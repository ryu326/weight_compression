/opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
17:23:34 INFO - logger_setup: /workspace/Weight_compression/NWC/utils/util.py
17:23:34 INFO - before_main: Create new exp folder!
17:23:34 INFO - before_main: seed : 100
17:23:34 INFO - before_main: exp name : block_seq_scaler_meta-llama--Llama-2-7b-hf__scaled3_RHT_sig0.0001_col_4096.pt/lmbda50_rdloss_size16_encdim512_M16_Q0_R0_m0_batch_size1024_total_iter200000_lr0.0001_seed100
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ryu326 (maskedkd) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /workspace/Weight_compression/NWC/wandb/run-20250324_172334-l2yb4a0j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run nwc
wandb: ‚≠êÔ∏è View project at https://wandb.ai/maskedkd/NWC_VQVAE
wandb: üöÄ View run at https://wandb.ai/maskedkd/NWC_VQVAE/runs/l2yb4a0j
17:23:35 INFO - main: Create experiment save folder
{'entropy_bottleneck.quantiles'}
17:23:46 INFO - main: Training mode : scratch!
17:23:46 INFO - main: batch_size : 1024
17:23:46 INFO - main: num of gpus: 1
17:23:46 INFO - main: Namespace(iter=200000, dataset='block_seq', dataset_path='../Wparam_dataset/block_pt/meta-llama--Llama-2-7b-hf/scaled3_RHT_sig0.0001_col_4096.pt', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=1024, seed=100, input_size=16, dim_encoder=512, n_resblock=4, M=16, N=0, R=0, m=0, Q=0, clip_max_norm=1.0, save_dir='', architecture='nwc', loss='rdloss', checkpoint='None', lmbda=50, dataset_stat_type='scaler', save_path='./checkpoint/nwc/block_seq_scaler_meta-llama--Llama-2-7b-hf__scaled3_RHT_sig0.0001_col_4096.pt/lmbda50_rdloss_size16_encdim512_M16_Q0_R0_m0_batch_size1024_total_iter200000_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:23:48 INFO - main: Train iter. 1/200000 (0.0005%): 	Loss: 154.69320678710938	recon_loss: 2.9862284660339355	bpp_loss: 5.381791591644287	aux_loss: 658.1146240234375
17:23:59 INFO - main: {'TEST MSE': 2.033244088507184, 'TEST BPP': 5.390625, 'TEST loss': 107.04319608306885, 'TEST recon_loss': 2.0332441551685334, 'TEST bpp_loss': 5.38098853969574}
17:23:59 INFO - main: can not find prev_mse_best_model!
17:23:59 INFO - main: can not find prev_bpp_best_model!
17:23:59 INFO - main: can not find prev_bpp_best_model!
17:23:59 INFO - main: can not find recent_saved_model!
/workspace/Weight_compression/NWC/train_nwc.py:422: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  csv_file = pd.concat([csv_file, pd.DataFrame([new_row])], ignore_index=True)
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:29:22 INFO - main: Train iter. 1000/200000 (0.5%): 	Loss: 4.900506019592285	recon_loss: 0.008549479767680168	bpp_loss: 4.473031997680664	aux_loss: 621.9385986328125
17:34:50 INFO - main: Train iter. 2000/200000 (1.0%): 	Loss: 4.3507795333862305	recon_loss: 0.010708357207477093	bpp_loss: 3.815361738204956	aux_loss: 562.1866455078125
17:40:17 INFO - main: Train iter. 3000/200000 (1.5%): 	Loss: 4.124096870422363	recon_loss: 0.012891155667603016	bpp_loss: 3.479539155960083	aux_loss: 504.2552490234375
17:45:42 INFO - main: Train iter. 4000/200000 (2.0%): 	Loss: 4.100210189819336	recon_loss: 0.01446786429733038	bpp_loss: 3.376816987991333	aux_loss: 466.8082275390625
17:51:09 INFO - main: Train iter. 5000/200000 (2.5%): 	Loss: 4.089184284210205	recon_loss: 0.014720744453370571	bpp_loss: 3.353147029876709	aux_loss: 442.4658203125
17:51:20 INFO - main: {'TEST MSE': 0.01467841193338816, 'TEST BPP': 3.366046875, 'TEST loss': 4.088303307294845, 'TEST recon_loss': 0.014678412424400449, 'TEST bpp_loss': 3.3543826887607575}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:56:47 INFO - main: Train iter. 6000/200000 (3.0%): 	Loss: 4.0835161209106445	recon_loss: 0.014657932333648205	bpp_loss: 3.3506195545196533	aux_loss: 417.57568359375
18:02:14 INFO - main: Train iter. 7000/200000 (3.5%): 	Loss: 4.069422245025635	recon_loss: 0.014823327772319317	bpp_loss: 3.3282556533813477	aux_loss: 385.1987609863281
18:07:39 INFO - main: Train iter. 8000/200000 (4.0%): 	Loss: 4.06484317779541	recon_loss: 0.014549864456057549	bpp_loss: 3.3373501300811768	aux_loss: 341.3545227050781
18:13:06 INFO - main: Train iter. 9000/200000 (4.5%): 	Loss: 4.056891918182373	recon_loss: 0.014604553580284119	bpp_loss: 3.3266642093658447	aux_loss: 284.0360107421875
18:18:34 INFO - main: Train iter. 10000/200000 (5.0%): 	Loss: 4.046770095825195	recon_loss: 0.014508814550936222	bpp_loss: 3.3213295936584473	aux_loss: 203.52377319335938
18:18:44 INFO - main: {'TEST MSE': 0.0145114817712045, 'TEST BPP': 3.3329296875, 'TEST loss': 4.046791397809982, 'TEST recon_loss': 0.014511482257395982, 'TEST bpp_loss': 3.32121728515625}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
18:24:11 INFO - main: Train iter. 11000/200000 (5.5%): 	Loss: 4.046846389770508	recon_loss: 0.014562951400876045	bpp_loss: 3.3186988830566406	aux_loss: 116.07911682128906
18:29:36 INFO - main: Train iter. 12000/200000 (6.0%): 	Loss: 4.023427486419678	recon_loss: 0.014510372653603554	bpp_loss: 3.2979090213775635	aux_loss: 56.81329345703125
18:35:04 INFO - main: Train iter. 13000/200000 (6.5%): 	Loss: 4.037308692932129	recon_loss: 0.014547969214618206	bpp_loss: 3.3099100589752197	aux_loss: 29.582822799682617
18:40:32 INFO - main: Train iter. 14000/200000 (7.0%): 	Loss: 4.034884452819824	recon_loss: 0.014635794796049595	bpp_loss: 3.3030948638916016	aux_loss: 13.174420356750488
18:45:56 INFO - main: Train iter. 15000/200000 (7.5%): 	Loss: 4.0429368019104	recon_loss: 0.014557905495166779	bpp_loss: 3.3150415420532227	aux_loss: 4.786713600158691
18:46:07 INFO - main: {'TEST MSE': 0.01453801580417378, 'TEST BPP': 3.3245703125, 'TEST loss': 4.038973077774048, 'TEST recon_loss': 0.014538016286678612, 'TEST bpp_loss': 3.312072261810303}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
18:51:33 INFO - main: Train iter. 16000/200000 (8.0%): 	Loss: 4.029313087463379	recon_loss: 0.014524626545608044	bpp_loss: 3.303081512451172	aux_loss: 0.9696860909461975
18:57:00 INFO - main: Train iter. 17000/200000 (8.5%): 	Loss: 4.0416154861450195	recon_loss: 0.014538904651999474	bpp_loss: 3.3146703243255615	aux_loss: 0.2756422758102417
19:02:27 INFO - main: Train iter. 18000/200000 (9.0%): 	Loss: 4.035900592803955	recon_loss: 0.014562133699655533	bpp_loss: 3.3077938556671143	aux_loss: 0.29442641139030457
19:07:52 INFO - main: Train iter. 19000/200000 (9.5%): 	Loss: 4.045121669769287	recon_loss: 0.014552228152751923	bpp_loss: 3.3175101280212402	aux_loss: 0.65735924243927
19:13:18 INFO - main: Train iter. 20000/200000 (10.0%): 	Loss: 4.037217617034912	recon_loss: 0.014486096799373627	bpp_loss: 3.312912702560425	aux_loss: 0.35863474011421204
19:13:29 INFO - main: {'TEST MSE': 0.014581427880239427, 'TEST BPP': 3.3256015625, 'TEST loss': 4.042041067123413, 'TEST recon_loss': 0.014581428377889097, 'TEST bpp_loss': 3.3129696464538574}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
19:18:55 INFO - main: Train iter. 21000/200000 (10.5%): 	Loss: 4.0399556159973145	recon_loss: 0.01454565767198801	bpp_loss: 3.3126726150512695	aux_loss: 0.28139838576316833
19:24:21 INFO - main: Train iter. 22000/200000 (11.0%): 	Loss: 4.040066242218018	recon_loss: 0.014603507705032825	bpp_loss: 3.3098909854888916	aux_loss: 0.38406267762184143
19:29:46 INFO - main: Train iter. 23000/200000 (11.5%): 	Loss: 4.030882358551025	recon_loss: 0.014516999945044518	bpp_loss: 3.305032253265381	aux_loss: 0.909915566444397
19:35:12 INFO - main: Train iter. 24000/200000 (12.0%): 	Loss: 4.030880451202393	recon_loss: 0.014515464194118977	bpp_loss: 3.3051071166992188	aux_loss: 0.9179567694664001
19:40:39 INFO - main: Train iter. 25000/200000 (12.5%): 	Loss: 4.039787769317627	recon_loss: 0.014519602060317993	bpp_loss: 3.313807725906372	aux_loss: 1.4787530899047852
19:40:50 INFO - main: {'TEST MSE': 0.014545000543519607, 'TEST BPP': 3.32384375, 'TEST loss': 4.0386368157863615, 'TEST recon_loss': 0.01454500102251768, 'TEST bpp_loss': 3.3113867609500884}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
19:46:15 INFO - main: Train iter. 26000/200000 (13.0%): 	Loss: 4.027693271636963	recon_loss: 0.01450087409466505	bpp_loss: 3.30264949798584	aux_loss: 1.523223638534546
19:51:40 INFO - main: Train iter. 27000/200000 (13.5%): 	Loss: 4.0430755615234375	recon_loss: 0.014523130841553211	bpp_loss: 3.3169188499450684	aux_loss: 0.15210746228694916
19:57:06 INFO - main: Train iter. 28000/200000 (14.0%): 	Loss: 4.032362461090088	recon_loss: 0.014519625343382359	bpp_loss: 3.3063812255859375	aux_loss: 0.35919779539108276
20:02:32 INFO - main: Train iter. 29000/200000 (14.5%): 	Loss: 4.039241790771484	recon_loss: 0.014552382752299309	bpp_loss: 3.3116228580474854	aux_loss: 0.4151279032230377
20:07:56 INFO - main: Train iter. 30000/200000 (15.0%): 	Loss: 4.035060882568359	recon_loss: 0.014519724994897842	bpp_loss: 3.3090744018554688	aux_loss: 0.24759699404239655
20:08:07 INFO - main: {'TEST MSE': 0.014520812268801572, 'TEST BPP': 3.32484375, 'TEST loss': 4.038146648645401, 'TEST recon_loss': 0.014520812749862671, 'TEST bpp_loss': 3.312106012582779}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
20:13:33 INFO - main: Train iter. 31000/200000 (15.5%): 	Loss: 4.01948356628418	recon_loss: 0.014483647421002388	bpp_loss: 3.2953009605407715	aux_loss: 1.1247673034667969
20:18:59 INFO - main: Train iter. 32000/200000 (16.0%): 	Loss: 4.043549060821533	recon_loss: 0.014537576586008072	bpp_loss: 3.3166701793670654	aux_loss: 0.1688506156206131
20:24:25 INFO - main: Train iter. 33000/200000 (16.5%): 	Loss: 4.029322624206543	recon_loss: 0.014488848857581615	bpp_loss: 3.304880380630493	aux_loss: 0.4814055860042572
20:29:49 INFO - main: Train iter. 34000/200000 (17.0%): 	Loss: 4.037256717681885	recon_loss: 0.014490646310150623	bpp_loss: 3.3127243518829346	aux_loss: 0.5726295709609985
20:35:15 INFO - main: Train iter. 35000/200000 (17.5%): 	Loss: 4.045173645019531	recon_loss: 0.014704344794154167	bpp_loss: 3.3099563121795654	aux_loss: 0.29459071159362793
20:35:27 INFO - main: {'TEST MSE': 0.014756696141290278, 'TEST BPP': 3.3255078125, 'TEST loss': 4.050743682384491, 'TEST recon_loss': 0.014756696639582515, 'TEST bpp_loss': 3.3129088439941405}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
20:40:52 INFO - main: Train iter. 36000/200000 (18.0%): 	Loss: 4.023947238922119	recon_loss: 0.014493024908006191	bpp_loss: 3.2992959022521973	aux_loss: 0.22040806710720062
20:46:18 INFO - main: Train iter. 37000/200000 (18.5%): 	Loss: 4.026051044464111	recon_loss: 0.01447722315788269	bpp_loss: 3.302190065383911	aux_loss: 0.3341881036758423
20:51:42 INFO - main: Train iter. 38000/200000 (19.0%): 	Loss: 4.035827159881592	recon_loss: 0.014471684582531452	bpp_loss: 3.3122427463531494	aux_loss: 0.3367295265197754
20:57:09 INFO - main: Train iter. 39000/200000 (19.5%): 	Loss: 4.036706447601318	recon_loss: 0.014467259868979454	bpp_loss: 3.3133435249328613	aux_loss: 0.433694988489151
21:02:35 INFO - main: Train iter. 40000/200000 (20.0%): 	Loss: 4.039585590362549	recon_loss: 0.014504184946417809	bpp_loss: 3.3143763542175293	aux_loss: 0.19837985932826996
21:02:46 INFO - main: {'TEST MSE': 0.014488589290277626, 'TEST BPP': 3.325484375, 'TEST loss': 4.037190534353257, 'TEST recon_loss': 0.01448858976829797, 'TEST bpp_loss': 3.3127610459327697}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
21:08:09 INFO - main: Train iter. 41000/200000 (20.5%): 	Loss: 4.028884410858154	recon_loss: 0.014528957195580006	bpp_loss: 3.302436351776123	aux_loss: 0.5764901041984558
21:13:36 INFO - main: Train iter. 42000/200000 (21.0%): 	Loss: 4.031744956970215	recon_loss: 0.014468692243099213	bpp_loss: 3.3083102703094482	aux_loss: 0.42739707231521606
21:19:03 INFO - main: Train iter. 43000/200000 (21.5%): 	Loss: 4.03309965133667	recon_loss: 0.014459558762609959	bpp_loss: 3.310121774673462	aux_loss: 0.23933430016040802
21:24:29 INFO - main: Train iter. 44000/200000 (22.0%): 	Loss: 4.029017925262451	recon_loss: 0.014474543742835522	bpp_loss: 3.305290937423706	aux_loss: 0.23460443317890167
21:29:54 INFO - main: Train iter. 45000/200000 (22.5%): 	Loss: 4.041112422943115	recon_loss: 0.014456227421760559	bpp_loss: 3.31830096244812	aux_loss: 0.29865577816963196
21:30:05 INFO - main: {'TEST MSE': 0.0144966681743366, 'TEST BPP': 3.3251171875, 'TEST loss': 4.0372346012592315, 'TEST recon_loss': 0.014496668661944568, 'TEST bpp_loss': 3.312401172399521}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
21:35:31 INFO - main: Train iter. 46000/200000 (23.0%): 	Loss: 4.020568370819092	recon_loss: 0.01447254978120327	bpp_loss: 3.296941041946411	aux_loss: 0.30487579107284546
21:40:58 INFO - main: Train iter. 47000/200000 (23.5%): 	Loss: 4.036355972290039	recon_loss: 0.014475144445896149	bpp_loss: 3.312598705291748	aux_loss: 0.5472919344902039
21:46:25 INFO - main: Train iter. 48000/200000 (24.0%): 	Loss: 4.028585910797119	recon_loss: 0.014455685392022133	bpp_loss: 3.3058016300201416	aux_loss: 0.8628265857696533
21:51:50 INFO - main: Train iter. 49000/200000 (24.5%): 	Loss: 4.0435333251953125	recon_loss: 0.01445222832262516	bpp_loss: 3.3209218978881836	aux_loss: 0.7498829960823059
21:57:17 INFO - main: Train iter. 50000/200000 (25.0%): 	Loss: 4.042692184448242	recon_loss: 0.014554797671735287	bpp_loss: 3.3149523735046387	aux_loss: 0.42040640115737915
21:57:28 INFO - main: {'TEST MSE': 0.014547506351730178, 'TEST BPP': 3.3251875, 'TEST loss': 4.039865171432495, 'TEST recon_loss': 0.014547506839968263, 'TEST bpp_loss': 3.3124898269176484}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:02:56 INFO - main: Train iter. 51000/200000 (25.5%): 	Loss: 4.0320048332214355	recon_loss: 0.014478066004812717	bpp_loss: 3.3081014156341553	aux_loss: 0.5526217222213745
22:08:23 INFO - main: Train iter. 52000/200000 (26.0%): 	Loss: 4.026787281036377	recon_loss: 0.014449048787355423	bpp_loss: 3.304334878921509	aux_loss: 1.1474580764770508
22:13:47 INFO - main: Train iter. 53000/200000 (26.5%): 	Loss: 4.030637741088867	recon_loss: 0.01448227558284998	bpp_loss: 3.3065240383148193	aux_loss: 0.4474899172782898
22:19:14 INFO - main: Train iter. 54000/200000 (27.0%): 	Loss: 4.0325140953063965	recon_loss: 0.014497361145913601	bpp_loss: 3.3076460361480713	aux_loss: 0.20865193009376526
22:24:41 INFO - main: Train iter. 55000/200000 (27.5%): 	Loss: 4.028510570526123	recon_loss: 0.014453006908297539	bpp_loss: 3.3058600425720215	aux_loss: 0.638264536857605
22:24:52 INFO - main: {'TEST MSE': 0.014464984456611957, 'TEST BPP': 3.3244375, 'TEST loss': 4.034973453044891, 'TEST recon_loss': 0.014464984938502312, 'TEST bpp_loss': 3.31172420334816}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:30:16 INFO - main: Train iter. 56000/200000 (28.0%): 	Loss: 4.026312828063965	recon_loss: 0.014473087154328823	bpp_loss: 3.3026585578918457	aux_loss: 0.19234691560268402
22:35:43 INFO - main: Train iter. 57000/200000 (28.5%): 	Loss: 4.031265735626221	recon_loss: 0.014454334042966366	bpp_loss: 3.308548927307129	aux_loss: 0.31869301199913025
22:41:09 INFO - main: Train iter. 58000/200000 (29.0%): 	Loss: 4.031562805175781	recon_loss: 0.014451366849243641	bpp_loss: 3.3089942932128906	aux_loss: 0.4451315999031067
22:46:36 INFO - main: Train iter. 59000/200000 (29.5%): 	Loss: 4.019932746887207	recon_loss: 0.014462864026427269	bpp_loss: 3.2967896461486816	aux_loss: 0.3617892265319824
22:52:00 INFO - main: Train iter. 60000/200000 (30.0%): 	Loss: 4.034392833709717	recon_loss: 0.014552460052073002	bpp_loss: 3.306769847869873	aux_loss: 0.42423582077026367
22:52:11 INFO - main: {'TEST MSE': 0.014464775861261896, 'TEST BPP': 3.3247421875, 'TEST loss': 4.035226036787033, 'TEST recon_loss': 0.01446477635204792, 'TEST bpp_loss': 3.3119872274398805}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:57:37 INFO - main: Train iter. 61000/200000 (30.5%): 	Loss: 4.039271354675293	recon_loss: 0.014444531872868538	bpp_loss: 3.317044734954834	aux_loss: 0.39187705516815186
23:03:04 INFO - main: Train iter. 62000/200000 (31.0%): 	Loss: 4.02124547958374	recon_loss: 0.014463266357779503	bpp_loss: 3.2980823516845703	aux_loss: 0.45283499360084534
23:08:31 INFO - main: Train iter. 63000/200000 (31.5%): 	Loss: 4.040755748748779	recon_loss: 0.014471733011305332	bpp_loss: 3.317168951034546	aux_loss: 0.2649734616279602
23:13:56 INFO - main: Train iter. 64000/200000 (32.0%): 	Loss: 4.0363874435424805	recon_loss: 0.01446753740310669	bpp_loss: 3.3130106925964355	aux_loss: 0.8660594820976257
23:19:23 INFO - main: Train iter. 65000/200000 (32.5%): 	Loss: 4.041221618652344	recon_loss: 0.014455683529376984	bpp_loss: 3.3184375762939453	aux_loss: 0.20662760734558105
23:19:34 INFO - main: {'TEST MSE': 0.014489604535372609, 'TEST BPP': 3.325203125, 'TEST loss': 4.036922086238861, 'TEST recon_loss': 0.014489605023525655, 'TEST bpp_loss': 3.3124418375492097}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
23:25:00 INFO - main: Train iter. 66000/200000 (33.0%): 	Loss: 4.036704063415527	recon_loss: 0.01445878017693758	bpp_loss: 3.313765048980713	aux_loss: 0.31127023696899414
23:30:27 INFO - main: Train iter. 67000/200000 (33.5%): 	Loss: 4.034446716308594	recon_loss: 0.014464220963418484	bpp_loss: 3.3112356662750244	aux_loss: 0.20217448472976685
23:35:51 INFO - main: Train iter. 68000/200000 (34.0%): 	Loss: 4.032751083374023	recon_loss: 0.014491811394691467	bpp_loss: 3.3081605434417725	aux_loss: 0.9229877591133118
23:41:18 INFO - main: Train iter. 69000/200000 (34.5%): 	Loss: 4.033729076385498	recon_loss: 0.014442767947912216	bpp_loss: 3.3115906715393066	aux_loss: 0.37449437379837036
23:46:45 INFO - main: Train iter. 70000/200000 (35.0%): 	Loss: 4.03959321975708	recon_loss: 0.01455786544829607	bpp_loss: 3.311699867248535	aux_loss: 0.8109449744224548
23:46:56 INFO - main: {'TEST MSE': 0.014486838217970007, 'TEST BPP': 3.323859375, 'TEST loss': 4.035472561597824, 'TEST recon_loss': 0.01448683870676905, 'TEST bpp_loss': 3.3111306254863737}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
23:52:20 INFO - main: Train iter. 71000/200000 (35.5%): 	Loss: 4.033930778503418	recon_loss: 0.014460449106991291	bpp_loss: 3.310908079147339	aux_loss: 0.3012741804122925
23:57:46 INFO - main: Train iter. 72000/200000 (36.0%): 	Loss: 4.0347490310668945	recon_loss: 0.014471620321273804	bpp_loss: 3.3111681938171387	aux_loss: 0.6962053775787354
00:03:13 INFO - main: Train iter. 73000/200000 (36.5%): 	Loss: 4.035181522369385	recon_loss: 0.014508902095258236	bpp_loss: 3.309736490249634	aux_loss: 0.3377978205680847
00:08:39 INFO - main: Train iter. 74000/200000 (37.0%): 	Loss: 4.031729698181152	recon_loss: 0.014453689567744732	bpp_loss: 3.3090453147888184	aux_loss: 0.473178505897522
00:14:04 INFO - main: Train iter. 75000/200000 (37.5%): 	Loss: 4.031654357910156	recon_loss: 0.014449264854192734	bpp_loss: 3.3091909885406494	aux_loss: 0.4663202166557312
00:14:16 INFO - main: {'TEST MSE': 0.01444485365533337, 'TEST BPP': 3.32540625, 'TEST loss': 4.034966771364212, 'TEST recon_loss': 0.014444854139350354, 'TEST bpp_loss': 3.3127240607738493}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
00:19:42 INFO - main: Train iter. 76000/200000 (38.0%): 	Loss: 4.036326885223389	recon_loss: 0.014476428739726543	bpp_loss: 3.3125054836273193	aux_loss: 0.7054070830345154
00:25:09 INFO - main: Train iter. 77000/200000 (38.5%): 	Loss: 4.03074836730957	recon_loss: 0.01447463221848011	bpp_loss: 3.307016611099243	aux_loss: 0.7351310849189758
00:30:35 INFO - main: Train iter. 78000/200000 (39.0%): 	Loss: 4.0312323570251465	recon_loss: 0.014472481794655323	bpp_loss: 3.307608127593994	aux_loss: 0.7298679947853088
00:35:59 INFO - main: Train iter. 79000/200000 (39.5%): 	Loss: 4.0287981033325195	recon_loss: 0.014473352581262589	bpp_loss: 3.3051302433013916	aux_loss: 0.4156630039215088
00:41:25 INFO - main: Train iter. 80000/200000 (40.0%): 	Loss: 4.03197717666626	recon_loss: 0.01445397362112999	bpp_loss: 3.3092784881591797	aux_loss: 0.26635438203811646
00:41:36 INFO - main: {'TEST MSE': 0.014446989171630035, 'TEST BPP': 3.3248203125, 'TEST loss': 4.034442705154419, 'TEST recon_loss': 0.014446989656426013, 'TEST bpp_loss': 3.312093220949173}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
00:47:01 INFO - main: Train iter. 81000/200000 (40.5%): 	Loss: 4.031452178955078	recon_loss: 0.014443622902035713	bpp_loss: 3.3092708587646484	aux_loss: 0.8420489430427551
00:52:25 INFO - main: Train iter. 82000/200000 (41.0%): 	Loss: 4.021225929260254	recon_loss: 0.014460708945989609	bpp_loss: 3.2981903553009033	aux_loss: 0.3674677014350891
00:57:51 INFO - main: Train iter. 83000/200000 (41.5%): 	Loss: 4.031612396240234	recon_loss: 0.014444975182414055	bpp_loss: 3.309363842010498	aux_loss: 0.2868638336658478
01:03:17 INFO - main: Train iter. 84000/200000 (42.0%): 	Loss: 4.035707950592041	recon_loss: 0.014477124437689781	bpp_loss: 3.311851739883423	aux_loss: 0.3384777009487152
01:08:43 INFO - main: Train iter. 85000/200000 (42.5%): 	Loss: 4.0314226150512695	recon_loss: 0.01447321381419897	bpp_loss: 3.3077621459960938	aux_loss: 0.37047696113586426
01:08:54 INFO - main: {'TEST MSE': 0.014467960287537473, 'TEST BPP': 3.3244140625, 'TEST loss': 4.035097113609314, 'TEST recon_loss': 0.0144679607860744, 'TEST bpp_loss': 3.3116990764141083}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
01:14:18 INFO - main: Train iter. 86000/200000 (43.0%): 	Loss: 4.032209873199463	recon_loss: 0.01444331556558609	bpp_loss: 3.310044050216675	aux_loss: 0.33193302154541016
01:19:44 INFO - main: Train iter. 87000/200000 (43.5%): 	Loss: 4.032227039337158	recon_loss: 0.014449807815253735	bpp_loss: 3.309736490249634	aux_loss: 0.5344823598861694
01:25:09 INFO - main: Train iter. 88000/200000 (44.0%): 	Loss: 4.015981197357178	recon_loss: 0.014461052604019642	bpp_loss: 3.292928457260132	aux_loss: 0.7889474630355835
01:30:35 INFO - main: Train iter. 89000/200000 (44.5%): 	Loss: 4.024441242218018	recon_loss: 0.014469808898866177	bpp_loss: 3.3009510040283203	aux_loss: 0.49848902225494385
01:35:59 INFO - main: Train iter. 90000/200000 (45.0%): 	Loss: 4.041869640350342	recon_loss: 0.014460590668022633	bpp_loss: 3.3188400268554688	aux_loss: 0.7505765557289124
01:36:10 INFO - main: {'TEST MSE': 0.014441848328377617, 'TEST BPP': 3.3252109375, 'TEST loss': 4.034676281690597, 'TEST recon_loss': 0.01444184880051762, 'TEST bpp_loss': 3.3125838403701784}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
01:41:35 INFO - main: Train iter. 91000/200000 (45.5%): 	Loss: 4.0296854972839355	recon_loss: 0.014443336986005306	bpp_loss: 3.307518720626831	aux_loss: 0.4384896755218506
01:47:01 INFO - main: Train iter. 92000/200000 (46.0%): 	Loss: 4.0333781242370605	recon_loss: 0.0144722955301404	bpp_loss: 3.3097634315490723	aux_loss: 0.6333392262458801
01:52:27 INFO - main: Train iter. 93000/200000 (46.5%): 	Loss: 4.036606311798096	recon_loss: 0.014475065283477306	bpp_loss: 3.3128528594970703	aux_loss: 0.9000245332717896
01:57:52 INFO - main: Train iter. 94000/200000 (47.0%): 	Loss: 4.0267205238342285	recon_loss: 0.01444656029343605	bpp_loss: 3.3043923377990723	aux_loss: 0.22424639761447906
02:03:18 INFO - main: Train iter. 95000/200000 (47.5%): 	Loss: 4.025130271911621	recon_loss: 0.014448384754359722	bpp_loss: 3.302711009979248	aux_loss: 0.1501198709011078
02:03:29 INFO - main: {'TEST MSE': 0.014450057722747016, 'TEST BPP': 3.3246640625, 'TEST loss': 4.034462625026703, 'TEST recon_loss': 0.014450058207847179, 'TEST bpp_loss': 3.3119597222805024}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
02:08:55 INFO - main: Train iter. 96000/200000 (48.0%): 	Loss: 4.021909236907959	recon_loss: 0.014445813372731209	bpp_loss: 3.2996184825897217	aux_loss: 0.4737904667854309
02:14:18 INFO - main: Train iter. 97000/200000 (48.5%): 	Loss: 4.028873920440674	recon_loss: 0.014453832060098648	bpp_loss: 3.306182384490967	aux_loss: 0.4090332090854645
02:19:43 INFO - main: Train iter. 98000/200000 (49.0%): 	Loss: 4.036777973175049	recon_loss: 0.01445773709565401	bpp_loss: 3.3138909339904785	aux_loss: 0.2896338403224945
02:25:09 INFO - main: Train iter. 99000/200000 (49.5%): 	Loss: 4.024803638458252	recon_loss: 0.014486994594335556	bpp_loss: 3.3004539012908936	aux_loss: 0.37540119886398315
02:30:33 INFO - main: Train iter. 100000/200000 (50.0%): 	Loss: 4.030213832855225	recon_loss: 0.014438283629715443	bpp_loss: 3.3082997798919678	aux_loss: 0.5598066449165344
02:30:45 INFO - main: {'TEST MSE': 0.014471430759551207, 'TEST BPP': 3.325109375, 'TEST loss': 4.0358759310245516, 'TEST recon_loss': 0.01447143123485148, 'TEST bpp_loss': 3.3123043677806856}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
02:36:08 INFO - main: Train iter. 101000/200000 (50.5%): 	Loss: 4.027397632598877	recon_loss: 0.014440628699958324	bpp_loss: 3.305366277694702	aux_loss: 0.23261889815330505
02:41:36 INFO - main: Train iter. 102000/200000 (51.0%): 	Loss: 4.029122352600098	recon_loss: 0.01446341723203659	bpp_loss: 3.3059515953063965	aux_loss: 0.23219163715839386
02:47:03 INFO - main: Train iter. 103000/200000 (51.5%): 	Loss: 4.025569915771484	recon_loss: 0.0144589152187109	bpp_loss: 3.302623987197876	aux_loss: 0.22078779339790344
02:52:30 INFO - main: Train iter. 104000/200000 (52.0%): 	Loss: 4.01674222946167	recon_loss: 0.014446573331952095	bpp_loss: 3.2944135665893555	aux_loss: 0.5163595080375671
02:57:55 INFO - main: Train iter. 105000/200000 (52.5%): 	Loss: 4.032325267791748	recon_loss: 0.014495398849248886	bpp_loss: 3.3075554370880127	aux_loss: 0.35431697964668274
02:58:06 INFO - main: {'TEST MSE': 0.01448593361597502, 'TEST BPP': 3.3245625, 'TEST loss': 4.0362547385692595, 'TEST recon_loss': 0.014485934094525874, 'TEST bpp_loss': 3.3119580340385437}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
03:03:32 INFO - main: Train iter. 106000/200000 (53.0%): 	Loss: 4.027151107788086	recon_loss: 0.014448313042521477	bpp_loss: 3.3047354221343994	aux_loss: 0.1730487048625946
03:08:59 INFO - main: Train iter. 107000/200000 (53.5%): 	Loss: 4.030083179473877	recon_loss: 0.014448586851358414	bpp_loss: 3.3076539039611816	aux_loss: 0.17431309819221497
03:14:26 INFO - main: Train iter. 108000/200000 (54.0%): 	Loss: 4.027992248535156	recon_loss: 0.014455342665314674	bpp_loss: 3.305225133895874	aux_loss: 0.36540740728378296
03:19:51 INFO - main: Train iter. 109000/200000 (54.5%): 	Loss: 4.019786357879639	recon_loss: 0.014453080482780933	bpp_loss: 3.2971322536468506	aux_loss: 0.257038414478302
03:25:17 INFO - main: Train iter. 110000/200000 (55.0%): 	Loss: 4.0299859046936035	recon_loss: 0.014476164244115353	bpp_loss: 3.3061776161193848	aux_loss: 1.1769474744796753
03:25:27 INFO - main: {'TEST MSE': 0.014467885883912977, 'TEST BPP': 3.323328125, 'TEST loss': 4.033909020900726, 'TEST recon_loss': 0.014467886372469365, 'TEST bpp_loss': 3.310514706611633}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
03:30:53 INFO - main: Train iter. 111000/200000 (55.5%): 	Loss: 4.029630661010742	recon_loss: 0.014479515142738819	bpp_loss: 3.305655002593994	aux_loss: 0.3252050280570984
03:36:18 INFO - main: Train iter. 112000/200000 (56.0%): 	Loss: 4.029643535614014	recon_loss: 0.014460782520473003	bpp_loss: 3.3066043853759766	aux_loss: 0.29140833020210266
03:41:44 INFO - main: Train iter. 113000/200000 (56.5%): 	Loss: 4.025740146636963	recon_loss: 0.014455386437475681	bpp_loss: 3.3029708862304688	aux_loss: 0.23862986266613007
03:47:11 INFO - main: Train iter. 114000/200000 (57.0%): 	Loss: 4.047145843505859	recon_loss: 0.014450986869633198	bpp_loss: 3.324596643447876	aux_loss: 0.7951960563659668
03:52:41 INFO - main: Train iter. 115000/200000 (57.5%): 	Loss: 4.029613494873047	recon_loss: 0.014465359970927238	bpp_loss: 3.3063457012176514	aux_loss: 0.7342922687530518
03:52:52 INFO - main: {'TEST MSE': 0.014466123483838633, 'TEST BPP': 3.323828125, 'TEST loss': 4.03445761680603, 'TEST recon_loss': 0.014466123966500164, 'TEST bpp_loss': 3.311151421546936}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
03:58:19 INFO - main: Train iter. 116000/200000 (58.0%): 	Loss: 4.017229080200195	recon_loss: 0.014450488612055779	bpp_loss: 3.2947046756744385	aux_loss: 0.27057749032974243
04:03:47 INFO - main: Train iter. 117000/200000 (58.5%): 	Loss: 4.038697242736816	recon_loss: 0.014472289942204952	bpp_loss: 3.3150827884674072	aux_loss: 0.43250587582588196
04:09:16 INFO - main: Train iter. 118000/200000 (59.0%): 	Loss: 4.020206451416016	recon_loss: 0.014452161267399788	bpp_loss: 3.297598361968994	aux_loss: 0.2966727018356323
04:14:43 INFO - main: Train iter. 119000/200000 (59.5%): 	Loss: 4.029369354248047	recon_loss: 0.014443106018006802	bpp_loss: 3.3072140216827393	aux_loss: 0.18523792922496796
04:20:09 INFO - main: Train iter. 120000/200000 (60.0%): 	Loss: 4.027137756347656	recon_loss: 0.014473915100097656	bpp_loss: 3.3034420013427734	aux_loss: 0.7122774720191956
04:20:20 INFO - main: {'TEST MSE': 0.014466151507739, 'TEST BPP': 3.3237578125, 'TEST loss': 4.034261597394943, 'TEST recon_loss': 0.014466152001172305, 'TEST bpp_loss': 3.3109539949893954}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
04:25:46 INFO - main: Train iter. 121000/200000 (60.5%): 	Loss: 4.03309440612793	recon_loss: 0.014470716938376427	bpp_loss: 3.309558391571045	aux_loss: 0.8098564743995667
04:31:14 INFO - main: Train iter. 122000/200000 (61.0%): 	Loss: 4.036394119262695	recon_loss: 0.01446034386754036	bpp_loss: 3.3133766651153564	aux_loss: 0.34948086738586426
04:36:40 INFO - main: Train iter. 123000/200000 (61.5%): 	Loss: 4.034214019775391	recon_loss: 0.014523125253617764	bpp_loss: 3.308058023452759	aux_loss: 0.3647497594356537
04:42:08 INFO - main: Train iter. 124000/200000 (62.0%): 	Loss: 4.028192520141602	recon_loss: 0.01445589680224657	bpp_loss: 3.3053975105285645	aux_loss: 0.4299328923225403
04:47:35 INFO - main: Train iter. 125000/200000 (62.5%): 	Loss: 4.038441181182861	recon_loss: 0.014479642733931541	bpp_loss: 3.3144588470458984	aux_loss: 0.40117740631103516
04:47:46 INFO - main: {'TEST MSE': 0.014467474888153434, 'TEST BPP': 3.3238125, 'TEST loss': 4.034529373884201, 'TEST recon_loss': 0.01446747536957264, 'TEST bpp_loss': 3.3111556034088134}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
04:53:13 INFO - main: Train iter. 126000/200000 (63.0%): 	Loss: 4.017937183380127	recon_loss: 0.01444119494408369	bpp_loss: 3.295877456665039	aux_loss: 0.5661218166351318
04:58:37 INFO - main: Train iter. 127000/200000 (63.5%): 	Loss: 4.034954071044922	recon_loss: 0.014469034969806671	bpp_loss: 3.311502456665039	aux_loss: 0.9083349704742432
Terminated
