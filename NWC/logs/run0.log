/opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
17:20:07 INFO - logger_setup: /workspace/Weight_compression/NWC/utils/util.py
17:20:07 INFO - before_main: find checkpoint...
17:20:07 INFO - before_main: no checkpoint is here
17:20:07 INFO - before_main: seed : 100
17:20:07 INFO - before_main: exp name : block_seq_scaler_meta-llama--Llama-2-7b-hf__scaled3_RHT_sig0.0001_col_4096.pt/lmbda10_rdloss_size16_encdim512_M16_Q0_R0_m0_batch_size1024_total_iter200000_lr0.0001_seed100
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ryu326 (maskedkd) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /workspace/Weight_compression/NWC/wandb/run-20250324_172007-3tusa0a1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run nwc
wandb: ‚≠êÔ∏è View project at https://wandb.ai/maskedkd/NWC_VQVAE
wandb: üöÄ View run at https://wandb.ai/maskedkd/NWC_VQVAE/runs/3tusa0a1
17:20:08 INFO - main: Create experiment save folder
{'entropy_bottleneck.quantiles'}
17:20:19 INFO - main: Training mode : scratch!
17:20:19 INFO - main: batch_size : 1024
17:20:19 INFO - main: num of gpus: 1
17:20:19 INFO - main: Namespace(iter=200000, dataset='block_seq', dataset_path='../Wparam_dataset/block_pt/meta-llama--Llama-2-7b-hf/scaled3_RHT_sig0.0001_col_4096.pt', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=1024, seed=100, input_size=16, dim_encoder=512, n_resblock=4, M=16, N=0, R=0, m=0, Q=0, clip_max_norm=1.0, save_dir='', architecture='nwc', loss='rdloss', checkpoint='None', lmbda=10, dataset_stat_type='scaler', save_path='./checkpoint/nwc/block_seq_scaler_meta-llama--Llama-2-7b-hf__scaled3_RHT_sig0.0001_col_4096.pt/lmbda10_rdloss_size16_encdim512_M16_Q0_R0_m0_batch_size1024_total_iter200000_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:20:21 INFO - main: Train iter. 1/200000 (0.0005%): 	Loss: 35.244075775146484	recon_loss: 2.9862284660339355	bpp_loss: 5.381791591644287	aux_loss: 658.1145629882812
17:20:32 INFO - main: {'TEST MSE': 2.033238746791266, 'TEST BPP': 5.390625, 'TEST loss': 25.713366670608522, 'TEST recon_loss': 2.0332388138771056, 'TEST bpp_loss': 5.380978523254394}
17:20:32 INFO - main: can not find prev_mse_best_model!
17:20:32 INFO - main: can not find prev_bpp_best_model!
17:20:32 INFO - main: can not find prev_bpp_best_model!
17:20:32 INFO - main: can not find recent_saved_model!
/workspace/Weight_compression/NWC/train_nwc.py:422: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  csv_file = pd.concat([csv_file, pd.DataFrame([new_row])], ignore_index=True)
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:26:02 INFO - main: Train iter. 1000/200000 (0.5%): 	Loss: 4.399242401123047	recon_loss: 0.015693342313170433	bpp_loss: 4.242309093475342	aux_loss: 615.45361328125
17:31:38 INFO - main: Train iter. 2000/200000 (1.0%): 	Loss: 3.6259231567382812	recon_loss: 0.026988668367266655	bpp_loss: 3.356036424636841	aux_loss: 551.8179931640625
17:37:13 INFO - main: Train iter. 3000/200000 (1.5%): 	Loss: 3.168243885040283	recon_loss: 0.04198424518108368	bpp_loss: 2.748401403427124	aux_loss: 477.2164306640625
17:42:46 INFO - main: Train iter. 4000/200000 (2.0%): 	Loss: 2.976834297180176	recon_loss: 0.05648064985871315	bpp_loss: 2.4120278358459473	aux_loss: 399.7845458984375
17:48:20 INFO - main: Train iter. 5000/200000 (2.5%): 	Loss: 2.917961597442627	recon_loss: 0.06743810325860977	bpp_loss: 2.2435805797576904	aux_loss: 331.3126220703125
17:48:31 INFO - main: {'TEST MSE': 0.06709841493211323, 'TEST BPP': 2.258671875, 'TEST loss': 2.9178750643730162, 'TEST recon_loss': 0.06709841718524695, 'TEST bpp_loss': 2.246890895366669}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:54:06 INFO - main: Train iter. 6000/200000 (3.0%): 	Loss: 2.9099700450897217	recon_loss: 0.07254231721162796	bpp_loss: 2.184546947479248	aux_loss: 282.77459716796875
17:59:40 INFO - main: Train iter. 7000/200000 (3.5%): 	Loss: 2.893078327178955	recon_loss: 0.0735984519124031	bpp_loss: 2.1570937633514404	aux_loss: 251.9742431640625
18:05:13 INFO - main: Train iter. 8000/200000 (4.0%): 	Loss: 2.907114028930664	recon_loss: 0.07356460392475128	bpp_loss: 2.1714680194854736	aux_loss: 222.9521942138672
18:10:48 INFO - main: Train iter. 9000/200000 (4.5%): 	Loss: 2.899465322494507	recon_loss: 0.07338173687458038	bpp_loss: 2.1656479835510254	aux_loss: 187.36138916015625
18:16:22 INFO - main: Train iter. 10000/200000 (5.0%): 	Loss: 2.8968186378479004	recon_loss: 0.07333838194608688	bpp_loss: 2.1634347438812256	aux_loss: 140.7108154296875
18:16:33 INFO - main: {'TEST MSE': 0.07295703468159075, 'TEST BPP': 2.1778828125, 'TEST loss': 2.8956345705986024, 'TEST recon_loss': 0.07295703710615635, 'TEST bpp_loss': 2.166064204096794}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
18:22:07 INFO - main: Train iter. 11000/200000 (5.5%): 	Loss: 2.8985753059387207	recon_loss: 0.0732860192656517	bpp_loss: 2.165715217590332	aux_loss: 78.86839294433594
18:27:40 INFO - main: Train iter. 12000/200000 (6.0%): 	Loss: 2.8742942810058594	recon_loss: 0.07281647622585297	bpp_loss: 2.146129608154297	aux_loss: 14.139861106872559
18:33:15 INFO - main: Train iter. 13000/200000 (6.5%): 	Loss: 2.886401653289795	recon_loss: 0.07278529554605484	bpp_loss: 2.1585488319396973	aux_loss: 47.35704803466797
18:38:50 INFO - main: Train iter. 14000/200000 (7.0%): 	Loss: 2.8741347789764404	recon_loss: 0.07257089018821716	bpp_loss: 2.148425817489624	aux_loss: 102.07684326171875
18:44:23 INFO - main: Train iter. 15000/200000 (7.5%): 	Loss: 2.884176254272461	recon_loss: 0.07235496491193771	bpp_loss: 2.1606266498565674	aux_loss: 166.873291015625
18:44:34 INFO - main: {'TEST MSE': 0.07235557122652365, 'TEST BPP': 2.170640625, 'TEST loss': 2.8823621737957, 'TEST recon_loss': 0.07235557358711958, 'TEST bpp_loss': 2.15880644261837}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
18:50:08 INFO - main: Train iter. 16000/200000 (8.0%): 	Loss: 2.8683021068573	recon_loss: 0.0718967467546463	bpp_loss: 2.149334669113159	aux_loss: 235.5763397216797
18:55:43 INFO - main: Train iter. 17000/200000 (8.5%): 	Loss: 2.878772258758545	recon_loss: 0.07231886684894562	bpp_loss: 2.155583620071411	aux_loss: 293.2369384765625
19:01:17 INFO - main: Train iter. 18000/200000 (9.0%): 	Loss: 2.8700573444366455	recon_loss: 0.07191154360771179	bpp_loss: 2.150941848754883	aux_loss: 330.4723205566406
19:06:51 INFO - main: Train iter. 19000/200000 (9.5%): 	Loss: 2.879728317260742	recon_loss: 0.07206455618143082	bpp_loss: 2.1590828895568848	aux_loss: 337.1316833496094
19:12:25 INFO - main: Train iter. 20000/200000 (10.0%): 	Loss: 2.87286376953125	recon_loss: 0.07231742143630981	bpp_loss: 2.1496894359588623	aux_loss: 319.431884765625
19:12:36 INFO - main: {'TEST MSE': 0.0722854984205399, 'TEST BPP': 2.162953125, 'TEST loss': 2.8735743782520293, 'TEST recon_loss': 0.07228550080955029, 'TEST bpp_loss': 2.1507193709611894}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
19:18:10 INFO - main: Train iter. 21000/200000 (10.5%): 	Loss: 2.873748779296875	recon_loss: 0.07221701741218567	bpp_loss: 2.151578664779663	aux_loss: 279.27117919921875
19:23:44 INFO - main: Train iter. 22000/200000 (11.0%): 	Loss: 2.8712170124053955	recon_loss: 0.07225296646356583	bpp_loss: 2.1486873626708984	aux_loss: 222.58062744140625
19:29:17 INFO - main: Train iter. 23000/200000 (11.5%): 	Loss: 2.865777015686035	recon_loss: 0.07221149653196335	bpp_loss: 2.1436619758605957	aux_loss: 154.40045166015625
19:34:51 INFO - main: Train iter. 24000/200000 (12.0%): 	Loss: 2.8655736446380615	recon_loss: 0.07214485853910446	bpp_loss: 2.144124984741211	aux_loss: 82.4453353881836
19:40:27 INFO - main: Train iter. 25000/200000 (12.5%): 	Loss: 2.8752036094665527	recon_loss: 0.07250857353210449	bpp_loss: 2.150117874145508	aux_loss: 19.59084701538086
19:40:37 INFO - main: {'TEST MSE': 0.07251595913016229, 'TEST BPP': 2.160296875, 'TEST loss': 2.873400102853775, 'TEST recon_loss': 0.07251596161723137, 'TEST bpp_loss': 2.148240488409996}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
19:46:12 INFO - main: Train iter. 26000/200000 (13.0%): 	Loss: 2.862034559249878	recon_loss: 0.07216908782720566	bpp_loss: 2.14034366607666	aux_loss: 0.5337437391281128
19:51:44 INFO - main: Train iter. 27000/200000 (13.5%): 	Loss: 2.876974105834961	recon_loss: 0.07227285206317902	bpp_loss: 2.154245615005493	aux_loss: 0.1646692007780075
19:57:18 INFO - main: Train iter. 28000/200000 (14.0%): 	Loss: 2.8677029609680176	recon_loss: 0.07240279763936996	bpp_loss: 2.1436750888824463	aux_loss: 0.3229406476020813
20:02:53 INFO - main: Train iter. 29000/200000 (14.5%): 	Loss: 2.870756149291992	recon_loss: 0.07184199243783951	bpp_loss: 2.152336359024048	aux_loss: 0.41953378915786743
20:08:26 INFO - main: Train iter. 30000/200000 (15.0%): 	Loss: 2.8688371181488037	recon_loss: 0.0720997303724289	bpp_loss: 2.1478397846221924	aux_loss: 0.221804678440094
20:08:36 INFO - main: {'TEST MSE': 0.072545458069763, 'TEST BPP': 2.1622421875, 'TEST loss': 2.875559477567673, 'TEST recon_loss': 0.07254546049237251, 'TEST bpp_loss': 2.150104876637459}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
20:14:09 INFO - main: Train iter. 31000/200000 (15.5%): 	Loss: 2.853910446166992	recon_loss: 0.07195749878883362	bpp_loss: 2.134335517883301	aux_loss: 0.6085076928138733
20:19:43 INFO - main: Train iter. 32000/200000 (16.0%): 	Loss: 2.876845359802246	recon_loss: 0.07227514684200287	bpp_loss: 2.1540939807891846	aux_loss: 0.3851490616798401
20:25:17 INFO - main: Train iter. 33000/200000 (16.5%): 	Loss: 2.8647215366363525	recon_loss: 0.07209396362304688	bpp_loss: 2.143781900405884	aux_loss: 0.22988788783550262
20:30:50 INFO - main: Train iter. 34000/200000 (17.0%): 	Loss: 2.8725383281707764	recon_loss: 0.07216446846723557	bpp_loss: 2.1508936882019043	aux_loss: 0.2791977822780609
20:36:24 INFO - main: Train iter. 35000/200000 (17.5%): 	Loss: 2.873318910598755	recon_loss: 0.07275441288948059	bpp_loss: 2.1457748413085938	aux_loss: 0.4847217798233032
20:36:35 INFO - main: {'TEST MSE': 0.07245663769644414, 'TEST BPP': 2.160609375, 'TEST loss': 2.873152462244034, 'TEST recon_loss': 0.07245664012432099, 'TEST bpp_loss': 2.148586063861847}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
20:42:08 INFO - main: Train iter. 36000/200000 (18.0%): 	Loss: 2.859011173248291	recon_loss: 0.07224137336015701	bpp_loss: 2.1365973949432373	aux_loss: 0.26257994771003723
20:47:42 INFO - main: Train iter. 37000/200000 (18.5%): 	Loss: 2.86167573928833	recon_loss: 0.07206754386425018	bpp_loss: 2.141000270843506	aux_loss: 0.2402656078338623
20:53:13 INFO - main: Train iter. 38000/200000 (19.0%): 	Loss: 2.8725130558013916	recon_loss: 0.0723898634314537	bpp_loss: 2.1486144065856934	aux_loss: 0.6715047955513
20:58:48 INFO - main: Train iter. 39000/200000 (19.5%): 	Loss: 2.8731884956359863	recon_loss: 0.0724124014377594	bpp_loss: 2.149064540863037	aux_loss: 0.5483864545822144
21:04:22 INFO - main: Train iter. 40000/200000 (20.0%): 	Loss: 2.8737587928771973	recon_loss: 0.07236085832118988	bpp_loss: 2.1501500606536865	aux_loss: 0.2527676820755005
21:04:33 INFO - main: {'TEST MSE': 0.07218044829304299, 'TEST BPP': 2.1616484375, 'TEST loss': 2.8712589251995086, 'TEST recon_loss': 0.07218045063316822, 'TEST bpp_loss': 2.1494544175863264}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
21:10:05 INFO - main: Train iter. 41000/200000 (20.5%): 	Loss: 2.8626911640167236	recon_loss: 0.07223493605852127	bpp_loss: 2.1403417587280273	aux_loss: 0.22542262077331543
21:15:39 INFO - main: Train iter. 42000/200000 (21.0%): 	Loss: 2.8682570457458496	recon_loss: 0.07238155603408813	bpp_loss: 2.144441604614258	aux_loss: 0.2822684049606323
21:21:14 INFO - main: Train iter. 43000/200000 (21.5%): 	Loss: 2.869081974029541	recon_loss: 0.07213538885116577	bpp_loss: 2.147728204727173	aux_loss: 0.16405904293060303
21:26:48 INFO - main: Train iter. 44000/200000 (22.0%): 	Loss: 2.8651537895202637	recon_loss: 0.07223723828792572	bpp_loss: 2.1427814960479736	aux_loss: 0.12903088331222534
21:32:20 INFO - main: Train iter. 45000/200000 (22.5%): 	Loss: 2.8775362968444824	recon_loss: 0.0725320428609848	bpp_loss: 2.1522157192230225	aux_loss: 0.6121143102645874
21:32:31 INFO - main: {'TEST MSE': 0.07245543035366783, 'TEST BPP': 2.158984375, 'TEST loss': 2.871529366970062, 'TEST recon_loss': 0.0724554327353835, 'TEST bpp_loss': 2.14697503554821}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
21:38:05 INFO - main: Train iter. 46000/200000 (23.0%): 	Loss: 2.8565292358398438	recon_loss: 0.07234268635511398	bpp_loss: 2.1331024169921875	aux_loss: 0.4403225779533386
21:43:40 INFO - main: Train iter. 47000/200000 (23.5%): 	Loss: 2.8717844486236572	recon_loss: 0.07220663875341415	bpp_loss: 2.1497180461883545	aux_loss: 0.16180452704429626
21:49:14 INFO - main: Train iter. 48000/200000 (24.0%): 	Loss: 2.8651466369628906	recon_loss: 0.07215726375579834	bpp_loss: 2.1435739994049072	aux_loss: 0.39775100350379944
21:54:46 INFO - main: Train iter. 49000/200000 (24.5%): 	Loss: 2.8798301219940186	recon_loss: 0.07225877791643143	bpp_loss: 2.1572422981262207	aux_loss: 0.6144719123840332
22:00:22 INFO - main: Train iter. 50000/200000 (25.0%): 	Loss: 2.873547315597534	recon_loss: 0.07230444252490997	bpp_loss: 2.150502920150757	aux_loss: 0.25970131158828735
22:00:33 INFO - main: {'TEST MSE': 0.07225101984354065, 'TEST BPP': 2.1609609375, 'TEST loss': 2.8712925627231596, 'TEST recon_loss': 0.07225102218240499, 'TEST bpp_loss': 2.1487823404073714}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:06:07 INFO - main: Train iter. 51000/200000 (25.5%): 	Loss: 2.8672587871551514	recon_loss: 0.07223469763994217	bpp_loss: 2.144911766052246	aux_loss: 0.26796436309814453
22:11:42 INFO - main: Train iter. 52000/200000 (26.0%): 	Loss: 2.862720012664795	recon_loss: 0.0719616487622261	bpp_loss: 2.14310359954834	aux_loss: 0.5765830874443054
22:17:15 INFO - main: Train iter. 53000/200000 (26.5%): 	Loss: 2.865903854370117	recon_loss: 0.07218850404024124	bpp_loss: 2.1440188884735107	aux_loss: 0.3487270474433899
22:22:50 INFO - main: Train iter. 54000/200000 (27.0%): 	Loss: 2.8672642707824707	recon_loss: 0.07232806086540222	bpp_loss: 2.1439836025238037	aux_loss: 0.15499147772789001
22:28:25 INFO - main: Train iter. 55000/200000 (27.5%): 	Loss: 2.864624500274658	recon_loss: 0.0721513032913208	bpp_loss: 2.14311146736145	aux_loss: 0.3348112404346466
22:28:35 INFO - main: {'TEST MSE': 0.07230120455884252, 'TEST BPP': 2.16, 'TEST loss': 2.870987025976181, 'TEST recon_loss': 0.07230120716243982, 'TEST bpp_loss': 2.1479749547243117}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:34:07 INFO - main: Train iter. 56000/200000 (28.0%): 	Loss: 2.8624491691589355	recon_loss: 0.0721978172659874	bpp_loss: 2.1404709815979004	aux_loss: 0.221889466047287
22:39:42 INFO - main: Train iter. 57000/200000 (28.5%): 	Loss: 2.8666863441467285	recon_loss: 0.07216799259185791	bpp_loss: 2.1450064182281494	aux_loss: 0.24307619035243988
22:45:17 INFO - main: Train iter. 58000/200000 (29.0%): 	Loss: 2.8676671981811523	recon_loss: 0.07230853289365768	bpp_loss: 2.1445817947387695	aux_loss: 0.16653704643249512
22:50:51 INFO - main: Train iter. 59000/200000 (29.5%): 	Loss: 2.8556923866271973	recon_loss: 0.07225073128938675	bpp_loss: 2.1331851482391357	aux_loss: 0.2844521403312683
22:56:24 INFO - main: Train iter. 60000/200000 (30.0%): 	Loss: 2.865837335586548	recon_loss: 0.07225790619850159	bpp_loss: 2.1432583332061768	aux_loss: 0.3387441635131836
22:56:35 INFO - main: {'TEST MSE': 0.07234025330740533, 'TEST BPP': 2.1597734375, 'TEST loss': 2.8710992319583895, 'TEST recon_loss': 0.0723402558118105, 'TEST bpp_loss': 2.147696672797203}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
23:02:09 INFO - main: Train iter. 61000/200000 (30.5%): 	Loss: 2.875199556350708	recon_loss: 0.07240674644708633	bpp_loss: 2.151132106781006	aux_loss: 0.22606390714645386
23:07:44 INFO - main: Train iter. 62000/200000 (31.0%): 	Loss: 2.8564586639404297	recon_loss: 0.0718802735209465	bpp_loss: 2.1376559734344482	aux_loss: 0.528972327709198
23:13:19 INFO - main: Train iter. 63000/200000 (31.5%): 	Loss: 2.8762950897216797	recon_loss: 0.07233584672212601	bpp_loss: 2.1529366970062256	aux_loss: 0.21709750592708588
23:18:52 INFO - main: Train iter. 64000/200000 (32.0%): 	Loss: 2.871356964111328	recon_loss: 0.07230981439352036	bpp_loss: 2.148258686065674	aux_loss: 0.2746806740760803
23:24:27 INFO - main: Train iter. 65000/200000 (32.5%): 	Loss: 2.8769896030426025	recon_loss: 0.07237189263105392	bpp_loss: 2.153270721435547	aux_loss: 0.2377157211303711
23:24:38 INFO - main: {'TEST MSE': 0.07235392521957952, 'TEST BPP': 2.159625, 'TEST loss': 2.87105641412735, 'TEST recon_loss': 0.07235392761975527, 'TEST bpp_loss': 2.147517138361931}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
23:30:12 INFO - main: Train iter. 66000/200000 (33.0%): 	Loss: 2.874680757522583	recon_loss: 0.07242845743894577	bpp_loss: 2.1503961086273193	aux_loss: 0.12196309864521027
23:35:48 INFO - main: Train iter. 67000/200000 (33.5%): 	Loss: 2.8699214458465576	recon_loss: 0.07237409800291061	bpp_loss: 2.1461803913116455	aux_loss: 0.37951767444610596
23:41:20 INFO - main: Train iter. 68000/200000 (34.0%): 	Loss: 2.868076801300049	recon_loss: 0.07229054719209671	bpp_loss: 2.1451714038848877	aux_loss: 0.3212629556655884
23:46:55 INFO - main: Train iter. 69000/200000 (34.5%): 	Loss: 2.8704538345336914	recon_loss: 0.07206550240516663	bpp_loss: 2.14979887008667	aux_loss: 0.37834131717681885
23:52:30 INFO - main: Train iter. 70000/200000 (35.0%): 	Loss: 2.8719265460968018	recon_loss: 0.07242479920387268	bpp_loss: 2.1476786136627197	aux_loss: 0.28310075402259827
23:52:41 INFO - main: {'TEST MSE': 0.07235445068924813, 'TEST BPP': 2.1595546875, 'TEST loss': 2.871231463432312, 'TEST recon_loss': 0.07235445315390825, 'TEST bpp_loss': 2.1476869300603867}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
23:58:13 INFO - main: Train iter. 71000/200000 (35.5%): 	Loss: 2.8693387508392334	recon_loss: 0.072352334856987	bpp_loss: 2.145815372467041	aux_loss: 0.23830941319465637
00:03:48 INFO - main: Train iter. 72000/200000 (36.0%): 	Loss: 2.8689026832580566	recon_loss: 0.07203659415245056	bpp_loss: 2.1485366821289062	aux_loss: 0.45353269577026367
00:09:23 INFO - main: Train iter. 73000/200000 (36.5%): 	Loss: 2.8688302040100098	recon_loss: 0.07223089784383774	bpp_loss: 2.1465213298797607	aux_loss: 0.21906328201293945
00:14:58 INFO - main: Train iter. 74000/200000 (37.0%): 	Loss: 2.868007183074951	recon_loss: 0.07219900190830231	bpp_loss: 2.146017074584961	aux_loss: 0.26933082938194275
00:20:32 INFO - main: Train iter. 75000/200000 (37.5%): 	Loss: 2.8679513931274414	recon_loss: 0.07207398861646652	bpp_loss: 2.1472115516662598	aux_loss: 0.511099636554718
00:20:43 INFO - main: {'TEST MSE': 0.07213145539227349, 'TEST BPP': 2.162296875, 'TEST loss': 2.8715530219078063, 'TEST recon_loss': 0.07213145782798529, 'TEST bpp_loss': 2.150238443851471}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
00:26:17 INFO - main: Train iter. 76000/200000 (38.0%): 	Loss: 2.8721582889556885	recon_loss: 0.07235489040613174	bpp_loss: 2.1486093997955322	aux_loss: 0.41348856687545776
00:31:52 INFO - main: Train iter. 77000/200000 (38.5%): 	Loss: 2.8668148517608643	recon_loss: 0.07234961539506912	bpp_loss: 2.1433186531066895	aux_loss: 0.38014715909957886
00:37:26 INFO - main: Train iter. 78000/200000 (39.0%): 	Loss: 2.867539882659912	recon_loss: 0.07224096357822418	bpp_loss: 2.1451303958892822	aux_loss: 0.23112018406391144
00:42:59 INFO - main: Train iter. 79000/200000 (39.5%): 	Loss: 2.864929676055908	recon_loss: 0.07229546457529068	bpp_loss: 2.141975164413452	aux_loss: 0.27280205488204956
00:48:34 INFO - main: Train iter. 80000/200000 (40.0%): 	Loss: 2.8684263229370117	recon_loss: 0.0722607746720314	bpp_loss: 2.1458184719085693	aux_loss: 0.2902829647064209
00:48:44 INFO - main: {'TEST MSE': 0.07235954841981426, 'TEST BPP': 2.159734375, 'TEST loss': 2.8713423957824706, 'TEST recon_loss': 0.0723595507517457, 'TEST bpp_loss': 2.147746888399124}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
00:54:18 INFO - main: Train iter. 81000/200000 (40.5%): 	Loss: 2.8674869537353516	recon_loss: 0.07207006961107254	bpp_loss: 2.1467862129211426	aux_loss: 0.4822414517402649
00:59:50 INFO - main: Train iter. 82000/200000 (41.0%): 	Loss: 2.8573694229125977	recon_loss: 0.07190770655870438	bpp_loss: 2.1382923126220703	aux_loss: 0.6346436738967896
01:05:26 INFO - main: Train iter. 83000/200000 (41.5%): 	Loss: 2.867159843444824	recon_loss: 0.07208891957998276	bpp_loss: 2.146270751953125	aux_loss: 0.3006431758403778
01:11:00 INFO - main: Train iter. 84000/200000 (42.0%): 	Loss: 2.8717517852783203	recon_loss: 0.0721733570098877	bpp_loss: 2.1500182151794434	aux_loss: 0.4596114754676819
01:16:35 INFO - main: Train iter. 85000/200000 (42.5%): 	Loss: 2.867525815963745	recon_loss: 0.07220859080553055	bpp_loss: 2.145439863204956	aux_loss: 0.22964593768119812
01:16:46 INFO - main: {'TEST MSE': 0.07225484726779074, 'TEST BPP': 2.161046875, 'TEST loss': 2.8715518054962157, 'TEST recon_loss': 0.07225484969466925, 'TEST bpp_loss': 2.149003311038017}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
01:22:18 INFO - main: Train iter. 86000/200000 (43.0%): 	Loss: 2.8684024810791016	recon_loss: 0.0721639022231102	bpp_loss: 2.146763324737549	aux_loss: 0.19842804968357086
01:27:52 INFO - main: Train iter. 87000/200000 (43.5%): 	Loss: 2.86820650100708	recon_loss: 0.0722842663526535	bpp_loss: 2.1453638076782227	aux_loss: 0.15677908062934875
01:33:27 INFO - main: Train iter. 88000/200000 (44.0%): 	Loss: 2.8523025512695312	recon_loss: 0.0719299167394638	bpp_loss: 2.1330034732818604	aux_loss: 0.26706016063690186
01:39:02 INFO - main: Train iter. 89000/200000 (44.5%): 	Loss: 2.8599472045898438	recon_loss: 0.07220412790775299	bpp_loss: 2.1379058361053467	aux_loss: 0.24095405638217926
01:44:34 INFO - main: Train iter. 90000/200000 (45.0%): 	Loss: 2.87734055519104	recon_loss: 0.0723119005560875	bpp_loss: 2.154221534729004	aux_loss: 0.3380870819091797
01:44:45 INFO - main: {'TEST MSE': 0.07231633614339532, 'TEST BPP': 2.160375, 'TEST loss': 2.8715816404819487, 'TEST recon_loss': 0.0723163385912776, 'TEST bpp_loss': 2.1484182521104813}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
01:50:19 INFO - main: Train iter. 91000/200000 (45.5%): 	Loss: 2.8658604621887207	recon_loss: 0.07217884063720703	bpp_loss: 2.1440720558166504	aux_loss: 0.1707659661769867
01:55:53 INFO - main: Train iter. 92000/200000 (46.0%): 	Loss: 2.86968994140625	recon_loss: 0.07207946479320526	bpp_loss: 2.148895263671875	aux_loss: 0.36197617650032043
02:01:28 INFO - main: Train iter. 93000/200000 (46.5%): 	Loss: 2.872626781463623	recon_loss: 0.07227951288223267	bpp_loss: 2.149831533432007	aux_loss: 0.34249335527420044
02:07:01 INFO - main: Train iter. 94000/200000 (47.0%): 	Loss: 2.8629579544067383	recon_loss: 0.07206624746322632	bpp_loss: 2.1422953605651855	aux_loss: 0.20061571896076202
02:12:35 INFO - main: Train iter. 95000/200000 (47.5%): 	Loss: 2.8615360260009766	recon_loss: 0.07207407802343369	bpp_loss: 2.1407952308654785	aux_loss: 0.14334598183631897
02:12:45 INFO - main: {'TEST MSE': 0.07225197423732967, 'TEST BPP': 2.1609921875, 'TEST loss': 2.871457827329636, 'TEST recon_loss': 0.07225197680294514, 'TEST bpp_loss': 2.1489380543231964}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
02:18:20 INFO - main: Train iter. 96000/200000 (48.0%): 	Loss: 2.858779191970825	recon_loss: 0.07218733429908752	bpp_loss: 2.1369059085845947	aux_loss: 0.15695463120937347
02:23:52 INFO - main: Train iter. 97000/200000 (48.5%): 	Loss: 2.8652737140655518	recon_loss: 0.07231993973255157	bpp_loss: 2.1420743465423584	aux_loss: 0.40724897384643555
02:29:27 INFO - main: Train iter. 98000/200000 (49.0%): 	Loss: 2.8731870651245117	recon_loss: 0.07232904434204102	bpp_loss: 2.1498966217041016	aux_loss: 0.18658991158008575
02:35:02 INFO - main: Train iter. 99000/200000 (49.5%): 	Loss: 2.8592801094055176	recon_loss: 0.07205425947904587	bpp_loss: 2.138737440109253	aux_loss: 0.2466774880886078
02:40:38 INFO - main: Train iter. 100000/200000 (50.0%): 	Loss: 2.867424488067627	recon_loss: 0.07203465700149536	bpp_loss: 2.147077798843384	aux_loss: 0.56824791431427
02:40:49 INFO - main: {'TEST MSE': 0.07209965142443836, 'TEST BPP': 2.1625078125, 'TEST loss': 2.8714372918605804, 'TEST recon_loss': 0.07209965389221906, 'TEST bpp_loss': 2.150440750360489}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
02:46:21 INFO - main: Train iter. 101000/200000 (50.5%): 	Loss: 2.8640809059143066	recon_loss: 0.07215064764022827	bpp_loss: 2.1425745487213135	aux_loss: 0.16666077077388763
02:51:57 INFO - main: Train iter. 102000/200000 (51.0%): 	Loss: 2.864673137664795	recon_loss: 0.07211992144584656	bpp_loss: 2.1434738636016846	aux_loss: 0.19587871432304382
02:57:33 INFO - main: Train iter. 103000/200000 (51.5%): 	Loss: 2.8615825176239014	recon_loss: 0.07206856459379196	bpp_loss: 2.140896797180176	aux_loss: 0.13827167451381683
03:03:08 INFO - main: Train iter. 104000/200000 (52.0%): 	Loss: 2.853029727935791	recon_loss: 0.07188692688941956	bpp_loss: 2.1341605186462402	aux_loss: 0.2013520896434784
03:08:42 INFO - main: Train iter. 105000/200000 (52.5%): 	Loss: 2.8665225505828857	recon_loss: 0.07219748198986053	bpp_loss: 2.144547700881958	aux_loss: 0.23365607857704163
03:08:52 INFO - main: {'TEST MSE': 0.07229908273335363, 'TEST BPP': 2.1603828125, 'TEST loss': 2.871420300483704, 'TEST recon_loss': 0.07229908508807421, 'TEST bpp_loss': 2.1484294526576995}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
03:14:27 INFO - main: Train iter. 106000/200000 (53.0%): 	Loss: 2.863516330718994	recon_loss: 0.07214051485061646	bpp_loss: 2.14211106300354	aux_loss: 0.20521220564842224
03:20:02 INFO - main: Train iter. 107000/200000 (53.5%): 	Loss: 2.86676287651062	recon_loss: 0.07226114720106125	bpp_loss: 2.144151449203491	aux_loss: 0.1688060760498047
03:25:36 INFO - main: Train iter. 108000/200000 (54.0%): 	Loss: 2.8638689517974854	recon_loss: 0.07216235995292664	bpp_loss: 2.142245292663574	aux_loss: 0.28256693482398987
03:31:09 INFO - main: Train iter. 109000/200000 (54.5%): 	Loss: 2.8561763763427734	recon_loss: 0.07217495143413544	bpp_loss: 2.1344268321990967	aux_loss: 0.25462234020233154
03:36:43 INFO - main: Train iter. 110000/200000 (55.0%): 	Loss: 2.8662314414978027	recon_loss: 0.07232578843832016	bpp_loss: 2.1429736614227295	aux_loss: 0.5384459495544434
03:36:54 INFO - main: {'TEST MSE': 0.07244899149316292, 'TEST BPP': 2.158921875, 'TEST loss': 2.8714363656044006, 'TEST recon_loss': 0.0724489939659834, 'TEST bpp_loss': 2.1469464254379274}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
03:42:27 INFO - main: Train iter. 111000/200000 (55.5%): 	Loss: 2.8638105392456055	recon_loss: 0.07206233590841293	bpp_loss: 2.1431870460510254	aux_loss: 0.20941738784313202
03:48:00 INFO - main: Train iter. 112000/200000 (56.0%): 	Loss: 2.865934371948242	recon_loss: 0.07203768193721771	bpp_loss: 2.145557403564453	aux_loss: 0.43641674518585205
03:53:37 INFO - main: Train iter. 113000/200000 (56.5%): 	Loss: 2.8620617389678955	recon_loss: 0.07200288772583008	bpp_loss: 2.1420328617095947	aux_loss: 0.36762797832489014
03:59:15 INFO - main: Train iter. 114000/200000 (57.0%): 	Loss: 2.883413791656494	recon_loss: 0.07227793335914612	bpp_loss: 2.1606345176696777	aux_loss: 0.3351849913597107
04:04:51 INFO - main: Train iter. 115000/200000 (57.5%): 	Loss: 2.8652219772338867	recon_loss: 0.07228437811136246	bpp_loss: 2.142378330230713	aux_loss: 0.5111978650093079
04:05:02 INFO - main: {'TEST MSE': 0.07244121076556381, 'TEST BPP': 2.1593203125, 'TEST loss': 2.8715075290203096, 'TEST recon_loss': 0.07244121310859919, 'TEST bpp_loss': 2.1470954039096832}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
04:10:37 INFO - main: Train iter. 116000/200000 (58.0%): 	Loss: 2.8534975051879883	recon_loss: 0.07204201817512512	bpp_loss: 2.133077383041382	aux_loss: 0.24784259498119354
04:16:12 INFO - main: Train iter. 117000/200000 (58.5%): 	Loss: 2.8752453327178955	recon_loss: 0.07231273502111435	bpp_loss: 2.152117967605591	aux_loss: 0.2311408519744873
04:21:48 INFO - main: Train iter. 118000/200000 (59.0%): 	Loss: 2.8569540977478027	recon_loss: 0.07203315198421478	bpp_loss: 2.136622667312622	aux_loss: 0.41329720616340637
04:27:24 INFO - main: Train iter. 119000/200000 (59.5%): 	Loss: 2.865675687789917	recon_loss: 0.0721706822514534	bpp_loss: 2.1439688205718994	aux_loss: 0.2065316140651703
04:32:59 INFO - main: Train iter. 120000/200000 (60.0%): 	Loss: 2.863481044769287	recon_loss: 0.07224464416503906	bpp_loss: 2.1410346031188965	aux_loss: 0.3364863991737366
04:33:09 INFO - main: {'TEST MSE': 0.072403806396969, 'TEST BPP': 2.1595703125, 'TEST loss': 2.8714791657924654, 'TEST recon_loss': 0.07240380880981684, 'TEST bpp_loss': 2.1474410749673845}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
04:38:44 INFO - main: Train iter. 121000/200000 (60.5%): 	Loss: 2.8699445724487305	recon_loss: 0.07230252772569656	bpp_loss: 2.1469192504882812	aux_loss: 0.2356266975402832
04:44:19 INFO - main: Train iter. 122000/200000 (61.0%): 	Loss: 2.872986316680908	recon_loss: 0.07236726582050323	bpp_loss: 2.1493136882781982	aux_loss: 0.5000452399253845
04:49:52 INFO - main: Train iter. 123000/200000 (61.5%): 	Loss: 2.8675355911254883	recon_loss: 0.07234735041856766	bpp_loss: 2.144062042236328	aux_loss: 0.23258821666240692
04:55:28 INFO - main: Train iter. 124000/200000 (62.0%): 	Loss: 2.865065574645996	recon_loss: 0.07235212624073029	bpp_loss: 2.1415443420410156	aux_loss: 0.4446442723274231
Terminated
