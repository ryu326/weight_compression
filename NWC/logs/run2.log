/opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
17:23:34 INFO - logger_setup: /workspace/Weight_compression/NWC/utils/util.py
17:23:34 INFO - before_main: Create new exp folder!
17:23:34 INFO - before_main: seed : 100
17:23:34 INFO - before_main: exp name : block_seq_scaler_meta-llama--Llama-2-7b-hf__scaled3_RHT_sig0.0001_col_4096.pt/lmbda100_rdloss_size16_encdim512_M16_Q0_R0_m0_batch_size1024_total_iter200000_lr0.0001_seed100
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ryu326 (maskedkd) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /workspace/Weight_compression/NWC/wandb/run-20250324_172334-s70z6vab
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run nwc
wandb: ‚≠êÔ∏è View project at https://wandb.ai/maskedkd/NWC_VQVAE
wandb: üöÄ View run at https://wandb.ai/maskedkd/NWC_VQVAE/runs/s70z6vab
17:23:35 INFO - main: Create experiment save folder
{'entropy_bottleneck.quantiles'}
17:23:46 INFO - main: Training mode : scratch!
17:23:46 INFO - main: batch_size : 1024
17:23:46 INFO - main: num of gpus: 1
17:23:46 INFO - main: Namespace(iter=200000, dataset='block_seq', dataset_path='../Wparam_dataset/block_pt/meta-llama--Llama-2-7b-hf/scaled3_RHT_sig0.0001_col_4096.pt', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=1024, seed=100, input_size=16, dim_encoder=512, n_resblock=4, M=16, N=0, R=0, m=0, Q=0, clip_max_norm=1.0, save_dir='', architecture='nwc', loss='rdloss', checkpoint='None', lmbda=100, dataset_stat_type='scaler', save_path='./checkpoint/nwc/block_seq_scaler_meta-llama--Llama-2-7b-hf__scaled3_RHT_sig0.0001_col_4096.pt/lmbda100_rdloss_size16_encdim512_M16_Q0_R0_m0_batch_size1024_total_iter200000_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:23:48 INFO - main: Train iter. 1/200000 (0.0005%): 	Loss: 304.004638671875	recon_loss: 2.9862284660339355	bpp_loss: 5.381791591644287	aux_loss: 658.1146850585938
17:23:59 INFO - main: {'TEST MSE': 2.0332521009414815, 'TEST BPP': 5.390625, 'TEST loss': 208.7062074737549, 'TEST recon_loss': 2.033252168416977, 'TEST bpp_loss': 5.380990894317627}
17:23:59 INFO - main: can not find prev_mse_best_model!
17:23:59 INFO - main: can not find prev_bpp_best_model!
17:23:59 INFO - main: can not find prev_bpp_best_model!
17:23:59 INFO - main: can not find recent_saved_model!
/workspace/Weight_compression/NWC/train_nwc.py:422: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  csv_file = pd.concat([csv_file, pd.DataFrame([new_row])], ignore_index=True)
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:29:23 INFO - main: Train iter. 1000/200000 (0.5%): 	Loss: 5.293476104736328	recon_loss: 0.00724846962839365	bpp_loss: 4.568629264831543	aux_loss: 624.1787109375
17:34:51 INFO - main: Train iter. 2000/200000 (1.0%): 	Loss: 4.7411651611328125	recon_loss: 0.006364704109728336	bpp_loss: 4.104694843292236	aux_loss: 575.2166137695312
17:40:19 INFO - main: Train iter. 3000/200000 (1.5%): 	Loss: 4.631260395050049	recon_loss: 0.007186605595052242	bpp_loss: 3.912599802017212	aux_loss: 531.5327758789062
17:45:45 INFO - main: Train iter. 4000/200000 (2.0%): 	Loss: 4.61301851272583	recon_loss: 0.007555811665952206	bpp_loss: 3.8574373722076416	aux_loss: 503.4535827636719
17:51:12 INFO - main: Train iter. 5000/200000 (2.5%): 	Loss: 4.62921142578125	recon_loss: 0.007866761647164822	bpp_loss: 3.8425354957580566	aux_loss: 482.5718688964844
17:51:23 INFO - main: {'TEST MSE': 0.007907999250530387, 'TEST BPP': 3.856515625, 'TEST loss': 4.634481791019439, 'TEST recon_loss': 0.007907999511808157, 'TEST bpp_loss': 3.843681842803955}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
17:56:50 INFO - main: Train iter. 6000/200000 (3.0%): 	Loss: 4.594789981842041	recon_loss: 0.007562548387795687	bpp_loss: 3.8385350704193115	aux_loss: 458.32598876953125
18:02:18 INFO - main: Train iter. 7000/200000 (3.5%): 	Loss: 4.558985710144043	recon_loss: 0.007438987493515015	bpp_loss: 3.815087080001831	aux_loss: 427.07257080078125
18:07:44 INFO - main: Train iter. 8000/200000 (4.0%): 	Loss: 4.569003582000732	recon_loss: 0.007442972157150507	bpp_loss: 3.8247063159942627	aux_loss: 386.46600341796875
18:13:11 INFO - main: Train iter. 9000/200000 (4.5%): 	Loss: 4.557520389556885	recon_loss: 0.00744929164648056	bpp_loss: 3.812591075897217	aux_loss: 337.49169921875
18:18:39 INFO - main: Train iter. 10000/200000 (5.0%): 	Loss: 4.550839424133301	recon_loss: 0.007411230821162462	bpp_loss: 3.80971622467041	aux_loss: 291.1669616699219
18:18:50 INFO - main: {'TEST MSE': 0.007439276327572176, 'TEST BPP': 3.821515625, 'TEST loss': 4.553509863853455, 'TEST recon_loss': 0.007439276571851223, 'TEST bpp_loss': 3.809582211971283}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
18:24:17 INFO - main: Train iter. 11000/200000 (5.5%): 	Loss: 4.553706169128418	recon_loss: 0.007429356686770916	bpp_loss: 3.8107705116271973	aux_loss: 254.8064422607422
18:29:43 INFO - main: Train iter. 12000/200000 (6.0%): 	Loss: 4.535318851470947	recon_loss: 0.0074290623888373375	bpp_loss: 3.792412757873535	aux_loss: 225.04144287109375
18:35:10 INFO - main: Train iter. 13000/200000 (6.5%): 	Loss: 4.544772148132324	recon_loss: 0.0073846857994794846	bpp_loss: 3.8063035011291504	aux_loss: 198.2098388671875
18:40:38 INFO - main: Train iter. 14000/200000 (7.0%): 	Loss: 4.54462194442749	recon_loss: 0.007460928987711668	bpp_loss: 3.7985291481018066	aux_loss: 171.7933349609375
18:46:04 INFO - main: Train iter. 15000/200000 (7.5%): 	Loss: 4.542374134063721	recon_loss: 0.0073046814650297165	bpp_loss: 3.811905860900879	aux_loss: 145.73500061035156
18:46:15 INFO - main: {'TEST MSE': 0.007447351031327555, 'TEST BPP': 3.821109375, 'TEST loss': 4.553588559627533, 'TEST recon_loss': 0.007447351279202849, 'TEST bpp_loss': 3.8088534331321715}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
18:51:41 INFO - main: Train iter. 16000/200000 (8.0%): 	Loss: 4.5357160568237305	recon_loss: 0.007355946581810713	bpp_loss: 3.800121307373047	aux_loss: 118.96073913574219
18:57:09 INFO - main: Train iter. 17000/200000 (8.5%): 	Loss: 4.54954719543457	recon_loss: 0.007379550486803055	bpp_loss: 3.8115923404693604	aux_loss: 94.8328857421875
19:02:37 INFO - main: Train iter. 18000/200000 (9.0%): 	Loss: 4.5389204025268555	recon_loss: 0.007339118514209986	bpp_loss: 3.8050084114074707	aux_loss: 71.53469848632812
19:08:03 INFO - main: Train iter. 19000/200000 (9.5%): 	Loss: 4.5486836433410645	recon_loss: 0.0073346965946257114	bpp_loss: 3.815214157104492	aux_loss: 50.36168670654297
19:13:31 INFO - main: Train iter. 20000/200000 (10.0%): 	Loss: 4.575861930847168	recon_loss: 0.0076507022604346275	bpp_loss: 3.8107919692993164	aux_loss: 34.26227569580078
19:13:42 INFO - main: {'TEST MSE': 0.007335700774770011, 'TEST BPP': 3.82396875, 'TEST loss': 4.5448409872055056, 'TEST recon_loss': 0.007335701022297144, 'TEST bpp_loss': 3.8112708778381346}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
19:19:08 INFO - main: Train iter. 21000/200000 (10.5%): 	Loss: 4.542547225952148	recon_loss: 0.007324449717998505	bpp_loss: 3.8101024627685547	aux_loss: 19.823518753051758
19:24:35 INFO - main: Train iter. 22000/200000 (11.0%): 	Loss: 4.550180912017822	recon_loss: 0.007420728914439678	bpp_loss: 3.808107852935791	aux_loss: 11.800394058227539
19:30:01 INFO - main: Train iter. 23000/200000 (11.5%): 	Loss: 4.561174392700195	recon_loss: 0.007580440957099199	bpp_loss: 3.8031301498413086	aux_loss: 5.711217880249023
19:35:28 INFO - main: Train iter. 24000/200000 (12.0%): 	Loss: 4.535717010498047	recon_loss: 0.007317389361560345	bpp_loss: 3.8039779663085938	aux_loss: 1.6319472789764404
19:40:55 INFO - main: Train iter. 25000/200000 (12.5%): 	Loss: 4.5438313484191895	recon_loss: 0.007313207723200321	bpp_loss: 3.8125107288360596	aux_loss: 1.3864266872406006
19:41:06 INFO - main: {'TEST MSE': 0.007348980578065644, 'TEST BPP': 3.8233359375, 'TEST loss': 4.545039953708649, 'TEST recon_loss': 0.0073489808305166665, 'TEST bpp_loss': 3.810141873598099}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
19:46:34 INFO - main: Train iter. 26000/200000 (13.0%): 	Loss: 4.529611587524414	recon_loss: 0.00728489039465785	bpp_loss: 3.8011226654052734	aux_loss: 1.6857291460037231
19:51:58 INFO - main: Train iter. 27000/200000 (13.5%): 	Loss: 4.546342849731445	recon_loss: 0.00732098612934351	bpp_loss: 3.814244270324707	aux_loss: 0.5487920045852661
19:57:26 INFO - main: Train iter. 28000/200000 (14.0%): 	Loss: 4.55154275894165	recon_loss: 0.007455476559698582	bpp_loss: 3.805995225906372	aux_loss: 0.3624172806739807
20:02:54 INFO - main: Train iter. 29000/200000 (14.5%): 	Loss: 4.541657447814941	recon_loss: 0.007307269610464573	bpp_loss: 3.8109304904937744	aux_loss: 0.3681081235408783
20:08:19 INFO - main: Train iter. 30000/200000 (15.0%): 	Loss: 4.536674499511719	recon_loss: 0.007280187215656042	bpp_loss: 3.8086557388305664	aux_loss: 0.26883962750434875
20:08:30 INFO - main: {'TEST MSE': 0.007289296093131606, 'TEST BPP': 3.825078125, 'TEST loss': 4.540779870510101, 'TEST recon_loss': 0.007289296333212405, 'TEST bpp_loss': 3.8118502433300017}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
20:13:57 INFO - main: Train iter. 31000/200000 (15.5%): 	Loss: 4.531498432159424	recon_loss: 0.007377249654382467	bpp_loss: 3.7937734127044678	aux_loss: 1.6940922737121582
20:19:24 INFO - main: Train iter. 32000/200000 (16.0%): 	Loss: 4.5484514236450195	recon_loss: 0.007325043901801109	bpp_loss: 3.8159468173980713	aux_loss: 0.2839289903640747
20:24:52 INFO - main: Train iter. 33000/200000 (16.5%): 	Loss: 4.534404754638672	recon_loss: 0.0073215551674366	bpp_loss: 3.8022494316101074	aux_loss: 0.4350782036781311
20:30:17 INFO - main: Train iter. 34000/200000 (17.0%): 	Loss: 4.541408538818359	recon_loss: 0.007305079605430365	bpp_loss: 3.8109004497528076	aux_loss: 0.42375102639198303
20:35:45 INFO - main: Train iter. 35000/200000 (17.5%): 	Loss: 4.5582275390625	recon_loss: 0.007490903604775667	bpp_loss: 3.8091371059417725	aux_loss: 0.37393513321876526
20:35:56 INFO - main: {'TEST MSE': 0.007263585853677418, 'TEST BPP': 3.8255, 'TEST loss': 4.538477090835571, 'TEST recon_loss': 0.00726358609739691, 'TEST bpp_loss': 3.8121184799671175}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
20:41:23 INFO - main: Train iter. 36000/200000 (18.0%): 	Loss: 4.534695625305176	recon_loss: 0.007357587106525898	bpp_loss: 3.7989370822906494	aux_loss: 0.3980844020843506
20:46:50 INFO - main: Train iter. 37000/200000 (18.5%): 	Loss: 4.5373945236206055	recon_loss: 0.007376873400062323	bpp_loss: 3.7997071743011475	aux_loss: 0.45776742696762085
20:52:16 INFO - main: Train iter. 38000/200000 (19.0%): 	Loss: 4.554930686950684	recon_loss: 0.007424721494317055	bpp_loss: 3.8124587535858154	aux_loss: 0.3605138659477234
20:57:43 INFO - main: Train iter. 39000/200000 (19.5%): 	Loss: 4.541367530822754	recon_loss: 0.007281056605279446	bpp_loss: 3.8132619857788086	aux_loss: 0.574315071105957
21:03:11 INFO - main: Train iter. 40000/200000 (20.0%): 	Loss: 4.541422367095947	recon_loss: 0.007276981137692928	bpp_loss: 3.8137242794036865	aux_loss: 0.454317569732666
21:03:22 INFO - main: {'TEST MSE': 0.007256072038490048, 'TEST BPP': 3.825234375, 'TEST loss': 4.537602883338928, 'TEST recon_loss': 0.007256072280928493, 'TEST bpp_loss': 3.811995651721954}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
21:08:46 INFO - main: Train iter. 41000/200000 (20.5%): 	Loss: 4.529191017150879	recon_loss: 0.007273804862052202	bpp_loss: 3.8018105030059814	aux_loss: 0.5362201929092407
21:14:14 INFO - main: Train iter. 42000/200000 (21.0%): 	Loss: 4.533204555511475	recon_loss: 0.007257462944835424	bpp_loss: 3.8074584007263184	aux_loss: 0.45942869782447815
21:19:41 INFO - main: Train iter. 43000/200000 (21.5%): 	Loss: 4.539252758026123	recon_loss: 0.007325613871216774	bpp_loss: 3.8066914081573486	aux_loss: 0.6023110151290894
21:25:09 INFO - main: Train iter. 44000/200000 (22.0%): 	Loss: 4.5309038162231445	recon_loss: 0.007257596589624882	bpp_loss: 3.8051443099975586	aux_loss: 0.2028781771659851
21:30:34 INFO - main: Train iter. 45000/200000 (22.5%): 	Loss: 4.544445991516113	recon_loss: 0.007265359163284302	bpp_loss: 3.8179099559783936	aux_loss: 0.23948797583580017
21:30:45 INFO - main: {'TEST MSE': 0.007272979363339972, 'TEST BPP': 3.825015625, 'TEST loss': 4.539157746791839, 'TEST recon_loss': 0.007272979600820691, 'TEST bpp_loss': 3.811859783411026}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
21:36:12 INFO - main: Train iter. 46000/200000 (23.0%): 	Loss: 4.522511005401611	recon_loss: 0.0072559635154902935	bpp_loss: 3.796914577484131	aux_loss: 0.3171093463897705
21:41:40 INFO - main: Train iter. 47000/200000 (23.5%): 	Loss: 4.540138244628906	recon_loss: 0.007278485223650932	bpp_loss: 3.8122894763946533	aux_loss: 0.6853727102279663
21:47:08 INFO - main: Train iter. 48000/200000 (24.0%): 	Loss: 4.534921169281006	recon_loss: 0.007296197582036257	bpp_loss: 3.8053014278411865	aux_loss: 0.6792775392532349
21:52:34 INFO - main: Train iter. 49000/200000 (24.5%): 	Loss: 4.547386169433594	recon_loss: 0.007267084438353777	bpp_loss: 3.8206777572631836	aux_loss: 1.069610834121704
21:58:03 INFO - main: Train iter. 50000/200000 (25.0%): 	Loss: 4.542611122131348	recon_loss: 0.0072800773195922375	bpp_loss: 3.814603328704834	aux_loss: 0.8762758374214172
21:58:14 INFO - main: {'TEST MSE': 0.007253448391190585, 'TEST BPP': 3.8257890625, 'TEST loss': 4.537886088371277, 'TEST recon_loss': 0.007253448638599366, 'TEST bpp_loss': 3.8125412197113038}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:03:41 INFO - main: Train iter. 51000/200000 (25.5%): 	Loss: 4.533106803894043	recon_loss: 0.007250186521559954	bpp_loss: 3.8080883026123047	aux_loss: 0.3727186322212219
22:09:09 INFO - main: Train iter. 52000/200000 (26.0%): 	Loss: 4.5348405838012695	recon_loss: 0.007311742287129164	bpp_loss: 3.803666353225708	aux_loss: 0.5011897087097168
22:14:34 INFO - main: Train iter. 53000/200000 (26.5%): 	Loss: 4.533529758453369	recon_loss: 0.007278811652213335	bpp_loss: 3.8056485652923584	aux_loss: 0.38294780254364014
22:20:02 INFO - main: Train iter. 54000/200000 (27.0%): 	Loss: 4.532573699951172	recon_loss: 0.007244737818837166	bpp_loss: 3.8080997467041016	aux_loss: 0.1967708170413971
22:25:30 INFO - main: Train iter. 55000/200000 (27.5%): 	Loss: 4.5322394371032715	recon_loss: 0.007271462585777044	bpp_loss: 3.805093288421631	aux_loss: 0.31917184591293335
22:25:41 INFO - main: {'TEST MSE': 0.00726466218016682, 'TEST BPP': 3.8244453125, 'TEST loss': 4.537752595424652, 'TEST recon_loss': 0.007264662424102426, 'TEST bpp_loss': 3.8112863597869873}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:31:06 INFO - main: Train iter. 56000/200000 (28.0%): 	Loss: 4.527774810791016	recon_loss: 0.007250333204865456	bpp_loss: 3.802741289138794	aux_loss: 0.237404927611351
22:36:35 INFO - main: Train iter. 57000/200000 (28.5%): 	Loss: 4.534237861633301	recon_loss: 0.007280205842107534	bpp_loss: 3.8062174320220947	aux_loss: 0.6172347068786621
22:42:02 INFO - main: Train iter. 58000/200000 (29.0%): 	Loss: 4.533414840698242	recon_loss: 0.007244074251502752	bpp_loss: 3.8090076446533203	aux_loss: 0.6137955188751221
22:47:30 INFO - main: Train iter. 59000/200000 (29.5%): 	Loss: 4.520899772644043	recon_loss: 0.007240354549139738	bpp_loss: 3.7968642711639404	aux_loss: 0.4227718114852905
22:52:55 INFO - main: Train iter. 60000/200000 (30.0%): 	Loss: 4.535338878631592	recon_loss: 0.007287914399057627	bpp_loss: 3.8065476417541504	aux_loss: 0.45327872037887573
22:53:06 INFO - main: {'TEST MSE': 0.007265109552255419, 'TEST BPP': 3.825015625, 'TEST loss': 4.538251895904541, 'TEST recon_loss': 0.0072651097942143675, 'TEST bpp_loss': 3.8117409195899965}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
22:58:33 INFO - main: Train iter. 61000/200000 (30.5%): 	Loss: 4.541707515716553	recon_loss: 0.007252077106386423	bpp_loss: 3.816499710083008	aux_loss: 0.4252403974533081
23:04:00 INFO - main: Train iter. 62000/200000 (31.0%): 	Loss: 4.522799968719482	recon_loss: 0.007250137161463499	bpp_loss: 3.797786235809326	aux_loss: 0.4631214141845703
23:09:28 INFO - main: Train iter. 63000/200000 (31.5%): 	Loss: 4.543024063110352	recon_loss: 0.007250776514410973	bpp_loss: 3.817946672439575	aux_loss: 0.2121748924255371
23:14:54 INFO - main: Train iter. 64000/200000 (32.0%): 	Loss: 4.539125919342041	recon_loss: 0.007263835985213518	bpp_loss: 3.8127424716949463	aux_loss: 0.8534365892410278
23:20:22 INFO - main: Train iter. 65000/200000 (32.5%): 	Loss: 4.545485019683838	recon_loss: 0.007266705855727196	bpp_loss: 3.818814277648926	aux_loss: 0.29280954599380493
23:20:33 INFO - main: {'TEST MSE': 0.007255693108990445, 'TEST BPP': 3.82571875, 'TEST loss': 4.537972297668457, 'TEST recon_loss': 0.0072556933518499135, 'TEST bpp_loss': 3.8124029569625852}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
23:26:00 INFO - main: Train iter. 66000/200000 (33.0%): 	Loss: 4.538878917694092	recon_loss: 0.0072460174560546875	bpp_loss: 3.814277172088623	aux_loss: 0.24815046787261963
23:31:28 INFO - main: Train iter. 67000/200000 (33.5%): 	Loss: 4.535820007324219	recon_loss: 0.007241108454763889	bpp_loss: 3.81170916557312	aux_loss: 0.29997289180755615
23:36:53 INFO - main: Train iter. 68000/200000 (34.0%): 	Loss: 4.536211013793945	recon_loss: 0.007281169760972261	bpp_loss: 3.8080942630767822	aux_loss: 0.9527684450149536
23:42:21 INFO - main: Train iter. 69000/200000 (34.5%): 	Loss: 4.535771369934082	recon_loss: 0.007239067927002907	bpp_loss: 3.8118643760681152	aux_loss: 0.32686465978622437
23:47:48 INFO - main: Train iter. 70000/200000 (35.0%): 	Loss: 4.537508487701416	recon_loss: 0.007245885673910379	bpp_loss: 3.812920093536377	aux_loss: 1.0541690587997437
23:47:59 INFO - main: {'TEST MSE': 0.007249174734389456, 'TEST BPP': 3.8255625, 'TEST loss': 4.53711828327179, 'TEST recon_loss': 0.007249174979515374, 'TEST bpp_loss': 3.812200782060623}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
23:53:25 INFO - main: Train iter. 71000/200000 (35.5%): 	Loss: 4.536045074462891	recon_loss: 0.007249790709465742	bpp_loss: 3.811065912246704	aux_loss: 0.35914525389671326
23:58:52 INFO - main: Train iter. 72000/200000 (36.0%): 	Loss: 4.53468132019043	recon_loss: 0.007232251577079296	bpp_loss: 3.8114559650421143	aux_loss: 0.8439471125602722
00:04:20 INFO - main: Train iter. 73000/200000 (36.5%): 	Loss: 4.535341262817383	recon_loss: 0.007255055475980043	bpp_loss: 3.809835910797119	aux_loss: 0.32087934017181396
00:09:47 INFO - main: Train iter. 74000/200000 (37.0%): 	Loss: 4.5345563888549805	recon_loss: 0.007260942831635475	bpp_loss: 3.808462142944336	aux_loss: 0.38512709736824036
00:15:12 INFO - main: Train iter. 75000/200000 (37.5%): 	Loss: 4.533835411071777	recon_loss: 0.007244039326906204	bpp_loss: 3.809431552886963	aux_loss: 0.3011164665222168
00:15:23 INFO - main: {'TEST MSE': 0.007240694477393181, 'TEST BPP': 3.8260859375, 'TEST loss': 4.536850175380707, 'TEST recon_loss': 0.007240694721229375, 'TEST bpp_loss': 3.8127807042598723}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
00:20:51 INFO - main: Train iter. 76000/200000 (38.0%): 	Loss: 4.537866592407227	recon_loss: 0.007246868219226599	bpp_loss: 3.8131799697875977	aux_loss: 0.7520283460617065
00:26:18 INFO - main: Train iter. 77000/200000 (38.5%): 	Loss: 4.532693386077881	recon_loss: 0.007251172326505184	bpp_loss: 3.8075761795043945	aux_loss: 0.9670673608779907
00:31:45 INFO - main: Train iter. 78000/200000 (39.0%): 	Loss: 4.533287525177002	recon_loss: 0.007256068289279938	bpp_loss: 3.807680606842041	aux_loss: 0.8870428800582886
00:37:10 INFO - main: Train iter. 79000/200000 (39.5%): 	Loss: 4.5297722816467285	recon_loss: 0.007241472601890564	bpp_loss: 3.8056252002716064	aux_loss: 0.5496841073036194
00:42:38 INFO - main: Train iter. 80000/200000 (40.0%): 	Loss: 4.535231113433838	recon_loss: 0.007263616658747196	bpp_loss: 3.8088693618774414	aux_loss: 0.4166606068611145
00:42:49 INFO - main: {'TEST MSE': 0.007292314699789242, 'TEST BPP': 3.8246953125, 'TEST loss': 4.540739644527435, 'TEST recon_loss': 0.007292314950376749, 'TEST bpp_loss': 3.811508149623871}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
00:48:16 INFO - main: Train iter. 81000/200000 (40.5%): 	Loss: 4.533163547515869	recon_loss: 0.007236109580844641	bpp_loss: 3.8095526695251465	aux_loss: 0.9435949921607971
00:53:41 INFO - main: Train iter. 82000/200000 (41.0%): 	Loss: 4.523275375366211	recon_loss: 0.007247099187225103	bpp_loss: 3.798565626144409	aux_loss: 0.5342034101486206
00:59:08 INFO - main: Train iter. 83000/200000 (41.5%): 	Loss: 4.533127307891846	recon_loss: 0.007237260229885578	bpp_loss: 3.809401273727417	aux_loss: 0.2902734875679016
01:04:36 INFO - main: Train iter. 84000/200000 (42.0%): 	Loss: 4.538426876068115	recon_loss: 0.007261142134666443	bpp_loss: 3.812312602996826	aux_loss: 0.27662211656570435
01:10:04 INFO - main: Train iter. 85000/200000 (42.5%): 	Loss: 4.533831596374512	recon_loss: 0.0072576976381242275	bpp_loss: 3.8080618381500244	aux_loss: 0.2542811632156372
01:10:15 INFO - main: {'TEST MSE': 0.007248918959458035, 'TEST BPP': 3.8251015625, 'TEST loss': 4.536756216526031, 'TEST recon_loss': 0.007248919207602739, 'TEST bpp_loss': 3.811864288330078}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
01:15:40 INFO - main: Train iter. 86000/200000 (43.0%): 	Loss: 4.5336079597473145	recon_loss: 0.007232654839754105	bpp_loss: 3.810342311859131	aux_loss: 0.31590670347213745
01:21:08 INFO - main: Train iter. 87000/200000 (43.5%): 	Loss: 4.53380012512207	recon_loss: 0.0072425007820129395	bpp_loss: 3.8095498085021973	aux_loss: 0.6180615425109863
01:26:36 INFO - main: Train iter. 88000/200000 (44.0%): 	Loss: 4.518518447875977	recon_loss: 0.007256851997226477	bpp_loss: 3.792833089828491	aux_loss: 1.0275094509124756
01:32:03 INFO - main: Train iter. 89000/200000 (44.5%): 	Loss: 4.526709079742432	recon_loss: 0.00725696561858058	bpp_loss: 3.8010125160217285	aux_loss: 0.5100765228271484
01:37:28 INFO - main: Train iter. 90000/200000 (45.0%): 	Loss: 4.544661045074463	recon_loss: 0.007254596333950758	bpp_loss: 3.8192014694213867	aux_loss: 0.6936966180801392
01:37:39 INFO - main: {'TEST MSE': 0.007251364878154148, 'TEST BPP': 3.825875, 'TEST loss': 4.537568902492523, 'TEST recon_loss': 0.0072513651237823065, 'TEST bpp_loss': 3.8124323871135712}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
01:43:06 INFO - main: Train iter. 91000/200000 (45.5%): 	Loss: 4.531543254852295	recon_loss: 0.007242032792419195	bpp_loss: 3.807340145111084	aux_loss: 0.5080886483192444
01:48:33 INFO - main: Train iter. 92000/200000 (46.0%): 	Loss: 4.534709453582764	recon_loss: 0.007244076579809189	bpp_loss: 3.8103017807006836	aux_loss: 0.9219868183135986
01:54:01 INFO - main: Train iter. 93000/200000 (46.5%): 	Loss: 4.539051532745361	recon_loss: 0.007257360499352217	bpp_loss: 3.8133156299591064	aux_loss: 0.8397184610366821
01:59:27 INFO - main: Train iter. 94000/200000 (47.0%): 	Loss: 4.5279645919799805	recon_loss: 0.007236334029585123	bpp_loss: 3.804331064224243	aux_loss: 0.18671151995658875
02:04:55 INFO - main: Train iter. 95000/200000 (47.5%): 	Loss: 4.527152061462402	recon_loss: 0.007246319204568863	bpp_loss: 3.802520275115967	aux_loss: 0.15356692671775818
02:05:05 INFO - main: {'TEST MSE': 0.0072407698073690295, 'TEST BPP': 3.8251328125, 'TEST loss': 4.536065833091736, 'TEST recon_loss': 0.007240770041942597, 'TEST bpp_loss': 3.811988839387894}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
02:10:32 INFO - main: Train iter. 96000/200000 (48.0%): 	Loss: 4.523070812225342	recon_loss: 0.00723022548481822	bpp_loss: 3.8000481128692627	aux_loss: 0.5672696828842163
02:15:57 INFO - main: Train iter. 97000/200000 (48.5%): 	Loss: 4.530784606933594	recon_loss: 0.007242035586386919	bpp_loss: 3.8065807819366455	aux_loss: 0.337934672832489
02:21:23 INFO - main: Train iter. 98000/200000 (49.0%): 	Loss: 4.539072513580322	recon_loss: 0.007249617017805576	bpp_loss: 3.81411075592041	aux_loss: 0.4450782239437103
02:26:50 INFO - main: Train iter. 99000/200000 (49.5%): 	Loss: 4.524713039398193	recon_loss: 0.007243716157972813	bpp_loss: 3.8003416061401367	aux_loss: 0.26440709829330444
02:32:15 INFO - main: Train iter. 100000/200000 (50.0%): 	Loss: 4.532708168029785	recon_loss: 0.007246901746839285	bpp_loss: 3.808018207550049	aux_loss: 0.4324071407318115
02:32:26 INFO - main: {'TEST MSE': 0.007247617776035855, 'TEST BPP': 3.825328125, 'TEST loss': 4.536696392536164, 'TEST recon_loss': 0.00724761802284047, 'TEST bpp_loss': 3.8119345877170563}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
02:37:52 INFO - main: Train iter. 101000/200000 (50.5%): 	Loss: 4.529807090759277	recon_loss: 0.007246030494570732	bpp_loss: 3.805204153060913	aux_loss: 0.20528405904769897
02:43:19 INFO - main: Train iter. 102000/200000 (51.0%): 	Loss: 4.530648708343506	recon_loss: 0.0072432151064276695	bpp_loss: 3.8063271045684814	aux_loss: 0.2423332929611206
02:48:47 INFO - main: Train iter. 103000/200000 (51.5%): 	Loss: 4.527139186859131	recon_loss: 0.007248426787555218	bpp_loss: 3.8022966384887695	aux_loss: 0.24307745695114136
02:54:15 INFO - main: Train iter. 104000/200000 (52.0%): 	Loss: 4.5182390213012695	recon_loss: 0.007237512618303299	bpp_loss: 3.794487953186035	aux_loss: 0.7379448413848877
02:59:41 INFO - main: Train iter. 105000/200000 (52.5%): 	Loss: 4.532648086547852	recon_loss: 0.007248192094266415	bpp_loss: 3.807828664779663	aux_loss: 0.3515629470348358
02:59:52 INFO - main: {'TEST MSE': 0.007239922123912335, 'TEST BPP': 3.8255390625, 'TEST loss': 4.536087863922119, 'TEST recon_loss': 0.007239922366570681, 'TEST bpp_loss': 3.8120956265926362}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
03:05:19 INFO - main: Train iter. 106000/200000 (53.0%): 	Loss: 4.527822971343994	recon_loss: 0.007228190544992685	bpp_loss: 3.8050038814544678	aux_loss: 0.2554347515106201
03:10:47 INFO - main: Train iter. 107000/200000 (53.5%): 	Loss: 4.531290054321289	recon_loss: 0.00723870936781168	bpp_loss: 3.8074190616607666	aux_loss: 0.20437270402908325
03:16:14 INFO - main: Train iter. 108000/200000 (54.0%): 	Loss: 4.52889347076416	recon_loss: 0.007229138165712357	bpp_loss: 3.8059794902801514	aux_loss: 0.3269388973712921
03:21:39 INFO - main: Train iter. 109000/200000 (54.5%): 	Loss: 4.521507740020752	recon_loss: 0.007240646984428167	bpp_loss: 3.79744291305542	aux_loss: 0.3290921747684479
03:27:05 INFO - main: Train iter. 110000/200000 (55.0%): 	Loss: 4.5310587882995605	recon_loss: 0.007234797812998295	bpp_loss: 3.8075788021087646	aux_loss: 0.8376241326332092
03:27:15 INFO - main: {'TEST MSE': 0.007240384754354406, 'TEST BPP': 3.825296875, 'TEST loss': 4.5359172205924985, 'TEST recon_loss': 0.007240384992212057, 'TEST bpp_loss': 3.8118787167072297}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
03:32:41 INFO - main: Train iter. 111000/200000 (55.5%): 	Loss: 4.528574466705322	recon_loss: 0.007232969161123037	bpp_loss: 3.8052773475646973	aux_loss: 0.39720696210861206
03:38:05 INFO - main: Train iter. 112000/200000 (56.0%): 	Loss: 4.530732154846191	recon_loss: 0.007235383149236441	bpp_loss: 3.8071937561035156	aux_loss: 0.4204117953777313
03:43:31 INFO - main: Train iter. 113000/200000 (56.5%): 	Loss: 4.528852939605713	recon_loss: 0.007254746276885271	bpp_loss: 3.803378105163574	aux_loss: 0.31040847301483154
03:49:00 INFO - main: Train iter. 114000/200000 (57.0%): 	Loss: 4.549055099487305	recon_loss: 0.007237092591822147	bpp_loss: 3.825345754623413	aux_loss: 0.7006280422210693
03:54:29 INFO - main: Train iter. 115000/200000 (57.5%): 	Loss: 4.5321550369262695	recon_loss: 0.007249173242598772	bpp_loss: 3.8072376251220703	aux_loss: 0.6035363078117371
03:54:40 INFO - main: {'TEST MSE': 0.007256104078033556, 'TEST BPP': 3.8251484375, 'TEST loss': 4.537454811096191, 'TEST recon_loss': 0.0072561043277382855, 'TEST bpp_loss': 3.8118443756103515}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
04:00:07 INFO - main: Train iter. 116000/200000 (58.0%): 	Loss: 4.5189032554626465	recon_loss: 0.007238283753395081	bpp_loss: 3.795074701309204	aux_loss: 0.21122297644615173
04:05:36 INFO - main: Train iter. 117000/200000 (58.5%): 	Loss: 4.541309833526611	recon_loss: 0.007252716459333897	bpp_loss: 3.8160383701324463	aux_loss: 0.4080728590488434
04:11:05 INFO - main: Train iter. 118000/200000 (59.0%): 	Loss: 4.521847248077393	recon_loss: 0.007239304482936859	bpp_loss: 3.797916889190674	aux_loss: 0.27390673756599426
04:16:32 INFO - main: Train iter. 119000/200000 (59.5%): 	Loss: 4.531668663024902	recon_loss: 0.00724312337115407	bpp_loss: 3.807356119155884	aux_loss: 0.2279062569141388
04:21:58 INFO - main: Train iter. 120000/200000 (60.0%): 	Loss: 4.528393268585205	recon_loss: 0.007241641636937857	bpp_loss: 3.8042290210723877	aux_loss: 0.7866170406341553
04:22:09 INFO - main: {'TEST MSE': 0.007244197575621438, 'TEST BPP': 3.8251328125, 'TEST loss': 4.536137055873871, 'TEST recon_loss': 0.007244197819381952, 'TEST bpp_loss': 3.811717272043228}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
04:27:37 INFO - main: Train iter. 121000/200000 (60.5%): 	Loss: 4.534328460693359	recon_loss: 0.007238918449729681	bpp_loss: 3.810436487197876	aux_loss: 0.7129748463630676
04:33:05 INFO - main: Train iter. 122000/200000 (61.0%): 	Loss: 4.537789344787598	recon_loss: 0.00724111357703805	bpp_loss: 3.813678026199341	aux_loss: 0.34155789017677307
04:38:30 INFO - main: Train iter. 123000/200000 (61.5%): 	Loss: 4.532161235809326	recon_loss: 0.007237539626657963	bpp_loss: 3.8084070682525635	aux_loss: 0.20153796672821045
04:43:57 INFO - main: Train iter. 124000/200000 (62.0%): 	Loss: 4.5297465324401855	recon_loss: 0.007240264676511288	bpp_loss: 3.805720090866089	aux_loss: 0.4527839720249176
04:49:25 INFO - main: Train iter. 125000/200000 (62.5%): 	Loss: 4.5389275550842285	recon_loss: 0.007236788049340248	bpp_loss: 3.815248727798462	aux_loss: 0.4775097966194153
04:49:36 INFO - main: {'TEST MSE': 0.007234719119158361, 'TEST BPP': 3.825234375, 'TEST loss': 4.535287550926208, 'TEST recon_loss': 0.00723471935512498, 'TEST bpp_loss': 3.8118156111240387}
/workspace/Weight_compression/NWC/train_nwc.py:239: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
04:55:03 INFO - main: Train iter. 126000/200000 (63.0%): 	Loss: 4.518301963806152	recon_loss: 0.007231918163597584	bpp_loss: 3.7951102256774902	aux_loss: 0.3961288332939148
05:00:28 INFO - main: Train iter. 127000/200000 (63.5%): 	Loss: 4.536388874053955	recon_loss: 0.00723810400813818	bpp_loss: 3.8125786781311035	aux_loss: 0.6861268877983093
Terminated
