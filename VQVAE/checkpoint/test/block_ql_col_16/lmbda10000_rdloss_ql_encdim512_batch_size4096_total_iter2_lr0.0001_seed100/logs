18:16:49 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:16:49 INFO - ddp_or_single_process: Create new exp folder!
18:16:49 INFO - ddp_or_single_process: seed : 100
18:16:49 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:16:51 INFO - main: Create experiment save folder
18:17:12 INFO - main: Training mode : scratch!
18:17:12 INFO - main: batch_size : 4096
18:17:12 INFO - main: num of gpus: 1
18:17:12 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:19:19 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:19:19 INFO - ddp_or_single_process: find checkpoint...
18:19:19 INFO - ddp_or_single_process: no checkpoint is here
18:19:19 INFO - ddp_or_single_process: seed : 100
18:19:19 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:19:21 INFO - main: Create experiment save folder
18:19:38 INFO - main: Training mode : scratch!
18:19:38 INFO - main: batch_size : 4096
18:19:38 INFO - main: num of gpus: 1
18:19:38 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:20:55 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:20:55 INFO - ddp_or_single_process: find checkpoint...
18:20:55 INFO - ddp_or_single_process: no checkpoint is here
18:20:55 INFO - ddp_or_single_process: seed : 100
18:20:55 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:20:56 INFO - main: Create experiment save folder
18:21:13 INFO - main: Training mode : scratch!
18:21:13 INFO - main: batch_size : 4096
18:21:13 INFO - main: num of gpus: 1
18:21:13 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:24:00 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:24:00 INFO - ddp_or_single_process: find checkpoint...
18:24:00 INFO - ddp_or_single_process: no checkpoint is here
18:24:00 INFO - ddp_or_single_process: seed : 100
18:24:00 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:24:02 INFO - main: Create experiment save folder
18:24:13 INFO - main: Training mode : scratch!
18:24:13 INFO - main: batch_size : 4096
18:24:13 INFO - main: num of gpus: 1
18:24:13 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:29:18 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:29:18 INFO - ddp_or_single_process: find checkpoint...
18:29:18 INFO - ddp_or_single_process: no checkpoint is here
18:29:18 INFO - ddp_or_single_process: seed : 100
18:29:18 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:29:19 INFO - main: Create experiment save folder
18:29:30 INFO - main: Training mode : scratch!
18:29:30 INFO - main: batch_size : 4096
18:29:30 INFO - main: num of gpus: 1
18:29:30 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:32:32 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:32:32 INFO - ddp_or_single_process: find checkpoint...
18:32:32 INFO - ddp_or_single_process: no checkpoint is here
18:32:32 INFO - ddp_or_single_process: seed : 100
18:32:32 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:32:33 INFO - main: Create experiment save folder
18:32:44 INFO - main: Training mode : scratch!
18:32:44 INFO - main: batch_size : 4096
18:32:44 INFO - main: num of gpus: 1
18:32:44 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:34:07 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:34:07 INFO - ddp_or_single_process: find checkpoint...
18:34:07 INFO - ddp_or_single_process: no checkpoint is here
18:34:07 INFO - ddp_or_single_process: seed : 100
18:34:07 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:34:09 INFO - main: Create experiment save folder
18:34:20 INFO - main: Training mode : scratch!
18:34:20 INFO - main: batch_size : 4096
18:34:20 INFO - main: num of gpus: 1
18:34:20 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:35:21 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:35:21 INFO - ddp_or_single_process: find checkpoint...
18:35:21 INFO - ddp_or_single_process: no checkpoint is here
18:35:21 INFO - ddp_or_single_process: seed : 100
18:35:21 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:35:37 INFO - main: Create experiment save folder
18:35:48 INFO - main: Training mode : scratch!
18:35:48 INFO - main: batch_size : 4096
18:35:48 INFO - main: num of gpus: 1
18:35:48 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:37:04 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:37:04 INFO - ddp_or_single_process: find checkpoint...
18:37:04 INFO - ddp_or_single_process: no checkpoint is here
18:37:04 INFO - ddp_or_single_process: seed : 100
18:37:04 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:37:05 INFO - main: Create experiment save folder
18:37:16 INFO - main: Training mode : scratch!
18:37:16 INFO - main: batch_size : 4096
18:37:16 INFO - main: num of gpus: 1
18:37:16 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:37:40 INFO - main: Train iter. 1/2 (50.0%): 	Loss: 2150757.25	recon_loss: 215.07386779785156	aux_loss: 659.0755615234375
18:40:28 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:40:28 INFO - ddp_or_single_process: find checkpoint...
18:40:28 INFO - ddp_or_single_process: no checkpoint is here
18:40:28 INFO - ddp_or_single_process: seed : 100
18:40:28 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:40:29 INFO - main: Create experiment save folder
18:40:40 INFO - main: Training mode : scratch!
18:40:40 INFO - main: batch_size : 4096
18:40:40 INFO - main: num of gpus: 1
18:40:40 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:41:04 INFO - main: Train iter. 1/2 (50.0%): 	Loss: 2150757.25	recon_loss: 215.07386779785156	aux_loss: 659.0755615234375
18:41:48 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
18:41:48 INFO - ddp_or_single_process: find checkpoint...
18:41:48 INFO - ddp_or_single_process: no checkpoint is here
18:41:48 INFO - ddp_or_single_process: seed : 100
18:41:48 INFO - ddp_or_single_process: exp name : block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100
18:41:49 INFO - main: Create experiment save folder
18:42:00 INFO - main: Training mode : scratch!
18:42:00 INFO - main: batch_size : 4096
18:42:00 INFO - main: num of gpus: 1
18:42:00 INFO - main: Namespace(dist_port=6044, iter=2, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_16_row_dataset.pt', dataset='block_ql', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=16, dim_encoder=512, n_resblock=4, clip_max_norm=1.0, save_dir='test', architecture='nwc_ql', loss='rdloss_ql', checkpoint='None', block_direction='col', lmbda=10000, save_path='./checkpoint/test/block_ql_col_16/lmbda10000_rdloss_ql_encdim512_batch_size4096_total_iter2_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
18:42:24 INFO - main: Train iter. 1/2 (50.0%): 	Loss: 2150757.25	recon_loss: 215.07386779785156	aux_loss: 659.0755615234375
18:42:31 INFO - main: {'TEST MSE': 164.29151632323712, 'TEST BPP': 8.112, 'TEST loss': 1642933.6403203125, 'TEST recon_loss': 164.29150590896606, 'TEST bpp_loss': 18.584740699768066}
18:42:31 INFO - main: can not find prev_mse_best_model!
18:42:31 INFO - main: can not find prev_bpp_best_model!
18:42:31 INFO - main: can not find prev_bpp_best_model!
18:42:31 INFO - main: can not find recent_saved_model!
