21:42:50 INFO - logger_setup: /home/jgryu/Weight_compression/VQVAE/utils/util.py
21:42:50 INFO - ddp_or_single_process: Create new exp folder!
21:42:50 INFO - ddp_or_single_process: seed : 100
21:42:50 INFO - ddp_or_single_process: exp name : block_row_2048/lmbda100_rdloss_encdim2048_batch_size4096_total_iter1500000_lr0.0001_seed100
21:42:51 INFO - main: Create experiment save folder
21:43:09 INFO - main: Training mode : scratch!
21:43:09 INFO - main: batch_size : 4096
21:43:09 INFO - main: num of gpus: 1
21:43:09 INFO - main: Namespace(dist_port=6044, iter=1500000, dataset_path='../Wparam_dataset/dataset_block/meta-llama/Meta-Llama-3-8B/mlp_attn_2048_row_dataset.pt', dataset='block', learning_rate=0.0001, aux_learning_rate=0.001, num_workers=2, batch_size=4096, seed=100, input_size=2048, dim_encoder=2048, n_resblock=4, clip_max_norm=1.0, save_dir='nwc', architecture='nwc', loss='rdloss', checkpoint='None', block_direction='row', lmbda=100, save_path='./checkpoint/nwc/block_row_2048/lmbda100_rdloss_encdim2048_batch_size4096_total_iter1500000_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
21:43:11 INFO - main: Train iter. 1/1500000 (6.666666666666667e-05%): 	Loss: 351.1156005859375	recon_loss: 3.457021951675415	aux_loss: 84435.6328125
21:43:26 INFO - main: {'TEST MSE': 2.7529295714068467, 'TEST BPP': 5.4375, 'TEST loss': 280.7056959838867, 'TEST recon_loss': 2.752929488301277, 'TEST bpp_loss': 5.412747738361358}
21:43:26 INFO - main: can not find prev_mse_best_model!
21:43:26 INFO - main: can not find prev_bpp_best_model!
21:43:27 INFO - main: can not find prev_bpp_best_model!
21:43:27 INFO - main: can not find recent_saved_model!
21:46:38 INFO - main: Train iter. 1000/1500000 (0.06666666666666667%): 	Loss: 38.64647674560547	recon_loss: 0.3465389609336853	aux_loss: 77656.328125
21:49:48 INFO - main: Train iter. 2000/1500000 (0.13333333333333333%): 	Loss: 24.136505126953125	recon_loss: 0.20932745933532715	aux_loss: 67743.265625
21:52:59 INFO - main: Train iter. 3000/1500000 (0.2%): 	Loss: 17.323619842529297	recon_loss: 0.1414109319448471	aux_loss: 60170.5859375
21:56:09 INFO - main: Train iter. 4000/1500000 (0.26666666666666666%): 	Loss: 13.80953311920166	recon_loss: 0.10490384697914124	aux_loss: 58422.53125
21:59:23 INFO - main: Train iter. 5000/1500000 (0.3333333333333333%): 	Loss: 11.326736450195312	recon_loss: 0.07923650741577148	aux_loss: 57640.1640625
22:02:33 INFO - main: Train iter. 6000/1500000 (0.4%): 	Loss: 10.004709243774414	recon_loss: 0.06516090780496597	aux_loss: 55865.3203125
22:05:44 INFO - main: Train iter. 7000/1500000 (0.4666666666666667%): 	Loss: 9.07021713256836	recon_loss: 0.0553780272603035	aux_loss: 52790.70703125
22:08:55 INFO - main: Train iter. 8000/1500000 (0.5333333333333333%): 	Loss: 8.509615898132324	recon_loss: 0.04923202469944954	aux_loss: 48450.25390625
22:12:06 INFO - main: Train iter. 9000/1500000 (0.6%): 	Loss: 8.130401611328125	recon_loss: 0.045039623975753784	aux_loss: 43507.7265625
22:15:18 INFO - main: Train iter. 10000/1500000 (0.6666666666666666%): 	Loss: 7.85481071472168	recon_loss: 0.04210022836923599	aux_loss: 39176.03125
22:15:37 INFO - main: {'TEST MSE': 0.04346770310641614, 'TEST BPP': 3.68840625, 'TEST loss': 8.011165373325348, 'TEST recon_loss': 0.04346770182996988, 'TEST bpp_loss': 3.6643951869010927}
22:18:48 INFO - main: Train iter. 11000/1500000 (0.7333333333333333%): 	Loss: 7.608022689819336	recon_loss: 0.039429329335689545	aux_loss: 35884.3671875
22:21:59 INFO - main: Train iter. 12000/1500000 (0.8%): 	Loss: 7.431127548217773	recon_loss: 0.037452347576618195	aux_loss: 33388.1640625
22:25:10 INFO - main: Train iter. 13000/1500000 (0.8666666666666667%): 	Loss: 7.145883560180664	recon_loss: 0.03476227447390556	aux_loss: 31340.955078125
22:28:21 INFO - main: Train iter. 14000/1500000 (0.9333333333333333%): 	Loss: 7.075289726257324	recon_loss: 0.033867139369249344	aux_loss: 29391.09375
22:31:33 INFO - main: Train iter. 15000/1500000 (1.0%): 	Loss: 6.992750644683838	recon_loss: 0.032900091260671616	aux_loss: 27523.37890625
22:34:44 INFO - main: Train iter. 16000/1500000 (1.0666666666666667%): 	Loss: 6.885166645050049	recon_loss: 0.031855255365371704	aux_loss: 25613.9765625
22:37:53 INFO - main: Train iter. 17000/1500000 (1.1333333333333333%): 	Loss: 6.881533622741699	recon_loss: 0.031711265444755554	aux_loss: 23819.9296875
22:41:05 INFO - main: Train iter. 18000/1500000 (1.2%): 	Loss: 6.734947204589844	recon_loss: 0.030343566089868546	aux_loss: 21950.2734375
22:44:15 INFO - main: Train iter. 19000/1500000 (1.2666666666666666%): 	Loss: 6.684913635253906	recon_loss: 0.02973775565624237	aux_loss: 20085.263671875
22:47:28 INFO - main: Train iter. 20000/1500000 (1.3333333333333333%): 	Loss: 6.60932731628418	recon_loss: 0.02899937331676483	aux_loss: 18302.7578125
22:47:50 INFO - main: {'TEST MSE': 0.03009791525245217, 'TEST BPP': 3.76496875, 'TEST loss': 6.749305341720581, 'TEST recon_loss': 0.030097914344631136, 'TEST bpp_loss': 3.739513913631439}
22:51:01 INFO - main: Train iter. 21000/1500000 (1.4%): 	Loss: 6.566762924194336	recon_loss: 0.028602736070752144	aux_loss: 16472.91015625
22:54:12 INFO - main: Train iter. 22000/1500000 (1.4666666666666666%): 	Loss: 6.5565290451049805	recon_loss: 0.0283806212246418	aux_loss: 14617.6953125
22:57:22 INFO - main: Train iter. 23000/1500000 (1.5333333333333334%): 	Loss: 6.533595085144043	recon_loss: 0.028036072850227356	aux_loss: 12942.404296875
23:00:33 INFO - main: Train iter. 24000/1500000 (1.6%): 	Loss: 6.461584568023682	recon_loss: 0.027499090880155563	aux_loss: 11053.619140625
23:03:45 INFO - main: Train iter. 25000/1500000 (1.6666666666666667%): 	Loss: 6.453993797302246	recon_loss: 0.027332883328199387	aux_loss: 9287.607421875
23:06:56 INFO - main: Train iter. 26000/1500000 (1.7333333333333334%): 	Loss: 6.463001251220703	recon_loss: 0.027312805876135826	aux_loss: 7543.9755859375
23:10:06 INFO - main: Train iter. 27000/1500000 (1.8%): 	Loss: 6.438316345214844	recon_loss: 0.02706819772720337	aux_loss: 5793.9326171875
23:13:52 INFO - main: Train iter. 28000/1500000 (1.8666666666666667%): 	Loss: 6.379990577697754	recon_loss: 0.026503143832087517	aux_loss: 4122.11767578125
23:17:05 INFO - main: Train iter. 29000/1500000 (1.9333333333333333%): 	Loss: 6.287576198577881	recon_loss: 0.02571309357881546	aux_loss: 2501.78515625
23:20:30 INFO - main: Train iter. 30000/1500000 (2.0%): 	Loss: 6.314696311950684	recon_loss: 0.025805724784731865	aux_loss: 1187.0693359375
23:21:00 INFO - main: {'TEST MSE': 0.02641260666372874, 'TEST BPP': 3.7795, 'TEST loss': 6.394202882289886, 'TEST recon_loss': 0.026412605908699333, 'TEST bpp_loss': 3.75294229388237}
23:24:13 INFO - main: Train iter. 31000/1500000 (2.066666666666667%): 	Loss: 6.2776875495910645	recon_loss: 0.02546537294983864	aux_loss: 460.9769287109375
23:27:27 INFO - main: Train iter. 32000/1500000 (2.1333333333333333%): 	Loss: 6.241542816162109	recon_loss: 0.025021426379680634	aux_loss: 233.39749145507812
23:30:38 INFO - main: Train iter. 33000/1500000 (2.2%): 	Loss: 6.1596598625183105	recon_loss: 0.02443772554397583	aux_loss: 160.26947021484375
23:33:49 INFO - main: Train iter. 34000/1500000 (2.2666666666666666%): 	Loss: 6.175437927246094	recon_loss: 0.024543724954128265	aux_loss: 133.7307891845703
23:37:09 INFO - main: Train iter. 35000/1500000 (2.3333333333333335%): 	Loss: 6.226719856262207	recon_loss: 0.02485891990363598	aux_loss: 123.4789810180664
23:40:35 INFO - main: Train iter. 36000/1500000 (2.4%): 	Loss: 6.213295936584473	recon_loss: 0.024740662425756454	aux_loss: 116.21925354003906
23:43:57 INFO - main: Train iter. 37000/1500000 (2.466666666666667%): 	Loss: 6.105288505554199	recon_loss: 0.023809310048818588	aux_loss: 115.6058120727539
23:47:17 INFO - main: Train iter. 38000/1500000 (2.533333333333333%): 	Loss: 6.078911781311035	recon_loss: 0.023577744141221046	aux_loss: 111.94613647460938
23:50:28 INFO - main: Train iter. 39000/1500000 (2.6%): 	Loss: 6.132777214050293	recon_loss: 0.024004468694329262	aux_loss: 125.26068878173828
23:53:40 INFO - main: Train iter. 40000/1500000 (2.6666666666666665%): 	Loss: 6.063285827636719	recon_loss: 0.023326443508267403	aux_loss: 103.97636413574219
23:54:10 INFO - main: {'TEST MSE': 0.024097702582273506, 'TEST BPP': 3.7859375, 'TEST loss': 6.168711287975311, 'TEST recon_loss': 0.024097701888531445, 'TEST bpp_loss': 3.7589411046504972}
23:57:21 INFO - main: Train iter. 41000/1500000 (2.7333333333333334%): 	Loss: 6.072107315063477	recon_loss: 0.02340790070593357	aux_loss: 107.22032165527344
00:00:31 INFO - main: Train iter. 42000/1500000 (2.8%): 	Loss: 6.091758728027344	recon_loss: 0.023612963035702705	aux_loss: 106.03502655029297
00:03:41 INFO - main: Train iter. 43000/1500000 (2.8666666666666667%): 	Loss: 6.111836910247803	recon_loss: 0.02369658835232258	aux_loss: 106.31472778320312
00:06:52 INFO - main: Train iter. 44000/1500000 (2.933333333333333%): 	Loss: 6.086359977722168	recon_loss: 0.023394417017698288	aux_loss: 105.13481903076172
00:10:03 INFO - main: Train iter. 45000/1500000 (3.0%): 	Loss: 6.001893043518066	recon_loss: 0.0227209459990263	aux_loss: 110.01227569580078
00:13:15 INFO - main: Train iter. 46000/1500000 (3.066666666666667%): 	Loss: 6.097794532775879	recon_loss: 0.02352314628660679	aux_loss: 122.63938903808594
00:16:24 INFO - main: Train iter. 47000/1500000 (3.1333333333333333%): 	Loss: 6.063925743103027	recon_loss: 0.023235511034727097	aux_loss: 110.45081329345703
00:19:35 INFO - main: Train iter. 48000/1500000 (3.2%): 	Loss: 6.0866875648498535	recon_loss: 0.023369939997792244	aux_loss: 123.17325592041016
00:22:44 INFO - main: Train iter. 49000/1500000 (3.2666666666666666%): 	Loss: 6.100560665130615	recon_loss: 0.023423513397574425	aux_loss: 122.2127914428711
00:25:58 INFO - main: Train iter. 50000/1500000 (3.3333333333333335%): 	Loss: 5.983282566070557	recon_loss: 0.02241033874452114	aux_loss: 113.44446563720703
00:26:31 INFO - main: {'TEST MSE': 0.023303460700348468, 'TEST BPP': 3.788484375, 'TEST loss': 6.091836633205414, 'TEST recon_loss': 0.023303460009396076, 'TEST bpp_loss': 3.7614906277656557}
00:29:41 INFO - main: Train iter. 51000/1500000 (3.4%): 	Loss: 5.990390777587891	recon_loss: 0.022561434656381607	aux_loss: 119.65165710449219
00:32:52 INFO - main: Train iter. 52000/1500000 (3.466666666666667%): 	Loss: 5.955422401428223	recon_loss: 0.02225518971681595	aux_loss: 116.7334976196289
00:36:02 INFO - main: Train iter. 53000/1500000 (3.533333333333333%): 	Loss: 5.950506210327148	recon_loss: 0.02212313376367092	aux_loss: 119.1521224975586
00:39:20 INFO - main: Train iter. 54000/1500000 (3.6%): 	Loss: 5.9349846839904785	recon_loss: 0.02207348681986332	aux_loss: 117.18490600585938
00:42:32 INFO - main: Train iter. 55000/1500000 (3.6666666666666665%): 	Loss: 5.913486480712891	recon_loss: 0.021914029493927956	aux_loss: 124.08425903320312
00:45:53 INFO - main: Train iter. 56000/1500000 (3.7333333333333334%): 	Loss: 5.944852828979492	recon_loss: 0.02212892845273018	aux_loss: 119.55652618408203
00:49:06 INFO - main: Train iter. 57000/1500000 (3.8%): 	Loss: 5.924346923828125	recon_loss: 0.021940676495432854	aux_loss: 146.359619140625
00:52:33 INFO - main: Train iter. 58000/1500000 (3.8666666666666667%): 	Loss: 5.919468879699707	recon_loss: 0.021740416064858437	aux_loss: 125.70967102050781
00:55:58 INFO - main: Train iter. 59000/1500000 (3.933333333333333%): 	Loss: 5.8469557762146	recon_loss: 0.02112097665667534	aux_loss: 125.4757308959961
00:59:21 INFO - main: Train iter. 60000/1500000 (4.0%): 	Loss: 5.827059745788574	recon_loss: 0.02087453566491604	aux_loss: 128.47279357910156
00:59:56 INFO - main: {'TEST MSE': 0.0214626835146725, 'TEST BPP': 3.7910625, 'TEST loss': 5.910462583065033, 'TEST recon_loss': 0.02146268291864544, 'TEST bpp_loss': 3.76419428563118}
01:03:08 INFO - main: Train iter. 61000/1500000 (4.066666666666666%): 	Loss: 5.84280252456665	recon_loss: 0.021050382405519485	aux_loss: 132.60426330566406
01:06:18 INFO - main: Train iter. 62000/1500000 (4.133333333333334%): 	Loss: 5.85048770904541	recon_loss: 0.021117113530635834	aux_loss: 141.25222778320312
01:09:29 INFO - main: Train iter. 63000/1500000 (4.2%): 	Loss: 5.873107433319092	recon_loss: 0.021225398406386375	aux_loss: 200.16307067871094
01:12:40 INFO - main: Train iter. 64000/1500000 (4.266666666666667%): 	Loss: 5.851233005523682	recon_loss: 0.021056674420833588	aux_loss: 265.1145324707031
01:15:51 INFO - main: Train iter. 65000/1500000 (4.333333333333333%): 	Loss: 5.847127437591553	recon_loss: 0.02106093056499958	aux_loss: 305.7813415527344
01:19:01 INFO - main: Train iter. 66000/1500000 (4.4%): 	Loss: 5.814338684082031	recon_loss: 0.020838085561990738	aux_loss: 357.97064208984375
01:22:12 INFO - main: Train iter. 67000/1500000 (4.466666666666667%): 	Loss: 5.822883129119873	recon_loss: 0.02088676393032074	aux_loss: 418.6590576171875
01:25:22 INFO - main: Train iter. 68000/1500000 (4.533333333333333%): 	Loss: 5.855889797210693	recon_loss: 0.021173756569623947	aux_loss: 506.61663818359375
01:28:35 INFO - main: Train iter. 69000/1500000 (4.6%): 	Loss: 5.742299556732178	recon_loss: 0.020187480375170708	aux_loss: 602.2521362304688
01:31:45 INFO - main: Train iter. 70000/1500000 (4.666666666666667%): 	Loss: 5.793038845062256	recon_loss: 0.020531509071588516	aux_loss: 714.3388671875
01:32:24 INFO - main: {'TEST MSE': 0.02107128678685436, 'TEST BPP': 3.78965625, 'TEST loss': 5.869645296573639, 'TEST recon_loss': 0.021071286162361504, 'TEST bpp_loss': 3.7625166807174684}
01:35:34 INFO - main: Train iter. 71000/1500000 (4.733333333333333%): 	Loss: 5.832154273986816	recon_loss: 0.02085696905851364	aux_loss: 774.3924560546875
01:38:46 INFO - main: Train iter. 72000/1500000 (4.8%): 	Loss: 5.766138076782227	recon_loss: 0.020374935120344162	aux_loss: 913.0965576171875
01:41:55 INFO - main: Train iter. 73000/1500000 (4.866666666666666%): 	Loss: 5.789279937744141	recon_loss: 0.020548347383737564	aux_loss: 1016.5848999023438
01:45:09 INFO - main: Train iter. 74000/1500000 (4.933333333333334%): 	Loss: 5.764850616455078	recon_loss: 0.02034706622362137	aux_loss: 1100.026123046875
01:48:18 INFO - main: Train iter. 75000/1500000 (5.0%): 	Loss: 5.764951705932617	recon_loss: 0.020348278805613518	aux_loss: 1158.705322265625
01:51:30 INFO - main: Train iter. 76000/1500000 (5.066666666666666%): 	Loss: 5.784926414489746	recon_loss: 0.02055843360722065	aux_loss: 1216.526123046875
01:54:40 INFO - main: Train iter. 77000/1500000 (5.133333333333334%): 	Loss: 5.722648620605469	recon_loss: 0.019952399656176567	aux_loss: 1180.29833984375
01:57:51 INFO - main: Train iter. 78000/1500000 (5.2%): 	Loss: 5.697830677032471	recon_loss: 0.019734498113393784	aux_loss: 1295.5164794921875
02:01:03 INFO - main: Train iter. 79000/1500000 (5.266666666666667%): 	Loss: 5.716568470001221	recon_loss: 0.01979268528521061	aux_loss: 1379.580810546875
