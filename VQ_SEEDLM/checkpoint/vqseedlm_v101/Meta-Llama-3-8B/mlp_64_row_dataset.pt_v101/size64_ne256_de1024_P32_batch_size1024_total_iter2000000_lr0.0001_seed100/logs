12:59:38 INFO - logger_setup: /home/jgryu/Weight_compression/VQ_SEEDLM/utils/util.py
12:59:38 INFO - ddp_or_single_process: Create new exp folder!
12:59:38 INFO - ddp_or_single_process: seed : 100
12:59:38 INFO - ddp_or_single_process: exp name : Meta-Llama-3-8B/mlp_64_row_dataset.pt_v101/size64_ne256_de1024_P32_batch_size1024_total_iter2000000_lr0.0001_seed100
12:59:49 INFO - main: Create experiment save folder
13:00:04 INFO - main: Training mode : scratch!
13:00:04 INFO - main: batch_size : 1024
13:00:04 INFO - main: num of gpus: 1
13:00:04 INFO - main: Namespace(dist_port=6044, iter=2000000, dataset_path='../Wparam_dataset/dataset_per_row/meta-llama/Meta-Llama-3-8B/mlp_64_row_dataset.pt', learning_rate=0.0001, num_workers=2, batch_size=1024, seed=100, input_size=64, dim_encoder=1024, P=32, n_embeddings=256, n_resblock=4, vq_beta=0.25, clip_max_norm=1.0, save_dir='checkpoint_v101', checkpoint='None', save_path='checkpoint_v101/Meta-Llama-3-8B/mlp_64_row_dataset.pt_v101/size64_ne256_de1024_P32_batch_size1024_total_iter2000000_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
13:00:10 INFO - main: Train iter. 1/2000000 (5e-05%): 	Loss: 3.8791675567626953	recon_loss: 1.0030421018600464	embedding_loss: 2.8761253356933594
13:00:12 INFO - main: Average_MSE: 0.9977847244831468
13:00:12 INFO - main: can not find prev_mse_best_model!
13:00:12 INFO - main: can not find recent_saved_model!
13:00:40 INFO - main: Train iter. 1000/2000000 (0.05%): 	Loss: 34.40706253051758	recon_loss: 0.6570273041725159	embedding_loss: 33.75003433227539
13:01:07 INFO - main: Train iter. 2000/2000000 (0.1%): 	Loss: 15.930774688720703	recon_loss: 0.6773446798324585	embedding_loss: 15.253430366516113
13:01:34 INFO - main: Train iter. 3000/2000000 (0.15%): 	Loss: 11.800978660583496	recon_loss: 0.7532863616943359	embedding_loss: 11.04769229888916
13:02:01 INFO - main: Train iter. 4000/2000000 (0.2%): 	Loss: 10.710492134094238	recon_loss: 0.7491934895515442	embedding_loss: 9.961298942565918
13:02:28 INFO - main: Train iter. 5000/2000000 (0.25%): 	Loss: 8.111688613891602	recon_loss: 0.7233105897903442	embedding_loss: 7.388378143310547
13:02:55 INFO - main: Train iter. 6000/2000000 (0.3%): 	Loss: 7.34774923324585	recon_loss: 0.7444502711296082	embedding_loss: 6.603299140930176
13:03:22 INFO - main: Train iter. 7000/2000000 (0.35%): 	Loss: 6.172263145446777	recon_loss: 0.7267310619354248	embedding_loss: 5.445531845092773
13:03:50 INFO - main: Train iter. 8000/2000000 (0.4%): 	Loss: 5.782176494598389	recon_loss: 0.7537415623664856	embedding_loss: 5.028434753417969
13:04:27 INFO - main: Train iter. 9000/2000000 (0.45%): 	Loss: 5.461540699005127	recon_loss: 0.7533704042434692	embedding_loss: 4.708170413970947
13:04:54 INFO - main: Train iter. 10000/2000000 (0.5%): 	Loss: 5.291232109069824	recon_loss: 0.7503483295440674	embedding_loss: 4.540884017944336
13:05:22 INFO - main: Train iter. 11000/2000000 (0.55%): 	Loss: 5.4590229988098145	recon_loss: 0.7616648077964783	embedding_loss: 4.697358131408691
13:05:50 INFO - main: Train iter. 12000/2000000 (0.6%): 	Loss: 4.784188747406006	recon_loss: 0.7473381161689758	embedding_loss: 4.036850452423096
13:06:29 INFO - main: Train iter. 13000/2000000 (0.65%): 	Loss: 4.549466609954834	recon_loss: 0.6977460980415344	embedding_loss: 3.8517203330993652
13:06:57 INFO - main: Train iter. 14000/2000000 (0.7%): 	Loss: 4.592021942138672	recon_loss: 0.7003716230392456	embedding_loss: 3.891650438308716
13:07:24 INFO - main: Train iter. 15000/2000000 (0.75%): 	Loss: 4.470105171203613	recon_loss: 0.6922768950462341	embedding_loss: 3.7778282165527344
13:07:51 INFO - main: Train iter. 16000/2000000 (0.8%): 	Loss: 4.467715263366699	recon_loss: 0.712080717086792	embedding_loss: 3.755634307861328
13:08:18 INFO - main: Train iter. 17000/2000000 (0.85%): 	Loss: 4.690318584442139	recon_loss: 0.6902003288269043	embedding_loss: 4.000118255615234
13:08:45 INFO - main: Train iter. 18000/2000000 (0.9%): 	Loss: 4.531929016113281	recon_loss: 0.6952541470527649	embedding_loss: 3.836674690246582
13:09:12 INFO - main: Train iter. 19000/2000000 (0.95%): 	Loss: 4.538796424865723	recon_loss: 0.6950917840003967	embedding_loss: 3.8437044620513916
13:09:39 INFO - main: Train iter. 20000/2000000 (1.0%): 	Loss: 4.473412036895752	recon_loss: 0.6720398664474487	embedding_loss: 3.8013720512390137
13:10:06 INFO - main: Train iter. 21000/2000000 (1.05%): 	Loss: 4.531810760498047	recon_loss: 0.6645731925964355	embedding_loss: 3.8672378063201904
13:10:34 INFO - main: Train iter. 22000/2000000 (1.1%): 	Loss: 4.320765018463135	recon_loss: 0.6415201425552368	embedding_loss: 3.6792449951171875
13:11:01 INFO - main: Train iter. 23000/2000000 (1.15%): 	Loss: 4.592715740203857	recon_loss: 0.6561092138290405	embedding_loss: 3.9366064071655273
13:11:28 INFO - main: Train iter. 24000/2000000 (1.2%): 	Loss: 4.638207912445068	recon_loss: 0.6528986692428589	embedding_loss: 3.98530912399292
13:11:55 INFO - main: Train iter. 25000/2000000 (1.25%): 	Loss: 4.799159049987793	recon_loss: 0.6641063094139099	embedding_loss: 4.135052680969238
13:12:23 INFO - main: Train iter. 26000/2000000 (1.3%): 	Loss: 4.784424781799316	recon_loss: 0.648310124874115	embedding_loss: 4.136114597320557
13:12:50 INFO - main: Train iter. 27000/2000000 (1.35%): 	Loss: 4.7829389572143555	recon_loss: 0.6607797145843506	embedding_loss: 4.122159481048584
13:13:16 INFO - main: Train iter. 28000/2000000 (1.4%): 	Loss: 4.846687316894531	recon_loss: 0.6534271240234375	embedding_loss: 4.193260192871094
13:13:44 INFO - main: Train iter. 29000/2000000 (1.45%): 	Loss: 4.585328102111816	recon_loss: 0.6412421464920044	embedding_loss: 3.9440858364105225
13:14:11 INFO - main: Train iter. 30000/2000000 (1.5%): 	Loss: 4.535831928253174	recon_loss: 0.63685142993927	embedding_loss: 3.8989803791046143
13:14:38 INFO - main: Train iter. 31000/2000000 (1.55%): 	Loss: 4.651617527008057	recon_loss: 0.6474871039390564	embedding_loss: 4.0041303634643555
13:15:05 INFO - main: Train iter. 32000/2000000 (1.6%): 	Loss: 4.300481796264648	recon_loss: 0.6055858731269836	embedding_loss: 3.6948957443237305
13:15:32 INFO - main: Train iter. 33000/2000000 (1.65%): 	Loss: 4.220390796661377	recon_loss: 0.6060824394226074	embedding_loss: 3.6143083572387695
13:15:58 INFO - main: Train iter. 34000/2000000 (1.7%): 	Loss: 4.436634540557861	recon_loss: 0.6099575161933899	embedding_loss: 3.826676845550537
13:16:25 INFO - main: Train iter. 35000/2000000 (1.75%): 	Loss: 4.3265275955200195	recon_loss: 0.6204637885093689	embedding_loss: 3.706063985824585
13:16:52 INFO - main: Train iter. 36000/2000000 (1.8%): 	Loss: 4.619873046875	recon_loss: 0.651954710483551	embedding_loss: 3.9679181575775146
13:17:19 INFO - main: Train iter. 37000/2000000 (1.85%): 	Loss: 4.312699794769287	recon_loss: 0.616066038608551	embedding_loss: 3.6966335773468018
13:17:46 INFO - main: Train iter. 38000/2000000 (1.9%): 	Loss: 4.4475274085998535	recon_loss: 0.6187092661857605	embedding_loss: 3.8288183212280273
13:18:13 INFO - main: Train iter. 39000/2000000 (1.95%): 	Loss: 4.272850036621094	recon_loss: 0.6153799295425415	embedding_loss: 3.6574699878692627
13:18:40 INFO - main: Train iter. 40000/2000000 (2.0%): 	Loss: 4.496403694152832	recon_loss: 0.6285948753356934	embedding_loss: 3.8678085803985596
13:19:07 INFO - main: Train iter. 41000/2000000 (2.05%): 	Loss: 4.337067604064941	recon_loss: 0.6160888671875	embedding_loss: 3.7209784984588623
13:19:34 INFO - main: Train iter. 42000/2000000 (2.1%): 	Loss: 4.412989616394043	recon_loss: 0.6294980645179749	embedding_loss: 3.783491611480713
13:20:01 INFO - main: Train iter. 43000/2000000 (2.15%): 	Loss: 4.274639129638672	recon_loss: 0.6047952771186829	embedding_loss: 3.6698436737060547
13:20:28 INFO - main: Train iter. 44000/2000000 (2.2%): 	Loss: 4.389958381652832	recon_loss: 0.6417703628540039	embedding_loss: 3.748188018798828
13:20:56 INFO - main: Train iter. 45000/2000000 (2.25%): 	Loss: 4.130966663360596	recon_loss: 0.5977080464363098	embedding_loss: 3.5332584381103516
13:21:22 INFO - main: Train iter. 46000/2000000 (2.3%): 	Loss: 4.1314215660095215	recon_loss: 0.6008095741271973	embedding_loss: 3.530611991882324
13:21:50 INFO - main: Train iter. 47000/2000000 (2.35%): 	Loss: 4.2818098068237305	recon_loss: 0.6233524680137634	embedding_loss: 3.6584572792053223
13:22:17 INFO - main: Train iter. 48000/2000000 (2.4%): 	Loss: 4.261501789093018	recon_loss: 0.6168211102485657	embedding_loss: 3.6446805000305176
13:22:44 INFO - main: Train iter. 49000/2000000 (2.45%): 	Loss: 4.158453941345215	recon_loss: 0.6100127100944519	embedding_loss: 3.5484414100646973
13:23:12 INFO - main: Train iter. 50000/2000000 (2.5%): 	Loss: 4.007750988006592	recon_loss: 0.5898905992507935	embedding_loss: 3.417860269546509
13:23:14 INFO - main: Average_MSE: 0.6029391396711569
13:23:41 INFO - main: Train iter. 51000/2000000 (2.55%): 	Loss: 3.99058198928833	recon_loss: 0.5888257026672363	embedding_loss: 3.4017562866210938
13:24:08 INFO - main: Train iter. 52000/2000000 (2.6%): 	Loss: 3.9773550033569336	recon_loss: 0.5811839699745178	embedding_loss: 3.3961710929870605
13:24:35 INFO - main: Train iter. 53000/2000000 (2.65%): 	Loss: 4.279913902282715	recon_loss: 0.6063268780708313	embedding_loss: 3.673586845397949
13:25:02 INFO - main: Train iter. 54000/2000000 (2.7%): 	Loss: 4.107858180999756	recon_loss: 0.5967643857002258	embedding_loss: 3.511093854904175
13:25:28 INFO - main: Train iter. 55000/2000000 (2.75%): 	Loss: 4.1896562576293945	recon_loss: 0.6007550358772278	embedding_loss: 3.5889010429382324
13:25:55 INFO - main: Train iter. 56000/2000000 (2.8%): 	Loss: 3.969749689102173	recon_loss: 0.5931746959686279	embedding_loss: 3.376574993133545
13:26:22 INFO - main: Train iter. 57000/2000000 (2.85%): 	Loss: 3.9916648864746094	recon_loss: 0.5877916216850281	embedding_loss: 3.4038732051849365
13:26:49 INFO - main: Train iter. 58000/2000000 (2.9%): 	Loss: 4.062653064727783	recon_loss: 0.5916116833686829	embedding_loss: 3.471041202545166
13:27:17 INFO - main: Train iter. 59000/2000000 (2.95%): 	Loss: 3.9816272258758545	recon_loss: 0.5863221287727356	embedding_loss: 3.3953051567077637
13:27:44 INFO - main: Train iter. 60000/2000000 (3.0%): 	Loss: 3.989016056060791	recon_loss: 0.5750632286071777	embedding_loss: 3.4139528274536133
13:28:11 INFO - main: Train iter. 61000/2000000 (3.05%): 	Loss: 3.9751224517822266	recon_loss: 0.5779222249984741	embedding_loss: 3.397200107574463
13:28:38 INFO - main: Train iter. 62000/2000000 (3.1%): 	Loss: 3.781902313232422	recon_loss: 0.5649120211601257	embedding_loss: 3.2169902324676514
13:29:05 INFO - main: Train iter. 63000/2000000 (3.15%): 	Loss: 3.8976120948791504	recon_loss: 0.5708141922950745	embedding_loss: 3.3267979621887207
13:29:32 INFO - main: Train iter. 64000/2000000 (3.2%): 	Loss: 4.016000747680664	recon_loss: 0.5839507579803467	embedding_loss: 3.4320497512817383
13:29:59 INFO - main: Train iter. 65000/2000000 (3.25%): 	Loss: 3.8358559608459473	recon_loss: 0.5585995316505432	embedding_loss: 3.277256488800049
13:30:26 INFO - main: Train iter. 66000/2000000 (3.3%): 	Loss: 4.045829772949219	recon_loss: 0.5762609243392944	embedding_loss: 3.4695687294006348
13:30:54 INFO - main: Train iter. 67000/2000000 (3.35%): 	Loss: 3.945038080215454	recon_loss: 0.5675671696662903	embedding_loss: 3.3774709701538086
13:31:21 INFO - main: Train iter. 68000/2000000 (3.4%): 	Loss: 3.9842541217803955	recon_loss: 0.5814523100852966	embedding_loss: 3.402801752090454
13:31:48 INFO - main: Train iter. 69000/2000000 (3.45%): 	Loss: 3.9124629497528076	recon_loss: 0.5618469715118408	embedding_loss: 3.350615978240967
13:32:15 INFO - main: Train iter. 70000/2000000 (3.5%): 	Loss: 4.065016269683838	recon_loss: 0.5902038812637329	embedding_loss: 3.4748125076293945
13:32:42 INFO - main: Train iter. 71000/2000000 (3.55%): 	Loss: 3.9746994972229004	recon_loss: 0.5995962023735046	embedding_loss: 3.375103235244751
13:33:10 INFO - main: Train iter. 72000/2000000 (3.6%): 	Loss: 4.054978847503662	recon_loss: 0.584083616733551	embedding_loss: 3.470895290374756
13:33:37 INFO - main: Train iter. 73000/2000000 (3.65%): 	Loss: 4.048526763916016	recon_loss: 0.5970356464385986	embedding_loss: 3.451491355895996
13:34:04 INFO - main: Train iter. 74000/2000000 (3.7%): 	Loss: 3.8135018348693848	recon_loss: 0.559828519821167	embedding_loss: 3.2536733150482178
13:34:31 INFO - main: Train iter. 75000/2000000 (3.75%): 	Loss: 3.9195845127105713	recon_loss: 0.5664701461791992	embedding_loss: 3.353114366531372
13:35:00 INFO - main: Train iter. 76000/2000000 (3.8%): 	Loss: 3.910085678100586	recon_loss: 0.5674718618392944	embedding_loss: 3.342613697052002
13:35:28 INFO - main: Train iter. 77000/2000000 (3.85%): 	Loss: 3.9126288890838623	recon_loss: 0.5587513446807861	embedding_loss: 3.353877544403076
13:35:56 INFO - main: Train iter. 78000/2000000 (3.9%): 	Loss: 3.7858641147613525	recon_loss: 0.5393679738044739	embedding_loss: 3.2464962005615234
13:36:24 INFO - main: Train iter. 79000/2000000 (3.95%): 	Loss: 3.936063528060913	recon_loss: 0.5736434459686279	embedding_loss: 3.362420082092285
13:36:53 INFO - main: Train iter. 80000/2000000 (4.0%): 	Loss: 3.9689478874206543	recon_loss: 0.5602158308029175	embedding_loss: 3.4087321758270264
13:37:22 INFO - main: Train iter. 81000/2000000 (4.05%): 	Loss: 4.042802810668945	recon_loss: 0.5704294443130493	embedding_loss: 3.4723732471466064
