12:59:38 INFO - logger_setup: /home/jgryu/Weight_compression/VQ_SEEDLM/utils/util.py
12:59:38 INFO - ddp_or_single_process: Create new exp folder!
12:59:38 INFO - ddp_or_single_process: seed : 100
12:59:38 INFO - ddp_or_single_process: exp name : Meta-Llama-3-8B/mlp_64_row_dataset.pt_v101/size64_ne256_de1024_P16_batch_size1024_total_iter2000000_lr0.0001_seed100
12:59:49 INFO - main: Create experiment save folder
13:00:04 INFO - main: Training mode : scratch!
13:00:04 INFO - main: batch_size : 1024
13:00:04 INFO - main: num of gpus: 1
13:00:04 INFO - main: Namespace(dist_port=6044, iter=2000000, dataset_path='../Wparam_dataset/dataset_per_row/meta-llama/Meta-Llama-3-8B/mlp_64_row_dataset.pt', learning_rate=0.0001, num_workers=2, batch_size=1024, seed=100, input_size=64, dim_encoder=1024, P=16, n_embeddings=256, n_resblock=4, vq_beta=0.25, clip_max_norm=1.0, save_dir='checkpoint_v101', checkpoint='None', save_path='checkpoint_v101/Meta-Llama-3-8B/mlp_64_row_dataset.pt_v101/size64_ne256_de1024_P16_batch_size1024_total_iter2000000_lr0.0001_seed100', logger=<Logger utils.util (INFO)>, **{'dev.num_gpus': 1})
13:00:10 INFO - main: Train iter. 1/2000000 (5e-05%): 	Loss: 3.8369851112365723	recon_loss: 0.9991961717605591	embedding_loss: 2.8377890586853027
13:00:12 INFO - main: Average_MSE: 0.9981175789150418
13:00:12 INFO - main: can not find prev_mse_best_model!
13:00:12 INFO - main: can not find recent_saved_model!
13:00:35 INFO - main: Train iter. 1000/2000000 (0.05%): 	Loss: 26.511266708374023	recon_loss: 0.8182358741760254	embedding_loss: 25.693031311035156
13:00:57 INFO - main: Train iter. 2000/2000000 (0.1%): 	Loss: 14.682245254516602	recon_loss: 0.8197804689407349	embedding_loss: 13.862464904785156
13:01:20 INFO - main: Train iter. 3000/2000000 (0.15%): 	Loss: 10.110029220581055	recon_loss: 0.7933902740478516	embedding_loss: 9.316638946533203
13:01:42 INFO - main: Train iter. 4000/2000000 (0.2%): 	Loss: 8.445137023925781	recon_loss: 0.7999395728111267	embedding_loss: 7.645197868347168
13:02:04 INFO - main: Train iter. 5000/2000000 (0.25%): 	Loss: 7.040239334106445	recon_loss: 0.7888716459274292	embedding_loss: 6.251367568969727
13:02:26 INFO - main: Train iter. 6000/2000000 (0.3%): 	Loss: 6.115255832672119	recon_loss: 0.785891056060791	embedding_loss: 5.329364776611328
13:02:49 INFO - main: Train iter. 7000/2000000 (0.35%): 	Loss: 5.3101091384887695	recon_loss: 0.7728531360626221	embedding_loss: 4.537256240844727
13:03:11 INFO - main: Train iter. 8000/2000000 (0.4%): 	Loss: 5.1074981689453125	recon_loss: 0.772348165512085	embedding_loss: 4.335150241851807
13:03:33 INFO - main: Train iter. 9000/2000000 (0.45%): 	Loss: 4.712366580963135	recon_loss: 0.7754865288734436	embedding_loss: 3.936880111694336
13:03:56 INFO - main: Train iter. 10000/2000000 (0.5%): 	Loss: 4.463597774505615	recon_loss: 0.7703620791435242	embedding_loss: 3.6932358741760254
13:04:28 INFO - main: Train iter. 11000/2000000 (0.55%): 	Loss: 4.319554328918457	recon_loss: 0.7679987549781799	embedding_loss: 3.551555633544922
13:04:51 INFO - main: Train iter. 12000/2000000 (0.6%): 	Loss: 4.348618984222412	recon_loss: 0.7724121809005737	embedding_loss: 3.576206922531128
13:05:13 INFO - main: Train iter. 13000/2000000 (0.65%): 	Loss: 4.325558662414551	recon_loss: 0.7501601576805115	embedding_loss: 3.5753984451293945
13:05:35 INFO - main: Train iter. 14000/2000000 (0.7%): 	Loss: 4.44754695892334	recon_loss: 0.7653377056121826	embedding_loss: 3.6822092533111572
13:05:59 INFO - main: Train iter. 15000/2000000 (0.75%): 	Loss: 4.171261310577393	recon_loss: 0.7274084687232971	embedding_loss: 3.443852663040161
13:06:32 INFO - main: Train iter. 16000/2000000 (0.8%): 	Loss: 4.4313507080078125	recon_loss: 0.7419450283050537	embedding_loss: 3.689405918121338
13:06:54 INFO - main: Train iter. 17000/2000000 (0.85%): 	Loss: 4.379671096801758	recon_loss: 0.7292484641075134	embedding_loss: 3.6504225730895996
13:07:16 INFO - main: Train iter. 18000/2000000 (0.9%): 	Loss: 4.385528564453125	recon_loss: 0.7320482730865479	embedding_loss: 3.6534805297851562
13:07:39 INFO - main: Train iter. 19000/2000000 (0.95%): 	Loss: 4.367150783538818	recon_loss: 0.7244016528129578	embedding_loss: 3.642749309539795
13:08:01 INFO - main: Train iter. 20000/2000000 (1.0%): 	Loss: 4.261381149291992	recon_loss: 0.7148048877716064	embedding_loss: 3.546576499938965
13:08:23 INFO - main: Train iter. 21000/2000000 (1.05%): 	Loss: 4.362983226776123	recon_loss: 0.7270415425300598	embedding_loss: 3.635941743850708
13:08:46 INFO - main: Train iter. 22000/2000000 (1.1%): 	Loss: 4.111781120300293	recon_loss: 0.7001956105232239	embedding_loss: 3.4115853309631348
13:09:08 INFO - main: Train iter. 23000/2000000 (1.15%): 	Loss: 4.270547866821289	recon_loss: 0.7131150960922241	embedding_loss: 3.5574328899383545
13:09:31 INFO - main: Train iter. 24000/2000000 (1.2%): 	Loss: 4.145756721496582	recon_loss: 0.7107610702514648	embedding_loss: 3.434995651245117
13:09:53 INFO - main: Train iter. 25000/2000000 (1.25%): 	Loss: 3.9901132583618164	recon_loss: 0.6916562914848328	embedding_loss: 3.298456907272339
13:10:15 INFO - main: Train iter. 26000/2000000 (1.3%): 	Loss: 4.041134834289551	recon_loss: 0.694467306137085	embedding_loss: 3.346667766571045
13:10:37 INFO - main: Train iter. 27000/2000000 (1.35%): 	Loss: 4.129652976989746	recon_loss: 0.7009851932525635	embedding_loss: 3.4286675453186035
13:10:59 INFO - main: Train iter. 28000/2000000 (1.4%): 	Loss: 4.0146965980529785	recon_loss: 0.6991714835166931	embedding_loss: 3.3155250549316406
13:11:22 INFO - main: Train iter. 29000/2000000 (1.45%): 	Loss: 3.948946952819824	recon_loss: 0.6917692422866821	embedding_loss: 3.2571778297424316
13:11:45 INFO - main: Train iter. 30000/2000000 (1.5%): 	Loss: 3.9728879928588867	recon_loss: 0.6924640536308289	embedding_loss: 3.280423879623413
13:12:07 INFO - main: Train iter. 31000/2000000 (1.55%): 	Loss: 3.9339680671691895	recon_loss: 0.6826151609420776	embedding_loss: 3.2513527870178223
13:12:30 INFO - main: Train iter. 32000/2000000 (1.6%): 	Loss: 3.8112385272979736	recon_loss: 0.6759138703346252	embedding_loss: 3.135324716567993
13:12:52 INFO - main: Train iter. 33000/2000000 (1.65%): 	Loss: 3.858518600463867	recon_loss: 0.6907172203063965	embedding_loss: 3.1678013801574707
13:13:14 INFO - main: Train iter. 34000/2000000 (1.7%): 	Loss: 4.079923152923584	recon_loss: 0.7164878249168396	embedding_loss: 3.3634352684020996
13:13:37 INFO - main: Train iter. 35000/2000000 (1.75%): 	Loss: 3.7599077224731445	recon_loss: 0.6759430766105652	embedding_loss: 3.0839645862579346
13:13:59 INFO - main: Train iter. 36000/2000000 (1.8%): 	Loss: 4.003753662109375	recon_loss: 0.694374680519104	embedding_loss: 3.3093791007995605
13:14:21 INFO - main: Train iter. 37000/2000000 (1.85%): 	Loss: 3.9016127586364746	recon_loss: 0.6877847909927368	embedding_loss: 3.2138278484344482
13:14:44 INFO - main: Train iter. 38000/2000000 (1.9%): 	Loss: 3.7388696670532227	recon_loss: 0.6718916296958923	embedding_loss: 3.0669779777526855
13:15:06 INFO - main: Train iter. 39000/2000000 (1.95%): 	Loss: 3.714881420135498	recon_loss: 0.6645695567131042	embedding_loss: 3.050311803817749
13:15:28 INFO - main: Train iter. 40000/2000000 (2.0%): 	Loss: 3.8024909496307373	recon_loss: 0.6722046732902527	embedding_loss: 3.13028621673584
13:15:51 INFO - main: Train iter. 41000/2000000 (2.05%): 	Loss: 3.7679507732391357	recon_loss: 0.6663479804992676	embedding_loss: 3.101602792739868
13:16:13 INFO - main: Train iter. 42000/2000000 (2.1%): 	Loss: 3.7374496459960938	recon_loss: 0.6704114079475403	embedding_loss: 3.0670382976531982
13:16:35 INFO - main: Train iter. 43000/2000000 (2.15%): 	Loss: 3.8578546047210693	recon_loss: 0.6753230094909668	embedding_loss: 3.1825315952301025
13:16:58 INFO - main: Train iter. 44000/2000000 (2.2%): 	Loss: 3.793102979660034	recon_loss: 0.6622536778450012	embedding_loss: 3.1308493614196777
13:17:20 INFO - main: Train iter. 45000/2000000 (2.25%): 	Loss: 3.7591676712036133	recon_loss: 0.671241819858551	embedding_loss: 3.087925910949707
13:17:42 INFO - main: Train iter. 46000/2000000 (2.3%): 	Loss: 3.606621265411377	recon_loss: 0.6447063684463501	embedding_loss: 2.9619150161743164
13:18:04 INFO - main: Train iter. 47000/2000000 (2.35%): 	Loss: 3.843980312347412	recon_loss: 0.6789246797561646	embedding_loss: 3.165055513381958
13:18:26 INFO - main: Train iter. 48000/2000000 (2.4%): 	Loss: 3.7503793239593506	recon_loss: 0.6539751887321472	embedding_loss: 3.0964040756225586
13:18:48 INFO - main: Train iter. 49000/2000000 (2.45%): 	Loss: 3.770937919616699	recon_loss: 0.6659002304077148	embedding_loss: 3.1050376892089844
13:19:11 INFO - main: Train iter. 50000/2000000 (2.5%): 	Loss: 3.7328460216522217	recon_loss: 0.6559969782829285	embedding_loss: 3.0768489837646484
13:19:13 INFO - main: Average_MSE: 0.654822416785113
13:19:35 INFO - main: Train iter. 51000/2000000 (2.55%): 	Loss: 3.710965871810913	recon_loss: 0.6550846695899963	embedding_loss: 3.0558812618255615
13:19:58 INFO - main: Train iter. 52000/2000000 (2.6%): 	Loss: 3.63289213180542	recon_loss: 0.6444319486618042	embedding_loss: 2.9884603023529053
13:20:20 INFO - main: Train iter. 53000/2000000 (2.65%): 	Loss: 3.6149585247039795	recon_loss: 0.6416179537773132	embedding_loss: 2.9733405113220215
13:20:42 INFO - main: Train iter. 54000/2000000 (2.7%): 	Loss: 3.76816463470459	recon_loss: 0.6612501740455627	embedding_loss: 3.106914520263672
13:21:05 INFO - main: Train iter. 55000/2000000 (2.75%): 	Loss: 3.563443183898926	recon_loss: 0.6369732022285461	embedding_loss: 2.9264700412750244
13:21:27 INFO - main: Train iter. 56000/2000000 (2.8%): 	Loss: 3.7507901191711426	recon_loss: 0.6563340425491333	embedding_loss: 3.094456195831299
13:21:49 INFO - main: Train iter. 57000/2000000 (2.85%): 	Loss: 3.629727363586426	recon_loss: 0.638299822807312	embedding_loss: 2.991427421569824
13:22:12 INFO - main: Train iter. 58000/2000000 (2.9%): 	Loss: 3.6353611946105957	recon_loss: 0.6356428861618042	embedding_loss: 2.999718189239502
13:22:34 INFO - main: Train iter. 59000/2000000 (2.95%): 	Loss: 3.5487918853759766	recon_loss: 0.6235203742980957	embedding_loss: 2.925271511077881
13:22:57 INFO - main: Train iter. 60000/2000000 (3.0%): 	Loss: 3.704444408416748	recon_loss: 0.642383337020874	embedding_loss: 3.062061071395874
13:23:19 INFO - main: Train iter. 61000/2000000 (3.05%): 	Loss: 3.7103347778320312	recon_loss: 0.6412416100502014	embedding_loss: 3.0690932273864746
13:23:41 INFO - main: Train iter. 62000/2000000 (3.1%): 	Loss: 3.783843517303467	recon_loss: 0.6471663117408752	embedding_loss: 3.1366772651672363
13:24:03 INFO - main: Train iter. 63000/2000000 (3.15%): 	Loss: 3.774709701538086	recon_loss: 0.6553105711936951	embedding_loss: 3.119399070739746
13:24:25 INFO - main: Train iter. 64000/2000000 (3.2%): 	Loss: 3.8395652770996094	recon_loss: 0.6506608724594116	embedding_loss: 3.1889045238494873
13:24:48 INFO - main: Train iter. 65000/2000000 (3.25%): 	Loss: 3.8170809745788574	recon_loss: 0.6512218713760376	embedding_loss: 3.1658589839935303
13:25:10 INFO - main: Train iter. 66000/2000000 (3.3%): 	Loss: 3.709827184677124	recon_loss: 0.6331937313079834	embedding_loss: 3.0766334533691406
13:25:32 INFO - main: Train iter. 67000/2000000 (3.35%): 	Loss: 3.635249137878418	recon_loss: 0.6249012351036072	embedding_loss: 3.010347843170166
13:25:54 INFO - main: Train iter. 68000/2000000 (3.4%): 	Loss: 3.8621106147766113	recon_loss: 0.6529333591461182	embedding_loss: 3.209177255630493
13:26:17 INFO - main: Train iter. 69000/2000000 (3.45%): 	Loss: 3.7424819469451904	recon_loss: 0.6301352381706238	embedding_loss: 3.112346649169922
13:26:39 INFO - main: Train iter. 70000/2000000 (3.5%): 	Loss: 3.6928319931030273	recon_loss: 0.6320447325706482	embedding_loss: 3.0607872009277344
13:27:01 INFO - main: Train iter. 71000/2000000 (3.55%): 	Loss: 3.6722257137298584	recon_loss: 0.6237265467643738	embedding_loss: 3.04849910736084
13:27:24 INFO - main: Train iter. 72000/2000000 (3.6%): 	Loss: 3.9579434394836426	recon_loss: 0.652755618095398	embedding_loss: 3.305187702178955
13:27:46 INFO - main: Train iter. 73000/2000000 (3.65%): 	Loss: 3.7075300216674805	recon_loss: 0.6230778098106384	embedding_loss: 3.0844521522521973
13:28:08 INFO - main: Train iter. 74000/2000000 (3.7%): 	Loss: 3.804997444152832	recon_loss: 0.6323705315589905	embedding_loss: 3.1726269721984863
13:28:30 INFO - main: Train iter. 75000/2000000 (3.75%): 	Loss: 3.5839426517486572	recon_loss: 0.6139063239097595	embedding_loss: 2.970036268234253
13:28:52 INFO - main: Train iter. 76000/2000000 (3.8%): 	Loss: 3.756882667541504	recon_loss: 0.6161636710166931	embedding_loss: 3.140718936920166
13:29:15 INFO - main: Train iter. 77000/2000000 (3.85%): 	Loss: 3.6593732833862305	recon_loss: 0.6110683083534241	embedding_loss: 3.048305034637451
13:29:37 INFO - main: Train iter. 78000/2000000 (3.9%): 	Loss: 3.6117911338806152	recon_loss: 0.6015321016311646	embedding_loss: 3.010258913040161
13:29:59 INFO - main: Train iter. 79000/2000000 (3.95%): 	Loss: 3.650604009628296	recon_loss: 0.6078128814697266	embedding_loss: 3.0427911281585693
13:30:22 INFO - main: Train iter. 80000/2000000 (4.0%): 	Loss: 3.877697706222534	recon_loss: 0.6300612092018127	embedding_loss: 3.247636556625366
13:30:44 INFO - main: Train iter. 81000/2000000 (4.05%): 	Loss: 3.832259178161621	recon_loss: 0.6294678449630737	embedding_loss: 3.202791213989258
13:31:07 INFO - main: Train iter. 82000/2000000 (4.1%): 	Loss: 3.808332681655884	recon_loss: 0.6146814227104187	embedding_loss: 3.1936511993408203
13:31:29 INFO - main: Train iter. 83000/2000000 (4.15%): 	Loss: 3.84399151802063	recon_loss: 0.6135911345481873	embedding_loss: 3.230400323867798
13:31:51 INFO - main: Train iter. 84000/2000000 (4.2%): 	Loss: 4.077282428741455	recon_loss: 0.6435303688049316	embedding_loss: 3.4337520599365234
13:32:14 INFO - main: Train iter. 85000/2000000 (4.25%): 	Loss: 4.0227766036987305	recon_loss: 0.6346923112869263	embedding_loss: 3.3880841732025146
13:32:36 INFO - main: Train iter. 86000/2000000 (4.3%): 	Loss: 3.9449234008789062	recon_loss: 0.6250472068786621	embedding_loss: 3.319876194000244
13:33:09 INFO - main: Train iter. 87000/2000000 (4.35%): 	Loss: 3.9347660541534424	recon_loss: 0.6217504143714905	embedding_loss: 3.3130156993865967
13:33:32 INFO - main: Train iter. 88000/2000000 (4.4%): 	Loss: 3.950194835662842	recon_loss: 0.6210374236106873	embedding_loss: 3.3291573524475098
13:33:54 INFO - main: Train iter. 89000/2000000 (4.45%): 	Loss: 3.83370304107666	recon_loss: 0.6057224273681641	embedding_loss: 3.227980613708496
13:34:16 INFO - main: Train iter. 90000/2000000 (4.5%): 	Loss: 3.834989547729492	recon_loss: 0.6059894561767578	embedding_loss: 3.2290000915527344
13:34:38 INFO - main: Train iter. 91000/2000000 (4.55%): 	Loss: 3.9535093307495117	recon_loss: 0.6174222230911255	embedding_loss: 3.336087226867676
13:35:03 INFO - main: Train iter. 92000/2000000 (4.6%): 	Loss: 3.886484384536743	recon_loss: 0.6102859973907471	embedding_loss: 3.276198387145996
13:35:25 INFO - main: Train iter. 93000/2000000 (4.65%): 	Loss: 3.830331325531006	recon_loss: 0.599347710609436	embedding_loss: 3.2309837341308594
13:35:47 INFO - main: Train iter. 94000/2000000 (4.7%): 	Loss: 3.7237393856048584	recon_loss: 0.5884897708892822	embedding_loss: 3.135249614715576
13:36:09 INFO - main: Train iter. 95000/2000000 (4.75%): 	Loss: 3.7813332080841064	recon_loss: 0.5943577289581299	embedding_loss: 3.1869754791259766
13:36:31 INFO - main: Train iter. 96000/2000000 (4.8%): 	Loss: 3.8578333854675293	recon_loss: 0.6027047038078308	embedding_loss: 3.2551286220550537
13:36:54 INFO - main: Train iter. 97000/2000000 (4.85%): 	Loss: 3.9420933723449707	recon_loss: 0.6016073226928711	embedding_loss: 3.3404860496520996
13:37:16 INFO - main: Train iter. 98000/2000000 (4.9%): 	Loss: 3.9048380851745605	recon_loss: 0.6028085947036743	embedding_loss: 3.3020293712615967
13:37:38 INFO - main: Train iter. 99000/2000000 (4.95%): 	Loss: 3.8217363357543945	recon_loss: 0.585663914680481	embedding_loss: 3.236072540283203
