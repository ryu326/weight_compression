[Stage: Convert to HF format] K=4
W0413 09:41:00.634992 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/lib/codebook/__init__.py:6: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::decode_matvec_e8p")

W0413 09:41:00.666809 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/lib/codebook/__init__.py:25: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::decompress_packed_e8p")

I0413 09:41:00.961698 852166 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0413 09:41:00.961823 852166 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0413 09:41:00.961868 852166 utils.py:162] NumExpr defaulting to 16 threads.
I0413 09:41:01.079657 852166 config.py:58] PyTorch version 2.4.0 available.
W0413 09:41:01.441537 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/lib/utils/matmul_had.py:92: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")

W0413 09:41:22.421317 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/quantize_llama/hfize_llama.py:23: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  saved_config = torch.load(os.path.join(args.quantized_path, 'config.pt'))

W0413 09:41:22.422458 852166 warnings.py:110] /opt/conda/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(

Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  8.51it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  8.66it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  9.47it/s]
Some weights of the model checkpoint at meta-llama/Meta-Llama-3-8B were not used when initializing LlamaForCausalLM: ['model.layers.0.mlp.down_proj.weight', 'model.layers.0.mlp.gate_proj.weight', 'model.layers.0.mlp.up_proj.weight', 'model.layers.0.self_attn.k_proj.weight', 'model.layers.0.self_attn.o_proj.weight', 'model.layers.0.self_attn.q_proj.weight', 'model.layers.0.self_attn.v_proj.weight', 'model.layers.1.mlp.down_proj.weight', 'model.layers.1.mlp.gate_proj.weight', 'model.layers.1.mlp.up_proj.weight', 'model.layers.1.self_attn.k_proj.weight', 'model.layers.1.self_attn.o_proj.weight', 'model.layers.1.self_attn.q_proj.weight', 'model.layers.1.self_attn.v_proj.weight', 'model.layers.10.mlp.down_proj.weight', 'model.layers.10.mlp.gate_proj.weight', 'model.layers.10.mlp.up_proj.weight', 'model.layers.10.self_attn.k_proj.weight', 'model.layers.10.self_attn.o_proj.weight', 'model.layers.10.self_attn.q_proj.weight', 'model.layers.10.self_attn.v_proj.weight', 'model.layers.11.mlp.down_proj.weight', 'model.layers.11.mlp.gate_proj.weight', 'model.layers.11.mlp.up_proj.weight', 'model.layers.11.self_attn.k_proj.weight', 'model.layers.11.self_attn.o_proj.weight', 'model.layers.11.self_attn.q_proj.weight', 'model.layers.11.self_attn.v_proj.weight', 'model.layers.12.mlp.down_proj.weight', 'model.layers.12.mlp.gate_proj.weight', 'model.layers.12.mlp.up_proj.weight', 'model.layers.12.self_attn.k_proj.weight', 'model.layers.12.self_attn.o_proj.weight', 'model.layers.12.self_attn.q_proj.weight', 'model.layers.12.self_attn.v_proj.weight', 'model.layers.13.mlp.down_proj.weight', 'model.layers.13.mlp.gate_proj.weight', 'model.layers.13.mlp.up_proj.weight', 'model.layers.13.self_attn.k_proj.weight', 'model.layers.13.self_attn.o_proj.weight', 'model.layers.13.self_attn.q_proj.weight', 'model.layers.13.self_attn.v_proj.weight', 'model.layers.14.mlp.down_proj.weight', 'model.layers.14.mlp.gate_proj.weight', 'model.layers.14.mlp.up_proj.weight', 'model.layers.14.self_attn.k_proj.weight', 'model.layers.14.self_attn.o_proj.weight', 'model.layers.14.self_attn.q_proj.weight', 'model.layers.14.self_attn.v_proj.weight', 'model.layers.15.mlp.down_proj.weight', 'model.layers.15.mlp.gate_proj.weight', 'model.layers.15.mlp.up_proj.weight', 'model.layers.15.self_attn.k_proj.weight', 'model.layers.15.self_attn.o_proj.weight', 'model.layers.15.self_attn.q_proj.weight', 'model.layers.15.self_attn.v_proj.weight', 'model.layers.16.mlp.down_proj.weight', 'model.layers.16.mlp.gate_proj.weight', 'model.layers.16.mlp.up_proj.weight', 'model.layers.16.self_attn.k_proj.weight', 'model.layers.16.self_attn.o_proj.weight', 'model.layers.16.self_attn.q_proj.weight', 'model.layers.16.self_attn.v_proj.weight', 'model.layers.17.mlp.down_proj.weight', 'model.layers.17.mlp.gate_proj.weight', 'model.layers.17.mlp.up_proj.weight', 'model.layers.17.self_attn.k_proj.weight', 'model.layers.17.self_attn.o_proj.weight', 'model.layers.17.self_attn.q_proj.weight', 'model.layers.17.self_attn.v_proj.weight', 'model.layers.18.mlp.down_proj.weight', 'model.layers.18.mlp.gate_proj.weight', 'model.layers.18.mlp.up_proj.weight', 'model.layers.18.self_attn.k_proj.weight', 'model.layers.18.self_attn.o_proj.weight', 'model.layers.18.self_attn.q_proj.weight', 'model.layers.18.self_attn.v_proj.weight', 'model.layers.19.mlp.down_proj.weight', 'model.layers.19.mlp.gate_proj.weight', 'model.layers.19.mlp.up_proj.weight', 'model.layers.19.self_attn.k_proj.weight', 'model.layers.19.self_attn.o_proj.weight', 'model.layers.19.self_attn.q_proj.weight', 'model.layers.19.self_attn.v_proj.weight', 'model.layers.2.mlp.down_proj.weight', 'model.layers.2.mlp.gate_proj.weight', 'model.layers.2.mlp.up_proj.weight', 'model.layers.2.self_attn.k_proj.weight', 'model.layers.2.self_attn.o_proj.weight', 'model.layers.2.self_attn.q_proj.weight', 'model.layers.2.self_attn.v_proj.weight', 'model.layers.20.mlp.down_proj.weight', 'model.layers.20.mlp.gate_proj.weight', 'model.layers.20.mlp.up_proj.weight', 'model.layers.20.self_attn.k_proj.weight', 'model.layers.20.self_attn.o_proj.weight', 'model.layers.20.self_attn.q_proj.weight', 'model.layers.20.self_attn.v_proj.weight', 'model.layers.21.mlp.down_proj.weight', 'model.layers.21.mlp.gate_proj.weight', 'model.layers.21.mlp.up_proj.weight', 'model.layers.21.self_attn.k_proj.weight', 'model.layers.21.self_attn.o_proj.weight', 'model.layers.21.self_attn.q_proj.weight', 'model.layers.21.self_attn.v_proj.weight', 'model.layers.22.mlp.down_proj.weight', 'model.layers.22.mlp.gate_proj.weight', 'model.layers.22.mlp.up_proj.weight', 'model.layers.22.self_attn.k_proj.weight', 'model.layers.22.self_attn.o_proj.weight', 'model.layers.22.self_attn.q_proj.weight', 'model.layers.22.self_attn.v_proj.weight', 'model.layers.23.mlp.down_proj.weight', 'model.layers.23.mlp.gate_proj.weight', 'model.layers.23.mlp.up_proj.weight', 'model.layers.23.self_attn.k_proj.weight', 'model.layers.23.self_attn.o_proj.weight', 'model.layers.23.self_attn.q_proj.weight', 'model.layers.23.self_attn.v_proj.weight', 'model.layers.24.mlp.down_proj.weight', 'model.layers.24.mlp.gate_proj.weight', 'model.layers.24.mlp.up_proj.weight', 'model.layers.24.self_attn.k_proj.weight', 'model.layers.24.self_attn.o_proj.weight', 'model.layers.24.self_attn.q_proj.weight', 'model.layers.24.self_attn.v_proj.weight', 'model.layers.25.mlp.down_proj.weight', 'model.layers.25.mlp.gate_proj.weight', 'model.layers.25.mlp.up_proj.weight', 'model.layers.25.self_attn.k_proj.weight', 'model.layers.25.self_attn.o_proj.weight', 'model.layers.25.self_attn.q_proj.weight', 'model.layers.25.self_attn.v_proj.weight', 'model.layers.26.mlp.down_proj.weight', 'model.layers.26.mlp.gate_proj.weight', 'model.layers.26.mlp.up_proj.weight', 'model.layers.26.self_attn.k_proj.weight', 'model.layers.26.self_attn.o_proj.weight', 'model.layers.26.self_attn.q_proj.weight', 'model.layers.26.self_attn.v_proj.weight', 'model.layers.27.mlp.down_proj.weight', 'model.layers.27.mlp.gate_proj.weight', 'model.layers.27.mlp.up_proj.weight', 'model.layers.27.self_attn.k_proj.weight', 'model.layers.27.self_attn.o_proj.weight', 'model.layers.27.self_attn.q_proj.weight', 'model.layers.27.self_attn.v_proj.weight', 'model.layers.28.mlp.down_proj.weight', 'model.layers.28.mlp.gate_proj.weight', 'model.layers.28.mlp.up_proj.weight', 'model.layers.28.self_attn.k_proj.weight', 'model.layers.28.self_attn.o_proj.weight', 'model.layers.28.self_attn.q_proj.weight', 'model.layers.28.self_attn.v_proj.weight', 'model.layers.29.mlp.down_proj.weight', 'model.layers.29.mlp.gate_proj.weight', 'model.layers.29.mlp.up_proj.weight', 'model.layers.29.self_attn.k_proj.weight', 'model.layers.29.self_attn.o_proj.weight', 'model.layers.29.self_attn.q_proj.weight', 'model.layers.29.self_attn.v_proj.weight', 'model.layers.3.mlp.down_proj.weight', 'model.layers.3.mlp.gate_proj.weight', 'model.layers.3.mlp.up_proj.weight', 'model.layers.3.self_attn.k_proj.weight', 'model.layers.3.self_attn.o_proj.weight', 'model.layers.3.self_attn.q_proj.weight', 'model.layers.3.self_attn.v_proj.weight', 'model.layers.30.mlp.down_proj.weight', 'model.layers.30.mlp.gate_proj.weight', 'model.layers.30.mlp.up_proj.weight', 'model.layers.30.self_attn.k_proj.weight', 'model.layers.30.self_attn.o_proj.weight', 'model.layers.30.self_attn.q_proj.weight', 'model.layers.30.self_attn.v_proj.weight', 'model.layers.31.mlp.down_proj.weight', 'model.layers.31.mlp.gate_proj.weight', 'model.layers.31.mlp.up_proj.weight', 'model.layers.31.self_attn.k_proj.weight', 'model.layers.31.self_attn.o_proj.weight', 'model.layers.31.self_attn.q_proj.weight', 'model.layers.31.self_attn.v_proj.weight', 'model.layers.4.mlp.down_proj.weight', 'model.layers.4.mlp.gate_proj.weight', 'model.layers.4.mlp.up_proj.weight', 'model.layers.4.self_attn.k_proj.weight', 'model.layers.4.self_attn.o_proj.weight', 'model.layers.4.self_attn.q_proj.weight', 'model.layers.4.self_attn.v_proj.weight', 'model.layers.5.mlp.down_proj.weight', 'model.layers.5.mlp.gate_proj.weight', 'model.layers.5.mlp.up_proj.weight', 'model.layers.5.self_attn.k_proj.weight', 'model.layers.5.self_attn.o_proj.weight', 'model.layers.5.self_attn.q_proj.weight', 'model.layers.5.self_attn.v_proj.weight', 'model.layers.6.mlp.down_proj.weight', 'model.layers.6.mlp.gate_proj.weight', 'model.layers.6.mlp.up_proj.weight', 'model.layers.6.self_attn.k_proj.weight', 'model.layers.6.self_attn.o_proj.weight', 'model.layers.6.self_attn.q_proj.weight', 'model.layers.6.self_attn.v_proj.weight', 'model.layers.7.mlp.down_proj.weight', 'model.layers.7.mlp.gate_proj.weight', 'model.layers.7.mlp.up_proj.weight', 'model.layers.7.self_attn.k_proj.weight', 'model.layers.7.self_attn.o_proj.weight', 'model.layers.7.self_attn.q_proj.weight', 'model.layers.7.self_attn.v_proj.weight', 'model.layers.8.mlp.down_proj.weight', 'model.layers.8.mlp.gate_proj.weight', 'model.layers.8.mlp.up_proj.weight', 'model.layers.8.self_attn.k_proj.weight', 'model.layers.8.self_attn.o_proj.weight', 'model.layers.8.self_attn.q_proj.weight', 'model.layers.8.self_attn.v_proj.weight', 'model.layers.9.mlp.down_proj.weight', 'model.layers.9.mlp.gate_proj.weight', 'model.layers.9.mlp.up_proj.weight', 'model.layers.9.self_attn.k_proj.weight', 'model.layers.9.self_attn.o_proj.weight', 'model.layers.9.self_attn.q_proj.weight', 'model.layers.9.self_attn.v_proj.weight']
- This IS expected if you are initializing LlamaForCausalLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LlamaForCausalLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of LlamaForCausalLM were not initialized from the model checkpoint at meta-llama/Meta-Llama-3-8B and are newly initialized: ['model.layers.0.mlp.down_proj.Qidxs', 'model.layers.0.mlp.down_proj.SU', 'model.layers.0.mlp.down_proj.SV', 'model.layers.0.mlp.down_proj.Wscale', 'model.layers.0.mlp.down_proj.codebook_id', 'model.layers.0.mlp.upgate_proj.Qidxs', 'model.layers.0.mlp.upgate_proj.SU', 'model.layers.0.mlp.upgate_proj.SV', 'model.layers.0.mlp.upgate_proj.Wscale', 'model.layers.0.mlp.upgate_proj.codebook_id', 'model.layers.0.mlp.upgate_proj.fuse_scales', 'model.layers.0.self_attn.o_proj.Qidxs', 'model.layers.0.self_attn.o_proj.SU', 'model.layers.0.self_attn.o_proj.SV', 'model.layers.0.self_attn.o_proj.Wscale', 'model.layers.0.self_attn.o_proj.codebook_id', 'model.layers.0.self_attn.qkv_proj.Qidxs', 'model.layers.0.self_attn.qkv_proj.SU', 'model.layers.0.self_attn.qkv_proj.SV', 'model.layers.0.self_attn.qkv_proj.Wscale', 'model.layers.0.self_attn.qkv_proj.codebook_id', 'model.layers.0.self_attn.qkv_proj.fuse_scales', 'model.layers.1.mlp.down_proj.Qidxs', 'model.layers.1.mlp.down_proj.SU', 'model.layers.1.mlp.down_proj.SV', 'model.layers.1.mlp.down_proj.Wscale', 'model.layers.1.mlp.down_proj.codebook_id', 'model.layers.1.mlp.upgate_proj.Qidxs', 'model.layers.1.mlp.upgate_proj.SU', 'model.layers.1.mlp.upgate_proj.SV', 'model.layers.1.mlp.upgate_proj.Wscale', 'model.layers.1.mlp.upgate_proj.codebook_id', 'model.layers.1.mlp.upgate_proj.fuse_scales', 'model.layers.1.self_attn.o_proj.Qidxs', 'model.layers.1.self_attn.o_proj.SU', 'model.layers.1.self_attn.o_proj.SV', 'model.layers.1.self_attn.o_proj.Wscale', 'model.layers.1.self_attn.o_proj.codebook_id', 'model.layers.1.self_attn.qkv_proj.Qidxs', 'model.layers.1.self_attn.qkv_proj.SU', 'model.layers.1.self_attn.qkv_proj.SV', 'model.layers.1.self_attn.qkv_proj.Wscale', 'model.layers.1.self_attn.qkv_proj.codebook_id', 'model.layers.1.self_attn.qkv_proj.fuse_scales', 'model.layers.10.mlp.down_proj.Qidxs', 'model.layers.10.mlp.down_proj.SU', 'model.layers.10.mlp.down_proj.SV', 'model.layers.10.mlp.down_proj.Wscale', 'model.layers.10.mlp.down_proj.codebook_id', 'model.layers.10.mlp.upgate_proj.Qidxs', 'model.layers.10.mlp.upgate_proj.SU', 'model.layers.10.mlp.upgate_proj.SV', 'model.layers.10.mlp.upgate_proj.Wscale', 'model.layers.10.mlp.upgate_proj.codebook_id', 'model.layers.10.mlp.upgate_proj.fuse_scales', 'model.layers.10.self_attn.o_proj.Qidxs', 'model.layers.10.self_attn.o_proj.SU', 'model.layers.10.self_attn.o_proj.SV', 'model.layers.10.self_attn.o_proj.Wscale', 'model.layers.10.self_attn.o_proj.codebook_id', 'model.layers.10.self_attn.qkv_proj.Qidxs', 'model.layers.10.self_attn.qkv_proj.SU', 'model.layers.10.self_attn.qkv_proj.SV', 'model.layers.10.self_attn.qkv_proj.Wscale', 'model.layers.10.self_attn.qkv_proj.codebook_id', 'model.layers.10.self_attn.qkv_proj.fuse_scales', 'model.layers.11.mlp.down_proj.Qidxs', 'model.layers.11.mlp.down_proj.SU', 'model.layers.11.mlp.down_proj.SV', 'model.layers.11.mlp.down_proj.Wscale', 'model.layers.11.mlp.down_proj.codebook_id', 'model.layers.11.mlp.upgate_proj.Qidxs', 'model.layers.11.mlp.upgate_proj.SU', 'model.layers.11.mlp.upgate_proj.SV', 'model.layers.11.mlp.upgate_proj.Wscale', 'model.layers.11.mlp.upgate_proj.codebook_id', 'model.layers.11.mlp.upgate_proj.fuse_scales', 'model.layers.11.self_attn.o_proj.Qidxs', 'model.layers.11.self_attn.o_proj.SU', 'model.layers.11.self_attn.o_proj.SV', 'model.layers.11.self_attn.o_proj.Wscale', 'model.layers.11.self_attn.o_proj.codebook_id', 'model.layers.11.self_attn.qkv_proj.Qidxs', 'model.layers.11.self_attn.qkv_proj.SU', 'model.layers.11.self_attn.qkv_proj.SV', 'model.layers.11.self_attn.qkv_proj.Wscale', 'model.layers.11.self_attn.qkv_proj.codebook_id', 'model.layers.11.self_attn.qkv_proj.fuse_scales', 'model.layers.12.mlp.down_proj.Qidxs', 'model.layers.12.mlp.down_proj.SU', 'model.layers.12.mlp.down_proj.SV', 'model.layers.12.mlp.down_proj.Wscale', 'model.layers.12.mlp.down_proj.codebook_id', 'model.layers.12.mlp.upgate_proj.Qidxs', 'model.layers.12.mlp.upgate_proj.SU', 'model.layers.12.mlp.upgate_proj.SV', 'model.layers.12.mlp.upgate_proj.Wscale', 'model.layers.12.mlp.upgate_proj.codebook_id', 'model.layers.12.mlp.upgate_proj.fuse_scales', 'model.layers.12.self_attn.o_proj.Qidxs', 'model.layers.12.self_attn.o_proj.SU', 'model.layers.12.self_attn.o_proj.SV', 'model.layers.12.self_attn.o_proj.Wscale', 'model.layers.12.self_attn.o_proj.codebook_id', 'model.layers.12.self_attn.qkv_proj.Qidxs', 'model.layers.12.self_attn.qkv_proj.SU', 'model.layers.12.self_attn.qkv_proj.SV', 'model.layers.12.self_attn.qkv_proj.Wscale', 'model.layers.12.self_attn.qkv_proj.codebook_id', 'model.layers.12.self_attn.qkv_proj.fuse_scales', 'model.layers.13.mlp.down_proj.Qidxs', 'model.layers.13.mlp.down_proj.SU', 'model.layers.13.mlp.down_proj.SV', 'model.layers.13.mlp.down_proj.Wscale', 'model.layers.13.mlp.down_proj.codebook_id', 'model.layers.13.mlp.upgate_proj.Qidxs', 'model.layers.13.mlp.upgate_proj.SU', 'model.layers.13.mlp.upgate_proj.SV', 'model.layers.13.mlp.upgate_proj.Wscale', 'model.layers.13.mlp.upgate_proj.codebook_id', 'model.layers.13.mlp.upgate_proj.fuse_scales', 'model.layers.13.self_attn.o_proj.Qidxs', 'model.layers.13.self_attn.o_proj.SU', 'model.layers.13.self_attn.o_proj.SV', 'model.layers.13.self_attn.o_proj.Wscale', 'model.layers.13.self_attn.o_proj.codebook_id', 'model.layers.13.self_attn.qkv_proj.Qidxs', 'model.layers.13.self_attn.qkv_proj.SU', 'model.layers.13.self_attn.qkv_proj.SV', 'model.layers.13.self_attn.qkv_proj.Wscale', 'model.layers.13.self_attn.qkv_proj.codebook_id', 'model.layers.13.self_attn.qkv_proj.fuse_scales', 'model.layers.14.mlp.down_proj.Qidxs', 'model.layers.14.mlp.down_proj.SU', 'model.layers.14.mlp.down_proj.SV', 'model.layers.14.mlp.down_proj.Wscale', 'model.layers.14.mlp.down_proj.codebook_id', 'model.layers.14.mlp.upgate_proj.Qidxs', 'model.layers.14.mlp.upgate_proj.SU', 'model.layers.14.mlp.upgate_proj.SV', 'model.layers.14.mlp.upgate_proj.Wscale', 'model.layers.14.mlp.upgate_proj.codebook_id', 'model.layers.14.mlp.upgate_proj.fuse_scales', 'model.layers.14.self_attn.o_proj.Qidxs', 'model.layers.14.self_attn.o_proj.SU', 'model.layers.14.self_attn.o_proj.SV', 'model.layers.14.self_attn.o_proj.Wscale', 'model.layers.14.self_attn.o_proj.codebook_id', 'model.layers.14.self_attn.qkv_proj.Qidxs', 'model.layers.14.self_attn.qkv_proj.SU', 'model.layers.14.self_attn.qkv_proj.SV', 'model.layers.14.self_attn.qkv_proj.Wscale', 'model.layers.14.self_attn.qkv_proj.codebook_id', 'model.layers.14.self_attn.qkv_proj.fuse_scales', 'model.layers.15.mlp.down_proj.Qidxs', 'model.layers.15.mlp.down_proj.SU', 'model.layers.15.mlp.down_proj.SV', 'model.layers.15.mlp.down_proj.Wscale', 'model.layers.15.mlp.down_proj.codebook_id', 'model.layers.15.mlp.upgate_proj.Qidxs', 'model.layers.15.mlp.upgate_proj.SU', 'model.layers.15.mlp.upgate_proj.SV', 'model.layers.15.mlp.upgate_proj.Wscale', 'model.layers.15.mlp.upgate_proj.codebook_id', 'model.layers.15.mlp.upgate_proj.fuse_scales', 'model.layers.15.self_attn.o_proj.Qidxs', 'model.layers.15.self_attn.o_proj.SU', 'model.layers.15.self_attn.o_proj.SV', 'model.layers.15.self_attn.o_proj.Wscale', 'model.layers.15.self_attn.o_proj.codebook_id', 'model.layers.15.self_attn.qkv_proj.Qidxs', 'model.layers.15.self_attn.qkv_proj.SU', 'model.layers.15.self_attn.qkv_proj.SV', 'model.layers.15.self_attn.qkv_proj.Wscale', 'model.layers.15.self_attn.qkv_proj.codebook_id', 'model.layers.15.self_attn.qkv_proj.fuse_scales', 'model.layers.16.mlp.down_proj.Qidxs', 'model.layers.16.mlp.down_proj.SU', 'model.layers.16.mlp.down_proj.SV', 'model.layers.16.mlp.down_proj.Wscale', 'model.layers.16.mlp.down_proj.codebook_id', 'model.layers.16.mlp.upgate_proj.Qidxs', 'model.layers.16.mlp.upgate_proj.SU', 'model.layers.16.mlp.upgate_proj.SV', 'model.layers.16.mlp.upgate_proj.Wscale', 'model.layers.16.mlp.upgate_proj.codebook_id', 'model.layers.16.mlp.upgate_proj.fuse_scales', 'model.layers.16.self_attn.o_proj.Qidxs', 'model.layers.16.self_attn.o_proj.SU', 'model.layers.16.self_attn.o_proj.SV', 'model.layers.16.self_attn.o_proj.Wscale', 'model.layers.16.self_attn.o_proj.codebook_id', 'model.layers.16.self_attn.qkv_proj.Qidxs', 'model.layers.16.self_attn.qkv_proj.SU', 'model.layers.16.self_attn.qkv_proj.SV', 'model.layers.16.self_attn.qkv_proj.Wscale', 'model.layers.16.self_attn.qkv_proj.codebook_id', 'model.layers.16.self_attn.qkv_proj.fuse_scales', 'model.layers.17.mlp.down_proj.Qidxs', 'model.layers.17.mlp.down_proj.SU', 'model.layers.17.mlp.down_proj.SV', 'model.layers.17.mlp.down_proj.Wscale', 'model.layers.17.mlp.down_proj.codebook_id', 'model.layers.17.mlp.upgate_proj.Qidxs', 'model.layers.17.mlp.upgate_proj.SU', 'model.layers.17.mlp.upgate_proj.SV', 'model.layers.17.mlp.upgate_proj.Wscale', 'model.layers.17.mlp.upgate_proj.codebook_id', 'model.layers.17.mlp.upgate_proj.fuse_scales', 'model.layers.17.self_attn.o_proj.Qidxs', 'model.layers.17.self_attn.o_proj.SU', 'model.layers.17.self_attn.o_proj.SV', 'model.layers.17.self_attn.o_proj.Wscale', 'model.layers.17.self_attn.o_proj.codebook_id', 'model.layers.17.self_attn.qkv_proj.Qidxs', 'model.layers.17.self_attn.qkv_proj.SU', 'model.layers.17.self_attn.qkv_proj.SV', 'model.layers.17.self_attn.qkv_proj.Wscale', 'model.layers.17.self_attn.qkv_proj.codebook_id', 'model.layers.17.self_attn.qkv_proj.fuse_scales', 'model.layers.18.mlp.down_proj.Qidxs', 'model.layers.18.mlp.down_proj.SU', 'model.layers.18.mlp.down_proj.SV', 'model.layers.18.mlp.down_proj.Wscale', 'model.layers.18.mlp.down_proj.codebook_id', 'model.layers.18.mlp.upgate_proj.Qidxs', 'model.layers.18.mlp.upgate_proj.SU', 'model.layers.18.mlp.upgate_proj.SV', 'model.layers.18.mlp.upgate_proj.Wscale', 'model.layers.18.mlp.upgate_proj.codebook_id', 'model.layers.18.mlp.upgate_proj.fuse_scales', 'model.layers.18.self_attn.o_proj.Qidxs', 'model.layers.18.self_attn.o_proj.SU', 'model.layers.18.self_attn.o_proj.SV', 'model.layers.18.self_attn.o_proj.Wscale', 'model.layers.18.self_attn.o_proj.codebook_id', 'model.layers.18.self_attn.qkv_proj.Qidxs', 'model.layers.18.self_attn.qkv_proj.SU', 'model.layers.18.self_attn.qkv_proj.SV', 'model.layers.18.self_attn.qkv_proj.Wscale', 'model.layers.18.self_attn.qkv_proj.codebook_id', 'model.layers.18.self_attn.qkv_proj.fuse_scales', 'model.layers.19.mlp.down_proj.Qidxs', 'model.layers.19.mlp.down_proj.SU', 'model.layers.19.mlp.down_proj.SV', 'model.layers.19.mlp.down_proj.Wscale', 'model.layers.19.mlp.down_proj.codebook_id', 'model.layers.19.mlp.upgate_proj.Qidxs', 'model.layers.19.mlp.upgate_proj.SU', 'model.layers.19.mlp.upgate_proj.SV', 'model.layers.19.mlp.upgate_proj.Wscale', 'model.layers.19.mlp.upgate_proj.codebook_id', 'model.layers.19.mlp.upgate_proj.fuse_scales', 'model.layers.19.self_attn.o_proj.Qidxs', 'model.layers.19.self_attn.o_proj.SU', 'model.layers.19.self_attn.o_proj.SV', 'model.layers.19.self_attn.o_proj.Wscale', 'model.layers.19.self_attn.o_proj.codebook_id', 'model.layers.19.self_attn.qkv_proj.Qidxs', 'model.layers.19.self_attn.qkv_proj.SU', 'model.layers.19.self_attn.qkv_proj.SV', 'model.layers.19.self_attn.qkv_proj.Wscale', 'model.layers.19.self_attn.qkv_proj.codebook_id', 'model.layers.19.self_attn.qkv_proj.fuse_scales', 'model.layers.2.mlp.down_proj.Qidxs', 'model.layers.2.mlp.down_proj.SU', 'model.layers.2.mlp.down_proj.SV', 'model.layers.2.mlp.down_proj.Wscale', 'model.layers.2.mlp.down_proj.codebook_id', 'model.layers.2.mlp.upgate_proj.Qidxs', 'model.layers.2.mlp.upgate_proj.SU', 'model.layers.2.mlp.upgate_proj.SV', 'model.layers.2.mlp.upgate_proj.Wscale', 'model.layers.2.mlp.upgate_proj.codebook_id', 'model.layers.2.mlp.upgate_proj.fuse_scales', 'model.layers.2.self_attn.o_proj.Qidxs', 'model.layers.2.self_attn.o_proj.SU', 'model.layers.2.self_attn.o_proj.SV', 'model.layers.2.self_attn.o_proj.Wscale', 'model.layers.2.self_attn.o_proj.codebook_id', 'model.layers.2.self_attn.qkv_proj.Qidxs', 'model.layers.2.self_attn.qkv_proj.SU', 'model.layers.2.self_attn.qkv_proj.SV', 'model.layers.2.self_attn.qkv_proj.Wscale', 'model.layers.2.self_attn.qkv_proj.codebook_id', 'model.layers.2.self_attn.qkv_proj.fuse_scales', 'model.layers.20.mlp.down_proj.Qidxs', 'model.layers.20.mlp.down_proj.SU', 'model.layers.20.mlp.down_proj.SV', 'model.layers.20.mlp.down_proj.Wscale', 'model.layers.20.mlp.down_proj.codebook_id', 'model.layers.20.mlp.upgate_proj.Qidxs', 'model.layers.20.mlp.upgate_proj.SU', 'model.layers.20.mlp.upgate_proj.SV', 'model.layers.20.mlp.upgate_proj.Wscale', 'model.layers.20.mlp.upgate_proj.codebook_id', 'model.layers.20.mlp.upgate_proj.fuse_scales', 'model.layers.20.self_attn.o_proj.Qidxs', 'model.layers.20.self_attn.o_proj.SU', 'model.layers.20.self_attn.o_proj.SV', 'model.layers.20.self_attn.o_proj.Wscale', 'model.layers.20.self_attn.o_proj.codebook_id', 'model.layers.20.self_attn.qkv_proj.Qidxs', 'model.layers.20.self_attn.qkv_proj.SU', 'model.layers.20.self_attn.qkv_proj.SV', 'model.layers.20.self_attn.qkv_proj.Wscale', 'model.layers.20.self_attn.qkv_proj.codebook_id', 'model.layers.20.self_attn.qkv_proj.fuse_scales', 'model.layers.21.mlp.down_proj.Qidxs', 'model.layers.21.mlp.down_proj.SU', 'model.layers.21.mlp.down_proj.SV', 'model.layers.21.mlp.down_proj.Wscale', 'model.layers.21.mlp.down_proj.codebook_id', 'model.layers.21.mlp.upgate_proj.Qidxs', 'model.layers.21.mlp.upgate_proj.SU', 'model.layers.21.mlp.upgate_proj.SV', 'model.layers.21.mlp.upgate_proj.Wscale', 'model.layers.21.mlp.upgate_proj.codebook_id', 'model.layers.21.mlp.upgate_proj.fuse_scales', 'model.layers.21.self_attn.o_proj.Qidxs', 'model.layers.21.self_attn.o_proj.SU', 'model.layers.21.self_attn.o_proj.SV', 'model.layers.21.self_attn.o_proj.Wscale', 'model.layers.21.self_attn.o_proj.codebook_id', 'model.layers.21.self_attn.qkv_proj.Qidxs', 'model.layers.21.self_attn.qkv_proj.SU', 'model.layers.21.self_attn.qkv_proj.SV', 'model.layers.21.self_attn.qkv_proj.Wscale', 'model.layers.21.self_attn.qkv_proj.codebook_id', 'model.layers.21.self_attn.qkv_proj.fuse_scales', 'model.layers.22.mlp.down_proj.Qidxs', 'model.layers.22.mlp.down_proj.SU', 'model.layers.22.mlp.down_proj.SV', 'model.layers.22.mlp.down_proj.Wscale', 'model.layers.22.mlp.down_proj.codebook_id', 'model.layers.22.mlp.upgate_proj.Qidxs', 'model.layers.22.mlp.upgate_proj.SU', 'model.layers.22.mlp.upgate_proj.SV', 'model.layers.22.mlp.upgate_proj.Wscale', 'model.layers.22.mlp.upgate_proj.codebook_id', 'model.layers.22.mlp.upgate_proj.fuse_scales', 'model.layers.22.self_attn.o_proj.Qidxs', 'model.layers.22.self_attn.o_proj.SU', 'model.layers.22.self_attn.o_proj.SV', 'model.layers.22.self_attn.o_proj.Wscale', 'model.layers.22.self_attn.o_proj.codebook_id', 'model.layers.22.self_attn.qkv_proj.Qidxs', 'model.layers.22.self_attn.qkv_proj.SU', 'model.layers.22.self_attn.qkv_proj.SV', 'model.layers.22.self_attn.qkv_proj.Wscale', 'model.layers.22.self_attn.qkv_proj.codebook_id', 'model.layers.22.self_attn.qkv_proj.fuse_scales', 'model.layers.23.mlp.down_proj.Qidxs', 'model.layers.23.mlp.down_proj.SU', 'model.layers.23.mlp.down_proj.SV', 'model.layers.23.mlp.down_proj.Wscale', 'model.layers.23.mlp.down_proj.codebook_id', 'model.layers.23.mlp.upgate_proj.Qidxs', 'model.layers.23.mlp.upgate_proj.SU', 'model.layers.23.mlp.upgate_proj.SV', 'model.layers.23.mlp.upgate_proj.Wscale', 'model.layers.23.mlp.upgate_proj.codebook_id', 'model.layers.23.mlp.upgate_proj.fuse_scales', 'model.layers.23.self_attn.o_proj.Qidxs', 'model.layers.23.self_attn.o_proj.SU', 'model.layers.23.self_attn.o_proj.SV', 'model.layers.23.self_attn.o_proj.Wscale', 'model.layers.23.self_attn.o_proj.codebook_id', 'model.layers.23.self_attn.qkv_proj.Qidxs', 'model.layers.23.self_attn.qkv_proj.SU', 'model.layers.23.self_attn.qkv_proj.SV', 'model.layers.23.self_attn.qkv_proj.Wscale', 'model.layers.23.self_attn.qkv_proj.codebook_id', 'model.layers.23.self_attn.qkv_proj.fuse_scales', 'model.layers.24.mlp.down_proj.Qidxs', 'model.layers.24.mlp.down_proj.SU', 'model.layers.24.mlp.down_proj.SV', 'model.layers.24.mlp.down_proj.Wscale', 'model.layers.24.mlp.down_proj.codebook_id', 'model.layers.24.mlp.upgate_proj.Qidxs', 'model.layers.24.mlp.upgate_proj.SU', 'model.layers.24.mlp.upgate_proj.SV', 'model.layers.24.mlp.upgate_proj.Wscale', 'model.layers.24.mlp.upgate_proj.codebook_id', 'model.layers.24.mlp.upgate_proj.fuse_scales', 'model.layers.24.self_attn.o_proj.Qidxs', 'model.layers.24.self_attn.o_proj.SU', 'model.layers.24.self_attn.o_proj.SV', 'model.layers.24.self_attn.o_proj.Wscale', 'model.layers.24.self_attn.o_proj.codebook_id', 'model.layers.24.self_attn.qkv_proj.Qidxs', 'model.layers.24.self_attn.qkv_proj.SU', 'model.layers.24.self_attn.qkv_proj.SV', 'model.layers.24.self_attn.qkv_proj.Wscale', 'model.layers.24.self_attn.qkv_proj.codebook_id', 'model.layers.24.self_attn.qkv_proj.fuse_scales', 'model.layers.25.mlp.down_proj.Qidxs', 'model.layers.25.mlp.down_proj.SU', 'model.layers.25.mlp.down_proj.SV', 'model.layers.25.mlp.down_proj.Wscale', 'model.layers.25.mlp.down_proj.codebook_id', 'model.layers.25.mlp.upgate_proj.Qidxs', 'model.layers.25.mlp.upgate_proj.SU', 'model.layers.25.mlp.upgate_proj.SV', 'model.layers.25.mlp.upgate_proj.Wscale', 'model.layers.25.mlp.upgate_proj.codebook_id', 'model.layers.25.mlp.upgate_proj.fuse_scales', 'model.layers.25.self_attn.o_proj.Qidxs', 'model.layers.25.self_attn.o_proj.SU', 'model.layers.25.self_attn.o_proj.SV', 'model.layers.25.self_attn.o_proj.Wscale', 'model.layers.25.self_attn.o_proj.codebook_id', 'model.layers.25.self_attn.qkv_proj.Qidxs', 'model.layers.25.self_attn.qkv_proj.SU', 'model.layers.25.self_attn.qkv_proj.SV', 'model.layers.25.self_attn.qkv_proj.Wscale', 'model.layers.25.self_attn.qkv_proj.codebook_id', 'model.layers.25.self_attn.qkv_proj.fuse_scales', 'model.layers.26.mlp.down_proj.Qidxs', 'model.layers.26.mlp.down_proj.SU', 'model.layers.26.mlp.down_proj.SV', 'model.layers.26.mlp.down_proj.Wscale', 'model.layers.26.mlp.down_proj.codebook_id', 'model.layers.26.mlp.upgate_proj.Qidxs', 'model.layers.26.mlp.upgate_proj.SU', 'model.layers.26.mlp.upgate_proj.SV', 'model.layers.26.mlp.upgate_proj.Wscale', 'model.layers.26.mlp.upgate_proj.codebook_id', 'model.layers.26.mlp.upgate_proj.fuse_scales', 'model.layers.26.self_attn.o_proj.Qidxs', 'model.layers.26.self_attn.o_proj.SU', 'model.layers.26.self_attn.o_proj.SV', 'model.layers.26.self_attn.o_proj.Wscale', 'model.layers.26.self_attn.o_proj.codebook_id', 'model.layers.26.self_attn.qkv_proj.Qidxs', 'model.layers.26.self_attn.qkv_proj.SU', 'model.layers.26.self_attn.qkv_proj.SV', 'model.layers.26.self_attn.qkv_proj.Wscale', 'model.layers.26.self_attn.qkv_proj.codebook_id', 'model.layers.26.self_attn.qkv_proj.fuse_scales', 'model.layers.27.mlp.down_proj.Qidxs', 'model.layers.27.mlp.down_proj.SU', 'model.layers.27.mlp.down_proj.SV', 'model.layers.27.mlp.down_proj.Wscale', 'model.layers.27.mlp.down_proj.codebook_id', 'model.layers.27.mlp.upgate_proj.Qidxs', 'model.layers.27.mlp.upgate_proj.SU', 'model.layers.27.mlp.upgate_proj.SV', 'model.layers.27.mlp.upgate_proj.Wscale', 'model.layers.27.mlp.upgate_proj.codebook_id', 'model.layers.27.mlp.upgate_proj.fuse_scales', 'model.layers.27.self_attn.o_proj.Qidxs', 'model.layers.27.self_attn.o_proj.SU', 'model.layers.27.self_attn.o_proj.SV', 'model.layers.27.self_attn.o_proj.Wscale', 'model.layers.27.self_attn.o_proj.codebook_id', 'model.layers.27.self_attn.qkv_proj.Qidxs', 'model.layers.27.self_attn.qkv_proj.SU', 'model.layers.27.self_attn.qkv_proj.SV', 'model.layers.27.self_attn.qkv_proj.Wscale', 'model.layers.27.self_attn.qkv_proj.codebook_id', 'model.layers.27.self_attn.qkv_proj.fuse_scales', 'model.layers.28.mlp.down_proj.Qidxs', 'model.layers.28.mlp.down_proj.SU', 'model.layers.28.mlp.down_proj.SV', 'model.layers.28.mlp.down_proj.Wscale', 'model.layers.28.mlp.down_proj.codebook_id', 'model.layers.28.mlp.upgate_proj.Qidxs', 'model.layers.28.mlp.upgate_proj.SU', 'model.layers.28.mlp.upgate_proj.SV', 'model.layers.28.mlp.upgate_proj.Wscale', 'model.layers.28.mlp.upgate_proj.codebook_id', 'model.layers.28.mlp.upgate_proj.fuse_scales', 'model.layers.28.self_attn.o_proj.Qidxs', 'model.layers.28.self_attn.o_proj.SU', 'model.layers.28.self_attn.o_proj.SV', 'model.layers.28.self_attn.o_proj.Wscale', 'model.layers.28.self_attn.o_proj.codebook_id', 'model.layers.28.self_attn.qkv_proj.Qidxs', 'model.layers.28.self_attn.qkv_proj.SU', 'model.layers.28.self_attn.qkv_proj.SV', 'model.layers.28.self_attn.qkv_proj.Wscale', 'model.layers.28.self_attn.qkv_proj.codebook_id', 'model.layers.28.self_attn.qkv_proj.fuse_scales', 'model.layers.29.mlp.down_proj.Qidxs', 'model.layers.29.mlp.down_proj.SU', 'model.layers.29.mlp.down_proj.SV', 'model.layers.29.mlp.down_proj.Wscale', 'model.layers.29.mlp.down_proj.codebook_id', 'model.layers.29.mlp.upgate_proj.Qidxs', 'model.layers.29.mlp.upgate_proj.SU', 'model.layers.29.mlp.upgate_proj.SV', 'model.layers.29.mlp.upgate_proj.Wscale', 'model.layers.29.mlp.upgate_proj.codebook_id', 'model.layers.29.mlp.upgate_proj.fuse_scales', 'model.layers.29.self_attn.o_proj.Qidxs', 'model.layers.29.self_attn.o_proj.SU', 'model.layers.29.self_attn.o_proj.SV', 'model.layers.29.self_attn.o_proj.Wscale', 'model.layers.29.self_attn.o_proj.codebook_id', 'model.layers.29.self_attn.qkv_proj.Qidxs', 'model.layers.29.self_attn.qkv_proj.SU', 'model.layers.29.self_attn.qkv_proj.SV', 'model.layers.29.self_attn.qkv_proj.Wscale', 'model.layers.29.self_attn.qkv_proj.codebook_id', 'model.layers.29.self_attn.qkv_proj.fuse_scales', 'model.layers.3.mlp.down_proj.Qidxs', 'model.layers.3.mlp.down_proj.SU', 'model.layers.3.mlp.down_proj.SV', 'model.layers.3.mlp.down_proj.Wscale', 'model.layers.3.mlp.down_proj.codebook_id', 'model.layers.3.mlp.upgate_proj.Qidxs', 'model.layers.3.mlp.upgate_proj.SU', 'model.layers.3.mlp.upgate_proj.SV', 'model.layers.3.mlp.upgate_proj.Wscale', 'model.layers.3.mlp.upgate_proj.codebook_id', 'model.layers.3.mlp.upgate_proj.fuse_scales', 'model.layers.3.self_attn.o_proj.Qidxs', 'model.layers.3.self_attn.o_proj.SU', 'model.layers.3.self_attn.o_proj.SV', 'model.layers.3.self_attn.o_proj.Wscale', 'model.layers.3.self_attn.o_proj.codebook_id', 'model.layers.3.self_attn.qkv_proj.Qidxs', 'model.layers.3.self_attn.qkv_proj.SU', 'model.layers.3.self_attn.qkv_proj.SV', 'model.layers.3.self_attn.qkv_proj.Wscale', 'model.layers.3.self_attn.qkv_proj.codebook_id', 'model.layers.3.self_attn.qkv_proj.fuse_scales', 'model.layers.30.mlp.down_proj.Qidxs', 'model.layers.30.mlp.down_proj.SU', 'model.layers.30.mlp.down_proj.SV', 'model.layers.30.mlp.down_proj.Wscale', 'model.layers.30.mlp.down_proj.codebook_id', 'model.layers.30.mlp.upgate_proj.Qidxs', 'model.layers.30.mlp.upgate_proj.SU', 'model.layers.30.mlp.upgate_proj.SV', 'model.layers.30.mlp.upgate_proj.Wscale', 'model.layers.30.mlp.upgate_proj.codebook_id', 'model.layers.30.mlp.upgate_proj.fuse_scales', 'model.layers.30.self_attn.o_proj.Qidxs', 'model.layers.30.self_attn.o_proj.SU', 'model.layers.30.self_attn.o_proj.SV', 'model.layers.30.self_attn.o_proj.Wscale', 'model.layers.30.self_attn.o_proj.codebook_id', 'model.layers.30.self_attn.qkv_proj.Qidxs', 'model.layers.30.self_attn.qkv_proj.SU', 'model.layers.30.self_attn.qkv_proj.SV', 'model.layers.30.self_attn.qkv_proj.Wscale', 'model.layers.30.self_attn.qkv_proj.codebook_id', 'model.layers.30.self_attn.qkv_proj.fuse_scales', 'model.layers.31.mlp.down_proj.Qidxs', 'model.layers.31.mlp.down_proj.SU', 'model.layers.31.mlp.down_proj.SV', 'model.layers.31.mlp.down_proj.Wscale', 'model.layers.31.mlp.down_proj.codebook_id', 'model.layers.31.mlp.upgate_proj.Qidxs', 'model.layers.31.mlp.upgate_proj.SU', 'model.layers.31.mlp.upgate_proj.SV', 'model.layers.31.mlp.upgate_proj.Wscale', 'model.layers.31.mlp.upgate_proj.codebook_id', 'model.layers.31.mlp.upgate_proj.fuse_scales', 'model.layers.31.self_attn.o_proj.Qidxs', 'model.layers.31.self_attn.o_proj.SU', 'model.layers.31.self_attn.o_proj.SV', 'model.layers.31.self_attn.o_proj.Wscale', 'model.layers.31.self_attn.o_proj.codebook_id', 'model.layers.31.self_attn.qkv_proj.Qidxs', 'model.layers.31.self_attn.qkv_proj.SU', 'model.layers.31.self_attn.qkv_proj.SV', 'model.layers.31.self_attn.qkv_proj.Wscale', 'model.layers.31.self_attn.qkv_proj.codebook_id', 'model.layers.31.self_attn.qkv_proj.fuse_scales', 'model.layers.4.mlp.down_proj.Qidxs', 'model.layers.4.mlp.down_proj.SU', 'model.layers.4.mlp.down_proj.SV', 'model.layers.4.mlp.down_proj.Wscale', 'model.layers.4.mlp.down_proj.codebook_id', 'model.layers.4.mlp.upgate_proj.Qidxs', 'model.layers.4.mlp.upgate_proj.SU', 'model.layers.4.mlp.upgate_proj.SV', 'model.layers.4.mlp.upgate_proj.Wscale', 'model.layers.4.mlp.upgate_proj.codebook_id', 'model.layers.4.mlp.upgate_proj.fuse_scales', 'model.layers.4.self_attn.o_proj.Qidxs', 'model.layers.4.self_attn.o_proj.SU', 'model.layers.4.self_attn.o_proj.SV', 'model.layers.4.self_attn.o_proj.Wscale', 'model.layers.4.self_attn.o_proj.codebook_id', 'model.layers.4.self_attn.qkv_proj.Qidxs', 'model.layers.4.self_attn.qkv_proj.SU', 'model.layers.4.self_attn.qkv_proj.SV', 'model.layers.4.self_attn.qkv_proj.Wscale', 'model.layers.4.self_attn.qkv_proj.codebook_id', 'model.layers.4.self_attn.qkv_proj.fuse_scales', 'model.layers.5.mlp.down_proj.Qidxs', 'model.layers.5.mlp.down_proj.SU', 'model.layers.5.mlp.down_proj.SV', 'model.layers.5.mlp.down_proj.Wscale', 'model.layers.5.mlp.down_proj.codebook_id', 'model.layers.5.mlp.upgate_proj.Qidxs', 'model.layers.5.mlp.upgate_proj.SU', 'model.layers.5.mlp.upgate_proj.SV', 'model.layers.5.mlp.upgate_proj.Wscale', 'model.layers.5.mlp.upgate_proj.codebook_id', 'model.layers.5.mlp.upgate_proj.fuse_scales', 'model.layers.5.self_attn.o_proj.Qidxs', 'model.layers.5.self_attn.o_proj.SU', 'model.layers.5.self_attn.o_proj.SV', 'model.layers.5.self_attn.o_proj.Wscale', 'model.layers.5.self_attn.o_proj.codebook_id', 'model.layers.5.self_attn.qkv_proj.Qidxs', 'model.layers.5.self_attn.qkv_proj.SU', 'model.layers.5.self_attn.qkv_proj.SV', 'model.layers.5.self_attn.qkv_proj.Wscale', 'model.layers.5.self_attn.qkv_proj.codebook_id', 'model.layers.5.self_attn.qkv_proj.fuse_scales', 'model.layers.6.mlp.down_proj.Qidxs', 'model.layers.6.mlp.down_proj.SU', 'model.layers.6.mlp.down_proj.SV', 'model.layers.6.mlp.down_proj.Wscale', 'model.layers.6.mlp.down_proj.codebook_id', 'model.layers.6.mlp.upgate_proj.Qidxs', 'model.layers.6.mlp.upgate_proj.SU', 'model.layers.6.mlp.upgate_proj.SV', 'model.layers.6.mlp.upgate_proj.Wscale', 'model.layers.6.mlp.upgate_proj.codebook_id', 'model.layers.6.mlp.upgate_proj.fuse_scales', 'model.layers.6.self_attn.o_proj.Qidxs', 'model.layers.6.self_attn.o_proj.SU', 'model.layers.6.self_attn.o_proj.SV', 'model.layers.6.self_attn.o_proj.Wscale', 'model.layers.6.self_attn.o_proj.codebook_id', 'model.layers.6.self_attn.qkv_proj.Qidxs', 'model.layers.6.self_attn.qkv_proj.SU', 'model.layers.6.self_attn.qkv_proj.SV', 'model.layers.6.self_attn.qkv_proj.Wscale', 'model.layers.6.self_attn.qkv_proj.codebook_id', 'model.layers.6.self_attn.qkv_proj.fuse_scales', 'model.layers.7.mlp.down_proj.Qidxs', 'model.layers.7.mlp.down_proj.SU', 'model.layers.7.mlp.down_proj.SV', 'model.layers.7.mlp.down_proj.Wscale', 'model.layers.7.mlp.down_proj.codebook_id', 'model.layers.7.mlp.upgate_proj.Qidxs', 'model.layers.7.mlp.upgate_proj.SU', 'model.layers.7.mlp.upgate_proj.SV', 'model.layers.7.mlp.upgate_proj.Wscale', 'model.layers.7.mlp.upgate_proj.codebook_id', 'model.layers.7.mlp.upgate_proj.fuse_scales', 'model.layers.7.self_attn.o_proj.Qidxs', 'model.layers.7.self_attn.o_proj.SU', 'model.layers.7.self_attn.o_proj.SV', 'model.layers.7.self_attn.o_proj.Wscale', 'model.layers.7.self_attn.o_proj.codebook_id', 'model.layers.7.self_attn.qkv_proj.Qidxs', 'model.layers.7.self_attn.qkv_proj.SU', 'model.layers.7.self_attn.qkv_proj.SV', 'model.layers.7.self_attn.qkv_proj.Wscale', 'model.layers.7.self_attn.qkv_proj.codebook_id', 'model.layers.7.self_attn.qkv_proj.fuse_scales', 'model.layers.8.mlp.down_proj.Qidxs', 'model.layers.8.mlp.down_proj.SU', 'model.layers.8.mlp.down_proj.SV', 'model.layers.8.mlp.down_proj.Wscale', 'model.layers.8.mlp.down_proj.codebook_id', 'model.layers.8.mlp.upgate_proj.Qidxs', 'model.layers.8.mlp.upgate_proj.SU', 'model.layers.8.mlp.upgate_proj.SV', 'model.layers.8.mlp.upgate_proj.Wscale', 'model.layers.8.mlp.upgate_proj.codebook_id', 'model.layers.8.mlp.upgate_proj.fuse_scales', 'model.layers.8.self_attn.o_proj.Qidxs', 'model.layers.8.self_attn.o_proj.SU', 'model.layers.8.self_attn.o_proj.SV', 'model.layers.8.self_attn.o_proj.Wscale', 'model.layers.8.self_attn.o_proj.codebook_id', 'model.layers.8.self_attn.qkv_proj.Qidxs', 'model.layers.8.self_attn.qkv_proj.SU', 'model.layers.8.self_attn.qkv_proj.SV', 'model.layers.8.self_attn.qkv_proj.Wscale', 'model.layers.8.self_attn.qkv_proj.codebook_id', 'model.layers.8.self_attn.qkv_proj.fuse_scales', 'model.layers.9.mlp.down_proj.Qidxs', 'model.layers.9.mlp.down_proj.SU', 'model.layers.9.mlp.down_proj.SV', 'model.layers.9.mlp.down_proj.Wscale', 'model.layers.9.mlp.down_proj.codebook_id', 'model.layers.9.mlp.upgate_proj.Qidxs', 'model.layers.9.mlp.upgate_proj.SU', 'model.layers.9.mlp.upgate_proj.SV', 'model.layers.9.mlp.upgate_proj.Wscale', 'model.layers.9.mlp.upgate_proj.codebook_id', 'model.layers.9.mlp.upgate_proj.fuse_scales', 'model.layers.9.self_attn.o_proj.Qidxs', 'model.layers.9.self_attn.o_proj.SU', 'model.layers.9.self_attn.o_proj.SV', 'model.layers.9.self_attn.o_proj.Wscale', 'model.layers.9.self_attn.o_proj.codebook_id', 'model.layers.9.self_attn.qkv_proj.Qidxs', 'model.layers.9.self_attn.qkv_proj.SU', 'model.layers.9.self_attn.qkv_proj.SV', 'model.layers.9.self_attn.qkv_proj.Wscale', 'model.layers.9.self_attn.qkv_proj.codebook_id', 'model.layers.9.self_attn.qkv_proj.fuse_scales']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
W0413 09:41:25.096294 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/quantize_llama/hfize_llama.py:47: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ln_data = torch.load(f'{args.quantized_path}/{ii}_layernorm.pt',

W0413 09:41:25.097676 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/quantize_llama/hfize_llama.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  saved_layer = torch.load(f'{args.quantized_path}/{ii}_qkv.pt',

W0413 09:41:25.113821 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/quantize_llama/hfize_llama.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  saved_layer = torch.load(f'{args.quantized_path}/{ii}_o.pt',

W0413 09:41:25.132175 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/quantize_llama/hfize_llama.py:66: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  saved_layer = torch.load(f'{args.quantized_path}/{ii}_up.pt',

W0413 09:41:25.180025 852166 warnings.py:110] /workspace/Weight_compression/quip-sharp/quantize_llama/hfize_llama.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  saved_layer = torch.load(f'{args.quantized_path}/{ii}_down.pt',

I0413 09:41:25.207965 852166 hfize_llama.py:78] loaded layer 0 down
I0413 09:41:25.316014 852166 hfize_llama.py:78] loaded layer 1 down
I0413 09:41:25.423501 852166 hfize_llama.py:78] loaded layer 2 down
I0413 09:41:25.524497 852166 hfize_llama.py:78] loaded layer 3 down
I0413 09:41:25.633126 852166 hfize_llama.py:78] loaded layer 4 down
I0413 09:41:25.739948 852166 hfize_llama.py:78] loaded layer 5 down
I0413 09:41:25.863945 852166 hfize_llama.py:78] loaded layer 6 down
I0413 09:41:25.981921 852166 hfize_llama.py:78] loaded layer 7 down
I0413 09:41:26.090001 852166 hfize_llama.py:78] loaded layer 8 down
I0413 09:41:26.204125 852166 hfize_llama.py:78] loaded layer 9 down
I0413 09:41:26.313589 852166 hfize_llama.py:78] loaded layer 10 down
I0413 09:41:26.426654 852166 hfize_llama.py:78] loaded layer 11 down
I0413 09:41:26.531646 852166 hfize_llama.py:78] loaded layer 12 down
I0413 09:41:26.667000 852166 hfize_llama.py:78] loaded layer 13 down
I0413 09:41:26.779104 852166 hfize_llama.py:78] loaded layer 14 down
I0413 09:41:26.866643 852166 hfize_llama.py:78] loaded layer 15 down
I0413 09:41:26.937788 852166 hfize_llama.py:78] loaded layer 16 down
I0413 09:41:27.009584 852166 hfize_llama.py:78] loaded layer 17 down
I0413 09:41:27.086975 852166 hfize_llama.py:78] loaded layer 18 down
I0413 09:41:27.168492 852166 hfize_llama.py:78] loaded layer 19 down
I0413 09:41:27.244664 852166 hfize_llama.py:78] loaded layer 20 down
I0413 09:41:27.328524 852166 hfize_llama.py:78] loaded layer 21 down
I0413 09:41:27.404077 852166 hfize_llama.py:78] loaded layer 22 down
I0413 09:41:27.491160 852166 hfize_llama.py:78] loaded layer 23 down
I0413 09:41:27.561980 852166 hfize_llama.py:78] loaded layer 24 down
I0413 09:41:27.655522 852166 hfize_llama.py:78] loaded layer 25 down
I0413 09:41:27.746263 852166 hfize_llama.py:78] loaded layer 26 down
I0413 09:41:27.835673 852166 hfize_llama.py:78] loaded layer 27 down
I0413 09:41:27.931910 852166 hfize_llama.py:78] loaded layer 28 down
I0413 09:41:28.044900 852166 hfize_llama.py:78] loaded layer 29 down
I0413 09:41:28.124143 852166 hfize_llama.py:78] loaded layer 30 down
I0413 09:41:28.203818 852166 hfize_llama.py:78] loaded layer 31 down
I0413 09:41:28.203948 852166 hfize_llama.py:80] saving model...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.45it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.27it/s]
I0413 09:41:39.282773 852166 hfize_llama.py:87] successfully loaded hfized model
I0413 09:41:39.282896 852166 hfize_llama.py:89] generating some text...
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
I0413 09:41:59.517749 852166 hfize_llama.py:100] <|begin_of_text|>It is a truth universally acknowledged that a single man in possession of a good fortune must be in want of a wife. So begins Pride and Prejudice, Jane Austen’s classic novel of manners and mores in early 19th-century England. It remains one of the most popular and enduring of the English language’s greatest novels.<|end_of_text|>
I0413 09:41:59.517874 852166 hfize_llama.py:101] elapsed: 20.23492932319641
[Stage: End-to-End Finetuning] K=4
W0413 09:42:02.402527 852670 warnings.py:110] /workspace/Weight_compression/quip-sharp/lib/codebook/__init__.py:6: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::decode_matvec_e8p")

W0413 09:42:02.434687 852670 warnings.py:110] /workspace/Weight_compression/quip-sharp/lib/codebook/__init__.py:25: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::decompress_packed_e8p")

I0413 09:42:02.734233 852670 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0413 09:42:02.734361 852670 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0413 09:42:02.734406 852670 utils.py:162] NumExpr defaulting to 16 threads.
I0413 09:42:02.850816 852670 config.py:58] PyTorch version 2.4.0 available.
W0413 09:42:03.218549 852670 warnings.py:110] /workspace/Weight_compression/quip-sharp/lib/utils/matmul_had.py:92: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")

W0413 09:42:23.784197 852670 warnings.py:110] /opt/conda/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(

Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:06,  2.05s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.11s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:06<00:02,  2.23s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.52s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.75s/it]
/opt/conda/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
[Stage: Eval PPL] K=4
[Stage: Eval Zero-shot] K=4
