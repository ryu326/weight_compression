nohup: ignoring input
Running with lmbda=50
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  8.80it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  8.92it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  9.74it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.17it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  9.90it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:11,  2.62it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:11,  2.60it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:11,  2.61it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:10,  2.63it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:01<00:10,  2.66it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:09,  2.65it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:09,  2.65it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:09,  2.67it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:08,  2.72it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:03<00:07,  2.76it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:07,  2.77it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:04<00:07,  2.80it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:04<00:06,  2.78it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:06,  2.79it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:05<00:06,  2.81it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:05<00:05,  2.80it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:06<00:05,  2.74it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:06<00:05,  2.65it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:07<00:05,  2.59it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:07<00:04,  2.53it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:07<00:04,  2.50it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:08<00:04,  2.45it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:08<00:03,  2.45it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:09<00:03,  2.45it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:09<00:02,  2.44it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:09<00:02,  2.45it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:10<00:02,  2.44it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:10<00:01,  2.46it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:11<00:01,  2.46it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:11<00:00,  2.46it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:11<00:00,  2.47it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.49it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.59it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 01:07:28 - INFO - layer0_self_attn.q_proj | mse: 0.111963858291711, bpp_loss: 2.2340127014904283, bpp: 0
2025-03-03 01:07:37 - INFO - layer0_self_attn.k_proj | mse: 0.11177549258384042, bpp_loss: 2.3580370714480523, bpp: 0
2025-03-03 01:07:45 - INFO - layer0_self_attn.v_proj | mse: 0.10624536278738332, bpp_loss: 2.145806831365917, bpp: 0
2025-03-03 01:07:54 - INFO - layer0_self_attn.o_proj | mse: 0.11477701409659369, bpp_loss: 2.022360572096659, bpp: 0
2025-03-03 01:08:04 - INFO - layer0_mlp.gate_proj | mse: 0.11878950348445629, bpp_loss: 2.5002353557407164, bpp: 0
2025-03-03 01:08:15 - INFO - layer0_mlp.up_proj | mse: 0.11845848066315397, bpp_loss: 2.482689919166787, bpp: 0
2025-03-03 01:08:42 - INFO - layer0_mlp.down_proj | mse: 0.13079162260834154, bpp_loss: 2.531189192238069, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:23<43:04, 83.36s/it]2025-03-03 01:08:51 - INFO - layer1_self_attn.q_proj | mse: 0.14512528482608922, bpp_loss: 2.905285459361039, bpp: 0
2025-03-03 01:09:00 - INFO - layer1_self_attn.k_proj | mse: 0.14806849466600305, bpp_loss: 2.921107147092698, bpp: 0
2025-03-03 01:09:09 - INFO - layer1_self_attn.v_proj | mse: 0.12185606508510322, bpp_loss: 2.1076734207745176, bpp: 0
2025-03-03 01:09:18 - INFO - layer1_self_attn.o_proj | mse: 0.13346686705975985, bpp_loss: 2.0694335082371254, bpp: 0
2025-03-03 01:09:28 - INFO - layer1_mlp.gate_proj | mse: 0.12845819845800144, bpp_loss: 2.6180415523000233, bpp: 0
2025-03-03 01:09:38 - INFO - layer1_mlp.up_proj | mse: 0.12674670224374784, bpp_loss: 2.548277958187946, bpp: 0
2025-03-03 01:10:06 - INFO - layer1_mlp.down_proj | mse: 0.0925709351377247, bpp_loss: 2.546760629212787, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [02:47<41:47, 83.57s/it]2025-03-03 01:10:15 - INFO - layer2_self_attn.q_proj | mse: 0.12994970673414183, bpp_loss: 3.054568849707721, bpp: 0
2025-03-03 01:10:24 - INFO - layer2_self_attn.k_proj | mse: 0.13113935988306222, bpp_loss: 3.1087472026993055, bpp: 0
2025-03-03 01:10:33 - INFO - layer2_self_attn.v_proj | mse: 0.11279661897240635, bpp_loss: 2.3564270482456777, bpp: 0
2025-03-03 01:10:42 - INFO - layer2_self_attn.o_proj | mse: 0.11592561035821874, bpp_loss: 2.339000147418119, bpp: 0
2025-03-03 01:10:52 - INFO - layer2_mlp.gate_proj | mse: 0.11893370990930498, bpp_loss: 2.6520925470909407, bpp: 0
2025-03-03 01:11:02 - INFO - layer2_mlp.up_proj | mse: 0.11700599891907923, bpp_loss: 2.565351036528862, bpp: 0
2025-03-03 01:11:30 - INFO - layer2_mlp.down_proj | mse: 0.1020535122389409, bpp_loss: 2.566952359256183, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:11<40:28, 83.73s/it]2025-03-03 01:11:39 - INFO - layer3_self_attn.q_proj | mse: 0.11908427904811336, bpp_loss: 2.988295882329112, bpp: 0
2025-03-03 01:11:48 - INFO - layer3_self_attn.k_proj | mse: 0.12004650276715569, bpp_loss: 3.0413364942069165, bpp: 0
2025-03-03 01:11:57 - INFO - layer3_self_attn.v_proj | mse: 0.10357650287880357, bpp_loss: 2.3072727999824565, bpp: 0
2025-03-03 01:12:05 - INFO - layer3_self_attn.o_proj | mse: 0.09998693966528796, bpp_loss: 2.2934704886283726, bpp: 0
2025-03-03 01:12:16 - INFO - layer3_mlp.gate_proj | mse: 0.11082953649992991, bpp_loss: 2.6618725346877823, bpp: 0
2025-03-03 01:12:26 - INFO - layer3_mlp.up_proj | mse: 0.10874904707275762, bpp_loss: 2.5655905159926693, bpp: 0
2025-03-03 01:12:53 - INFO - layer3_mlp.down_proj | mse: 0.10027976114004536, bpp_loss: 2.5658944535264094, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [05:34<39:01, 83.63s/it]2025-03-03 01:13:02 - INFO - layer4_self_attn.q_proj | mse: 0.11821727532424621, bpp_loss: 3.072564964822959, bpp: 0
2025-03-03 01:13:11 - INFO - layer4_self_attn.k_proj | mse: 0.11866608515911717, bpp_loss: 3.100018234777963, bpp: 0
2025-03-03 01:13:20 - INFO - layer4_self_attn.v_proj | mse: 0.10251353160736343, bpp_loss: 2.3529261281946674, bpp: 0
2025-03-03 01:13:29 - INFO - layer4_self_attn.o_proj | mse: 0.10199689621185473, bpp_loss: 2.346380395872984, bpp: 0
2025-03-03 01:13:39 - INFO - layer4_mlp.gate_proj | mse: 0.1097822246194281, bpp_loss: 2.684724446775955, bpp: 0
2025-03-03 01:13:49 - INFO - layer4_mlp.up_proj | mse: 0.1070640516564684, bpp_loss: 2.5558727462884296, bpp: 0
2025-03-03 01:14:17 - INFO - layer4_mlp.down_proj | mse: 0.10021506573284436, bpp_loss: 2.551798395985781, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [06:57<37:34, 83.49s/it]2025-03-03 01:14:26 - INFO - layer5_self_attn.q_proj | mse: 0.11690953872019196, bpp_loss: 3.091023784218123, bpp: 0
2025-03-03 01:14:34 - INFO - layer5_self_attn.k_proj | mse: 0.11787596894504523, bpp_loss: 3.1467864335281774, bpp: 0
2025-03-03 01:14:43 - INFO - layer5_self_attn.v_proj | mse: 0.1016180441609527, bpp_loss: 2.371368001739029, bpp: 0
2025-03-03 01:14:52 - INFO - layer5_self_attn.o_proj | mse: 0.10558917105721542, bpp_loss: 2.355358744825935, bpp: 0
2025-03-03 01:15:02 - INFO - layer5_mlp.gate_proj | mse: 0.10946382697489761, bpp_loss: 2.6912937365299046, bpp: 0
2025-03-03 01:15:13 - INFO - layer5_mlp.up_proj | mse: 0.10666053755378357, bpp_loss: 2.555817465492806, bpp: 0
2025-03-03 01:15:40 - INFO - layer5_mlp.down_proj | mse: 0.09968197971691041, bpp_loss: 2.553373695827674, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [08:21<36:11, 83.53s/it]2025-03-03 01:15:49 - INFO - layer6_self_attn.q_proj | mse: 0.11309546629570837, bpp_loss: 2.971458464366151, bpp: 0
2025-03-03 01:15:58 - INFO - layer6_self_attn.k_proj | mse: 0.11354272331576204, bpp_loss: 2.997500362660503, bpp: 0
2025-03-03 01:16:07 - INFO - layer6_self_attn.v_proj | mse: 0.09908907664397022, bpp_loss: 2.306771614064928, bpp: 0
2025-03-03 01:16:16 - INFO - layer6_self_attn.o_proj | mse: 0.10262207799835842, bpp_loss: 2.311807921563741, bpp: 0
2025-03-03 01:16:26 - INFO - layer6_mlp.gate_proj | mse: 0.10826661699149424, bpp_loss: 2.7114055800403274, bpp: 0
2025-03-03 01:16:36 - INFO - layer6_mlp.up_proj | mse: 0.10497436068311065, bpp_loss: 2.5508881227308233, bpp: 0
2025-03-03 01:17:04 - INFO - layer6_mlp.down_proj | mse: 0.09974614907507924, bpp_loss: 2.5479926068422407, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [09:44<34:48, 83.53s/it]2025-03-03 01:17:13 - INFO - layer7_self_attn.q_proj | mse: 0.1122978988881476, bpp_loss: 2.9645221160026267, bpp: 0
2025-03-03 01:17:21 - INFO - layer7_self_attn.k_proj | mse: 0.11241288830181723, bpp_loss: 2.9747994572971947, bpp: 0
2025-03-03 01:17:30 - INFO - layer7_self_attn.v_proj | mse: 0.09876858261858872, bpp_loss: 2.315047553856857, bpp: 0
2025-03-03 01:17:39 - INFO - layer7_self_attn.o_proj | mse: 0.09896437634360755, bpp_loss: 2.3153794558602385, bpp: 0
2025-03-03 01:17:49 - INFO - layer7_mlp.gate_proj | mse: 0.10742057492019853, bpp_loss: 2.7089621448066343, bpp: 0
2025-03-03 01:18:00 - INFO - layer7_mlp.up_proj | mse: 0.10425011189839178, bpp_loss: 2.5537087347705003, bpp: 0
2025-03-03 01:18:27 - INFO - layer7_mlp.down_proj | mse: 0.10018308885069276, bpp_loss: 2.549317189319016, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [11:08<33:22, 83.46s/it]2025-03-03 01:18:36 - INFO - layer8_self_attn.q_proj | mse: 0.11281081448099703, bpp_loss: 2.9810886581544764, bpp: 0
2025-03-03 01:18:45 - INFO - layer8_self_attn.k_proj | mse: 0.11302930943159067, bpp_loss: 2.9979702376876958, bpp: 0
2025-03-03 01:18:54 - INFO - layer8_self_attn.v_proj | mse: 0.09934220863552512, bpp_loss: 2.3406758253695443, bpp: 0
2025-03-03 01:19:02 - INFO - layer8_self_attn.o_proj | mse: 0.10274386966798128, bpp_loss: 2.3402044291142374, bpp: 0
2025-03-03 01:19:13 - INFO - layer8_mlp.gate_proj | mse: 0.10668245913804175, bpp_loss: 2.688302444813903, bpp: 0
2025-03-03 01:19:23 - INFO - layer8_mlp.up_proj | mse: 0.10430039701161346, bpp_loss: 2.567655941384823, bpp: 0
2025-03-03 01:19:50 - INFO - layer8_mlp.down_proj | mse: 0.10062830743074684, bpp_loss: 2.5598960530532655, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [12:31<31:58, 83.40s/it]2025-03-03 01:19:59 - INFO - layer9_self_attn.q_proj | mse: 0.11288993850765591, bpp_loss: 3.0071912759449333, bpp: 0
2025-03-03 01:20:08 - INFO - layer9_self_attn.k_proj | mse: 0.11350923350365832, bpp_loss: 3.0420286732551176, bpp: 0
2025-03-03 01:20:17 - INFO - layer9_self_attn.v_proj | mse: 0.09935078388153092, bpp_loss: 2.357214887335431, bpp: 0
2025-03-03 01:20:26 - INFO - layer9_self_attn.o_proj | mse: 0.10410571143906401, bpp_loss: 2.354656552139204, bpp: 0
2025-03-03 01:20:36 - INFO - layer9_mlp.gate_proj | mse: 0.10596166847892775, bpp_loss: 2.674826088643005, bpp: 0
2025-03-03 01:20:46 - INFO - layer9_mlp.up_proj | mse: 0.10409102949681398, bpp_loss: 2.5751063286565072, bpp: 0
2025-03-03 01:21:14 - INFO - layer9_mlp.down_proj | mse: 0.10076401083353474, bpp_loss: 2.5665979491503434, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [13:55<30:36, 83.47s/it]2025-03-03 01:21:23 - INFO - layer10_self_attn.q_proj | mse: 0.11232280186607525, bpp_loss: 2.9968990679481067, bpp: 0
2025-03-03 01:21:32 - INFO - layer10_self_attn.k_proj | mse: 0.11289962621800842, bpp_loss: 3.0360048286092933, bpp: 0
2025-03-03 01:21:41 - INFO - layer10_self_attn.v_proj | mse: 0.09894345969625558, bpp_loss: 2.35043739201501, bpp: 0
2025-03-03 01:21:49 - INFO - layer10_self_attn.o_proj | mse: 0.10626852753976924, bpp_loss: 2.3539643714902923, bpp: 0
2025-03-03 01:22:00 - INFO - layer10_mlp.gate_proj | mse: 0.10591585047060213, bpp_loss: 2.6674957174028076, bpp: 0
2025-03-03 01:22:10 - INFO - layer10_mlp.up_proj | mse: 0.10438766940842419, bpp_loss: 2.5875732334287362, bpp: 0
2025-03-03 01:22:38 - INFO - layer10_mlp.down_proj | mse: 0.10112475111327676, bpp_loss: 2.575665864941859, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [15:18<29:15, 83.60s/it]2025-03-03 01:22:47 - INFO - layer11_self_attn.q_proj | mse: 0.11002777633066714, bpp_loss: 2.890449891187018, bpp: 0
2025-03-03 01:22:56 - INFO - layer11_self_attn.k_proj | mse: 0.10995459703536091, bpp_loss: 2.895909574464895, bpp: 0
2025-03-03 01:23:05 - INFO - layer11_self_attn.v_proj | mse: 0.09975668272186204, bpp_loss: 2.3832399848324712, bpp: 0
2025-03-03 01:23:14 - INFO - layer11_self_attn.o_proj | mse: 0.10348562844748269, bpp_loss: 2.384832699666731, bpp: 0
2025-03-03 01:23:24 - INFO - layer11_mlp.gate_proj | mse: 0.10506290939560596, bpp_loss: 2.664585648710991, bpp: 0
2025-03-03 01:23:34 - INFO - layer11_mlp.up_proj | mse: 0.10385682556869288, bpp_loss: 2.5969573007246782, bpp: 0
2025-03-03 01:24:02 - INFO - layer11_mlp.down_proj | mse: 0.1009072945166385, bpp_loss: 2.583308711474718, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [16:43<27:57, 83.89s/it]2025-03-03 01:24:11 - INFO - layer12_self_attn.q_proj | mse: 0.1106483112608893, bpp_loss: 2.9486714740341995, bpp: 0
2025-03-03 01:24:20 - INFO - layer12_self_attn.k_proj | mse: 0.11128342410932132, bpp_loss: 2.992397016554605, bpp: 0
2025-03-03 01:24:29 - INFO - layer12_self_attn.v_proj | mse: 0.0986728063912402, bpp_loss: 2.372984624002129, bpp: 0
2025-03-03 01:24:38 - INFO - layer12_self_attn.o_proj | mse: 0.10580927676347773, bpp_loss: 2.3776220880099572, bpp: 0
2025-03-03 01:24:48 - INFO - layer12_mlp.gate_proj | mse: 0.10475766297687944, bpp_loss: 2.6581640485674143, bpp: 0
2025-03-03 01:24:59 - INFO - layer12_mlp.up_proj | mse: 0.10395771487405736, bpp_loss: 2.6080288570807424, bpp: 0
2025-03-03 01:25:27 - INFO - layer12_mlp.down_proj | mse: 0.10070292877952185, bpp_loss: 2.5928900900491794, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [18:07<26:35, 83.98s/it]2025-03-03 01:25:36 - INFO - layer13_self_attn.q_proj | mse: 0.11010597330370378, bpp_loss: 2.9385372395336162, bpp: 0
2025-03-03 01:25:45 - INFO - layer13_self_attn.k_proj | mse: 0.11046225159890408, bpp_loss: 2.9640787028183695, bpp: 0
2025-03-03 01:25:54 - INFO - layer13_self_attn.v_proj | mse: 0.09925512353588517, bpp_loss: 2.404768834647257, bpp: 0
2025-03-03 01:26:03 - INFO - layer13_self_attn.o_proj | mse: 0.10464027373399293, bpp_loss: 2.4043223076150753, bpp: 0
2025-03-03 01:26:13 - INFO - layer13_mlp.gate_proj | mse: 0.10491451182600924, bpp_loss: 2.6536249536154575, bpp: 0
2025-03-03 01:26:23 - INFO - layer13_mlp.up_proj | mse: 0.10448005569172787, bpp_loss: 2.6196375303403583, bpp: 0
2025-03-03 01:26:51 - INFO - layer13_mlp.down_proj | mse: 0.1013366022694084, bpp_loss: 2.601297243606559, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [19:32<25:15, 84.21s/it]2025-03-03 01:27:00 - INFO - layer14_self_attn.q_proj | mse: 0.11062440486560557, bpp_loss: 2.9310543028987013, bpp: 0
2025-03-03 01:27:09 - INFO - layer14_self_attn.k_proj | mse: 0.11088052660509222, bpp_loss: 2.9618543656542897, bpp: 0
2025-03-03 01:27:18 - INFO - layer14_self_attn.v_proj | mse: 0.09949218273526433, bpp_loss: 2.3888483493647072, bpp: 0
2025-03-03 01:27:27 - INFO - layer14_self_attn.o_proj | mse: 0.10378118473042572, bpp_loss: 2.3897778294049203, bpp: 0
2025-03-03 01:27:38 - INFO - layer14_mlp.gate_proj | mse: 0.10465637697880217, bpp_loss: 2.6510277266159306, bpp: 0
2025-03-03 01:27:48 - INFO - layer14_mlp.up_proj | mse: 0.10427556922204646, bpp_loss: 2.6215362204888533, bpp: 0
2025-03-03 01:28:15 - INFO - layer14_mlp.down_proj | mse: 0.10087762017697192, bpp_loss: 2.6037742015147627, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [20:56<23:51, 84.21s/it]2025-03-03 01:28:25 - INFO - layer15_self_attn.q_proj | mse: 0.11028936768652504, bpp_loss: 2.922659561736509, bpp: 0
2025-03-03 01:28:34 - INFO - layer15_self_attn.k_proj | mse: 0.11096660353391796, bpp_loss: 2.972170344321057, bpp: 0
2025-03-03 01:28:42 - INFO - layer15_self_attn.v_proj | mse: 0.10014544265835186, bpp_loss: 2.4259174031903967, bpp: 0
2025-03-03 01:28:51 - INFO - layer15_self_attn.o_proj | mse: 0.10669370909544314, bpp_loss: 2.4186667829053476, bpp: 0
2025-03-03 01:29:02 - INFO - layer15_mlp.gate_proj | mse: 0.10505993420026014, bpp_loss: 2.6565249524577412, bpp: 0
2025-03-03 01:29:12 - INFO - layer15_mlp.up_proj | mse: 0.10464166485341096, bpp_loss: 2.62777606709752, bpp: 0
2025-03-03 01:29:40 - INFO - layer15_mlp.down_proj | mse: 0.10126336072137346, bpp_loss: 2.606347119435668, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [22:21<22:28, 84.26s/it]2025-03-03 01:29:49 - INFO - layer16_self_attn.q_proj | mse: 0.11047545052485083, bpp_loss: 2.9041220183717087, bpp: 0
2025-03-03 01:29:58 - INFO - layer16_self_attn.k_proj | mse: 0.11094849122377329, bpp_loss: 2.945168284000829, bpp: 0
2025-03-03 01:30:07 - INFO - layer16_self_attn.v_proj | mse: 0.10172088917217087, bpp_loss: 2.465342129347846, bpp: 0
2025-03-03 01:30:16 - INFO - layer16_self_attn.o_proj | mse: 0.10316370907715698, bpp_loss: 2.472281111171469, bpp: 0
2025-03-03 01:30:26 - INFO - layer16_mlp.gate_proj | mse: 0.10655226631445959, bpp_loss: 2.6663639416355034, bpp: 0
2025-03-03 01:30:37 - INFO - layer16_mlp.up_proj | mse: 0.10595234620017752, bpp_loss: 2.6284950192324645, bpp: 0
2025-03-03 01:31:04 - INFO - layer16_mlp.down_proj | mse: 0.10134124184939695, bpp_loss: 2.606959230634709, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [23:45<21:04, 84.33s/it]2025-03-03 01:31:14 - INFO - layer17_self_attn.q_proj | mse: 0.11092226719443395, bpp_loss: 2.9043705842341296, bpp: 0
2025-03-03 01:31:22 - INFO - layer17_self_attn.k_proj | mse: 0.11128224211595295, bpp_loss: 2.9362263505754527, bpp: 0
2025-03-03 01:31:31 - INFO - layer17_self_attn.v_proj | mse: 0.10193704331236833, bpp_loss: 2.46442843019031, bpp: 0
2025-03-03 01:31:40 - INFO - layer17_self_attn.o_proj | mse: 0.10280072123136566, bpp_loss: 2.4660532134003006, bpp: 0
2025-03-03 01:31:51 - INFO - layer17_mlp.gate_proj | mse: 0.10604236957471379, bpp_loss: 2.679804851192721, bpp: 0
2025-03-03 01:32:01 - INFO - layer17_mlp.up_proj | mse: 0.10502780209052527, bpp_loss: 2.6247192065036575, bpp: 0
2025-03-03 01:32:29 - INFO - layer17_mlp.down_proj | mse: 0.10031554972174146, bpp_loss: 2.607437815257283, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [25:09<19:40, 84.34s/it]2025-03-03 01:32:38 - INFO - layer18_self_attn.q_proj | mse: 0.10954162941116014, bpp_loss: 2.878150771895889, bpp: 0
2025-03-03 01:32:47 - INFO - layer18_self_attn.k_proj | mse: 0.10990477949133534, bpp_loss: 2.906212750065606, bpp: 0
2025-03-03 01:32:56 - INFO - layer18_self_attn.v_proj | mse: 0.10231307943789279, bpp_loss: 2.511249641829636, bpp: 0
2025-03-03 01:33:05 - INFO - layer18_self_attn.o_proj | mse: 0.10146985463943631, bpp_loss: 2.510697392048314, bpp: 0
2025-03-03 01:33:15 - INFO - layer18_mlp.gate_proj | mse: 0.10646782250916606, bpp_loss: 2.690432932011263, bpp: 0
2025-03-03 01:33:25 - INFO - layer18_mlp.up_proj | mse: 0.10513652176508977, bpp_loss: 2.621155179040723, bpp: 0
2025-03-03 01:33:53 - INFO - layer18_mlp.down_proj | mse: 0.09970985169186024, bpp_loss: 2.6063642631566455, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [26:34<18:16, 84.35s/it]2025-03-03 01:34:02 - INFO - layer19_self_attn.q_proj | mse: 0.10930154569933839, bpp_loss: 2.8567890461999923, bpp: 0
2025-03-03 01:34:11 - INFO - layer19_self_attn.k_proj | mse: 0.10964416154178079, bpp_loss: 2.8835096468101256, bpp: 0
2025-03-03 01:34:20 - INFO - layer19_self_attn.v_proj | mse: 0.1028163652612411, bpp_loss: 2.5215162218082696, bpp: 0
2025-03-03 01:34:29 - INFO - layer19_self_attn.o_proj | mse: 0.10020541143954105, bpp_loss: 2.515414142573718, bpp: 0
2025-03-03 01:34:39 - INFO - layer19_mlp.gate_proj | mse: 0.10614412987929546, bpp_loss: 2.6950816930120074, bpp: 0
2025-03-03 01:34:50 - INFO - layer19_mlp.up_proj | mse: 0.104722503929271, bpp_loss: 2.6210112709898588, bpp: 0
2025-03-03 01:35:17 - INFO - layer19_mlp.down_proj | mse: 0.09930297432487145, bpp_loss: 2.609631766500168, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [27:58<16:51, 84.31s/it]2025-03-03 01:35:26 - INFO - layer20_self_attn.q_proj | mse: 0.10920137755545446, bpp_loss: 2.8631754567904864, bpp: 0
2025-03-03 01:35:35 - INFO - layer20_self_attn.k_proj | mse: 0.10944103250497592, bpp_loss: 2.888418386603007, bpp: 0
2025-03-03 01:35:44 - INFO - layer20_self_attn.v_proj | mse: 0.10305825672762624, bpp_loss: 2.5384221091517247, bpp: 0
2025-03-03 01:35:53 - INFO - layer20_self_attn.o_proj | mse: 0.10109546403409134, bpp_loss: 2.5415070462040603, bpp: 0
2025-03-03 01:36:03 - INFO - layer20_mlp.gate_proj | mse: 0.1069213975074523, bpp_loss: 2.7045255014023115, bpp: 0
2025-03-03 01:36:14 - INFO - layer20_mlp.up_proj | mse: 0.10525827193289351, bpp_loss: 2.621712443137238, bpp: 0
2025-03-03 01:36:42 - INFO - layer20_mlp.down_proj | mse: 0.0995077453784555, bpp_loss: 2.6111642253520184, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [29:22<15:27, 84.33s/it]2025-03-03 01:36:51 - INFO - layer21_self_attn.q_proj | mse: 0.10856978751078698, bpp_loss: 2.8302650825935416, bpp: 0
2025-03-03 01:37:00 - INFO - layer21_self_attn.k_proj | mse: 0.1086577417231978, bpp_loss: 2.844321399839828, bpp: 0
2025-03-03 01:37:09 - INFO - layer21_self_attn.v_proj | mse: 0.10396375635315724, bpp_loss: 2.5726203308149707, bpp: 0
2025-03-03 01:37:18 - INFO - layer21_self_attn.o_proj | mse: 0.09986817250810767, bpp_loss: 2.5699194230837747, bpp: 0
2025-03-03 01:37:28 - INFO - layer21_mlp.gate_proj | mse: 0.10644165803763211, bpp_loss: 2.7129145508502113, bpp: 0
2025-03-03 01:37:38 - INFO - layer21_mlp.up_proj | mse: 0.10457176932217076, bpp_loss: 2.619632873467581, bpp: 0
2025-03-03 01:38:06 - INFO - layer21_mlp.down_proj | mse: 0.09854160027648952, bpp_loss: 2.6112579054437406, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [30:47<14:03, 84.39s/it]2025-03-03 01:38:15 - INFO - layer22_self_attn.q_proj | mse: 0.10846931807447582, bpp_loss: 2.8660656684078276, bpp: 0
2025-03-03 01:38:24 - INFO - layer22_self_attn.k_proj | mse: 0.10866938783432728, bpp_loss: 2.8829574389674235, bpp: 0
2025-03-03 01:38:33 - INFO - layer22_self_attn.v_proj | mse: 0.10310196730591524, bpp_loss: 2.5765148478676565, bpp: 0
2025-03-03 01:38:42 - INFO - layer22_self_attn.o_proj | mse: 0.09953687830802697, bpp_loss: 2.5609788047731854, bpp: 0
2025-03-03 01:38:52 - INFO - layer22_mlp.gate_proj | mse: 0.10628144592419836, bpp_loss: 2.7213895953325338, bpp: 0
2025-03-03 01:39:03 - INFO - layer22_mlp.up_proj | mse: 0.104198240014319, bpp_loss: 2.6197929802935485, bpp: 0
2025-03-03 01:39:30 - INFO - layer22_mlp.down_proj | mse: 0.09855678670838514, bpp_loss: 2.611952025399998, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [32:11<12:39, 84.37s/it]2025-03-03 01:39:40 - INFO - layer23_self_attn.q_proj | mse: 0.10796012228428568, bpp_loss: 2.8611563579179347, bpp: 0
2025-03-03 01:39:49 - INFO - layer23_self_attn.k_proj | mse: 0.1080734198250947, bpp_loss: 2.8713182266510557, bpp: 0
2025-03-03 01:39:58 - INFO - layer23_self_attn.v_proj | mse: 0.10383709765201757, bpp_loss: 2.631323779496597, bpp: 0
2025-03-03 01:40:06 - INFO - layer23_self_attn.o_proj | mse: 0.0982477291290988, bpp_loss: 2.613782041356899, bpp: 0
2025-03-03 01:40:17 - INFO - layer23_mlp.gate_proj | mse: 0.10547616834101768, bpp_loss: 2.7212931974249526, bpp: 0
2025-03-03 01:40:27 - INFO - layer23_mlp.up_proj | mse: 0.10354523206656195, bpp_loss: 2.6250734690056983, bpp: 0
2025-03-03 01:40:55 - INFO - layer23_mlp.down_proj | mse: 0.09780636482837769, bpp_loss: 2.61863020153413, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [33:36<11:15, 84.42s/it]2025-03-03 01:41:04 - INFO - layer24_self_attn.q_proj | mse: 0.10584040258884471, bpp_loss: 2.805801509413868, bpp: 0
2025-03-03 01:41:13 - INFO - layer24_self_attn.k_proj | mse: 0.10582001899732553, bpp_loss: 2.8123922216764186, bpp: 0
2025-03-03 01:41:22 - INFO - layer24_self_attn.v_proj | mse: 0.10293514400659166, bpp_loss: 2.620602538139792, bpp: 0
2025-03-03 01:41:31 - INFO - layer24_self_attn.o_proj | mse: 0.09967998062279128, bpp_loss: 2.6060517872683704, bpp: 0
2025-03-03 01:41:41 - INFO - layer24_mlp.gate_proj | mse: 0.10495863095467362, bpp_loss: 2.723961898840444, bpp: 0
2025-03-03 01:41:52 - INFO - layer24_mlp.up_proj | mse: 0.10298705954842223, bpp_loss: 2.6285729866994676, bpp: 0
2025-03-03 01:42:19 - INFO - layer24_mlp.down_proj | mse: 0.09732078707667598, bpp_loss: 2.6225088173523545, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [35:00<09:50, 84.40s/it]2025-03-03 01:42:29 - INFO - layer25_self_attn.q_proj | mse: 0.10586093682657752, bpp_loss: 2.8290630696865264, bpp: 0
2025-03-03 01:42:37 - INFO - layer25_self_attn.k_proj | mse: 0.10590723156683854, bpp_loss: 2.8336278155911714, bpp: 0
2025-03-03 01:42:46 - INFO - layer25_self_attn.v_proj | mse: 0.10327060994797248, bpp_loss: 2.6664520531194285, bpp: 0
2025-03-03 01:42:55 - INFO - layer25_self_attn.o_proj | mse: 0.0997636935648803, bpp_loss: 2.6587934722192585, bpp: 0
2025-03-03 01:43:06 - INFO - layer25_mlp.gate_proj | mse: 0.10423903899745256, bpp_loss: 2.724538138959297, bpp: 0
2025-03-03 01:43:16 - INFO - layer25_mlp.up_proj | mse: 0.10244079643542042, bpp_loss: 2.632778572611684, bpp: 0
2025-03-03 01:43:44 - INFO - layer25_mlp.down_proj | mse: 0.09690921838717087, bpp_loss: 2.6260993566667272, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [36:24<08:26, 84.35s/it]2025-03-03 01:43:53 - INFO - layer26_self_attn.q_proj | mse: 0.10480958848992629, bpp_loss: 2.8045404731237795, bpp: 0
2025-03-03 01:44:02 - INFO - layer26_self_attn.k_proj | mse: 0.10484225554194027, bpp_loss: 2.8149053378147073, bpp: 0
2025-03-03 01:44:11 - INFO - layer26_self_attn.v_proj | mse: 0.10313012655969103, bpp_loss: 2.6812462349189445, bpp: 0
2025-03-03 01:44:19 - INFO - layer26_self_attn.o_proj | mse: 0.10255126268978892, bpp_loss: 2.673904135241173, bpp: 0
2025-03-03 01:44:30 - INFO - layer26_mlp.gate_proj | mse: 0.10412396361572901, bpp_loss: 2.7260628029877365, bpp: 0
2025-03-03 01:44:40 - INFO - layer26_mlp.up_proj | mse: 0.10228807836475627, bpp_loss: 2.6372975183780802, bpp: 0
2025-03-03 01:45:08 - INFO - layer26_mlp.down_proj | mse: 0.09688201044132722, bpp_loss: 2.62712329275213, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [37:49<07:02, 84.41s/it]2025-03-03 01:45:17 - INFO - layer27_self_attn.q_proj | mse: 0.10610586439357551, bpp_loss: 2.8715799194178544, bpp: 0
2025-03-03 01:45:26 - INFO - layer27_self_attn.k_proj | mse: 0.10637334253993469, bpp_loss: 2.8861407731601503, bpp: 0
2025-03-03 01:45:35 - INFO - layer27_self_attn.v_proj | mse: 0.10304538227044727, bpp_loss: 2.6888266978785396, bpp: 0
2025-03-03 01:45:44 - INFO - layer27_self_attn.o_proj | mse: 0.10000601379356572, bpp_loss: 2.6887355544022284, bpp: 0
2025-03-03 01:45:54 - INFO - layer27_mlp.gate_proj | mse: 0.10393086912590799, bpp_loss: 2.724635826293812, bpp: 0
2025-03-03 01:46:05 - INFO - layer27_mlp.up_proj | mse: 0.10224532178932273, bpp_loss: 2.6430288320190685, bpp: 0
2025-03-03 01:46:32 - INFO - layer27_mlp.down_proj | mse: 0.09713052980212676, bpp_loss: 2.630510038869499, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [39:13<05:37, 84.38s/it]2025-03-03 01:46:42 - INFO - layer28_self_attn.q_proj | mse: 0.10518378209637654, bpp_loss: 2.8242315633106045, bpp: 0
2025-03-03 01:46:51 - INFO - layer28_self_attn.k_proj | mse: 0.1055297005673482, bpp_loss: 2.841707719693659, bpp: 0
2025-03-03 01:46:59 - INFO - layer28_self_attn.v_proj | mse: 0.1039852176445123, bpp_loss: 2.726264757307945, bpp: 0
2025-03-03 01:47:08 - INFO - layer28_self_attn.o_proj | mse: 0.10327811908231269, bpp_loss: 2.7304968319949694, bpp: 0
2025-03-03 01:47:19 - INFO - layer28_mlp.gate_proj | mse: 0.10367898650080448, bpp_loss: 2.71670369552665, bpp: 0
2025-03-03 01:47:29 - INFO - layer28_mlp.up_proj | mse: 0.10239497842709479, bpp_loss: 2.654578140222056, bpp: 0
2025-03-03 01:47:57 - INFO - layer28_mlp.down_proj | mse: 0.09788441843149367, bpp_loss: 2.6348201271016585, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [40:37<04:13, 84.36s/it]2025-03-03 01:48:06 - INFO - layer29_self_attn.q_proj | mse: 0.10443301930856905, bpp_loss: 2.7799014931079, bpp: 0
2025-03-03 01:48:15 - INFO - layer29_self_attn.k_proj | mse: 0.10451854000522144, bpp_loss: 2.7950217361794785, bpp: 0
2025-03-03 01:48:24 - INFO - layer29_self_attn.v_proj | mse: 0.10439381652851822, bpp_loss: 2.7311394321732223, bpp: 0
2025-03-03 01:48:33 - INFO - layer29_self_attn.o_proj | mse: 0.10240718696872127, bpp_loss: 2.7483195503009483, bpp: 0
2025-03-03 01:48:43 - INFO - layer29_mlp.gate_proj | mse: 0.10383674946792457, bpp_loss: 2.7166921896643417, bpp: 0
2025-03-03 01:48:54 - INFO - layer29_mlp.up_proj | mse: 0.10269272217929705, bpp_loss: 2.664645821375902, bpp: 0
2025-03-03 01:49:21 - INFO - layer29_mlp.down_proj | mse: 0.09881990608576577, bpp_loss: 2.634914472309309, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [42:02<02:48, 84.45s/it]2025-03-03 01:49:31 - INFO - layer30_self_attn.q_proj | mse: 0.10521969383606837, bpp_loss: 2.8003364359610714, bpp: 0
2025-03-03 01:49:40 - INFO - layer30_self_attn.k_proj | mse: 0.10568335970523586, bpp_loss: 2.8227872379356995, bpp: 0
2025-03-03 01:49:48 - INFO - layer30_self_attn.v_proj | mse: 0.10535645742169056, bpp_loss: 2.767246393399546, bpp: 0
2025-03-03 01:49:57 - INFO - layer30_self_attn.o_proj | mse: 0.10387710001581758, bpp_loss: 2.7784226169460453, bpp: 0
2025-03-03 01:50:08 - INFO - layer30_mlp.gate_proj | mse: 0.10481814999182316, bpp_loss: 2.7342255981855614, bpp: 0
2025-03-03 01:50:18 - INFO - layer30_mlp.up_proj | mse: 0.10347757008776975, bpp_loss: 2.675464226885937, bpp: 0
2025-03-03 01:50:46 - INFO - layer30_mlp.down_proj | mse: 0.10128920611398629, bpp_loss: 2.6183426956927707, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [43:27<01:24, 84.50s/it]2025-03-03 01:50:55 - INFO - layer31_self_attn.q_proj | mse: 0.1074729092531131, bpp_loss: 2.821037265006453, bpp: 0
2025-03-03 01:51:04 - INFO - layer31_self_attn.k_proj | mse: 0.10836969457459497, bpp_loss: 2.8642367960419506, bpp: 0
2025-03-03 01:51:13 - INFO - layer31_self_attn.v_proj | mse: 0.10455603932424139, bpp_loss: 2.6434383211890236, bpp: 0
2025-03-03 01:51:22 - INFO - layer31_self_attn.o_proj | mse: 0.1122140237116747, bpp_loss: 2.6402945404988714, bpp: 0
2025-03-03 01:51:32 - INFO - layer31_mlp.gate_proj | mse: 0.10820462081949106, bpp_loss: 2.805741470913554, bpp: 0
2025-03-03 01:51:43 - INFO - layer31_mlp.up_proj | mse: 0.10652001347215999, bpp_loss: 2.7351492997692075, bpp: 0
2025-03-03 01:52:10 - INFO - layer31_mlp.down_proj | mse: 0.11257762330505977, bpp_loss: 2.613680350702516, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [44:51<00:00, 84.47s/it]pseudo compress quantization...: 100%|██████████| 32/32 [44:51<00:00, 84.11s/it]
2025-03-03 01:52:10 - INFO - #### Total | mse: 0.1058081302551282, bpp_loss: 2.6479571436968703, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Llama-2-7b-hf/block_seq_ql_random_col_16/lmbda50_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_3.84823_bpp_4.61283_MSE_0.01614_total_iter_95000.pth.tar/COL_MSE0.10581_bpploss2.648_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Llama-2-7b-hf/block_seq_ql_random_col_16/lmbda50_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_3.84823_bpp_4.61283_MSE_0.01614_total_iter_95000.pth.tar/COL_MSE0.10581_bpploss2.648_bpp0
I0303 01:52:42.026656 2846886 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.52it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.62it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.81it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.74it/s]
I0303 01:52:43.883524 2846886 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/166 [00:00<?, ?it/s]avg_loss = 1.5078125:   0%|          | 0/166 [00:00<?, ?it/s]avg_loss = 1.5078125:   1%|          | 1/166 [00:00<01:25,  1.94it/s]avg_loss = 1.76953125:   1%|          | 1/166 [00:00<01:25,  1.94it/s]avg_loss = 1.76953125:   1%|          | 2/166 [00:00<01:10,  2.32it/s]avg_loss = 1.9296875:   1%|          | 2/166 [00:01<01:10,  2.32it/s] avg_loss = 1.9296875:   2%|▏         | 3/166 [00:01<01:06,  2.47it/s]avg_loss = 1.966796875:   2%|▏         | 3/166 [00:01<01:06,  2.47it/s]avg_loss = 1.966796875:   2%|▏         | 4/166 [00:01<01:03,  2.54it/s]avg_loss = 1.8890625:   2%|▏         | 4/166 [00:02<01:03,  2.54it/s]  avg_loss = 1.8890625:   3%|▎         | 5/166 [00:02<01:02,  2.59it/s]avg_loss = 1.86328125:   3%|▎         | 5/166 [00:02<01:02,  2.59it/s]avg_loss = 1.86328125:   4%|▎         | 6/166 [00:02<01:01,  2.61it/s]avg_loss = 1.8046875:   4%|▎         | 6/166 [00:02<01:01,  2.61it/s] avg_loss = 1.8046875:   4%|▍         | 7/166 [00:02<01:00,  2.63it/s]avg_loss = 1.75:   4%|▍         | 7/166 [00:03<01:00,  2.63it/s]     avg_loss = 1.75:   5%|▍         | 8/166 [00:03<00:59,  2.64it/s]avg_loss = 1.7447916666666667:   5%|▍         | 8/166 [00:03<00:59,  2.64it/s]avg_loss = 1.7447916666666667:   5%|▌         | 9/166 [00:03<00:59,  2.65it/s]avg_loss = 1.753125:   5%|▌         | 9/166 [00:03<00:59,  2.65it/s]          avg_loss = 1.753125:   6%|▌         | 10/166 [00:03<00:58,  2.65it/s]avg_loss = 1.7677556818181819:   6%|▌         | 10/166 [00:04<00:58,  2.65it/s]avg_loss = 1.7677556818181819:   7%|▋         | 11/166 [00:04<00:58,  2.65it/s]avg_loss = 1.7734375:   7%|▋         | 11/166 [00:04<00:58,  2.65it/s]         avg_loss = 1.7734375:   7%|▋         | 12/166 [00:04<00:57,  2.66it/s]avg_loss = 1.7680288461538463:   7%|▋         | 12/166 [00:05<00:57,  2.66it/s]avg_loss = 1.7680288461538463:   8%|▊         | 13/166 [00:05<00:57,  2.65it/s]avg_loss = 1.7767857142857142:   8%|▊         | 13/166 [00:05<00:57,  2.65it/s]avg_loss = 1.7767857142857142:   8%|▊         | 14/166 [00:05<00:57,  2.66it/s]avg_loss = 1.79375:   8%|▊         | 14/166 [00:05<00:57,  2.66it/s]           avg_loss = 1.79375:   9%|▉         | 15/166 [00:05<00:56,  2.66it/s]avg_loss = 1.8125:   9%|▉         | 15/166 [00:06<00:56,  2.66it/s] avg_loss = 1.8125:  10%|▉         | 16/166 [00:06<00:56,  2.65it/s]avg_loss = 1.8244485294117647:  10%|▉         | 16/166 [00:06<00:56,  2.65it/s]avg_loss = 1.8244485294117647:  10%|█         | 17/166 [00:06<00:56,  2.66it/s]avg_loss = 1.8385416666666667:  10%|█         | 17/166 [00:06<00:56,  2.66it/s]avg_loss = 1.8385416666666667:  11%|█         | 18/166 [00:06<00:55,  2.65it/s]avg_loss = 1.8577302631578947:  11%|█         | 18/166 [00:07<00:55,  2.65it/s]avg_loss = 1.8577302631578947:  11%|█▏        | 19/166 [00:07<00:55,  2.65it/s]avg_loss = 1.8640625:  11%|█▏        | 19/166 [00:07<00:55,  2.65it/s]         avg_loss = 1.8640625:  12%|█▏        | 20/166 [00:07<00:55,  2.65it/s]avg_loss = 1.8668154761904763:  12%|█▏        | 20/166 [00:08<00:55,  2.65it/s]avg_loss = 1.8668154761904763:  13%|█▎        | 21/166 [00:08<00:54,  2.65it/s]avg_loss = 1.8568892045454546:  13%|█▎        | 21/166 [00:08<00:54,  2.65it/s]avg_loss = 1.8568892045454546:  13%|█▎        | 22/166 [00:08<00:54,  2.65it/s]avg_loss = 1.8478260869565217:  13%|█▎        | 22/166 [00:08<00:54,  2.65it/s]avg_loss = 1.8478260869565217:  14%|█▍        | 23/166 [00:08<00:53,  2.65it/s]avg_loss = 1.8548177083333333:  14%|█▍        | 23/166 [00:09<00:53,  2.65it/s]avg_loss = 1.8548177083333333:  14%|█▍        | 24/166 [00:09<00:53,  2.65it/s]avg_loss = 1.8625:  14%|█▍        | 24/166 [00:09<00:53,  2.65it/s]            avg_loss = 1.8625:  15%|█▌        | 25/166 [00:09<00:53,  2.65it/s]avg_loss = 1.8668870192307692:  15%|█▌        | 25/166 [00:09<00:53,  2.65it/s]avg_loss = 1.8668870192307692:  16%|█▌        | 26/166 [00:09<00:52,  2.65it/s]avg_loss = 1.8723958333333333:  16%|█▌        | 26/166 [00:10<00:52,  2.65it/s]avg_loss = 1.8723958333333333:  16%|█▋        | 27/166 [00:10<00:52,  2.65it/s]avg_loss = 1.875:  16%|█▋        | 27/166 [00:10<00:52,  2.65it/s]             avg_loss = 1.875:  17%|█▋        | 28/166 [00:10<00:51,  2.65it/s]avg_loss = 1.8836206896551724:  17%|█▋        | 28/166 [00:11<00:51,  2.65it/s]avg_loss = 1.8836206896551724:  17%|█▋        | 29/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8833333333333333:  17%|█▋        | 29/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8833333333333333:  18%|█▊        | 30/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8976814516129032:  18%|█▊        | 30/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8976814516129032:  19%|█▊        | 31/166 [00:11<00:50,  2.66it/s]avg_loss = 1.90380859375:  19%|█▊        | 31/166 [00:12<00:50,  2.66it/s]     avg_loss = 1.90380859375:  19%|█▉        | 32/166 [00:12<00:50,  2.66it/s]avg_loss = 1.9086174242424243:  19%|█▉        | 32/166 [00:12<00:50,  2.66it/s]avg_loss = 1.9086174242424243:  20%|█▉        | 33/166 [00:12<00:50,  2.66it/s]avg_loss = 1.9071691176470589:  20%|█▉        | 33/166 [00:12<00:50,  2.66it/s]avg_loss = 1.9071691176470589:  20%|██        | 34/166 [00:12<00:49,  2.66it/s]avg_loss = 1.9006696428571428:  20%|██        | 34/166 [00:13<00:49,  2.66it/s]avg_loss = 1.9006696428571428:  21%|██        | 35/166 [00:13<00:49,  2.66it/s]avg_loss = 1.8930121527777777:  21%|██        | 35/166 [00:13<00:49,  2.66it/s]avg_loss = 1.8930121527777777:  22%|██▏       | 36/166 [00:13<00:48,  2.66it/s]avg_loss = 1.8840793918918919:  22%|██▏       | 36/166 [00:14<00:48,  2.66it/s]avg_loss = 1.8840793918918919:  22%|██▏       | 37/166 [00:14<00:48,  2.66it/s]avg_loss = 1.881373355263158:  22%|██▏       | 37/166 [00:14<00:48,  2.66it/s] avg_loss = 1.881373355263158:  23%|██▎       | 38/166 [00:14<00:48,  2.66it/s]avg_loss = 1.8786057692307692:  23%|██▎       | 38/166 [00:14<00:48,  2.66it/s]avg_loss = 1.8786057692307692:  23%|██▎       | 39/166 [00:14<00:47,  2.66it/s]avg_loss = 1.881640625:  23%|██▎       | 39/166 [00:15<00:47,  2.66it/s]       avg_loss = 1.881640625:  24%|██▍       | 40/166 [00:15<00:47,  2.66it/s]avg_loss = 1.8814786585365855:  24%|██▍       | 40/166 [00:15<00:47,  2.66it/s]avg_loss = 1.8814786585365855:  25%|██▍       | 41/166 [00:15<00:47,  2.66it/s]avg_loss = 1.8684895833333333:  25%|██▍       | 41/166 [00:15<00:47,  2.66it/s]avg_loss = 1.8684895833333333:  25%|██▌       | 42/166 [00:15<00:46,  2.66it/s]avg_loss = 1.8522892441860466:  25%|██▌       | 42/166 [00:16<00:46,  2.66it/s]avg_loss = 1.8522892441860466:  26%|██▌       | 43/166 [00:16<00:46,  2.65it/s]avg_loss = 1.8419744318181819:  26%|██▌       | 43/166 [00:16<00:46,  2.65it/s]avg_loss = 1.8419744318181819:  27%|██▋       | 44/166 [00:16<00:45,  2.66it/s]avg_loss = 1.827951388888889:  27%|██▋       | 44/166 [00:17<00:45,  2.66it/s] avg_loss = 1.827951388888889:  27%|██▋       | 45/166 [00:17<00:45,  2.65it/s]avg_loss = 1.8174252717391304:  27%|██▋       | 45/166 [00:17<00:45,  2.65it/s]avg_loss = 1.8174252717391304:  28%|██▊       | 46/166 [00:17<00:45,  2.65it/s]avg_loss = 1.809840425531915:  28%|██▊       | 46/166 [00:17<00:45,  2.65it/s] avg_loss = 1.809840425531915:  28%|██▊       | 47/166 [00:17<00:44,  2.66it/s]avg_loss = 1.8108723958333333:  28%|██▊       | 47/166 [00:18<00:44,  2.66it/s]avg_loss = 1.8108723958333333:  29%|██▉       | 48/166 [00:18<00:44,  2.65it/s]avg_loss = 1.8214285714285714:  29%|██▉       | 48/166 [00:18<00:44,  2.65it/s]avg_loss = 1.8214285714285714:  30%|██▉       | 49/166 [00:18<00:44,  2.65it/s]avg_loss = 1.83125:  30%|██▉       | 49/166 [00:18<00:44,  2.65it/s]           avg_loss = 1.83125:  30%|███       | 50/166 [00:18<00:43,  2.65it/s]avg_loss = 1.8388480392156863:  30%|███       | 50/166 [00:19<00:43,  2.65it/s]avg_loss = 1.8388480392156863:  31%|███       | 51/166 [00:19<00:43,  2.65it/s]avg_loss = 1.8443509615384615:  31%|███       | 51/166 [00:19<00:43,  2.65it/s]avg_loss = 1.8443509615384615:  31%|███▏      | 52/166 [00:19<00:43,  2.65it/s]avg_loss = 1.8475825471698113:  31%|███▏      | 52/166 [00:20<00:43,  2.65it/s]avg_loss = 1.8475825471698113:  32%|███▏      | 53/166 [00:20<00:42,  2.65it/s]avg_loss = 1.8478009259259258:  32%|███▏      | 53/166 [00:20<00:42,  2.65it/s]avg_loss = 1.8478009259259258:  33%|███▎      | 54/166 [00:20<00:42,  2.65it/s]avg_loss = 1.850284090909091:  33%|███▎      | 54/166 [00:20<00:42,  2.65it/s] avg_loss = 1.850284090909091:  33%|███▎      | 55/166 [00:20<00:41,  2.65it/s]avg_loss = 1.853515625:  33%|███▎      | 55/166 [00:21<00:41,  2.65it/s]      avg_loss = 1.853515625:  34%|███▎      | 56/166 [00:21<00:41,  2.65it/s]avg_loss = 1.8484100877192982:  34%|███▎      | 56/166 [00:21<00:41,  2.65it/s]avg_loss = 1.8484100877192982:  34%|███▍      | 57/166 [00:21<00:41,  2.65it/s]avg_loss = 1.8521012931034482:  34%|███▍      | 57/166 [00:21<00:41,  2.65it/s]avg_loss = 1.8521012931034482:  35%|███▍      | 58/166 [00:21<00:40,  2.64it/s]avg_loss = 1.8503707627118644:  35%|███▍      | 58/166 [00:22<00:40,  2.64it/s]avg_loss = 1.8503707627118644:  36%|███▌      | 59/166 [00:22<00:40,  2.64it/s]avg_loss = 1.8459635416666667:  36%|███▌      | 59/166 [00:22<00:40,  2.64it/s]avg_loss = 1.8459635416666667:  36%|███▌      | 60/166 [00:22<00:40,  2.64it/s]avg_loss = 1.841188524590164:  36%|███▌      | 60/166 [00:23<00:40,  2.64it/s] avg_loss = 1.841188524590164:  37%|███▋      | 61/166 [00:23<00:39,  2.64it/s]avg_loss = 1.8371975806451613:  37%|███▋      | 61/166 [00:23<00:39,  2.64it/s]avg_loss = 1.8371975806451613:  37%|███▋      | 62/166 [00:23<00:39,  2.64it/s]avg_loss = 1.8315972222222223:  37%|███▋      | 62/166 [00:23<00:39,  2.64it/s]avg_loss = 1.8315972222222223:  38%|███▊      | 63/166 [00:23<00:38,  2.64it/s]avg_loss = 1.8275146484375:  38%|███▊      | 63/166 [00:24<00:38,  2.64it/s]   avg_loss = 1.8275146484375:  39%|███▊      | 64/166 [00:24<00:38,  2.64it/s]avg_loss = 1.8205528846153847:  39%|███▊      | 64/166 [00:24<00:38,  2.64it/s]avg_loss = 1.8205528846153847:  39%|███▉      | 65/166 [00:24<00:38,  2.64it/s]avg_loss = 1.8133285984848484:  39%|███▉      | 65/166 [00:25<00:38,  2.64it/s]avg_loss = 1.8133285984848484:  40%|███▉      | 66/166 [00:25<00:37,  2.64it/s]avg_loss = 1.8088852611940298:  40%|███▉      | 66/166 [00:25<00:37,  2.64it/s]avg_loss = 1.8088852611940298:  40%|████      | 67/166 [00:25<00:37,  2.64it/s]avg_loss = 1.8076746323529411:  40%|████      | 67/166 [00:25<00:37,  2.64it/s]avg_loss = 1.8076746323529411:  41%|████      | 68/166 [00:25<00:37,  2.64it/s]avg_loss = 1.809782608695652:  41%|████      | 68/166 [00:26<00:37,  2.64it/s] avg_loss = 1.809782608695652:  42%|████▏     | 69/166 [00:26<00:36,  2.64it/s]avg_loss = 1.8129464285714285:  42%|████▏     | 69/166 [00:26<00:36,  2.64it/s]avg_loss = 1.8129464285714285:  42%|████▏     | 70/166 [00:26<00:36,  2.64it/s]avg_loss = 1.816681338028169:  42%|████▏     | 70/166 [00:26<00:36,  2.64it/s] avg_loss = 1.816681338028169:  43%|████▎     | 71/166 [00:26<00:36,  2.64it/s]avg_loss = 1.8216145833333333:  43%|████▎     | 71/166 [00:27<00:36,  2.64it/s]avg_loss = 1.8216145833333333:  43%|████▎     | 72/166 [00:27<00:35,  2.64it/s]avg_loss = 1.8276969178082192:  43%|████▎     | 72/166 [00:27<00:35,  2.64it/s]avg_loss = 1.8276969178082192:  44%|████▍     | 73/166 [00:27<00:35,  2.64it/s]avg_loss = 1.822212837837838:  44%|████▍     | 73/166 [00:28<00:35,  2.64it/s] avg_loss = 1.822212837837838:  45%|████▍     | 74/166 [00:28<00:34,  2.63it/s]avg_loss = 1.8179166666666666:  45%|████▍     | 74/166 [00:28<00:34,  2.63it/s]avg_loss = 1.8179166666666666:  45%|████▌     | 75/166 [00:28<00:34,  2.63it/s]avg_loss = 1.8172286184210527:  45%|████▌     | 75/166 [00:28<00:34,  2.63it/s]avg_loss = 1.8172286184210527:  46%|████▌     | 76/166 [00:28<00:34,  2.64it/s]avg_loss = 1.8139204545454546:  46%|████▌     | 76/166 [00:29<00:34,  2.64it/s]avg_loss = 1.8139204545454546:  46%|████▋     | 77/166 [00:29<00:33,  2.63it/s]avg_loss = 1.8103966346153846:  46%|████▋     | 77/166 [00:29<00:33,  2.63it/s]avg_loss = 1.8103966346153846:  47%|████▋     | 78/166 [00:29<00:33,  2.63it/s]avg_loss = 1.807753164556962:  47%|████▋     | 78/166 [00:29<00:33,  2.63it/s] avg_loss = 1.807753164556962:  48%|████▊     | 79/166 [00:29<00:33,  2.63it/s]avg_loss = 1.80419921875:  48%|████▊     | 79/166 [00:30<00:33,  2.63it/s]    avg_loss = 1.80419921875:  48%|████▊     | 80/166 [00:30<00:32,  2.63it/s]avg_loss = 1.7956211419753085:  48%|████▊     | 80/166 [00:30<00:32,  2.63it/s]avg_loss = 1.7956211419753085:  49%|████▉     | 81/166 [00:30<00:32,  2.63it/s]avg_loss = 1.7973513719512195:  49%|████▉     | 81/166 [00:31<00:32,  2.63it/s]avg_loss = 1.7973513719512195:  49%|████▉     | 82/166 [00:31<00:31,  2.63it/s]avg_loss = 1.798851656626506:  49%|████▉     | 82/166 [00:31<00:31,  2.63it/s] avg_loss = 1.798851656626506:  50%|█████     | 83/166 [00:31<00:31,  2.63it/s]avg_loss = 1.8019903273809523:  50%|█████     | 83/166 [00:31<00:31,  2.63it/s]avg_loss = 1.8019903273809523:  51%|█████     | 84/166 [00:31<00:31,  2.63it/s]avg_loss = 1.8038602941176471:  51%|█████     | 84/166 [00:32<00:31,  2.63it/s]avg_loss = 1.8038602941176471:  51%|█████     | 85/166 [00:32<00:30,  2.63it/s]avg_loss = 1.8025981104651163:  51%|█████     | 85/166 [00:32<00:30,  2.63it/s]avg_loss = 1.8025981104651163:  52%|█████▏    | 86/166 [00:32<00:30,  2.63it/s]avg_loss = 1.8026221264367817:  52%|█████▏    | 86/166 [00:32<00:30,  2.63it/s]avg_loss = 1.8026221264367817:  52%|█████▏    | 87/166 [00:32<00:30,  2.63it/s]avg_loss = 1.8025568181818181:  52%|█████▏    | 87/166 [00:33<00:30,  2.63it/s]avg_loss = 1.8025568181818181:  53%|█████▎    | 88/166 [00:33<00:29,  2.63it/s]avg_loss = 1.8035463483146068:  53%|█████▎    | 88/166 [00:33<00:29,  2.63it/s]avg_loss = 1.8035463483146068:  54%|█████▎    | 89/166 [00:33<00:29,  2.63it/s]avg_loss = 1.8034722222222221:  54%|█████▎    | 89/166 [00:34<00:29,  2.63it/s]avg_loss = 1.8034722222222221:  54%|█████▍    | 90/166 [00:34<00:28,  2.63it/s]avg_loss = 1.8036572802197801:  54%|█████▍    | 90/166 [00:34<00:28,  2.63it/s]avg_loss = 1.8036572802197801:  55%|█████▍    | 91/166 [00:34<00:28,  2.63it/s]avg_loss = 1.804602581521739:  55%|█████▍    | 91/166 [00:34<00:28,  2.63it/s] avg_loss = 1.804602581521739:  55%|█████▌    | 92/166 [00:34<00:28,  2.63it/s]avg_loss = 1.8083837365591398:  55%|█████▌    | 92/166 [00:35<00:28,  2.63it/s]avg_loss = 1.8083837365591398:  56%|█████▌    | 93/166 [00:35<00:27,  2.63it/s]avg_loss = 1.8072639627659575:  56%|█████▌    | 93/166 [00:35<00:27,  2.63it/s]avg_loss = 1.8072639627659575:  57%|█████▋    | 94/166 [00:35<00:27,  2.63it/s]avg_loss = 1.8063322368421053:  57%|█████▋    | 94/166 [00:36<00:27,  2.63it/s]avg_loss = 1.8063322368421053:  57%|█████▋    | 95/166 [00:36<00:26,  2.63it/s]avg_loss = 1.8058268229166667:  57%|█████▋    | 95/166 [00:36<00:26,  2.63it/s]avg_loss = 1.8058268229166667:  58%|█████▊    | 96/166 [00:36<00:26,  2.63it/s]avg_loss = 1.8055734536082475:  58%|█████▊    | 96/166 [00:36<00:26,  2.63it/s]avg_loss = 1.8055734536082475:  58%|█████▊    | 97/166 [00:36<00:26,  2.62it/s]avg_loss = 1.803890306122449:  58%|█████▊    | 97/166 [00:37<00:26,  2.62it/s] avg_loss = 1.803890306122449:  59%|█████▉    | 98/166 [00:37<00:25,  2.63it/s]avg_loss = 1.8012152777777777:  59%|█████▉    | 98/166 [00:37<00:25,  2.63it/s]avg_loss = 1.8012152777777777:  60%|█████▉    | 99/166 [00:37<00:25,  2.62it/s]avg_loss = 1.798671875:  60%|█████▉    | 99/166 [00:37<00:25,  2.62it/s]       avg_loss = 1.798671875:  60%|██████    | 100/166 [00:37<00:25,  2.62it/s]avg_loss = 1.799272896039604:  60%|██████    | 100/166 [00:38<00:25,  2.62it/s]avg_loss = 1.799272896039604:  61%|██████    | 101/166 [00:38<00:24,  2.63it/s]avg_loss = 1.8000919117647058:  61%|██████    | 101/166 [00:38<00:24,  2.63it/s]avg_loss = 1.8000919117647058:  61%|██████▏   | 102/166 [00:38<00:24,  2.62it/s]avg_loss = 1.8013501213592233:  61%|██████▏   | 102/166 [00:39<00:24,  2.62it/s]avg_loss = 1.8013501213592233:  62%|██████▏   | 103/166 [00:39<00:23,  2.63it/s]avg_loss = 1.8035606971153846:  62%|██████▏   | 103/166 [00:39<00:23,  2.63it/s]avg_loss = 1.8035606971153846:  63%|██████▎   | 104/166 [00:39<00:23,  2.62it/s]avg_loss = 1.8101934523809524:  63%|██████▎   | 104/166 [00:39<00:23,  2.62it/s]avg_loss = 1.8101934523809524:  63%|██████▎   | 105/166 [00:39<00:23,  2.62it/s]avg_loss = 1.8153744103773586:  63%|██████▎   | 105/166 [00:40<00:23,  2.62it/s]avg_loss = 1.8153744103773586:  64%|██████▍   | 106/166 [00:40<00:22,  2.63it/s]avg_loss = 1.8189982476635513:  64%|██████▍   | 106/166 [00:40<00:22,  2.63it/s]avg_loss = 1.8189982476635513:  64%|██████▍   | 107/166 [00:40<00:22,  2.62it/s]avg_loss = 1.8221209490740742:  64%|██████▍   | 107/166 [00:40<00:22,  2.62it/s]avg_loss = 1.8221209490740742:  65%|██████▌   | 108/166 [00:40<00:22,  2.62it/s]avg_loss = 1.8269065366972477:  65%|██████▌   | 108/166 [00:41<00:22,  2.62it/s]avg_loss = 1.8269065366972477:  66%|██████▌   | 109/166 [00:41<00:21,  2.62it/s]avg_loss = 1.830184659090909:  66%|██████▌   | 109/166 [00:41<00:21,  2.62it/s] avg_loss = 1.830184659090909:  66%|██████▋   | 110/166 [00:41<00:21,  2.62it/s]avg_loss = 1.8314329954954955:  66%|██████▋   | 110/166 [00:42<00:21,  2.62it/s]avg_loss = 1.8314329954954955:  67%|██████▋   | 111/166 [00:42<00:20,  2.62it/s]avg_loss = 1.8325892857142858:  67%|██████▋   | 111/166 [00:42<00:20,  2.62it/s]avg_loss = 1.8325892857142858:  67%|██████▋   | 112/166 [00:42<00:20,  2.63it/s]avg_loss = 1.8326189159292035:  67%|██████▋   | 112/166 [00:42<00:20,  2.63it/s]avg_loss = 1.8326189159292035:  68%|██████▊   | 113/166 [00:42<00:20,  2.63it/s]avg_loss = 1.8340186403508771:  68%|██████▊   | 113/166 [00:43<00:20,  2.63it/s]avg_loss = 1.8340186403508771:  69%|██████▊   | 114/166 [00:43<00:19,  2.63it/s]avg_loss = 1.8317934782608696:  69%|██████▊   | 114/166 [00:43<00:19,  2.63it/s]avg_loss = 1.8317934782608696:  69%|██████▉   | 115/166 [00:43<00:19,  2.63it/s]avg_loss = 1.8314251077586208:  69%|██████▉   | 115/166 [00:44<00:19,  2.63it/s]avg_loss = 1.8314251077586208:  70%|██████▉   | 116/166 [00:44<00:19,  2.63it/s]avg_loss = 1.8327323717948718:  70%|██████▉   | 116/166 [00:44<00:19,  2.63it/s]avg_loss = 1.8327323717948718:  70%|███████   | 117/166 [00:44<00:18,  2.63it/s]avg_loss = 1.8330243644067796:  70%|███████   | 117/166 [00:44<00:18,  2.63it/s]avg_loss = 1.8330243644067796:  71%|███████   | 118/166 [00:44<00:18,  2.63it/s]avg_loss = 1.833048844537815:  71%|███████   | 118/166 [00:45<00:18,  2.63it/s] avg_loss = 1.833048844537815:  72%|███████▏  | 119/166 [00:45<00:17,  2.63it/s]avg_loss = 1.8336588541666667:  72%|███████▏  | 119/166 [00:45<00:17,  2.63it/s]avg_loss = 1.8336588541666667:  72%|███████▏  | 120/166 [00:45<00:17,  2.63it/s]avg_loss = 1.8335485537190082:  72%|███████▏  | 120/166 [00:45<00:17,  2.63it/s]avg_loss = 1.8335485537190082:  73%|███████▎  | 121/166 [00:45<00:17,  2.63it/s]avg_loss = 1.8345286885245902:  73%|███████▎  | 121/166 [00:46<00:17,  2.63it/s]avg_loss = 1.8345286885245902:  73%|███████▎  | 122/166 [00:46<00:16,  2.63it/s]avg_loss = 1.8349212398373984:  73%|███████▎  | 122/166 [00:46<00:16,  2.63it/s]avg_loss = 1.8349212398373984:  74%|███████▍  | 123/166 [00:46<00:16,  2.63it/s]avg_loss = 1.8336693548387097:  74%|███████▍  | 123/166 [00:47<00:16,  2.63it/s]avg_loss = 1.8336693548387097:  75%|███████▍  | 124/166 [00:47<00:15,  2.63it/s]avg_loss = 1.8321875:  75%|███████▍  | 124/166 [00:47<00:15,  2.63it/s]         avg_loss = 1.8321875:  75%|███████▌  | 125/166 [00:47<00:15,  2.63it/s]avg_loss = 1.8302951388888888:  75%|███████▌  | 125/166 [00:47<00:15,  2.63it/s]avg_loss = 1.8302951388888888:  76%|███████▌  | 126/166 [00:47<00:15,  2.63it/s]avg_loss = 1.828371062992126:  76%|███████▌  | 126/166 [00:48<00:15,  2.63it/s] avg_loss = 1.828371062992126:  77%|███████▋  | 127/166 [00:48<00:14,  2.63it/s]avg_loss = 1.82708740234375:  77%|███████▋  | 127/166 [00:48<00:14,  2.63it/s] avg_loss = 1.82708740234375:  77%|███████▋  | 128/166 [00:48<00:14,  2.63it/s]avg_loss = 1.8260658914728682:  77%|███████▋  | 128/166 [00:48<00:14,  2.63it/s]avg_loss = 1.8260658914728682:  78%|███████▊  | 129/166 [00:48<00:14,  2.63it/s]avg_loss = 1.8260216346153846:  78%|███████▊  | 129/166 [00:49<00:14,  2.63it/s]avg_loss = 1.8260216346153846:  78%|███████▊  | 130/166 [00:49<00:13,  2.63it/s]avg_loss = 1.8270515267175573:  78%|███████▊  | 130/166 [00:49<00:13,  2.63it/s]avg_loss = 1.8270515267175573:  79%|███████▉  | 131/166 [00:49<00:13,  2.63it/s]avg_loss = 1.8276515151515151:  79%|███████▉  | 131/166 [00:50<00:13,  2.63it/s]avg_loss = 1.8276515151515151:  80%|███████▉  | 132/166 [00:50<00:12,  2.63it/s]avg_loss = 1.8285361842105263:  80%|███████▉  | 132/166 [00:50<00:12,  2.63it/s]avg_loss = 1.8285361842105263:  80%|████████  | 133/166 [00:50<00:12,  2.63it/s]avg_loss = 1.829932369402985:  80%|████████  | 133/166 [00:50<00:12,  2.63it/s] avg_loss = 1.829932369402985:  81%|████████  | 134/166 [00:50<00:12,  2.63it/s]avg_loss = 1.8277199074074073:  81%|████████  | 134/166 [00:51<00:12,  2.63it/s]avg_loss = 1.8277199074074073:  81%|████████▏ | 135/166 [00:51<00:11,  2.63it/s]avg_loss = 1.8278952205882353:  81%|████████▏ | 135/166 [00:51<00:11,  2.63it/s]avg_loss = 1.8278952205882353:  82%|████████▏ | 136/166 [00:51<00:11,  2.63it/s]avg_loss = 1.8282390510948905:  82%|████████▏ | 136/166 [00:52<00:11,  2.63it/s]avg_loss = 1.8282390510948905:  83%|████████▎ | 137/166 [00:52<00:11,  2.63it/s]avg_loss = 1.828917572463768:  83%|████████▎ | 137/166 [00:52<00:11,  2.63it/s] avg_loss = 1.828917572463768:  83%|████████▎ | 138/166 [00:52<00:10,  2.63it/s]avg_loss = 1.8279563848920863:  83%|████████▎ | 138/166 [00:52<00:10,  2.63it/s]avg_loss = 1.8279563848920863:  84%|████████▎ | 139/166 [00:52<00:10,  2.63it/s]avg_loss = 1.8265066964285714:  84%|████████▎ | 139/166 [00:53<00:10,  2.63it/s]avg_loss = 1.8265066964285714:  84%|████████▍ | 140/166 [00:53<00:09,  2.63it/s]avg_loss = 1.824855939716312:  84%|████████▍ | 140/166 [00:53<00:09,  2.63it/s] avg_loss = 1.824855939716312:  85%|████████▍ | 141/166 [00:53<00:09,  2.63it/s]avg_loss = 1.8245488556338028:  85%|████████▍ | 141/166 [00:53<00:09,  2.63it/s]avg_loss = 1.8245488556338028:  86%|████████▌ | 142/166 [00:53<00:09,  2.63it/s]avg_loss = 1.8229348776223777:  86%|████████▌ | 142/166 [00:54<00:09,  2.63it/s]avg_loss = 1.8229348776223777:  86%|████████▌ | 143/166 [00:54<00:08,  2.63it/s]avg_loss = 1.8241644965277777:  86%|████████▌ | 143/166 [00:54<00:08,  2.63it/s]avg_loss = 1.8241644965277777:  87%|████████▋ | 144/166 [00:54<00:08,  2.63it/s]avg_loss = 1.8231681034482758:  87%|████████▋ | 144/166 [00:55<00:08,  2.63it/s]avg_loss = 1.8231681034482758:  87%|████████▋ | 145/166 [00:55<00:07,  2.63it/s]avg_loss = 1.8228809931506849:  87%|████████▋ | 145/166 [00:55<00:07,  2.63it/s]avg_loss = 1.8228809931506849:  88%|████████▊ | 146/166 [00:55<00:07,  2.63it/s]avg_loss = 1.8214817176870748:  88%|████████▊ | 146/166 [00:55<00:07,  2.63it/s]avg_loss = 1.8214817176870748:  89%|████████▊ | 147/166 [00:55<00:07,  2.62it/s]avg_loss = 1.8205764358108107:  89%|████████▊ | 147/166 [00:56<00:07,  2.62it/s]avg_loss = 1.8205764358108107:  89%|████████▉ | 148/166 [00:56<00:06,  2.63it/s]avg_loss = 1.818844379194631:  89%|████████▉ | 148/166 [00:56<00:06,  2.63it/s] avg_loss = 1.818844379194631:  90%|████████▉ | 149/166 [00:56<00:06,  2.62it/s]avg_loss = 1.8197395833333334:  90%|████████▉ | 149/166 [00:56<00:06,  2.62it/s]avg_loss = 1.8197395833333334:  90%|█████████ | 150/166 [00:56<00:06,  2.62it/s]avg_loss = 1.8189673013245033:  90%|█████████ | 150/166 [00:57<00:06,  2.62it/s]avg_loss = 1.8189673013245033:  91%|█████████ | 151/166 [00:57<00:05,  2.62it/s]avg_loss = 1.8187191611842106:  91%|█████████ | 151/166 [00:57<00:05,  2.62it/s]avg_loss = 1.8187191611842106:  92%|█████████▏| 152/166 [00:57<00:05,  2.62it/s]avg_loss = 1.8185253267973855:  92%|█████████▏| 152/166 [00:58<00:05,  2.62it/s]avg_loss = 1.8185253267973855:  92%|█████████▏| 153/166 [00:58<00:04,  2.62it/s]avg_loss = 1.8204139610389611:  92%|█████████▏| 153/166 [00:58<00:04,  2.62it/s]avg_loss = 1.8204139610389611:  93%|█████████▎| 154/166 [00:58<00:04,  2.62it/s]avg_loss = 1.8198084677419355:  93%|█████████▎| 154/166 [00:58<00:04,  2.62it/s]avg_loss = 1.8198084677419355:  93%|█████████▎| 155/166 [00:58<00:04,  2.62it/s]avg_loss = 1.8196113782051282:  93%|█████████▎| 155/166 [00:59<00:04,  2.62it/s]avg_loss = 1.8196113782051282:  94%|█████████▍| 156/166 [00:59<00:03,  2.62it/s]avg_loss = 1.8176751592356688:  94%|█████████▍| 156/166 [00:59<00:03,  2.62it/s]avg_loss = 1.8176751592356688:  95%|█████████▍| 157/166 [00:59<00:03,  2.62it/s]avg_loss = 1.8129944620253164:  95%|█████████▍| 157/166 [01:00<00:03,  2.62it/s]avg_loss = 1.8129944620253164:  95%|█████████▌| 158/166 [01:00<00:03,  2.62it/s]avg_loss = 1.8135318396226414:  95%|█████████▌| 158/166 [01:00<00:03,  2.62it/s]avg_loss = 1.8135318396226414:  96%|█████████▌| 159/166 [01:00<00:02,  2.62it/s]avg_loss = 1.814990234375:  96%|█████████▌| 159/166 [01:00<00:02,  2.62it/s]    avg_loss = 1.814990234375:  96%|█████████▋| 160/166 [01:00<00:02,  2.62it/s]avg_loss = 1.8174010093167703:  96%|█████████▋| 160/166 [01:01<00:02,  2.62it/s]avg_loss = 1.8174010093167703:  97%|█████████▋| 161/166 [01:01<00:01,  2.62it/s]avg_loss = 1.8179012345679013:  97%|█████████▋| 161/166 [01:01<00:01,  2.62it/s]avg_loss = 1.8179012345679013:  98%|█████████▊| 162/166 [01:01<00:01,  2.62it/s]avg_loss = 1.8178680981595092:  98%|█████████▊| 162/166 [01:01<00:01,  2.62it/s]avg_loss = 1.8178680981595092:  98%|█████████▊| 163/166 [01:01<00:01,  2.62it/s]avg_loss = 1.8186451981707317:  98%|█████████▊| 163/166 [01:02<00:01,  2.62it/s]avg_loss = 1.8186451981707317:  99%|█████████▉| 164/166 [01:02<00:00,  2.62it/s]avg_loss = 1.8188920454545454:  99%|█████████▉| 164/166 [01:02<00:00,  2.62it/s]avg_loss = 1.8188920454545454:  99%|█████████▉| 165/166 [01:02<00:00,  2.62it/s]avg_loss = 1.8208301957831325:  99%|█████████▉| 165/166 [01:03<00:00,  2.62it/s]avg_loss = 1.8208301957831325: 100%|██████████| 166/166 [01:03<00:00,  2.62it/s]avg_loss = 1.8208301957831325: 100%|██████████| 166/166 [01:03<00:00,  2.63it/s]
I0303 01:54:27.235717 2846886 eval_ppl.py:105] wikitext2 perplexity: 6.176984786987305
wikitext2 perplexity: 6.177
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Llama-2-7b-hf/block_seq_ql_random_col_16/lmbda50_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_3.84823_bpp_4.61283_MSE_0.01614_total_iter_95000.pth.tar/COL_MSE0.13775_bpploss2.6436_bpp0
I0303 01:54:31.199229 2848491 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.13it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.27it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.41it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.35it/s]
I0303 01:54:33.549905 2848491 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/166 [00:00<?, ?it/s]avg_loss = 1.578125:   0%|          | 0/166 [00:00<?, ?it/s]avg_loss = 1.578125:   1%|          | 1/166 [00:00<01:23,  1.97it/s]avg_loss = 1.8359375:   1%|          | 1/166 [00:00<01:23,  1.97it/s]avg_loss = 1.8359375:   1%|          | 2/166 [00:00<01:10,  2.32it/s]avg_loss = 2.0052083333333335:   1%|          | 2/166 [00:01<01:10,  2.32it/s]avg_loss = 2.0052083333333335:   2%|▏         | 3/166 [00:01<01:06,  2.47it/s]avg_loss = 2.0546875:   2%|▏         | 3/166 [00:01<01:06,  2.47it/s]         avg_loss = 2.0546875:   2%|▏         | 4/166 [00:01<01:04,  2.53it/s]avg_loss = 1.9765625:   2%|▏         | 4/166 [00:02<01:04,  2.53it/s]avg_loss = 1.9765625:   3%|▎         | 5/166 [00:02<01:02,  2.57it/s]avg_loss = 1.95703125:   3%|▎         | 5/166 [00:02<01:02,  2.57it/s]avg_loss = 1.95703125:   4%|▎         | 6/166 [00:02<01:01,  2.60it/s]avg_loss = 1.8995535714285714:   4%|▎         | 6/166 [00:02<01:01,  2.60it/s]avg_loss = 1.8995535714285714:   4%|▍         | 7/166 [00:02<01:00,  2.62it/s]avg_loss = 1.8466796875:   4%|▍         | 7/166 [00:03<01:00,  2.62it/s]      avg_loss = 1.8466796875:   5%|▍         | 8/166 [00:03<00:59,  2.64it/s]avg_loss = 1.8472222222222223:   5%|▍         | 8/166 [00:03<00:59,  2.64it/s]avg_loss = 1.8472222222222223:   5%|▌         | 9/166 [00:03<00:59,  2.65it/s]avg_loss = 1.85859375:   5%|▌         | 9/166 [00:03<00:59,  2.65it/s]        avg_loss = 1.85859375:   6%|▌         | 10/166 [00:03<00:58,  2.65it/s]avg_loss = 1.8757102272727273:   6%|▌         | 10/166 [00:04<00:58,  2.65it/s]avg_loss = 1.8757102272727273:   7%|▋         | 11/166 [00:04<00:58,  2.65it/s]avg_loss = 1.8782552083333333:   7%|▋         | 11/166 [00:04<00:58,  2.65it/s]avg_loss = 1.8782552083333333:   7%|▋         | 12/166 [00:04<00:57,  2.66it/s]avg_loss = 1.8695913461538463:   7%|▋         | 12/166 [00:05<00:57,  2.66it/s]avg_loss = 1.8695913461538463:   8%|▊         | 13/166 [00:05<00:57,  2.66it/s]avg_loss = 1.8766741071428572:   8%|▊         | 13/166 [00:05<00:57,  2.66it/s]avg_loss = 1.8766741071428572:   8%|▊         | 14/166 [00:05<00:57,  2.66it/s]avg_loss = 1.8921875:   8%|▊         | 14/166 [00:05<00:57,  2.66it/s]         avg_loss = 1.8921875:   9%|▉         | 15/166 [00:05<00:56,  2.66it/s]avg_loss = 1.91064453125:   9%|▉         | 15/166 [00:06<00:56,  2.66it/s]avg_loss = 1.91064453125:  10%|▉         | 16/166 [00:06<00:56,  2.66it/s]avg_loss = 1.9214154411764706:  10%|▉         | 16/166 [00:06<00:56,  2.66it/s]avg_loss = 1.9214154411764706:  10%|█         | 17/166 [00:06<00:56,  2.66it/s]avg_loss = 1.9361979166666667:  10%|█         | 17/166 [00:06<00:56,  2.66it/s]avg_loss = 1.9361979166666667:  11%|█         | 18/166 [00:06<00:55,  2.66it/s]avg_loss = 1.9551809210526316:  11%|█         | 18/166 [00:07<00:55,  2.66it/s]avg_loss = 1.9551809210526316:  11%|█▏        | 19/166 [00:07<00:55,  2.66it/s]avg_loss = 1.961328125:  11%|█▏        | 19/166 [00:07<00:55,  2.66it/s]       avg_loss = 1.961328125:  12%|█▏        | 20/166 [00:07<00:54,  2.66it/s]avg_loss = 1.9639136904761905:  12%|█▏        | 20/166 [00:08<00:54,  2.66it/s]avg_loss = 1.9639136904761905:  13%|█▎        | 21/166 [00:08<00:54,  2.65it/s]avg_loss = 1.9545454545454546:  13%|█▎        | 21/166 [00:08<00:54,  2.65it/s]avg_loss = 1.9545454545454546:  13%|█▎        | 22/166 [00:08<00:54,  2.66it/s]avg_loss = 1.9453125:  13%|█▎        | 22/166 [00:08<00:54,  2.66it/s]         avg_loss = 1.9453125:  14%|█▍        | 23/166 [00:08<00:53,  2.65it/s]avg_loss = 1.9541015625:  14%|█▍        | 23/166 [00:09<00:53,  2.65it/s]avg_loss = 1.9541015625:  14%|█▍        | 24/166 [00:09<00:53,  2.65it/s]avg_loss = 1.9640625:  14%|█▍        | 24/166 [00:09<00:53,  2.65it/s]   avg_loss = 1.9640625:  15%|█▌        | 25/166 [00:09<00:53,  2.66it/s]avg_loss = 1.9696514423076923:  15%|█▌        | 25/166 [00:09<00:53,  2.66it/s]avg_loss = 1.9696514423076923:  16%|█▌        | 26/166 [00:09<00:52,  2.65it/s]avg_loss = 1.9759837962962963:  16%|█▌        | 26/166 [00:10<00:52,  2.65it/s]avg_loss = 1.9759837962962963:  16%|█▋        | 27/166 [00:10<00:52,  2.65it/s]avg_loss = 1.978515625:  16%|█▋        | 27/166 [00:10<00:52,  2.65it/s]       avg_loss = 1.978515625:  17%|█▋        | 28/166 [00:10<00:52,  2.65it/s]avg_loss = 1.988415948275862:  17%|█▋        | 28/166 [00:11<00:52,  2.65it/s]avg_loss = 1.988415948275862:  17%|█▋        | 29/166 [00:11<00:51,  2.65it/s]avg_loss = 1.9893229166666666:  17%|█▋        | 29/166 [00:11<00:51,  2.65it/s]avg_loss = 1.9893229166666666:  18%|█▊        | 30/166 [00:11<00:51,  2.65it/s]avg_loss = 2.0032762096774195:  18%|█▊        | 30/166 [00:11<00:51,  2.65it/s]avg_loss = 2.0032762096774195:  19%|█▊        | 31/166 [00:11<00:50,  2.65it/s]avg_loss = 2.010009765625:  19%|█▊        | 31/166 [00:12<00:50,  2.65it/s]    avg_loss = 2.010009765625:  19%|█▉        | 32/166 [00:12<00:50,  2.65it/s]avg_loss = 2.014914772727273:  19%|█▉        | 32/166 [00:12<00:50,  2.65it/s]avg_loss = 2.014914772727273:  20%|█▉        | 33/166 [00:12<00:50,  2.65it/s]avg_loss = 2.0158547794117645:  20%|█▉        | 33/166 [00:12<00:50,  2.65it/s]avg_loss = 2.0158547794117645:  20%|██        | 34/166 [00:12<00:49,  2.65it/s]avg_loss = 2.0089285714285716:  20%|██        | 34/166 [00:13<00:49,  2.65it/s]avg_loss = 2.0089285714285716:  21%|██        | 35/166 [00:13<00:49,  2.64it/s]avg_loss = 2.0026041666666665:  21%|██        | 35/166 [00:13<00:49,  2.64it/s]avg_loss = 2.0026041666666665:  22%|██▏       | 36/166 [00:13<00:49,  2.64it/s]avg_loss = 1.9951435810810811:  22%|██▏       | 36/166 [00:14<00:49,  2.64it/s]avg_loss = 1.9951435810810811:  22%|██▏       | 37/166 [00:14<00:48,  2.64it/s]avg_loss = 1.9928042763157894:  22%|██▏       | 37/166 [00:14<00:48,  2.64it/s]avg_loss = 1.9928042763157894:  23%|██▎       | 38/166 [00:14<00:48,  2.64it/s]avg_loss = 1.9903846153846154:  23%|██▎       | 38/166 [00:14<00:48,  2.64it/s]avg_loss = 1.9903846153846154:  23%|██▎       | 39/166 [00:14<00:48,  2.64it/s]avg_loss = 1.99296875:  23%|██▎       | 39/166 [00:15<00:48,  2.64it/s]        avg_loss = 1.99296875:  24%|██▍       | 40/166 [00:15<00:47,  2.64it/s]avg_loss = 1.993140243902439:  24%|██▍       | 40/166 [00:15<00:47,  2.64it/s]avg_loss = 1.993140243902439:  25%|██▍       | 41/166 [00:15<00:47,  2.64it/s]avg_loss = 1.9795386904761905:  25%|██▍       | 41/166 [00:15<00:47,  2.64it/s]avg_loss = 1.9795386904761905:  25%|██▌       | 42/166 [00:15<00:46,  2.64it/s]avg_loss = 1.9636627906976745:  25%|██▌       | 42/166 [00:16<00:46,  2.64it/s]avg_loss = 1.9636627906976745:  26%|██▌       | 43/166 [00:16<00:46,  2.64it/s]avg_loss = 1.9533025568181819:  26%|██▌       | 43/166 [00:16<00:46,  2.64it/s]avg_loss = 1.9533025568181819:  27%|██▋       | 44/166 [00:16<00:46,  2.64it/s]avg_loss = 1.9387152777777779:  27%|██▋       | 44/166 [00:17<00:46,  2.64it/s]avg_loss = 1.9387152777777779:  27%|██▋       | 45/166 [00:17<00:45,  2.64it/s]avg_loss = 1.9288383152173914:  27%|██▋       | 45/166 [00:17<00:45,  2.64it/s]avg_loss = 1.9288383152173914:  28%|██▊       | 46/166 [00:17<00:45,  2.64it/s]avg_loss = 1.9212101063829787:  28%|██▊       | 46/166 [00:17<00:45,  2.64it/s]avg_loss = 1.9212101063829787:  28%|██▊       | 47/166 [00:17<00:45,  2.64it/s]avg_loss = 1.9228515625:  28%|██▊       | 47/166 [00:18<00:45,  2.64it/s]      avg_loss = 1.9228515625:  29%|██▉       | 48/166 [00:18<00:44,  2.64it/s]avg_loss = 1.9333545918367347:  29%|██▉       | 48/166 [00:18<00:44,  2.64it/s]avg_loss = 1.9333545918367347:  30%|██▉       | 49/166 [00:18<00:44,  2.64it/s]avg_loss = 1.943125:  30%|██▉       | 49/166 [00:18<00:44,  2.64it/s]          avg_loss = 1.943125:  30%|███       | 50/166 [00:18<00:43,  2.64it/s]avg_loss = 1.9506740196078431:  30%|███       | 50/166 [00:19<00:43,  2.64it/s]avg_loss = 1.9506740196078431:  31%|███       | 51/166 [00:19<00:43,  2.64it/s]avg_loss = 1.9567307692307692:  31%|███       | 51/166 [00:19<00:43,  2.64it/s]avg_loss = 1.9567307692307692:  31%|███▏      | 52/166 [00:19<00:43,  2.64it/s]avg_loss = 1.959316037735849:  31%|███▏      | 52/166 [00:20<00:43,  2.64it/s] avg_loss = 1.959316037735849:  32%|███▏      | 53/166 [00:20<00:42,  2.63it/s]avg_loss = 1.958912037037037:  32%|███▏      | 53/166 [00:20<00:42,  2.63it/s]avg_loss = 1.958912037037037:  33%|███▎      | 54/166 [00:20<00:42,  2.64it/s]avg_loss = 1.9610795454545455:  33%|███▎      | 54/166 [00:20<00:42,  2.64it/s]avg_loss = 1.9610795454545455:  33%|███▎      | 55/166 [00:20<00:42,  2.63it/s]avg_loss = 1.9640066964285714:  33%|███▎      | 55/166 [00:21<00:42,  2.63it/s]avg_loss = 1.9640066964285714:  34%|███▎      | 56/166 [00:21<00:41,  2.64it/s]avg_loss = 1.9590186403508771:  34%|███▎      | 56/166 [00:21<00:41,  2.64it/s]avg_loss = 1.9590186403508771:  34%|███▍      | 57/166 [00:21<00:41,  2.63it/s]avg_loss = 1.9624191810344827:  34%|███▍      | 57/166 [00:22<00:41,  2.63it/s]avg_loss = 1.9624191810344827:  35%|███▍      | 58/166 [00:22<00:41,  2.63it/s]avg_loss = 1.9601430084745763:  35%|███▍      | 58/166 [00:22<00:41,  2.63it/s]avg_loss = 1.9601430084745763:  36%|███▌      | 59/166 [00:22<00:40,  2.63it/s]avg_loss = 1.955859375:  36%|███▌      | 59/166 [00:22<00:40,  2.63it/s]       avg_loss = 1.955859375:  36%|███▌      | 60/166 [00:22<00:40,  2.63it/s]avg_loss = 1.9508196721311475:  36%|███▌      | 60/166 [00:23<00:40,  2.63it/s]avg_loss = 1.9508196721311475:  37%|███▋      | 61/166 [00:23<00:39,  2.63it/s]avg_loss = 1.9464465725806452:  37%|███▋      | 61/166 [00:23<00:39,  2.63it/s]avg_loss = 1.9464465725806452:  37%|███▋      | 62/166 [00:23<00:39,  2.63it/s]avg_loss = 1.9404761904761905:  37%|███▋      | 62/166 [00:23<00:39,  2.63it/s]avg_loss = 1.9404761904761905:  38%|███▊      | 63/166 [00:23<00:39,  2.63it/s]avg_loss = 1.9361572265625:  38%|███▊      | 63/166 [00:24<00:39,  2.63it/s]   avg_loss = 1.9361572265625:  39%|███▊      | 64/166 [00:24<00:38,  2.63it/s]avg_loss = 1.9289663461538462:  39%|███▊      | 64/166 [00:24<00:38,  2.63it/s]avg_loss = 1.9289663461538462:  39%|███▉      | 65/166 [00:24<00:38,  2.63it/s]avg_loss = 1.9211647727272727:  39%|███▉      | 65/166 [00:25<00:38,  2.63it/s]avg_loss = 1.9211647727272727:  40%|███▉      | 66/166 [00:25<00:38,  2.63it/s]avg_loss = 1.9172108208955223:  40%|███▉      | 66/166 [00:25<00:38,  2.63it/s]avg_loss = 1.9172108208955223:  40%|████      | 67/166 [00:25<00:37,  2.63it/s]avg_loss = 1.9161305147058822:  40%|████      | 67/166 [00:25<00:37,  2.63it/s]avg_loss = 1.9161305147058822:  41%|████      | 68/166 [00:25<00:37,  2.63it/s]avg_loss = 1.9182518115942029:  41%|████      | 68/166 [00:26<00:37,  2.63it/s]avg_loss = 1.9182518115942029:  42%|████▏     | 69/166 [00:26<00:36,  2.63it/s]avg_loss = 1.9216517857142856:  42%|████▏     | 69/166 [00:26<00:36,  2.63it/s]avg_loss = 1.9216517857142856:  42%|████▏     | 70/166 [00:26<00:36,  2.63it/s]avg_loss = 1.9256161971830985:  42%|████▏     | 70/166 [00:26<00:36,  2.63it/s]avg_loss = 1.9256161971830985:  43%|████▎     | 71/166 [00:26<00:36,  2.63it/s]avg_loss = 1.9301215277777777:  43%|████▎     | 71/166 [00:27<00:36,  2.63it/s]avg_loss = 1.9301215277777777:  43%|████▎     | 72/166 [00:27<00:35,  2.63it/s]avg_loss = 1.936429794520548:  43%|████▎     | 72/166 [00:27<00:35,  2.63it/s] avg_loss = 1.936429794520548:  44%|████▍     | 73/166 [00:27<00:35,  2.62it/s]avg_loss = 1.9310599662162162:  44%|████▍     | 73/166 [00:28<00:35,  2.62it/s]avg_loss = 1.9310599662162162:  45%|████▍     | 74/166 [00:28<00:35,  2.63it/s]avg_loss = 1.9271875:  45%|████▍     | 74/166 [00:28<00:35,  2.63it/s]         avg_loss = 1.9271875:  45%|████▌     | 75/166 [00:28<00:34,  2.63it/s]avg_loss = 1.9271175986842106:  45%|████▌     | 75/166 [00:28<00:34,  2.63it/s]avg_loss = 1.9271175986842106:  46%|████▌     | 76/166 [00:28<00:34,  2.62it/s]avg_loss = 1.924208603896104:  46%|████▌     | 76/166 [00:29<00:34,  2.62it/s] avg_loss = 1.924208603896104:  46%|████▋     | 77/166 [00:29<00:33,  2.63it/s]avg_loss = 1.9210737179487178:  46%|████▋     | 77/166 [00:29<00:33,  2.63it/s]avg_loss = 1.9210737179487178:  47%|████▋     | 78/166 [00:29<00:33,  2.62it/s]avg_loss = 1.9181170886075949:  47%|████▋     | 78/166 [00:30<00:33,  2.62it/s]avg_loss = 1.9181170886075949:  48%|████▊     | 79/166 [00:30<00:33,  2.63it/s]avg_loss = 1.91455078125:  48%|████▊     | 79/166 [00:30<00:33,  2.63it/s]     avg_loss = 1.91455078125:  48%|████▊     | 80/166 [00:30<00:32,  2.63it/s]avg_loss = 1.9065393518518519:  48%|████▊     | 80/166 [00:30<00:32,  2.63it/s]avg_loss = 1.9065393518518519:  49%|████▉     | 81/166 [00:30<00:32,  2.63it/s]avg_loss = 1.908060213414634:  49%|████▉     | 81/166 [00:31<00:32,  2.63it/s] avg_loss = 1.908060213414634:  49%|████▉     | 82/166 [00:31<00:31,  2.64it/s]avg_loss = 1.9097326807228916:  49%|████▉     | 82/166 [00:31<00:31,  2.64it/s]avg_loss = 1.9097326807228916:  50%|█████     | 83/166 [00:31<00:31,  2.63it/s]avg_loss = 1.9130394345238095:  50%|█████     | 83/166 [00:31<00:31,  2.63it/s]avg_loss = 1.9130394345238095:  51%|█████     | 84/166 [00:31<00:31,  2.64it/s]avg_loss = 1.9146139705882352:  51%|█████     | 84/166 [00:32<00:31,  2.64it/s]avg_loss = 1.9146139705882352:  51%|█████     | 85/166 [00:32<00:30,  2.64it/s]avg_loss = 1.9129723837209303:  51%|█████     | 85/166 [00:32<00:30,  2.64it/s]avg_loss = 1.9129723837209303:  52%|█████▏    | 86/166 [00:32<00:30,  2.63it/s]avg_loss = 1.9128951149425288:  52%|█████▏    | 86/166 [00:33<00:30,  2.63it/s]avg_loss = 1.9128951149425288:  52%|█████▏    | 87/166 [00:33<00:29,  2.64it/s]avg_loss = 1.9126420454545454:  52%|█████▏    | 87/166 [00:33<00:29,  2.64it/s]avg_loss = 1.9126420454545454:  53%|█████▎    | 88/166 [00:33<00:29,  2.64it/s]avg_loss = 1.9134480337078652:  53%|█████▎    | 88/166 [00:33<00:29,  2.64it/s]avg_loss = 1.9134480337078652:  54%|█████▎    | 89/166 [00:33<00:29,  2.64it/s]avg_loss = 1.9133680555555554:  54%|█████▎    | 89/166 [00:34<00:29,  2.64it/s]avg_loss = 1.9133680555555554:  54%|█████▍    | 90/166 [00:34<00:28,  2.64it/s]avg_loss = 1.9131181318681318:  54%|█████▍    | 90/166 [00:34<00:28,  2.64it/s]avg_loss = 1.9131181318681318:  55%|█████▍    | 91/166 [00:34<00:28,  2.64it/s]avg_loss = 1.9138926630434783:  55%|█████▍    | 91/166 [00:34<00:28,  2.64it/s]avg_loss = 1.9138926630434783:  55%|█████▌    | 92/166 [00:34<00:28,  2.63it/s]avg_loss = 1.918010752688172:  55%|█████▌    | 92/166 [00:35<00:28,  2.63it/s] avg_loss = 1.918010752688172:  56%|█████▌    | 93/166 [00:35<00:27,  2.64it/s]avg_loss = 1.9163065159574468:  56%|█████▌    | 93/166 [00:35<00:27,  2.64it/s]avg_loss = 1.9163065159574468:  57%|█████▋    | 94/166 [00:35<00:27,  2.63it/s]avg_loss = 1.9150493421052632:  57%|█████▋    | 94/166 [00:36<00:27,  2.63it/s]avg_loss = 1.9150493421052632:  57%|█████▋    | 95/166 [00:36<00:26,  2.63it/s]avg_loss = 1.9140625:  57%|█████▋    | 95/166 [00:36<00:26,  2.63it/s]         avg_loss = 1.9140625:  58%|█████▊    | 96/166 [00:36<00:26,  2.64it/s]avg_loss = 1.913659793814433:  58%|█████▊    | 96/166 [00:36<00:26,  2.64it/s]avg_loss = 1.913659793814433:  58%|█████▊    | 97/166 [00:36<00:26,  2.63it/s]avg_loss = 1.9119897959183674:  58%|█████▊    | 97/166 [00:37<00:26,  2.63it/s]avg_loss = 1.9119897959183674:  59%|█████▉    | 98/166 [00:37<00:25,  2.63it/s]avg_loss = 1.9093276515151516:  59%|█████▉    | 98/166 [00:37<00:25,  2.63it/s]avg_loss = 1.9093276515151516:  60%|█████▉    | 99/166 [00:37<00:25,  2.63it/s]avg_loss = 1.907265625:  60%|█████▉    | 99/166 [00:37<00:25,  2.63it/s]       avg_loss = 1.907265625:  60%|██████    | 100/166 [00:37<00:25,  2.63it/s]avg_loss = 1.9077196782178218:  60%|██████    | 100/166 [00:38<00:25,  2.63it/s]avg_loss = 1.9077196782178218:  61%|██████    | 101/166 [00:38<00:24,  2.63it/s]avg_loss = 1.908624387254902:  61%|██████    | 101/166 [00:38<00:24,  2.63it/s] avg_loss = 1.908624387254902:  61%|██████▏   | 102/166 [00:38<00:24,  2.63it/s]avg_loss = 1.9099666262135921:  61%|██████▏   | 102/166 [00:39<00:24,  2.63it/s]avg_loss = 1.9099666262135921:  62%|██████▏   | 103/166 [00:39<00:23,  2.63it/s]avg_loss = 1.9123347355769231:  62%|██████▏   | 103/166 [00:39<00:23,  2.63it/s]avg_loss = 1.9123347355769231:  63%|██████▎   | 104/166 [00:39<00:23,  2.63it/s]avg_loss = 1.9189732142857143:  63%|██████▎   | 104/166 [00:39<00:23,  2.63it/s]avg_loss = 1.9189732142857143:  63%|██████▎   | 105/166 [00:39<00:23,  2.63it/s]avg_loss = 1.9243071933962264:  63%|██████▎   | 105/166 [00:40<00:23,  2.63it/s]avg_loss = 1.9243071933962264:  64%|██████▍   | 106/166 [00:40<00:22,  2.63it/s]avg_loss = 1.928081191588785:  64%|██████▍   | 106/166 [00:40<00:22,  2.63it/s] avg_loss = 1.928081191588785:  64%|██████▍   | 107/166 [00:40<00:22,  2.63it/s]avg_loss = 1.9310619212962963:  64%|██████▍   | 107/166 [00:41<00:22,  2.63it/s]avg_loss = 1.9310619212962963:  65%|██████▌   | 108/166 [00:41<00:22,  2.63it/s]avg_loss = 1.935851490825688:  65%|██████▌   | 108/166 [00:41<00:22,  2.63it/s] avg_loss = 1.935851490825688:  66%|██████▌   | 109/166 [00:41<00:21,  2.63it/s]avg_loss = 1.9391335227272728:  66%|██████▌   | 109/166 [00:41<00:21,  2.63it/s]avg_loss = 1.9391335227272728:  66%|██████▋   | 110/166 [00:41<00:21,  2.63it/s]avg_loss = 1.9401041666666667:  66%|██████▋   | 110/166 [00:42<00:21,  2.63it/s]avg_loss = 1.9401041666666667:  67%|██████▋   | 111/166 [00:42<00:20,  2.63it/s]avg_loss = 1.9411969866071428:  67%|██████▋   | 111/166 [00:42<00:20,  2.63it/s]avg_loss = 1.9411969866071428:  67%|██████▋   | 112/166 [00:42<00:20,  2.63it/s]avg_loss = 1.9409568584070795:  67%|██████▋   | 112/166 [00:42<00:20,  2.63it/s]avg_loss = 1.9409568584070795:  68%|██████▊   | 113/166 [00:42<00:20,  2.63it/s]avg_loss = 1.9418859649122806:  68%|██████▊   | 113/166 [00:43<00:20,  2.63it/s]avg_loss = 1.9418859649122806:  69%|██████▊   | 114/166 [00:43<00:19,  2.62it/s]avg_loss = 1.9400135869565218:  69%|██████▊   | 114/166 [00:43<00:19,  2.62it/s]avg_loss = 1.9400135869565218:  69%|██████▉   | 115/166 [00:43<00:19,  2.63it/s]avg_loss = 1.9397898706896552:  69%|██████▉   | 115/166 [00:44<00:19,  2.63it/s]avg_loss = 1.9397898706896552:  70%|██████▉   | 116/166 [00:44<00:19,  2.62it/s]avg_loss = 1.9411057692307692:  70%|██████▉   | 116/166 [00:44<00:19,  2.62it/s]avg_loss = 1.9411057692307692:  70%|███████   | 117/166 [00:44<00:18,  2.62it/s]avg_loss = 1.9418697033898304:  70%|███████   | 117/166 [00:44<00:18,  2.62it/s]avg_loss = 1.9418697033898304:  71%|███████   | 118/166 [00:44<00:18,  2.63it/s]avg_loss = 1.9423581932773109:  71%|███████   | 118/166 [00:45<00:18,  2.63it/s]avg_loss = 1.9423581932773109:  72%|███████▏  | 119/166 [00:45<00:17,  2.63it/s]avg_loss = 1.943359375:  72%|███████▏  | 119/166 [00:45<00:17,  2.63it/s]       avg_loss = 1.943359375:  72%|███████▏  | 120/166 [00:45<00:17,  2.62it/s]avg_loss = 1.943440082644628:  72%|███████▏  | 120/166 [00:45<00:17,  2.62it/s]avg_loss = 1.943440082644628:  73%|███████▎  | 121/166 [00:45<00:17,  2.63it/s]avg_loss = 1.9445440573770492:  73%|███████▎  | 121/166 [00:46<00:17,  2.63it/s]avg_loss = 1.9445440573770492:  73%|███████▎  | 122/166 [00:46<00:16,  2.62it/s]avg_loss = 1.9448043699186992:  73%|███████▎  | 122/166 [00:46<00:16,  2.62it/s]avg_loss = 1.9448043699186992:  74%|███████▍  | 123/166 [00:46<00:16,  2.62it/s]avg_loss = 1.943422379032258:  74%|███████▍  | 123/166 [00:47<00:16,  2.62it/s] avg_loss = 1.943422379032258:  75%|███████▍  | 124/166 [00:47<00:16,  2.62it/s]avg_loss = 1.941875:  75%|███████▍  | 124/166 [00:47<00:16,  2.62it/s]         avg_loss = 1.941875:  75%|███████▌  | 125/166 [00:47<00:15,  2.62it/s]avg_loss = 1.9399801587301588:  75%|███████▌  | 125/166 [00:47<00:15,  2.62it/s]avg_loss = 1.9399801587301588:  76%|███████▌  | 126/166 [00:47<00:15,  2.62it/s]avg_loss = 1.937992125984252:  76%|███████▌  | 126/166 [00:48<00:15,  2.62it/s] avg_loss = 1.937992125984252:  77%|███████▋  | 127/166 [00:48<00:14,  2.62it/s]avg_loss = 1.93670654296875:  77%|███████▋  | 127/166 [00:48<00:14,  2.62it/s] avg_loss = 1.93670654296875:  77%|███████▋  | 128/166 [00:48<00:14,  2.62it/s]avg_loss = 1.9356831395348837:  77%|███████▋  | 128/166 [00:49<00:14,  2.62it/s]avg_loss = 1.9356831395348837:  78%|███████▊  | 129/166 [00:49<00:14,  2.62it/s]avg_loss = 1.935576923076923:  78%|███████▊  | 129/166 [00:49<00:14,  2.62it/s] avg_loss = 1.935576923076923:  78%|███████▊  | 130/166 [00:49<00:13,  2.62it/s]avg_loss = 1.9365458015267176:  78%|███████▊  | 130/166 [00:49<00:13,  2.62it/s]avg_loss = 1.9365458015267176:  79%|███████▉  | 131/166 [00:49<00:13,  2.62it/s]avg_loss = 1.9370265151515151:  79%|███████▉  | 131/166 [00:50<00:13,  2.62it/s]avg_loss = 1.9370265151515151:  80%|███████▉  | 132/166 [00:50<00:12,  2.62it/s]avg_loss = 1.9378524436090225:  80%|███████▉  | 132/166 [00:50<00:12,  2.62it/s]avg_loss = 1.9378524436090225:  80%|████████  | 133/166 [00:50<00:12,  2.62it/s]avg_loss = 1.9390158582089552:  80%|████████  | 133/166 [00:50<00:12,  2.62it/s]avg_loss = 1.9390158582089552:  81%|████████  | 134/166 [00:50<00:12,  2.62it/s]avg_loss = 1.9367476851851853:  81%|████████  | 134/166 [00:51<00:12,  2.62it/s]avg_loss = 1.9367476851851853:  81%|████████▏ | 135/166 [00:51<00:11,  2.62it/s]avg_loss = 1.9367532169117647:  81%|████████▏ | 135/166 [00:51<00:11,  2.62it/s]avg_loss = 1.9367532169117647:  82%|████████▏ | 136/166 [00:51<00:11,  2.62it/s]avg_loss = 1.9369867700729928:  82%|████████▏ | 136/166 [00:52<00:11,  2.62it/s]avg_loss = 1.9369867700729928:  83%|████████▎ | 137/166 [00:52<00:11,  2.62it/s]avg_loss = 1.9376698369565217:  83%|████████▎ | 137/166 [00:52<00:11,  2.62it/s]avg_loss = 1.9376698369565217:  83%|████████▎ | 138/166 [00:52<00:10,  2.62it/s]avg_loss = 1.9365445143884892:  83%|████████▎ | 138/166 [00:52<00:10,  2.62it/s]avg_loss = 1.9365445143884892:  84%|████████▎ | 139/166 [00:52<00:10,  2.62it/s]avg_loss = 1.9348772321428571:  84%|████████▎ | 139/166 [00:53<00:10,  2.62it/s]avg_loss = 1.9348772321428571:  84%|████████▍ | 140/166 [00:53<00:09,  2.62it/s]avg_loss = 1.9330673758865249:  84%|████████▍ | 140/166 [00:53<00:09,  2.62it/s]avg_loss = 1.9330673758865249:  85%|████████▍ | 141/166 [00:53<00:09,  2.62it/s]avg_loss = 1.9327134683098592:  85%|████████▍ | 141/166 [00:53<00:09,  2.62it/s]avg_loss = 1.9327134683098592:  86%|████████▌ | 142/166 [00:53<00:09,  2.62it/s]avg_loss = 1.9308347902097902:  86%|████████▌ | 142/166 [00:54<00:09,  2.62it/s]avg_loss = 1.9308347902097902:  86%|████████▌ | 143/166 [00:54<00:08,  2.62it/s]avg_loss = 1.9320746527777777:  86%|████████▌ | 143/166 [00:54<00:08,  2.62it/s]avg_loss = 1.9320746527777777:  87%|████████▋ | 144/166 [00:54<00:08,  2.62it/s]avg_loss = 1.9308189655172414:  87%|████████▋ | 144/166 [00:55<00:08,  2.62it/s]avg_loss = 1.9308189655172414:  87%|████████▋ | 145/166 [00:55<00:08,  2.62it/s]avg_loss = 1.9304901541095891:  87%|████████▋ | 145/166 [00:55<00:08,  2.62it/s]avg_loss = 1.9304901541095891:  88%|████████▊ | 146/166 [00:55<00:07,  2.62it/s]avg_loss = 1.9291560374149659:  88%|████████▊ | 146/166 [00:55<00:07,  2.62it/s]avg_loss = 1.9291560374149659:  89%|████████▊ | 147/166 [00:55<00:07,  2.62it/s]avg_loss = 1.9279455236486487:  89%|████████▊ | 147/166 [00:56<00:07,  2.62it/s]avg_loss = 1.9279455236486487:  89%|████████▉ | 148/166 [00:56<00:06,  2.62it/s]avg_loss = 1.925912332214765:  89%|████████▉ | 148/166 [00:56<00:06,  2.62it/s] avg_loss = 1.925912332214765:  90%|████████▉ | 149/166 [00:56<00:06,  2.62it/s]avg_loss = 1.92671875:  90%|████████▉ | 149/166 [00:57<00:06,  2.62it/s]       avg_loss = 1.92671875:  90%|█████████ | 150/166 [00:57<00:06,  2.62it/s]avg_loss = 1.9259105960264902:  90%|█████████ | 150/166 [00:57<00:06,  2.62it/s]avg_loss = 1.9259105960264902:  91%|█████████ | 151/166 [00:57<00:05,  2.62it/s]avg_loss = 1.9256784539473684:  91%|█████████ | 151/166 [00:57<00:05,  2.62it/s]avg_loss = 1.9256784539473684:  92%|█████████▏| 152/166 [00:57<00:05,  2.62it/s]avg_loss = 1.9256535947712419:  92%|█████████▏| 152/166 [00:58<00:05,  2.62it/s]avg_loss = 1.9256535947712419:  92%|█████████▏| 153/166 [00:58<00:04,  2.62it/s]avg_loss = 1.9275568181818181:  92%|█████████▏| 153/166 [00:58<00:04,  2.62it/s]avg_loss = 1.9275568181818181:  93%|█████████▎| 154/166 [00:58<00:04,  2.62it/s]avg_loss = 1.9269657258064516:  93%|█████████▎| 154/166 [00:58<00:04,  2.62it/s]avg_loss = 1.9269657258064516:  93%|█████████▎| 155/166 [00:58<00:04,  2.62it/s]avg_loss = 1.9266826923076923:  93%|█████████▎| 155/166 [00:59<00:04,  2.62it/s]avg_loss = 1.9266826923076923:  94%|█████████▍| 156/166 [00:59<00:03,  2.62it/s]avg_loss = 1.9246616242038217:  94%|█████████▍| 156/166 [00:59<00:03,  2.62it/s]avg_loss = 1.9246616242038217:  95%|█████████▍| 157/166 [00:59<00:03,  2.62it/s]avg_loss = 1.9198477056962024:  95%|█████████▍| 157/166 [01:00<00:03,  2.62it/s]avg_loss = 1.9198477056962024:  95%|█████████▌| 158/166 [01:00<00:03,  2.62it/s]avg_loss = 1.9203518081761006:  95%|█████████▌| 158/166 [01:00<00:03,  2.62it/s]avg_loss = 1.9203518081761006:  96%|█████████▌| 159/166 [01:00<00:02,  2.62it/s]avg_loss = 1.921630859375:  96%|█████████▌| 159/166 [01:00<00:02,  2.62it/s]    avg_loss = 1.921630859375:  96%|█████████▋| 160/166 [01:00<00:02,  2.62it/s]avg_loss = 1.9239615683229814:  96%|█████████▋| 160/166 [01:01<00:02,  2.62it/s]avg_loss = 1.9239615683229814:  97%|█████████▋| 161/166 [01:01<00:01,  2.62it/s]avg_loss = 1.9248167438271604:  97%|█████████▋| 161/166 [01:01<00:01,  2.62it/s]avg_loss = 1.9248167438271604:  98%|█████████▊| 162/166 [01:01<00:01,  2.61it/s]avg_loss = 1.9249904141104295:  98%|█████████▊| 162/166 [01:02<00:01,  2.61it/s]avg_loss = 1.9249904141104295:  98%|█████████▊| 163/166 [01:02<00:01,  2.62it/s]avg_loss = 1.9262099847560976:  98%|█████████▊| 163/166 [01:02<00:01,  2.62it/s]avg_loss = 1.9262099847560976:  99%|█████████▉| 164/166 [01:02<00:00,  2.62it/s]avg_loss = 1.9266098484848484:  99%|█████████▉| 164/166 [01:02<00:00,  2.62it/s]avg_loss = 1.9266098484848484:  99%|█████████▉| 165/166 [01:02<00:00,  2.61it/s]avg_loss = 1.9285579819277108:  99%|█████████▉| 165/166 [01:03<00:00,  2.61it/s]avg_loss = 1.9285579819277108: 100%|██████████| 166/166 [01:03<00:00,  2.62it/s]avg_loss = 1.9285579819277108: 100%|██████████| 166/166 [01:03<00:00,  2.63it/s]
I0303 01:56:12.609483 2848491 eval_ppl.py:105] wikitext2 perplexity: 6.87958288192749
wikitext2 perplexity: 6.880
Running with lmbda=100
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  8.81it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  9.87it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00, 10.31it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.09it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:11,  2.66it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:11,  2.66it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:10,  2.67it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:10,  2.68it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:01<00:09,  2.73it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:09,  2.78it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:08,  2.81it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:02<00:08,  2.83it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:08,  2.83it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:03<00:07,  2.84it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.60it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:04<00:08,  2.34it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:08,  2.30it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.33it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:05<00:07,  2.33it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.38it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:06<00:06,  2.41it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.43it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:07<00:05,  2.41it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:07<00:04,  2.45it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.43it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:08<00:04,  2.47it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.50it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:09<00:03,  2.51it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:09<00:02,  2.54it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.53it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:10<00:01,  2.55it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.55it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:11<00:01,  2.47it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:12<00:00,  2.28it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.25it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.30it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.49it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 01:57:48 - INFO - layer0_self_attn.q_proj | mse: 0.05588006912911097, bpp_loss: 2.724299118213821, bpp: 0
2025-03-03 01:57:57 - INFO - layer0_self_attn.k_proj | mse: 0.0564317992983069, bpp_loss: 2.8462438066489995, bpp: 0
2025-03-03 01:58:05 - INFO - layer0_self_attn.v_proj | mse: 0.05387382659111833, bpp_loss: 2.6396073297364637, bpp: 0
2025-03-03 01:58:14 - INFO - layer0_self_attn.o_proj | mse: 0.05828358890874783, bpp_loss: 2.5127190488856286, bpp: 0
2025-03-03 01:58:24 - INFO - layer0_mlp.gate_proj | mse: 0.06035728780288331, bpp_loss: 2.987961559924622, bpp: 0
2025-03-03 01:58:34 - INFO - layer0_mlp.up_proj | mse: 0.06018722736166716, bpp_loss: 2.970634455640995, bpp: 0
2025-03-03 01:59:02 - INFO - layer0_mlp.down_proj | mse: 0.06671126589912257, bpp_loss: 3.0167045641343955, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:22<42:48, 82.86s/it]2025-03-03 01:59:11 - INFO - layer1_self_attn.q_proj | mse: 0.07351693402953158, bpp_loss: 3.3969884826801717, bpp: 0
2025-03-03 01:59:20 - INFO - layer1_self_attn.k_proj | mse: 0.0745850504485752, bpp_loss: 3.4113194959354587, bpp: 0
2025-03-03 01:59:28 - INFO - layer1_self_attn.v_proj | mse: 0.06215072935902, bpp_loss: 2.5975997634232044, bpp: 0
2025-03-03 01:59:37 - INFO - layer1_self_attn.o_proj | mse: 0.0683676900078603, bpp_loss: 2.5571081702946685, bpp: 0
2025-03-03 01:59:47 - INFO - layer1_mlp.gate_proj | mse: 0.06528845849471442, bpp_loss: 3.102681808346926, bpp: 0
2025-03-03 01:59:57 - INFO - layer1_mlp.up_proj | mse: 0.06446320829582095, bpp_loss: 3.0340680630747663, bpp: 0
2025-03-03 02:00:25 - INFO - layer1_mlp.down_proj | mse: 0.046304099190730884, bpp_loss: 3.044166609233375, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [02:45<41:27, 82.93s/it]2025-03-03 02:00:34 - INFO - layer2_self_attn.q_proj | mse: 0.06554341535359579, bpp_loss: 3.5475790913333185, bpp: 0
2025-03-03 02:00:42 - INFO - layer2_self_attn.k_proj | mse: 0.06610952644210684, bpp_loss: 3.6032033475348726, bpp: 0
2025-03-03 02:00:51 - INFO - layer2_self_attn.v_proj | mse: 0.05734364344706516, bpp_loss: 2.8463680983986706, bpp: 0
2025-03-03 02:01:00 - INFO - layer2_self_attn.o_proj | mse: 0.0585900554540077, bpp_loss: 2.831872533017304, bpp: 0
2025-03-03 02:01:10 - INFO - layer2_mlp.gate_proj | mse: 0.06020521220193877, bpp_loss: 3.1410232643315266, bpp: 0
2025-03-03 02:01:20 - INFO - layer2_mlp.up_proj | mse: 0.059225467438928286, bpp_loss: 3.0550798114042643, bpp: 0
2025-03-03 02:01:47 - INFO - layer2_mlp.down_proj | mse: 0.05140138926791426, bpp_loss: 3.0617823843995846, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:08<40:02, 82.84s/it]2025-03-03 02:01:56 - INFO - layer3_self_attn.q_proj | mse: 0.05987985357047145, bpp_loss: 3.482803067250643, bpp: 0
2025-03-03 02:02:05 - INFO - layer3_self_attn.k_proj | mse: 0.0603652356707401, bpp_loss: 3.5368762014550157, bpp: 0
2025-03-03 02:02:14 - INFO - layer3_self_attn.v_proj | mse: 0.052413809841439514, bpp_loss: 2.8005691476282664, bpp: 0
2025-03-03 02:02:23 - INFO - layer3_self_attn.o_proj | mse: 0.05040901582473163, bpp_loss: 2.78953521681251, bpp: 0
2025-03-03 02:02:33 - INFO - layer3_mlp.gate_proj | mse: 0.05584224776675423, bpp_loss: 3.1545164992296417, bpp: 0
2025-03-03 02:02:43 - INFO - layer3_mlp.up_proj | mse: 0.05483686026936463, bpp_loss: 3.0585689572400825, bpp: 0
2025-03-03 02:03:10 - INFO - layer3_mlp.down_proj | mse: 0.050443009856988616, bpp_loss: 3.0613817704711543, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [05:31<38:41, 82.91s/it]2025-03-03 02:03:19 - INFO - layer4_self_attn.q_proj | mse: 0.059445314567297985, bpp_loss: 3.567565247474704, bpp: 0
2025-03-03 02:03:28 - INFO - layer4_self_attn.k_proj | mse: 0.05960384073670245, bpp_loss: 3.595620506501291, bpp: 0
2025-03-03 02:03:37 - INFO - layer4_self_attn.v_proj | mse: 0.05179693097894009, bpp_loss: 2.846202213142533, bpp: 0
2025-03-03 02:03:46 - INFO - layer4_self_attn.o_proj | mse: 0.051413293013713196, bpp_loss: 2.842148077324964, bpp: 0
2025-03-03 02:03:56 - INFO - layer4_mlp.gate_proj | mse: 0.05527879319890635, bpp_loss: 3.177589111290006, bpp: 0
2025-03-03 02:04:06 - INFO - layer4_mlp.up_proj | mse: 0.053947376034142625, bpp_loss: 3.049171299522006, bpp: 0
2025-03-03 02:04:33 - INFO - layer4_mlp.down_proj | mse: 0.05037772803447308, bpp_loss: 3.0474858288328317, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [06:54<37:18, 82.90s/it]2025-03-03 02:04:42 - INFO - layer5_self_attn.q_proj | mse: 0.0587227284155217, bpp_loss: 3.5867080269381404, bpp: 0
2025-03-03 02:04:51 - INFO - layer5_self_attn.k_proj | mse: 0.05921805316588896, bpp_loss: 3.6433328097336926, bpp: 0
2025-03-03 02:05:00 - INFO - layer5_self_attn.v_proj | mse: 0.051301223818953655, bpp_loss: 2.865655423956923, bpp: 0
2025-03-03 02:05:08 - INFO - layer5_self_attn.o_proj | mse: 0.05324004058818315, bpp_loss: 2.851035091734957, bpp: 0
2025-03-03 02:05:19 - INFO - layer5_mlp.gate_proj | mse: 0.05515906961343963, bpp_loss: 3.1844734436897344, bpp: 0
2025-03-03 02:05:29 - INFO - layer5_mlp.up_proj | mse: 0.05372437436328013, bpp_loss: 3.049459296516901, bpp: 0
2025-03-03 02:05:56 - INFO - layer5_mlp.down_proj | mse: 0.050073719124535336, bpp_loss: 3.0494377148489273, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [08:17<35:53, 82.81s/it]2025-03-03 02:06:05 - INFO - layer6_self_attn.q_proj | mse: 0.05681772013307858, bpp_loss: 3.4667910142452456, bpp: 0
2025-03-03 02:06:14 - INFO - layer6_self_attn.k_proj | mse: 0.0570433186320527, bpp_loss: 3.4933843328617513, bpp: 0
2025-03-03 02:06:22 - INFO - layer6_self_attn.v_proj | mse: 0.05000093261430308, bpp_loss: 2.8015935696312226, bpp: 0
2025-03-03 02:06:31 - INFO - layer6_self_attn.o_proj | mse: 0.05169144386489851, bpp_loss: 2.808161480817944, bpp: 0
2025-03-03 02:06:41 - INFO - layer6_mlp.gate_proj | mse: 0.05449503188351646, bpp_loss: 3.2048047050227257, bpp: 0
2025-03-03 02:06:52 - INFO - layer6_mlp.up_proj | mse: 0.0528498264710696, bpp_loss: 3.044938286896362, bpp: 0
2025-03-03 02:07:19 - INFO - layer6_mlp.down_proj | mse: 0.05011266831230171, bpp_loss: 3.044202815069882, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [09:40<34:31, 82.87s/it]2025-03-03 02:07:28 - INFO - layer7_self_attn.q_proj | mse: 0.056394960504992805, bpp_loss: 3.459959402680397, bpp: 0
2025-03-03 02:07:37 - INFO - layer7_self_attn.k_proj | mse: 0.05648021467372881, bpp_loss: 3.47042555490043, bpp: 0
2025-03-03 02:07:45 - INFO - layer7_self_attn.v_proj | mse: 0.04979648832017164, bpp_loss: 2.810106229095254, bpp: 0
2025-03-03 02:07:54 - INFO - layer7_self_attn.o_proj | mse: 0.04978724096028971, bpp_loss: 2.812854853691533, bpp: 0
2025-03-03 02:08:04 - INFO - layer7_mlp.gate_proj | mse: 0.05404410868977759, bpp_loss: 3.202745129549226, bpp: 0
2025-03-03 02:08:14 - INFO - layer7_mlp.up_proj | mse: 0.05248620585728264, bpp_loss: 3.0481314095560204, bpp: 0
2025-03-03 02:08:42 - INFO - layer7_mlp.down_proj | mse: 0.05036074354973803, bpp_loss: 3.0453644243047333, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [11:03<33:09, 82.89s/it]2025-03-03 02:08:51 - INFO - layer8_self_attn.q_proj | mse: 0.05669932959143233, bpp_loss: 3.4765989828156307, bpp: 0
2025-03-03 02:08:59 - INFO - layer8_self_attn.k_proj | mse: 0.05677905620294568, bpp_loss: 3.4937878122436814, bpp: 0
2025-03-03 02:09:08 - INFO - layer8_self_attn.v_proj | mse: 0.050158236231743196, bpp_loss: 2.8351861722767353, bpp: 0
2025-03-03 02:09:17 - INFO - layer8_self_attn.o_proj | mse: 0.05172811462974357, bpp_loss: 2.837345571781043, bpp: 0
2025-03-03 02:09:27 - INFO - layer8_mlp.gate_proj | mse: 0.05369195335776531, bpp_loss: 3.182144194321577, bpp: 0
2025-03-03 02:09:37 - INFO - layer8_mlp.up_proj | mse: 0.052499348459332, bpp_loss: 3.0620611405303313, bpp: 0
2025-03-03 02:10:04 - INFO - layer8_mlp.down_proj | mse: 0.05056971005994742, bpp_loss: 3.0559525734766626, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [12:25<31:41, 82.69s/it]2025-03-03 02:10:13 - INFO - layer9_self_attn.q_proj | mse: 0.05674626747514379, bpp_loss: 3.502499927766621, bpp: 0
2025-03-03 02:10:22 - INFO - layer9_self_attn.k_proj | mse: 0.057008293387387124, bpp_loss: 3.5379802168463357, bpp: 0
2025-03-03 02:10:31 - INFO - layer9_self_attn.v_proj | mse: 0.05011333786600068, bpp_loss: 2.851746545464266, bpp: 0
2025-03-03 02:10:39 - INFO - layer9_self_attn.o_proj | mse: 0.052385749087111085, bpp_loss: 2.851824607234448, bpp: 0
2025-03-03 02:10:50 - INFO - layer9_mlp.gate_proj | mse: 0.05335054753589381, bpp_loss: 3.1686424868571206, bpp: 0
2025-03-03 02:11:00 - INFO - layer9_mlp.up_proj | mse: 0.052409376827323474, bpp_loss: 3.069445047700821, bpp: 0
2025-03-03 02:11:28 - INFO - layer9_mlp.down_proj | mse: 0.050634409779025724, bpp_loss: 3.062726005067139, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [13:49<30:28, 83.14s/it]2025-03-03 02:11:38 - INFO - layer10_self_attn.q_proj | mse: 0.056408327459408596, bpp_loss: 3.4921570583828725, bpp: 0
2025-03-03 02:11:47 - INFO - layer10_self_attn.k_proj | mse: 0.05669897035815371, bpp_loss: 3.5320054220501333, bpp: 0
2025-03-03 02:11:56 - INFO - layer10_self_attn.v_proj | mse: 0.049888637450223115, bpp_loss: 2.8450756538077258, bpp: 0
2025-03-03 02:12:05 - INFO - layer10_self_attn.o_proj | mse: 0.053499945865265595, bpp_loss: 2.8507505121524446, bpp: 0
2025-03-03 02:12:16 - INFO - layer10_mlp.gate_proj | mse: 0.0533390434472233, bpp_loss: 3.1612770212597625, bpp: 0
2025-03-03 02:12:26 - INFO - layer10_mlp.up_proj | mse: 0.05254301052900123, bpp_loss: 3.0818309297048767, bpp: 0
2025-03-03 02:12:54 - INFO - layer10_mlp.down_proj | mse: 0.05082084673027583, bpp_loss: 3.071721577951901, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [15:14<29:20, 83.81s/it]2025-03-03 02:13:03 - INFO - layer11_self_attn.q_proj | mse: 0.05525059971960439, bpp_loss: 3.386139190697577, bpp: 0
2025-03-03 02:13:11 - INFO - layer11_self_attn.k_proj | mse: 0.05519420009486086, bpp_loss: 3.3913455234724097, bpp: 0
2025-03-03 02:13:20 - INFO - layer11_self_attn.v_proj | mse: 0.05026519504341009, bpp_loss: 2.8778376404661685, bpp: 0
2025-03-03 02:13:29 - INFO - layer11_self_attn.o_proj | mse: 0.052045995522727366, bpp_loss: 2.8826632871641777, bpp: 0
2025-03-03 02:13:39 - INFO - layer11_mlp.gate_proj | mse: 0.052870855496724045, bpp_loss: 3.158738946325557, bpp: 0
2025-03-03 02:13:50 - INFO - layer11_mlp.up_proj | mse: 0.052242934051172744, bpp_loss: 3.091568625770336, bpp: 0
2025-03-03 02:14:17 - INFO - layer11_mlp.down_proj | mse: 0.05068452241715488, bpp_loss: 3.079595891802117, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [16:38<27:54, 83.73s/it]2025-03-03 02:14:26 - INFO - layer12_self_attn.q_proj | mse: 0.0555724437668233, bpp_loss: 3.4443860424216837, bpp: 0
2025-03-03 02:14:35 - INFO - layer12_self_attn.k_proj | mse: 0.05581447429125177, bpp_loss: 3.4884413343970664, bpp: 0
2025-03-03 02:14:44 - INFO - layer12_self_attn.v_proj | mse: 0.04976269721564069, bpp_loss: 2.8679107259958982, bpp: 0
2025-03-03 02:14:52 - INFO - layer12_self_attn.o_proj | mse: 0.05328597030108041, bpp_loss: 2.8749464013963006, bpp: 0
2025-03-03 02:15:03 - INFO - layer12_mlp.gate_proj | mse: 0.052707862222423546, bpp_loss: 3.1524002741762374, bpp: 0
2025-03-03 02:15:13 - INFO - layer12_mlp.up_proj | mse: 0.052273725167063335, bpp_loss: 3.1027071869304015, bpp: 0
2025-03-03 02:15:41 - INFO - layer12_mlp.down_proj | mse: 0.05057961013025757, bpp_loss: 3.089153143274056, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [18:01<26:29, 83.64s/it]2025-03-03 02:15:50 - INFO - layer13_self_attn.q_proj | mse: 0.05523323484644265, bpp_loss: 3.4344389231409878, bpp: 0
2025-03-03 02:15:58 - INFO - layer13_self_attn.k_proj | mse: 0.05542234799129616, bpp_loss: 3.4599624979309738, bpp: 0
2025-03-03 02:16:07 - INFO - layer13_self_attn.v_proj | mse: 0.05001487897723278, bpp_loss: 2.900170810171403, bpp: 0
2025-03-03 02:16:16 - INFO - layer13_self_attn.o_proj | mse: 0.052627571024474545, bpp_loss: 2.901601049816236, bpp: 0
2025-03-03 02:16:26 - INFO - layer13_mlp.gate_proj | mse: 0.05279525535179902, bpp_loss: 3.1478021683734516, bpp: 0
2025-03-03 02:16:36 - INFO - layer13_mlp.up_proj | mse: 0.052536598767437125, bpp_loss: 3.1142659143999567, bpp: 0
2025-03-03 02:17:04 - INFO - layer13_mlp.down_proj | mse: 0.050895023955687624, bpp_loss: 3.097484186075108, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [19:24<25:02, 83.46s/it]2025-03-03 02:17:13 - INFO - layer14_self_attn.q_proj | mse: 0.055582403799177324, bpp_loss: 3.426553665252868, bpp: 0
2025-03-03 02:17:21 - INFO - layer14_self_attn.k_proj | mse: 0.05567010307184201, bpp_loss: 3.457244956982322, bpp: 0
2025-03-03 02:17:30 - INFO - layer14_self_attn.v_proj | mse: 0.05016920443491142, bpp_loss: 2.883974372933153, bpp: 0
2025-03-03 02:17:39 - INFO - layer14_self_attn.o_proj | mse: 0.052156019405432824, bpp_loss: 2.887379653577227, bpp: 0
2025-03-03 02:17:49 - INFO - layer14_mlp.gate_proj | mse: 0.05265348513763204, bpp_loss: 3.1453006759632465, bpp: 0
2025-03-03 02:18:00 - INFO - layer14_mlp.up_proj | mse: 0.052430466219260285, bpp_loss: 3.1162490663660125, bpp: 0
2025-03-03 02:18:27 - INFO - layer14_mlp.down_proj | mse: 0.05066246285282269, bpp_loss: 3.10018194763553, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [20:48<23:37, 83.40s/it]2025-03-03 02:18:36 - INFO - layer15_self_attn.q_proj | mse: 0.05540916644760482, bpp_loss: 3.418129492783919, bpp: 0
2025-03-03 02:18:45 - INFO - layer15_self_attn.k_proj | mse: 0.055707486509159174, bpp_loss: 3.4676557141938247, bpp: 0
2025-03-03 02:18:53 - INFO - layer15_self_attn.v_proj | mse: 0.05045476012690445, bpp_loss: 2.920681274845265, bpp: 0
2025-03-03 02:19:02 - INFO - layer15_self_attn.o_proj | mse: 0.05370942521938287, bpp_loss: 2.9153392226435244, bpp: 0
2025-03-03 02:19:13 - INFO - layer15_mlp.gate_proj | mse: 0.0528632191620031, bpp_loss: 3.1507871935880463, bpp: 0
2025-03-03 02:19:23 - INFO - layer15_mlp.up_proj | mse: 0.052643891210611096, bpp_loss: 3.1224765761127307, bpp: 0
2025-03-03 02:19:50 - INFO - layer15_mlp.down_proj | mse: 0.05087392593999617, bpp_loss: 3.1026650085222234, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [22:11<22:13, 83.36s/it]2025-03-03 02:19:59 - INFO - layer16_self_attn.q_proj | mse: 0.05549400344221081, bpp_loss: 3.3997776394244283, bpp: 0
2025-03-03 02:20:08 - INFO - layer16_self_attn.k_proj | mse: 0.055749876036036476, bpp_loss: 3.4405917790718377, bpp: 0
2025-03-03 02:20:17 - INFO - layer16_self_attn.v_proj | mse: 0.05120457847883427, bpp_loss: 2.9608266325085424, bpp: 0
2025-03-03 02:20:25 - INFO - layer16_self_attn.o_proj | mse: 0.05191582560599343, bpp_loss: 2.9677639511646703, bpp: 0
2025-03-03 02:20:36 - INFO - layer16_mlp.gate_proj | mse: 0.05365811374461459, bpp_loss: 3.1601911146453645, bpp: 0
2025-03-03 02:20:46 - INFO - layer16_mlp.up_proj | mse: 0.05333062666270874, bpp_loss: 3.1228688283888406, bpp: 0
2025-03-03 02:21:13 - INFO - layer16_mlp.down_proj | mse: 0.0508871547795918, bpp_loss: 3.103278959928037, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [23:34<20:50, 83.35s/it]2025-03-03 02:21:23 - INFO - layer17_self_attn.q_proj | mse: 0.05572984588371078, bpp_loss: 3.399981678405311, bpp: 0
2025-03-03 02:21:31 - INFO - layer17_self_attn.k_proj | mse: 0.055916832599318254, bpp_loss: 3.4316793634789065, bpp: 0
2025-03-03 02:21:40 - INFO - layer17_self_attn.v_proj | mse: 0.051374107615917784, bpp_loss: 2.959629032644443, bpp: 0
2025-03-03 02:21:49 - INFO - layer17_self_attn.o_proj | mse: 0.05165932725097275, bpp_loss: 2.9632377552916296, bpp: 0
2025-03-03 02:21:59 - INFO - layer17_mlp.gate_proj | mse: 0.05332962630717218, bpp_loss: 3.1739268378289633, bpp: 0
2025-03-03 02:22:10 - INFO - layer17_mlp.up_proj | mse: 0.052830095320486305, bpp_loss: 3.119573777151662, bpp: 0
2025-03-03 02:22:37 - INFO - layer17_mlp.down_proj | mse: 0.05036700870747351, bpp_loss: 3.103925689188547, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [24:58<19:27, 83.41s/it]2025-03-03 02:22:46 - INFO - layer18_self_attn.q_proj | mse: 0.054980966173573474, bpp_loss: 3.373894353688229, bpp: 0
2025-03-03 02:22:55 - INFO - layer18_self_attn.k_proj | mse: 0.055198864333397796, bpp_loss: 3.4022726755938493, bpp: 0
2025-03-03 02:23:04 - INFO - layer18_self_attn.v_proj | mse: 0.05143543800711465, bpp_loss: 3.006835573061835, bpp: 0
2025-03-03 02:23:13 - INFO - layer18_self_attn.o_proj | mse: 0.05099333772283472, bpp_loss: 3.0075183048611507, bpp: 0
2025-03-03 02:23:23 - INFO - layer18_mlp.gate_proj | mse: 0.05353464744964037, bpp_loss: 3.184802518940942, bpp: 0
2025-03-03 02:23:34 - INFO - layer18_mlp.up_proj | mse: 0.05287543902230753, bpp_loss: 3.116096379625243, bpp: 0
2025-03-03 02:24:01 - INFO - layer18_mlp.down_proj | mse: 0.05004383350288045, bpp_loss: 3.1028410538727806, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [26:22<18:08, 83.71s/it]2025-03-03 02:24:10 - INFO - layer19_self_attn.q_proj | mse: 0.054923459878568386, bpp_loss: 3.352497555606533, bpp: 0
2025-03-03 02:24:19 - INFO - layer19_self_attn.k_proj | mse: 0.05506747186469952, bpp_loss: 3.378991494420916, bpp: 0
2025-03-03 02:24:28 - INFO - layer19_self_attn.v_proj | mse: 0.05169768409459327, bpp_loss: 3.0169253253843635, bpp: 0
2025-03-03 02:24:37 - INFO - layer19_self_attn.o_proj | mse: 0.05028369555725908, bpp_loss: 3.0124066557036713, bpp: 0
2025-03-03 02:24:48 - INFO - layer19_mlp.gate_proj | mse: 0.05337270627340419, bpp_loss: 3.1897012114005032, bpp: 0
2025-03-03 02:24:58 - INFO - layer19_mlp.up_proj | mse: 0.05263650927665161, bpp_loss: 3.116039957677902, bpp: 0
2025-03-03 02:25:25 - INFO - layer19_mlp.down_proj | mse: 0.04984522412197637, bpp_loss: 3.1062020639520744, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [27:46<16:45, 83.82s/it]2025-03-03 02:25:35 - INFO - layer20_self_attn.q_proj | mse: 0.054826055513295786, bpp_loss: 3.359265842125751, bpp: 0
2025-03-03 02:25:44 - INFO - layer20_self_attn.k_proj | mse: 0.05497076278964361, bpp_loss: 3.384330040891655, bpp: 0
2025-03-03 02:25:53 - INFO - layer20_self_attn.v_proj | mse: 0.051846765905221075, bpp_loss: 3.0341517522465438, bpp: 0
2025-03-03 02:26:01 - INFO - layer20_self_attn.o_proj | mse: 0.05080699994476282, bpp_loss: 3.037373568979092, bpp: 0
2025-03-03 02:26:12 - INFO - layer20_mlp.gate_proj | mse: 0.05375652372052423, bpp_loss: 3.1988183439297733, bpp: 0
2025-03-03 02:26:23 - INFO - layer20_mlp.up_proj | mse: 0.05294296733290302, bpp_loss: 3.116591171426482, bpp: 0
2025-03-03 02:26:50 - INFO - layer20_mlp.down_proj | mse: 0.049950076042591295, bpp_loss: 3.10762708246448, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [29:11<15:25, 84.13s/it]2025-03-03 02:27:00 - INFO - layer21_self_attn.q_proj | mse: 0.05451980334918607, bpp_loss: 3.326266509189736, bpp: 0
2025-03-03 02:27:08 - INFO - layer21_self_attn.k_proj | mse: 0.054584390016231076, bpp_loss: 3.340444618021138, bpp: 0
2025-03-03 02:27:17 - INFO - layer21_self_attn.v_proj | mse: 0.05226035349653173, bpp_loss: 3.06854645506246, bpp: 0
2025-03-03 02:27:26 - INFO - layer21_self_attn.o_proj | mse: 0.0501273769342926, bpp_loss: 3.066495554812718, bpp: 0
2025-03-03 02:27:37 - INFO - layer21_mlp.gate_proj | mse: 0.05350881068078218, bpp_loss: 3.207501890181109, bpp: 0
2025-03-03 02:27:47 - INFO - layer21_mlp.up_proj | mse: 0.052566260171471764, bpp_loss: 3.1146215326910793, bpp: 0
2025-03-03 02:28:15 - INFO - layer21_mlp.down_proj | mse: 0.049446220242960706, bpp_loss: 3.10793846923598, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [30:35<14:01, 84.20s/it]2025-03-03 02:28:24 - INFO - layer22_self_attn.q_proj | mse: 0.054436003495819965, bpp_loss: 3.362400019657798, bpp: 0
2025-03-03 02:28:33 - INFO - layer22_self_attn.k_proj | mse: 0.05454464259217719, bpp_loss: 3.3793338644318283, bpp: 0
2025-03-03 02:28:42 - INFO - layer22_self_attn.v_proj | mse: 0.051824000944709736, bpp_loss: 3.07237281819107, bpp: 0
2025-03-03 02:28:51 - INFO - layer22_self_attn.o_proj | mse: 0.049874760616315086, bpp_loss: 3.058123146125581, bpp: 0
2025-03-03 02:29:01 - INFO - layer22_mlp.gate_proj | mse: 0.05341181931250845, bpp_loss: 3.215950817562813, bpp: 0
2025-03-03 02:29:12 - INFO - layer22_mlp.up_proj | mse: 0.05240129636923932, bpp_loss: 3.114882833519301, bpp: 0
2025-03-03 02:29:39 - INFO - layer22_mlp.down_proj | mse: 0.0494427448698466, bpp_loss: 3.1085392544695805, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [32:00<12:38, 84.30s/it]2025-03-03 02:29:48 - INFO - layer23_self_attn.q_proj | mse: 0.054169886959468456, bpp_loss: 3.357727808353957, bpp: 0
2025-03-03 02:29:57 - INFO - layer23_self_attn.k_proj | mse: 0.05424383686809817, bpp_loss: 3.3677793957758695, bpp: 0
2025-03-03 02:30:06 - INFO - layer23_self_attn.v_proj | mse: 0.052178320839133034, bpp_loss: 3.1273935551871546, bpp: 0
2025-03-03 02:30:15 - INFO - layer23_self_attn.o_proj | mse: 0.04921262994887967, bpp_loss: 3.111443373025395, bpp: 0
2025-03-03 02:30:25 - INFO - layer23_mlp.gate_proj | mse: 0.05300342416470555, bpp_loss: 3.2161864541297733, bpp: 0
2025-03-03 02:30:36 - INFO - layer23_mlp.up_proj | mse: 0.05204488952619664, bpp_loss: 3.1203609357566333, bpp: 0
2025-03-03 02:31:04 - INFO - layer23_mlp.down_proj | mse: 0.04903792858021331, bpp_loss: 3.1154945820006867, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [33:24<11:14, 84.32s/it]2025-03-03 02:31:13 - INFO - layer24_self_attn.q_proj | mse: 0.05313176072510455, bpp_loss: 3.3022833322174847, bpp: 0
2025-03-03 02:31:22 - INFO - layer24_self_attn.k_proj | mse: 0.05311094837128508, bpp_loss: 3.3089392397087067, bpp: 0
2025-03-03 02:31:31 - INFO - layer24_self_attn.v_proj | mse: 0.05166439128138428, bpp_loss: 3.1168714254745282, bpp: 0
2025-03-03 02:31:39 - INFO - layer24_self_attn.o_proj | mse: 0.04998353297663051, bpp_loss: 3.1030275522498414, bpp: 0
2025-03-03 02:31:50 - INFO - layer24_mlp.gate_proj | mse: 0.052707077460752615, bpp_loss: 3.219069289433402, bpp: 0
2025-03-03 02:32:00 - INFO - layer24_mlp.up_proj | mse: 0.05174880153488248, bpp_loss: 3.1240386320494635, bpp: 0
2025-03-03 02:32:28 - INFO - layer24_mlp.down_proj | mse: 0.048794294576409145, bpp_loss: 3.119618139164739, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [34:49<09:50, 84.36s/it]2025-03-03 02:32:37 - INFO - layer25_self_attn.q_proj | mse: 0.053116464340337455, bpp_loss: 3.3259617846342735, bpp: 0
2025-03-03 02:32:46 - INFO - layer25_self_attn.k_proj | mse: 0.05312823792134001, bpp_loss: 3.3306180253857747, bpp: 0
2025-03-03 02:32:55 - INFO - layer25_self_attn.v_proj | mse: 0.0518275411307297, bpp_loss: 3.1630177103797905, bpp: 0
2025-03-03 02:33:04 - INFO - layer25_self_attn.o_proj | mse: 0.049996552285937954, bpp_loss: 3.1561362043139525, bpp: 0
2025-03-03 02:33:15 - INFO - layer25_mlp.gate_proj | mse: 0.052348838069852, bpp_loss: 3.21996328308312, bpp: 0
2025-03-03 02:33:25 - INFO - layer25_mlp.up_proj | mse: 0.05142408699008875, bpp_loss: 3.1285617442931546, bpp: 0
2025-03-03 02:33:53 - INFO - layer25_mlp.down_proj | mse: 0.04856587287576448, bpp_loss: 3.123407147001735, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [36:13<08:26, 84.40s/it]2025-03-03 02:34:02 - INFO - layer26_self_attn.q_proj | mse: 0.052578089537387046, bpp_loss: 3.301317567238584, bpp: 0
2025-03-03 02:34:11 - INFO - layer26_self_attn.k_proj | mse: 0.052609846918034185, bpp_loss: 3.311519695504103, bpp: 0
2025-03-03 02:34:19 - INFO - layer26_self_attn.v_proj | mse: 0.051765741418636574, bpp_loss: 3.1779360179789364, bpp: 0
2025-03-03 02:34:28 - INFO - layer26_self_attn.o_proj | mse: 0.05141784716463249, bpp_loss: 3.1712423467542976, bpp: 0
2025-03-03 02:34:39 - INFO - layer26_mlp.gate_proj | mse: 0.05225600335130779, bpp_loss: 3.221556872865835, bpp: 0
2025-03-03 02:34:49 - INFO - layer26_mlp.up_proj | mse: 0.05134265718703685, bpp_loss: 3.133127738006933, bpp: 0
2025-03-03 02:35:17 - INFO - layer26_mlp.down_proj | mse: 0.048531533084845487, bpp_loss: 3.1245777072211682, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [37:38<07:02, 84.41s/it]2025-03-03 02:35:26 - INFO - layer27_self_attn.q_proj | mse: 0.05319837532194823, bpp_loss: 3.368373033590615, bpp: 0
2025-03-03 02:35:35 - INFO - layer27_self_attn.k_proj | mse: 0.05331692809797837, bpp_loss: 3.3830971641582437, bpp: 0
2025-03-03 02:35:44 - INFO - layer27_self_attn.v_proj | mse: 0.051698390972980235, bpp_loss: 3.185342919372488, bpp: 0
2025-03-03 02:35:53 - INFO - layer27_self_attn.o_proj | mse: 0.05011435183090002, bpp_loss: 3.1862870162003674, bpp: 0
2025-03-03 02:36:03 - INFO - layer27_mlp.gate_proj | mse: 0.05215644210415564, bpp_loss: 3.2203136487582396, bpp: 0
2025-03-03 02:36:14 - INFO - layer27_mlp.up_proj | mse: 0.05130051721005902, bpp_loss: 3.138873242231649, bpp: 0
2025-03-03 02:36:42 - INFO - layer27_mlp.down_proj | mse: 0.0486561463391849, bpp_loss: 3.127828428933267, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [39:03<05:38, 84.55s/it]2025-03-03 02:36:51 - INFO - layer28_self_attn.q_proj | mse: 0.052762179210424996, bpp_loss: 3.3207066387985833, bpp: 0
2025-03-03 02:37:00 - INFO - layer28_self_attn.k_proj | mse: 0.05295024941995348, bpp_loss: 3.3383780452422798, bpp: 0
2025-03-03 02:37:09 - INFO - layer28_self_attn.v_proj | mse: 0.05213557787306225, bpp_loss: 3.2229636167758144, bpp: 0
2025-03-03 02:37:18 - INFO - layer28_self_attn.o_proj | mse: 0.05176498818756849, bpp_loss: 3.2276983378687873, bpp: 0
2025-03-03 02:37:28 - INFO - layer28_mlp.gate_proj | mse: 0.05205924807764821, bpp_loss: 3.2123586566642275, bpp: 0
2025-03-03 02:37:39 - INFO - layer28_mlp.up_proj | mse: 0.0513862890735649, bpp_loss: 3.1503195448583643, bpp: 0
2025-03-03 02:38:07 - INFO - layer28_mlp.down_proj | mse: 0.04905242079986157, bpp_loss: 3.1320074888942546, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [40:27<04:13, 84.64s/it]2025-03-03 02:38:16 - INFO - layer29_self_attn.q_proj | mse: 0.05237932924077701, bpp_loss: 3.276214351702947, bpp: 0
2025-03-03 02:38:25 - INFO - layer29_self_attn.k_proj | mse: 0.052463343475293266, bpp_loss: 3.291101704002358, bpp: 0
2025-03-03 02:38:34 - INFO - layer29_self_attn.v_proj | mse: 0.05233978460970299, bpp_loss: 3.227918994030915, bpp: 0
2025-03-03 02:38:43 - INFO - layer29_self_attn.o_proj | mse: 0.05130561573548906, bpp_loss: 3.2454205439426005, bpp: 0
2025-03-03 02:38:53 - INFO - layer29_mlp.gate_proj | mse: 0.05213151514141045, bpp_loss: 3.212308926291244, bpp: 0
2025-03-03 02:39:04 - INFO - layer29_mlp.up_proj | mse: 0.05155017490646914, bpp_loss: 3.160426445348665, bpp: 0
2025-03-03 02:39:31 - INFO - layer29_mlp.down_proj | mse: 0.04952927131188221, bpp_loss: 3.132011047694399, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [41:52<02:49, 84.68s/it]2025-03-03 02:39:41 - INFO - layer30_self_attn.q_proj | mse: 0.052800987992686364, bpp_loss: 3.296353447774891, bpp: 0
2025-03-03 02:39:50 - INFO - layer30_self_attn.k_proj | mse: 0.05302312162874733, bpp_loss: 3.318750590959098, bpp: 0
2025-03-03 02:39:58 - INFO - layer30_self_attn.v_proj | mse: 0.052863448230485346, bpp_loss: 3.263866097200662, bpp: 0
2025-03-03 02:40:07 - INFO - layer30_self_attn.o_proj | mse: 0.05204695734086045, bpp_loss: 3.275955912657082, bpp: 0
2025-03-03 02:40:18 - INFO - layer30_mlp.gate_proj | mse: 0.05259491690809251, bpp_loss: 3.229810887471188, bpp: 0
2025-03-03 02:40:29 - INFO - layer30_mlp.up_proj | mse: 0.05193227622641869, bpp_loss: 3.1708868143343647, bpp: 0
2025-03-03 02:40:57 - INFO - layer30_mlp.down_proj | mse: 0.05081275764843704, bpp_loss: 3.114782037646618, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [43:17<01:24, 84.79s/it]2025-03-03 02:41:06 - INFO - layer31_self_attn.q_proj | mse: 0.05393850596352556, bpp_loss: 3.3163081035600044, bpp: 0
2025-03-03 02:41:15 - INFO - layer31_self_attn.k_proj | mse: 0.05439609383738218, bpp_loss: 3.3595157407107763, bpp: 0
2025-03-03 02:41:24 - INFO - layer31_self_attn.v_proj | mse: 0.05253410084301136, bpp_loss: 3.1390381957171485, bpp: 0
2025-03-03 02:41:33 - INFO - layer31_self_attn.o_proj | mse: 0.05640567376841491, bpp_loss: 3.135579119203612, bpp: 0
2025-03-03 02:41:43 - INFO - layer31_mlp.gate_proj | mse: 0.054311044078580034, bpp_loss: 3.3005668857069903, bpp: 0
2025-03-03 02:41:54 - INFO - layer31_mlp.up_proj | mse: 0.053499751426548024, bpp_loss: 3.2296616929734863, bpp: 0
2025-03-03 02:42:22 - INFO - layer31_mlp.down_proj | mse: 0.056679088291864466, bpp_loss: 3.107284136549678, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [44:42<00:00, 84.86s/it]pseudo compress quantization...: 100%|██████████| 32/32 [44:42<00:00, 83.84s/it]
2025-03-03 02:42:22 - INFO - #### Total | mse: 0.053220567583676374, bpp_loss: 3.142884355670244, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Llama-2-7b-hf/block_seq_ql_random_col_16/lmbda100_rdloss_ql_encdim512_M16_batch_size2048_total_iter1500000_lr0.0001_seed100/best_loss_model_loss_4.39201_bpp_5.10767_MSE_0.0081_total_iter_190000.pth.tar/COL_MSE0.05322_bpploss3.1429_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Llama-2-7b-hf/block_seq_ql_random_col_16/lmbda100_rdloss_ql_encdim512_M16_batch_size2048_total_iter1500000_lr0.0001_seed100/best_loss_model_loss_4.39201_bpp_5.10767_MSE_0.0081_total_iter_190000.pth.tar/COL_MSE0.05322_bpploss3.1429_bpp0
I0303 02:42:51.949566 2884153 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.45it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.50it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.68it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.62it/s]
I0303 02:42:53.929937 2884153 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/166 [00:00<?, ?it/s]avg_loss = 1.421875:   0%|          | 0/166 [00:00<?, ?it/s]avg_loss = 1.421875:   1%|          | 1/166 [00:00<01:21,  2.03it/s]avg_loss = 1.6796875:   1%|          | 1/166 [00:00<01:21,  2.03it/s]avg_loss = 1.6796875:   1%|          | 2/166 [00:00<01:09,  2.37it/s]avg_loss = 1.8489583333333333:   1%|          | 2/166 [00:01<01:09,  2.37it/s]avg_loss = 1.8489583333333333:   2%|▏         | 3/166 [00:01<01:05,  2.50it/s]avg_loss = 1.884765625:   2%|▏         | 3/166 [00:01<01:05,  2.50it/s]       avg_loss = 1.884765625:   2%|▏         | 4/166 [00:01<01:03,  2.56it/s]avg_loss = 1.815625:   2%|▏         | 4/166 [00:01<01:03,  2.56it/s]   avg_loss = 1.815625:   3%|▎         | 5/166 [00:01<01:01,  2.60it/s]avg_loss = 1.7890625:   3%|▎         | 5/166 [00:02<01:01,  2.60it/s]avg_loss = 1.7890625:   4%|▎         | 6/166 [00:02<01:00,  2.62it/s]avg_loss = 1.7299107142857142:   4%|▎         | 6/166 [00:02<01:00,  2.62it/s]avg_loss = 1.7299107142857142:   4%|▍         | 7/166 [00:02<01:00,  2.64it/s]avg_loss = 1.67578125:   4%|▍         | 7/166 [00:03<01:00,  2.64it/s]        avg_loss = 1.67578125:   5%|▍         | 8/166 [00:03<00:59,  2.65it/s]avg_loss = 1.6701388888888888:   5%|▍         | 8/166 [00:03<00:59,  2.65it/s]avg_loss = 1.6701388888888888:   5%|▌         | 9/166 [00:03<00:59,  2.65it/s]avg_loss = 1.67734375:   5%|▌         | 9/166 [00:03<00:59,  2.65it/s]        avg_loss = 1.67734375:   6%|▌         | 10/166 [00:03<00:58,  2.66it/s]avg_loss = 1.6938920454545454:   6%|▌         | 10/166 [00:04<00:58,  2.66it/s]avg_loss = 1.6938920454545454:   7%|▋         | 11/166 [00:04<00:58,  2.66it/s]avg_loss = 1.7024739583333333:   7%|▋         | 11/166 [00:04<00:58,  2.66it/s]avg_loss = 1.7024739583333333:   7%|▋         | 12/166 [00:04<00:57,  2.66it/s]avg_loss = 1.6971153846153846:   7%|▋         | 12/166 [00:04<00:57,  2.66it/s]avg_loss = 1.6971153846153846:   8%|▊         | 13/166 [00:04<00:57,  2.66it/s]avg_loss = 1.70703125:   8%|▊         | 13/166 [00:05<00:57,  2.66it/s]        avg_loss = 1.70703125:   8%|▊         | 14/166 [00:05<00:57,  2.66it/s]avg_loss = 1.7239583333333333:   8%|▊         | 14/166 [00:05<00:57,  2.66it/s]avg_loss = 1.7239583333333333:   9%|▉         | 15/166 [00:05<00:56,  2.66it/s]avg_loss = 1.7431640625:   9%|▉         | 15/166 [00:06<00:56,  2.66it/s]      avg_loss = 1.7431640625:  10%|▉         | 16/166 [00:06<00:56,  2.66it/s]avg_loss = 1.7564338235294117:  10%|▉         | 16/166 [00:06<00:56,  2.66it/s]avg_loss = 1.7564338235294117:  10%|█         | 17/166 [00:06<00:56,  2.66it/s]avg_loss = 1.7708333333333333:  10%|█         | 17/166 [00:06<00:56,  2.66it/s]avg_loss = 1.7708333333333333:  11%|█         | 18/166 [00:06<00:55,  2.66it/s]avg_loss = 1.7894736842105263:  11%|█         | 18/166 [00:07<00:55,  2.66it/s]avg_loss = 1.7894736842105263:  11%|█▏        | 19/166 [00:07<00:55,  2.66it/s]avg_loss = 1.795703125:  11%|█▏        | 19/166 [00:07<00:55,  2.66it/s]       avg_loss = 1.795703125:  12%|█▏        | 20/166 [00:07<00:55,  2.65it/s]avg_loss = 1.796875:  12%|█▏        | 20/166 [00:08<00:55,  2.65it/s]   avg_loss = 1.796875:  13%|█▎        | 21/166 [00:08<00:54,  2.66it/s]avg_loss = 1.7865767045454546:  13%|█▎        | 21/166 [00:08<00:54,  2.66it/s]avg_loss = 1.7865767045454546:  13%|█▎        | 22/166 [00:08<00:54,  2.65it/s]avg_loss = 1.776154891304348:  13%|█▎        | 22/166 [00:08<00:54,  2.65it/s] avg_loss = 1.776154891304348:  14%|█▍        | 23/166 [00:08<00:53,  2.65it/s]avg_loss = 1.783203125:  14%|█▍        | 23/166 [00:09<00:53,  2.65it/s]      avg_loss = 1.783203125:  14%|█▍        | 24/166 [00:09<00:53,  2.65it/s]avg_loss = 1.790625:  14%|█▍        | 24/166 [00:09<00:53,  2.65it/s]   avg_loss = 1.790625:  15%|█▌        | 25/166 [00:09<00:53,  2.65it/s]avg_loss = 1.7953725961538463:  15%|█▌        | 25/166 [00:09<00:53,  2.65it/s]avg_loss = 1.7953725961538463:  16%|█▌        | 26/166 [00:09<00:52,  2.65it/s]avg_loss = 1.8012152777777777:  16%|█▌        | 26/166 [00:10<00:52,  2.65it/s]avg_loss = 1.8012152777777777:  16%|█▋        | 27/166 [00:10<00:52,  2.65it/s]avg_loss = 1.8038504464285714:  16%|█▋        | 27/166 [00:10<00:52,  2.65it/s]avg_loss = 1.8038504464285714:  17%|█▋        | 28/166 [00:10<00:51,  2.66it/s]avg_loss = 1.8127693965517242:  17%|█▋        | 28/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8127693965517242:  17%|█▋        | 29/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8127604166666667:  17%|█▋        | 29/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8127604166666667:  18%|█▊        | 30/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8273689516129032:  18%|█▊        | 30/166 [00:11<00:51,  2.66it/s]avg_loss = 1.8273689516129032:  19%|█▊        | 31/166 [00:11<00:50,  2.66it/s]avg_loss = 1.833740234375:  19%|█▊        | 31/166 [00:12<00:50,  2.66it/s]    avg_loss = 1.833740234375:  19%|█▉        | 32/166 [00:12<00:50,  2.66it/s]avg_loss = 1.8387784090909092:  19%|█▉        | 32/166 [00:12<00:50,  2.66it/s]avg_loss = 1.8387784090909092:  20%|█▉        | 33/166 [00:12<00:49,  2.67it/s]avg_loss = 1.837545955882353:  20%|█▉        | 33/166 [00:12<00:49,  2.67it/s] avg_loss = 1.837545955882353:  20%|██        | 34/166 [00:12<00:49,  2.66it/s]avg_loss = 1.8308035714285715:  20%|██        | 34/166 [00:13<00:49,  2.66it/s]avg_loss = 1.8308035714285715:  21%|██        | 35/166 [00:13<00:49,  2.66it/s]avg_loss = 1.8229166666666667:  21%|██        | 35/166 [00:13<00:49,  2.66it/s]avg_loss = 1.8229166666666667:  22%|██▏       | 36/166 [00:13<00:48,  2.66it/s]avg_loss = 1.8135557432432432:  22%|██▏       | 36/166 [00:14<00:48,  2.66it/s]avg_loss = 1.8135557432432432:  22%|██▏       | 37/166 [00:14<00:48,  2.66it/s]avg_loss = 1.811060855263158:  22%|██▏       | 37/166 [00:14<00:48,  2.66it/s] avg_loss = 1.811060855263158:  23%|██▎       | 38/166 [00:14<00:48,  2.66it/s]avg_loss = 1.8086939102564104:  23%|██▎       | 38/166 [00:14<00:48,  2.66it/s]avg_loss = 1.8086939102564104:  23%|██▎       | 39/166 [00:14<00:47,  2.66it/s]avg_loss = 1.8119140625:  23%|██▎       | 39/166 [00:15<00:47,  2.66it/s]      avg_loss = 1.8119140625:  24%|██▍       | 40/166 [00:15<00:47,  2.66it/s]avg_loss = 1.8119283536585367:  24%|██▍       | 40/166 [00:15<00:47,  2.66it/s]avg_loss = 1.8119283536585367:  25%|██▍       | 41/166 [00:15<00:47,  2.66it/s]avg_loss = 1.7992931547619047:  25%|██▍       | 41/166 [00:15<00:47,  2.66it/s]avg_loss = 1.7992931547619047:  25%|██▌       | 42/166 [00:15<00:46,  2.66it/s]avg_loss = 1.783611918604651:  25%|██▌       | 42/166 [00:16<00:46,  2.66it/s] avg_loss = 1.783611918604651:  26%|██▌       | 43/166 [00:16<00:46,  2.66it/s]avg_loss = 1.7730823863636365:  26%|██▌       | 43/166 [00:16<00:46,  2.66it/s]avg_loss = 1.7730823863636365:  27%|██▋       | 44/166 [00:16<00:45,  2.66it/s]avg_loss = 1.759375:  27%|██▋       | 44/166 [00:17<00:45,  2.66it/s]          avg_loss = 1.759375:  27%|██▋       | 45/166 [00:17<00:45,  2.66it/s]avg_loss = 1.7489809782608696:  27%|██▋       | 45/166 [00:17<00:45,  2.66it/s]avg_loss = 1.7489809782608696:  28%|██▊       | 46/166 [00:17<00:45,  2.65it/s]avg_loss = 1.741688829787234:  28%|██▊       | 46/166 [00:17<00:45,  2.65it/s] avg_loss = 1.741688829787234:  28%|██▊       | 47/166 [00:17<00:44,  2.66it/s]avg_loss = 1.74267578125:  28%|██▊       | 47/166 [00:18<00:44,  2.66it/s]    avg_loss = 1.74267578125:  29%|██▉       | 48/166 [00:18<00:44,  2.66it/s]avg_loss = 1.7530293367346939:  29%|██▉       | 48/166 [00:18<00:44,  2.66it/s]avg_loss = 1.7530293367346939:  30%|██▉       | 49/166 [00:18<00:44,  2.65it/s]avg_loss = 1.76359375:  30%|██▉       | 49/166 [00:18<00:44,  2.65it/s]        avg_loss = 1.76359375:  30%|███       | 50/166 [00:18<00:43,  2.65it/s]avg_loss = 1.7706801470588236:  30%|███       | 50/166 [00:19<00:43,  2.65it/s]avg_loss = 1.7706801470588236:  31%|███       | 51/166 [00:19<00:43,  2.65it/s]avg_loss = 1.7759915865384615:  31%|███       | 51/166 [00:19<00:43,  2.65it/s]avg_loss = 1.7759915865384615:  31%|███▏      | 52/166 [00:19<00:42,  2.65it/s]avg_loss = 1.7793337264150944:  31%|███▏      | 52/166 [00:20<00:42,  2.65it/s]avg_loss = 1.7793337264150944:  32%|███▏      | 53/166 [00:20<00:42,  2.65it/s]avg_loss = 1.7800925925925926:  32%|███▏      | 53/166 [00:20<00:42,  2.65it/s]avg_loss = 1.7800925925925926:  33%|███▎      | 54/166 [00:20<00:42,  2.65it/s]avg_loss = 1.7826704545454546:  33%|███▎      | 54/166 [00:20<00:42,  2.65it/s]avg_loss = 1.7826704545454546:  33%|███▎      | 55/166 [00:20<00:41,  2.65it/s]avg_loss = 1.7858537946428572:  33%|███▎      | 55/166 [00:21<00:41,  2.65it/s]avg_loss = 1.7858537946428572:  34%|███▎      | 56/166 [00:21<00:41,  2.65it/s]avg_loss = 1.7809758771929824:  34%|███▎      | 56/166 [00:21<00:41,  2.65it/s]avg_loss = 1.7809758771929824:  34%|███▍      | 57/166 [00:21<00:41,  2.65it/s]avg_loss = 1.7847521551724137:  34%|███▍      | 57/166 [00:21<00:41,  2.65it/s]avg_loss = 1.7847521551724137:  35%|███▍      | 58/166 [00:21<00:40,  2.65it/s]avg_loss = 1.7829713983050848:  35%|███▍      | 58/166 [00:22<00:40,  2.65it/s]avg_loss = 1.7829713983050848:  36%|███▌      | 59/166 [00:22<00:40,  2.65it/s]avg_loss = 1.778515625:  36%|███▌      | 59/166 [00:22<00:40,  2.65it/s]       avg_loss = 1.778515625:  36%|███▌      | 60/166 [00:22<00:40,  2.65it/s]avg_loss = 1.7739497950819672:  36%|███▌      | 60/166 [00:23<00:40,  2.65it/s]avg_loss = 1.7739497950819672:  37%|███▋      | 61/166 [00:23<00:39,  2.65it/s]avg_loss = 1.7697832661290323:  37%|███▋      | 61/166 [00:23<00:39,  2.65it/s]avg_loss = 1.7697832661290323:  37%|███▋      | 62/166 [00:23<00:39,  2.65it/s]avg_loss = 1.7638888888888888:  37%|███▋      | 62/166 [00:23<00:39,  2.65it/s]avg_loss = 1.7638888888888888:  38%|███▊      | 63/166 [00:23<00:38,  2.64it/s]avg_loss = 1.7596435546875:  38%|███▊      | 63/166 [00:24<00:38,  2.64it/s]   avg_loss = 1.7596435546875:  39%|███▊      | 64/166 [00:24<00:38,  2.65it/s]avg_loss = 1.7528846153846154:  39%|███▊      | 64/166 [00:24<00:38,  2.65it/s]avg_loss = 1.7528846153846154:  39%|███▉      | 65/166 [00:24<00:38,  2.64it/s]avg_loss = 1.7457386363636365:  39%|███▉      | 65/166 [00:24<00:38,  2.64it/s]avg_loss = 1.7457386363636365:  40%|███▉      | 66/166 [00:24<00:37,  2.64it/s]avg_loss = 1.7405550373134329:  40%|███▉      | 66/166 [00:25<00:37,  2.64it/s]avg_loss = 1.7405550373134329:  40%|████      | 67/166 [00:25<00:37,  2.64it/s]avg_loss = 1.7390854779411764:  40%|████      | 67/166 [00:25<00:37,  2.64it/s]avg_loss = 1.7390854779411764:  41%|████      | 68/166 [00:25<00:37,  2.64it/s]avg_loss = 1.7410552536231885:  41%|████      | 68/166 [00:26<00:37,  2.64it/s]avg_loss = 1.7410552536231885:  42%|████▏     | 69/166 [00:26<00:36,  2.64it/s]avg_loss = 1.7440848214285714:  42%|████▏     | 69/166 [00:26<00:36,  2.64it/s]avg_loss = 1.7440848214285714:  42%|████▏     | 70/166 [00:26<00:36,  2.64it/s]avg_loss = 1.7479093309859155:  42%|████▏     | 70/166 [00:26<00:36,  2.64it/s]avg_loss = 1.7479093309859155:  43%|████▎     | 71/166 [00:26<00:35,  2.64it/s]avg_loss = 1.7527126736111112:  43%|████▎     | 71/166 [00:27<00:35,  2.64it/s]avg_loss = 1.7527126736111112:  43%|████▎     | 72/166 [00:27<00:35,  2.64it/s]avg_loss = 1.7586686643835616:  43%|████▎     | 72/166 [00:27<00:35,  2.64it/s]avg_loss = 1.7586686643835616:  44%|████▍     | 73/166 [00:27<00:35,  2.64it/s]avg_loss = 1.7531672297297298:  44%|████▍     | 73/166 [00:27<00:35,  2.64it/s]avg_loss = 1.7531672297297298:  45%|████▍     | 74/166 [00:27<00:34,  2.64it/s]avg_loss = 1.7488541666666666:  45%|████▍     | 74/166 [00:28<00:34,  2.64it/s]avg_loss = 1.7488541666666666:  45%|████▌     | 75/166 [00:28<00:34,  2.64it/s]avg_loss = 1.748046875:  45%|████▌     | 75/166 [00:28<00:34,  2.64it/s]       avg_loss = 1.748046875:  46%|████▌     | 76/166 [00:28<00:34,  2.64it/s]avg_loss = 1.7446225649350648:  46%|████▌     | 76/166 [00:29<00:34,  2.64it/s]avg_loss = 1.7446225649350648:  46%|████▋     | 77/166 [00:29<00:33,  2.64it/s]avg_loss = 1.7410857371794872:  46%|████▋     | 77/166 [00:29<00:33,  2.64it/s]avg_loss = 1.7410857371794872:  47%|████▋     | 78/166 [00:29<00:33,  2.64it/s]avg_loss = 1.7384295886075949:  47%|████▋     | 78/166 [00:29<00:33,  2.64it/s]avg_loss = 1.7384295886075949:  48%|████▊     | 79/166 [00:29<00:33,  2.64it/s]avg_loss = 1.73515625:  48%|████▊     | 79/166 [00:30<00:33,  2.64it/s]        avg_loss = 1.73515625:  48%|████▊     | 80/166 [00:30<00:32,  2.64it/s]avg_loss = 1.7259837962962963:  48%|████▊     | 80/166 [00:30<00:32,  2.64it/s]avg_loss = 1.7259837962962963:  49%|████▉     | 81/166 [00:30<00:32,  2.64it/s]avg_loss = 1.727515243902439:  49%|████▉     | 81/166 [00:31<00:32,  2.64it/s] avg_loss = 1.727515243902439:  49%|████▉     | 82/166 [00:31<00:31,  2.64it/s]avg_loss = 1.729480421686747:  49%|████▉     | 82/166 [00:31<00:31,  2.64it/s]avg_loss = 1.729480421686747:  50%|█████     | 83/166 [00:31<00:31,  2.64it/s]avg_loss = 1.732514880952381:  50%|█████     | 83/166 [00:31<00:31,  2.64it/s]avg_loss = 1.732514880952381:  51%|█████     | 84/166 [00:31<00:31,  2.64it/s]avg_loss = 1.7344669117647058:  51%|█████     | 84/166 [00:32<00:31,  2.64it/s]avg_loss = 1.7344669117647058:  51%|█████     | 85/166 [00:32<00:30,  2.64it/s]avg_loss = 1.733375726744186:  51%|█████     | 85/166 [00:32<00:30,  2.64it/s] avg_loss = 1.733375726744186:  52%|█████▏    | 86/166 [00:32<00:30,  2.64it/s]avg_loss = 1.7335668103448276:  52%|█████▏    | 86/166 [00:32<00:30,  2.64it/s]avg_loss = 1.7335668103448276:  52%|█████▏    | 87/166 [00:32<00:29,  2.63it/s]avg_loss = 1.7337535511363635:  52%|█████▏    | 87/166 [00:33<00:29,  2.63it/s]avg_loss = 1.7337535511363635:  53%|█████▎    | 88/166 [00:33<00:29,  2.63it/s]avg_loss = 1.7347261235955056:  53%|█████▎    | 88/166 [00:33<00:29,  2.63it/s]avg_loss = 1.7347261235955056:  54%|█████▎    | 89/166 [00:33<00:29,  2.64it/s]avg_loss = 1.734548611111111:  54%|█████▎    | 89/166 [00:34<00:29,  2.64it/s] avg_loss = 1.734548611111111:  54%|█████▍    | 90/166 [00:34<00:28,  2.63it/s]avg_loss = 1.7349759615384615:  54%|█████▍    | 90/166 [00:34<00:28,  2.63it/s]avg_loss = 1.7349759615384615:  55%|█████▍    | 91/166 [00:34<00:28,  2.64it/s]avg_loss = 1.7357336956521738:  55%|█████▍    | 91/166 [00:34<00:28,  2.64it/s]avg_loss = 1.7357336956521738:  55%|█████▌    | 92/166 [00:34<00:28,  2.64it/s]avg_loss = 1.7395833333333333:  55%|█████▌    | 92/166 [00:35<00:28,  2.64it/s]avg_loss = 1.7395833333333333:  56%|█████▌    | 93/166 [00:35<00:27,  2.63it/s]avg_loss = 1.7386136968085106:  56%|█████▌    | 93/166 [00:35<00:27,  2.63it/s]avg_loss = 1.7386136968085106:  57%|█████▋    | 94/166 [00:35<00:27,  2.64it/s]avg_loss = 1.737828947368421:  57%|█████▋    | 94/166 [00:35<00:27,  2.64it/s] avg_loss = 1.737828947368421:  57%|█████▋    | 95/166 [00:35<00:26,  2.63it/s]avg_loss = 1.7374674479166667:  57%|█████▋    | 95/166 [00:36<00:26,  2.63it/s]avg_loss = 1.7374674479166667:  58%|█████▊    | 96/166 [00:36<00:26,  2.63it/s]avg_loss = 1.7372744845360826:  58%|█████▊    | 96/166 [00:36<00:26,  2.63it/s]avg_loss = 1.7372744845360826:  58%|█████▊    | 97/166 [00:36<00:26,  2.63it/s]avg_loss = 1.7354910714285714:  58%|█████▊    | 97/166 [00:37<00:26,  2.63it/s]avg_loss = 1.7354910714285714:  59%|█████▉    | 98/166 [00:37<00:25,  2.63it/s]avg_loss = 1.7329545454545454:  59%|█████▉    | 98/166 [00:37<00:25,  2.63it/s]avg_loss = 1.7329545454545454:  60%|█████▉    | 99/166 [00:37<00:25,  2.63it/s]avg_loss = 1.7303125:  60%|█████▉    | 99/166 [00:37<00:25,  2.63it/s]         avg_loss = 1.7303125:  60%|██████    | 100/166 [00:37<00:25,  2.63it/s]avg_loss = 1.7307394801980198:  60%|██████    | 100/166 [00:38<00:25,  2.63it/s]avg_loss = 1.7307394801980198:  61%|██████    | 101/166 [00:38<00:24,  2.63it/s]avg_loss = 1.7316942401960784:  61%|██████    | 101/166 [00:38<00:24,  2.63it/s]avg_loss = 1.7316942401960784:  61%|██████▏   | 102/166 [00:38<00:24,  2.63it/s]avg_loss = 1.7328580097087378:  61%|██████▏   | 102/166 [00:39<00:24,  2.63it/s]avg_loss = 1.7328580097087378:  62%|██████▏   | 103/166 [00:39<00:23,  2.63it/s]avg_loss = 1.7351262019230769:  62%|██████▏   | 103/166 [00:39<00:23,  2.63it/s]avg_loss = 1.7351262019230769:  63%|██████▎   | 104/166 [00:39<00:23,  2.63it/s]avg_loss = 1.7416666666666667:  63%|██████▎   | 104/166 [00:39<00:23,  2.63it/s]avg_loss = 1.7416666666666667:  63%|██████▎   | 105/166 [00:39<00:23,  2.62it/s]avg_loss = 1.7469044811320755:  63%|██████▎   | 105/166 [00:40<00:23,  2.62it/s]avg_loss = 1.7469044811320755:  64%|██████▍   | 106/166 [00:40<00:22,  2.63it/s]avg_loss = 1.7505841121495327:  64%|██████▍   | 106/166 [00:40<00:22,  2.63it/s]avg_loss = 1.7505841121495327:  64%|██████▍   | 107/166 [00:40<00:22,  2.62it/s]avg_loss = 1.7537615740740742:  64%|██████▍   | 107/166 [00:40<00:22,  2.62it/s]avg_loss = 1.7537615740740742:  65%|██████▌   | 108/166 [00:40<00:22,  2.62it/s]avg_loss = 1.7584575688073394:  65%|██████▌   | 108/166 [00:41<00:22,  2.62it/s]avg_loss = 1.7584575688073394:  66%|██████▌   | 109/166 [00:41<00:21,  2.63it/s]avg_loss = 1.7619318181818182:  66%|██████▌   | 109/166 [00:41<00:21,  2.63it/s]avg_loss = 1.7619318181818182:  66%|██████▋   | 110/166 [00:41<00:21,  2.62it/s]avg_loss = 1.7633727477477477:  66%|██████▋   | 110/166 [00:42<00:21,  2.62it/s]avg_loss = 1.7633727477477477:  67%|██████▋   | 111/166 [00:42<00:20,  2.62it/s]avg_loss = 1.7647879464285714:  67%|██████▋   | 111/166 [00:42<00:20,  2.62it/s]avg_loss = 1.7647879464285714:  67%|██████▋   | 112/166 [00:42<00:20,  2.62it/s]avg_loss = 1.7650027654867257:  67%|██████▋   | 112/166 [00:42<00:20,  2.62it/s]avg_loss = 1.7650027654867257:  68%|██████▊   | 113/166 [00:42<00:20,  2.62it/s]avg_loss = 1.7663103070175439:  68%|██████▊   | 113/166 [00:43<00:20,  2.62it/s]avg_loss = 1.7663103070175439:  69%|██████▊   | 114/166 [00:43<00:19,  2.62it/s]avg_loss = 1.7634510869565216:  69%|██████▊   | 114/166 [00:43<00:19,  2.62it/s]avg_loss = 1.7634510869565216:  69%|██████▉   | 115/166 [00:43<00:19,  2.63it/s]avg_loss = 1.7629310344827587:  69%|██████▉   | 115/166 [00:43<00:19,  2.63it/s]avg_loss = 1.7629310344827587:  70%|██████▉   | 116/166 [00:43<00:19,  2.63it/s]avg_loss = 1.7638888888888888:  70%|██████▉   | 116/166 [00:44<00:19,  2.63it/s]avg_loss = 1.7638888888888888:  70%|███████   | 117/166 [00:44<00:18,  2.63it/s]avg_loss = 1.7640360169491525:  70%|███████   | 117/166 [00:44<00:18,  2.63it/s]avg_loss = 1.7640360169491525:  71%|███████   | 118/166 [00:44<00:18,  2.64it/s]avg_loss = 1.7635898109243697:  71%|███████   | 118/166 [00:45<00:18,  2.64it/s]avg_loss = 1.7635898109243697:  72%|███████▏  | 119/166 [00:45<00:17,  2.63it/s]avg_loss = 1.7643229166666667:  72%|███████▏  | 119/166 [00:45<00:17,  2.63it/s]avg_loss = 1.7643229166666667:  72%|███████▏  | 120/166 [00:45<00:17,  2.64it/s]avg_loss = 1.763881714876033:  72%|███████▏  | 120/166 [00:45<00:17,  2.64it/s] avg_loss = 1.763881714876033:  73%|███████▎  | 121/166 [00:45<00:17,  2.64it/s]avg_loss = 1.7645363729508197:  73%|███████▎  | 121/166 [00:46<00:17,  2.64it/s]avg_loss = 1.7645363729508197:  73%|███████▎  | 122/166 [00:46<00:16,  2.63it/s]avg_loss = 1.7647992886178863:  73%|███████▎  | 122/166 [00:46<00:16,  2.63it/s]avg_loss = 1.7647992886178863:  74%|███████▍  | 123/166 [00:46<00:16,  2.64it/s]avg_loss = 1.7633568548387097:  74%|███████▍  | 123/166 [00:46<00:16,  2.64it/s]avg_loss = 1.7633568548387097:  75%|███████▍  | 124/166 [00:46<00:15,  2.64it/s]avg_loss = 1.76175:  75%|███████▍  | 124/166 [00:47<00:15,  2.64it/s]           avg_loss = 1.76175:  75%|███████▌  | 125/166 [00:47<00:15,  2.63it/s]avg_loss = 1.7596106150793651:  75%|███████▌  | 125/166 [00:47<00:15,  2.63it/s]avg_loss = 1.7596106150793651:  76%|███████▌  | 126/166 [00:47<00:15,  2.64it/s]avg_loss = 1.757566437007874:  76%|███████▌  | 126/166 [00:48<00:15,  2.64it/s] avg_loss = 1.757566437007874:  77%|███████▋  | 127/166 [00:48<00:14,  2.63it/s]avg_loss = 1.7562255859375:  77%|███████▋  | 127/166 [00:48<00:14,  2.63it/s]  avg_loss = 1.7562255859375:  77%|███████▋  | 128/166 [00:48<00:14,  2.63it/s]avg_loss = 1.7550266472868217:  77%|███████▋  | 128/166 [00:48<00:14,  2.63it/s]avg_loss = 1.7550266472868217:  78%|███████▊  | 129/166 [00:48<00:14,  2.64it/s]avg_loss = 1.7549278846153846:  78%|███████▊  | 129/166 [00:49<00:14,  2.64it/s]avg_loss = 1.7549278846153846:  78%|███████▊  | 130/166 [00:49<00:13,  2.63it/s]avg_loss = 1.7559637404580153:  78%|███████▊  | 130/166 [00:49<00:13,  2.63it/s]avg_loss = 1.7559637404580153:  79%|███████▉  | 131/166 [00:49<00:13,  2.63it/s]avg_loss = 1.7565104166666667:  79%|███████▉  | 131/166 [00:50<00:13,  2.63it/s]avg_loss = 1.7565104166666667:  80%|███████▉  | 132/166 [00:50<00:12,  2.63it/s]avg_loss = 1.7574013157894737:  80%|███████▉  | 132/166 [00:50<00:12,  2.63it/s]avg_loss = 1.7574013157894737:  80%|████████  | 133/166 [00:50<00:12,  2.63it/s]avg_loss = 1.7586870335820894:  80%|████████  | 133/166 [00:50<00:12,  2.63it/s]avg_loss = 1.7586870335820894:  81%|████████  | 134/166 [00:50<00:12,  2.63it/s]avg_loss = 1.756712962962963:  81%|████████  | 134/166 [00:51<00:12,  2.63it/s] avg_loss = 1.756712962962963:  81%|████████▏ | 135/166 [00:51<00:11,  2.63it/s]avg_loss = 1.7568933823529411:  81%|████████▏ | 135/166 [00:51<00:11,  2.63it/s]avg_loss = 1.7568933823529411:  82%|████████▏ | 136/166 [00:51<00:11,  2.63it/s]avg_loss = 1.7571281934306568:  82%|████████▏ | 136/166 [00:51<00:11,  2.63it/s]avg_loss = 1.7571281934306568:  83%|████████▎ | 137/166 [00:51<00:11,  2.63it/s]avg_loss = 1.7579257246376812:  83%|████████▎ | 137/166 [00:52<00:11,  2.63it/s]avg_loss = 1.7579257246376812:  83%|████████▎ | 138/166 [00:52<00:10,  2.63it/s]avg_loss = 1.7569694244604317:  83%|████████▎ | 138/166 [00:52<00:10,  2.63it/s]avg_loss = 1.7569694244604317:  84%|████████▎ | 139/166 [00:52<00:10,  2.63it/s]avg_loss = 1.7556919642857143:  84%|████████▎ | 139/166 [00:53<00:10,  2.63it/s]avg_loss = 1.7556919642857143:  84%|████████▍ | 140/166 [00:53<00:09,  2.63it/s]avg_loss = 1.7543218085106382:  84%|████████▍ | 140/166 [00:53<00:09,  2.63it/s]avg_loss = 1.7543218085106382:  85%|████████▍ | 141/166 [00:53<00:09,  2.63it/s]avg_loss = 1.7539612676056338:  85%|████████▍ | 141/166 [00:53<00:09,  2.63it/s]avg_loss = 1.7539612676056338:  86%|████████▌ | 142/166 [00:53<00:09,  2.63it/s]avg_loss = 1.7522399475524475:  86%|████████▌ | 142/166 [00:54<00:09,  2.63it/s]avg_loss = 1.7522399475524475:  86%|████████▌ | 143/166 [00:54<00:08,  2.63it/s]avg_loss = 1.75341796875:  86%|████████▌ | 143/166 [00:54<00:08,  2.63it/s]     avg_loss = 1.75341796875:  87%|████████▋ | 144/166 [00:54<00:08,  2.63it/s]avg_loss = 1.7525862068965516:  87%|████████▋ | 144/166 [00:54<00:08,  2.63it/s]avg_loss = 1.7525862068965516:  87%|████████▋ | 145/166 [00:54<00:07,  2.63it/s]avg_loss = 1.7525149828767124:  87%|████████▋ | 145/166 [00:55<00:07,  2.63it/s]avg_loss = 1.7525149828767124:  88%|████████▊ | 146/166 [00:55<00:07,  2.63it/s]avg_loss = 1.7513818027210883:  88%|████████▊ | 146/166 [00:55<00:07,  2.63it/s]avg_loss = 1.7513818027210883:  89%|████████▊ | 147/166 [00:55<00:07,  2.63it/s]avg_loss = 1.7505278716216217:  89%|████████▊ | 147/166 [00:56<00:07,  2.63it/s]avg_loss = 1.7505278716216217:  89%|████████▉ | 148/166 [00:56<00:06,  2.63it/s]avg_loss = 1.7487940436241611:  89%|████████▉ | 148/166 [00:56<00:06,  2.63it/s]avg_loss = 1.7487940436241611:  90%|████████▉ | 149/166 [00:56<00:06,  2.63it/s]avg_loss = 1.7496875:  90%|████████▉ | 149/166 [00:56<00:06,  2.63it/s]         avg_loss = 1.7496875:  90%|█████████ | 150/166 [00:56<00:06,  2.63it/s]avg_loss = 1.7488617549668874:  90%|█████████ | 150/166 [00:57<00:06,  2.63it/s]avg_loss = 1.7488617549668874:  91%|█████████ | 151/166 [00:57<00:05,  2.62it/s]avg_loss = 1.7486636513157894:  91%|█████████ | 151/166 [00:57<00:05,  2.62it/s]avg_loss = 1.7486636513157894:  92%|█████████▏| 152/166 [00:57<00:05,  2.62it/s]avg_loss = 1.748468137254902:  92%|█████████▏| 152/166 [00:58<00:05,  2.62it/s] avg_loss = 1.748468137254902:  92%|█████████▏| 153/166 [00:58<00:04,  2.63it/s]avg_loss = 1.7500507305194806:  92%|█████████▏| 153/166 [00:58<00:04,  2.63it/s]avg_loss = 1.7500507305194806:  93%|█████████▎| 154/166 [00:58<00:04,  2.62it/s]avg_loss = 1.7494959677419355:  93%|█████████▎| 154/166 [00:58<00:04,  2.62it/s]avg_loss = 1.7494959677419355:  93%|█████████▎| 155/166 [00:58<00:04,  2.62it/s]avg_loss = 1.7493489583333333:  93%|█████████▎| 155/166 [00:59<00:04,  2.62it/s]avg_loss = 1.7493489583333333:  94%|█████████▍| 156/166 [00:59<00:03,  2.62it/s]avg_loss = 1.7475119426751593:  94%|█████████▍| 156/166 [00:59<00:03,  2.62it/s]avg_loss = 1.7475119426751593:  95%|█████████▍| 157/166 [00:59<00:03,  2.62it/s]avg_loss = 1.7430775316455696:  95%|█████████▍| 157/166 [00:59<00:03,  2.62it/s]avg_loss = 1.7430775316455696:  95%|█████████▌| 158/166 [00:59<00:03,  2.62it/s]avg_loss = 1.7437106918238994:  95%|█████████▌| 158/166 [01:00<00:03,  2.62it/s]avg_loss = 1.7437106918238994:  96%|█████████▌| 159/166 [01:00<00:02,  2.62it/s]avg_loss = 1.745068359375:  96%|█████████▌| 159/166 [01:00<00:02,  2.62it/s]    avg_loss = 1.745068359375:  96%|█████████▋| 160/166 [01:00<00:02,  2.62it/s]avg_loss = 1.7473311335403727:  96%|█████████▋| 160/166 [01:01<00:02,  2.62it/s]avg_loss = 1.7473311335403727:  97%|█████████▋| 161/166 [01:01<00:01,  2.62it/s]avg_loss = 1.7476851851851851:  97%|█████████▋| 161/166 [01:01<00:01,  2.62it/s]avg_loss = 1.7476851851851851:  98%|█████████▊| 162/166 [01:01<00:01,  2.62it/s]avg_loss = 1.747411809815951:  98%|█████████▊| 162/166 [01:01<00:01,  2.62it/s] avg_loss = 1.747411809815951:  98%|█████████▊| 163/166 [01:01<00:01,  2.62it/s]avg_loss = 1.748046875:  98%|█████████▊| 163/166 [01:02<00:01,  2.62it/s]      avg_loss = 1.748046875:  99%|█████████▉| 164/166 [01:02<00:00,  2.62it/s]avg_loss = 1.748248106060606:  99%|█████████▉| 164/166 [01:02<00:00,  2.62it/s]avg_loss = 1.748248106060606:  99%|█████████▉| 165/166 [01:02<00:00,  2.62it/s]avg_loss = 1.7501411897590362:  99%|█████████▉| 165/166 [01:02<00:00,  2.62it/s]avg_loss = 1.7501411897590362: 100%|██████████| 166/166 [01:02<00:00,  2.62it/s]avg_loss = 1.7501411897590362: 100%|██████████| 166/166 [01:02<00:00,  2.64it/s]
I0303 02:44:38.282953 2884153 eval_ppl.py:105] wikitext2 perplexity: 5.755414962768555
wikitext2 perplexity: 5.755
