Running with lmbda=50
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.71it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  9.24it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.34it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.26it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.73it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.01it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.28it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:26,  1.18it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:25,  1.18it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:02<00:24,  1.18it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:03<00:23,  1.18it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:04<00:22,  1.20it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:05<00:21,  1.20it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:05<00:21,  1.15it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:06<00:21,  1.14it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:07<00:20,  1.14it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:08<00:19,  1.15it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:09<00:20,  1.01it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:10<00:19,  1.03it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:11<00:18,  1.02it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:12<00:17,  1.01it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:13<00:17,  1.01s/it]calculating model weight mean & std:  50%|█████     | 16/32 [00:14<00:15,  1.02it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:15<00:14,  1.04it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:16<00:13,  1.07it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:17<00:12,  1.08it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:18<00:11,  1.07it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:19<00:10,  1.07it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:20<00:09,  1.07it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:21<00:09,  1.02s/it]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:22<00:08,  1.05s/it]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:23<00:07,  1.10s/it]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:24<00:06,  1.04s/it]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:25<00:04,  1.03it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:26<00:03,  1.09it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:27<00:02,  1.16it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:27<00:01,  1.22it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:28<00:00,  1.28it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:29<00:00,  1.24it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:29<00:00,  1.09it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 03:24:23 - INFO - layer0_self_attn.q_proj | mse: 0.07544674099636985, bpp_loss: 2.896824935945915, bpp: 0
2025-03-03 03:24:31 - INFO - layer0_self_attn.k_proj | mse: 0.0894404184253129, bpp_loss: 3.408577291382244, bpp: 0
2025-03-03 03:24:40 - INFO - layer0_self_attn.v_proj | mse: 0.05822167910903707, bpp_loss: 2.102373615896795, bpp: 0
2025-03-03 03:24:49 - INFO - layer0_self_attn.o_proj | mse: 0.04559334018155815, bpp_loss: 2.182153780653607, bpp: 0
2025-03-03 03:25:00 - INFO - layer0_mlp.gate_proj | mse: 0.04668447360381667, bpp_loss: 2.579003306438348, bpp: 0
2025-03-03 03:25:12 - INFO - layer0_mlp.up_proj | mse: 0.0457847183998378, bpp_loss: 2.4711522619971737, bpp: 0
2025-03-03 03:25:50 - INFO - layer0_mlp.down_proj | mse: 0.04506948659755587, bpp_loss: 2.4630474917524094, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:36<50:02, 96.84s/it]2025-03-03 03:26:00 - INFO - layer1_self_attn.q_proj | mse: 0.06356555803869936, bpp_loss: 3.1252029285242315, bpp: 0
2025-03-03 03:26:09 - INFO - layer1_self_attn.k_proj | mse: 0.07089877816000367, bpp_loss: 3.7468247181968763, bpp: 0
2025-03-03 03:26:17 - INFO - layer1_self_attn.v_proj | mse: 0.05321757692009905, bpp_loss: 2.2071682663226966, bpp: 0
2025-03-03 03:26:26 - INFO - layer1_self_attn.o_proj | mse: 0.05364369132348033, bpp_loss: 2.267470010352554, bpp: 0
2025-03-03 03:26:38 - INFO - layer1_mlp.gate_proj | mse: 0.04742763951828041, bpp_loss: 2.5891405303762958, bpp: 0
2025-03-03 03:26:49 - INFO - layer1_mlp.up_proj | mse: 0.04642118044238077, bpp_loss: 2.4852692356133566, bpp: 0
2025-03-03 03:27:28 - INFO - layer1_mlp.down_proj | mse: 0.03993794019507862, bpp_loss: 2.472902633981513, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [03:14<48:32, 97.10s/it]2025-03-03 03:27:37 - INFO - layer2_self_attn.q_proj | mse: 0.053926321002478135, bpp_loss: 3.072531342302682, bpp: 0
2025-03-03 03:27:46 - INFO - layer2_self_attn.k_proj | mse: 0.06064001436437449, bpp_loss: 3.8436680138111115, bpp: 0
2025-03-03 03:27:55 - INFO - layer2_self_attn.v_proj | mse: 0.04418641753105103, bpp_loss: 2.1097059304302093, bpp: 0
2025-03-03 03:28:04 - INFO - layer2_self_attn.o_proj | mse: 0.043160725403395536, bpp_loss: 2.2203054096607957, bpp: 0
2025-03-03 03:28:15 - INFO - layer2_mlp.gate_proj | mse: 0.04538732031013211, bpp_loss: 2.6177708488955562, bpp: 0
2025-03-03 03:28:26 - INFO - layer2_mlp.up_proj | mse: 0.04406382544995253, bpp_loss: 2.4752959043585827, bpp: 0
2025-03-03 03:29:05 - INFO - layer2_mlp.down_proj | mse: 0.04263220633926665, bpp_loss: 2.479440966072226, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:51<47:02, 97.33s/it]2025-03-03 03:29:15 - INFO - layer3_self_attn.q_proj | mse: 0.050458056961348564, bpp_loss: 3.1104067678097636, bpp: 0
2025-03-03 03:29:24 - INFO - layer3_self_attn.k_proj | mse: 0.057159223511174286, bpp_loss: 3.9146750439540483, bpp: 0
2025-03-03 03:29:32 - INFO - layer3_self_attn.v_proj | mse: 0.04186794333308517, bpp_loss: 2.2057681008882355, bpp: 0
2025-03-03 03:29:41 - INFO - layer3_self_attn.o_proj | mse: 0.04577828448215411, bpp_loss: 2.3159885678905994, bpp: 0
2025-03-03 03:29:52 - INFO - layer3_mlp.gate_proj | mse: 0.04604768047069432, bpp_loss: 2.6884478995509977, bpp: 0
2025-03-03 03:30:04 - INFO - layer3_mlp.up_proj | mse: 0.04388294073372292, bpp_loss: 2.4573952413297127, bpp: 0
2025-03-03 03:30:42 - INFO - layer3_mlp.down_proj | mse: 0.04204029915599009, bpp_loss: 2.4558103675122505, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [06:28<45:19, 97.11s/it]2025-03-03 03:30:51 - INFO - layer4_self_attn.q_proj | mse: 0.0500650905190478, bpp_loss: 3.076181879208889, bpp: 0
2025-03-03 03:31:00 - INFO - layer4_self_attn.k_proj | mse: 0.056812719837603574, bpp_loss: 3.8984389221586753, bpp: 0
2025-03-03 03:31:08 - INFO - layer4_self_attn.v_proj | mse: 0.04243473812364263, bpp_loss: 2.24935636628652, bpp: 0
2025-03-03 03:31:18 - INFO - layer4_self_attn.o_proj | mse: 0.0476088503587307, bpp_loss: 2.3243653606041335, bpp: 0
2025-03-03 03:31:29 - INFO - layer4_mlp.gate_proj | mse: 0.04630458358394829, bpp_loss: 2.7557013908268084, bpp: 0
2025-03-03 03:31:40 - INFO - layer4_mlp.up_proj | mse: 0.0432565041139234, bpp_loss: 2.4300567241319055, bpp: 0
2025-03-03 03:32:19 - INFO - layer4_mlp.down_proj | mse: 0.04273116269163007, bpp_loss: 2.4326557572598437, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [08:05<43:37, 96.94s/it]2025-03-03 03:32:28 - INFO - layer5_self_attn.q_proj | mse: 0.05041847177167857, bpp_loss: 3.0524312973138876, bpp: 0
2025-03-03 03:32:37 - INFO - layer5_self_attn.k_proj | mse: 0.05722099425284172, bpp_loss: 3.8718212639796548, bpp: 0
2025-03-03 03:32:45 - INFO - layer5_self_attn.v_proj | mse: 0.04172007828033657, bpp_loss: 2.1372151252871845, bpp: 0
2025-03-03 03:32:54 - INFO - layer5_self_attn.o_proj | mse: 0.04852074086017009, bpp_loss: 2.27627827131073, bpp: 0
2025-03-03 03:33:06 - INFO - layer5_mlp.gate_proj | mse: 0.04595648819241723, bpp_loss: 2.7579522626141886, bpp: 0
2025-03-03 03:33:17 - INFO - layer5_mlp.up_proj | mse: 0.04300891126776144, bpp_loss: 2.4346361719737097, bpp: 0
2025-03-03 03:33:56 - INFO - layer5_mlp.down_proj | mse: 0.042938600872325504, bpp_loss: 2.4373469372928542, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [09:42<42:06, 97.16s/it]2025-03-03 03:34:06 - INFO - layer6_self_attn.q_proj | mse: 0.04992659450196905, bpp_loss: 3.0963760472950526, bpp: 0
2025-03-03 03:34:15 - INFO - layer6_self_attn.k_proj | mse: 0.05659631655174513, bpp_loss: 3.9404475062619895, bpp: 0
2025-03-03 03:34:23 - INFO - layer6_self_attn.v_proj | mse: 0.041426422457319145, bpp_loss: 2.18269335932564, bpp: 0
2025-03-03 03:34:32 - INFO - layer6_self_attn.o_proj | mse: 0.04913245139872547, bpp_loss: 2.3044550033519045, bpp: 0
2025-03-03 03:34:44 - INFO - layer6_mlp.gate_proj | mse: 0.045978413010583405, bpp_loss: 2.7623316126077304, bpp: 0
2025-03-03 03:34:55 - INFO - layer6_mlp.up_proj | mse: 0.042987721470681486, bpp_loss: 2.4339684798116132, bpp: 0
2025-03-03 03:35:34 - INFO - layer6_mlp.down_proj | mse: 0.0433186398829546, bpp_loss: 2.437946541966604, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [11:20<40:35, 97.43s/it]2025-03-03 03:35:44 - INFO - layer7_self_attn.q_proj | mse: 0.04962265417782981, bpp_loss: 3.0264538311748765, bpp: 0
2025-03-03 03:35:53 - INFO - layer7_self_attn.k_proj | mse: 0.05732280791690513, bpp_loss: 3.961349480319768, bpp: 0
2025-03-03 03:36:01 - INFO - layer7_self_attn.v_proj | mse: 0.04161277761764647, bpp_loss: 2.180993578163907, bpp: 0
2025-03-03 03:36:10 - INFO - layer7_self_attn.o_proj | mse: 0.05035623750320001, bpp_loss: 2.315911970101297, bpp: 0
2025-03-03 03:36:22 - INFO - layer7_mlp.gate_proj | mse: 0.045769789525613815, bpp_loss: 2.7346950241896724, bpp: 0
2025-03-03 03:36:33 - INFO - layer7_mlp.up_proj | mse: 0.043109784634579436, bpp_loss: 2.446441894463663, bpp: 0
2025-03-03 03:37:12 - INFO - layer7_mlp.down_proj | mse: 0.043375027919527846, bpp_loss: 2.4504895935699875, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [12:58<39:02, 97.59s/it]2025-03-03 03:37:22 - INFO - layer8_self_attn.q_proj | mse: 0.04939454104590534, bpp_loss: 3.012814889079891, bpp: 0
2025-03-03 03:37:31 - INFO - layer8_self_attn.k_proj | mse: 0.05645284920961707, bpp_loss: 3.877518267952837, bpp: 0
2025-03-03 03:37:39 - INFO - layer8_self_attn.v_proj | mse: 0.04176558212797611, bpp_loss: 2.200288971653208, bpp: 0
2025-03-03 03:37:48 - INFO - layer8_self_attn.o_proj | mse: 0.053057156084854125, bpp_loss: 2.326462372962851, bpp: 0
2025-03-03 03:38:00 - INFO - layer8_mlp.gate_proj | mse: 0.045564099503177476, bpp_loss: 2.7390997525570646, bpp: 0
2025-03-03 03:38:11 - INFO - layer8_mlp.up_proj | mse: 0.04284876937632964, bpp_loss: 2.442334472235026, bpp: 0
2025-03-03 03:38:50 - INFO - layer8_mlp.down_proj | mse: 0.043484999655467045, bpp_loss: 2.448937731013367, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [14:36<37:27, 97.70s/it]2025-03-03 03:39:00 - INFO - layer9_self_attn.q_proj | mse: 0.049030226354617186, bpp_loss: 3.0243078399798833, bpp: 0
2025-03-03 03:39:09 - INFO - layer9_self_attn.k_proj | mse: 0.05610749855898903, bpp_loss: 3.8970554143888876, bpp: 0
2025-03-03 03:39:17 - INFO - layer9_self_attn.v_proj | mse: 0.04234947236673634, bpp_loss: 2.2985360310121905, bpp: 0
2025-03-03 03:39:26 - INFO - layer9_self_attn.o_proj | mse: 0.05375806077004008, bpp_loss: 2.37918315269053, bpp: 0
2025-03-03 03:39:38 - INFO - layer9_mlp.gate_proj | mse: 0.04568626530515503, bpp_loss: 2.7516848065757324, bpp: 0
2025-03-03 03:39:49 - INFO - layer9_mlp.up_proj | mse: 0.04291793088745516, bpp_loss: 2.451420687105773, bpp: 0
2025-03-03 03:40:29 - INFO - layer9_mlp.down_proj | mse: 0.043683273248925396, bpp_loss: 2.4510653531511446, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [16:15<35:56, 98.03s/it]2025-03-03 03:40:38 - INFO - layer10_self_attn.q_proj | mse: 0.04927055921209991, bpp_loss: 3.02163430681685, bpp: 0
2025-03-03 03:40:47 - INFO - layer10_self_attn.k_proj | mse: 0.056331387802847126, bpp_loss: 3.8953039869084023, bpp: 0
2025-03-03 03:40:56 - INFO - layer10_self_attn.v_proj | mse: 0.0415100658703865, bpp_loss: 2.1908796493371483, bpp: 0
2025-03-03 03:41:05 - INFO - layer10_self_attn.o_proj | mse: 0.05123466136887623, bpp_loss: 2.318659898592159, bpp: 0
2025-03-03 03:41:16 - INFO - layer10_mlp.gate_proj | mse: 0.0454555978094107, bpp_loss: 2.7236955582962503, bpp: 0
2025-03-03 03:41:28 - INFO - layer10_mlp.up_proj | mse: 0.04311453578439346, bpp_loss: 2.468528101420296, bpp: 0
2025-03-03 03:42:07 - INFO - layer10_mlp.down_proj | mse: 0.04367303923911694, bpp_loss: 2.4663557540459027, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [17:53<34:16, 97.95s/it]2025-03-03 03:42:16 - INFO - layer11_self_attn.q_proj | mse: 0.048438357660620476, bpp_loss: 2.968293502461165, bpp: 0
2025-03-03 03:42:25 - INFO - layer11_self_attn.k_proj | mse: 0.05600343678989166, bpp_loss: 3.895720167318359, bpp: 0
2025-03-03 03:42:33 - INFO - layer11_self_attn.v_proj | mse: 0.04119420711311623, bpp_loss: 2.1979532760742586, bpp: 0
2025-03-03 03:42:43 - INFO - layer11_self_attn.o_proj | mse: 0.05060505290132631, bpp_loss: 2.3383301308494993, bpp: 0
2025-03-03 03:42:54 - INFO - layer11_mlp.gate_proj | mse: 0.045236018537169596, bpp_loss: 2.702562184405646, bpp: 0
2025-03-03 03:43:05 - INFO - layer11_mlp.up_proj | mse: 0.04314922745530031, bpp_loss: 2.472359685825982, bpp: 0
2025-03-03 03:43:44 - INFO - layer11_mlp.down_proj | mse: 0.04366772854622378, bpp_loss: 2.4734290407005965, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [19:30<32:34, 97.75s/it]2025-03-03 03:43:53 - INFO - layer12_self_attn.q_proj | mse: 0.04900521908315703, bpp_loss: 3.0255750300129876, bpp: 0
2025-03-03 03:44:02 - INFO - layer12_self_attn.k_proj | mse: 0.05618100811714818, bpp_loss: 3.896545999450609, bpp: 0
2025-03-03 03:44:11 - INFO - layer12_self_attn.v_proj | mse: 0.04247828646754774, bpp_loss: 2.3133602428715676, bpp: 0
2025-03-03 03:44:20 - INFO - layer12_self_attn.o_proj | mse: 0.05178806602867734, bpp_loss: 2.38349483453203, bpp: 0
2025-03-03 03:44:31 - INFO - layer12_mlp.gate_proj | mse: 0.045138836830311634, bpp_loss: 2.683256936459137, bpp: 0
2025-03-03 03:44:42 - INFO - layer12_mlp.up_proj | mse: 0.04341112010358545, bpp_loss: 2.4903812728423094, bpp: 0
2025-03-03 03:45:21 - INFO - layer12_mlp.down_proj | mse: 0.044235343613691636, bpp_loss: 2.4853877144466554, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [21:07<30:55, 97.65s/it]2025-03-03 03:45:31 - INFO - layer13_self_attn.q_proj | mse: 0.049479650362512874, bpp_loss: 2.9972926870104857, bpp: 0
2025-03-03 03:45:40 - INFO - layer13_self_attn.k_proj | mse: 0.05692285380792667, bpp_loss: 3.909381015575491, bpp: 0
2025-03-03 03:45:48 - INFO - layer13_self_attn.v_proj | mse: 0.04250327925379504, bpp_loss: 2.2547182810958475, bpp: 0
2025-03-03 03:45:57 - INFO - layer13_self_attn.o_proj | mse: 0.052463216005420206, bpp_loss: 2.3648783063399605, bpp: 0
2025-03-03 03:46:09 - INFO - layer13_mlp.gate_proj | mse: 0.045613951811713876, bpp_loss: 2.6882145533870374, bpp: 0
2025-03-03 03:46:20 - INFO - layer13_mlp.up_proj | mse: 0.04386032393624586, bpp_loss: 2.49425835288795, bpp: 0
2025-03-03 03:46:59 - INFO - layer13_mlp.down_proj | mse: 0.044531709413101236, bpp_loss: 2.4856990548848574, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [22:45<29:20, 97.79s/it]2025-03-03 03:47:09 - INFO - layer14_self_attn.q_proj | mse: 0.04941181321370485, bpp_loss: 2.9690572432009503, bpp: 0
2025-03-03 03:47:18 - INFO - layer14_self_attn.k_proj | mse: 0.05678941602717431, bpp_loss: 3.859764441207517, bpp: 0
2025-03-03 03:47:26 - INFO - layer14_self_attn.v_proj | mse: 0.042358059200912415, bpp_loss: 2.247030210419325, bpp: 0
2025-03-03 03:47:36 - INFO - layer14_self_attn.o_proj | mse: 0.05216966447593529, bpp_loss: 2.356076235708315, bpp: 0
2025-03-03 03:47:47 - INFO - layer14_mlp.gate_proj | mse: 0.04578571167157593, bpp_loss: 2.716214573542987, bpp: 0
2025-03-03 03:47:58 - INFO - layer14_mlp.up_proj | mse: 0.04374523685085532, bpp_loss: 2.488306972497542, bpp: 0
2025-03-03 03:48:37 - INFO - layer14_mlp.down_proj | mse: 0.044316616418210664, bpp_loss: 2.481452876302813, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [24:23<27:42, 97.77s/it]2025-03-03 03:48:47 - INFO - layer15_self_attn.q_proj | mse: 0.050053143115491076, bpp_loss: 3.0908893471350893, bpp: 0
2025-03-03 03:48:55 - INFO - layer15_self_attn.k_proj | mse: 0.05665934460988774, bpp_loss: 3.905132549116388, bpp: 0
2025-03-03 03:49:04 - INFO - layer15_self_attn.v_proj | mse: 0.04266134479343094, bpp_loss: 2.3074235887324903, bpp: 0
2025-03-03 03:49:13 - INFO - layer15_self_attn.o_proj | mse: 0.04933453750020532, bpp_loss: 2.3857089919038117, bpp: 0
2025-03-03 03:49:24 - INFO - layer15_mlp.gate_proj | mse: 0.04636863636743406, bpp_loss: 2.7524860820599963, bpp: 0
2025-03-03 03:49:36 - INFO - layer15_mlp.up_proj | mse: 0.04393605759537195, bpp_loss: 2.481910583297057, bpp: 0
2025-03-03 03:50:15 - INFO - layer15_mlp.down_proj | mse: 0.04462382212318898, bpp_loss: 2.4765734480627413, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [26:01<26:03, 97.70s/it]2025-03-03 03:50:24 - INFO - layer16_self_attn.q_proj | mse: 0.050635686229456474, bpp_loss: 3.070151047199033, bpp: 0
2025-03-03 03:50:33 - INFO - layer16_self_attn.k_proj | mse: 0.057345636612353, bpp_loss: 3.896523794042878, bpp: 0
2025-03-03 03:50:42 - INFO - layer16_self_attn.v_proj | mse: 0.04280696753523073, bpp_loss: 2.2659329045854975, bpp: 0
2025-03-03 03:50:51 - INFO - layer16_self_attn.o_proj | mse: 0.05226118205070661, bpp_loss: 2.368117391190026, bpp: 0
2025-03-03 03:51:02 - INFO - layer16_mlp.gate_proj | mse: 0.04645713356839504, bpp_loss: 2.7842104144926583, bpp: 0
2025-03-03 03:51:14 - INFO - layer16_mlp.up_proj | mse: 0.04355592256847484, bpp_loss: 2.469502362123291, bpp: 0
2025-03-03 03:51:52 - INFO - layer16_mlp.down_proj | mse: 0.043700698546117876, bpp_loss: 2.4632498217147907, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [27:39<24:26, 97.74s/it]2025-03-03 03:52:02 - INFO - layer17_self_attn.q_proj | mse: 0.04942973431903994, bpp_loss: 3.0829137302935123, bpp: 0
2025-03-03 03:52:11 - INFO - layer17_self_attn.k_proj | mse: 0.056047054662818445, bpp_loss: 3.923047503689304, bpp: 0
2025-03-03 03:52:19 - INFO - layer17_self_attn.v_proj | mse: 0.04268651140223241, bpp_loss: 2.3326857004722115, bpp: 0
2025-03-03 03:52:29 - INFO - layer17_self_attn.o_proj | mse: 0.048494986151726996, bpp_loss: 2.396513974876143, bpp: 0
2025-03-03 03:52:40 - INFO - layer17_mlp.gate_proj | mse: 0.046699174025540885, bpp_loss: 2.797507703370814, bpp: 0
2025-03-03 03:52:51 - INFO - layer17_mlp.up_proj | mse: 0.04358298922333869, bpp_loss: 2.467486212329407, bpp: 0
2025-03-03 03:53:30 - INFO - layer17_mlp.down_proj | mse: 0.043782577246397156, bpp_loss: 2.460283261690555, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [29:16<22:46, 97.63s/it]2025-03-03 03:53:39 - INFO - layer18_self_attn.q_proj | mse: 0.04974767315287513, bpp_loss: 3.082396860292647, bpp: 0
2025-03-03 03:53:48 - INFO - layer18_self_attn.k_proj | mse: 0.05675630283060463, bpp_loss: 3.9930377285345457, bpp: 0
2025-03-03 03:53:57 - INFO - layer18_self_attn.v_proj | mse: 0.04175278589094652, bpp_loss: 2.2603835765912663, bpp: 0
2025-03-03 03:54:06 - INFO - layer18_self_attn.o_proj | mse: 0.04743191927788205, bpp_loss: 2.376227410393767, bpp: 0
2025-03-03 03:54:17 - INFO - layer18_mlp.gate_proj | mse: 0.04642771948132342, bpp_loss: 2.805325579829514, bpp: 0
2025-03-03 03:54:29 - INFO - layer18_mlp.up_proj | mse: 0.04323813189767392, bpp_loss: 2.4640645424369723, bpp: 0
2025-03-03 03:55:08 - INFO - layer18_mlp.down_proj | mse: 0.04295215240973929, bpp_loss: 2.4591307563906804, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [30:54<21:09, 97.67s/it]2025-03-03 03:55:17 - INFO - layer19_self_attn.q_proj | mse: 0.04920714295025299, bpp_loss: 3.0859322872711346, bpp: 0
2025-03-03 03:55:26 - INFO - layer19_self_attn.k_proj | mse: 0.055627788868071515, bpp_loss: 3.9059778002556413, bpp: 0
2025-03-03 03:55:34 - INFO - layer19_self_attn.v_proj | mse: 0.04181383237197157, bpp_loss: 2.30511183780618, bpp: 0
2025-03-03 03:55:44 - INFO - layer19_self_attn.o_proj | mse: 0.04679956151693365, bpp_loss: 2.389676815830171, bpp: 0
2025-03-03 03:55:55 - INFO - layer19_mlp.gate_proj | mse: 0.04621301055150492, bpp_loss: 2.8156709832006266, bpp: 0
2025-03-03 03:56:06 - INFO - layer19_mlp.up_proj | mse: 0.04291134218492561, bpp_loss: 2.4607593325365866, bpp: 0
2025-03-03 03:56:45 - INFO - layer19_mlp.down_proj | mse: 0.04254683132246917, bpp_loss: 2.4565156626382043, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [32:31<19:30, 97.57s/it]2025-03-03 03:56:55 - INFO - layer20_self_attn.q_proj | mse: 0.048861635859326194, bpp_loss: 3.0583771771052852, bpp: 0
2025-03-03 03:57:04 - INFO - layer20_self_attn.k_proj | mse: 0.05507331230251968, bpp_loss: 3.8666376740438864, bpp: 0
2025-03-03 03:57:12 - INFO - layer20_self_attn.v_proj | mse: 0.04229909279645229, bpp_loss: 2.338027446210617, bpp: 0
2025-03-03 03:57:21 - INFO - layer20_self_attn.o_proj | mse: 0.04647771746971474, bpp_loss: 2.376667871081736, bpp: 0
2025-03-03 03:57:33 - INFO - layer20_mlp.gate_proj | mse: 0.0461403063711801, bpp_loss: 2.817570781867419, bpp: 0
2025-03-03 03:57:44 - INFO - layer20_mlp.up_proj | mse: 0.04287114447768376, bpp_loss: 2.46409268401164, bpp: 0
2025-03-03 03:58:23 - INFO - layer20_mlp.down_proj | mse: 0.04243168464077435, bpp_loss: 2.460480656158844, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [34:09<17:54, 97.68s/it]2025-03-03 03:58:32 - INFO - layer21_self_attn.q_proj | mse: 0.0488061169355238, bpp_loss: 3.0595522791263647, bpp: 0
2025-03-03 03:58:41 - INFO - layer21_self_attn.k_proj | mse: 0.055368213853842, bpp_loss: 3.9037308453116566, bpp: 0
2025-03-03 03:58:50 - INFO - layer21_self_attn.v_proj | mse: 0.04247501860352931, bpp_loss: 2.36332568936632, bpp: 0
2025-03-03 03:58:59 - INFO - layer21_self_attn.o_proj | mse: 0.0489813706287247, bpp_loss: 2.393258896714542, bpp: 0
2025-03-03 03:59:10 - INFO - layer21_mlp.gate_proj | mse: 0.04641521087923465, bpp_loss: 2.8282155100522295, bpp: 0
2025-03-03 03:59:22 - INFO - layer21_mlp.up_proj | mse: 0.04303074338056539, bpp_loss: 2.4669280254415105, bpp: 0
2025-03-03 04:00:01 - INFO - layer21_mlp.down_proj | mse: 0.042799032949496024, bpp_loss: 2.4617069004535943, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [35:47<16:17, 97.72s/it]2025-03-03 04:00:10 - INFO - layer22_self_attn.q_proj | mse: 0.04893621732323607, bpp_loss: 3.0227374833193608, bpp: 0
2025-03-03 04:00:19 - INFO - layer22_self_attn.k_proj | mse: 0.05534346152212797, bpp_loss: 3.8468328122980893, bpp: 0
2025-03-03 04:00:28 - INFO - layer22_self_attn.v_proj | mse: 0.04325686955515039, bpp_loss: 2.412431747681694, bpp: 0
2025-03-03 04:00:37 - INFO - layer22_self_attn.o_proj | mse: 0.047514441535474995, bpp_loss: 2.421944655943662, bpp: 0
2025-03-03 04:00:48 - INFO - layer22_mlp.gate_proj | mse: 0.0464720260226553, bpp_loss: 2.833135572927339, bpp: 0
2025-03-03 04:01:00 - INFO - layer22_mlp.up_proj | mse: 0.04310947672034062, bpp_loss: 2.4711771991902163, bpp: 0
2025-03-03 04:01:38 - INFO - layer22_mlp.down_proj | mse: 0.04262389927663015, bpp_loss: 2.4678180191466317, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [37:24<14:39, 97.72s/it]2025-03-03 04:01:48 - INFO - layer23_self_attn.q_proj | mse: 0.0486576435038356, bpp_loss: 3.033283193828538, bpp: 0
2025-03-03 04:01:57 - INFO - layer23_self_attn.k_proj | mse: 0.055053936881814695, bpp_loss: 3.849748812208418, bpp: 0
2025-03-03 04:02:05 - INFO - layer23_self_attn.v_proj | mse: 0.043599919953978224, bpp_loss: 2.4624047716497444, bpp: 0
2025-03-03 04:02:14 - INFO - layer23_self_attn.o_proj | mse: 0.04521715340982008, bpp_loss: 2.4453400415950455, bpp: 0
2025-03-03 04:02:26 - INFO - layer23_mlp.gate_proj | mse: 0.04652729166216447, bpp_loss: 2.8350668335333467, bpp: 0
2025-03-03 04:02:37 - INFO - layer23_mlp.up_proj | mse: 0.04317317192600067, bpp_loss: 2.4748573831415603, bpp: 0
2025-03-03 04:03:16 - INFO - layer23_mlp.down_proj | mse: 0.042142205525415734, bpp_loss: 2.4724602099241957, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [39:02<13:00, 97.59s/it]2025-03-03 04:03:25 - INFO - layer24_self_attn.q_proj | mse: 0.04828570089946188, bpp_loss: 3.003140773100313, bpp: 0
2025-03-03 04:03:34 - INFO - layer24_self_attn.k_proj | mse: 0.053664428354192995, bpp_loss: 3.697406890511047, bpp: 0
2025-03-03 04:03:43 - INFO - layer24_self_attn.v_proj | mse: 0.044401948807096046, bpp_loss: 2.5533997394086327, bpp: 0
2025-03-03 04:03:52 - INFO - layer24_self_attn.o_proj | mse: 0.04709001900495431, bpp_loss: 2.4832830954692326, bpp: 0
2025-03-03 04:04:03 - INFO - layer24_mlp.gate_proj | mse: 0.04635987571070381, bpp_loss: 2.8404717040913448, bpp: 0
2025-03-03 04:04:14 - INFO - layer24_mlp.up_proj | mse: 0.04299494917802923, bpp_loss: 2.47934428994943, bpp: 0
2025-03-03 04:04:53 - INFO - layer24_mlp.down_proj | mse: 0.04174827395407609, bpp_loss: 2.4768628138782725, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [40:39<11:23, 97.63s/it]2025-03-03 04:05:03 - INFO - layer25_self_attn.q_proj | mse: 0.047690570135531886, bpp_loss: 2.9856484183110297, bpp: 0
2025-03-03 04:05:12 - INFO - layer25_self_attn.k_proj | mse: 0.053145741852545086, bpp_loss: 3.6777937255683355, bpp: 0
2025-03-03 04:05:20 - INFO - layer25_self_attn.v_proj | mse: 0.044117708372429586, bpp_loss: 2.566116864036303, bpp: 0
2025-03-03 04:05:29 - INFO - layer25_self_attn.o_proj | mse: 0.04689326056475982, bpp_loss: 2.484289438347332, bpp: 0
2025-03-03 04:05:41 - INFO - layer25_mlp.gate_proj | mse: 0.0462331839005062, bpp_loss: 2.848396037173058, bpp: 0
2025-03-03 04:05:52 - INFO - layer25_mlp.up_proj | mse: 0.042898240930699764, bpp_loss: 2.487880496940176, bpp: 0
2025-03-03 04:06:31 - INFO - layer25_mlp.down_proj | mse: 0.04151078930330243, bpp_loss: 2.484806122857013, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [42:17<09:45, 97.51s/it]2025-03-03 04:06:40 - INFO - layer26_self_attn.q_proj | mse: 0.04768379974704691, bpp_loss: 2.9949503025854938, bpp: 0
2025-03-03 04:06:49 - INFO - layer26_self_attn.k_proj | mse: 0.05351488881083921, bpp_loss: 3.7529094901983626, bpp: 0
2025-03-03 04:06:57 - INFO - layer26_self_attn.v_proj | mse: 0.044917532576152, bpp_loss: 2.6095429563429207, bpp: 0
2025-03-03 04:07:07 - INFO - layer26_self_attn.o_proj | mse: 0.05130835054367469, bpp_loss: 2.5089042732142843, bpp: 0
2025-03-03 04:07:18 - INFO - layer26_mlp.gate_proj | mse: 0.04613413484278056, bpp_loss: 2.852608975821308, bpp: 0
2025-03-03 04:07:29 - INFO - layer26_mlp.up_proj | mse: 0.042830559394464056, bpp_loss: 2.4967422296426127, bpp: 0
2025-03-03 04:08:08 - INFO - layer26_mlp.down_proj | mse: 0.04146967778606151, bpp_loss: 2.4920192881088172, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [43:54<08:07, 97.52s/it]2025-03-03 04:08:18 - INFO - layer27_self_attn.q_proj | mse: 0.04714107648319964, bpp_loss: 2.965761111176107, bpp: 0
2025-03-03 04:08:27 - INFO - layer27_self_attn.k_proj | mse: 0.05279230265906293, bpp_loss: 3.7106596968951635, bpp: 0
2025-03-03 04:08:35 - INFO - layer27_self_attn.v_proj | mse: 0.0451619560577429, bpp_loss: 2.6972363880486228, bpp: 0
2025-03-03 04:08:44 - INFO - layer27_self_attn.o_proj | mse: 0.047239373137583654, bpp_loss: 2.5366875927429646, bpp: 0
2025-03-03 04:08:56 - INFO - layer27_mlp.gate_proj | mse: 0.04600351298740578, bpp_loss: 2.861577252391726, bpp: 0
2025-03-03 04:09:07 - INFO - layer27_mlp.up_proj | mse: 0.04273734746365278, bpp_loss: 2.5113453912615245, bpp: 0
2025-03-03 04:09:45 - INFO - layer27_mlp.down_proj | mse: 0.041672470765928324, bpp_loss: 2.502043197031266, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [45:32<06:29, 97.44s/it]2025-03-03 04:09:55 - INFO - layer28_self_attn.q_proj | mse: 0.04706115576983413, bpp_loss: 2.9773688637651503, bpp: 0
2025-03-03 04:10:04 - INFO - layer28_self_attn.k_proj | mse: 0.05245921808667426, bpp_loss: 3.678688735817559, bpp: 0
2025-03-03 04:10:12 - INFO - layer28_self_attn.v_proj | mse: 0.0456679708951917, bpp_loss: 2.743849409162067, bpp: 0
2025-03-03 04:10:22 - INFO - layer28_self_attn.o_proj | mse: 0.04858112681548928, bpp_loss: 2.5633065651054494, bpp: 0
2025-03-03 04:10:33 - INFO - layer28_mlp.gate_proj | mse: 0.045928789154546776, bpp_loss: 2.8484600260853767, bpp: 0
2025-03-03 04:10:44 - INFO - layer28_mlp.up_proj | mse: 0.04299492600168867, bpp_loss: 2.532853649829381, bpp: 0
2025-03-03 04:11:23 - INFO - layer28_mlp.down_proj | mse: 0.04212164148953079, bpp_loss: 2.5165408604911397, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [47:09<04:52, 97.54s/it]2025-03-03 04:11:33 - INFO - layer29_self_attn.q_proj | mse: 0.04690080736065344, bpp_loss: 2.9686375182354823, bpp: 0
2025-03-03 04:11:42 - INFO - layer29_self_attn.k_proj | mse: 0.05318207076636694, bpp_loss: 3.752036709629465, bpp: 0
2025-03-03 04:11:50 - INFO - layer29_self_attn.v_proj | mse: 0.04622167974446261, bpp_loss: 2.8073328206373844, bpp: 0
2025-03-03 04:11:59 - INFO - layer29_self_attn.o_proj | mse: 0.050401987599457965, bpp_loss: 2.6008967318339273, bpp: 0
2025-03-03 04:12:11 - INFO - layer29_mlp.gate_proj | mse: 0.04613446924426573, bpp_loss: 2.8401316301231936, bpp: 0
2025-03-03 04:12:22 - INFO - layer29_mlp.up_proj | mse: 0.04350887128623994, bpp_loss: 2.5653002875125304, bpp: 0
2025-03-03 04:13:01 - INFO - layer29_mlp.down_proj | mse: 0.042533968453460476, bpp_loss: 2.5306178854246224, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [48:47<03:15, 97.64s/it]2025-03-03 04:13:11 - INFO - layer30_self_attn.q_proj | mse: 0.04666405524778665, bpp_loss: 2.8782525156857446, bpp: 0
2025-03-03 04:13:20 - INFO - layer30_self_attn.k_proj | mse: 0.05113415716805424, bpp_loss: 3.460449333942961, bpp: 0
2025-03-03 04:13:28 - INFO - layer30_self_attn.v_proj | mse: 0.04928631912367813, bpp_loss: 3.0611176682868972, bpp: 0
2025-03-03 04:13:37 - INFO - layer30_self_attn.o_proj | mse: 0.053311342599904325, bpp_loss: 2.68233229679754, bpp: 0
2025-03-03 04:13:49 - INFO - layer30_mlp.gate_proj | mse: 0.046744205655241594, bpp_loss: 2.8855941075432514, bpp: 0
2025-03-03 04:14:00 - INFO - layer30_mlp.up_proj | mse: 0.043927985607046804, bpp_loss: 2.5963893475543176, bpp: 0
2025-03-03 04:14:39 - INFO - layer30_mlp.down_proj | mse: 0.044202794098833334, bpp_loss: 2.530742137609715, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [50:25<01:37, 97.57s/it]2025-03-03 04:14:48 - INFO - layer31_self_attn.q_proj | mse: 0.04889569349177354, bpp_loss: 3.0169888310483657, bpp: 0
2025-03-03 04:14:57 - INFO - layer31_self_attn.k_proj | mse: 0.054120718352978464, bpp_loss: 3.6632366466219537, bpp: 0
2025-03-03 04:15:05 - INFO - layer31_self_attn.v_proj | mse: 0.04802389226541126, bpp_loss: 2.9045375248242635, bpp: 0
2025-03-03 04:15:15 - INFO - layer31_self_attn.o_proj | mse: 0.05493574913314832, bpp_loss: 2.6387687050155364, bpp: 0
2025-03-03 04:15:26 - INFO - layer31_mlp.gate_proj | mse: 0.050992306375679974, bpp_loss: 3.081984092414911, bpp: 0
2025-03-03 04:15:37 - INFO - layer31_mlp.up_proj | mse: 0.04778999829197091, bpp_loss: 2.7780000226838246, bpp: 0
2025-03-03 04:16:16 - INFO - layer31_mlp.down_proj | mse: 0.052462384968065975, bpp_loss: 2.557190074452332, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [52:02<00:00, 97.62s/it]pseudo compress quantization...: 100%|██████████| 32/32 [52:02<00:00, 97.59s/it]
2025-03-03 04:16:16 - INFO - #### Total | mse: 0.04546265752310963, bpp_loss: 2.6198064438644555, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda50_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_3.84823_bpp_4.61283_MSE_0.01614_total_iter_95000.pth.tar/COL_MSE0.04546_bpploss2.6198_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda50_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_3.84823_bpp_4.61283_MSE_0.01614_total_iter_95000.pth.tar/COL_MSE0.04546_bpploss2.6198_bpp0
I0303 04:16:52.691984 2961271 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.71it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.16it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.06it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.51it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s]
I0303 04:16:55.737850 2961271 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.9375:   0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.9375:   1%|          | 1/141 [00:00<01:14,  1.88it/s]avg_loss = 2.21875:   1%|          | 1/141 [00:00<01:14,  1.88it/s]avg_loss = 2.21875:   1%|▏         | 2/141 [00:00<01:04,  2.15it/s]avg_loss = 2.3541666666666665:   1%|▏         | 2/141 [00:01<01:04,  2.15it/s]avg_loss = 2.3541666666666665:   2%|▏         | 3/141 [00:01<01:01,  2.25it/s]avg_loss = 2.296875:   2%|▏         | 3/141 [00:01<01:01,  2.25it/s]          avg_loss = 2.296875:   3%|▎         | 4/141 [00:01<00:59,  2.29it/s]avg_loss = 2.246875:   3%|▎         | 4/141 [00:02<00:59,  2.29it/s]avg_loss = 2.246875:   4%|▎         | 5/141 [00:02<00:58,  2.32it/s]avg_loss = 2.14453125:   4%|▎         | 5/141 [00:02<00:58,  2.32it/s]avg_loss = 2.14453125:   4%|▍         | 6/141 [00:02<00:57,  2.34it/s]avg_loss = 2.083705357142857:   4%|▍         | 6/141 [00:03<00:57,  2.34it/s]avg_loss = 2.083705357142857:   5%|▍         | 7/141 [00:03<00:57,  2.35it/s]avg_loss = 2.0703125:   5%|▍         | 7/141 [00:03<00:57,  2.35it/s]        avg_loss = 2.0703125:   6%|▌         | 8/141 [00:03<00:56,  2.35it/s]avg_loss = 2.1006944444444446:   6%|▌         | 8/141 [00:03<00:56,  2.35it/s]avg_loss = 2.1006944444444446:   6%|▋         | 9/141 [00:03<00:55,  2.36it/s]avg_loss = 2.09375:   6%|▋         | 9/141 [00:04<00:55,  2.36it/s]           avg_loss = 2.09375:   7%|▋         | 10/141 [00:04<00:55,  2.36it/s]avg_loss = 2.086647727272727:   7%|▋         | 10/141 [00:04<00:55,  2.36it/s]avg_loss = 2.086647727272727:   8%|▊         | 11/141 [00:04<00:55,  2.36it/s]avg_loss = 2.1080729166666665:   8%|▊         | 11/141 [00:05<00:55,  2.36it/s]avg_loss = 2.1080729166666665:   9%|▊         | 12/141 [00:05<00:54,  2.36it/s]avg_loss = 2.1177884615384617:   9%|▊         | 12/141 [00:05<00:54,  2.36it/s]avg_loss = 2.1177884615384617:   9%|▉         | 13/141 [00:05<00:54,  2.37it/s]avg_loss = 2.1328125:   9%|▉         | 13/141 [00:06<00:54,  2.37it/s]         avg_loss = 2.1328125:  10%|▉         | 14/141 [00:06<00:53,  2.37it/s]avg_loss = 2.1416666666666666:  10%|▉         | 14/141 [00:06<00:53,  2.37it/s]avg_loss = 2.1416666666666666:  11%|█         | 15/141 [00:06<00:53,  2.38it/s]avg_loss = 2.1640625:  11%|█         | 15/141 [00:06<00:53,  2.38it/s]         avg_loss = 2.1640625:  11%|█▏        | 16/141 [00:06<00:52,  2.37it/s]avg_loss = 2.166360294117647:  11%|█▏        | 16/141 [00:07<00:52,  2.37it/s]avg_loss = 2.166360294117647:  12%|█▏        | 17/141 [00:07<00:52,  2.38it/s]avg_loss = 2.1675347222222223:  12%|█▏        | 17/141 [00:07<00:52,  2.38it/s]avg_loss = 2.1675347222222223:  13%|█▎        | 18/141 [00:07<00:51,  2.37it/s]avg_loss = 2.1595394736842106:  13%|█▎        | 18/141 [00:08<00:51,  2.37it/s]avg_loss = 2.1595394736842106:  13%|█▎        | 19/141 [00:08<00:51,  2.38it/s]avg_loss = 2.15859375:  13%|█▎        | 19/141 [00:08<00:51,  2.38it/s]        avg_loss = 2.15859375:  14%|█▍        | 20/141 [00:08<00:50,  2.38it/s]avg_loss = 2.1636904761904763:  14%|█▍        | 20/141 [00:08<00:50,  2.38it/s]avg_loss = 2.1636904761904763:  15%|█▍        | 21/141 [00:08<00:50,  2.38it/s]avg_loss = 2.1661931818181817:  15%|█▍        | 21/141 [00:09<00:50,  2.38it/s]avg_loss = 2.1661931818181817:  16%|█▌        | 22/141 [00:09<00:50,  2.37it/s]avg_loss = 2.1684782608695654:  16%|█▌        | 22/141 [00:09<00:50,  2.37it/s]avg_loss = 2.1684782608695654:  16%|█▋        | 23/141 [00:09<00:49,  2.37it/s]avg_loss = 2.1731770833333335:  16%|█▋        | 23/141 [00:10<00:49,  2.37it/s]avg_loss = 2.1731770833333335:  17%|█▋        | 24/141 [00:10<00:49,  2.37it/s]avg_loss = 2.179375:  17%|█▋        | 24/141 [00:10<00:49,  2.37it/s]          avg_loss = 2.179375:  18%|█▊        | 25/141 [00:10<00:48,  2.37it/s]avg_loss = 2.191105769230769:  18%|█▊        | 25/141 [00:11<00:48,  2.37it/s]avg_loss = 2.191105769230769:  18%|█▊        | 26/141 [00:11<00:48,  2.37it/s]avg_loss = 2.2025462962962963:  18%|█▊        | 26/141 [00:11<00:48,  2.37it/s]avg_loss = 2.2025462962962963:  19%|█▉        | 27/141 [00:11<00:48,  2.37it/s]avg_loss = 2.2059151785714284:  19%|█▉        | 27/141 [00:11<00:48,  2.37it/s]avg_loss = 2.2059151785714284:  20%|█▉        | 28/141 [00:11<00:47,  2.36it/s]avg_loss = 2.2015086206896552:  20%|█▉        | 28/141 [00:12<00:47,  2.36it/s]avg_loss = 2.2015086206896552:  21%|██        | 29/141 [00:12<00:47,  2.37it/s]avg_loss = 2.1924479166666666:  21%|██        | 29/141 [00:12<00:47,  2.37it/s]avg_loss = 2.1924479166666666:  21%|██▏       | 30/141 [00:12<00:46,  2.36it/s]avg_loss = 2.180695564516129:  21%|██▏       | 30/141 [00:13<00:46,  2.36it/s] avg_loss = 2.180695564516129:  22%|██▏       | 31/141 [00:13<00:46,  2.37it/s]avg_loss = 2.16943359375:  22%|██▏       | 31/141 [00:13<00:46,  2.37it/s]    avg_loss = 2.16943359375:  23%|██▎       | 32/141 [00:13<00:46,  2.36it/s]avg_loss = 2.1671401515151514:  23%|██▎       | 32/141 [00:14<00:46,  2.36it/s]avg_loss = 2.1671401515151514:  23%|██▎       | 33/141 [00:14<00:45,  2.36it/s]avg_loss = 2.1659007352941178:  23%|██▎       | 33/141 [00:14<00:45,  2.36it/s]avg_loss = 2.1659007352941178:  24%|██▍       | 34/141 [00:14<00:45,  2.36it/s]avg_loss = 2.16875:  24%|██▍       | 34/141 [00:14<00:45,  2.36it/s]           avg_loss = 2.16875:  25%|██▍       | 35/141 [00:14<00:44,  2.36it/s]avg_loss = 2.152126736111111:  25%|██▍       | 35/141 [00:15<00:44,  2.36it/s]avg_loss = 2.152126736111111:  26%|██▌       | 36/141 [00:15<00:44,  2.36it/s]avg_loss = 2.137668918918919:  26%|██▌       | 36/141 [00:15<00:44,  2.36it/s]avg_loss = 2.137668918918919:  26%|██▌       | 37/141 [00:15<00:44,  2.36it/s]avg_loss = 2.1231496710526314:  26%|██▌       | 37/141 [00:16<00:44,  2.36it/s]avg_loss = 2.1231496710526314:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 2.1095753205128207:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 2.1095753205128207:  28%|██▊       | 39/141 [00:16<00:43,  2.36it/s]avg_loss = 2.1015625:  28%|██▊       | 39/141 [00:16<00:43,  2.36it/s]         avg_loss = 2.1015625:  28%|██▊       | 40/141 [00:16<00:42,  2.36it/s]avg_loss = 2.1078506097560976:  28%|██▊       | 40/141 [00:17<00:42,  2.36it/s]avg_loss = 2.1078506097560976:  29%|██▉       | 41/141 [00:17<00:42,  2.35it/s]avg_loss = 2.122767857142857:  29%|██▉       | 41/141 [00:17<00:42,  2.35it/s] avg_loss = 2.122767857142857:  30%|██▉       | 42/141 [00:17<00:41,  2.36it/s]avg_loss = 2.137718023255814:  30%|██▉       | 42/141 [00:18<00:41,  2.36it/s]avg_loss = 2.137718023255814:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]avg_loss = 2.14453125:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]       avg_loss = 2.14453125:  31%|███       | 44/141 [00:18<00:41,  2.36it/s]avg_loss = 2.1510416666666665:  31%|███       | 44/141 [00:19<00:41,  2.36it/s]avg_loss = 2.1510416666666665:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 2.1545516304347827:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 2.1545516304347827:  33%|███▎      | 46/141 [00:19<00:40,  2.35it/s]avg_loss = 2.158909574468085:  33%|███▎      | 46/141 [00:19<00:40,  2.35it/s] avg_loss = 2.158909574468085:  33%|███▎      | 47/141 [00:19<00:39,  2.36it/s]avg_loss = 2.1598307291666665:  33%|███▎      | 47/141 [00:20<00:39,  2.36it/s]avg_loss = 2.1598307291666665:  34%|███▍      | 48/141 [00:20<00:39,  2.35it/s]avg_loss = 2.1591198979591835:  34%|███▍      | 48/141 [00:20<00:39,  2.35it/s]avg_loss = 2.1591198979591835:  35%|███▍      | 49/141 [00:20<00:39,  2.35it/s]avg_loss = 2.1584375:  35%|███▍      | 49/141 [00:21<00:39,  2.35it/s]         avg_loss = 2.1584375:  35%|███▌      | 50/141 [00:21<00:38,  2.35it/s]avg_loss = 2.153799019607843:  35%|███▌      | 50/141 [00:21<00:38,  2.35it/s]avg_loss = 2.153799019607843:  36%|███▌      | 51/141 [00:21<00:38,  2.35it/s]avg_loss = 2.1490384615384617:  36%|███▌      | 51/141 [00:22<00:38,  2.35it/s]avg_loss = 2.1490384615384617:  37%|███▋      | 52/141 [00:22<00:37,  2.35it/s]avg_loss = 2.1428360849056602:  37%|███▋      | 52/141 [00:22<00:37,  2.35it/s]avg_loss = 2.1428360849056602:  38%|███▊      | 53/141 [00:22<00:37,  2.35it/s]avg_loss = 2.1393229166666665:  38%|███▊      | 53/141 [00:22<00:37,  2.35it/s]avg_loss = 2.1393229166666665:  38%|███▊      | 54/141 [00:22<00:37,  2.35it/s]avg_loss = 2.13125:  38%|███▊      | 54/141 [00:23<00:37,  2.35it/s]           avg_loss = 2.13125:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 2.123325892857143:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 2.123325892857143:  40%|███▉      | 56/141 [00:23<00:36,  2.35it/s]avg_loss = 2.121984649122807:  40%|███▉      | 56/141 [00:24<00:36,  2.35it/s]avg_loss = 2.121984649122807:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 2.119073275862069:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 2.119073275862069:  41%|████      | 58/141 [00:24<00:35,  2.35it/s]avg_loss = 2.121292372881356:  41%|████      | 58/141 [00:25<00:35,  2.35it/s]avg_loss = 2.121292372881356:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 2.1260416666666666:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 2.1260416666666666:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 2.1306352459016393:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 2.1306352459016393:  43%|████▎     | 61/141 [00:25<00:34,  2.35it/s]avg_loss = 2.1393649193548385:  43%|████▎     | 61/141 [00:26<00:34,  2.35it/s]avg_loss = 2.1393649193548385:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 2.1316964285714284:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 2.1316964285714284:  45%|████▍     | 63/141 [00:26<00:33,  2.35it/s]avg_loss = 2.129150390625:  45%|████▍     | 63/141 [00:27<00:33,  2.35it/s]    avg_loss = 2.129150390625:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 2.1274038461538463:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 2.1274038461538463:  46%|████▌     | 65/141 [00:27<00:32,  2.35it/s]avg_loss = 2.121803977272727:  46%|████▌     | 65/141 [00:28<00:32,  2.35it/s] avg_loss = 2.121803977272727:  47%|████▋     | 66/141 [00:28<00:31,  2.35it/s]avg_loss = 2.118936567164179:  47%|████▋     | 66/141 [00:28<00:31,  2.35it/s]avg_loss = 2.118936567164179:  48%|████▊     | 67/141 [00:28<00:31,  2.34it/s]avg_loss = 2.1167279411764706:  48%|████▊     | 67/141 [00:28<00:31,  2.34it/s]avg_loss = 2.1167279411764706:  48%|████▊     | 68/141 [00:28<00:31,  2.34it/s]avg_loss = 2.1152626811594204:  48%|████▊     | 68/141 [00:29<00:31,  2.34it/s]avg_loss = 2.1152626811594204:  49%|████▉     | 69/141 [00:29<00:30,  2.34it/s]avg_loss = 2.116517857142857:  49%|████▉     | 69/141 [00:29<00:30,  2.34it/s] avg_loss = 2.116517857142857:  50%|████▉     | 70/141 [00:29<00:30,  2.34it/s]avg_loss = 2.119718309859155:  50%|████▉     | 70/141 [00:30<00:30,  2.34it/s]avg_loss = 2.119718309859155:  50%|█████     | 71/141 [00:30<00:29,  2.34it/s]avg_loss = 2.1221788194444446:  50%|█████     | 71/141 [00:30<00:29,  2.34it/s]avg_loss = 2.1221788194444446:  51%|█████     | 72/141 [00:30<00:29,  2.34it/s]avg_loss = 2.119755993150685:  51%|█████     | 72/141 [00:31<00:29,  2.34it/s] avg_loss = 2.119755993150685:  52%|█████▏    | 73/141 [00:31<00:29,  2.34it/s]avg_loss = 2.1206714527027026:  52%|█████▏    | 73/141 [00:31<00:29,  2.34it/s]avg_loss = 2.1206714527027026:  52%|█████▏    | 74/141 [00:31<00:28,  2.34it/s]avg_loss = 2.1198958333333335:  52%|█████▏    | 74/141 [00:31<00:28,  2.34it/s]avg_loss = 2.1198958333333335:  53%|█████▎    | 75/141 [00:31<00:28,  2.34it/s]avg_loss = 2.1180098684210527:  53%|█████▎    | 75/141 [00:32<00:28,  2.34it/s]avg_loss = 2.1180098684210527:  54%|█████▍    | 76/141 [00:32<00:27,  2.34it/s]avg_loss = 2.1187094155844157:  54%|█████▍    | 76/141 [00:32<00:27,  2.34it/s]avg_loss = 2.1187094155844157:  55%|█████▍    | 77/141 [00:32<00:27,  2.34it/s]avg_loss = 2.120592948717949:  55%|█████▍    | 77/141 [00:33<00:27,  2.34it/s] avg_loss = 2.120592948717949:  55%|█████▌    | 78/141 [00:33<00:26,  2.34it/s]avg_loss = 2.124011075949367:  55%|█████▌    | 78/141 [00:33<00:26,  2.34it/s]avg_loss = 2.124011075949367:  56%|█████▌    | 79/141 [00:33<00:26,  2.34it/s]avg_loss = 2.12001953125:  56%|█████▌    | 79/141 [00:34<00:26,  2.34it/s]    avg_loss = 2.12001953125:  57%|█████▋    | 80/141 [00:34<00:26,  2.34it/s]avg_loss = 2.1182484567901234:  57%|█████▋    | 80/141 [00:34<00:26,  2.34it/s]avg_loss = 2.1182484567901234:  57%|█████▋    | 81/141 [00:34<00:25,  2.34it/s]avg_loss = 2.1169969512195124:  57%|█████▋    | 81/141 [00:34<00:25,  2.34it/s]avg_loss = 2.1169969512195124:  58%|█████▊    | 82/141 [00:34<00:25,  2.34it/s]avg_loss = 2.11511671686747:  58%|█████▊    | 82/141 [00:35<00:25,  2.34it/s]  avg_loss = 2.11511671686747:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]avg_loss = 2.113002232142857:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]avg_loss = 2.113002232142857:  60%|█████▉    | 84/141 [00:35<00:24,  2.34it/s]avg_loss = 2.1106617647058825:  60%|█████▉    | 84/141 [00:36<00:24,  2.34it/s]avg_loss = 2.1106617647058825:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s]avg_loss = 2.111736918604651:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s] avg_loss = 2.111736918604651:  61%|██████    | 86/141 [00:36<00:23,  2.34it/s]avg_loss = 2.1136853448275863:  61%|██████    | 86/141 [00:37<00:23,  2.34it/s]avg_loss = 2.1136853448275863:  62%|██████▏   | 87/141 [00:37<00:23,  2.34it/s]avg_loss = 2.1150568181818183:  62%|██████▏   | 87/141 [00:37<00:23,  2.34it/s]avg_loss = 2.1150568181818183:  62%|██████▏   | 88/141 [00:37<00:22,  2.34it/s]avg_loss = 2.1235955056179776:  62%|██████▏   | 88/141 [00:37<00:22,  2.34it/s]avg_loss = 2.1235955056179776:  63%|██████▎   | 89/141 [00:37<00:22,  2.34it/s]avg_loss = 2.131076388888889:  63%|██████▎   | 89/141 [00:38<00:22,  2.34it/s] avg_loss = 2.131076388888889:  64%|██████▍   | 90/141 [00:38<00:21,  2.34it/s]avg_loss = 2.1341002747252746:  64%|██████▍   | 90/141 [00:38<00:21,  2.34it/s]avg_loss = 2.1341002747252746:  65%|██████▍   | 91/141 [00:38<00:21,  2.35it/s]avg_loss = 2.1394361413043477:  65%|██████▍   | 91/141 [00:39<00:21,  2.35it/s]avg_loss = 2.1394361413043477:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]avg_loss = 2.1439852150537635:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]avg_loss = 2.1439852150537635:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 2.144281914893617:  66%|██████▌   | 93/141 [00:40<00:20,  2.35it/s] avg_loss = 2.144281914893617:  67%|██████▋   | 94/141 [00:40<00:20,  2.35it/s]avg_loss = 2.1481907894736842:  67%|██████▋   | 94/141 [00:40<00:20,  2.35it/s]avg_loss = 2.1481907894736842:  67%|██████▋   | 95/141 [00:40<00:19,  2.34it/s]avg_loss = 2.1481119791666665:  67%|██████▋   | 95/141 [00:40<00:19,  2.34it/s]avg_loss = 2.1481119791666665:  68%|██████▊   | 96/141 [00:40<00:19,  2.35it/s]avg_loss = 2.149484536082474:  68%|██████▊   | 96/141 [00:41<00:19,  2.35it/s] avg_loss = 2.149484536082474:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s]avg_loss = 2.1477200255102042:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s]avg_loss = 2.1477200255102042:  70%|██████▉   | 98/141 [00:41<00:18,  2.35it/s]avg_loss = 2.148910984848485:  70%|██████▉   | 98/141 [00:42<00:18,  2.35it/s] avg_loss = 2.148910984848485:  70%|███████   | 99/141 [00:42<00:17,  2.35it/s]avg_loss = 2.151484375:  70%|███████   | 99/141 [00:42<00:17,  2.35it/s]      avg_loss = 2.151484375:  71%|███████   | 100/141 [00:42<00:17,  2.35it/s]avg_loss = 2.152150371287129:  71%|███████   | 100/141 [00:43<00:17,  2.35it/s]avg_loss = 2.152150371287129:  72%|███████▏  | 101/141 [00:43<00:17,  2.34it/s]avg_loss = 2.153262867647059:  72%|███████▏  | 101/141 [00:43<00:17,  2.34it/s]avg_loss = 2.153262867647059:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]avg_loss = 2.1537469660194173:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]avg_loss = 2.1537469660194173:  73%|███████▎  | 103/141 [00:43<00:16,  2.34it/s]avg_loss = 2.1581280048076925:  73%|███████▎  | 103/141 [00:44<00:16,  2.34it/s]avg_loss = 2.1581280048076925:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 2.1576636904761903:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 2.1576636904761903:  74%|███████▍  | 105/141 [00:44<00:15,  2.34it/s]avg_loss = 2.157650353773585:  74%|███████▍  | 105/141 [00:45<00:15,  2.34it/s] avg_loss = 2.157650353773585:  75%|███████▌  | 106/141 [00:45<00:14,  2.34it/s]avg_loss = 2.156615070093458:  75%|███████▌  | 106/141 [00:45<00:14,  2.34it/s]avg_loss = 2.156615070093458:  76%|███████▌  | 107/141 [00:45<00:14,  2.34it/s]avg_loss = 2.1550925925925926:  76%|███████▌  | 107/141 [00:45<00:14,  2.34it/s]avg_loss = 2.1550925925925926:  77%|███████▋  | 108/141 [00:45<00:14,  2.34it/s]avg_loss = 2.153454701834862:  77%|███████▋  | 108/141 [00:46<00:14,  2.34it/s] avg_loss = 2.153454701834862:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 2.150994318181818:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 2.150994318181818:  78%|███████▊  | 110/141 [00:46<00:13,  2.34it/s]avg_loss = 2.153434684684685:  78%|███████▊  | 110/141 [00:47<00:13,  2.34it/s]avg_loss = 2.153434684684685:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 2.1529017857142856:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 2.1529017857142856:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s]avg_loss = 2.154037610619469:  79%|███████▉  | 112/141 [00:48<00:12,  2.34it/s] avg_loss = 2.154037610619469:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 2.155290570175439:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 2.155290570175439:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 2.1542119565217392:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 2.1542119565217392:  82%|████████▏ | 115/141 [00:48<00:11,  2.34it/s]avg_loss = 2.1534213362068964:  82%|████████▏ | 115/141 [00:49<00:11,  2.34it/s]avg_loss = 2.1534213362068964:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 2.155582264957265:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s] avg_loss = 2.155582264957265:  83%|████████▎ | 117/141 [00:49<00:10,  2.34it/s]avg_loss = 2.1546610169491527:  83%|████████▎ | 117/141 [00:50<00:10,  2.34it/s]avg_loss = 2.1546610169491527:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 2.152639180672269:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s] avg_loss = 2.152639180672269:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]avg_loss = 2.150520833333333:  84%|████████▍ | 119/141 [00:51<00:09,  2.34it/s]avg_loss = 2.150520833333333:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 2.1505681818181817:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 2.1505681818181817:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 2.151127049180328:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s] avg_loss = 2.151127049180328:  87%|████████▋ | 122/141 [00:51<00:08,  2.34it/s]avg_loss = 2.1504065040650406:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 2.1504065040650406:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 2.150327620967742:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s] avg_loss = 2.150327620967742:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]avg_loss = 2.1486875:  88%|████████▊ | 124/141 [00:53<00:07,  2.34it/s]        avg_loss = 2.1486875:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 2.1487475198412698:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 2.1487475198412698:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 2.1484375:  89%|████████▉ | 126/141 [00:54<00:06,  2.34it/s]         avg_loss = 2.1484375:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]avg_loss = 2.14739990234375:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]avg_loss = 2.14739990234375:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 2.1472262596899223:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 2.1472262596899223:  91%|█████████▏| 129/141 [00:54<00:05,  2.33it/s]avg_loss = 2.148737980769231:  91%|█████████▏| 129/141 [00:55<00:05,  2.33it/s] avg_loss = 2.148737980769231:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 2.1497495229007635:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 2.1497495229007635:  93%|█████████▎| 131/141 [00:55<00:04,  2.33it/s]avg_loss = 2.150390625:  93%|█████████▎| 131/141 [00:56<00:04,  2.33it/s]       avg_loss = 2.150390625:  94%|█████████▎| 132/141 [00:56<00:03,  2.33it/s]avg_loss = 2.1468515037593985:  94%|█████████▎| 132/141 [00:56<00:03,  2.33it/s]avg_loss = 2.1468515037593985:  94%|█████████▍| 133/141 [00:56<00:03,  2.33it/s]avg_loss = 2.1416161380597014:  94%|█████████▍| 133/141 [00:57<00:03,  2.33it/s]avg_loss = 2.1416161380597014:  95%|█████████▌| 134/141 [00:57<00:02,  2.33it/s]avg_loss = 2.14369212962963:  95%|█████████▌| 134/141 [00:57<00:02,  2.33it/s]  avg_loss = 2.14369212962963:  96%|█████████▌| 135/141 [00:57<00:02,  2.33it/s]avg_loss = 2.1470013786764706:  96%|█████████▌| 135/141 [00:57<00:02,  2.33it/s]avg_loss = 2.1470013786764706:  96%|█████████▋| 136/141 [00:57<00:02,  2.33it/s]avg_loss = 2.1485515510948905:  96%|█████████▋| 136/141 [00:58<00:02,  2.33it/s]avg_loss = 2.1485515510948905:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]avg_loss = 2.1479279891304346:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]avg_loss = 2.1479279891304346:  98%|█████████▊| 138/141 [00:58<00:01,  2.33it/s]avg_loss = 2.1487747302158273:  98%|█████████▊| 138/141 [00:59<00:01,  2.33it/s]avg_loss = 2.1487747302158273:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 2.1498325892857144:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 2.1498325892857144:  99%|█████████▉| 140/141 [00:59<00:00,  2.33it/s]avg_loss = 2.151207890070922:  99%|█████████▉| 140/141 [01:00<00:00,  2.33it/s] avg_loss = 2.151207890070922: 100%|██████████| 141/141 [01:00<00:00,  2.33it/s]avg_loss = 2.151207890070922: 100%|██████████| 141/141 [01:00<00:00,  2.35it/s]
I0303 04:18:16.635128 2961271 eval_ppl.py:105] wikitext2 perplexity: 8.595234870910645
wikitext2 perplexity: 8.595
Running with lmbda=100
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.75it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.58it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.84it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.19it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.46it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.95it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.13it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:20,  1.54it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:14,  2.03it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:12,  2.28it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:11,  2.41it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:12,  2.21it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:12,  2.03it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:12,  1.92it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:12,  1.94it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:11,  1.93it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:11,  1.92it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:05<00:11,  1.86it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:10,  1.82it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:06<00:10,  1.80it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:09,  1.82it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:07<00:09,  1.80it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:08,  1.81it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:08<00:08,  1.81it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:09<00:07,  1.81it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:10<00:07,  1.85it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:10<00:06,  1.88it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:10<00:05,  1.93it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:05,  1.92it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:12<00:04,  1.93it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:12<00:04,  1.94it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:13<00:03,  1.91it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:13<00:03,  1.88it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:14<00:02,  1.96it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:14<00:01,  2.08it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:14<00:01,  2.17it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:15<00:00,  2.26it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:15<00:00,  2.32it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  2.37it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  1.98it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 04:19:01 - INFO - layer0_self_attn.q_proj | mse: 0.03754282970229464, bpp_loss: 3.382617113937158, bpp: 0
2025-03-03 04:19:09 - INFO - layer0_self_attn.k_proj | mse: 0.04268716613385313, bpp_loss: 3.897417240019422, bpp: 0
2025-03-03 04:19:17 - INFO - layer0_self_attn.v_proj | mse: 0.02975115549140542, bpp_loss: 2.5914003940997645, bpp: 0
2025-03-03 04:19:26 - INFO - layer0_self_attn.o_proj | mse: 0.023014578390252387, bpp_loss: 2.679511110065505, bpp: 0
2025-03-03 04:19:37 - INFO - layer0_mlp.gate_proj | mse: 0.023562378928134363, bpp_loss: 3.071780903198357, bpp: 0
2025-03-03 04:19:48 - INFO - layer0_mlp.up_proj | mse: 0.02310852658373954, bpp_loss: 2.964860231482557, bpp: 0
2025-03-03 04:20:27 - INFO - layer0_mlp.down_proj | mse: 0.022737473371434665, bpp_loss: 2.9576466393191367, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:35<49:05, 95.02s/it]2025-03-03 04:20:36 - INFO - layer1_self_attn.q_proj | mse: 0.03215573558862273, bpp_loss: 3.618735527212266, bpp: 0
2025-03-03 04:20:45 - INFO - layer1_self_attn.k_proj | mse: 0.03517680055055001, bpp_loss: 4.247135017241817, bpp: 0
2025-03-03 04:20:53 - INFO - layer1_self_attn.v_proj | mse: 0.027154733235234107, bpp_loss: 2.6968828175449744, bpp: 0
2025-03-03 04:21:02 - INFO - layer1_self_attn.o_proj | mse: 0.027277724280480756, bpp_loss: 2.7601503028417937, bpp: 0
2025-03-03 04:21:14 - INFO - layer1_mlp.gate_proj | mse: 0.023935071038807137, bpp_loss: 3.081928943483425, bpp: 0
2025-03-03 04:21:25 - INFO - layer1_mlp.up_proj | mse: 0.023436908842174645, bpp_loss: 2.978862130681851, bpp: 0
2025-03-03 04:22:03 - INFO - layer1_mlp.down_proj | mse: 0.020012415803364818, bpp_loss: 2.970293614048777, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [03:11<47:50, 95.69s/it]2025-03-03 04:22:12 - INFO - layer2_self_attn.q_proj | mse: 0.027119157552480327, bpp_loss: 3.5694287742953748, bpp: 0
2025-03-03 04:22:21 - INFO - layer2_self_attn.k_proj | mse: 0.02996062325735242, bpp_loss: 4.352743561961688, bpp: 0
2025-03-03 04:22:29 - INFO - layer2_self_attn.v_proj | mse: 0.022373029761752167, bpp_loss: 2.604043670115061, bpp: 0
2025-03-03 04:22:38 - INFO - layer2_self_attn.o_proj | mse: 0.02180838892234515, bpp_loss: 2.716792684281245, bpp: 0
2025-03-03 04:22:49 - INFO - layer2_mlp.gate_proj | mse: 0.022827616092575137, bpp_loss: 3.112325877017741, bpp: 0
2025-03-03 04:23:00 - INFO - layer2_mlp.up_proj | mse: 0.022177817721494967, bpp_loss: 2.970519452023187, bpp: 0
2025-03-03 04:23:38 - INFO - layer2_mlp.down_proj | mse: 0.02144870163576697, bpp_loss: 2.975559103851473, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:46<46:11, 95.56s/it]2025-03-03 04:23:47 - INFO - layer3_self_attn.q_proj | mse: 0.025299348394964383, bpp_loss: 3.608459302224219, bpp: 0
2025-03-03 04:23:56 - INFO - layer3_self_attn.k_proj | mse: 0.028251408699928125, bpp_loss: 4.425570699735545, bpp: 0
2025-03-03 04:24:05 - INFO - layer3_self_attn.v_proj | mse: 0.021153658750153587, bpp_loss: 2.7008229549392127, bpp: 0
2025-03-03 04:24:15 - INFO - layer3_self_attn.o_proj | mse: 0.02312198914056013, bpp_loss: 2.8120322028989904, bpp: 0
2025-03-03 04:24:27 - INFO - layer3_mlp.gate_proj | mse: 0.02316133884205555, bpp_loss: 3.182857595251075, bpp: 0
2025-03-03 04:24:38 - INFO - layer3_mlp.up_proj | mse: 0.022092376486581616, bpp_loss: 2.952662398706057, bpp: 0
2025-03-03 04:25:16 - INFO - layer3_mlp.down_proj | mse: 0.021132928962047343, bpp_loss: 2.952442522110817, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [06:24<45:01, 96.49s/it]2025-03-03 04:25:25 - INFO - layer4_self_attn.q_proj | mse: 0.025132736579748384, bpp_loss: 3.5739123826497234, bpp: 0
2025-03-03 04:25:34 - INFO - layer4_self_attn.k_proj | mse: 0.02816676001308915, bpp_loss: 4.407425111159682, bpp: 0
2025-03-03 04:25:42 - INFO - layer4_self_attn.v_proj | mse: 0.021421330998364928, bpp_loss: 2.744362636934966, bpp: 0
2025-03-03 04:25:51 - INFO - layer4_self_attn.o_proj | mse: 0.02404779558598223, bpp_loss: 2.820804907823913, bpp: 0
2025-03-03 04:26:02 - INFO - layer4_mlp.gate_proj | mse: 0.02327599385424, bpp_loss: 3.250660370370107, bpp: 0
2025-03-03 04:26:13 - INFO - layer4_mlp.up_proj | mse: 0.021779287302007812, bpp_loss: 2.9256592484058013, bpp: 0
2025-03-03 04:26:52 - INFO - layer4_mlp.down_proj | mse: 0.02150499200061931, bpp_loss: 2.9291692785087173, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [08:00<43:18, 96.26s/it]2025-03-03 04:27:01 - INFO - layer5_self_attn.q_proj | mse: 0.02530940982380835, bpp_loss: 3.550032432191074, bpp: 0
2025-03-03 04:27:10 - INFO - layer5_self_attn.k_proj | mse: 0.02832056400310528, bpp_loss: 4.382459770189598, bpp: 0
2025-03-03 04:27:18 - INFO - layer5_self_attn.v_proj | mse: 0.02107277477013371, bpp_loss: 2.6332275296445005, bpp: 0
2025-03-03 04:27:27 - INFO - layer5_self_attn.o_proj | mse: 0.024578219455600573, bpp_loss: 2.771696802810766, bpp: 0
2025-03-03 04:27:38 - INFO - layer5_mlp.gate_proj | mse: 0.023092758394896835, bpp_loss: 3.2530556610519334, bpp: 0
2025-03-03 04:27:49 - INFO - layer5_mlp.up_proj | mse: 0.021635969778366917, bpp_loss: 2.93057574192062, bpp: 0
2025-03-03 04:28:28 - INFO - layer5_mlp.down_proj | mse: 0.021607356930497385, bpp_loss: 2.933837738703005, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [09:36<41:41, 96.23s/it]2025-03-03 04:28:37 - INFO - layer6_self_attn.q_proj | mse: 0.025040205040077725, bpp_loss: 3.5941549255512655, bpp: 0
2025-03-03 04:28:46 - INFO - layer6_self_attn.k_proj | mse: 0.02804694122945613, bpp_loss: 4.4505023582605645, bpp: 0
2025-03-03 04:28:54 - INFO - layer6_self_attn.v_proj | mse: 0.02092599031426354, bpp_loss: 2.6782942987047136, bpp: 0
2025-03-03 04:29:04 - INFO - layer6_self_attn.o_proj | mse: 0.024833127334250586, bpp_loss: 2.8012998147751205, bpp: 0
2025-03-03 04:29:15 - INFO - layer6_mlp.gate_proj | mse: 0.023103210924487683, bpp_loss: 3.2573412038785006, bpp: 0
2025-03-03 04:29:26 - INFO - layer6_mlp.up_proj | mse: 0.021621896773290614, bpp_loss: 2.9297306144477, bpp: 0
2025-03-03 04:30:04 - INFO - layer6_mlp.down_proj | mse: 0.02180494516645643, bpp_loss: 2.9343453586334363, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [11:12<40:06, 96.26s/it]2025-03-03 04:30:14 - INFO - layer7_self_attn.q_proj | mse: 0.024913224767212836, bpp_loss: 3.523664925247431, bpp: 0
2025-03-03 04:30:23 - INFO - layer7_self_attn.k_proj | mse: 0.028333293608155775, bpp_loss: 4.472258283931296, bpp: 0
2025-03-03 04:30:31 - INFO - layer7_self_attn.v_proj | mse: 0.020994146137754206, bpp_loss: 2.676650150620844, bpp: 0
2025-03-03 04:30:40 - INFO - layer7_self_attn.o_proj | mse: 0.025488594803776094, bpp_loss: 2.81259297253564, bpp: 0
2025-03-03 04:30:51 - INFO - layer7_mlp.gate_proj | mse: 0.02301154518668209, bpp_loss: 3.2297632756110812, bpp: 0
2025-03-03 04:31:02 - INFO - layer7_mlp.up_proj | mse: 0.021691549953926498, bpp_loss: 2.9420530406891237, bpp: 0
2025-03-03 04:31:40 - INFO - layer7_mlp.down_proj | mse: 0.02182750071217631, bpp_loss: 2.947061772541409, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [12:48<38:28, 96.17s/it]2025-03-03 04:31:50 - INFO - layer8_self_attn.q_proj | mse: 0.024774465119260257, bpp_loss: 3.5101665791589767, bpp: 0
2025-03-03 04:31:58 - INFO - layer8_self_attn.k_proj | mse: 0.027876548773686893, bpp_loss: 4.387965837144293, bpp: 0
2025-03-03 04:32:07 - INFO - layer8_self_attn.v_proj | mse: 0.021076048428237272, bpp_loss: 2.696512883179821, bpp: 0
2025-03-03 04:32:16 - INFO - layer8_self_attn.o_proj | mse: 0.026849466065598026, bpp_loss: 2.8229035531985573, bpp: 0
2025-03-03 04:32:27 - INFO - layer8_mlp.gate_proj | mse: 0.022920218816720357, bpp_loss: 3.2340385198060955, bpp: 0
2025-03-03 04:32:38 - INFO - layer8_mlp.up_proj | mse: 0.021570976697635726, bpp_loss: 2.937880398772125, bpp: 0
2025-03-03 04:33:15 - INFO - layer8_mlp.down_proj | mse: 0.021879395849587452, bpp_loss: 2.9455598669259677, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [14:23<36:44, 95.85s/it]2025-03-03 04:33:25 - INFO - layer9_self_attn.q_proj | mse: 0.024584219230762063, bpp_loss: 3.521888563176617, bpp: 0
2025-03-03 04:33:33 - INFO - layer9_self_attn.k_proj | mse: 0.027747618791172716, bpp_loss: 4.408097294392064, bpp: 0
2025-03-03 04:33:42 - INFO - layer9_self_attn.v_proj | mse: 0.021402158370639808, bpp_loss: 2.7939118510694243, bpp: 0
2025-03-03 04:33:51 - INFO - layer9_self_attn.o_proj | mse: 0.02714457040990021, bpp_loss: 2.8765307720168494, bpp: 0
2025-03-03 04:34:02 - INFO - layer9_mlp.gate_proj | mse: 0.022969670505655716, bpp_loss: 3.24676938660975, bpp: 0
2025-03-03 04:34:13 - INFO - layer9_mlp.up_proj | mse: 0.021596743821975538, bpp_loss: 2.9469983759336174, bpp: 0
2025-03-03 04:34:50 - INFO - layer9_mlp.down_proj | mse: 0.021988198835781465, bpp_loss: 2.947807677007014, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [15:58<35:01, 95.54s/it]2025-03-03 04:35:00 - INFO - layer10_self_attn.q_proj | mse: 0.024696975024610577, bpp_loss: 3.5199377972166985, bpp: 0
2025-03-03 04:35:08 - INFO - layer10_self_attn.k_proj | mse: 0.027833000429781783, bpp_loss: 4.406296941568144, bpp: 0
2025-03-03 04:35:16 - INFO - layer10_self_attn.v_proj | mse: 0.020914662877816695, bpp_loss: 2.686937841877807, bpp: 0
2025-03-03 04:35:25 - INFO - layer10_self_attn.o_proj | mse: 0.02588640799829568, bpp_loss: 2.815745327679906, bpp: 0
2025-03-03 04:35:36 - INFO - layer10_mlp.gate_proj | mse: 0.02285634151124166, bpp_loss: 3.2186925600815033, bpp: 0
2025-03-03 04:35:48 - INFO - layer10_mlp.up_proj | mse: 0.021689922643728873, bpp_loss: 2.9639841542313143, bpp: 0
2025-03-03 04:36:26 - INFO - layer10_mlp.down_proj | mse: 0.02197836875647984, bpp_loss: 2.963061537543711, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [17:34<33:25, 95.49s/it]2025-03-03 04:36:35 - INFO - layer11_self_attn.q_proj | mse: 0.024303976714841545, bpp_loss: 3.4658377187442966, bpp: 0
2025-03-03 04:36:44 - INFO - layer11_self_attn.k_proj | mse: 0.027696636636034198, bpp_loss: 4.407294847536832, bpp: 0
2025-03-03 04:36:52 - INFO - layer11_self_attn.v_proj | mse: 0.02077746473580909, bpp_loss: 2.693786619056482, bpp: 0
2025-03-03 04:37:01 - INFO - layer11_self_attn.o_proj | mse: 0.025586772679414754, bpp_loss: 2.8349569181445986, bpp: 0
2025-03-03 04:37:12 - INFO - layer11_mlp.gate_proj | mse: 0.022743719395214565, bpp_loss: 3.1976756059697697, bpp: 0
2025-03-03 04:37:23 - INFO - layer11_mlp.up_proj | mse: 0.021708142558311844, bpp_loss: 2.967870733168508, bpp: 0
2025-03-03 04:38:01 - INFO - layer11_mlp.down_proj | mse: 0.021974749936447276, bpp_loss: 2.970036953471468, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [19:09<31:47, 95.38s/it]2025-03-03 04:38:10 - INFO - layer12_self_attn.q_proj | mse: 0.024598061300159256, bpp_loss: 3.522520655707922, bpp: 0
2025-03-03 04:38:19 - INFO - layer12_self_attn.k_proj | mse: 0.02784045452031317, bpp_loss: 4.406724259490147, bpp: 0
2025-03-03 04:38:27 - INFO - layer12_self_attn.v_proj | mse: 0.021420502444190043, bpp_loss: 2.8088439341518097, bpp: 0
2025-03-03 04:38:36 - INFO - layer12_self_attn.o_proj | mse: 0.026154842168702806, bpp_loss: 2.8797716825501993, bpp: 0
2025-03-03 04:38:47 - INFO - layer12_mlp.gate_proj | mse: 0.022704667261377355, bpp_loss: 3.1784639145646776, bpp: 0
2025-03-03 04:38:58 - INFO - layer12_mlp.up_proj | mse: 0.021837347346006907, bpp_loss: 2.9859886463465437, bpp: 0
2025-03-03 04:39:36 - INFO - layer12_mlp.down_proj | mse: 0.02227180771516777, bpp_loss: 2.981752476006347, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [20:44<30:10, 95.31s/it]2025-03-03 04:39:45 - INFO - layer13_self_attn.q_proj | mse: 0.024828413845989966, bpp_loss: 3.4951216847402975, bpp: 0
2025-03-03 04:39:54 - INFO - layer13_self_attn.k_proj | mse: 0.02811567935850327, bpp_loss: 4.420718031411525, bpp: 0
2025-03-03 04:40:02 - INFO - layer13_self_attn.v_proj | mse: 0.021463840752508866, bpp_loss: 2.7507393019623123, bpp: 0
2025-03-03 04:40:11 - INFO - layer13_self_attn.o_proj | mse: 0.026475585339745294, bpp_loss: 2.8619094823370688, bpp: 0
2025-03-03 04:40:22 - INFO - layer13_mlp.gate_proj | mse: 0.02295034640399053, bpp_loss: 3.183127097918519, bpp: 0
2025-03-03 04:40:33 - INFO - layer13_mlp.up_proj | mse: 0.02208054993108636, bpp_loss: 2.9896325305370346, bpp: 0
2025-03-03 04:41:11 - INFO - layer13_mlp.down_proj | mse: 0.022423041614561504, bpp_loss: 2.98194290180358, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [22:19<28:33, 95.19s/it]2025-03-03 04:41:20 - INFO - layer14_self_attn.q_proj | mse: 0.02480590961930989, bpp_loss: 3.4663086271611974, bpp: 0
2025-03-03 04:41:29 - INFO - layer14_self_attn.k_proj | mse: 0.028028327730946927, bpp_loss: 4.370456169650424, bpp: 0
2025-03-03 04:41:37 - INFO - layer14_self_attn.v_proj | mse: 0.02139037464998826, bpp_loss: 2.743221718701534, bpp: 0
2025-03-03 04:41:46 - INFO - layer14_self_attn.o_proj | mse: 0.026370040284852327, bpp_loss: 2.8532467989134602, bpp: 0
2025-03-03 04:41:57 - INFO - layer14_mlp.gate_proj | mse: 0.02302114019167236, bpp_loss: 3.2114144562344467, bpp: 0
2025-03-03 04:42:08 - INFO - layer14_mlp.up_proj | mse: 0.0220160154108076, bpp_loss: 2.9840677859527722, bpp: 0
2025-03-03 04:42:46 - INFO - layer14_mlp.down_proj | mse: 0.022303289462907584, bpp_loss: 2.9776934607819254, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [23:54<26:57, 95.17s/it]2025-03-03 04:42:55 - INFO - layer15_self_attn.q_proj | mse: 0.02506724313837911, bpp_loss: 3.5912197622819804, bpp: 0
2025-03-03 04:43:04 - INFO - layer15_self_attn.k_proj | mse: 0.0280648449525358, bpp_loss: 4.415404728788417, bpp: 0
2025-03-03 04:43:12 - INFO - layer15_self_attn.v_proj | mse: 0.02153225151574565, bpp_loss: 2.803946029045619, bpp: 0
2025-03-03 04:43:21 - INFO - layer15_self_attn.o_proj | mse: 0.02486964745288203, bpp_loss: 2.8828106559230946, bpp: 0
2025-03-03 04:43:32 - INFO - layer15_mlp.gate_proj | mse: 0.023318456221044767, bpp_loss: 3.2476222118628875, bpp: 0
2025-03-03 04:43:43 - INFO - layer15_mlp.up_proj | mse: 0.022111208918736427, bpp_loss: 2.977633091355009, bpp: 0
2025-03-03 04:44:21 - INFO - layer15_mlp.down_proj | mse: 0.022484644327759904, bpp_loss: 2.972493726410903, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [25:29<25:21, 95.12s/it]2025-03-03 04:44:30 - INFO - layer16_self_attn.q_proj | mse: 0.025402173126884565, bpp_loss: 3.569249459542334, bpp: 0
2025-03-03 04:44:39 - INFO - layer16_self_attn.k_proj | mse: 0.028428365854159907, bpp_loss: 4.407219442189671, bpp: 0
2025-03-03 04:44:47 - INFO - layer16_self_attn.v_proj | mse: 0.021610093601067526, bpp_loss: 2.763102216005791, bpp: 0
2025-03-03 04:44:56 - INFO - layer16_self_attn.o_proj | mse: 0.026371987097459047, bpp_loss: 2.864573242259212, bpp: 0
2025-03-03 04:45:07 - INFO - layer16_mlp.gate_proj | mse: 0.023351540447188752, bpp_loss: 3.279702307124223, bpp: 0
2025-03-03 04:45:18 - INFO - layer16_mlp.up_proj | mse: 0.02191600287949598, bpp_loss: 2.9654861371964216, bpp: 0
2025-03-03 04:45:56 - INFO - layer16_mlp.down_proj | mse: 0.022002980374697632, bpp_loss: 2.9595482675358653, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [27:04<23:45, 95.05s/it]2025-03-03 04:46:05 - INFO - layer17_self_attn.q_proj | mse: 0.02475301251903292, bpp_loss: 3.583210769749712, bpp: 0
2025-03-03 04:46:14 - INFO - layer17_self_attn.k_proj | mse: 0.02770291742432493, bpp_loss: 4.433776147372555, bpp: 0
2025-03-03 04:46:22 - INFO - layer17_self_attn.v_proj | mse: 0.021474913249209596, bpp_loss: 2.8298966103466228, bpp: 0
2025-03-03 04:46:31 - INFO - layer17_self_attn.o_proj | mse: 0.024489538085504817, bpp_loss: 2.892606938024983, bpp: 0
2025-03-03 04:46:42 - INFO - layer17_mlp.gate_proj | mse: 0.02345235421770246, bpp_loss: 3.2928752321084693, bpp: 0
2025-03-03 04:46:53 - INFO - layer17_mlp.up_proj | mse: 0.02194266063749431, bpp_loss: 2.9632833864140724, bpp: 0
2025-03-03 04:47:31 - INFO - layer17_mlp.down_proj | mse: 0.022038405411237794, bpp_loss: 2.9564817792769253, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [28:39<22:09, 94.98s/it]2025-03-03 04:47:40 - INFO - layer18_self_attn.q_proj | mse: 0.024938712947739528, bpp_loss: 3.5821352415368892, bpp: 0
2025-03-03 04:47:48 - INFO - layer18_self_attn.k_proj | mse: 0.02806007642046636, bpp_loss: 4.506107012159191, bpp: 0
2025-03-03 04:47:57 - INFO - layer18_self_attn.v_proj | mse: 0.02106565818506167, bpp_loss: 2.7576253268052824, bpp: 0
2025-03-03 04:48:06 - INFO - layer18_self_attn.o_proj | mse: 0.023947482589969822, bpp_loss: 2.8727601447026245, bpp: 0
2025-03-03 04:48:17 - INFO - layer18_mlp.gate_proj | mse: 0.023318121819559598, bpp_loss: 3.300967770628631, bpp: 0
2025-03-03 04:48:28 - INFO - layer18_mlp.up_proj | mse: 0.02175470051558347, bpp_loss: 2.960098811757884, bpp: 0
2025-03-03 04:49:05 - INFO - layer18_mlp.down_proj | mse: 0.02160847601665567, bpp_loss: 2.9556221120957553, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [30:13<20:33, 94.88s/it]2025-03-03 04:49:15 - INFO - layer19_self_attn.q_proj | mse: 0.024634178729873536, bpp_loss: 3.5852242665132508, bpp: 0
2025-03-03 04:49:23 - INFO - layer19_self_attn.k_proj | mse: 0.027471014960719523, bpp_loss: 4.4175520410062745, bpp: 0
2025-03-03 04:49:31 - INFO - layer19_self_attn.v_proj | mse: 0.021051506132109533, bpp_loss: 2.8021556335734203, bpp: 0
2025-03-03 04:49:40 - INFO - layer19_self_attn.o_proj | mse: 0.02359930587431521, bpp_loss: 2.8863325589336455, bpp: 0
2025-03-03 04:49:51 - INFO - layer19_mlp.gate_proj | mse: 0.023202523199223928, bpp_loss: 3.311535588465631, bpp: 0
2025-03-03 04:50:02 - INFO - layer19_mlp.up_proj | mse: 0.02158606780624361, bpp_loss: 2.956786613312683, bpp: 0
2025-03-03 04:50:40 - INFO - layer19_mlp.down_proj | mse: 0.021392366573686424, bpp_loss: 2.953209940693341, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [31:48<18:59, 94.93s/it]2025-03-03 04:50:50 - INFO - layer20_self_attn.q_proj | mse: 0.024483367384831728, bpp_loss: 3.558131084020715, bpp: 0
2025-03-03 04:50:58 - INFO - layer20_self_attn.k_proj | mse: 0.0272631087007175, bpp_loss: 4.376366744108964, bpp: 0
2025-03-03 04:51:06 - INFO - layer20_self_attn.v_proj | mse: 0.02127591539510886, bpp_loss: 2.8347181067219935, bpp: 0
2025-03-03 04:51:15 - INFO - layer20_self_attn.o_proj | mse: 0.023444960137338582, bpp_loss: 2.8734422105480917, bpp: 0
2025-03-03 04:51:26 - INFO - layer20_mlp.gate_proj | mse: 0.02316247117183701, bpp_loss: 3.313645850733987, bpp: 0
2025-03-03 04:51:38 - INFO - layer20_mlp.up_proj | mse: 0.021548765486118397, bpp_loss: 2.9604435205858732, bpp: 0
2025-03-03 04:52:15 - INFO - layer20_mlp.down_proj | mse: 0.02132581902268507, bpp_loss: 2.9572422698007097, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [33:23<17:24, 94.94s/it]2025-03-03 04:52:25 - INFO - layer21_self_attn.q_proj | mse: 0.024443547534713592, bpp_loss: 3.5584003443364054, bpp: 0
2025-03-03 04:52:33 - INFO - layer21_self_attn.k_proj | mse: 0.027417286409225097, bpp_loss: 4.4147849277360365, bpp: 0
2025-03-03 04:52:41 - INFO - layer21_self_attn.v_proj | mse: 0.021373789081277725, bpp_loss: 2.859403881826438, bpp: 0
2025-03-03 04:52:50 - INFO - layer21_self_attn.o_proj | mse: 0.02472873819934286, bpp_loss: 2.889053061720915, bpp: 0
2025-03-03 04:53:01 - INFO - layer21_mlp.gate_proj | mse: 0.023301357048072978, bpp_loss: 3.324287163359778, bpp: 0
2025-03-03 04:53:12 - INFO - layer21_mlp.up_proj | mse: 0.021644646006999425, bpp_loss: 2.9631572293915918, bpp: 0
2025-03-03 04:53:50 - INFO - layer21_mlp.down_proj | mse: 0.02152842162546874, bpp_loss: 2.9581946286905025, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [34:58<15:48, 94.83s/it]2025-03-03 04:53:59 - INFO - layer22_self_attn.q_proj | mse: 0.024523636276548137, bpp_loss: 3.521471501328051, bpp: 0
2025-03-03 04:54:08 - INFO - layer22_self_attn.k_proj | mse: 0.027422538747403646, bpp_loss: 4.356209504883736, bpp: 0
2025-03-03 04:54:16 - INFO - layer22_self_attn.v_proj | mse: 0.021766988735505338, bpp_loss: 2.9080987260094844, bpp: 0
2025-03-03 04:54:25 - INFO - layer22_self_attn.o_proj | mse: 0.023915962766813383, bpp_loss: 2.9191400284762494, bpp: 0
2025-03-03 04:54:36 - INFO - layer22_mlp.gate_proj | mse: 0.023325475341327503, bpp_loss: 3.329235912234123, bpp: 0
2025-03-03 04:54:47 - INFO - layer22_mlp.up_proj | mse: 0.021681797680911025, bpp_loss: 2.967563992831856, bpp: 0
2025-03-03 04:55:25 - INFO - layer22_mlp.down_proj | mse: 0.021430549594752775, bpp_loss: 2.964450421942664, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [36:33<14:13, 94.86s/it]2025-03-03 04:55:34 - INFO - layer23_self_attn.q_proj | mse: 0.02438202593870714, bpp_loss: 3.532261257758364, bpp: 0
2025-03-03 04:55:43 - INFO - layer23_self_attn.k_proj | mse: 0.027289419641333933, bpp_loss: 4.359438608633354, bpp: 0
2025-03-03 04:55:51 - INFO - layer23_self_attn.v_proj | mse: 0.02191222906768595, bpp_loss: 2.9584159507066943, bpp: 0
2025-03-03 04:56:00 - INFO - layer23_self_attn.o_proj | mse: 0.022738787180239948, bpp_loss: 2.942436942947097, bpp: 0
2025-03-03 04:56:11 - INFO - layer23_mlp.gate_proj | mse: 0.023349722759907987, bpp_loss: 3.3312678057700396, bpp: 0
2025-03-03 04:56:22 - INFO - layer23_mlp.up_proj | mse: 0.02170116979071022, bpp_loss: 2.971241926242198, bpp: 0
2025-03-03 04:57:01 - INFO - layer23_mlp.down_proj | mse: 0.021179629288268102, bpp_loss: 2.969280961784534, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [38:09<12:41, 95.14s/it]2025-03-03 04:57:10 - INFO - layer24_self_attn.q_proj | mse: 0.024188318084338363, bpp_loss: 3.501945464871824, bpp: 0
2025-03-03 04:57:18 - INFO - layer24_self_attn.k_proj | mse: 0.0266260924953173, bpp_loss: 4.205290726386011, bpp: 0
2025-03-03 04:57:26 - INFO - layer24_self_attn.v_proj | mse: 0.022332811568280722, bpp_loss: 3.0498800300993025, bpp: 0
2025-03-03 04:57:35 - INFO - layer24_self_attn.o_proj | mse: 0.023718007848037678, bpp_loss: 2.98008509905776, bpp: 0
2025-03-03 04:57:46 - INFO - layer24_mlp.gate_proj | mse: 0.023261674186682058, bpp_loss: 3.3369013173505664, bpp: 0
2025-03-03 04:57:57 - INFO - layer24_mlp.up_proj | mse: 0.021610209275838694, bpp_loss: 2.97583408148161, bpp: 0
2025-03-03 04:58:35 - INFO - layer24_mlp.down_proj | mse: 0.02096583913480737, bpp_loss: 2.973918162735312, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [39:43<11:04, 94.87s/it]2025-03-03 04:58:44 - INFO - layer25_self_attn.q_proj | mse: 0.02390840148570692, bpp_loss: 3.4837415854563005, bpp: 0
2025-03-03 04:58:53 - INFO - layer25_self_attn.k_proj | mse: 0.02639806627466992, bpp_loss: 4.186392769042868, bpp: 0
2025-03-03 04:59:01 - INFO - layer25_self_attn.v_proj | mse: 0.022184781384105658, bpp_loss: 3.061814228014555, bpp: 0
2025-03-03 04:59:10 - INFO - layer25_self_attn.o_proj | mse: 0.023613585397140403, bpp_loss: 2.9805532781174406, bpp: 0
2025-03-03 04:59:21 - INFO - layer25_mlp.gate_proj | mse: 0.023187468510579776, bpp_loss: 3.344956190924027, bpp: 0
2025-03-03 04:59:32 - INFO - layer25_mlp.up_proj | mse: 0.021556249788665157, bpp_loss: 2.9845316226461103, bpp: 0
2025-03-03 05:00:09 - INFO - layer25_mlp.down_proj | mse: 0.020844731167230908, bpp_loss: 2.982018878683448, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [41:17<09:28, 94.73s/it]2025-03-03 05:00:18 - INFO - layer26_self_attn.q_proj | mse: 0.023894492784330625, bpp_loss: 3.4933238016674295, bpp: 0
2025-03-03 05:00:27 - INFO - layer26_self_attn.k_proj | mse: 0.02648195883339825, bpp_loss: 4.2618540114490315, bpp: 0
2025-03-03 05:00:35 - INFO - layer26_self_attn.v_proj | mse: 0.022540594703973543, bpp_loss: 3.106946163577959, bpp: 0
2025-03-03 05:00:44 - INFO - layer26_self_attn.o_proj | mse: 0.02588735822825848, bpp_loss: 3.004539949062746, bpp: 0
2025-03-03 05:00:55 - INFO - layer26_mlp.gate_proj | mse: 0.023140680445355485, bpp_loss: 3.349350572563708, bpp: 0
2025-03-03 05:01:05 - INFO - layer26_mlp.up_proj | mse: 0.021511256234381073, bpp_loss: 2.993328942119011, bpp: 0
2025-03-03 05:01:43 - INFO - layer26_mlp.down_proj | mse: 0.02080815062456873, bpp_loss: 2.9894664511250864, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [42:51<07:51, 94.35s/it]2025-03-03 05:01:52 - INFO - layer27_self_attn.q_proj | mse: 0.023622293907104398, bpp_loss: 3.464106709579937, bpp: 0
2025-03-03 05:02:00 - INFO - layer27_self_attn.k_proj | mse: 0.026172543098802608, bpp_loss: 4.218960918718949, bpp: 0
2025-03-03 05:02:08 - INFO - layer27_self_attn.v_proj | mse: 0.022649742231301714, bpp_loss: 3.194010676990729, bpp: 0
2025-03-03 05:02:17 - INFO - layer27_self_attn.o_proj | mse: 0.02377167701015943, bpp_loss: 3.033615116844885, bpp: 0
2025-03-03 05:02:28 - INFO - layer27_mlp.gate_proj | mse: 0.023062440430543524, bpp_loss: 3.3583960071472183, bpp: 0
2025-03-03 05:02:39 - INFO - layer27_mlp.up_proj | mse: 0.02147093767907776, bpp_loss: 3.008080206545336, bpp: 0
2025-03-03 05:03:16 - INFO - layer27_mlp.down_proj | mse: 0.020915533232177225, bpp_loss: 2.9993283502657766, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [44:24<06:16, 94.01s/it]2025-03-03 05:03:25 - INFO - layer28_self_attn.q_proj | mse: 0.02359039167432878, bpp_loss: 3.4752462598262355, bpp: 0
2025-03-03 05:03:34 - INFO - layer28_self_attn.k_proj | mse: 0.026089566005526248, bpp_loss: 4.184005223272834, bpp: 0
2025-03-03 05:03:42 - INFO - layer28_self_attn.v_proj | mse: 0.02292891139295022, bpp_loss: 3.2409512677113526, bpp: 0
2025-03-03 05:03:50 - INFO - layer28_self_attn.o_proj | mse: 0.024440653389186637, bpp_loss: 3.061097568832338, bpp: 0
2025-03-03 05:04:01 - INFO - layer28_mlp.gate_proj | mse: 0.023042565063063677, bpp_loss: 3.3450196783191393, bpp: 0
2025-03-03 05:04:12 - INFO - layer28_mlp.up_proj | mse: 0.021593151489189326, bpp_loss: 3.029352631685989, bpp: 0
2025-03-03 05:04:50 - INFO - layer28_mlp.down_proj | mse: 0.021140555633543234, bpp_loss: 3.0137012028301666, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [45:58<04:41, 93.94s/it]2025-03-03 05:04:59 - INFO - layer29_self_attn.q_proj | mse: 0.023522661716095836, bpp_loss: 3.4661738050053827, bpp: 0
2025-03-03 05:05:08 - INFO - layer29_self_attn.k_proj | mse: 0.026407281767083582, bpp_loss: 4.260104202723596, bpp: 0
2025-03-03 05:05:17 - INFO - layer29_self_attn.v_proj | mse: 0.02315248485916824, bpp_loss: 3.304971235396806, bpp: 0
2025-03-03 05:05:27 - INFO - layer29_self_attn.o_proj | mse: 0.02539896899780267, bpp_loss: 3.0964350007707253, bpp: 0
2025-03-03 05:05:38 - INFO - layer29_mlp.gate_proj | mse: 0.02314578917299523, bpp_loss: 3.336491598814194, bpp: 0
2025-03-03 05:05:49 - INFO - layer29_mlp.up_proj | mse: 0.02185564010051734, bpp_loss: 3.061709562915244, bpp: 0
2025-03-03 05:06:27 - INFO - layer29_mlp.down_proj | mse: 0.021347111457844632, bpp_loss: 3.027585344472235, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [47:35<03:09, 94.88s/it]2025-03-03 05:06:36 - INFO - layer30_self_attn.q_proj | mse: 0.023420342518104036, bpp_loss: 3.3756781453848816, bpp: 0
2025-03-03 05:06:45 - INFO - layer30_self_attn.k_proj | mse: 0.025506043691172348, bpp_loss: 3.9616279895417392, bpp: 0
2025-03-03 05:06:53 - INFO - layer30_self_attn.v_proj | mse: 0.024634862431919945, bpp_loss: 3.561534377571661, bpp: 0
2025-03-03 05:07:02 - INFO - layer30_self_attn.o_proj | mse: 0.02685749666760075, bpp_loss: 3.1779427099390887, bpp: 0
2025-03-03 05:07:13 - INFO - layer30_mlp.gate_proj | mse: 0.02345494169058027, bpp_loss: 3.38177701371855, bpp: 0
2025-03-03 05:07:24 - INFO - layer30_mlp.up_proj | mse: 0.02206271077066967, bpp_loss: 3.092259318035628, bpp: 0
2025-03-03 05:08:01 - INFO - layer30_mlp.down_proj | mse: 0.022209001487713344, bpp_loss: 3.027001340274832, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [49:09<01:34, 94.76s/it]2025-03-03 05:08:10 - INFO - layer31_self_attn.q_proj | mse: 0.024499738572392116, bpp_loss: 3.5145013740984723, bpp: 0
2025-03-03 05:08:19 - INFO - layer31_self_attn.k_proj | mse: 0.026905996057257183, bpp_loss: 4.167305710958317, bpp: 0
2025-03-03 05:08:27 - INFO - layer31_self_attn.v_proj | mse: 0.02411262125903922, bpp_loss: 3.4011165264528245, bpp: 0
2025-03-03 05:08:36 - INFO - layer31_self_attn.o_proj | mse: 0.027671070235358135, bpp_loss: 3.133823983138427, bpp: 0
2025-03-03 05:08:47 - INFO - layer31_mlp.gate_proj | mse: 0.025550602689070997, bpp_loss: 3.5784659357741475, bpp: 0
2025-03-03 05:08:58 - INFO - layer31_mlp.up_proj | mse: 0.024018469444845755, bpp_loss: 3.2726322592103054, bpp: 0
2025-03-03 05:09:36 - INFO - layer31_mlp.down_proj | mse: 0.02648896305460492, bpp_loss: 3.0499918832876056, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [50:44<00:00, 94.63s/it]pseudo compress quantization...: 100%|██████████| 32/32 [50:44<00:00, 95.13s/it]
2025-03-03 05:09:36 - INFO - #### Total | mse: 0.022853566249293796, bpp_loss: 3.1161192451522766, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda100_rdloss_ql_encdim512_M16_batch_size2048_total_iter1500000_lr0.0001_seed100/best_loss_model_loss_4.39201_bpp_5.10767_MSE_0.0081_total_iter_190000.pth.tar/COL_MSE0.02285_bpploss3.1161_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda100_rdloss_ql_encdim512_M16_batch_size2048_total_iter1500000_lr0.0001_seed100/best_loss_model_loss_4.39201_bpp_5.10767_MSE_0.0081_total_iter_190000.pth.tar/COL_MSE0.02285_bpploss3.1161_bpp0
I0303 05:10:05.046658 2994358 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:02,  1.17it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.17it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.18it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.42it/s]
I0303 05:10:08.011411 2994358 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.7421875:   0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.7421875:   1%|          | 1/141 [00:00<01:13,  1.90it/s]avg_loss = 2.01953125:   1%|          | 1/141 [00:00<01:13,  1.90it/s]avg_loss = 2.01953125:   1%|▏         | 2/141 [00:00<01:04,  2.17it/s]avg_loss = 2.1432291666666665:   1%|▏         | 2/141 [00:01<01:04,  2.17it/s]avg_loss = 2.1432291666666665:   2%|▏         | 3/141 [00:01<01:00,  2.27it/s]avg_loss = 2.087890625:   2%|▏         | 3/141 [00:01<01:00,  2.27it/s]       avg_loss = 2.087890625:   3%|▎         | 4/141 [00:01<00:59,  2.31it/s]avg_loss = 2.0359375:   3%|▎         | 4/141 [00:02<00:59,  2.31it/s]  avg_loss = 2.0359375:   4%|▎         | 5/141 [00:02<00:58,  2.34it/s]avg_loss = 1.9388020833333333:   4%|▎         | 5/141 [00:02<00:58,  2.34it/s]avg_loss = 1.9388020833333333:   4%|▍         | 6/141 [00:02<00:57,  2.35it/s]avg_loss = 1.8794642857142858:   4%|▍         | 6/141 [00:03<00:57,  2.35it/s]avg_loss = 1.8794642857142858:   5%|▍         | 7/141 [00:03<00:56,  2.37it/s]avg_loss = 1.8740234375:   5%|▍         | 7/141 [00:03<00:56,  2.37it/s]      avg_loss = 1.8740234375:   6%|▌         | 8/141 [00:03<00:56,  2.37it/s]avg_loss = 1.9053819444444444:   6%|▌         | 8/141 [00:03<00:56,  2.37it/s]avg_loss = 1.9053819444444444:   6%|▋         | 9/141 [00:03<00:55,  2.37it/s]avg_loss = 1.90390625:   6%|▋         | 9/141 [00:04<00:55,  2.37it/s]        avg_loss = 1.90390625:   7%|▋         | 10/141 [00:04<00:55,  2.37it/s]avg_loss = 1.8984375:   7%|▋         | 10/141 [00:04<00:55,  2.37it/s] avg_loss = 1.8984375:   8%|▊         | 11/141 [00:04<00:54,  2.37it/s]avg_loss = 1.919921875:   8%|▊         | 11/141 [00:05<00:54,  2.37it/s]avg_loss = 1.919921875:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.9308894230769231:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.9308894230769231:   9%|▉         | 13/141 [00:05<00:53,  2.38it/s]avg_loss = 1.9481026785714286:   9%|▉         | 13/141 [00:05<00:53,  2.38it/s]avg_loss = 1.9481026785714286:  10%|▉         | 14/141 [00:05<00:53,  2.37it/s]avg_loss = 1.9578125:  10%|▉         | 14/141 [00:06<00:53,  2.37it/s]         avg_loss = 1.9578125:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.97998046875:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.97998046875:  11%|█▏        | 16/141 [00:06<00:52,  2.37it/s]avg_loss = 1.982077205882353:  11%|█▏        | 16/141 [00:07<00:52,  2.37it/s]avg_loss = 1.982077205882353:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.9848090277777777:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.9848090277777777:  13%|█▎        | 18/141 [00:07<00:51,  2.37it/s]avg_loss = 1.972861842105263:  13%|█▎        | 18/141 [00:08<00:51,  2.37it/s] avg_loss = 1.972861842105263:  13%|█▎        | 19/141 [00:08<00:51,  2.37it/s]avg_loss = 1.971484375:  13%|█▎        | 19/141 [00:08<00:51,  2.37it/s]      avg_loss = 1.971484375:  14%|█▍        | 20/141 [00:08<00:50,  2.37it/s]avg_loss = 1.9758184523809523:  14%|█▍        | 20/141 [00:08<00:50,  2.37it/s]avg_loss = 1.9758184523809523:  15%|█▍        | 21/141 [00:08<00:50,  2.38it/s]avg_loss = 1.9783380681818181:  15%|█▍        | 21/141 [00:09<00:50,  2.38it/s]avg_loss = 1.9783380681818181:  16%|█▌        | 22/141 [00:09<00:49,  2.38it/s]avg_loss = 1.9799592391304348:  16%|█▌        | 22/141 [00:09<00:49,  2.38it/s]avg_loss = 1.9799592391304348:  16%|█▋        | 23/141 [00:09<00:49,  2.38it/s]avg_loss = 1.9840494791666667:  16%|█▋        | 23/141 [00:10<00:49,  2.38it/s]avg_loss = 1.9840494791666667:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]avg_loss = 1.9903125:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]         avg_loss = 1.9903125:  18%|█▊        | 25/141 [00:10<00:48,  2.38it/s]avg_loss = 2.0021033653846154:  18%|█▊        | 25/141 [00:11<00:48,  2.38it/s]avg_loss = 2.0021033653846154:  18%|█▊        | 26/141 [00:11<00:48,  2.38it/s]avg_loss = 2.014178240740741:  18%|█▊        | 26/141 [00:11<00:48,  2.38it/s] avg_loss = 2.014178240740741:  19%|█▉        | 27/141 [00:11<00:47,  2.38it/s]avg_loss = 2.0186941964285716:  19%|█▉        | 27/141 [00:11<00:47,  2.38it/s]avg_loss = 2.0186941964285716:  20%|█▉        | 28/141 [00:11<00:47,  2.38it/s]avg_loss = 2.015355603448276:  20%|█▉        | 28/141 [00:12<00:47,  2.38it/s] avg_loss = 2.015355603448276:  21%|██        | 29/141 [00:12<00:46,  2.38it/s]avg_loss = 2.0067708333333334:  21%|██        | 29/141 [00:12<00:46,  2.38it/s]avg_loss = 2.0067708333333334:  21%|██▏       | 30/141 [00:12<00:46,  2.38it/s]avg_loss = 1.994203629032258:  21%|██▏       | 30/141 [00:13<00:46,  2.38it/s] avg_loss = 1.994203629032258:  22%|██▏       | 31/141 [00:13<00:46,  2.38it/s]avg_loss = 1.983154296875:  22%|██▏       | 31/141 [00:13<00:46,  2.38it/s]   avg_loss = 1.983154296875:  23%|██▎       | 32/141 [00:13<00:45,  2.38it/s]avg_loss = 1.9812973484848484:  23%|██▎       | 32/141 [00:13<00:45,  2.38it/s]avg_loss = 1.9812973484848484:  23%|██▎       | 33/141 [00:13<00:45,  2.38it/s]avg_loss = 1.9795496323529411:  23%|██▎       | 33/141 [00:14<00:45,  2.38it/s]avg_loss = 1.9795496323529411:  24%|██▍       | 34/141 [00:14<00:45,  2.38it/s]avg_loss = 1.9823660714285714:  24%|██▍       | 34/141 [00:14<00:45,  2.38it/s]avg_loss = 1.9823660714285714:  25%|██▍       | 35/141 [00:14<00:44,  2.38it/s]avg_loss = 1.9659288194444444:  25%|██▍       | 35/141 [00:15<00:44,  2.38it/s]avg_loss = 1.9659288194444444:  26%|██▌       | 36/141 [00:15<00:44,  2.37it/s]avg_loss = 1.9503800675675675:  26%|██▌       | 36/141 [00:15<00:44,  2.37it/s]avg_loss = 1.9503800675675675:  26%|██▌       | 37/141 [00:15<00:43,  2.37it/s]avg_loss = 1.9352384868421053:  26%|██▌       | 37/141 [00:16<00:43,  2.37it/s]avg_loss = 1.9352384868421053:  27%|██▋       | 38/141 [00:16<00:43,  2.37it/s]avg_loss = 1.9208733974358974:  27%|██▋       | 38/141 [00:16<00:43,  2.37it/s]avg_loss = 1.9208733974358974:  28%|██▊       | 39/141 [00:16<00:43,  2.37it/s]avg_loss = 1.9125:  28%|██▊       | 39/141 [00:16<00:43,  2.37it/s]            avg_loss = 1.9125:  28%|██▊       | 40/141 [00:16<00:42,  2.37it/s]avg_loss = 1.9180640243902438:  28%|██▊       | 40/141 [00:17<00:42,  2.37it/s]avg_loss = 1.9180640243902438:  29%|██▉       | 41/141 [00:17<00:42,  2.37it/s]avg_loss = 1.9341517857142858:  29%|██▉       | 41/141 [00:17<00:42,  2.37it/s]avg_loss = 1.9341517857142858:  30%|██▉       | 42/141 [00:17<00:41,  2.37it/s]avg_loss = 1.9498546511627908:  30%|██▉       | 42/141 [00:18<00:41,  2.37it/s]avg_loss = 1.9498546511627908:  30%|███       | 43/141 [00:18<00:41,  2.37it/s]avg_loss = 1.9545454545454546:  30%|███       | 43/141 [00:18<00:41,  2.37it/s]avg_loss = 1.9545454545454546:  31%|███       | 44/141 [00:18<00:40,  2.37it/s]avg_loss = 1.9597222222222221:  31%|███       | 44/141 [00:19<00:40,  2.37it/s]avg_loss = 1.9597222222222221:  32%|███▏      | 45/141 [00:19<00:40,  2.37it/s]avg_loss = 1.9643342391304348:  32%|███▏      | 45/141 [00:19<00:40,  2.37it/s]avg_loss = 1.9643342391304348:  33%|███▎      | 46/141 [00:19<00:40,  2.37it/s]avg_loss = 1.9700797872340425:  33%|███▎      | 46/141 [00:19<00:40,  2.37it/s]avg_loss = 1.9700797872340425:  33%|███▎      | 47/141 [00:19<00:39,  2.37it/s]avg_loss = 1.9723307291666667:  33%|███▎      | 47/141 [00:20<00:39,  2.37it/s]avg_loss = 1.9723307291666667:  34%|███▍      | 48/141 [00:20<00:39,  2.36it/s]avg_loss = 1.9724170918367347:  34%|███▍      | 48/141 [00:20<00:39,  2.36it/s]avg_loss = 1.9724170918367347:  35%|███▍      | 49/141 [00:20<00:38,  2.36it/s]avg_loss = 1.9721875:  35%|███▍      | 49/141 [00:21<00:38,  2.36it/s]         avg_loss = 1.9721875:  35%|███▌      | 50/141 [00:21<00:38,  2.36it/s]avg_loss = 1.9667585784313726:  35%|███▌      | 50/141 [00:21<00:38,  2.36it/s]avg_loss = 1.9667585784313726:  36%|███▌      | 51/141 [00:21<00:38,  2.36it/s]avg_loss = 1.9627403846153846:  36%|███▌      | 51/141 [00:21<00:38,  2.36it/s]avg_loss = 1.9627403846153846:  37%|███▋      | 52/141 [00:21<00:37,  2.36it/s]avg_loss = 1.956073113207547:  37%|███▋      | 52/141 [00:22<00:37,  2.36it/s] avg_loss = 1.956073113207547:  38%|███▊      | 53/141 [00:22<00:37,  2.36it/s]avg_loss = 1.953125:  38%|███▊      | 53/141 [00:22<00:37,  2.36it/s]         avg_loss = 1.953125:  38%|███▊      | 54/141 [00:22<00:36,  2.36it/s]avg_loss = 1.9453125:  38%|███▊      | 54/141 [00:23<00:36,  2.36it/s]avg_loss = 1.9453125:  39%|███▉      | 55/141 [00:23<00:36,  2.36it/s]avg_loss = 1.9376395089285714:  39%|███▉      | 55/141 [00:23<00:36,  2.36it/s]avg_loss = 1.9376395089285714:  40%|███▉      | 56/141 [00:23<00:36,  2.36it/s]avg_loss = 1.9342105263157894:  40%|███▉      | 56/141 [00:24<00:36,  2.36it/s]avg_loss = 1.9342105263157894:  40%|████      | 57/141 [00:24<00:35,  2.36it/s]avg_loss = 1.9311691810344827:  40%|████      | 57/141 [00:24<00:35,  2.36it/s]avg_loss = 1.9311691810344827:  41%|████      | 58/141 [00:24<00:35,  2.36it/s]avg_loss = 1.933395127118644:  41%|████      | 58/141 [00:24<00:35,  2.36it/s] avg_loss = 1.933395127118644:  42%|████▏     | 59/141 [00:24<00:34,  2.36it/s]avg_loss = 1.9384114583333334:  42%|████▏     | 59/141 [00:25<00:34,  2.36it/s]avg_loss = 1.9384114583333334:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.9435194672131149:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.9435194672131149:  43%|████▎     | 61/141 [00:25<00:33,  2.35it/s]avg_loss = 1.9509828629032258:  43%|████▎     | 61/141 [00:26<00:33,  2.35it/s]avg_loss = 1.9509828629032258:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.9427083333333333:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.9427083333333333:  45%|████▍     | 63/141 [00:26<00:33,  2.35it/s]avg_loss = 1.9403076171875:  45%|████▍     | 63/141 [00:27<00:33,  2.35it/s]   avg_loss = 1.9403076171875:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 1.9377403846153847:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 1.9377403846153847:  46%|████▌     | 65/141 [00:27<00:32,  2.35it/s]avg_loss = 1.9316998106060606:  46%|████▌     | 65/141 [00:27<00:32,  2.35it/s]avg_loss = 1.9316998106060606:  47%|████▋     | 66/141 [00:27<00:31,  2.35it/s]avg_loss = 1.9291044776119404:  47%|████▋     | 66/141 [00:28<00:31,  2.35it/s]avg_loss = 1.9291044776119404:  48%|████▊     | 67/141 [00:28<00:31,  2.35it/s]avg_loss = 1.9264705882352942:  48%|████▊     | 67/141 [00:28<00:31,  2.35it/s]avg_loss = 1.9264705882352942:  48%|████▊     | 68/141 [00:28<00:31,  2.35it/s]avg_loss = 1.9242527173913044:  48%|████▊     | 68/141 [00:29<00:31,  2.35it/s]avg_loss = 1.9242527173913044:  49%|████▉     | 69/141 [00:29<00:30,  2.35it/s]avg_loss = 1.9252232142857142:  49%|████▉     | 69/141 [00:29<00:30,  2.35it/s]avg_loss = 1.9252232142857142:  50%|████▉     | 70/141 [00:29<00:30,  2.35it/s]avg_loss = 1.9286971830985915:  50%|████▉     | 70/141 [00:30<00:30,  2.35it/s]avg_loss = 1.9286971830985915:  50%|█████     | 71/141 [00:30<00:29,  2.35it/s]avg_loss = 1.9312065972222223:  50%|█████     | 71/141 [00:30<00:29,  2.35it/s]avg_loss = 1.9312065972222223:  51%|█████     | 72/141 [00:30<00:29,  2.35it/s]avg_loss = 1.9296875:  51%|█████     | 72/141 [00:30<00:29,  2.35it/s]         avg_loss = 1.9296875:  52%|█████▏    | 73/141 [00:30<00:28,  2.35it/s]avg_loss = 1.9310599662162162:  52%|█████▏    | 73/141 [00:31<00:28,  2.35it/s]avg_loss = 1.9310599662162162:  52%|█████▏    | 74/141 [00:31<00:28,  2.35it/s]avg_loss = 1.9307291666666666:  52%|█████▏    | 74/141 [00:31<00:28,  2.35it/s]avg_loss = 1.9307291666666666:  53%|█████▎    | 75/141 [00:31<00:28,  2.35it/s]avg_loss = 1.929173519736842:  53%|█████▎    | 75/141 [00:32<00:28,  2.35it/s] avg_loss = 1.929173519736842:  54%|█████▍    | 76/141 [00:32<00:27,  2.35it/s]avg_loss = 1.9302962662337662:  54%|█████▍    | 76/141 [00:32<00:27,  2.35it/s]avg_loss = 1.9302962662337662:  55%|█████▍    | 77/141 [00:32<00:27,  2.35it/s]avg_loss = 1.9323918269230769:  55%|█████▍    | 77/141 [00:33<00:27,  2.35it/s]avg_loss = 1.9323918269230769:  55%|█████▌    | 78/141 [00:33<00:26,  2.35it/s]avg_loss = 1.9362143987341771:  55%|█████▌    | 78/141 [00:33<00:26,  2.35it/s]avg_loss = 1.9362143987341771:  56%|█████▌    | 79/141 [00:33<00:26,  2.35it/s]avg_loss = 1.93271484375:  56%|█████▌    | 79/141 [00:33<00:26,  2.35it/s]     avg_loss = 1.93271484375:  57%|█████▋    | 80/141 [00:33<00:25,  2.35it/s]avg_loss = 1.9313271604938271:  57%|█████▋    | 80/141 [00:34<00:25,  2.35it/s]avg_loss = 1.9313271604938271:  57%|█████▋    | 81/141 [00:34<00:25,  2.35it/s]avg_loss = 1.9304496951219512:  57%|█████▋    | 81/141 [00:34<00:25,  2.35it/s]avg_loss = 1.9304496951219512:  58%|█████▊    | 82/141 [00:34<00:25,  2.34it/s]avg_loss = 1.9288403614457832:  58%|█████▊    | 82/141 [00:35<00:25,  2.34it/s]avg_loss = 1.9288403614457832:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]avg_loss = 1.9265252976190477:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]avg_loss = 1.9265252976190477:  60%|█████▉    | 84/141 [00:35<00:24,  2.34it/s]avg_loss = 1.924172794117647:  60%|█████▉    | 84/141 [00:36<00:24,  2.34it/s] avg_loss = 1.924172794117647:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s]avg_loss = 1.92578125:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s]       avg_loss = 1.92578125:  61%|██████    | 86/141 [00:36<00:23,  2.34it/s]avg_loss = 1.9277119252873562:  61%|██████    | 86/141 [00:36<00:23,  2.34it/s]avg_loss = 1.9277119252873562:  62%|██████▏   | 87/141 [00:36<00:23,  2.34it/s]avg_loss = 1.9288884943181819:  62%|██████▏   | 87/141 [00:37<00:23,  2.34it/s]avg_loss = 1.9288884943181819:  62%|██████▏   | 88/141 [00:37<00:22,  2.35it/s]avg_loss = 1.9374122191011236:  62%|██████▏   | 88/141 [00:37<00:22,  2.35it/s]avg_loss = 1.9374122191011236:  63%|██████▎   | 89/141 [00:37<00:22,  2.35it/s]avg_loss = 1.944704861111111:  63%|██████▎   | 89/141 [00:38<00:22,  2.35it/s] avg_loss = 1.944704861111111:  64%|██████▍   | 90/141 [00:38<00:21,  2.35it/s]avg_loss = 1.9478880494505495:  64%|██████▍   | 90/141 [00:38<00:21,  2.35it/s]avg_loss = 1.9478880494505495:  65%|██████▍   | 91/141 [00:38<00:21,  2.35it/s]avg_loss = 1.953040081521739:  65%|██████▍   | 91/141 [00:39<00:21,  2.35it/s] avg_loss = 1.953040081521739:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]avg_loss = 1.957913306451613:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]avg_loss = 1.957913306451613:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 1.958527260638298:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 1.958527260638298:  67%|██████▋   | 94/141 [00:39<00:19,  2.35it/s]avg_loss = 1.9624177631578947:  67%|██████▋   | 94/141 [00:40<00:19,  2.35it/s]avg_loss = 1.9624177631578947:  67%|██████▋   | 95/141 [00:40<00:19,  2.35it/s]avg_loss = 1.9629720052083333:  67%|██████▋   | 95/141 [00:40<00:19,  2.35it/s]avg_loss = 1.9629720052083333:  68%|██████▊   | 96/141 [00:40<00:19,  2.35it/s]avg_loss = 1.9646423969072164:  68%|██████▊   | 96/141 [00:41<00:19,  2.35it/s]avg_loss = 1.9646423969072164:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s]avg_loss = 1.961654974489796:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s] avg_loss = 1.961654974489796:  70%|██████▉   | 98/141 [00:41<00:18,  2.35it/s]avg_loss = 1.9628314393939394:  70%|██████▉   | 98/141 [00:41<00:18,  2.35it/s]avg_loss = 1.9628314393939394:  70%|███████   | 99/141 [00:41<00:17,  2.35it/s]avg_loss = 1.965234375:  70%|███████   | 99/141 [00:42<00:17,  2.35it/s]       avg_loss = 1.965234375:  71%|███████   | 100/141 [00:42<00:17,  2.35it/s]avg_loss = 1.9645730198019802:  71%|███████   | 100/141 [00:42<00:17,  2.35it/s]avg_loss = 1.9645730198019802:  72%|███████▏  | 101/141 [00:42<00:17,  2.35it/s]avg_loss = 1.9652267156862746:  72%|███████▏  | 101/141 [00:43<00:17,  2.35it/s]avg_loss = 1.9652267156862746:  72%|███████▏  | 102/141 [00:43<00:16,  2.35it/s]avg_loss = 1.9647299757281553:  72%|███████▏  | 102/141 [00:43<00:16,  2.35it/s]avg_loss = 1.9647299757281553:  73%|███████▎  | 103/141 [00:43<00:16,  2.35it/s]avg_loss = 1.9677734375:  73%|███████▎  | 103/141 [00:44<00:16,  2.35it/s]      avg_loss = 1.9677734375:  74%|███████▍  | 104/141 [00:44<00:15,  2.35it/s]avg_loss = 1.9670386904761905:  74%|███████▍  | 104/141 [00:44<00:15,  2.35it/s]avg_loss = 1.9670386904761905:  74%|███████▍  | 105/141 [00:44<00:15,  2.35it/s]avg_loss = 1.9663915094339623:  74%|███████▍  | 105/141 [00:44<00:15,  2.35it/s]avg_loss = 1.9663915094339623:  75%|███████▌  | 106/141 [00:44<00:14,  2.35it/s]avg_loss = 1.9643691588785046:  75%|███████▌  | 106/141 [00:45<00:14,  2.35it/s]avg_loss = 1.9643691588785046:  76%|███████▌  | 107/141 [00:45<00:14,  2.35it/s]avg_loss = 1.9622395833333333:  76%|███████▌  | 107/141 [00:45<00:14,  2.35it/s]avg_loss = 1.9622395833333333:  77%|███████▋  | 108/141 [00:45<00:14,  2.35it/s]avg_loss = 1.9601490825688073:  77%|███████▋  | 108/141 [00:46<00:14,  2.35it/s]avg_loss = 1.9601490825688073:  77%|███████▋  | 109/141 [00:46<00:13,  2.35it/s]avg_loss = 1.9578835227272726:  77%|███████▋  | 109/141 [00:46<00:13,  2.35it/s]avg_loss = 1.9578835227272726:  78%|███████▊  | 110/141 [00:46<00:13,  2.35it/s]avg_loss = 1.9602336711711712:  78%|███████▊  | 110/141 [00:47<00:13,  2.35it/s]avg_loss = 1.9602336711711712:  79%|███████▊  | 111/141 [00:47<00:12,  2.35it/s]avg_loss = 1.9599609375:  79%|███████▊  | 111/141 [00:47<00:12,  2.35it/s]      avg_loss = 1.9599609375:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s]avg_loss = 1.9608683628318584:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s]avg_loss = 1.9608683628318584:  80%|████████  | 113/141 [00:47<00:11,  2.35it/s]avg_loss = 1.9617598684210527:  80%|████████  | 113/141 [00:48<00:11,  2.35it/s]avg_loss = 1.9617598684210527:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.9608016304347826:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.9608016304347826:  82%|████████▏ | 115/141 [00:48<00:11,  2.34it/s]avg_loss = 1.9597925646551724:  82%|████████▏ | 115/141 [00:49<00:11,  2.34it/s]avg_loss = 1.9597925646551724:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.962005876068376:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s] avg_loss = 1.962005876068376:  83%|████████▎ | 117/141 [00:49<00:10,  2.34it/s]avg_loss = 1.9615995762711864:  83%|████████▎ | 117/141 [00:50<00:10,  2.34it/s]avg_loss = 1.9615995762711864:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.9600183823529411:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.9600183823529411:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]avg_loss = 1.958203125:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]       avg_loss = 1.958203125:  85%|████████▌ | 120/141 [00:50<00:08,  2.34it/s]avg_loss = 1.9583548553719008:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 1.9583548553719008:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.9588242827868851:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.9588242827868851:  87%|████████▋ | 122/141 [00:51<00:08,  2.34it/s]avg_loss = 1.9583333333333333:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 1.9583333333333333:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.9584173387096775:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.9584173387096775:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]avg_loss = 1.9571875:  88%|████████▊ | 124/141 [00:53<00:07,  2.34it/s]         avg_loss = 1.9571875:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 1.9575272817460319:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 1.9575272817460319:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 1.9572465551181102:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 1.9572465551181102:  90%|█████████ | 127/141 [00:53<00:05,  2.34it/s]avg_loss = 1.95599365234375:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]  avg_loss = 1.95599365234375:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.9559108527131783:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.9559108527131783:  91%|█████████▏| 129/141 [00:54<00:05,  2.34it/s]avg_loss = 1.9568509615384615:  91%|█████████▏| 129/141 [00:55<00:05,  2.34it/s]avg_loss = 1.9568509615384615:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 1.9577767175572518:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 1.9577767175572518:  93%|█████████▎| 131/141 [00:55<00:04,  2.34it/s]avg_loss = 1.9583333333333333:  93%|█████████▎| 131/141 [00:56<00:04,  2.34it/s]avg_loss = 1.9583333333333333:  94%|█████████▎| 132/141 [00:56<00:03,  2.34it/s]avg_loss = 1.9553571428571428:  94%|█████████▎| 132/141 [00:56<00:03,  2.34it/s]avg_loss = 1.9553571428571428:  94%|█████████▍| 133/141 [00:56<00:03,  2.33it/s]avg_loss = 1.9507346082089552:  94%|█████████▍| 133/141 [00:56<00:03,  2.33it/s]avg_loss = 1.9507346082089552:  95%|█████████▌| 134/141 [00:56<00:02,  2.33it/s]avg_loss = 1.9528356481481481:  95%|█████████▌| 134/141 [00:57<00:02,  2.33it/s]avg_loss = 1.9528356481481481:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.9562844669117647:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.9562844669117647:  96%|█████████▋| 136/141 [00:57<00:02,  2.33it/s]avg_loss = 1.9576300182481752:  96%|█████████▋| 136/141 [00:58<00:02,  2.33it/s]avg_loss = 1.9576300182481752:  97%|█████████▋| 137/141 [00:58<00:01,  2.34it/s]avg_loss = 1.956634963768116:  97%|█████████▋| 137/141 [00:58<00:01,  2.34it/s] avg_loss = 1.956634963768116:  98%|█████████▊| 138/141 [00:58<00:01,  2.33it/s]avg_loss = 1.957171762589928:  98%|█████████▊| 138/141 [00:59<00:01,  2.33it/s]avg_loss = 1.957171762589928:  99%|█████████▊| 139/141 [00:59<00:00,  2.34it/s]avg_loss = 1.9579241071428573:  99%|█████████▊| 139/141 [00:59<00:00,  2.34it/s]avg_loss = 1.9579241071428573:  99%|█████████▉| 140/141 [00:59<00:00,  2.33it/s]avg_loss = 1.9592198581560283:  99%|█████████▉| 140/141 [00:59<00:00,  2.33it/s]avg_loss = 1.9592198581560283: 100%|██████████| 141/141 [00:59<00:00,  2.33it/s]avg_loss = 1.9592198581560283: 100%|██████████| 141/141 [00:59<00:00,  2.35it/s]
I0303 05:11:55.955760 2994358 eval_ppl.py:105] wikitext2 perplexity: 7.093790531158447
wikitext2 perplexity: 7.094
Running with lmbda=200
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.72it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.66it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.00it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.27it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.19it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.06it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.24it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:22,  1.40it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:21,  1.39it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:02<00:20,  1.39it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:02<00:20,  1.39it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:03<00:19,  1.39it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:04<00:18,  1.40it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:05<00:17,  1.40it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:05<00:17,  1.41it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:06<00:17,  1.29it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:07<00:18,  1.18it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:08<00:16,  1.24it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:09<00:15,  1.25it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:09<00:14,  1.29it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:10<00:14,  1.28it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:11<00:12,  1.31it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:11<00:11,  1.39it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:12<00:10,  1.44it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:13<00:09,  1.51it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:13<00:08,  1.53it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:14<00:07,  1.60it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:14<00:06,  1.67it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:15<00:05,  1.72it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:16<00:05,  1.73it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:16<00:04,  1.70it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:17<00:04,  1.64it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:18<00:03,  1.55it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:19<00:03,  1.35it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:19<00:03,  1.26it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:20<00:02,  1.29it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:21<00:01,  1.46it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:21<00:00,  1.61it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:22<00:00,  1.74it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:22<00:00,  1.45it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 05:12:49 - INFO - layer0_self_attn.q_proj | mse: 0.028038476071067974, bpp_loss: 3.931453018449247, bpp: 0
2025-03-03 05:12:57 - INFO - layer0_self_attn.k_proj | mse: 0.039128366615383305, bpp_loss: 4.518328288337216, bpp: 0
2025-03-03 05:13:06 - INFO - layer0_self_attn.v_proj | mse: 0.016316100295931186, bpp_loss: 3.0726011384977028, bpp: 0
2025-03-03 05:13:15 - INFO - layer0_self_attn.o_proj | mse: 0.012393950801348858, bpp_loss: 3.1641253298148513, bpp: 0
2025-03-03 05:13:26 - INFO - layer0_mlp.gate_proj | mse: 0.011972818069597487, bpp_loss: 3.5667299543773487, bpp: 0
2025-03-03 05:13:37 - INFO - layer0_mlp.up_proj | mse: 0.011884478136661712, bpp_loss: 3.4536259226234898, bpp: 0
2025-03-03 05:14:15 - INFO - layer0_mlp.down_proj | mse: 0.01170344111876559, bpp_loss: 3.4467919645165757, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:35<49:12, 95.24s/it]2025-03-03 05:14:25 - INFO - layer1_self_attn.q_proj | mse: 0.015793359383207223, bpp_loss: 4.177000515395775, bpp: 0
2025-03-03 05:14:33 - INFO - layer1_self_attn.k_proj | mse: 0.017122397941275205, bpp_loss: 4.907456079497933, bpp: 0
2025-03-03 05:14:42 - INFO - layer1_self_attn.v_proj | mse: 0.01451703396321305, bpp_loss: 3.175674973987043, bpp: 0
2025-03-03 05:14:51 - INFO - layer1_self_attn.o_proj | mse: 0.014502401001194374, bpp_loss: 3.245045499294065, bpp: 0
2025-03-03 05:15:02 - INFO - layer1_mlp.gate_proj | mse: 0.012126273586778825, bpp_loss: 3.5773554228113165, bpp: 0
2025-03-03 05:15:13 - INFO - layer1_mlp.up_proj | mse: 0.012031371438559847, bpp_loss: 3.468009349025254, bpp: 0
2025-03-03 05:15:52 - INFO - layer1_mlp.down_proj | mse: 0.010408594698692826, bpp_loss: 3.461608315036366, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [03:12<48:06, 96.23s/it]2025-03-03 05:16:02 - INFO - layer2_self_attn.q_proj | mse: 0.013192548107543077, bpp_loss: 4.118671516713221, bpp: 0
2025-03-03 05:16:11 - INFO - layer2_self_attn.k_proj | mse: 0.014254851610670957, bpp_loss: 5.005519530328456, bpp: 0
2025-03-03 05:16:19 - INFO - layer2_self_attn.v_proj | mse: 0.01219951289225256, bpp_loss: 3.0841944770654663, bpp: 0
2025-03-03 05:16:28 - INFO - layer2_self_attn.o_proj | mse: 0.01169462862566651, bpp_loss: 3.1992285850574262, bpp: 0
2025-03-03 05:16:40 - INFO - layer2_mlp.gate_proj | mse: 0.01150174322099006, bpp_loss: 3.611148407350161, bpp: 0
2025-03-03 05:16:51 - INFO - layer2_mlp.up_proj | mse: 0.01137477163925288, bpp_loss: 3.4601821318667914, bpp: 0
2025-03-03 05:17:30 - INFO - layer2_mlp.down_proj | mse: 0.010991123741308603, bpp_loss: 3.4659382105039964, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:49<46:49, 96.87s/it]2025-03-03 05:17:40 - INFO - layer3_self_attn.q_proj | mse: 0.012166386658991316, bpp_loss: 4.158541984797921, bpp: 0
2025-03-03 05:17:48 - INFO - layer3_self_attn.k_proj | mse: 0.013009630288224498, bpp_loss: 5.0844056060304865, bpp: 0
2025-03-03 05:17:57 - INFO - layer3_self_attn.v_proj | mse: 0.011308988804024074, bpp_loss: 3.1815072933095507, bpp: 0
2025-03-03 05:18:06 - INFO - layer3_self_attn.o_proj | mse: 0.012135888043340632, bpp_loss: 3.2950594528228976, bpp: 0
2025-03-03 05:18:17 - INFO - layer3_mlp.gate_proj | mse: 0.011570607578320586, bpp_loss: 3.687175978241222, bpp: 0
2025-03-03 05:18:29 - INFO - layer3_mlp.up_proj | mse: 0.01136281099207298, bpp_loss: 3.4415575808047185, bpp: 0
2025-03-03 05:19:08 - INFO - layer3_mlp.down_proj | mse: 0.010866781846498105, bpp_loss: 3.4411370778522854, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [06:27<45:23, 97.28s/it]2025-03-03 05:19:17 - INFO - layer4_self_attn.q_proj | mse: 0.012136356639976253, bpp_loss: 4.122247202438302, bpp: 0
2025-03-03 05:19:26 - INFO - layer4_self_attn.k_proj | mse: 0.013041623777841056, bpp_loss: 5.062471570039634, bpp: 0
2025-03-03 05:19:35 - INFO - layer4_self_attn.v_proj | mse: 0.011366078649159794, bpp_loss: 3.2270135181606747, bpp: 0
2025-03-03 05:19:44 - INFO - layer4_self_attn.o_proj | mse: 0.012612537008783441, bpp_loss: 3.3052674015634693, bpp: 0
2025-03-03 05:19:55 - INFO - layer4_mlp.gate_proj | mse: 0.011530932166467705, bpp_loss: 3.7606074774105633, bpp: 0
2025-03-03 05:20:06 - INFO - layer4_mlp.up_proj | mse: 0.011233770094214711, bpp_loss: 3.414053945403014, bpp: 0
2025-03-03 05:20:45 - INFO - layer4_mlp.down_proj | mse: 0.011097905419515533, bpp_loss: 3.4162891147092784, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [08:04<43:46, 97.28s/it]2025-03-03 05:20:55 - INFO - layer5_self_attn.q_proj | mse: 0.01226495998094072, bpp_loss: 4.097198600589763, bpp: 0
2025-03-03 05:21:04 - INFO - layer5_self_attn.k_proj | mse: 0.013267916118510577, bpp_loss: 5.035610583960079, bpp: 0
2025-03-03 05:21:12 - INFO - layer5_self_attn.v_proj | mse: 0.011404352202806441, bpp_loss: 3.114064750727266, bpp: 0
2025-03-03 05:21:21 - INFO - layer5_self_attn.o_proj | mse: 0.013043757449693513, bpp_loss: 3.253577465075068, bpp: 0
2025-03-03 05:21:32 - INFO - layer5_mlp.gate_proj | mse: 0.011440719088579118, bpp_loss: 3.762863921932876, bpp: 0
2025-03-03 05:21:44 - INFO - layer5_mlp.up_proj | mse: 0.01115023263013276, bpp_loss: 3.4192455490119755, bpp: 0
2025-03-03 05:22:22 - INFO - layer5_mlp.down_proj | mse: 0.011145829953153528, bpp_loss: 3.421459395687894, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [09:41<42:06, 97.16s/it]2025-03-03 05:22:31 - INFO - layer6_self_attn.q_proj | mse: 0.012043904044715616, bpp_loss: 4.14477424294455, bpp: 0
2025-03-03 05:22:40 - INFO - layer6_self_attn.k_proj | mse: 0.012864630410577158, bpp_loss: 5.107091742567718, bpp: 0
2025-03-03 05:22:48 - INFO - layer6_self_attn.v_proj | mse: 0.011185358960890842, bpp_loss: 3.159265869995579, bpp: 0
2025-03-03 05:22:57 - INFO - layer6_self_attn.o_proj | mse: 0.013074083691311309, bpp_loss: 3.284386139246635, bpp: 0
2025-03-03 05:23:08 - INFO - layer6_mlp.gate_proj | mse: 0.011436530792750033, bpp_loss: 3.7681240809948315, bpp: 0
2025-03-03 05:23:20 - INFO - layer6_mlp.up_proj | mse: 0.011143465966416794, bpp_loss: 3.418249719576644, bpp: 0
2025-03-03 05:23:58 - INFO - layer6_mlp.down_proj | mse: 0.011256046696121466, bpp_loss: 3.4214425667056014, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [11:18<40:22, 96.91s/it]2025-03-03 05:24:08 - INFO - layer7_self_attn.q_proj | mse: 0.012064746817482071, bpp_loss: 4.067771732690744, bpp: 0
2025-03-03 05:24:17 - INFO - layer7_self_attn.k_proj | mse: 0.012963410871070282, bpp_loss: 5.134317210060544, bpp: 0
2025-03-03 05:24:26 - INFO - layer7_self_attn.v_proj | mse: 0.01125590556876201, bpp_loss: 3.15755799470935, bpp: 0
2025-03-03 05:24:35 - INFO - layer7_self_attn.o_proj | mse: 0.013394159094041522, bpp_loss: 3.2961627966724336, bpp: 0
2025-03-03 05:24:46 - INFO - layer7_mlp.gate_proj | mse: 0.01142307858251005, bpp_loss: 3.7384536494500935, bpp: 0
2025-03-03 05:24:57 - INFO - layer7_mlp.up_proj | mse: 0.011159651329389512, bpp_loss: 3.431613361529474, bpp: 0
2025-03-03 05:25:36 - INFO - layer7_mlp.down_proj | mse: 0.01124479954914012, bpp_loss: 3.435004032366643, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [12:56<38:55, 97.31s/it]2025-03-03 05:25:46 - INFO - layer8_self_attn.q_proj | mse: 0.012033891141334694, bpp_loss: 4.053498420806136, bpp: 0
2025-03-03 05:25:55 - INFO - layer8_self_attn.k_proj | mse: 0.012942456562164901, bpp_loss: 5.040822262642905, bpp: 0
2025-03-03 05:26:03 - INFO - layer8_self_attn.v_proj | mse: 0.01125207712700638, bpp_loss: 3.179348084842786, bpp: 0
2025-03-03 05:26:12 - INFO - layer8_self_attn.o_proj | mse: 0.014101050517697397, bpp_loss: 3.3074377791490406, bpp: 0
2025-03-03 05:26:24 - INFO - layer8_mlp.gate_proj | mse: 0.01137005608167614, bpp_loss: 3.7437130450936302, bpp: 0
2025-03-03 05:26:35 - INFO - layer8_mlp.up_proj | mse: 0.01110462904145618, bpp_loss: 3.427145716002477, bpp: 0
2025-03-03 05:27:14 - INFO - layer8_mlp.down_proj | mse: 0.011280447244094912, bpp_loss: 3.4333033301268836, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [14:34<37:22, 97.48s/it]2025-03-03 05:27:24 - INFO - layer9_self_attn.q_proj | mse: 0.01192852642734168, bpp_loss: 4.065794944879599, bpp: 0
2025-03-03 05:27:33 - INFO - layer9_self_attn.k_proj | mse: 0.0128596735707407, bpp_loss: 5.061800884897821, bpp: 0
2025-03-03 05:27:41 - INFO - layer9_self_attn.v_proj | mse: 0.011249523383981344, bpp_loss: 3.2809012969373725, bpp: 0
2025-03-03 05:27:50 - INFO - layer9_self_attn.o_proj | mse: 0.014156764991873235, bpp_loss: 3.3642902427818626, bpp: 0
2025-03-03 05:28:02 - INFO - layer9_mlp.gate_proj | mse: 0.011377609913244567, bpp_loss: 3.7580090646765063, bpp: 0
2025-03-03 05:28:13 - INFO - layer9_mlp.up_proj | mse: 0.011105004001537322, bpp_loss: 3.436742281474705, bpp: 0
2025-03-03 05:28:52 - INFO - layer9_mlp.down_proj | mse: 0.011330923658373432, bpp_loss: 3.4357305322773755, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [16:12<35:47, 97.61s/it]2025-03-03 05:29:02 - INFO - layer10_self_attn.q_proj | mse: 0.011991081543284808, bpp_loss: 4.067573959531728, bpp: 0
2025-03-03 05:29:10 - INFO - layer10_self_attn.k_proj | mse: 0.012949680337812014, bpp_loss: 5.062949889572337, bpp: 0
2025-03-03 05:29:19 - INFO - layer10_self_attn.v_proj | mse: 0.011198358715160946, bpp_loss: 3.1697509675868787, bpp: 0
2025-03-03 05:29:28 - INFO - layer10_self_attn.o_proj | mse: 0.013605314387285268, bpp_loss: 3.3002277425839566, bpp: 0
2025-03-03 05:29:40 - INFO - layer10_mlp.gate_proj | mse: 0.011359805517338709, bpp_loss: 3.7269831420853734, bpp: 0
2025-03-03 05:29:51 - INFO - layer10_mlp.up_proj | mse: 0.011129044488505695, bpp_loss: 3.4540655513826226, bpp: 0
2025-03-03 05:30:30 - INFO - layer10_mlp.down_proj | mse: 0.011299079366449204, bpp_loss: 3.4516415638084124, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [17:49<34:08, 97.56s/it]2025-03-03 05:30:39 - INFO - layer11_self_attn.q_proj | mse: 0.01183376199211056, bpp_loss: 4.004480414034333, bpp: 0
2025-03-03 05:30:48 - INFO - layer11_self_attn.k_proj | mse: 0.012788049987294312, bpp_loss: 5.063003612740431, bpp: 0
2025-03-03 05:30:56 - INFO - layer11_self_attn.v_proj | mse: 0.011124294373349733, bpp_loss: 3.1749335489002988, bpp: 0
2025-03-03 05:31:05 - INFO - layer11_self_attn.o_proj | mse: 0.013405408310338991, bpp_loss: 3.3196997924824245, bpp: 0
2025-03-03 05:31:16 - INFO - layer11_mlp.gate_proj | mse: 0.011331770422530182, bpp_loss: 3.7055254287884702, bpp: 0
2025-03-03 05:31:28 - INFO - layer11_mlp.up_proj | mse: 0.011126615111379535, bpp_loss: 3.4586409237901017, bpp: 0
2025-03-03 05:32:06 - INFO - layer11_mlp.down_proj | mse: 0.01128901504056267, bpp_loss: 3.4590366069460288, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [19:26<32:24, 97.24s/it]2025-03-03 05:32:15 - INFO - layer12_self_attn.q_proj | mse: 0.011897658438763382, bpp_loss: 4.0634538033627905, bpp: 0
2025-03-03 05:32:24 - INFO - layer12_self_attn.k_proj | mse: 0.012759195443301834, bpp_loss: 5.059039750485681, bpp: 0
2025-03-03 05:32:33 - INFO - layer12_self_attn.v_proj | mse: 0.011245339330250306, bpp_loss: 3.293412076192908, bpp: 0
2025-03-03 05:32:42 - INFO - layer12_self_attn.o_proj | mse: 0.013593894245476199, bpp_loss: 3.3656450666021556, bpp: 0
2025-03-03 05:32:53 - INFO - layer12_mlp.gate_proj | mse: 0.01133558210282523, bpp_loss: 3.685858882298427, bpp: 0
2025-03-03 05:33:04 - INFO - layer12_mlp.up_proj | mse: 0.01116548431767164, bpp_loss: 3.4784334543427184, bpp: 0
2025-03-03 05:33:43 - INFO - layer12_mlp.down_proj | mse: 0.01142085117063731, bpp_loss: 3.471887350115659, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [21:02<30:43, 97.03s/it]2025-03-03 05:33:52 - INFO - layer13_self_attn.q_proj | mse: 0.012068768636829215, bpp_loss: 4.038130091736093, bpp: 0
2025-03-03 05:34:01 - INFO - layer13_self_attn.k_proj | mse: 0.013105306567604374, bpp_loss: 5.077094711596146, bpp: 0
2025-03-03 05:34:09 - INFO - layer13_self_attn.v_proj | mse: 0.011366266956926812, bpp_loss: 3.233357586315833, bpp: 0
2025-03-03 05:34:18 - INFO - layer13_self_attn.o_proj | mse: 0.013814139009781833, bpp_loss: 3.3474107581423596, bpp: 0
2025-03-03 05:34:30 - INFO - layer13_mlp.gate_proj | mse: 0.011459408324058354, bpp_loss: 3.6906525754103705, bpp: 0
2025-03-03 05:34:41 - INFO - layer13_mlp.up_proj | mse: 0.011281884177209397, bpp_loss: 3.481901142546641, bpp: 0
2025-03-03 05:35:19 - INFO - layer13_mlp.down_proj | mse: 0.011496485502589596, bpp_loss: 3.471790647350385, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [22:39<29:04, 96.91s/it]2025-03-03 05:35:29 - INFO - layer14_self_attn.q_proj | mse: 0.01207166857644131, bpp_loss: 4.005181637476198, bpp: 0
2025-03-03 05:35:37 - INFO - layer14_self_attn.k_proj | mse: 0.013146438778006503, bpp_loss: 5.022215969103854, bpp: 0
2025-03-03 05:35:46 - INFO - layer14_self_attn.v_proj | mse: 0.011362439963692468, bpp_loss: 3.226101879554335, bpp: 0
2025-03-03 05:35:55 - INFO - layer14_self_attn.o_proj | mse: 0.013772115958789575, bpp_loss: 3.3391106846975163, bpp: 0
2025-03-03 05:36:06 - INFO - layer14_mlp.gate_proj | mse: 0.011457446612375561, bpp_loss: 3.7223626895408546, bpp: 0
2025-03-03 05:36:17 - INFO - layer14_mlp.up_proj | mse: 0.011250565491579923, bpp_loss: 3.4761853511445224, bpp: 0
2025-03-03 05:36:56 - INFO - layer14_mlp.down_proj | mse: 0.011437543929922918, bpp_loss: 3.4675090892207145, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [24:15<27:24, 96.73s/it]2025-03-03 05:37:05 - INFO - layer15_self_attn.q_proj | mse: 0.012140552281877569, bpp_loss: 4.14779119414743, bpp: 0
2025-03-03 05:37:14 - INFO - layer15_self_attn.k_proj | mse: 0.012986199007922172, bpp_loss: 5.068445544340648, bpp: 0
2025-03-03 05:37:22 - INFO - layer15_self_attn.v_proj | mse: 0.01135402550354928, bpp_loss: 3.2893762878957205, bpp: 0
2025-03-03 05:37:31 - INFO - layer15_self_attn.o_proj | mse: 0.012928211803850542, bpp_loss: 3.3700648609665222, bpp: 0
2025-03-03 05:37:42 - INFO - layer15_mlp.gate_proj | mse: 0.01155848635220969, bpp_loss: 3.7604240952059627, bpp: 0
2025-03-03 05:37:54 - INFO - layer15_mlp.up_proj | mse: 0.011313782271352773, bpp_loss: 3.468802514752107, bpp: 0
2025-03-03 05:38:32 - INFO - layer15_mlp.down_proj | mse: 0.011532989066692069, bpp_loss: 3.46196273386678, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [25:52<25:46, 96.66s/it]2025-03-03 05:38:42 - INFO - layer16_self_attn.q_proj | mse: 0.012265519110156638, bpp_loss: 4.120857554255053, bpp: 0
2025-03-03 05:38:50 - INFO - layer16_self_attn.k_proj | mse: 0.01323087163517405, bpp_loss: 5.060275393188931, bpp: 0
2025-03-03 05:38:59 - INFO - layer16_self_attn.v_proj | mse: 0.011459233052982899, bpp_loss: 3.2466154707362875, bpp: 0
2025-03-03 05:39:08 - INFO - layer16_self_attn.o_proj | mse: 0.01377071523870721, bpp_loss: 3.3502550968551077, bpp: 0
2025-03-03 05:39:19 - INFO - layer16_mlp.gate_proj | mse: 0.011524389816619268, bpp_loss: 3.7947480802291205, bpp: 0
2025-03-03 05:39:30 - INFO - layer16_mlp.up_proj | mse: 0.011235159019195185, bpp_loss: 3.4557191183391427, bpp: 0
2025-03-03 05:40:09 - INFO - layer16_mlp.down_proj | mse: 0.011307462579918964, bpp_loss: 3.448369887374741, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [27:28<24:09, 96.60s/it]2025-03-03 05:40:18 - INFO - layer17_self_attn.q_proj | mse: 0.011937891117447672, bpp_loss: 4.136963598895818, bpp: 0
2025-03-03 05:40:27 - INFO - layer17_self_attn.k_proj | mse: 0.012856469441658804, bpp_loss: 5.089786119060591, bpp: 0
2025-03-03 05:40:35 - INFO - layer17_self_attn.v_proj | mse: 0.01123956262736667, bpp_loss: 3.3155223550857045, bpp: 0
2025-03-03 05:40:44 - INFO - layer17_self_attn.o_proj | mse: 0.01270843636044117, bpp_loss: 3.3802343290299177, bpp: 0
2025-03-03 05:40:56 - INFO - layer17_mlp.gate_proj | mse: 0.011560017646139297, bpp_loss: 3.809085332921573, bpp: 0
2025-03-03 05:41:07 - INFO - layer17_mlp.up_proj | mse: 0.01125744803699867, bpp_loss: 3.4530969341285527, bpp: 0
2025-03-03 05:41:45 - INFO - layer17_mlp.down_proj | mse: 0.01132598792556141, bpp_loss: 3.445571330958046, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [29:05<22:32, 96.61s/it]2025-03-03 05:41:55 - INFO - layer18_self_attn.q_proj | mse: 0.011990105964199521, bpp_loss: 4.132549617730547, bpp: 0
2025-03-03 05:42:03 - INFO - layer18_self_attn.k_proj | mse: 0.012948847438073275, bpp_loss: 5.170505147310905, bpp: 0
2025-03-03 05:42:12 - INFO - layer18_self_attn.v_proj | mse: 0.011186494601578096, bpp_loss: 3.2406615276122466, bpp: 0
2025-03-03 05:42:21 - INFO - layer18_self_attn.o_proj | mse: 0.012445074911573283, bpp_loss: 3.35847745888168, bpp: 0
2025-03-03 05:42:32 - INFO - layer18_mlp.gate_proj | mse: 0.011480274480096976, bpp_loss: 3.8167814069560597, bpp: 0
2025-03-03 05:42:43 - INFO - layer18_mlp.up_proj | mse: 0.01116715053101234, bpp_loss: 3.449330040386745, bpp: 0
2025-03-03 05:43:21 - INFO - layer18_mlp.down_proj | mse: 0.011106752987522867, bpp_loss: 3.444264991275434, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [30:41<20:54, 96.50s/it]2025-03-03 05:43:31 - INFO - layer19_self_attn.q_proj | mse: 0.011852492096583189, bpp_loss: 4.135100160550792, bpp: 0
2025-03-03 05:43:39 - INFO - layer19_self_attn.k_proj | mse: 0.012698427078363458, bpp_loss: 5.068822662695311, bpp: 0
2025-03-03 05:43:48 - INFO - layer19_self_attn.v_proj | mse: 0.011097446755597295, bpp_loss: 3.286662950180471, bpp: 0
2025-03-03 05:43:57 - INFO - layer19_self_attn.o_proj | mse: 0.012232727485312175, bpp_loss: 3.3725822676788084, bpp: 0
2025-03-03 05:44:08 - INFO - layer19_mlp.gate_proj | mse: 0.011408470866148053, bpp_loss: 3.828085349140955, bpp: 0
2025-03-03 05:44:19 - INFO - layer19_mlp.up_proj | mse: 0.01108467669541663, bpp_loss: 3.445769111160189, bpp: 0
2025-03-03 05:44:58 - INFO - layer19_mlp.down_proj | mse: 0.010999394383981375, bpp_loss: 3.441974041168578, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [32:17<19:17, 96.44s/it]2025-03-03 05:45:07 - INFO - layer20_self_attn.q_proj | mse: 0.011815241923224223, bpp_loss: 4.106291057833005, bpp: 0
2025-03-03 05:45:16 - INFO - layer20_self_attn.k_proj | mse: 0.012671115209539254, bpp_loss: 5.021714361966588, bpp: 0
2025-03-03 05:45:24 - INFO - layer20_self_attn.v_proj | mse: 0.01113274214948247, bpp_loss: 3.3205782414297573, bpp: 0
2025-03-03 05:45:33 - INFO - layer20_self_attn.o_proj | mse: 0.012179056874669138, bpp_loss: 3.359851531102322, bpp: 0
2025-03-03 05:45:45 - INFO - layer20_mlp.gate_proj | mse: 0.01137955589812484, bpp_loss: 3.830100900160947, bpp: 0
2025-03-03 05:45:56 - INFO - layer20_mlp.up_proj | mse: 0.011064978461396752, bpp_loss: 3.449468584398606, bpp: 0
2025-03-03 05:46:34 - INFO - layer20_mlp.down_proj | mse: 0.010952896850740485, bpp_loss: 3.4461299388037463, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [33:54<17:40, 96.42s/it]2025-03-03 05:46:43 - INFO - layer21_self_attn.q_proj | mse: 0.01179093211476269, bpp_loss: 4.103938328044023, bpp: 0
2025-03-03 05:46:52 - INFO - layer21_self_attn.k_proj | mse: 0.012647963493844887, bpp_loss: 5.064536980702542, bpp: 0
2025-03-03 05:47:00 - INFO - layer21_self_attn.v_proj | mse: 0.011141805547161232, bpp_loss: 3.3460237564286217, bpp: 0
2025-03-03 05:47:09 - INFO - layer21_self_attn.o_proj | mse: 0.012823017291108489, bpp_loss: 3.377623442444019, bpp: 0
2025-03-03 05:47:21 - INFO - layer21_mlp.gate_proj | mse: 0.011435466336537343, bpp_loss: 3.8418295909650624, bpp: 0
2025-03-03 05:47:32 - INFO - layer21_mlp.up_proj | mse: 0.011101959623659974, bpp_loss: 3.452384890722377, bpp: 0
2025-03-03 05:48:10 - INFO - layer21_mlp.down_proj | mse: 0.01105163716650086, bpp_loss: 3.4475453811797445, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [35:30<16:02, 96.30s/it]2025-03-03 05:48:19 - INFO - layer22_self_attn.q_proj | mse: 0.011868773475823923, bpp_loss: 4.063171344459988, bpp: 0
2025-03-03 05:48:28 - INFO - layer22_self_attn.k_proj | mse: 0.012712871732615115, bpp_loss: 4.998851411044598, bpp: 0
2025-03-03 05:48:36 - INFO - layer22_self_attn.v_proj | mse: 0.011273114725885635, bpp_loss: 3.3964282317319885, bpp: 0
2025-03-03 05:48:45 - INFO - layer22_self_attn.o_proj | mse: 0.012348584563231369, bpp_loss: 3.406591118313372, bpp: 0
2025-03-03 05:48:57 - INFO - layer22_mlp.gate_proj | mse: 0.011446391497930251, bpp_loss: 3.8464961959315196, bpp: 0
2025-03-03 05:49:08 - INFO - layer22_mlp.up_proj | mse: 0.011118424758172263, bpp_loss: 3.4567750204753662, bpp: 0
2025-03-03 05:49:46 - INFO - layer22_mlp.down_proj | mse: 0.010999298367713357, bpp_loss: 3.453462677824843, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [37:05<14:25, 96.13s/it]2025-03-03 05:49:55 - INFO - layer23_self_attn.q_proj | mse: 0.011785826801494544, bpp_loss: 4.074964092287701, bpp: 0
2025-03-03 05:50:04 - INFO - layer23_self_attn.k_proj | mse: 0.012621397613482336, bpp_loss: 5.001272008055821, bpp: 0
2025-03-03 05:50:12 - INFO - layer23_self_attn.v_proj | mse: 0.011256398065998829, bpp_loss: 3.4492256967932917, bpp: 0
2025-03-03 05:50:21 - INFO - layer23_self_attn.o_proj | mse: 0.011709209440918935, bpp_loss: 3.430326455272734, bpp: 0
2025-03-03 05:50:32 - INFO - layer23_mlp.gate_proj | mse: 0.011452159095822952, bpp_loss: 3.848759312382234, bpp: 0
2025-03-03 05:50:44 - INFO - layer23_mlp.up_proj | mse: 0.011123658472505722, bpp_loss: 3.4607052439158514, bpp: 0
2025-03-03 05:51:22 - INFO - layer23_mlp.down_proj | mse: 0.010859852120671799, bpp_loss: 3.458528593448656, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [38:41<12:47, 96.00s/it]2025-03-03 05:51:31 - INFO - layer24_self_attn.q_proj | mse: 0.011743243897025725, bpp_loss: 4.041305924474727, bpp: 0
2025-03-03 05:51:40 - INFO - layer24_self_attn.k_proj | mse: 0.012470279181928157, bpp_loss: 4.828771748114377, bpp: 0
2025-03-03 05:51:48 - INFO - layer24_self_attn.v_proj | mse: 0.01133296762537204, bpp_loss: 3.5472868235083297, bpp: 0
2025-03-03 05:51:57 - INFO - layer24_self_attn.o_proj | mse: 0.012141262057307103, bpp_loss: 3.4706033511902206, bpp: 0
2025-03-03 05:52:08 - INFO - layer24_mlp.gate_proj | mse: 0.01139735367221911, bpp_loss: 3.8553121759822324, bpp: 0
2025-03-03 05:52:19 - INFO - layer24_mlp.up_proj | mse: 0.01107140410181596, bpp_loss: 3.4656008815925037, bpp: 0
2025-03-03 05:52:57 - INFO - layer24_mlp.down_proj | mse: 0.010739790399326163, bpp_loss: 3.4634941875868077, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [40:16<11:10, 95.79s/it]2025-03-03 05:53:06 - INFO - layer25_self_attn.q_proj | mse: 0.01161815684148002, bpp_loss: 4.0200918924529105, bpp: 0
2025-03-03 05:53:15 - INFO - layer25_self_attn.k_proj | mse: 0.01231178922555582, bpp_loss: 4.811292166472413, bpp: 0
2025-03-03 05:53:23 - INFO - layer25_self_attn.v_proj | mse: 0.011231480602858336, bpp_loss: 3.5583966457634233, bpp: 0
2025-03-03 05:53:32 - INFO - layer25_self_attn.o_proj | mse: 0.012080572636778747, bpp_loss: 3.4719794183038175, bpp: 0
2025-03-03 05:53:43 - INFO - layer25_mlp.gate_proj | mse: 0.011350150088317704, bpp_loss: 3.864448591800673, bpp: 0
2025-03-03 05:53:54 - INFO - layer25_mlp.up_proj | mse: 0.011025095290205313, bpp_loss: 3.474901665866907, bpp: 0
2025-03-03 05:54:32 - INFO - layer25_mlp.down_proj | mse: 0.01066156693904317, bpp_loss: 3.472240201995841, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [41:52<09:33, 95.65s/it]2025-03-03 05:54:41 - INFO - layer26_self_attn.q_proj | mse: 0.011624116058045536, bpp_loss: 4.030069213826209, bpp: 0
2025-03-03 05:54:50 - INFO - layer26_self_attn.k_proj | mse: 0.01242708862278038, bpp_loss: 4.8915737012866884, bpp: 0
2025-03-03 05:54:59 - INFO - layer26_self_attn.v_proj | mse: 0.011316059760675644, bpp_loss: 3.6093522264272906, bpp: 0
2025-03-03 05:55:08 - INFO - layer26_self_attn.o_proj | mse: 0.01322249918214812, bpp_loss: 3.496499915025197, bpp: 0
2025-03-03 05:55:19 - INFO - layer26_mlp.gate_proj | mse: 0.011313898153055554, bpp_loss: 3.870350818881499, bpp: 0
2025-03-03 05:55:30 - INFO - layer26_mlp.up_proj | mse: 0.010994617574647451, bpp_loss: 3.4842246447556784, bpp: 0
2025-03-03 05:56:09 - INFO - layer26_mlp.down_proj | mse: 0.010632526984326244, bpp_loss: 3.480041280322309, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [43:28<07:59, 95.92s/it]2025-03-03 05:56:18 - INFO - layer27_self_attn.q_proj | mse: 0.011511695596874441, bpp_loss: 3.9991388010093942, bpp: 0
2025-03-03 05:56:27 - INFO - layer27_self_attn.k_proj | mse: 0.012268797113824056, bpp_loss: 4.84556333423825, bpp: 0
2025-03-03 05:56:35 - INFO - layer27_self_attn.v_proj | mse: 0.011282377295241052, bpp_loss: 3.7022205542889424, bpp: 0
2025-03-03 05:56:44 - INFO - layer27_self_attn.o_proj | mse: 0.012093358009898709, bpp_loss: 3.5275688072433695, bpp: 0
2025-03-03 05:56:56 - INFO - layer27_mlp.gate_proj | mse: 0.01126765638728723, bpp_loss: 3.880727280263922, bpp: 0
2025-03-03 05:57:07 - INFO - layer27_mlp.up_proj | mse: 0.01094482982877403, bpp_loss: 3.4997394790739884, bpp: 0
2025-03-03 05:57:46 - INFO - layer27_mlp.down_proj | mse: 0.010665396829320084, bpp_loss: 3.4907751515274867, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [45:05<06:24, 96.22s/it]2025-03-03 05:57:55 - INFO - layer28_self_attn.q_proj | mse: 0.011478809818146469, bpp_loss: 4.009121999901254, bpp: 0
2025-03-03 05:58:04 - INFO - layer28_self_attn.k_proj | mse: 0.012142996661545606, bpp_loss: 4.799451894068625, bpp: 0
2025-03-03 05:58:12 - INFO - layer28_self_attn.v_proj | mse: 0.011305173398960009, bpp_loss: 3.754790641076397, bpp: 0
2025-03-03 05:58:21 - INFO - layer28_self_attn.o_proj | mse: 0.012394459232319811, bpp_loss: 3.55762999196304, bpp: 0
2025-03-03 05:58:33 - INFO - layer28_mlp.gate_proj | mse: 0.011265662394272949, bpp_loss: 3.86697369068861, bpp: 0
2025-03-03 05:58:44 - INFO - layer28_mlp.up_proj | mse: 0.010978315502245506, bpp_loss: 3.5223477560627674, bpp: 0
2025-03-03 05:59:23 - INFO - layer28_mlp.down_proj | mse: 0.010755743171166869, bpp_loss: 3.5063293231817494, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [46:42<04:49, 96.43s/it]2025-03-03 05:59:32 - INFO - layer29_self_attn.q_proj | mse: 0.01144808450891472, bpp_loss: 3.9978015482774936, bpp: 0
2025-03-03 05:59:41 - INFO - layer29_self_attn.k_proj | mse: 0.012209982804098827, bpp_loss: 4.889742387633305, bpp: 0
2025-03-03 05:59:49 - INFO - layer29_self_attn.v_proj | mse: 0.011355970867634717, bpp_loss: 3.8237628717324696, bpp: 0
2025-03-03 05:59:58 - INFO - layer29_self_attn.o_proj | mse: 0.012814597036880161, bpp_loss: 3.5946653789724223, bpp: 0
2025-03-03 06:00:10 - INFO - layer29_mlp.gate_proj | mse: 0.01132701430635747, bpp_loss: 3.8576888659569835, bpp: 0
2025-03-03 06:00:21 - INFO - layer29_mlp.up_proj | mse: 0.011069549994571463, bpp_loss: 3.556257869383054, bpp: 0
2025-03-03 06:00:59 - INFO - layer29_mlp.down_proj | mse: 0.010830783195529176, bpp_loss: 3.5217544038314372, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [48:19<03:13, 96.53s/it]2025-03-03 06:01:09 - INFO - layer30_self_attn.q_proj | mse: 0.011558280041392418, bpp_loss: 3.901510468625929, bpp: 0
2025-03-03 06:01:17 - INFO - layer30_self_attn.k_proj | mse: 0.012192035625380614, bpp_loss: 4.5467543003032915, bpp: 0
2025-03-03 06:01:26 - INFO - layer30_self_attn.v_proj | mse: 0.011777545605309553, bpp_loss: 4.109914672910236, bpp: 0
2025-03-03 06:01:35 - INFO - layer30_self_attn.o_proj | mse: 0.01338728875758789, bpp_loss: 3.6822803206159733, bpp: 0
2025-03-03 06:01:46 - INFO - layer30_mlp.gate_proj | mse: 0.011423135695634993, bpp_loss: 3.9079707604167715, bpp: 0
2025-03-03 06:01:58 - INFO - layer30_mlp.up_proj | mse: 0.01114364806623545, bpp_loss: 3.5885214717792615, bpp: 0
2025-03-03 06:02:37 - INFO - layer30_mlp.down_proj | mse: 0.011279662559421795, bpp_loss: 3.522706943214871, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [49:56<01:36, 96.71s/it]2025-03-03 06:02:46 - INFO - layer31_self_attn.q_proj | mse: 0.011891353025610807, bpp_loss: 4.053703702520579, bpp: 0
2025-03-03 06:02:55 - INFO - layer31_self_attn.k_proj | mse: 0.012530682519502772, bpp_loss: 4.781849966850132, bpp: 0
2025-03-03 06:03:03 - INFO - layer31_self_attn.v_proj | mse: 0.011773620112627847, bpp_loss: 3.9275646895403042, bpp: 0
2025-03-03 06:03:12 - INFO - layer31_self_attn.o_proj | mse: 0.013874721963995758, bpp_loss: 3.639779544901103, bpp: 0
2025-03-03 06:03:24 - INFO - layer31_mlp.gate_proj | mse: 0.012200783866214135, bpp_loss: 4.12626159856362, bpp: 0
2025-03-03 06:03:35 - INFO - layer31_mlp.up_proj | mse: 0.01188140892699091, bpp_loss: 3.7837667196456874, bpp: 0
2025-03-03 06:04:14 - INFO - layer31_mlp.down_proj | mse: 0.013510695735374882, bpp_loss: 3.548095016989724, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [51:33<00:00, 96.85s/it]pseudo compress quantization...: 100%|██████████| 32/32 [51:33<00:00, 96.68s/it]
2025-03-03 06:04:14 - INFO - #### Total | mse: 0.011570224449974695, bpp_loss: 3.619750934145276, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda200_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_4.97679_bpp_5.524_MSE_0.00426_total_iter_95000.pth.tar/COL_MSE0.01157_bpploss3.6198_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda200_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_4.97679_bpp_5.524_MSE_0.00426_total_iter_95000.pth.tar/COL_MSE0.01157_bpploss3.6198_bpp0
I0303 06:04:53.832324 3029677 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.58it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.40it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.28it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.71it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.57it/s]
I0303 06:04:56.511269 3029677 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.6640625:   0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.6640625:   1%|          | 1/141 [00:00<01:12,  1.93it/s]avg_loss = 1.94921875:   1%|          | 1/141 [00:00<01:12,  1.93it/s]avg_loss = 1.94921875:   1%|▏         | 2/141 [00:00<01:03,  2.18it/s]avg_loss = 2.0755208333333335:   1%|▏         | 2/141 [00:01<01:03,  2.18it/s]avg_loss = 2.0755208333333335:   2%|▏         | 3/141 [00:01<01:00,  2.28it/s]avg_loss = 2.0234375:   2%|▏         | 3/141 [00:01<01:00,  2.28it/s]         avg_loss = 2.0234375:   3%|▎         | 4/141 [00:01<00:59,  2.32it/s]avg_loss = 1.9703125:   3%|▎         | 4/141 [00:02<00:59,  2.32it/s]avg_loss = 1.9703125:   4%|▎         | 5/141 [00:02<00:57,  2.35it/s]avg_loss = 1.87109375:   4%|▎         | 5/141 [00:02<00:57,  2.35it/s]avg_loss = 1.87109375:   4%|▍         | 6/141 [00:02<00:57,  2.36it/s]avg_loss = 1.8102678571428572:   4%|▍         | 6/141 [00:03<00:57,  2.36it/s]avg_loss = 1.8102678571428572:   5%|▍         | 7/141 [00:03<00:56,  2.37it/s]avg_loss = 1.8037109375:   5%|▍         | 7/141 [00:03<00:56,  2.37it/s]      avg_loss = 1.8037109375:   6%|▌         | 8/141 [00:03<00:55,  2.38it/s]avg_loss = 1.8376736111111112:   6%|▌         | 8/141 [00:03<00:55,  2.38it/s]avg_loss = 1.8376736111111112:   6%|▋         | 9/141 [00:03<00:55,  2.38it/s]avg_loss = 1.8390625:   6%|▋         | 9/141 [00:04<00:55,  2.38it/s]         avg_loss = 1.8390625:   7%|▋         | 10/141 [00:04<00:54,  2.38it/s]avg_loss = 1.8345170454545454:   7%|▋         | 10/141 [00:04<00:54,  2.38it/s]avg_loss = 1.8345170454545454:   8%|▊         | 11/141 [00:04<00:54,  2.38it/s]avg_loss = 1.857421875:   8%|▊         | 11/141 [00:05<00:54,  2.38it/s]       avg_loss = 1.857421875:   9%|▊         | 12/141 [00:05<00:54,  2.38it/s]avg_loss = 1.8695913461538463:   9%|▊         | 12/141 [00:05<00:54,  2.38it/s]avg_loss = 1.8695913461538463:   9%|▉         | 13/141 [00:05<00:53,  2.38it/s]avg_loss = 1.88671875:   9%|▉         | 13/141 [00:05<00:53,  2.38it/s]        avg_loss = 1.88671875:  10%|▉         | 14/141 [00:05<00:53,  2.38it/s]avg_loss = 1.8963541666666666:  10%|▉         | 14/141 [00:06<00:53,  2.38it/s]avg_loss = 1.8963541666666666:  11%|█         | 15/141 [00:06<00:52,  2.38it/s]avg_loss = 1.92041015625:  11%|█         | 15/141 [00:06<00:52,  2.38it/s]     avg_loss = 1.92041015625:  11%|█▏        | 16/141 [00:06<00:52,  2.38it/s]avg_loss = 1.9227941176470589:  11%|█▏        | 16/141 [00:07<00:52,  2.38it/s]avg_loss = 1.9227941176470589:  12%|█▏        | 17/141 [00:07<00:52,  2.38it/s]avg_loss = 1.9249131944444444:  12%|█▏        | 17/141 [00:07<00:52,  2.38it/s]avg_loss = 1.9249131944444444:  13%|█▎        | 18/141 [00:07<00:51,  2.38it/s]avg_loss = 1.909950657894737:  13%|█▎        | 18/141 [00:08<00:51,  2.38it/s] avg_loss = 1.909950657894737:  13%|█▎        | 19/141 [00:08<00:51,  2.38it/s]avg_loss = 1.90859375:  13%|█▎        | 19/141 [00:08<00:51,  2.38it/s]       avg_loss = 1.90859375:  14%|█▍        | 20/141 [00:08<00:50,  2.38it/s]avg_loss = 1.9129464285714286:  14%|█▍        | 20/141 [00:08<00:50,  2.38it/s]avg_loss = 1.9129464285714286:  15%|█▍        | 21/141 [00:08<00:50,  2.38it/s]avg_loss = 1.9147727272727273:  15%|█▍        | 21/141 [00:09<00:50,  2.38it/s]avg_loss = 1.9147727272727273:  16%|█▌        | 22/141 [00:09<00:50,  2.38it/s]avg_loss = 1.9164402173913044:  16%|█▌        | 22/141 [00:09<00:50,  2.38it/s]avg_loss = 1.9164402173913044:  16%|█▋        | 23/141 [00:09<00:49,  2.38it/s]avg_loss = 1.921875:  16%|█▋        | 23/141 [00:10<00:49,  2.38it/s]          avg_loss = 1.921875:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]avg_loss = 1.928125:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]avg_loss = 1.928125:  18%|█▊        | 25/141 [00:10<00:48,  2.39it/s]avg_loss = 1.9393028846153846:  18%|█▊        | 25/141 [00:10<00:48,  2.39it/s]avg_loss = 1.9393028846153846:  18%|█▊        | 26/141 [00:10<00:48,  2.39it/s]avg_loss = 1.9519675925925926:  18%|█▊        | 26/141 [00:11<00:48,  2.39it/s]avg_loss = 1.9519675925925926:  19%|█▉        | 27/141 [00:11<00:47,  2.39it/s]avg_loss = 1.9581473214285714:  19%|█▉        | 27/141 [00:11<00:47,  2.39it/s]avg_loss = 1.9581473214285714:  20%|█▉        | 28/141 [00:11<00:47,  2.39it/s]avg_loss = 1.9544719827586208:  20%|█▉        | 28/141 [00:12<00:47,  2.39it/s]avg_loss = 1.9544719827586208:  21%|██        | 29/141 [00:12<00:46,  2.40it/s]avg_loss = 1.9450520833333333:  21%|██        | 29/141 [00:12<00:46,  2.40it/s]avg_loss = 1.9450520833333333:  21%|██▏       | 30/141 [00:12<00:46,  2.40it/s]avg_loss = 1.9309475806451613:  21%|██▏       | 30/141 [00:13<00:46,  2.40it/s]avg_loss = 1.9309475806451613:  22%|██▏       | 31/141 [00:13<00:45,  2.40it/s]avg_loss = 1.9189453125:  22%|██▏       | 31/141 [00:13<00:45,  2.40it/s]      avg_loss = 1.9189453125:  23%|██▎       | 32/141 [00:13<00:45,  2.39it/s]avg_loss = 1.9176136363636365:  23%|██▎       | 32/141 [00:13<00:45,  2.39it/s]avg_loss = 1.9176136363636365:  23%|██▎       | 33/141 [00:13<00:45,  2.39it/s]avg_loss = 1.915670955882353:  23%|██▎       | 33/141 [00:14<00:45,  2.39it/s] avg_loss = 1.915670955882353:  24%|██▍       | 34/141 [00:14<00:44,  2.39it/s]avg_loss = 1.918080357142857:  24%|██▍       | 34/141 [00:14<00:44,  2.39it/s]avg_loss = 1.918080357142857:  25%|██▍       | 35/141 [00:14<00:44,  2.39it/s]avg_loss = 1.9021267361111112:  25%|██▍       | 35/141 [00:15<00:44,  2.39it/s]avg_loss = 1.9021267361111112:  26%|██▌       | 36/141 [00:15<00:43,  2.39it/s]avg_loss = 1.8868243243243243:  26%|██▌       | 36/141 [00:15<00:43,  2.39it/s]avg_loss = 1.8868243243243243:  26%|██▌       | 37/141 [00:15<00:43,  2.39it/s]avg_loss = 1.8721217105263157:  26%|██▌       | 37/141 [00:16<00:43,  2.39it/s]avg_loss = 1.8721217105263157:  27%|██▋       | 38/141 [00:16<00:43,  2.39it/s]avg_loss = 1.857371794871795:  27%|██▋       | 38/141 [00:16<00:43,  2.39it/s] avg_loss = 1.857371794871795:  28%|██▊       | 39/141 [00:16<00:42,  2.39it/s]avg_loss = 1.8490234375:  28%|██▊       | 39/141 [00:16<00:42,  2.39it/s]     avg_loss = 1.8490234375:  28%|██▊       | 40/141 [00:16<00:42,  2.39it/s]avg_loss = 1.8542301829268293:  28%|██▊       | 40/141 [00:17<00:42,  2.39it/s]avg_loss = 1.8542301829268293:  29%|██▉       | 41/141 [00:17<00:41,  2.39it/s]avg_loss = 1.87109375:  29%|██▉       | 41/141 [00:17<00:41,  2.39it/s]        avg_loss = 1.87109375:  30%|██▉       | 42/141 [00:17<00:41,  2.39it/s]avg_loss = 1.8868095930232558:  30%|██▉       | 42/141 [00:18<00:41,  2.39it/s]avg_loss = 1.8868095930232558:  30%|███       | 43/141 [00:18<00:41,  2.39it/s]avg_loss = 1.8904474431818181:  30%|███       | 43/141 [00:18<00:41,  2.39it/s]avg_loss = 1.8904474431818181:  31%|███       | 44/141 [00:18<00:40,  2.39it/s]avg_loss = 1.8953125:  31%|███       | 44/141 [00:18<00:40,  2.39it/s]         avg_loss = 1.8953125:  32%|███▏      | 45/141 [00:18<00:40,  2.38it/s]avg_loss = 1.900305706521739:  32%|███▏      | 45/141 [00:19<00:40,  2.38it/s]avg_loss = 1.900305706521739:  33%|███▎      | 46/141 [00:19<00:39,  2.38it/s]avg_loss = 1.906748670212766:  33%|███▎      | 46/141 [00:19<00:39,  2.38it/s]avg_loss = 1.906748670212766:  33%|███▎      | 47/141 [00:19<00:39,  2.38it/s]avg_loss = 1.90966796875:  33%|███▎      | 47/141 [00:20<00:39,  2.38it/s]    avg_loss = 1.90966796875:  34%|███▍      | 48/141 [00:20<00:39,  2.38it/s]avg_loss = 1.9088010204081634:  34%|███▍      | 48/141 [00:20<00:39,  2.38it/s]avg_loss = 1.9088010204081634:  35%|███▍      | 49/141 [00:20<00:38,  2.38it/s]avg_loss = 1.90828125:  35%|███▍      | 49/141 [00:21<00:38,  2.38it/s]        avg_loss = 1.90828125:  35%|███▌      | 50/141 [00:21<00:38,  2.38it/s]avg_loss = 1.9025735294117647:  35%|███▌      | 50/141 [00:21<00:38,  2.38it/s]avg_loss = 1.9025735294117647:  36%|███▌      | 51/141 [00:21<00:37,  2.37it/s]avg_loss = 1.8985877403846154:  36%|███▌      | 51/141 [00:21<00:37,  2.37it/s]avg_loss = 1.8985877403846154:  37%|███▋      | 52/141 [00:21<00:37,  2.37it/s]avg_loss = 1.8918042452830188:  37%|███▋      | 52/141 [00:22<00:37,  2.37it/s]avg_loss = 1.8918042452830188:  38%|███▊      | 53/141 [00:22<00:37,  2.37it/s]avg_loss = 1.888599537037037:  38%|███▊      | 53/141 [00:22<00:37,  2.37it/s] avg_loss = 1.888599537037037:  38%|███▊      | 54/141 [00:22<00:36,  2.37it/s]avg_loss = 1.8808238636363637:  38%|███▊      | 54/141 [00:23<00:36,  2.37it/s]avg_loss = 1.8808238636363637:  39%|███▉      | 55/141 [00:23<00:36,  2.37it/s]avg_loss = 1.8729073660714286:  39%|███▉      | 55/141 [00:23<00:36,  2.37it/s]avg_loss = 1.8729073660714286:  40%|███▉      | 56/141 [00:23<00:35,  2.37it/s]avg_loss = 1.8681469298245614:  40%|███▉      | 56/141 [00:24<00:35,  2.37it/s]avg_loss = 1.8681469298245614:  40%|████      | 57/141 [00:24<00:35,  2.36it/s]avg_loss = 1.865167025862069:  40%|████      | 57/141 [00:24<00:35,  2.36it/s] avg_loss = 1.865167025862069:  41%|████      | 58/141 [00:24<00:35,  2.37it/s]avg_loss = 1.8674523305084745:  41%|████      | 58/141 [00:24<00:35,  2.37it/s]avg_loss = 1.8674523305084745:  42%|████▏     | 59/141 [00:24<00:34,  2.36it/s]avg_loss = 1.873046875:  42%|████▏     | 59/141 [00:25<00:34,  2.36it/s]       avg_loss = 1.873046875:  43%|████▎     | 60/141 [00:25<00:34,  2.37it/s]avg_loss = 1.8787141393442623:  43%|████▎     | 60/141 [00:25<00:34,  2.37it/s]avg_loss = 1.8787141393442623:  43%|████▎     | 61/141 [00:25<00:33,  2.36it/s]avg_loss = 1.885710685483871:  43%|████▎     | 61/141 [00:26<00:33,  2.36it/s] avg_loss = 1.885710685483871:  44%|████▍     | 62/141 [00:26<00:33,  2.36it/s]avg_loss = 1.8764880952380953:  44%|████▍     | 62/141 [00:26<00:33,  2.36it/s]avg_loss = 1.8764880952380953:  45%|████▍     | 63/141 [00:26<00:33,  2.36it/s]avg_loss = 1.8743896484375:  45%|████▍     | 63/141 [00:26<00:33,  2.36it/s]   avg_loss = 1.8743896484375:  45%|████▌     | 64/141 [00:26<00:32,  2.36it/s]avg_loss = 1.8716346153846153:  45%|████▌     | 64/141 [00:27<00:32,  2.36it/s]avg_loss = 1.8716346153846153:  46%|████▌     | 65/141 [00:27<00:32,  2.36it/s]avg_loss = 1.8656486742424243:  46%|████▌     | 65/141 [00:27<00:32,  2.36it/s]avg_loss = 1.8656486742424243:  47%|████▋     | 66/141 [00:27<00:31,  2.36it/s]avg_loss = 1.8631063432835822:  47%|████▋     | 66/141 [00:28<00:31,  2.36it/s]avg_loss = 1.8631063432835822:  48%|████▊     | 67/141 [00:28<00:31,  2.36it/s]avg_loss = 1.8599494485294117:  48%|████▊     | 67/141 [00:28<00:31,  2.36it/s]avg_loss = 1.8599494485294117:  48%|████▊     | 68/141 [00:28<00:30,  2.36it/s]avg_loss = 1.8569972826086956:  48%|████▊     | 68/141 [00:29<00:30,  2.36it/s]avg_loss = 1.8569972826086956:  49%|████▉     | 69/141 [00:29<00:30,  2.36it/s]avg_loss = 1.8580357142857142:  49%|████▉     | 69/141 [00:29<00:30,  2.36it/s]avg_loss = 1.8580357142857142:  50%|████▉     | 70/141 [00:29<00:30,  2.36it/s]avg_loss = 1.861575704225352:  50%|████▉     | 70/141 [00:29<00:30,  2.36it/s] avg_loss = 1.861575704225352:  50%|█████     | 71/141 [00:29<00:29,  2.36it/s]avg_loss = 1.8639322916666667:  50%|█████     | 71/141 [00:30<00:29,  2.36it/s]avg_loss = 1.8639322916666667:  51%|█████     | 72/141 [00:30<00:29,  2.36it/s]avg_loss = 1.8622645547945205:  51%|█████     | 72/141 [00:30<00:29,  2.36it/s]avg_loss = 1.8622645547945205:  52%|█████▏    | 73/141 [00:30<00:28,  2.36it/s]avg_loss = 1.863597972972973:  52%|█████▏    | 73/141 [00:31<00:28,  2.36it/s] avg_loss = 1.863597972972973:  52%|█████▏    | 74/141 [00:31<00:28,  2.35it/s]avg_loss = 1.8635416666666667:  52%|█████▏    | 74/141 [00:31<00:28,  2.35it/s]avg_loss = 1.8635416666666667:  53%|█████▎    | 75/141 [00:31<00:28,  2.36it/s]avg_loss = 1.8622532894736843:  53%|█████▎    | 75/141 [00:32<00:28,  2.36it/s]avg_loss = 1.8622532894736843:  54%|█████▍    | 76/141 [00:32<00:27,  2.35it/s]avg_loss = 1.8633319805194806:  54%|█████▍    | 76/141 [00:32<00:27,  2.35it/s]avg_loss = 1.8633319805194806:  55%|█████▍    | 77/141 [00:32<00:27,  2.35it/s]avg_loss = 1.8656850961538463:  55%|█████▍    | 77/141 [00:32<00:27,  2.35it/s]avg_loss = 1.8656850961538463:  55%|█████▌    | 78/141 [00:32<00:26,  2.35it/s]avg_loss = 1.8697587025316456:  55%|█████▌    | 78/141 [00:33<00:26,  2.35it/s]avg_loss = 1.8697587025316456:  56%|█████▌    | 79/141 [00:33<00:26,  2.35it/s]avg_loss = 1.866796875:  56%|█████▌    | 79/141 [00:33<00:26,  2.35it/s]       avg_loss = 1.866796875:  57%|█████▋    | 80/141 [00:33<00:25,  2.35it/s]avg_loss = 1.865644290123457:  57%|█████▋    | 80/141 [00:34<00:25,  2.35it/s]avg_loss = 1.865644290123457:  57%|█████▋    | 81/141 [00:34<00:25,  2.35it/s]avg_loss = 1.8649009146341464:  57%|█████▋    | 81/141 [00:34<00:25,  2.35it/s]avg_loss = 1.8649009146341464:  58%|█████▊    | 82/141 [00:34<00:25,  2.35it/s]avg_loss = 1.863234186746988:  58%|█████▊    | 82/141 [00:35<00:25,  2.35it/s] avg_loss = 1.863234186746988:  59%|█████▉    | 83/141 [00:35<00:24,  2.36it/s]avg_loss = 1.861235119047619:  59%|█████▉    | 83/141 [00:35<00:24,  2.36it/s]avg_loss = 1.861235119047619:  60%|█████▉    | 84/141 [00:35<00:24,  2.36it/s]avg_loss = 1.8590073529411764:  60%|█████▉    | 84/141 [00:35<00:24,  2.36it/s]avg_loss = 1.8590073529411764:  60%|██████    | 85/141 [00:35<00:23,  2.36it/s]avg_loss = 1.8605559593023255:  60%|██████    | 85/141 [00:36<00:23,  2.36it/s]avg_loss = 1.8605559593023255:  61%|██████    | 86/141 [00:36<00:23,  2.36it/s]avg_loss = 1.8623383620689655:  61%|██████    | 86/141 [00:36<00:23,  2.36it/s]avg_loss = 1.8623383620689655:  62%|██████▏   | 87/141 [00:36<00:22,  2.36it/s]avg_loss = 1.8629261363636365:  62%|██████▏   | 87/141 [00:37<00:22,  2.36it/s]avg_loss = 1.8629261363636365:  62%|██████▏   | 88/141 [00:37<00:22,  2.36it/s]avg_loss = 1.8716643258426966:  62%|██████▏   | 88/141 [00:37<00:22,  2.36it/s]avg_loss = 1.8716643258426966:  63%|██████▎   | 89/141 [00:37<00:22,  2.36it/s]avg_loss = 1.8789930555555556:  63%|██████▎   | 89/141 [00:37<00:22,  2.36it/s]avg_loss = 1.8789930555555556:  64%|██████▍   | 90/141 [00:37<00:21,  2.36it/s]avg_loss = 1.8822115384615385:  64%|██████▍   | 90/141 [00:38<00:21,  2.36it/s]avg_loss = 1.8822115384615385:  65%|██████▍   | 91/141 [00:38<00:21,  2.36it/s]avg_loss = 1.887398097826087:  65%|██████▍   | 91/141 [00:38<00:21,  2.36it/s] avg_loss = 1.887398097826087:  65%|██████▌   | 92/141 [00:38<00:20,  2.36it/s]avg_loss = 1.89247311827957:  65%|██████▌   | 92/141 [00:39<00:20,  2.36it/s] avg_loss = 1.89247311827957:  66%|██████▌   | 93/141 [00:39<00:20,  2.36it/s]avg_loss = 1.8934507978723405:  66%|██████▌   | 93/141 [00:39<00:20,  2.36it/s]avg_loss = 1.8934507978723405:  67%|██████▋   | 94/141 [00:39<00:19,  2.36it/s]avg_loss = 1.897203947368421:  67%|██████▋   | 94/141 [00:40<00:19,  2.36it/s] avg_loss = 1.897203947368421:  67%|██████▋   | 95/141 [00:40<00:19,  2.36it/s]avg_loss = 1.8977864583333333:  67%|██████▋   | 95/141 [00:40<00:19,  2.36it/s]avg_loss = 1.8977864583333333:  68%|██████▊   | 96/141 [00:40<00:19,  2.36it/s]avg_loss = 1.8994845360824741:  68%|██████▊   | 96/141 [00:40<00:19,  2.36it/s]avg_loss = 1.8994845360824741:  69%|██████▉   | 97/141 [00:40<00:18,  2.36it/s]avg_loss = 1.8955676020408163:  69%|██████▉   | 97/141 [00:41<00:18,  2.36it/s]avg_loss = 1.8955676020408163:  70%|██████▉   | 98/141 [00:41<00:18,  2.36it/s]avg_loss = 1.8963857323232323:  70%|██████▉   | 98/141 [00:41<00:18,  2.36it/s]avg_loss = 1.8963857323232323:  70%|███████   | 99/141 [00:41<00:17,  2.36it/s]avg_loss = 1.898359375:  70%|███████   | 99/141 [00:42<00:17,  2.36it/s]       avg_loss = 1.898359375:  71%|███████   | 100/141 [00:42<00:17,  2.36it/s]avg_loss = 1.8972772277227723:  71%|███████   | 100/141 [00:42<00:17,  2.36it/s]avg_loss = 1.8972772277227723:  72%|███████▏  | 101/141 [00:42<00:16,  2.35it/s]avg_loss = 1.8975949754901962:  72%|███████▏  | 101/141 [00:43<00:16,  2.35it/s]avg_loss = 1.8975949754901962:  72%|███████▏  | 102/141 [00:43<00:16,  2.36it/s]avg_loss = 1.8960103155339805:  72%|███████▏  | 102/141 [00:43<00:16,  2.36it/s]avg_loss = 1.8960103155339805:  73%|███████▎  | 103/141 [00:43<00:16,  2.35it/s]avg_loss = 1.8986628605769231:  73%|███████▎  | 103/141 [00:43<00:16,  2.35it/s]avg_loss = 1.8986628605769231:  74%|███████▍  | 104/141 [00:43<00:15,  2.35it/s]avg_loss = 1.8973214285714286:  74%|███████▍  | 104/141 [00:44<00:15,  2.35it/s]avg_loss = 1.8973214285714286:  74%|███████▍  | 105/141 [00:44<00:15,  2.35it/s]avg_loss = 1.8963001179245282:  74%|███████▍  | 105/141 [00:44<00:15,  2.35it/s]avg_loss = 1.8963001179245282:  75%|███████▌  | 106/141 [00:44<00:14,  2.35it/s]avg_loss = 1.893983644859813:  75%|███████▌  | 106/141 [00:45<00:14,  2.35it/s] avg_loss = 1.893983644859813:  76%|███████▌  | 107/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8915653935185186:  76%|███████▌  | 107/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8915653935185186:  77%|███████▋  | 108/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8890481651376148:  77%|███████▋  | 108/141 [00:46<00:14,  2.35it/s]avg_loss = 1.8890481651376148:  77%|███████▋  | 109/141 [00:46<00:13,  2.35it/s]avg_loss = 1.8864346590909091:  77%|███████▋  | 109/141 [00:46<00:13,  2.35it/s]avg_loss = 1.8864346590909091:  78%|███████▊  | 110/141 [00:46<00:13,  2.35it/s]avg_loss = 1.888865427927928:  78%|███████▊  | 110/141 [00:46<00:13,  2.35it/s] avg_loss = 1.888865427927928:  79%|███████▊  | 111/141 [00:46<00:12,  2.35it/s]avg_loss = 1.8885323660714286:  79%|███████▊  | 111/141 [00:47<00:12,  2.35it/s]avg_loss = 1.8885323660714286:  79%|███████▉  | 112/141 [00:47<00:12,  2.35it/s]avg_loss = 1.8895188053097345:  79%|███████▉  | 112/141 [00:47<00:12,  2.35it/s]avg_loss = 1.8895188053097345:  80%|████████  | 113/141 [00:47<00:11,  2.35it/s]avg_loss = 1.8904879385964912:  80%|████████  | 113/141 [00:48<00:11,  2.35it/s]avg_loss = 1.8904879385964912:  81%|████████  | 114/141 [00:48<00:11,  2.35it/s]avg_loss = 1.889741847826087:  81%|████████  | 114/141 [00:48<00:11,  2.35it/s] avg_loss = 1.889741847826087:  82%|████████▏ | 115/141 [00:48<00:11,  2.35it/s]avg_loss = 1.8883351293103448:  82%|████████▏ | 115/141 [00:49<00:11,  2.35it/s]avg_loss = 1.8883351293103448:  82%|████████▏ | 116/141 [00:49<00:10,  2.35it/s]avg_loss = 1.890491452991453:  82%|████████▏ | 116/141 [00:49<00:10,  2.35it/s] avg_loss = 1.890491452991453:  83%|████████▎ | 117/141 [00:49<00:10,  2.35it/s]avg_loss = 1.8900953389830508:  83%|████████▎ | 117/141 [00:49<00:10,  2.35it/s]avg_loss = 1.8900953389830508:  84%|████████▎ | 118/141 [00:49<00:09,  2.35it/s]avg_loss = 1.8885898109243697:  84%|████████▎ | 118/141 [00:50<00:09,  2.35it/s]avg_loss = 1.8885898109243697:  84%|████████▍ | 119/141 [00:50<00:09,  2.35it/s]avg_loss = 1.88671875:  84%|████████▍ | 119/141 [00:50<00:09,  2.35it/s]        avg_loss = 1.88671875:  85%|████████▌ | 120/141 [00:50<00:08,  2.35it/s]avg_loss = 1.8866219008264462:  85%|████████▌ | 120/141 [00:51<00:08,  2.35it/s]avg_loss = 1.8866219008264462:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8870389344262295:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8870389344262295:  87%|████████▋ | 122/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8867505081300813:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 1.8867505081300813:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8869707661290323:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8869707661290323:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8858125:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]         avg_loss = 1.8858125:  89%|████████▊ | 125/141 [00:52<00:06,  2.34it/s]avg_loss = 1.8863467261904763:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 1.8863467261904763:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 1.8860113188976377:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 1.8860113188976377:  90%|█████████ | 127/141 [00:53<00:05,  2.34it/s]avg_loss = 1.884765625:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]       avg_loss = 1.884765625:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.884811046511628:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.884811046511628:  91%|█████████▏| 129/141 [00:54<00:05,  2.34it/s]avg_loss = 1.8856370192307692:  91%|█████████▏| 129/141 [00:55<00:05,  2.34it/s]avg_loss = 1.8856370192307692:  92%|█████████▏| 130/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8866292938931297:  92%|█████████▏| 130/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8866292938931297:  93%|█████████▎| 131/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8872514204545454:  93%|█████████▎| 131/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8872514204545454:  94%|█████████▎| 132/141 [00:55<00:03,  2.34it/s]avg_loss = 1.8843397556390977:  94%|█████████▎| 132/141 [00:56<00:03,  2.34it/s]avg_loss = 1.8843397556390977:  94%|█████████▍| 133/141 [00:56<00:03,  2.34it/s]avg_loss = 1.8798390858208955:  94%|█████████▍| 133/141 [00:56<00:03,  2.34it/s]avg_loss = 1.8798390858208955:  95%|█████████▌| 134/141 [00:56<00:02,  2.34it/s]avg_loss = 1.8823495370370371:  95%|█████████▌| 134/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8823495370370371:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8858570772058822:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8858570772058822:  96%|█████████▋| 136/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8871464416058394:  96%|█████████▋| 136/141 [00:58<00:02,  2.34it/s]avg_loss = 1.8871464416058394:  97%|█████████▋| 137/141 [00:58<00:01,  2.34it/s]avg_loss = 1.885926177536232:  97%|█████████▋| 137/141 [00:58<00:01,  2.34it/s] avg_loss = 1.885926177536232:  98%|█████████▊| 138/141 [00:58<00:01,  2.34it/s]avg_loss = 1.8862410071942446:  98%|█████████▊| 138/141 [00:58<00:01,  2.34it/s]avg_loss = 1.8862410071942446:  99%|█████████▊| 139/141 [00:58<00:00,  2.34it/s]avg_loss = 1.8869419642857144:  99%|█████████▊| 139/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8869419642857144:  99%|█████████▉| 140/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8880762411347518:  99%|█████████▉| 140/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8880762411347518: 100%|██████████| 141/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8880762411347518: 100%|██████████| 141/141 [00:59<00:00,  2.36it/s]
I0303 06:09:14.856842 3029677 eval_ppl.py:105] wikitext2 perplexity: 6.606646537780762
wikitext2 perplexity: 6.607
Running with lmbda=300
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.87it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.89it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.92it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.67it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.10it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.97it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.28it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:11,  2.68it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:10,  2.73it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:10,  2.71it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:10,  2.71it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:11,  2.27it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:13,  1.92it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:13,  1.86it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:13,  1.82it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:12,  1.77it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:13,  1.68it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:05<00:12,  1.74it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:11,  1.72it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:06<00:11,  1.72it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:10,  1.73it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:07<00:09,  1.76it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:08,  1.78it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:09<00:08,  1.75it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:09<00:07,  1.78it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:10<00:07,  1.83it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:10<00:06,  1.92it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:11<00:05,  1.99it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:04,  2.01it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:11<00:04,  2.08it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:12<00:03,  2.07it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:12<00:03,  2.09it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:13<00:02,  2.17it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:13<00:02,  2.14it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:14<00:01,  2.11it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:14<00:01,  2.06it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:15<00:00,  2.14it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:15<00:00,  2.13it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  2.13it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  1.97it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 06:09:59 - INFO - layer0_self_attn.q_proj | mse: 0.025218135600612868, bpp_loss: 4.238113678526133, bpp: 0
2025-03-03 06:10:08 - INFO - layer0_self_attn.k_proj | mse: 0.03613492205731388, bpp_loss: 4.855192911869381, bpp: 0
2025-03-03 06:10:16 - INFO - layer0_self_attn.v_proj | mse: 0.01123376564518505, bpp_loss: 3.36165188299492, bpp: 0
2025-03-03 06:10:25 - INFO - layer0_self_attn.o_proj | mse: 0.008469599554413692, bpp_loss: 3.4542631438816898, bpp: 0
2025-03-03 06:10:36 - INFO - layer0_mlp.gate_proj | mse: 0.008102212756412163, bpp_loss: 3.8566001734164144, bpp: 0
2025-03-03 06:10:47 - INFO - layer0_mlp.up_proj | mse: 0.008050199254118895, bpp_loss: 3.7415825029435967, bpp: 0
2025-03-03 06:11:26 - INFO - layer0_mlp.down_proj | mse: 0.007938674703362429, bpp_loss: 3.73533562454395, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:35<49:35, 95.99s/it]2025-03-03 06:11:35 - INFO - layer1_self_attn.q_proj | mse: 0.011078341484111914, bpp_loss: 4.498206437623594, bpp: 0
2025-03-03 06:11:44 - INFO - layer1_self_attn.k_proj | mse: 0.012642656111857517, bpp_loss: 5.281679648614954, bpp: 0
2025-03-03 06:11:53 - INFO - layer1_self_attn.v_proj | mse: 0.00993538069454522, bpp_loss: 3.4633815818233415, bpp: 0
2025-03-03 06:12:02 - INFO - layer1_self_attn.o_proj | mse: 0.0099134891923686, bpp_loss: 3.536145307822153, bpp: 0
2025-03-03 06:12:13 - INFO - layer1_mlp.gate_proj | mse: 0.008199769423351275, bpp_loss: 3.8665991071611643, bpp: 0
2025-03-03 06:12:24 - INFO - layer1_mlp.up_proj | mse: 0.00814618241307953, bpp_loss: 3.755878491859351, bpp: 0
2025-03-03 06:13:02 - INFO - layer1_mlp.down_proj | mse: 0.007121552258457377, bpp_loss: 3.750165144397345, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [03:12<48:08, 96.27s/it]2025-03-03 06:13:12 - INFO - layer2_self_attn.q_proj | mse: 0.009001075774745418, bpp_loss: 4.42260854219785, bpp: 0
2025-03-03 06:13:21 - INFO - layer2_self_attn.k_proj | mse: 0.00987022186159273, bpp_loss: 5.34414216701407, bpp: 0
2025-03-03 06:13:29 - INFO - layer2_self_attn.v_proj | mse: 0.008344382131952358, bpp_loss: 3.373110976011958, bpp: 0
2025-03-03 06:13:38 - INFO - layer2_self_attn.o_proj | mse: 0.007973654836936557, bpp_loss: 3.4881737770629115, bpp: 0
2025-03-03 06:13:49 - INFO - layer2_mlp.gate_proj | mse: 0.007765757681925464, bpp_loss: 3.9008555808769807, bpp: 0
2025-03-03 06:14:01 - INFO - layer2_mlp.up_proj | mse: 0.00770154349178225, bpp_loss: 3.7480136042992984, bpp: 0
2025-03-03 06:14:39 - INFO - layer2_mlp.down_proj | mse: 0.007444392060593753, bpp_loss: 3.753874465573712, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:48<46:35, 96.38s/it]2025-03-03 06:14:48 - INFO - layer3_self_attn.q_proj | mse: 0.008215013247488896, bpp_loss: 4.462314850650728, bpp: 0
2025-03-03 06:14:57 - INFO - layer3_self_attn.k_proj | mse: 0.008811365114861943, bpp_loss: 5.426264358917251, bpp: 0
2025-03-03 06:15:06 - INFO - layer3_self_attn.v_proj | mse: 0.0077130506483342135, bpp_loss: 3.4698790655238554, bpp: 0
2025-03-03 06:15:15 - INFO - layer3_self_attn.o_proj | mse: 0.008245596601634738, bpp_loss: 3.5827808613539673, bpp: 0
2025-03-03 06:15:26 - INFO - layer3_mlp.gate_proj | mse: 0.0078039084216603265, bpp_loss: 3.9787421749372567, bpp: 0
2025-03-03 06:15:37 - INFO - layer3_mlp.up_proj | mse: 0.007694349721218894, bpp_loss: 3.729404706108783, bpp: 0
2025-03-03 06:16:15 - INFO - layer3_mlp.down_proj | mse: 0.007356238366108874, bpp_loss: 3.728994339887452, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [06:25<44:59, 96.41s/it]2025-03-03 06:16:25 - INFO - layer4_self_attn.q_proj | mse: 0.008218281111507322, bpp_loss: 4.426828225841746, bpp: 0
2025-03-03 06:16:34 - INFO - layer4_self_attn.k_proj | mse: 0.00887148019670089, bpp_loss: 5.400975702505093, bpp: 0
2025-03-03 06:16:42 - INFO - layer4_self_attn.v_proj | mse: 0.007726705134225032, bpp_loss: 3.5154370271484368, bpp: 0
2025-03-03 06:16:51 - INFO - layer4_self_attn.o_proj | mse: 0.00857136469301407, bpp_loss: 3.593863700865768, bpp: 0
2025-03-03 06:17:02 - INFO - layer4_mlp.gate_proj | mse: 0.007774816320177148, bpp_loss: 4.054207036404738, bpp: 0
2025-03-03 06:17:13 - INFO - layer4_mlp.up_proj | mse: 0.007614339199533728, bpp_loss: 3.7022940985459303, bpp: 0
2025-03-03 06:17:51 - INFO - layer4_mlp.down_proj | mse: 0.007518634984386217, bpp_loss: 3.7040894197665954, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [08:01<43:17, 96.21s/it]2025-03-03 06:18:01 - INFO - layer5_self_attn.q_proj | mse: 0.008303752558436043, bpp_loss: 4.3999024293152615, bpp: 0
2025-03-03 06:18:09 - INFO - layer5_self_attn.k_proj | mse: 0.009008642849937019, bpp_loss: 5.369320436613634, bpp: 0
2025-03-03 06:18:18 - INFO - layer5_self_attn.v_proj | mse: 0.007785520892471546, bpp_loss: 3.4028097224072553, bpp: 0
2025-03-03 06:18:27 - INFO - layer5_self_attn.o_proj | mse: 0.008885435975018938, bpp_loss: 3.541169718198944, bpp: 0
2025-03-03 06:18:38 - INFO - layer5_mlp.gate_proj | mse: 0.007710078179192074, bpp_loss: 4.055976660190416, bpp: 0
2025-03-03 06:18:49 - INFO - layer5_mlp.up_proj | mse: 0.007555781691939125, bpp_loss: 3.7073798261449804, bpp: 0
2025-03-03 06:19:28 - INFO - layer5_mlp.down_proj | mse: 0.007553437570637155, bpp_loss: 3.7091572012286633, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [09:37<41:43, 96.28s/it]2025-03-03 06:19:37 - INFO - layer6_self_attn.q_proj | mse: 0.00813544017923173, bpp_loss: 4.447751955711283, bpp: 0
2025-03-03 06:19:46 - INFO - layer6_self_attn.k_proj | mse: 0.00874052735421254, bpp_loss: 5.439020273974165, bpp: 0
2025-03-03 06:19:54 - INFO - layer6_self_attn.v_proj | mse: 0.007638913880458762, bpp_loss: 3.447800249559805, bpp: 0
2025-03-03 06:20:04 - INFO - layer6_self_attn.o_proj | mse: 0.008887555161658546, bpp_loss: 3.5721895310562104, bpp: 0
2025-03-03 06:20:15 - INFO - layer6_mlp.gate_proj | mse: 0.007707867321848302, bpp_loss: 4.061896670742759, bpp: 0
2025-03-03 06:20:26 - INFO - layer6_mlp.up_proj | mse: 0.007552378080783157, bpp_loss: 3.706355824334813, bpp: 0
2025-03-03 06:21:05 - INFO - layer6_mlp.down_proj | mse: 0.007625897571659689, bpp_loss: 3.709195313625969, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [11:15<40:15, 96.64s/it]2025-03-03 06:21:14 - INFO - layer7_self_attn.q_proj | mse: 0.008141963594837659, bpp_loss: 4.369173674087506, bpp: 0
2025-03-03 06:21:23 - INFO - layer7_self_attn.k_proj | mse: 0.008788963733193085, bpp_loss: 5.468208894249983, bpp: 0
2025-03-03 06:21:32 - INFO - layer7_self_attn.v_proj | mse: 0.0076886329250369645, bpp_loss: 3.445941220212262, bpp: 0
2025-03-03 06:21:41 - INFO - layer7_self_attn.o_proj | mse: 0.009106941677102959, bpp_loss: 3.584175897820387, bpp: 0
2025-03-03 06:21:53 - INFO - layer7_mlp.gate_proj | mse: 0.007700805159790247, bpp_loss: 4.032368237551834, bpp: 0
2025-03-03 06:22:04 - INFO - layer7_mlp.up_proj | mse: 0.007561906867657552, bpp_loss: 3.7200806655122767, bpp: 0
2025-03-03 06:22:41 - INFO - layer7_mlp.down_proj | mse: 0.007620009953431963, bpp_loss: 3.7229850072014545, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [12:51<38:37, 96.56s/it]2025-03-03 06:22:51 - INFO - layer8_self_attn.q_proj | mse: 0.008134909296180864, bpp_loss: 4.353979985346086, bpp: 0
2025-03-03 06:22:59 - INFO - layer8_self_attn.k_proj | mse: 0.008821414231274987, bpp_loss: 5.3707988725509495, bpp: 0
2025-03-03 06:23:08 - INFO - layer8_self_attn.v_proj | mse: 0.007683027147664933, bpp_loss: 3.4683133387588896, bpp: 0
2025-03-03 06:23:17 - INFO - layer8_self_attn.o_proj | mse: 0.009586014742915818, bpp_loss: 3.5956326118903235, bpp: 0
2025-03-03 06:23:28 - INFO - layer8_mlp.gate_proj | mse: 0.0076672201591449565, bpp_loss: 4.038175307280783, bpp: 0
2025-03-03 06:23:39 - INFO - layer8_mlp.up_proj | mse: 0.007521270465398036, bpp_loss: 3.7154362882886613, bpp: 0
2025-03-03 06:24:17 - INFO - layer8_mlp.down_proj | mse: 0.007642933837421397, bpp_loss: 3.7213271054705337, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [14:26<36:50, 96.13s/it]2025-03-03 06:24:26 - INFO - layer9_self_attn.q_proj | mse: 0.008065601174008168, bpp_loss: 4.366489602311049, bpp: 0
2025-03-03 06:24:34 - INFO - layer9_self_attn.k_proj | mse: 0.008759105363950265, bpp_loss: 5.392784383962862, bpp: 0
2025-03-03 06:24:43 - INFO - layer9_self_attn.v_proj | mse: 0.007657796079666289, bpp_loss: 3.5699552000733092, bpp: 0
2025-03-03 06:24:52 - INFO - layer9_self_attn.o_proj | mse: 0.009608639921123173, bpp_loss: 3.652970339055173, bpp: 0
2025-03-03 06:25:03 - INFO - layer9_mlp.gate_proj | mse: 0.007670677572520074, bpp_loss: 4.05365946064038, bpp: 0
2025-03-03 06:25:15 - INFO - layer9_mlp.up_proj | mse: 0.007521340822146154, bpp_loss: 3.7253330762365033, bpp: 0
2025-03-03 06:25:54 - INFO - layer9_mlp.down_proj | mse: 0.007677904452141368, bpp_loss: 3.7238160662486086, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [16:03<35:21, 96.44s/it]2025-03-03 06:26:03 - INFO - layer10_self_attn.q_proj | mse: 0.008109177764078334, bpp_loss: 4.3693792906124145, bpp: 0
2025-03-03 06:26:12 - INFO - layer10_self_attn.k_proj | mse: 0.00884841539228361, bpp_loss: 5.394805258372799, bpp: 0
2025-03-03 06:26:20 - INFO - layer10_self_attn.v_proj | mse: 0.007638025936911202, bpp_loss: 3.458625234605279, bpp: 0
2025-03-03 06:26:29 - INFO - layer10_self_attn.o_proj | mse: 0.00924470112110841, bpp_loss: 3.5883083330118097, bpp: 0
2025-03-03 06:26:41 - INFO - layer10_mlp.gate_proj | mse: 0.007659046360466651, bpp_loss: 4.021231705788523, bpp: 0
2025-03-03 06:26:52 - INFO - layer10_mlp.up_proj | mse: 0.007533619316282252, bpp_loss: 3.7423133541430746, bpp: 0
2025-03-03 06:27:30 - INFO - layer10_mlp.down_proj | mse: 0.00765602515892986, bpp_loss: 3.7397082418236613, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [17:40<33:44, 96.40s/it]2025-03-03 06:27:39 - INFO - layer11_self_attn.q_proj | mse: 0.007995776653997456, bpp_loss: 4.303065310930833, bpp: 0
2025-03-03 06:27:48 - INFO - layer11_self_attn.k_proj | mse: 0.008696015019392416, bpp_loss: 5.393593406537548, bpp: 0
2025-03-03 06:27:57 - INFO - layer11_self_attn.v_proj | mse: 0.007582966194356078, bpp_loss: 3.4632961770985276, bpp: 0
2025-03-03 06:28:06 - INFO - layer11_self_attn.o_proj | mse: 0.009100256751373778, bpp_loss: 3.6079401613678783, bpp: 0
2025-03-03 06:28:17 - INFO - layer11_mlp.gate_proj | mse: 0.0076451372452271335, bpp_loss: 4.0002032636797855, bpp: 0
2025-03-03 06:28:28 - INFO - layer11_mlp.up_proj | mse: 0.0075303688345192445, bpp_loss: 3.7472960988857915, bpp: 0
2025-03-03 06:29:07 - INFO - layer11_mlp.down_proj | mse: 0.007649075567668792, bpp_loss: 3.7472224362094755, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [19:17<32:13, 96.67s/it]2025-03-03 06:29:17 - INFO - layer12_self_attn.q_proj | mse: 0.00803008270784514, bpp_loss: 4.362852346559521, bpp: 0
2025-03-03 06:29:26 - INFO - layer12_self_attn.k_proj | mse: 0.008637827195122846, bpp_loss: 5.387546292273328, bpp: 0
2025-03-03 06:29:34 - INFO - layer12_self_attn.v_proj | mse: 0.007638666183319067, bpp_loss: 3.5815921566681936, bpp: 0
2025-03-03 06:29:43 - INFO - layer12_self_attn.o_proj | mse: 0.009216024020973317, bpp_loss: 3.6540336831239983, bpp: 0
2025-03-03 06:29:54 - INFO - layer12_mlp.gate_proj | mse: 0.0076549375263766165, bpp_loss: 3.9817001978600666, bpp: 0
2025-03-03 06:30:06 - INFO - layer12_mlp.up_proj | mse: 0.007553812530718297, bpp_loss: 3.76761023081573, bpp: 0
2025-03-03 06:30:44 - INFO - layer12_mlp.down_proj | mse: 0.007736690412235739, bpp_loss: 3.7602237622486427, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [20:54<30:38, 96.76s/it]2025-03-03 06:30:54 - INFO - layer13_self_attn.q_proj | mse: 0.008158653457080698, bpp_loss: 4.3377021857886575, bpp: 0
2025-03-03 06:31:03 - INFO - layer13_self_attn.k_proj | mse: 0.00903261660146049, bpp_loss: 5.4082923859823495, bpp: 0
2025-03-03 06:31:11 - INFO - layer13_self_attn.v_proj | mse: 0.007742181135631439, bpp_loss: 3.5216210673679598, bpp: 0
2025-03-03 06:31:20 - INFO - layer13_self_attn.o_proj | mse: 0.009383148612724126, bpp_loss: 3.635577206907328, bpp: 0
2025-03-03 06:31:31 - INFO - layer13_mlp.gate_proj | mse: 0.007736706139038259, bpp_loss: 3.9862333270055905, bpp: 0
2025-03-03 06:31:43 - INFO - layer13_mlp.up_proj | mse: 0.007636485020661633, bpp_loss: 3.771065619973732, bpp: 0
2025-03-03 06:32:21 - INFO - layer13_mlp.down_proj | mse: 0.007784550383210755, bpp_loss: 3.76005494398331, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [22:31<29:03, 96.84s/it]2025-03-03 06:32:31 - INFO - layer14_self_attn.q_proj | mse: 0.00816867505158933, bpp_loss: 4.303935129428282, bpp: 0
2025-03-03 06:32:40 - INFO - layer14_self_attn.k_proj | mse: 0.009063648272943965, bpp_loss: 5.352850409224629, bpp: 0
2025-03-03 06:32:48 - INFO - layer14_self_attn.v_proj | mse: 0.007754398688407772, bpp_loss: 3.5146543318405747, bpp: 0
2025-03-03 06:32:57 - INFO - layer14_self_attn.o_proj | mse: 0.009341724525283118, bpp_loss: 3.6275456688017584, bpp: 0
2025-03-03 06:33:08 - INFO - layer14_mlp.gate_proj | mse: 0.0077290099385207015, bpp_loss: 4.019905238944505, bpp: 0
2025-03-03 06:33:20 - INFO - layer14_mlp.up_proj | mse: 0.007614607382903022, bpp_loss: 3.7653298100589643, bpp: 0
2025-03-03 06:33:59 - INFO - layer14_mlp.down_proj | mse: 0.007747553494145013, bpp_loss: 3.7557032928535983, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [24:08<27:27, 96.94s/it]2025-03-03 06:34:08 - INFO - layer15_self_attn.q_proj | mse: 0.008215736783870635, bpp_loss: 4.452397340442985, bpp: 0
2025-03-03 06:34:17 - INFO - layer15_self_attn.k_proj | mse: 0.008904828053718701, bpp_loss: 5.399537301971577, bpp: 0
2025-03-03 06:34:25 - INFO - layer15_self_attn.v_proj | mse: 0.007726618947208588, bpp_loss: 3.5780561416759156, bpp: 0
2025-03-03 06:34:34 - INFO - layer15_self_attn.o_proj | mse: 0.008761899561508574, bpp_loss: 3.658349760225974, bpp: 0
2025-03-03 06:34:45 - INFO - layer15_mlp.gate_proj | mse: 0.007796492820408789, bpp_loss: 4.057924901867019, bpp: 0
2025-03-03 06:34:57 - INFO - layer15_mlp.up_proj | mse: 0.007658548069144693, bpp_loss: 3.757526058570615, bpp: 0
2025-03-03 06:35:35 - INFO - layer15_mlp.down_proj | mse: 0.007811574824025741, bpp_loss: 3.7500584265217185, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [25:45<25:49, 96.84s/it]2025-03-03 06:35:45 - INFO - layer16_self_attn.q_proj | mse: 0.008303711275579427, bpp_loss: 4.423167801462114, bpp: 0
2025-03-03 06:35:53 - INFO - layer16_self_attn.k_proj | mse: 0.009152062390862683, bpp_loss: 5.391217616968788, bpp: 0
2025-03-03 06:36:02 - INFO - layer16_self_attn.v_proj | mse: 0.007818266164634897, bpp_loss: 3.5351388706476428, bpp: 0
2025-03-03 06:36:11 - INFO - layer16_self_attn.o_proj | mse: 0.009343396118845734, bpp_loss: 3.638483423506841, bpp: 0
2025-03-03 06:36:22 - INFO - layer16_mlp.gate_proj | mse: 0.007767344433527117, bpp_loss: 4.0922040311353545, bpp: 0
2025-03-03 06:36:33 - INFO - layer16_mlp.up_proj | mse: 0.0076058988729390264, bpp_loss: 3.7441234684416225, bpp: 0
2025-03-03 06:37:12 - INFO - layer16_mlp.down_proj | mse: 0.007655379532300081, bpp_loss: 3.7363897734820575, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [27:21<24:12, 96.83s/it]2025-03-03 06:37:21 - INFO - layer17_self_attn.q_proj | mse: 0.008077932435705355, bpp_loss: 4.440335704013705, bpp: 0
2025-03-03 06:37:30 - INFO - layer17_self_attn.k_proj | mse: 0.008889626547095757, bpp_loss: 5.421471630921587, bpp: 0
2025-03-03 06:37:39 - INFO - layer17_self_attn.v_proj | mse: 0.007647712923003054, bpp_loss: 3.604099312040489, bpp: 0
2025-03-03 06:37:48 - INFO - layer17_self_attn.o_proj | mse: 0.008615141179021532, bpp_loss: 3.6682594884186983, bpp: 0
2025-03-03 06:38:00 - INFO - layer17_mlp.gate_proj | mse: 0.0077912624169811226, bpp_loss: 4.106840190012008, bpp: 0
2025-03-03 06:38:11 - INFO - layer17_mlp.up_proj | mse: 0.00762060426102194, bpp_loss: 3.7413527773294066, bpp: 0
2025-03-03 06:38:49 - INFO - layer17_mlp.down_proj | mse: 0.007668297858980821, bpp_loss: 3.7336928898002952, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [28:59<22:37, 96.99s/it]2025-03-03 06:38:59 - INFO - layer18_self_attn.q_proj | mse: 0.008099602314125409, bpp_loss: 4.434154608519748, bpp: 0
2025-03-03 06:39:07 - INFO - layer18_self_attn.k_proj | mse: 0.008919243737544663, bpp_loss: 5.50549658795353, bpp: 0
2025-03-03 06:39:16 - INFO - layer18_self_attn.v_proj | mse: 0.007634327862071202, bpp_loss: 3.5291893226094544, bpp: 0
2025-03-03 06:39:25 - INFO - layer18_self_attn.o_proj | mse: 0.008450480521976104, bpp_loss: 3.6464828884927556, bpp: 0
2025-03-03 06:39:36 - INFO - layer18_mlp.gate_proj | mse: 0.007730549509714793, bpp_loss: 4.113481411577335, bpp: 0
2025-03-03 06:39:47 - INFO - layer18_mlp.up_proj | mse: 0.00756236873901578, bpp_loss: 3.7372378361677483, bpp: 0
2025-03-03 06:40:25 - INFO - layer18_mlp.down_proj | mse: 0.007521407867988477, bpp_loss: 3.7320422429059232, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [30:35<20:56, 96.62s/it]2025-03-03 06:40:34 - INFO - layer19_self_attn.q_proj | mse: 0.008012341219149363, bpp_loss: 4.437121341819875, bpp: 0
2025-03-03 06:40:43 - INFO - layer19_self_attn.k_proj | mse: 0.008712812072210528, bpp_loss: 5.399976584361866, bpp: 0
2025-03-03 06:40:51 - INFO - layer19_self_attn.v_proj | mse: 0.007554774348851379, bpp_loss: 3.574879694788251, bpp: 0
2025-03-03 06:41:00 - INFO - layer19_self_attn.o_proj | mse: 0.008296734472811367, bpp_loss: 3.660248403029982, bpp: 0
2025-03-03 06:41:11 - INFO - layer19_mlp.gate_proj | mse: 0.007682628286982592, bpp_loss: 4.124016691997115, bpp: 0
2025-03-03 06:41:23 - INFO - layer19_mlp.up_proj | mse: 0.007505966631092904, bpp_loss: 3.733559100223439, bpp: 0
2025-03-03 06:42:01 - INFO - layer19_mlp.down_proj | mse: 0.00744562123436968, bpp_loss: 3.7297759570314417, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [32:10<19:15, 96.26s/it]2025-03-03 06:42:10 - INFO - layer20_self_attn.q_proj | mse: 0.007995484052697933, bpp_loss: 4.407604395295493, bpp: 0
2025-03-03 06:42:18 - INFO - layer20_self_attn.k_proj | mse: 0.008719462233428874, bpp_loss: 5.34835532552097, bpp: 0
2025-03-03 06:42:27 - INFO - layer20_self_attn.v_proj | mse: 0.007575793116953932, bpp_loss: 3.6089353158604354, bpp: 0
2025-03-03 06:42:36 - INFO - layer20_self_attn.o_proj | mse: 0.00826272246878449, bpp_loss: 3.648251256032381, bpp: 0
2025-03-03 06:42:47 - INFO - layer20_mlp.gate_proj | mse: 0.0076631262241309926, bpp_loss: 4.125613345764577, bpp: 0
2025-03-03 06:42:58 - INFO - layer20_mlp.up_proj | mse: 0.007489354161272795, bpp_loss: 3.737182681515281, bpp: 0
2025-03-03 06:43:36 - INFO - layer20_mlp.down_proj | mse: 0.007419477494495831, bpp_loss: 3.7338719005264074, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [33:45<17:35, 95.94s/it]2025-03-03 06:43:45 - INFO - layer21_self_attn.q_proj | mse: 0.007967009745542706, bpp_loss: 4.404206957900897, bpp: 0
2025-03-03 06:43:54 - INFO - layer21_self_attn.k_proj | mse: 0.008694183364227833, bpp_loss: 5.393449320690706, bpp: 0
2025-03-03 06:44:02 - INFO - layer21_self_attn.v_proj | mse: 0.007565108099696878, bpp_loss: 3.6343603564891964, bpp: 0
2025-03-03 06:44:11 - INFO - layer21_self_attn.o_proj | mse: 0.00869498512075895, bpp_loss: 3.6672629512031563, bpp: 0
2025-03-03 06:44:22 - INFO - layer21_mlp.gate_proj | mse: 0.007698420479892301, bpp_loss: 4.137589324398765, bpp: 0
2025-03-03 06:44:34 - INFO - layer21_mlp.up_proj | mse: 0.007519232602881987, bpp_loss: 3.7401445790060928, bpp: 0
2025-03-03 06:45:12 - INFO - layer21_mlp.down_proj | mse: 0.007489509773845101, bpp_loss: 3.73540902086201, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [35:22<16:01, 96.17s/it]2025-03-03 06:45:23 - INFO - layer22_self_attn.q_proj | mse: 0.008021398822742986, bpp_loss: 4.3625256376108155, bpp: 0
2025-03-03 06:45:32 - INFO - layer22_self_attn.k_proj | mse: 0.008787035027102423, bpp_loss: 5.32485545380041, bpp: 0
2025-03-03 06:45:40 - INFO - layer22_self_attn.v_proj | mse: 0.007661623797161276, bpp_loss: 3.684773305663839, bpp: 0
2025-03-03 06:45:49 - INFO - layer22_self_attn.o_proj | mse: 0.00837198805059737, bpp_loss: 3.6943525944370776, bpp: 0
2025-03-03 06:46:00 - INFO - layer22_mlp.gate_proj | mse: 0.007707239077473938, bpp_loss: 4.141295432911387, bpp: 0
2025-03-03 06:46:12 - INFO - layer22_mlp.up_proj | mse: 0.007526998332421215, bpp_loss: 3.744438089563378, bpp: 0
2025-03-03 06:46:50 - INFO - layer22_mlp.down_proj | mse: 0.007447107831071071, bpp_loss: 3.74117319776477, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [36:59<14:28, 96.50s/it]2025-03-03 06:46:59 - INFO - layer23_self_attn.q_proj | mse: 0.007971336478620293, bpp_loss: 4.374612816376612, bpp: 0
2025-03-03 06:47:08 - INFO - layer23_self_attn.k_proj | mse: 0.00866047047984626, bpp_loss: 5.327821924118325, bpp: 0
2025-03-03 06:47:16 - INFO - layer23_self_attn.v_proj | mse: 0.007628151367312973, bpp_loss: 3.737687414046377, bpp: 0
2025-03-03 06:47:25 - INFO - layer23_self_attn.o_proj | mse: 0.00792902589615301, bpp_loss: 3.7179253653157502, bpp: 0
2025-03-03 06:47:36 - INFO - layer23_mlp.gate_proj | mse: 0.007707999758080052, bpp_loss: 4.1436409730730315, bpp: 0
2025-03-03 06:47:47 - INFO - layer23_mlp.up_proj | mse: 0.007531846326229703, bpp_loss: 3.74837504367211, bpp: 0
2025-03-03 06:48:26 - INFO - layer23_mlp.down_proj | mse: 0.007351145365271648, bpp_loss: 3.7462655351763323, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [38:35<12:50, 96.37s/it]2025-03-03 06:48:35 - INFO - layer24_self_attn.q_proj | mse: 0.007944337490393596, bpp_loss: 4.340407814946957, bpp: 0
2025-03-03 06:48:44 - INFO - layer24_self_attn.k_proj | mse: 0.00857520617146126, bpp_loss: 5.1494853012263775, bpp: 0
2025-03-03 06:48:52 - INFO - layer24_self_attn.v_proj | mse: 0.007665258861325388, bpp_loss: 3.8369427985162474, bpp: 0
2025-03-03 06:49:01 - INFO - layer24_self_attn.o_proj | mse: 0.008218960467989875, bpp_loss: 3.758711996022612, bpp: 0
2025-03-03 06:49:12 - INFO - layer24_mlp.gate_proj | mse: 0.007669872194685746, bpp_loss: 4.150024822780064, bpp: 0
2025-03-03 06:49:23 - INFO - layer24_mlp.up_proj | mse: 0.007492247065210078, bpp_loss: 3.7533008788180138, bpp: 0
2025-03-03 06:50:01 - INFO - layer24_mlp.down_proj | mse: 0.00726785456367133, bpp_loss: 3.7512896390398964, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [40:11<11:13, 96.14s/it]2025-03-03 06:50:11 - INFO - layer25_self_attn.q_proj | mse: 0.007859501220048243, bpp_loss: 4.317785593564622, bpp: 0
2025-03-03 06:50:19 - INFO - layer25_self_attn.k_proj | mse: 0.008431956107525914, bpp_loss: 5.130784427397884, bpp: 0
2025-03-03 06:50:28 - INFO - layer25_self_attn.v_proj | mse: 0.007604334056088259, bpp_loss: 3.8477414656081237, bpp: 0
2025-03-03 06:50:37 - INFO - layer25_self_attn.o_proj | mse: 0.008179051533812728, bpp_loss: 3.760787419276312, bpp: 0
2025-03-03 06:50:48 - INFO - layer25_mlp.gate_proj | mse: 0.007638066805904594, bpp_loss: 4.159637452302767, bpp: 0
2025-03-03 06:50:59 - INFO - layer25_mlp.up_proj | mse: 0.007462690609189327, bpp_loss: 3.7626461384019683, bpp: 0
2025-03-03 06:51:37 - INFO - layer25_mlp.down_proj | mse: 0.007218658642208538, bpp_loss: 3.7601125967589075, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [41:47<09:36, 96.07s/it]2025-03-03 06:51:46 - INFO - layer26_self_attn.q_proj | mse: 0.007868829697122116, bpp_loss: 4.328584690345451, bpp: 0
2025-03-03 06:51:55 - INFO - layer26_self_attn.k_proj | mse: 0.008551142611618136, bpp_loss: 5.21565349411685, bpp: 0
2025-03-03 06:52:04 - INFO - layer26_self_attn.v_proj | mse: 0.007633866508042006, bpp_loss: 3.8997987544862553, bpp: 0
2025-03-03 06:52:13 - INFO - layer26_self_attn.o_proj | mse: 0.008945656798911673, bpp_loss: 3.784688293468207, bpp: 0
2025-03-03 06:52:24 - INFO - layer26_mlp.gate_proj | mse: 0.007614133095648068, bpp_loss: 4.166980094475938, bpp: 0
2025-03-03 06:52:35 - INFO - layer26_mlp.up_proj | mse: 0.007436428504433351, bpp_loss: 3.772008219667311, bpp: 0
2025-03-03 06:53:14 - INFO - layer26_mlp.down_proj | mse: 0.007194587529361573, bpp_loss: 3.768060889876714, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [43:23<08:00, 96.17s/it]2025-03-03 06:53:23 - INFO - layer27_self_attn.q_proj | mse: 0.007788417210780429, bpp_loss: 4.296792319917586, bpp: 0
2025-03-03 06:53:32 - INFO - layer27_self_attn.k_proj | mse: 0.008434210006645005, bpp_loss: 5.168573482776992, bpp: 0
2025-03-03 06:53:40 - INFO - layer27_self_attn.v_proj | mse: 0.007614457771347467, bpp_loss: 3.993573458166793, bpp: 0
2025-03-03 06:53:49 - INFO - layer27_self_attn.o_proj | mse: 0.008177952830418236, bpp_loss: 3.8162577155744657, bpp: 0
2025-03-03 06:54:01 - INFO - layer27_mlp.gate_proj | mse: 0.007579356996643479, bpp_loss: 4.178606947750917, bpp: 0
2025-03-03 06:54:12 - INFO - layer27_mlp.up_proj | mse: 0.007402945314141218, bpp_loss: 3.78768029522949, bpp: 0
2025-03-03 06:54:50 - INFO - layer27_mlp.down_proj | mse: 0.007214197196651469, bpp_loss: 3.778863353804419, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [45:00<06:24, 96.25s/it]2025-03-03 06:54:59 - INFO - layer28_self_attn.q_proj | mse: 0.007763688779667599, bpp_loss: 4.306564037222415, bpp: 0
2025-03-03 06:55:08 - INFO - layer28_self_attn.k_proj | mse: 0.00829564373628394, bpp_loss: 5.118055415106937, bpp: 0
2025-03-03 06:55:16 - INFO - layer28_self_attn.v_proj | mse: 0.007622891786527999, bpp_loss: 4.047502359084319, bpp: 0
2025-03-03 06:55:25 - INFO - layer28_self_attn.o_proj | mse: 0.008370808954271574, bpp_loss: 3.8466994286864065, bpp: 0
2025-03-03 06:55:37 - INFO - layer28_mlp.gate_proj | mse: 0.007581259939748434, bpp_loss: 4.165428744030318, bpp: 0
2025-03-03 06:55:48 - INFO - layer28_mlp.up_proj | mse: 0.007419620691171409, bpp_loss: 3.810621730251504, bpp: 0
2025-03-03 06:56:26 - INFO - layer28_mlp.down_proj | mse: 0.00726956961287249, bpp_loss: 3.7946722325037365, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [46:35<04:48, 96.05s/it]2025-03-03 06:56:35 - INFO - layer29_self_attn.q_proj | mse: 0.007729623904613829, bpp_loss: 4.294163090293296, bpp: 0
2025-03-03 06:56:44 - INFO - layer29_self_attn.k_proj | mse: 0.008299719875179263, bpp_loss: 5.212106883001979, bpp: 0
2025-03-03 06:56:52 - INFO - layer29_self_attn.v_proj | mse: 0.007636381865252996, bpp_loss: 4.116973007796332, bpp: 0
2025-03-03 06:57:01 - INFO - layer29_self_attn.o_proj | mse: 0.008659483312590695, bpp_loss: 3.8838386483257636, bpp: 0
2025-03-03 06:57:12 - INFO - layer29_mlp.gate_proj | mse: 0.007623644500267045, bpp_loss: 4.157381862734577, bpp: 0
2025-03-03 06:57:23 - INFO - layer29_mlp.up_proj | mse: 0.007479283213574674, bpp_loss: 3.844712624259825, bpp: 0
2025-03-03 06:58:01 - INFO - layer29_mlp.down_proj | mse: 0.007321579804259963, bpp_loss: 3.8104422109733735, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [48:11<03:11, 95.92s/it]2025-03-03 06:58:11 - INFO - layer30_self_attn.q_proj | mse: 0.007841026055321734, bpp_loss: 4.198237436125055, bpp: 0
2025-03-03 06:58:19 - INFO - layer30_self_attn.k_proj | mse: 0.008424754059698072, bpp_loss: 4.85776401637122, bpp: 0
2025-03-03 06:58:28 - INFO - layer30_self_attn.v_proj | mse: 0.007925213388131513, bpp_loss: 4.409464531112462, bpp: 0
2025-03-03 06:58:37 - INFO - layer30_self_attn.o_proj | mse: 0.009033020014638295, bpp_loss: 3.972793844761327, bpp: 0
2025-03-03 06:58:48 - INFO - layer30_mlp.gate_proj | mse: 0.007684508053746991, bpp_loss: 4.210292234883776, bpp: 0
2025-03-03 06:58:59 - INFO - layer30_mlp.up_proj | mse: 0.007528430299177008, bpp_loss: 3.877512888849846, bpp: 0
2025-03-03 06:59:38 - INFO - layer30_mlp.down_proj | mse: 0.007635956103461083, bpp_loss: 3.8116662765886367, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [49:48<01:36, 96.16s/it]2025-03-03 06:59:48 - INFO - layer31_self_attn.q_proj | mse: 0.008034578917913043, bpp_loss: 4.353784507024102, bpp: 0
2025-03-03 06:59:56 - INFO - layer31_self_attn.k_proj | mse: 0.0085455419040706, bpp_loss: 5.101878410845529, bpp: 0
2025-03-03 07:00:05 - INFO - layer31_self_attn.v_proj | mse: 0.007939576925191223, bpp_loss: 4.222111586888786, bpp: 0
2025-03-03 07:00:14 - INFO - layer31_self_attn.o_proj | mse: 0.009385334431342833, bpp_loss: 3.9332549414830282, bpp: 0
2025-03-03 07:00:25 - INFO - layer31_mlp.gate_proj | mse: 0.00819587662586428, bpp_loss: 4.434691559722913, bpp: 0
2025-03-03 07:00:37 - INFO - layer31_mlp.up_proj | mse: 0.008009171337249271, bpp_loss: 4.076772084526185, bpp: 0
2025-03-03 07:01:16 - INFO - layer31_mlp.down_proj | mse: 0.00920027631836021, bpp_loss: 3.838187501932095, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [51:25<00:00, 96.59s/it]pseudo compress quantization...: 100%|██████████| 32/32 [51:25<00:00, 96.42s/it]
2025-03-03 07:01:16 - INFO - #### Total | mse: 0.007850612335234578, bpp_loss: 3.9118807163706433, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda300_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_5.34295_bpp_5.7068_MSE_0.00302_total_iter_95000.pth.tar/COL_MSE0.00785_bpploss3.9119_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda300_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_5.34295_bpp_5.7068_MSE_0.00302_total_iter_95000.pth.tar/COL_MSE0.00785_bpploss3.9119_bpp0
I0303 07:01:52.291818 3059442 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:02,  1.19it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.25it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.33it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s]
I0303 07:01:54.994250 3059442 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.609375:   0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.609375:   1%|          | 1/141 [00:00<01:12,  1.94it/s]avg_loss = 1.90625:   1%|          | 1/141 [00:00<01:12,  1.94it/s] avg_loss = 1.90625:   1%|▏         | 2/141 [00:00<01:03,  2.18it/s]avg_loss = 2.0364583333333335:   1%|▏         | 2/141 [00:01<01:03,  2.18it/s]avg_loss = 2.0364583333333335:   2%|▏         | 3/141 [00:01<01:00,  2.27it/s]avg_loss = 1.986328125:   2%|▏         | 3/141 [00:01<01:00,  2.27it/s]       avg_loss = 1.986328125:   3%|▎         | 4/141 [00:01<00:59,  2.31it/s]avg_loss = 1.9359375:   3%|▎         | 4/141 [00:02<00:59,  2.31it/s]  avg_loss = 1.9359375:   4%|▎         | 5/141 [00:02<00:58,  2.33it/s]avg_loss = 1.83984375:   4%|▎         | 5/141 [00:02<00:58,  2.33it/s]avg_loss = 1.83984375:   4%|▍         | 6/141 [00:02<00:57,  2.34it/s]avg_loss = 1.7767857142857142:   4%|▍         | 6/141 [00:03<00:57,  2.34it/s]avg_loss = 1.7767857142857142:   5%|▍         | 7/141 [00:03<00:56,  2.35it/s]avg_loss = 1.7724609375:   5%|▍         | 7/141 [00:03<00:56,  2.35it/s]      avg_loss = 1.7724609375:   6%|▌         | 8/141 [00:03<00:56,  2.36it/s]avg_loss = 1.8064236111111112:   6%|▌         | 8/141 [00:03<00:56,  2.36it/s]avg_loss = 1.8064236111111112:   6%|▋         | 9/141 [00:03<00:55,  2.36it/s]avg_loss = 1.809375:   6%|▋         | 9/141 [00:04<00:55,  2.36it/s]          avg_loss = 1.809375:   7%|▋         | 10/141 [00:04<00:55,  2.36it/s]avg_loss = 1.8053977272727273:   7%|▋         | 10/141 [00:04<00:55,  2.36it/s]avg_loss = 1.8053977272727273:   8%|▊         | 11/141 [00:04<00:55,  2.36it/s]avg_loss = 1.828125:   8%|▊         | 11/141 [00:05<00:55,  2.36it/s]          avg_loss = 1.828125:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.8413461538461537:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.8413461538461537:   9%|▉         | 13/141 [00:05<00:54,  2.36it/s]avg_loss = 1.859375:   9%|▉         | 13/141 [00:05<00:54,  2.36it/s]          avg_loss = 1.859375:  10%|▉         | 14/141 [00:05<00:53,  2.36it/s]avg_loss = 1.86875:  10%|▉         | 14/141 [00:06<00:53,  2.36it/s] avg_loss = 1.86875:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.8935546875:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.8935546875:  11%|█▏        | 16/141 [00:06<00:52,  2.37it/s]avg_loss = 1.8970588235294117:  11%|█▏        | 16/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8970588235294117:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8993055555555556:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8993055555555556:  13%|█▎        | 18/141 [00:07<00:51,  2.38it/s]avg_loss = 1.8828125:  13%|█▎        | 18/141 [00:08<00:51,  2.38it/s]         avg_loss = 1.8828125:  13%|█▎        | 19/141 [00:08<00:51,  2.37it/s]avg_loss = 1.88203125:  13%|█▎        | 19/141 [00:08<00:51,  2.37it/s]avg_loss = 1.88203125:  14%|█▍        | 20/141 [00:08<00:50,  2.37it/s]avg_loss = 1.8869047619047619:  14%|█▍        | 20/141 [00:08<00:50,  2.37it/s]avg_loss = 1.8869047619047619:  15%|█▍        | 21/141 [00:08<00:50,  2.37it/s]avg_loss = 1.8895596590909092:  15%|█▍        | 21/141 [00:09<00:50,  2.37it/s]avg_loss = 1.8895596590909092:  16%|█▌        | 22/141 [00:09<00:50,  2.37it/s]avg_loss = 1.8909646739130435:  16%|█▌        | 22/141 [00:09<00:50,  2.37it/s]avg_loss = 1.8909646739130435:  16%|█▋        | 23/141 [00:09<00:49,  2.37it/s]avg_loss = 1.8961588541666667:  16%|█▋        | 23/141 [00:10<00:49,  2.37it/s]avg_loss = 1.8961588541666667:  17%|█▋        | 24/141 [00:10<00:49,  2.37it/s]avg_loss = 1.9021875:  17%|█▋        | 24/141 [00:10<00:49,  2.37it/s]         avg_loss = 1.9021875:  18%|█▊        | 25/141 [00:10<00:48,  2.37it/s]avg_loss = 1.9137620192307692:  18%|█▊        | 25/141 [00:11<00:48,  2.37it/s]avg_loss = 1.9137620192307692:  18%|█▊        | 26/141 [00:11<00:48,  2.37it/s]avg_loss = 1.9262152777777777:  18%|█▊        | 26/141 [00:11<00:48,  2.37it/s]avg_loss = 1.9262152777777777:  19%|█▉        | 27/141 [00:11<00:48,  2.37it/s]avg_loss = 1.9321986607142858:  19%|█▉        | 27/141 [00:11<00:48,  2.37it/s]avg_loss = 1.9321986607142858:  20%|█▉        | 28/141 [00:11<00:47,  2.37it/s]avg_loss = 1.9286099137931034:  20%|█▉        | 28/141 [00:12<00:47,  2.37it/s]avg_loss = 1.9286099137931034:  21%|██        | 29/141 [00:12<00:47,  2.37it/s]avg_loss = 1.9184895833333333:  21%|██        | 29/141 [00:12<00:47,  2.37it/s]avg_loss = 1.9184895833333333:  21%|██▏       | 30/141 [00:12<00:46,  2.37it/s]avg_loss = 1.9047379032258065:  21%|██▏       | 30/141 [00:13<00:46,  2.37it/s]avg_loss = 1.9047379032258065:  22%|██▏       | 31/141 [00:13<00:46,  2.36it/s]avg_loss = 1.8935546875:  22%|██▏       | 31/141 [00:13<00:46,  2.36it/s]      avg_loss = 1.8935546875:  23%|██▎       | 32/141 [00:13<00:46,  2.37it/s]avg_loss = 1.8920454545454546:  23%|██▎       | 32/141 [00:14<00:46,  2.37it/s]avg_loss = 1.8920454545454546:  23%|██▎       | 33/141 [00:14<00:45,  2.36it/s]avg_loss = 1.890625:  23%|██▎       | 33/141 [00:14<00:45,  2.36it/s]          avg_loss = 1.890625:  24%|██▍       | 34/141 [00:14<00:45,  2.37it/s]avg_loss = 1.89375:  24%|██▍       | 34/141 [00:14<00:45,  2.37it/s] avg_loss = 1.89375:  25%|██▍       | 35/141 [00:14<00:44,  2.36it/s]avg_loss = 1.8771701388888888:  25%|██▍       | 35/141 [00:15<00:44,  2.36it/s]avg_loss = 1.8771701388888888:  26%|██▌       | 36/141 [00:15<00:44,  2.36it/s]avg_loss = 1.861697635135135:  26%|██▌       | 36/141 [00:15<00:44,  2.36it/s] avg_loss = 1.861697635135135:  26%|██▌       | 37/141 [00:15<00:44,  2.36it/s]avg_loss = 1.8470394736842106:  26%|██▌       | 37/141 [00:16<00:44,  2.36it/s]avg_loss = 1.8470394736842106:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 1.8327323717948718:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 1.8327323717948718:  28%|██▊       | 39/141 [00:16<00:43,  2.36it/s]avg_loss = 1.8240234375:  28%|██▊       | 39/141 [00:16<00:43,  2.36it/s]      avg_loss = 1.8240234375:  28%|██▊       | 40/141 [00:16<00:42,  2.36it/s]avg_loss = 1.829077743902439:  28%|██▊       | 40/141 [00:17<00:42,  2.36it/s]avg_loss = 1.829077743902439:  29%|██▉       | 41/141 [00:17<00:42,  2.36it/s]avg_loss = 1.8461681547619047:  29%|██▉       | 41/141 [00:17<00:42,  2.36it/s]avg_loss = 1.8461681547619047:  30%|██▉       | 42/141 [00:17<00:41,  2.36it/s]avg_loss = 1.8624636627906976:  30%|██▉       | 42/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8624636627906976:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8659446022727273:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8659446022727273:  31%|███       | 44/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8703125:  31%|███       | 44/141 [00:19<00:41,  2.36it/s]         avg_loss = 1.8703125:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8755095108695652:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8755095108695652:  33%|███▎      | 46/141 [00:19<00:40,  2.35it/s]avg_loss = 1.8821476063829787:  33%|███▎      | 46/141 [00:19<00:40,  2.35it/s]avg_loss = 1.8821476063829787:  33%|███▎      | 47/141 [00:19<00:39,  2.36it/s]avg_loss = 1.8849283854166667:  33%|███▎      | 47/141 [00:20<00:39,  2.36it/s]avg_loss = 1.8849283854166667:  34%|███▍      | 48/141 [00:20<00:39,  2.35it/s]avg_loss = 1.8837691326530612:  34%|███▍      | 48/141 [00:20<00:39,  2.35it/s]avg_loss = 1.8837691326530612:  35%|███▍      | 49/141 [00:20<00:39,  2.36it/s]avg_loss = 1.8834375:  35%|███▍      | 49/141 [00:21<00:39,  2.36it/s]         avg_loss = 1.8834375:  35%|███▌      | 50/141 [00:21<00:38,  2.35it/s]avg_loss = 1.877297794117647:  35%|███▌      | 50/141 [00:21<00:38,  2.35it/s]avg_loss = 1.877297794117647:  36%|███▌      | 51/141 [00:21<00:38,  2.35it/s]avg_loss = 1.8734975961538463:  36%|███▌      | 51/141 [00:22<00:38,  2.35it/s]avg_loss = 1.8734975961538463:  37%|███▋      | 52/141 [00:22<00:37,  2.35it/s]avg_loss = 1.8670400943396226:  37%|███▋      | 52/141 [00:22<00:37,  2.35it/s]avg_loss = 1.8670400943396226:  38%|███▊      | 53/141 [00:22<00:37,  2.35it/s]avg_loss = 1.8641493055555556:  38%|███▊      | 53/141 [00:22<00:37,  2.35it/s]avg_loss = 1.8641493055555556:  38%|███▊      | 54/141 [00:22<00:36,  2.35it/s]avg_loss = 1.8566761363636364:  38%|███▊      | 54/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8566761363636364:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8489118303571428:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8489118303571428:  40%|███▉      | 56/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8430646929824561:  40%|███▉      | 56/141 [00:24<00:36,  2.35it/s]avg_loss = 1.8430646929824561:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.8401131465517242:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.8401131465517242:  41%|████      | 58/141 [00:24<00:35,  2.35it/s]avg_loss = 1.8424258474576272:  41%|████      | 58/141 [00:25<00:35,  2.35it/s]avg_loss = 1.8424258474576272:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8479166666666667:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8479166666666667:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8537397540983607:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8537397540983607:  43%|████▎     | 61/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8611391129032258:  43%|████▎     | 61/141 [00:26<00:34,  2.35it/s]avg_loss = 1.8611391129032258:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8520585317460319:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8520585317460319:  45%|████▍     | 63/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8497314453125:  45%|████▍     | 63/141 [00:27<00:33,  2.35it/s]   avg_loss = 1.8497314453125:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 1.8469951923076924:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 1.8469951923076924:  46%|████▌     | 65/141 [00:27<00:32,  2.34it/s]avg_loss = 1.8410274621212122:  46%|████▌     | 65/141 [00:28<00:32,  2.34it/s]avg_loss = 1.8410274621212122:  47%|████▋     | 66/141 [00:28<00:31,  2.34it/s]avg_loss = 1.8385027985074627:  47%|████▋     | 66/141 [00:28<00:31,  2.34it/s]avg_loss = 1.8385027985074627:  48%|████▊     | 67/141 [00:28<00:31,  2.34it/s]avg_loss = 1.8350183823529411:  48%|████▊     | 67/141 [00:28<00:31,  2.34it/s]avg_loss = 1.8350183823529411:  48%|████▊     | 68/141 [00:28<00:31,  2.34it/s]avg_loss = 1.8322010869565217:  48%|████▊     | 68/141 [00:29<00:31,  2.34it/s]avg_loss = 1.8322010869565217:  49%|████▉     | 69/141 [00:29<00:30,  2.34it/s]avg_loss = 1.8330357142857143:  49%|████▉     | 69/141 [00:29<00:30,  2.34it/s]avg_loss = 1.8330357142857143:  50%|████▉     | 70/141 [00:29<00:30,  2.34it/s]avg_loss = 1.8367077464788732:  50%|████▉     | 70/141 [00:30<00:30,  2.34it/s]avg_loss = 1.8367077464788732:  50%|█████     | 71/141 [00:30<00:29,  2.34it/s]avg_loss = 1.8391927083333333:  50%|█████     | 71/141 [00:30<00:29,  2.34it/s]avg_loss = 1.8391927083333333:  51%|█████     | 72/141 [00:30<00:29,  2.34it/s]avg_loss = 1.8377568493150684:  51%|█████     | 72/141 [00:31<00:29,  2.34it/s]avg_loss = 1.8377568493150684:  52%|█████▏    | 73/141 [00:31<00:29,  2.34it/s]avg_loss = 1.8394214527027026:  52%|█████▏    | 73/141 [00:31<00:29,  2.34it/s]avg_loss = 1.8394214527027026:  52%|█████▏    | 74/141 [00:31<00:28,  2.34it/s]avg_loss = 1.8395833333333333:  52%|█████▏    | 74/141 [00:31<00:28,  2.34it/s]avg_loss = 1.8395833333333333:  53%|█████▎    | 75/141 [00:31<00:28,  2.34it/s]avg_loss = 1.8385074013157894:  53%|█████▎    | 75/141 [00:32<00:28,  2.34it/s]avg_loss = 1.8385074013157894:  54%|█████▍    | 76/141 [00:32<00:27,  2.34it/s]avg_loss = 1.8396915584415585:  54%|█████▍    | 76/141 [00:32<00:27,  2.34it/s]avg_loss = 1.8396915584415585:  55%|█████▍    | 77/141 [00:32<00:27,  2.34it/s]avg_loss = 1.842147435897436:  55%|█████▍    | 77/141 [00:33<00:27,  2.34it/s] avg_loss = 1.842147435897436:  55%|█████▌    | 78/141 [00:33<00:26,  2.34it/s]avg_loss = 1.8463212025316456:  55%|█████▌    | 78/141 [00:33<00:26,  2.34it/s]avg_loss = 1.8463212025316456:  56%|█████▌    | 79/141 [00:33<00:26,  2.34it/s]avg_loss = 1.84345703125:  56%|█████▌    | 79/141 [00:34<00:26,  2.34it/s]     avg_loss = 1.84345703125:  57%|█████▋    | 80/141 [00:34<00:26,  2.34it/s]avg_loss = 1.8423032407407407:  57%|█████▋    | 80/141 [00:34<00:26,  2.34it/s]avg_loss = 1.8423032407407407:  57%|█████▋    | 81/141 [00:34<00:25,  2.34it/s]avg_loss = 1.8415586890243902:  57%|█████▋    | 81/141 [00:34<00:25,  2.34it/s]avg_loss = 1.8415586890243902:  58%|█████▊    | 82/141 [00:34<00:25,  2.34it/s]avg_loss = 1.839890813253012:  58%|█████▊    | 82/141 [00:35<00:25,  2.34it/s] avg_loss = 1.839890813253012:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]avg_loss = 1.837797619047619:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]avg_loss = 1.837797619047619:  60%|█████▉    | 84/141 [00:35<00:24,  2.34it/s]avg_loss = 1.8352941176470587:  60%|█████▉    | 84/141 [00:36<00:24,  2.34it/s]avg_loss = 1.8352941176470587:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s]avg_loss = 1.8370276162790697:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s]avg_loss = 1.8370276162790697:  61%|██████    | 86/141 [00:36<00:23,  2.34it/s]avg_loss = 1.839080459770115:  61%|██████    | 86/141 [00:37<00:23,  2.34it/s] avg_loss = 1.839080459770115:  62%|██████▏   | 87/141 [00:37<00:23,  2.34it/s]avg_loss = 1.8396661931818181:  62%|██████▏   | 87/141 [00:37<00:23,  2.34it/s]avg_loss = 1.8396661931818181:  62%|██████▏   | 88/141 [00:37<00:22,  2.34it/s]avg_loss = 1.8484901685393258:  62%|██████▏   | 88/141 [00:37<00:22,  2.34it/s]avg_loss = 1.8484901685393258:  63%|██████▎   | 89/141 [00:37<00:22,  2.34it/s]avg_loss = 1.856076388888889:  63%|██████▎   | 89/141 [00:38<00:22,  2.34it/s] avg_loss = 1.856076388888889:  64%|██████▍   | 90/141 [00:38<00:21,  2.34it/s]avg_loss = 1.859375:  64%|██████▍   | 90/141 [00:38<00:21,  2.34it/s]         avg_loss = 1.859375:  65%|██████▍   | 91/141 [00:38<00:21,  2.34it/s]avg_loss = 1.864470108695652:  65%|██████▍   | 91/141 [00:39<00:21,  2.34it/s]avg_loss = 1.864470108695652:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8696236559139785:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8696236559139785:  66%|██████▌   | 93/141 [00:39<00:20,  2.34it/s]avg_loss = 1.8706781914893618:  66%|██████▌   | 93/141 [00:40<00:20,  2.34it/s]avg_loss = 1.8706781914893618:  67%|██████▋   | 94/141 [00:40<00:20,  2.35it/s]avg_loss = 1.8745065789473685:  67%|██████▋   | 94/141 [00:40<00:20,  2.35it/s]avg_loss = 1.8745065789473685:  67%|██████▋   | 95/141 [00:40<00:19,  2.34it/s]avg_loss = 1.875244140625:  67%|██████▋   | 95/141 [00:40<00:19,  2.34it/s]    avg_loss = 1.875244140625:  68%|██████▊   | 96/141 [00:40<00:19,  2.35it/s]avg_loss = 1.877174613402062:  68%|██████▊   | 96/141 [00:41<00:19,  2.35it/s]avg_loss = 1.877174613402062:  69%|██████▉   | 97/141 [00:41<00:18,  2.34it/s]avg_loss = 1.8728475765306123:  69%|██████▉   | 97/141 [00:41<00:18,  2.34it/s]avg_loss = 1.8728475765306123:  70%|██████▉   | 98/141 [00:41<00:18,  2.34it/s]avg_loss = 1.8737373737373737:  70%|██████▉   | 98/141 [00:42<00:18,  2.34it/s]avg_loss = 1.8737373737373737:  70%|███████   | 99/141 [00:42<00:17,  2.34it/s]avg_loss = 1.8759375:  70%|███████   | 99/141 [00:42<00:17,  2.34it/s]         avg_loss = 1.8759375:  71%|███████   | 100/141 [00:42<00:17,  2.34it/s]avg_loss = 1.8746132425742574:  71%|███████   | 100/141 [00:42<00:17,  2.34it/s]avg_loss = 1.8746132425742574:  72%|███████▏  | 101/141 [00:42<00:17,  2.34it/s]avg_loss = 1.8749234068627452:  72%|███████▏  | 101/141 [00:43<00:17,  2.34it/s]avg_loss = 1.8749234068627452:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]avg_loss = 1.8731796116504855:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]avg_loss = 1.8731796116504855:  73%|███████▎  | 103/141 [00:43<00:16,  2.34it/s]avg_loss = 1.8759014423076923:  73%|███████▎  | 103/141 [00:44<00:16,  2.34it/s]avg_loss = 1.8759014423076923:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8742559523809523:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8742559523809523:  74%|███████▍  | 105/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8732311320754718:  74%|███████▍  | 105/141 [00:45<00:15,  2.34it/s]avg_loss = 1.8732311320754718:  75%|███████▌  | 106/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8708382009345794:  75%|███████▌  | 106/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8708382009345794:  76%|███████▌  | 107/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8685619212962963:  76%|███████▌  | 107/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8685619212962963:  77%|███████▋  | 108/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8660407110091743:  77%|███████▋  | 108/141 [00:46<00:14,  2.34it/s]avg_loss = 1.8660407110091743:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8634232954545455:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8634232954545455:  78%|███████▊  | 110/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8656390765765767:  78%|███████▊  | 110/141 [00:47<00:13,  2.34it/s]avg_loss = 1.8656390765765767:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8653738839285714:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8653738839285714:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8664269911504425:  79%|███████▉  | 112/141 [00:48<00:12,  2.34it/s]avg_loss = 1.8664269911504425:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8675986842105263:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8675986842105263:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8669157608695652:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8669157608695652:  82%|████████▏ | 115/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8655711206896552:  82%|████████▏ | 115/141 [00:49<00:11,  2.34it/s]avg_loss = 1.8655711206896552:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8676549145299146:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8676549145299146:  83%|████████▎ | 117/141 [00:49<00:10,  2.34it/s]avg_loss = 1.867386122881356:  83%|████████▎ | 117/141 [00:50<00:10,  2.34it/s] avg_loss = 1.867386122881356:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8660057773109244:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8660057773109244:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8642578125:  84%|████████▍ | 119/141 [00:51<00:09,  2.34it/s]      avg_loss = 1.8642578125:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8640237603305785:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8640237603305785:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8643698770491803:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8643698770491803:  87%|████████▋ | 122/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8642022357723578:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 1.8642022357723578:  87%|████████▋ | 123/141 [00:52<00:07,  2.33it/s]avg_loss = 1.864352318548387:  87%|████████▋ | 123/141 [00:52<00:07,  2.33it/s] avg_loss = 1.864352318548387:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8631875:  88%|████████▊ | 124/141 [00:53<00:07,  2.34it/s]        avg_loss = 1.8631875:  89%|████████▊ | 125/141 [00:53<00:06,  2.33it/s]avg_loss = 1.8636532738095237:  89%|████████▊ | 125/141 [00:53<00:06,  2.33it/s]avg_loss = 1.8636532738095237:  89%|████████▉ | 126/141 [00:53<00:06,  2.33it/s]avg_loss = 1.8633735236220472:  89%|████████▉ | 126/141 [00:54<00:06,  2.33it/s]avg_loss = 1.8633735236220472:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]avg_loss = 1.862060546875:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]    avg_loss = 1.862060546875:  91%|█████████ | 128/141 [00:54<00:05,  2.33it/s]avg_loss = 1.8622214147286822:  91%|█████████ | 128/141 [00:54<00:05,  2.33it/s]avg_loss = 1.8622214147286822:  91%|█████████▏| 129/141 [00:54<00:05,  2.34it/s]avg_loss = 1.862920673076923:  91%|█████████▏| 129/141 [00:55<00:05,  2.34it/s] avg_loss = 1.862920673076923:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 1.8639074427480915:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 1.8639074427480915:  93%|█████████▎| 131/141 [00:55<00:04,  2.33it/s]avg_loss = 1.8645833333333333:  93%|█████████▎| 131/141 [00:56<00:04,  2.33it/s]avg_loss = 1.8645833333333333:  94%|█████████▎| 132/141 [00:56<00:03,  2.33it/s]avg_loss = 1.8617246240601504:  94%|█████████▎| 132/141 [00:56<00:03,  2.33it/s]avg_loss = 1.8617246240601504:  94%|█████████▍| 133/141 [00:56<00:03,  2.33it/s]avg_loss = 1.857276119402985:  94%|█████████▍| 133/141 [00:57<00:03,  2.33it/s] avg_loss = 1.857276119402985:  95%|█████████▌| 134/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8597222222222223:  95%|█████████▌| 134/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8597222222222223:  96%|█████████▌| 135/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8631663602941178:  96%|█████████▌| 135/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8631663602941178:  96%|█████████▋| 136/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8642791970802919:  96%|█████████▋| 136/141 [00:58<00:02,  2.33it/s]avg_loss = 1.8642791970802919:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]avg_loss = 1.8629981884057971:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]avg_loss = 1.8629981884057971:  98%|█████████▊| 138/141 [00:58<00:01,  2.33it/s]avg_loss = 1.8633093525179856:  98%|█████████▊| 138/141 [00:59<00:01,  2.33it/s]avg_loss = 1.8633093525179856:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8638392857142858:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8638392857142858:  99%|█████████▉| 140/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8650265957446808:  99%|█████████▉| 140/141 [01:00<00:00,  2.33it/s]avg_loss = 1.8650265957446808: 100%|██████████| 141/141 [01:00<00:00,  2.33it/s]avg_loss = 1.8650265957446808: 100%|██████████| 141/141 [01:00<00:00,  2.35it/s]
I0303 07:03:17.237591 3059442 eval_ppl.py:105] wikitext2 perplexity: 6.4561076164245605
wikitext2 perplexity: 6.456
Running with lmbda=1000
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.72it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  9.29it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.80it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.98it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.16it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.96it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.52it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:23,  1.34it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:23,  1.30it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:02<00:22,  1.32it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:03<00:21,  1.33it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:03<00:20,  1.35it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:04<00:19,  1.37it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:05<00:18,  1.32it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:06<00:20,  1.20it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:07<00:19,  1.19it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:07<00:17,  1.25it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:08<00:15,  1.35it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:09<00:14,  1.39it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:09<00:13,  1.45it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:10<00:11,  1.51it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:10<00:10,  1.56it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:11<00:10,  1.55it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:12<00:09,  1.61it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:12<00:08,  1.67it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:13<00:07,  1.76it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:13<00:06,  1.79it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:14<00:06,  1.70it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:14<00:05,  1.72it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:15<00:05,  1.76it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:16<00:04,  1.80it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:16<00:03,  1.87it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:16<00:03,  1.95it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:17<00:02,  2.02it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:17<00:01,  2.06it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:18<00:01,  2.10it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:18<00:00,  2.13it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:19<00:00,  2.07it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:19<00:00,  1.98it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:19<00:00,  1.61it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 07:04:06 - INFO - layer0_self_attn.q_proj | mse: 0.01236142860146336, bpp_loss: 5.1031448081485, bpp: 0
2025-03-03 07:04:14 - INFO - layer0_self_attn.k_proj | mse: 0.01766276301247088, bpp_loss: 5.781144375272561, bpp: 0
2025-03-03 07:04:23 - INFO - layer0_self_attn.v_proj | mse: 0.003638785053162827, bpp_loss: 4.200933496642392, bpp: 0
2025-03-03 07:04:32 - INFO - layer0_self_attn.o_proj | mse: 0.0026529643791962324, bpp_loss: 4.293151559657417, bpp: 0
2025-03-03 07:04:43 - INFO - layer0_mlp.gate_proj | mse: 0.002531778062138138, bpp_loss: 4.6904913163078685, bpp: 0
2025-03-03 07:04:54 - INFO - layer0_mlp.up_proj | mse: 0.002517866256787663, bpp_loss: 4.574995679514749, bpp: 0
2025-03-03 07:05:32 - INFO - layer0_mlp.down_proj | mse: 0.0024826454617486522, bpp_loss: 4.570293337838458, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:35<49:24, 95.62s/it]2025-03-03 07:05:42 - INFO - layer1_self_attn.q_proj | mse: 0.003511753357792329, bpp_loss: 5.388787277741358, bpp: 0
2025-03-03 07:05:50 - INFO - layer1_self_attn.k_proj | mse: 0.004029398010506176, bpp_loss: 6.275170250388328, bpp: 0
2025-03-03 07:05:59 - INFO - layer1_self_attn.v_proj | mse: 0.0031285485004295785, bpp_loss: 4.302170497889165, bpp: 0
2025-03-03 07:06:08 - INFO - layer1_self_attn.o_proj | mse: 0.003110449951237108, bpp_loss: 4.375912149203941, bpp: 0
2025-03-03 07:06:19 - INFO - layer1_mlp.gate_proj | mse: 0.0025644314566657125, bpp_loss: 4.699911825824529, bpp: 0
2025-03-03 07:06:31 - INFO - layer1_mlp.up_proj | mse: 0.002549038227904149, bpp_loss: 4.588998794422618, bpp: 0
2025-03-03 07:07:09 - INFO - layer1_mlp.down_proj | mse: 0.002296912751710554, bpp_loss: 4.584663251614464, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [03:12<48:12, 96.40s/it]2025-03-03 07:07:19 - INFO - layer2_self_attn.q_proj | mse: 0.002827929092400821, bpp_loss: 5.282986041391268, bpp: 0
2025-03-03 07:07:27 - INFO - layer2_self_attn.k_proj | mse: 0.003099063125417587, bpp_loss: 6.2875787992961705, bpp: 0
2025-03-03 07:07:36 - INFO - layer2_self_attn.v_proj | mse: 0.0026160996935641763, bpp_loss: 4.213106438925024, bpp: 0
2025-03-03 07:07:45 - INFO - layer2_self_attn.o_proj | mse: 0.002501027170985842, bpp_loss: 4.325494557269849, bpp: 0
2025-03-03 07:07:56 - INFO - layer2_mlp.gate_proj | mse: 0.0024262717034566356, bpp_loss: 4.734748426492193, bpp: 0
2025-03-03 07:08:08 - INFO - layer2_mlp.up_proj | mse: 0.002405803683839711, bpp_loss: 4.58188971591049, bpp: 0
2025-03-03 07:08:46 - INFO - layer2_mlp.down_proj | mse: 0.0023256423090093183, bpp_loss: 4.587508398407538, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:49<46:40, 96.56s/it]2025-03-03 07:08:56 - INFO - layer3_self_attn.q_proj | mse: 0.0025628053363248573, bpp_loss: 5.3200917757931165, bpp: 0
2025-03-03 07:09:04 - INFO - layer3_self_attn.k_proj | mse: 0.0027365985579403933, bpp_loss: 6.366047368850559, bpp: 0
2025-03-03 07:09:13 - INFO - layer3_self_attn.v_proj | mse: 0.002411644897653421, bpp_loss: 4.308831785689108, bpp: 0
2025-03-03 07:09:22 - INFO - layer3_self_attn.o_proj | mse: 0.0025845313449446954, bpp_loss: 4.418645583558828, bpp: 0
2025-03-03 07:09:33 - INFO - layer3_mlp.gate_proj | mse: 0.002438772235212528, bpp_loss: 4.814640479827566, bpp: 0
2025-03-03 07:09:44 - INFO - layer3_mlp.up_proj | mse: 0.002404746884096671, bpp_loss: 4.563296876515129, bpp: 0
2025-03-03 07:10:23 - INFO - layer3_mlp.down_proj | mse: 0.002298180414766334, bpp_loss: 4.562720118157033, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [06:25<45:03, 96.56s/it]2025-03-03 07:10:32 - INFO - layer4_self_attn.q_proj | mse: 0.0025677408104723656, bpp_loss: 5.284973063331563, bpp: 0
2025-03-03 07:10:41 - INFO - layer4_self_attn.k_proj | mse: 0.0027621848757841245, bpp_loss: 6.331790600728709, bpp: 0
2025-03-03 07:10:49 - INFO - layer4_self_attn.v_proj | mse: 0.0024189403751041292, bpp_loss: 4.354017980571371, bpp: 0
2025-03-03 07:10:58 - INFO - layer4_self_attn.o_proj | mse: 0.002688937499977517, bpp_loss: 4.4312707032077014, bpp: 0
2025-03-03 07:11:09 - INFO - layer4_mlp.gate_proj | mse: 0.0024286716962938757, bpp_loss: 4.8926425113209655, bpp: 0
2025-03-03 07:11:21 - INFO - layer4_mlp.up_proj | mse: 0.002379879912269533, bpp_loss: 4.536973714628922, bpp: 0
2025-03-03 07:11:59 - INFO - layer4_mlp.down_proj | mse: 0.0023491048359850723, bpp_loss: 4.538021689048037, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [08:02<43:27, 96.59s/it]2025-03-03 07:12:08 - INFO - layer5_self_attn.q_proj | mse: 0.0025944720033265417, bpp_loss: 5.257011516601779, bpp: 0
2025-03-03 07:12:17 - INFO - layer5_self_attn.k_proj | mse: 0.002814949798493863, bpp_loss: 6.297587681910954, bpp: 0
2025-03-03 07:12:26 - INFO - layer5_self_attn.v_proj | mse: 0.0024337984011174245, bpp_loss: 4.2427415997954085, bpp: 0
2025-03-03 07:12:35 - INFO - layer5_self_attn.o_proj | mse: 0.0027870282832739334, bpp_loss: 4.3769086910178885, bpp: 0
2025-03-03 07:12:46 - INFO - layer5_mlp.gate_proj | mse: 0.0024083009345346428, bpp_loss: 4.893232152065528, bpp: 0
2025-03-03 07:12:57 - INFO - layer5_mlp.up_proj | mse: 0.0023605570521940196, bpp_loss: 4.54198227283944, bpp: 0
2025-03-03 07:13:35 - INFO - layer5_mlp.down_proj | mse: 0.0023591366736085036, bpp_loss: 4.543025783861855, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [09:38<41:46, 96.41s/it]2025-03-03 07:13:45 - INFO - layer6_self_attn.q_proj | mse: 0.0025374078694436267, bpp_loss: 5.304947284632362, bpp: 0
2025-03-03 07:13:53 - INFO - layer6_self_attn.k_proj | mse: 0.002722221259928479, bpp_loss: 6.359500874881633, bpp: 0
2025-03-03 07:14:02 - INFO - layer6_self_attn.v_proj | mse: 0.002389827451127482, bpp_loss: 4.287702856527176, bpp: 0
2025-03-03 07:14:11 - INFO - layer6_self_attn.o_proj | mse: 0.0027883790293719746, bpp_loss: 4.407956411596388, bpp: 0
2025-03-03 07:14:22 - INFO - layer6_mlp.gate_proj | mse: 0.0024075085933918773, bpp_loss: 4.900434454503868, bpp: 0
2025-03-03 07:14:33 - INFO - layer6_mlp.up_proj | mse: 0.0023588105493878198, bpp_loss: 4.541036245612694, bpp: 0
2025-03-03 07:15:11 - INFO - layer6_mlp.down_proj | mse: 0.0023826904574251974, bpp_loss: 4.542989013683317, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [11:14<40:08, 96.33s/it]2025-03-03 07:15:21 - INFO - layer7_self_attn.q_proj | mse: 0.0025433506090795275, bpp_loss: 5.221301750978455, bpp: 0
2025-03-03 07:15:30 - INFO - layer7_self_attn.k_proj | mse: 0.0027278989201692675, bpp_loss: 6.388923643738963, bpp: 0
2025-03-03 07:15:38 - INFO - layer7_self_attn.v_proj | mse: 0.002404882476035505, bpp_loss: 4.285559448529966, bpp: 0
2025-03-03 07:15:47 - INFO - layer7_self_attn.o_proj | mse: 0.0028550383493103197, bpp_loss: 4.42030225310009, bpp: 0
2025-03-03 07:15:58 - INFO - layer7_mlp.gate_proj | mse: 0.002406853240976328, bpp_loss: 4.871409278096897, bpp: 0
2025-03-03 07:16:10 - INFO - layer7_mlp.up_proj | mse: 0.002363224814537329, bpp_loss: 4.554870955978653, bpp: 0
2025-03-03 07:16:48 - INFO - layer7_mlp.down_proj | mse: 0.002380346543054839, bpp_loss: 4.557387446053326, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [12:51<38:36, 96.53s/it]2025-03-03 07:16:58 - INFO - layer8_self_attn.q_proj | mse: 0.002543673991456351, bpp_loss: 5.207215299829841, bpp: 0
2025-03-03 07:17:07 - INFO - layer8_self_attn.k_proj | mse: 0.0027607761888346926, bpp_loss: 6.288801995455287, bpp: 0
2025-03-03 07:17:15 - INFO - layer8_self_attn.v_proj | mse: 0.0024057651686934076, bpp_loss: 4.308137892163359, bpp: 0
2025-03-03 07:17:24 - INFO - layer8_self_attn.o_proj | mse: 0.003010754025292014, bpp_loss: 4.432180633302778, bpp: 0
2025-03-03 07:17:35 - INFO - layer8_mlp.gate_proj | mse: 0.002395727148988064, bpp_loss: 4.878161400157426, bpp: 0
2025-03-03 07:17:46 - INFO - layer8_mlp.up_proj | mse: 0.0023505523226117746, bpp_loss: 4.5502291373642425, bpp: 0
2025-03-03 07:18:25 - INFO - layer8_mlp.down_proj | mse: 0.0023892572252038643, bpp_loss: 4.555549452779815, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [14:28<37:01, 96.60s/it]2025-03-03 07:18:35 - INFO - layer9_self_attn.q_proj | mse: 0.0025249971201409386, bpp_loss: 5.218909098999575, bpp: 0
2025-03-03 07:18:43 - INFO - layer9_self_attn.k_proj | mse: 0.002750364398904977, bpp_loss: 6.310602038982324, bpp: 0
2025-03-03 07:18:52 - INFO - layer9_self_attn.v_proj | mse: 0.002396153505708363, bpp_loss: 4.409926554886624, bpp: 0
2025-03-03 07:19:01 - INFO - layer9_self_attn.o_proj | mse: 0.0030147211629606586, bpp_loss: 4.489239328773692, bpp: 0
2025-03-03 07:19:12 - INFO - layer9_mlp.gate_proj | mse: 0.002396063619789353, bpp_loss: 4.895503649088953, bpp: 0
2025-03-03 07:19:23 - INFO - layer9_mlp.up_proj | mse: 0.0023504844490430023, bpp_loss: 4.560172650696976, bpp: 0
2025-03-03 07:20:02 - INFO - layer9_mlp.down_proj | mse: 0.0023996803705057944, bpp_loss: 4.558271738966661, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [16:05<35:25, 96.59s/it]2025-03-03 07:20:11 - INFO - layer10_self_attn.q_proj | mse: 0.0025387151599031254, bpp_loss: 5.225681584211998, bpp: 0
2025-03-03 07:20:20 - INFO - layer10_self_attn.k_proj | mse: 0.002781974935706877, bpp_loss: 6.315780959208496, bpp: 0
2025-03-03 07:20:28 - INFO - layer10_self_attn.v_proj | mse: 0.0023935803887111425, bpp_loss: 4.298787519452162, bpp: 0
2025-03-03 07:20:37 - INFO - layer10_self_attn.o_proj | mse: 0.0029008880314066, bpp_loss: 4.4244522949447855, bpp: 0
2025-03-03 07:20:48 - INFO - layer10_mlp.gate_proj | mse: 0.0023939582975677563, bpp_loss: 4.861152241272586, bpp: 0
2025-03-03 07:21:00 - INFO - layer10_mlp.up_proj | mse: 0.0023551712431256594, bpp_loss: 4.5767088875041475, bpp: 0
2025-03-03 07:21:38 - INFO - layer10_mlp.down_proj | mse: 0.0023918687021486796, bpp_loss: 4.573902966188533, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [17:41<33:46, 96.50s/it]2025-03-03 07:21:47 - INFO - layer11_self_attn.q_proj | mse: 0.002504198889403991, bpp_loss: 5.152331328601576, bpp: 0
2025-03-03 07:21:56 - INFO - layer11_self_attn.k_proj | mse: 0.002719198920267821, bpp_loss: 6.308655888191424, bpp: 0
2025-03-03 07:22:04 - INFO - layer11_self_attn.v_proj | mse: 0.0023753981874144767, bpp_loss: 4.302654197905213, bpp: 0
2025-03-03 07:22:14 - INFO - layer11_self_attn.o_proj | mse: 0.002855363542338749, bpp_loss: 4.443877411424182, bpp: 0
2025-03-03 07:22:25 - INFO - layer11_mlp.gate_proj | mse: 0.0023892123210440368, bpp_loss: 4.841035020271582, bpp: 0
2025-03-03 07:22:36 - INFO - layer11_mlp.up_proj | mse: 0.0023533850094499343, bpp_loss: 4.582188980321267, bpp: 0
2025-03-03 07:23:14 - INFO - layer11_mlp.down_proj | mse: 0.002390445426520594, bpp_loss: 4.581766420310097, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [19:17<32:10, 96.50s/it]2025-03-03 07:23:24 - INFO - layer12_self_attn.q_proj | mse: 0.002516812974882028, bpp_loss: 5.211030537262559, bpp: 0
2025-03-03 07:23:32 - INFO - layer12_self_attn.k_proj | mse: 0.0026947125732747065, bpp_loss: 6.294812707463279, bpp: 0
2025-03-03 07:23:41 - INFO - layer12_self_attn.v_proj | mse: 0.0023913147203566123, bpp_loss: 4.41977393545676, bpp: 0
2025-03-03 07:23:50 - INFO - layer12_self_attn.o_proj | mse: 0.0028931902271690482, bpp_loss: 4.489901197492145, bpp: 0
2025-03-03 07:24:01 - INFO - layer12_mlp.gate_proj | mse: 0.002393704806342923, bpp_loss: 4.823558539551284, bpp: 0
2025-03-03 07:24:12 - INFO - layer12_mlp.up_proj | mse: 0.0023616181975009147, bpp_loss: 4.602646873399083, bpp: 0
2025-03-03 07:24:50 - INFO - layer12_mlp.down_proj | mse: 0.0024181295653149834, bpp_loss: 4.595059154189324, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [20:53<30:27, 96.18s/it]2025-03-03 07:24:59 - INFO - layer13_self_attn.q_proj | mse: 0.002559220789340551, bpp_loss: 5.188939478714019, bpp: 0
2025-03-03 07:25:08 - INFO - layer13_self_attn.k_proj | mse: 0.002865710510940971, bpp_loss: 6.330181411700323, bpp: 0
2025-03-03 07:25:16 - INFO - layer13_self_attn.v_proj | mse: 0.0024287254985130243, bpp_loss: 4.360472792293876, bpp: 0
2025-03-03 07:25:25 - INFO - layer13_self_attn.o_proj | mse: 0.0029426508917630816, bpp_loss: 4.471100555500016, bpp: 0
2025-03-03 07:25:36 - INFO - layer13_mlp.gate_proj | mse: 0.002420119833560248, bpp_loss: 4.827582036943308, bpp: 0
2025-03-03 07:25:48 - INFO - layer13_mlp.up_proj | mse: 0.0023876081871869676, bpp_loss: 4.605929938144982, bpp: 0
2025-03-03 07:26:27 - INFO - layer13_mlp.down_proj | mse: 0.002434015291313366, bpp_loss: 4.594773953281609, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [22:30<28:54, 96.35s/it]2025-03-03 07:26:36 - INFO - layer14_self_attn.q_proj | mse: 0.002559809975373128, bpp_loss: 5.153324342216365, bpp: 0
2025-03-03 07:26:45 - INFO - layer14_self_attn.k_proj | mse: 0.0028655622185744436, bpp_loss: 6.271077186218463, bpp: 0
2025-03-03 07:26:53 - INFO - layer14_self_attn.v_proj | mse: 0.002431426990709107, bpp_loss: 4.353433952666819, bpp: 0
2025-03-03 07:27:02 - INFO - layer14_self_attn.o_proj | mse: 0.0029326722096975105, bpp_loss: 4.463868180755526, bpp: 0
2025-03-03 07:27:13 - INFO - layer14_mlp.gate_proj | mse: 0.0024182698649479932, bpp_loss: 4.862990924423294, bpp: 0
2025-03-03 07:27:25 - INFO - layer14_mlp.up_proj | mse: 0.0023805222279935194, bpp_loss: 4.600352832781417, bpp: 0
2025-03-03 07:28:03 - INFO - layer14_mlp.down_proj | mse: 0.0024212496801623625, bpp_loss: 4.590548686583394, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [24:06<27:18, 96.36s/it]2025-03-03 07:28:12 - INFO - layer15_self_attn.q_proj | mse: 0.0025741392911174847, bpp_loss: 5.313608477823436, bpp: 0
2025-03-03 07:28:21 - INFO - layer15_self_attn.k_proj | mse: 0.0028082511118124767, bpp_loss: 6.313326781033538, bpp: 0
2025-03-03 07:28:30 - INFO - layer15_self_attn.v_proj | mse: 0.002419976792083377, bpp_loss: 4.416958783287555, bpp: 0
2025-03-03 07:28:39 - INFO - layer15_self_attn.o_proj | mse: 0.002748613860932341, bpp_loss: 4.49422187032178, bpp: 0
2025-03-03 07:28:50 - INFO - layer15_mlp.gate_proj | mse: 0.0024393965478862606, bpp_loss: 4.900917740272624, bpp: 0
2025-03-03 07:29:01 - INFO - layer15_mlp.up_proj | mse: 0.002394798853776143, bpp_loss: 4.5921587225581915, bpp: 0
2025-03-03 07:29:40 - INFO - layer15_mlp.down_proj | mse: 0.0024413458436723275, bpp_loss: 4.584626923049135, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [25:43<25:45, 96.58s/it]2025-03-03 07:29:49 - INFO - layer16_self_attn.q_proj | mse: 0.0026068447289455047, bpp_loss: 5.2778489463962615, bpp: 0
2025-03-03 07:29:58 - INFO - layer16_self_attn.k_proj | mse: 0.0029225711275833767, bpp_loss: 6.308224613661878, bpp: 0
2025-03-03 07:30:07 - INFO - layer16_self_attn.v_proj | mse: 0.002452404475955044, bpp_loss: 4.373526596697047, bpp: 0
2025-03-03 07:30:16 - INFO - layer16_self_attn.o_proj | mse: 0.0029293375326348257, bpp_loss: 4.474279230693355, bpp: 0
2025-03-03 07:30:27 - INFO - layer16_mlp.gate_proj | mse: 0.0024281570573745606, bpp_loss: 4.935957432591489, bpp: 0
2025-03-03 07:30:39 - INFO - layer16_mlp.up_proj | mse: 0.002378040290237884, bpp_loss: 4.5785409653160185, bpp: 0
2025-03-03 07:31:17 - INFO - layer16_mlp.down_proj | mse: 0.002393311636279916, bpp_loss: 4.57079605798104, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [27:20<24:10, 96.71s/it]2025-03-03 07:31:27 - INFO - layer17_self_attn.q_proj | mse: 0.002532130725338075, bpp_loss: 5.297194785787724, bpp: 0
2025-03-03 07:31:36 - INFO - layer17_self_attn.k_proj | mse: 0.0028284058369686684, bpp_loss: 6.3418042199919, bpp: 0
2025-03-03 07:31:44 - INFO - layer17_self_attn.v_proj | mse: 0.0023940214634423527, bpp_loss: 4.442802616977133, bpp: 0
2025-03-03 07:31:53 - INFO - layer17_self_attn.o_proj | mse: 0.00270120068117432, bpp_loss: 4.503548969281837, bpp: 0
2025-03-03 07:32:04 - INFO - layer17_mlp.gate_proj | mse: 0.0024347730748769097, bpp_loss: 4.9513855539262295, bpp: 0
2025-03-03 07:32:16 - INFO - layer17_mlp.up_proj | mse: 0.0023822105830167166, bpp_loss: 4.575434505540345, bpp: 0
2025-03-03 07:32:54 - INFO - layer17_mlp.down_proj | mse: 0.002397491447912905, bpp_loss: 4.56809476260761, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [28:57<22:34, 96.76s/it]2025-03-03 07:33:03 - INFO - layer18_self_attn.q_proj | mse: 0.002536117418044064, bpp_loss: 5.2863256657728925, bpp: 0
2025-03-03 07:33:12 - INFO - layer18_self_attn.k_proj | mse: 0.002815900209521828, bpp_loss: 6.432668297667988, bpp: 0
2025-03-03 07:33:21 - INFO - layer18_self_attn.v_proj | mse: 0.0023903844075614735, bpp_loss: 4.3683301220298745, bpp: 0
2025-03-03 07:33:30 - INFO - layer18_self_attn.o_proj | mse: 0.0026487191254409136, bpp_loss: 4.482206930522807, bpp: 0
2025-03-03 07:33:41 - INFO - layer18_mlp.gate_proj | mse: 0.002415815862959993, bpp_loss: 4.955886177186455, bpp: 0
2025-03-03 07:33:52 - INFO - layer18_mlp.up_proj | mse: 0.002362387569234736, bpp_loss: 4.570999591345234, bpp: 0
2025-03-03 07:34:31 - INFO - layer18_mlp.down_proj | mse: 0.0023499563595689005, bpp_loss: 4.566041030422119, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [30:34<20:57, 96.73s/it]2025-03-03 07:34:40 - INFO - layer19_self_attn.q_proj | mse: 0.0025071140384895765, bpp_loss: 5.290369878639467, bpp: 0
2025-03-03 07:34:49 - INFO - layer19_self_attn.k_proj | mse: 0.002742589098778691, bpp_loss: 6.3157113523921, bpp: 0
2025-03-03 07:34:57 - INFO - layer19_self_attn.v_proj | mse: 0.0023664367294211302, bpp_loss: 4.412720111315139, bpp: 0
2025-03-03 07:35:06 - INFO - layer19_self_attn.o_proj | mse: 0.0025980898663003978, bpp_loss: 4.495690009905957, bpp: 0
2025-03-03 07:35:17 - INFO - layer19_mlp.gate_proj | mse: 0.0023988874085681925, bpp_loss: 4.965945252549967, bpp: 0
2025-03-03 07:35:29 - INFO - layer19_mlp.up_proj | mse: 0.0023449208857198403, bpp_loss: 4.567182679793665, bpp: 0
2025-03-03 07:36:07 - INFO - layer19_mlp.down_proj | mse: 0.002327421093147007, bpp_loss: 4.563771310295643, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [32:10<19:19, 96.59s/it]2025-03-03 07:36:16 - INFO - layer20_self_attn.q_proj | mse: 0.002503367981382019, bpp_loss: 5.260492222732864, bpp: 0
2025-03-03 07:36:25 - INFO - layer20_self_attn.k_proj | mse: 0.002765549428598308, bpp_loss: 6.258041969384067, bpp: 0
2025-03-03 07:36:33 - INFO - layer20_self_attn.v_proj | mse: 0.002371212685162154, bpp_loss: 4.447309267357923, bpp: 0
2025-03-03 07:36:42 - INFO - layer20_self_attn.o_proj | mse: 0.0025882314115014617, bpp_loss: 4.484540680074133, bpp: 0
2025-03-03 07:36:54 - INFO - layer20_mlp.gate_proj | mse: 0.0023941333617116005, bpp_loss: 4.966779612004757, bpp: 0
2025-03-03 07:37:05 - INFO - layer20_mlp.up_proj | mse: 0.00234007868599649, bpp_loss: 4.570785090659878, bpp: 0
2025-03-03 07:37:43 - INFO - layer20_mlp.down_proj | mse: 0.00231758004646994, bpp_loss: 4.567716521975983, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [33:46<17:41, 96.54s/it]2025-03-03 07:37:53 - INFO - layer21_self_attn.q_proj | mse: 0.002494130217953604, bpp_loss: 5.255177905317396, bpp: 0
2025-03-03 07:38:01 - INFO - layer21_self_attn.k_proj | mse: 0.002736724941422489, bpp_loss: 6.30544383416418, bpp: 0
2025-03-03 07:38:10 - INFO - layer21_self_attn.v_proj | mse: 0.002368413779909671, bpp_loss: 4.472893823869526, bpp: 0
2025-03-03 07:38:19 - INFO - layer21_self_attn.o_proj | mse: 0.0027270004748423935, bpp_loss: 4.503847008920275, bpp: 0
2025-03-03 07:38:30 - INFO - layer21_mlp.gate_proj | mse: 0.002404859247962046, bpp_loss: 4.9788239178513845, bpp: 0
2025-03-03 07:38:41 - INFO - layer21_mlp.up_proj | mse: 0.0023489980592732236, bpp_loss: 4.573781259424452, bpp: 0
2025-03-03 07:39:19 - INFO - layer21_mlp.down_proj | mse: 0.0023397144863591783, bpp_loss: 4.569504898041487, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [35:22<16:04, 96.40s/it]2025-03-03 07:39:29 - INFO - layer22_self_attn.q_proj | mse: 0.002515841922425755, bpp_loss: 5.2112184803700075, bpp: 0
2025-03-03 07:39:38 - INFO - layer22_self_attn.k_proj | mse: 0.002776421667231417, bpp_loss: 6.232571870554239, bpp: 0
2025-03-03 07:39:46 - INFO - layer22_self_attn.v_proj | mse: 0.0023974276612434725, bpp_loss: 4.523186001577415, bpp: 0
2025-03-03 07:39:55 - INFO - layer22_self_attn.o_proj | mse: 0.002622706037013659, bpp_loss: 4.529419862898067, bpp: 0
2025-03-03 07:40:06 - INFO - layer22_mlp.gate_proj | mse: 0.002406684591712459, bpp_loss: 4.980837071846638, bpp: 0
2025-03-03 07:40:17 - INFO - layer22_mlp.up_proj | mse: 0.0023518845483305323, bpp_loss: 4.57780685754759, bpp: 0
2025-03-03 07:40:56 - INFO - layer22_mlp.down_proj | mse: 0.002326184676764656, bpp_loss: 4.574730974688594, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [36:59<14:27, 96.35s/it]2025-03-03 07:41:05 - INFO - layer23_self_attn.q_proj | mse: 0.002494666714024448, bpp_loss: 5.223059885203838, bpp: 0
2025-03-03 07:41:14 - INFO - layer23_self_attn.k_proj | mse: 0.0027340127663819306, bpp_loss: 6.233344958629459, bpp: 0
2025-03-03 07:41:22 - INFO - layer23_self_attn.v_proj | mse: 0.002386865044034981, bpp_loss: 4.5758284671464935, bpp: 0
2025-03-03 07:41:31 - INFO - layer23_self_attn.o_proj | mse: 0.002484741989376734, bpp_loss: 4.551758446148597, bpp: 0
2025-03-03 07:41:42 - INFO - layer23_mlp.gate_proj | mse: 0.0024080253016273137, bpp_loss: 4.98315888822877, bpp: 0
2025-03-03 07:41:54 - INFO - layer23_mlp.up_proj | mse: 0.0023532103591693146, bpp_loss: 4.581785788626543, bpp: 0
2025-03-03 07:42:32 - INFO - layer23_mlp.down_proj | mse: 0.0022965874552163187, bpp_loss: 4.579716858154695, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [38:35<12:50, 96.30s/it]2025-03-03 07:42:41 - INFO - layer24_self_attn.q_proj | mse: 0.00248949422558172, bpp_loss: 5.188515888643451, bpp: 0
2025-03-03 07:42:50 - INFO - layer24_self_attn.k_proj | mse: 0.0027152115033011897, bpp_loss: 6.04405906307511, bpp: 0
2025-03-03 07:42:58 - INFO - layer24_self_attn.v_proj | mse: 0.0023999555119505445, bpp_loss: 4.6753230665344745, bpp: 0
2025-03-03 07:43:07 - INFO - layer24_self_attn.o_proj | mse: 0.0025757127473630586, bpp_loss: 4.593031404423527, bpp: 0
2025-03-03 07:43:18 - INFO - layer24_mlp.gate_proj | mse: 0.0023961670855954078, bpp_loss: 4.989577035951827, bpp: 0
2025-03-03 07:43:29 - INFO - layer24_mlp.up_proj | mse: 0.0023406516796304197, bpp_loss: 4.586676851979324, bpp: 0
2025-03-03 07:44:08 - INFO - layer24_mlp.down_proj | mse: 0.002270295759239811, bpp_loss: 4.584791700621801, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [40:11<11:13, 96.23s/it]2025-03-03 07:44:17 - INFO - layer25_self_attn.q_proj | mse: 0.0024612668913055447, bpp_loss: 5.16454213578254, bpp: 0
2025-03-03 07:44:26 - INFO - layer25_self_attn.k_proj | mse: 0.0026519205385454004, bpp_loss: 6.024730857345276, bpp: 0
2025-03-03 07:44:34 - INFO - layer25_self_attn.v_proj | mse: 0.002378399342451345, bpp_loss: 4.685626304068137, bpp: 0
2025-03-03 07:44:43 - INFO - layer25_self_attn.o_proj | mse: 0.002563666482228649, bpp_loss: 4.595642380183563, bpp: 0
2025-03-03 07:44:55 - INFO - layer25_mlp.gate_proj | mse: 0.002385486517368014, bpp_loss: 5.000158838794699, bpp: 0
2025-03-03 07:45:06 - INFO - layer25_mlp.up_proj | mse: 0.0023310345329576546, bpp_loss: 4.596015352489693, bpp: 0
2025-03-03 07:45:44 - INFO - layer25_mlp.down_proj | mse: 0.0022550407607951363, bpp_loss: 4.593643187445456, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [41:47<09:37, 96.18s/it]2025-03-03 07:45:53 - INFO - layer26_self_attn.q_proj | mse: 0.0024660549784123287, bpp_loss: 5.17503442405723, bpp: 0
2025-03-03 07:46:02 - INFO - layer26_self_attn.k_proj | mse: 0.002708072285084075, bpp_loss: 6.116690436261706, bpp: 0
2025-03-03 07:46:10 - INFO - layer26_self_attn.v_proj | mse: 0.0023888486128693033, bpp_loss: 4.738732268335298, bpp: 0
2025-03-03 07:46:19 - INFO - layer26_self_attn.o_proj | mse: 0.0028047581837994315, bpp_loss: 4.619204607792199, bpp: 0
2025-03-03 07:46:31 - INFO - layer26_mlp.gate_proj | mse: 0.002378349239134763, bpp_loss: 5.009897414594889, bpp: 0
2025-03-03 07:46:42 - INFO - layer26_mlp.up_proj | mse: 0.0023231744426033063, bpp_loss: 4.605279804273907, bpp: 0
2025-03-03 07:47:20 - INFO - layer26_mlp.down_proj | mse: 0.0022472392320870152, bpp_loss: 4.601652429106513, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [43:23<08:00, 96.14s/it]2025-03-03 07:47:29 - INFO - layer27_self_attn.q_proj | mse: 0.0024381573637935975, bpp_loss: 5.142541532637551, bpp: 0
2025-03-03 07:47:38 - INFO - layer27_self_attn.k_proj | mse: 0.0026626622291977204, bpp_loss: 6.068820709420834, bpp: 0
2025-03-03 07:47:46 - INFO - layer27_self_attn.v_proj | mse: 0.002381809704751159, bpp_loss: 4.833793513302226, bpp: 0
2025-03-03 07:47:55 - INFO - layer27_self_attn.o_proj | mse: 0.002563743253856741, bpp_loss: 4.651573128183372, bpp: 0
2025-03-03 07:48:07 - INFO - layer27_mlp.gate_proj | mse: 0.0023671765875337746, bpp_loss: 5.023853896185756, bpp: 0
2025-03-03 07:48:18 - INFO - layer27_mlp.up_proj | mse: 0.0023123337093081406, bpp_loss: 4.620748007803091, bpp: 0
2025-03-03 07:48:56 - INFO - layer27_mlp.down_proj | mse: 0.002254338021040414, bpp_loss: 4.612476021217715, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [44:59<06:24, 96.03s/it]2025-03-03 07:49:05 - INFO - layer28_self_attn.q_proj | mse: 0.002429849188899679, bpp_loss: 5.151906851213425, bpp: 0
2025-03-03 07:49:14 - INFO - layer28_self_attn.k_proj | mse: 0.0026033436530002326, bpp_loss: 6.005997627042234, bpp: 0
2025-03-03 07:49:22 - INFO - layer28_self_attn.v_proj | mse: 0.002381132158920211, bpp_loss: 4.887976405152585, bpp: 0
2025-03-03 07:49:31 - INFO - layer28_self_attn.o_proj | mse: 0.0026240473677233496, bpp_loss: 4.6822453930508345, bpp: 0
2025-03-03 07:49:42 - INFO - layer28_mlp.gate_proj | mse: 0.0023680196269215063, bpp_loss: 5.012236171801176, bpp: 0
2025-03-03 07:49:54 - INFO - layer28_mlp.up_proj | mse: 0.0023185019268018854, bpp_loss: 4.643763316329569, bpp: 0
2025-03-03 07:50:32 - INFO - layer28_mlp.down_proj | mse: 0.0022713237954887686, bpp_loss: 4.628512685686084, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [46:35<04:48, 96.00s/it]2025-03-03 07:50:41 - INFO - layer29_self_attn.q_proj | mse: 0.0024174578135691747, bpp_loss: 5.137882723938674, bpp: 0
2025-03-03 07:50:50 - INFO - layer29_self_attn.k_proj | mse: 0.00260226015907923, bpp_loss: 6.1075358526431955, bpp: 0
2025-03-03 07:50:58 - INFO - layer29_self_attn.v_proj | mse: 0.0023870287269401593, bpp_loss: 4.957614230341278, bpp: 0
2025-03-03 07:51:07 - INFO - layer29_self_attn.o_proj | mse: 0.002716662559498201, bpp_loss: 4.718447944498621, bpp: 0
2025-03-03 07:51:18 - INFO - layer29_mlp.gate_proj | mse: 0.0023810710106288327, bpp_loss: 5.0065209325402975, bpp: 0
2025-03-03 07:51:29 - INFO - layer29_mlp.up_proj | mse: 0.002336893387691296, bpp_loss: 4.67774297955579, bpp: 0
2025-03-03 07:52:07 - INFO - layer29_mlp.down_proj | mse: 0.0022912254432833506, bpp_loss: 4.64436059208986, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [48:10<03:11, 95.92s/it]2025-03-03 07:52:17 - INFO - layer30_self_attn.q_proj | mse: 0.0024584636404892074, bpp_loss: 5.043449603021145, bpp: 0
2025-03-03 07:52:26 - INFO - layer30_self_attn.k_proj | mse: 0.0026867344801685534, bpp_loss: 5.732494386495091, bpp: 0
2025-03-03 07:52:34 - INFO - layer30_self_attn.v_proj | mse: 0.002473150922056061, bpp_loss: 5.261795395519584, bpp: 0
2025-03-03 07:52:43 - INFO - layer30_self_attn.o_proj | mse: 0.00283100973504319, bpp_loss: 4.808227015775628, bpp: 0
2025-03-03 07:52:54 - INFO - layer30_mlp.gate_proj | mse: 0.0023997054092308595, bpp_loss: 5.0641512745725255, bpp: 0
2025-03-03 07:53:05 - INFO - layer30_mlp.up_proj | mse: 0.0023517343159801408, bpp_loss: 4.7108755160921385, bpp: 0
2025-03-03 07:53:44 - INFO - layer30_mlp.down_proj | mse: 0.0023960565841145416, bpp_loss: 4.645852939824441, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [49:46<01:35, 95.98s/it]2025-03-03 07:53:53 - INFO - layer31_self_attn.q_proj | mse: 0.0025131578124850894, bpp_loss: 5.204904278041795, bpp: 0
2025-03-03 07:54:02 - INFO - layer31_self_attn.k_proj | mse: 0.0026860429923202395, bpp_loss: 5.991911805118434, bpp: 0
2025-03-03 07:54:10 - INFO - layer31_self_attn.v_proj | mse: 0.0024791028960151522, bpp_loss: 5.065266768448055, bpp: 0
2025-03-03 07:54:19 - INFO - layer31_self_attn.o_proj | mse: 0.002948060394501029, bpp_loss: 4.773244885378517, bpp: 0
2025-03-03 07:54:31 - INFO - layer31_mlp.gate_proj | mse: 0.002557599816423546, bpp_loss: 5.299341681546399, bpp: 0
2025-03-03 07:54:42 - INFO - layer31_mlp.up_proj | mse: 0.0025024113624056905, bpp_loss: 4.914231247002525, bpp: 0
2025-03-03 07:55:20 - INFO - layer31_mlp.down_proj | mse: 0.002913179924364583, bpp_loss: 4.673692574425202, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [51:23<00:00, 96.21s/it]pseudo compress quantization...: 100%|██████████| 32/32 [51:23<00:00, 96.37s/it]
2025-03-03 07:55:20 - INFO - #### Total | mse: 0.0024706061103094597, bpp_loss: 4.75138586742042, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda1000_rdloss_ql_encdim512_M16_batch_size2048_total_iter1500000_lr0.0001_seed100/best_loss_model_loss_6.59649_bpp_6.05166_MSE_0.00106_total_iter_140000.pth.tar/COL_MSE0.00247_bpploss4.7514_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda1000_rdloss_ql_encdim512_M16_batch_size2048_total_iter1500000_lr0.0001_seed100/best_loss_model_loss_6.59649_bpp_6.05166_MSE_0.00106_total_iter_140000.pth.tar/COL_MSE0.00247_bpploss4.7514_bpp0
I0303 07:55:55.880640 3086042 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.66it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.63it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.45it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s]
I0303 07:55:58.277107 3086042 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.546875:   0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.546875:   1%|          | 1/141 [00:00<01:12,  1.93it/s]avg_loss = 1.8515625:   1%|          | 1/141 [00:00<01:12,  1.93it/s]avg_loss = 1.8515625:   1%|▏         | 2/141 [00:00<01:03,  2.18it/s]avg_loss = 1.9895833333333333:   1%|▏         | 2/141 [00:01<01:03,  2.18it/s]avg_loss = 1.9895833333333333:   2%|▏         | 3/141 [00:01<01:00,  2.27it/s]avg_loss = 1.947265625:   2%|▏         | 3/141 [00:01<01:00,  2.27it/s]       avg_loss = 1.947265625:   3%|▎         | 4/141 [00:01<00:59,  2.31it/s]avg_loss = 1.8984375:   3%|▎         | 4/141 [00:02<00:59,  2.31it/s]  avg_loss = 1.8984375:   4%|▎         | 5/141 [00:02<00:58,  2.34it/s]avg_loss = 1.80078125:   4%|▎         | 5/141 [00:02<00:58,  2.34it/s]avg_loss = 1.80078125:   4%|▍         | 6/141 [00:02<00:57,  2.35it/s]avg_loss = 1.7388392857142858:   4%|▍         | 6/141 [00:03<00:57,  2.35it/s]avg_loss = 1.7388392857142858:   5%|▍         | 7/141 [00:03<00:56,  2.36it/s]avg_loss = 1.7373046875:   5%|▍         | 7/141 [00:03<00:56,  2.36it/s]      avg_loss = 1.7373046875:   6%|▌         | 8/141 [00:03<00:56,  2.36it/s]avg_loss = 1.7717013888888888:   6%|▌         | 8/141 [00:03<00:56,  2.36it/s]avg_loss = 1.7717013888888888:   6%|▋         | 9/141 [00:03<00:55,  2.37it/s]avg_loss = 1.7765625:   6%|▋         | 9/141 [00:04<00:55,  2.37it/s]         avg_loss = 1.7765625:   7%|▋         | 10/141 [00:04<00:55,  2.37it/s]avg_loss = 1.7734375:   7%|▋         | 10/141 [00:04<00:55,  2.37it/s]avg_loss = 1.7734375:   8%|▊         | 11/141 [00:04<00:54,  2.37it/s]avg_loss = 1.7962239583333333:   8%|▊         | 11/141 [00:05<00:54,  2.37it/s]avg_loss = 1.7962239583333333:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.8088942307692308:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.8088942307692308:   9%|▉         | 13/141 [00:05<00:53,  2.37it/s]avg_loss = 1.8270089285714286:   9%|▉         | 13/141 [00:05<00:53,  2.37it/s]avg_loss = 1.8270089285714286:  10%|▉         | 14/141 [00:05<00:53,  2.37it/s]avg_loss = 1.8375:  10%|▉         | 14/141 [00:06<00:53,  2.37it/s]            avg_loss = 1.8375:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.8623046875:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.8623046875:  11%|█▏        | 16/141 [00:06<00:52,  2.37it/s]avg_loss = 1.8658088235294117:  11%|█▏        | 16/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8658088235294117:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8676215277777777:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8676215277777777:  13%|█▎        | 18/141 [00:07<00:52,  2.36it/s]avg_loss = 1.847861842105263:  13%|█▎        | 18/141 [00:08<00:52,  2.36it/s] avg_loss = 1.847861842105263:  13%|█▎        | 19/141 [00:08<00:51,  2.36it/s]avg_loss = 1.846484375:  13%|█▎        | 19/141 [00:08<00:51,  2.36it/s]      avg_loss = 1.846484375:  14%|█▍        | 20/141 [00:08<00:51,  2.37it/s]avg_loss = 1.8519345238095237:  14%|█▍        | 20/141 [00:08<00:51,  2.37it/s]avg_loss = 1.8519345238095237:  15%|█▍        | 21/141 [00:08<00:50,  2.37it/s]avg_loss = 1.8547585227272727:  15%|█▍        | 21/141 [00:09<00:50,  2.37it/s]avg_loss = 1.8547585227272727:  16%|█▌        | 22/141 [00:09<00:50,  2.38it/s]avg_loss = 1.8569972826086956:  16%|█▌        | 22/141 [00:09<00:50,  2.38it/s]avg_loss = 1.8569972826086956:  16%|█▋        | 23/141 [00:09<00:49,  2.38it/s]avg_loss = 1.8619791666666667:  16%|█▋        | 23/141 [00:10<00:49,  2.38it/s]avg_loss = 1.8619791666666667:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]avg_loss = 1.868125:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]          avg_loss = 1.868125:  18%|█▊        | 25/141 [00:10<00:48,  2.38it/s]avg_loss = 1.8798076923076923:  18%|█▊        | 25/141 [00:11<00:48,  2.38it/s]avg_loss = 1.8798076923076923:  18%|█▊        | 26/141 [00:11<00:48,  2.38it/s]avg_loss = 1.8929398148148149:  18%|█▊        | 26/141 [00:11<00:48,  2.38it/s]avg_loss = 1.8929398148148149:  19%|█▉        | 27/141 [00:11<00:47,  2.38it/s]avg_loss = 1.9001116071428572:  19%|█▉        | 27/141 [00:11<00:47,  2.38it/s]avg_loss = 1.9001116071428572:  20%|█▉        | 28/141 [00:11<00:47,  2.38it/s]avg_loss = 1.896551724137931:  20%|█▉        | 28/141 [00:12<00:47,  2.38it/s] avg_loss = 1.896551724137931:  21%|██        | 29/141 [00:12<00:47,  2.37it/s]avg_loss = 1.8869791666666667:  21%|██        | 29/141 [00:12<00:47,  2.37it/s]avg_loss = 1.8869791666666667:  21%|██▏       | 30/141 [00:12<00:46,  2.38it/s]avg_loss = 1.8727318548387097:  21%|██▏       | 30/141 [00:13<00:46,  2.38it/s]avg_loss = 1.8727318548387097:  22%|██▏       | 31/141 [00:13<00:46,  2.37it/s]avg_loss = 1.860595703125:  22%|██▏       | 31/141 [00:13<00:46,  2.37it/s]    avg_loss = 1.860595703125:  23%|██▎       | 32/141 [00:13<00:45,  2.37it/s]avg_loss = 1.8596117424242424:  23%|██▎       | 32/141 [00:13<00:45,  2.37it/s]avg_loss = 1.8596117424242424:  23%|██▎       | 33/141 [00:13<00:45,  2.37it/s]avg_loss = 1.8582261029411764:  23%|██▎       | 33/141 [00:14<00:45,  2.37it/s]avg_loss = 1.8582261029411764:  24%|██▍       | 34/141 [00:14<00:45,  2.37it/s]avg_loss = 1.8613839285714286:  24%|██▍       | 34/141 [00:14<00:45,  2.37it/s]avg_loss = 1.8613839285714286:  25%|██▍       | 35/141 [00:14<00:44,  2.37it/s]avg_loss = 1.8448350694444444:  25%|██▍       | 35/141 [00:15<00:44,  2.37it/s]avg_loss = 1.8448350694444444:  26%|██▌       | 36/141 [00:15<00:44,  2.37it/s]avg_loss = 1.8293918918918919:  26%|██▌       | 36/141 [00:15<00:44,  2.37it/s]avg_loss = 1.8293918918918919:  26%|██▌       | 37/141 [00:15<00:43,  2.37it/s]avg_loss = 1.8147615131578947:  26%|██▌       | 37/141 [00:16<00:43,  2.37it/s]avg_loss = 1.8147615131578947:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 1.8006810897435896:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 1.8006810897435896:  28%|██▊       | 39/141 [00:16<00:43,  2.37it/s]avg_loss = 1.7923828125:  28%|██▊       | 39/141 [00:16<00:43,  2.37it/s]      avg_loss = 1.7923828125:  28%|██▊       | 40/141 [00:16<00:42,  2.36it/s]avg_loss = 1.7970655487804879:  28%|██▊       | 40/141 [00:17<00:42,  2.36it/s]avg_loss = 1.7970655487804879:  29%|██▉       | 41/141 [00:17<00:42,  2.36it/s]avg_loss = 1.8141741071428572:  29%|██▉       | 41/141 [00:17<00:42,  2.36it/s]avg_loss = 1.8141741071428572:  30%|██▉       | 42/141 [00:17<00:41,  2.36it/s]avg_loss = 1.830486918604651:  30%|██▉       | 42/141 [00:18<00:41,  2.36it/s] avg_loss = 1.830486918604651:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8330965909090908:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8330965909090908:  31%|███       | 44/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8371527777777779:  31%|███       | 44/141 [00:19<00:41,  2.36it/s]avg_loss = 1.8371527777777779:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8427309782608696:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8427309782608696:  33%|███▎      | 46/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8494015957446808:  33%|███▎      | 46/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8494015957446808:  33%|███▎      | 47/141 [00:19<00:39,  2.36it/s]avg_loss = 1.8528645833333333:  33%|███▎      | 47/141 [00:20<00:39,  2.36it/s]avg_loss = 1.8528645833333333:  34%|███▍      | 48/141 [00:20<00:39,  2.36it/s]avg_loss = 1.8515625:  34%|███▍      | 48/141 [00:20<00:39,  2.36it/s]         avg_loss = 1.8515625:  35%|███▍      | 49/141 [00:20<00:39,  2.36it/s]avg_loss = 1.85140625:  35%|███▍      | 49/141 [00:21<00:39,  2.36it/s]avg_loss = 1.85140625:  35%|███▌      | 50/141 [00:21<00:38,  2.36it/s]avg_loss = 1.8451286764705883:  35%|███▌      | 50/141 [00:21<00:38,  2.36it/s]avg_loss = 1.8451286764705883:  36%|███▌      | 51/141 [00:21<00:38,  2.36it/s]avg_loss = 1.8414963942307692:  36%|███▌      | 51/141 [00:22<00:38,  2.36it/s]avg_loss = 1.8414963942307692:  37%|███▋      | 52/141 [00:22<00:37,  2.36it/s]avg_loss = 1.8350530660377358:  37%|███▋      | 52/141 [00:22<00:37,  2.36it/s]avg_loss = 1.8350530660377358:  38%|███▊      | 53/141 [00:22<00:37,  2.36it/s]avg_loss = 1.83203125:  38%|███▊      | 53/141 [00:22<00:37,  2.36it/s]        avg_loss = 1.83203125:  38%|███▊      | 54/141 [00:22<00:36,  2.36it/s]avg_loss = 1.8242897727272727:  38%|███▊      | 54/141 [00:23<00:36,  2.36it/s]avg_loss = 1.8242897727272727:  39%|███▉      | 55/141 [00:23<00:36,  2.36it/s]avg_loss = 1.8166852678571428:  39%|███▉      | 55/141 [00:23<00:36,  2.36it/s]avg_loss = 1.8166852678571428:  40%|███▉      | 56/141 [00:23<00:36,  2.36it/s]avg_loss = 1.8101699561403508:  40%|███▉      | 56/141 [00:24<00:36,  2.36it/s]avg_loss = 1.8101699561403508:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.8072467672413792:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.8072467672413792:  41%|████      | 58/141 [00:24<00:35,  2.35it/s]avg_loss = 1.8093220338983051:  41%|████      | 58/141 [00:25<00:35,  2.35it/s]avg_loss = 1.8093220338983051:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8153645833333334:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8153645833333334:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8214651639344261:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8214651639344261:  43%|████▎     | 61/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8288810483870968:  43%|████▎     | 61/141 [00:26<00:34,  2.35it/s]avg_loss = 1.8288810483870968:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8195684523809523:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8195684523809523:  45%|████▍     | 63/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8175048828125:  45%|████▍     | 63/141 [00:27<00:33,  2.35it/s]   avg_loss = 1.8175048828125:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 1.8149038461538463:  45%|████▌     | 64/141 [00:27<00:32,  2.35it/s]avg_loss = 1.8149038461538463:  46%|████▌     | 65/141 [00:27<00:32,  2.35it/s]avg_loss = 1.8088304924242424:  46%|████▌     | 65/141 [00:27<00:32,  2.35it/s]avg_loss = 1.8088304924242424:  47%|████▋     | 66/141 [00:27<00:31,  2.35it/s]avg_loss = 1.8062033582089552:  47%|████▋     | 66/141 [00:28<00:31,  2.35it/s]avg_loss = 1.8062033582089552:  48%|████▊     | 67/141 [00:28<00:31,  2.35it/s]avg_loss = 1.8028492647058822:  48%|████▊     | 67/141 [00:28<00:31,  2.35it/s]avg_loss = 1.8028492647058822:  48%|████▊     | 68/141 [00:28<00:31,  2.35it/s]avg_loss = 1.7999320652173914:  48%|████▊     | 68/141 [00:29<00:31,  2.35it/s]avg_loss = 1.7999320652173914:  49%|████▉     | 69/141 [00:29<00:30,  2.35it/s]avg_loss = 1.80078125:  49%|████▉     | 69/141 [00:29<00:30,  2.35it/s]        avg_loss = 1.80078125:  50%|████▉     | 70/141 [00:29<00:30,  2.35it/s]avg_loss = 1.8044674295774648:  50%|████▉     | 70/141 [00:30<00:30,  2.35it/s]avg_loss = 1.8044674295774648:  50%|█████     | 71/141 [00:30<00:29,  2.35it/s]avg_loss = 1.8069661458333333:  50%|█████     | 71/141 [00:30<00:29,  2.35it/s]avg_loss = 1.8069661458333333:  51%|█████     | 72/141 [00:30<00:29,  2.35it/s]avg_loss = 1.8056506849315068:  51%|█████     | 72/141 [00:30<00:29,  2.35it/s]avg_loss = 1.8056506849315068:  52%|█████▏    | 73/141 [00:30<00:28,  2.35it/s]avg_loss = 1.8073268581081081:  52%|█████▏    | 73/141 [00:31<00:28,  2.35it/s]avg_loss = 1.8073268581081081:  52%|█████▏    | 74/141 [00:31<00:28,  2.34it/s]avg_loss = 1.8076041666666667:  52%|█████▏    | 74/141 [00:31<00:28,  2.34it/s]avg_loss = 1.8076041666666667:  53%|█████▎    | 75/141 [00:31<00:28,  2.34it/s]avg_loss = 1.806640625:  53%|█████▎    | 75/141 [00:32<00:28,  2.34it/s]       avg_loss = 1.806640625:  54%|█████▍    | 76/141 [00:32<00:27,  2.34it/s]avg_loss = 1.8078327922077921:  54%|█████▍    | 76/141 [00:32<00:27,  2.34it/s]avg_loss = 1.8078327922077921:  55%|█████▍    | 77/141 [00:32<00:27,  2.34it/s]avg_loss = 1.8102964743589745:  55%|█████▍    | 77/141 [00:33<00:27,  2.34it/s]avg_loss = 1.8102964743589745:  55%|█████▌    | 78/141 [00:33<00:26,  2.34it/s]avg_loss = 1.8146756329113924:  55%|█████▌    | 78/141 [00:33<00:26,  2.34it/s]avg_loss = 1.8146756329113924:  56%|█████▌    | 79/141 [00:33<00:26,  2.34it/s]avg_loss = 1.81201171875:  56%|█████▌    | 79/141 [00:33<00:26,  2.34it/s]     avg_loss = 1.81201171875:  57%|█████▋    | 80/141 [00:33<00:26,  2.34it/s]avg_loss = 1.8110532407407407:  57%|█████▋    | 80/141 [00:34<00:26,  2.34it/s]avg_loss = 1.8110532407407407:  57%|█████▋    | 81/141 [00:34<00:25,  2.34it/s]avg_loss = 1.810403963414634:  57%|█████▋    | 81/141 [00:34<00:25,  2.34it/s] avg_loss = 1.810403963414634:  58%|█████▊    | 82/141 [00:34<00:25,  2.34it/s]avg_loss = 1.8087349397590362:  58%|█████▊    | 82/141 [00:35<00:25,  2.34it/s]avg_loss = 1.8087349397590362:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]avg_loss = 1.806640625:  59%|█████▉    | 83/141 [00:35<00:24,  2.34it/s]       avg_loss = 1.806640625:  60%|█████▉    | 84/141 [00:35<00:24,  2.34it/s]avg_loss = 1.8043198529411764:  60%|█████▉    | 84/141 [00:36<00:24,  2.34it/s]avg_loss = 1.8043198529411764:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s]avg_loss = 1.806140988372093:  60%|██████    | 85/141 [00:36<00:23,  2.34it/s] avg_loss = 1.806140988372093:  61%|██████    | 86/141 [00:36<00:23,  2.34it/s]avg_loss = 1.8081896551724137:  61%|██████    | 86/141 [00:36<00:23,  2.34it/s]avg_loss = 1.8081896551724137:  62%|██████▏   | 87/141 [00:36<00:23,  2.34it/s]avg_loss = 1.8083274147727273:  62%|██████▏   | 87/141 [00:37<00:23,  2.34it/s]avg_loss = 1.8083274147727273:  62%|██████▏   | 88/141 [00:37<00:22,  2.34it/s]avg_loss = 1.8171523876404494:  62%|██████▏   | 88/141 [00:37<00:22,  2.34it/s]avg_loss = 1.8171523876404494:  63%|██████▎   | 89/141 [00:37<00:22,  2.34it/s]avg_loss = 1.8247395833333333:  63%|██████▎   | 89/141 [00:38<00:22,  2.34it/s]avg_loss = 1.8247395833333333:  64%|██████▍   | 90/141 [00:38<00:21,  2.34it/s]avg_loss = 1.8280391483516483:  64%|██████▍   | 90/141 [00:38<00:21,  2.34it/s]avg_loss = 1.8280391483516483:  65%|██████▍   | 91/141 [00:38<00:21,  2.34it/s]avg_loss = 1.8329653532608696:  65%|██████▍   | 91/141 [00:39<00:21,  2.34it/s]avg_loss = 1.8329653532608696:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]avg_loss = 1.837953629032258:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s] avg_loss = 1.837953629032258:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8390957446808511:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8390957446808511:  67%|██████▋   | 94/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8429276315789473:  67%|██████▋   | 94/141 [00:40<00:20,  2.35it/s]avg_loss = 1.8429276315789473:  67%|██████▋   | 95/141 [00:40<00:19,  2.35it/s]avg_loss = 1.84375:  67%|██████▋   | 95/141 [00:40<00:19,  2.35it/s]           avg_loss = 1.84375:  68%|██████▊   | 96/141 [00:40<00:19,  2.35it/s]avg_loss = 1.8456829896907216:  68%|██████▊   | 96/141 [00:41<00:19,  2.35it/s]avg_loss = 1.8456829896907216:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s]avg_loss = 1.8404017857142858:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s]avg_loss = 1.8404017857142858:  70%|██████▉   | 98/141 [00:41<00:18,  2.35it/s]avg_loss = 1.8410669191919191:  70%|██████▉   | 98/141 [00:42<00:18,  2.35it/s]avg_loss = 1.8410669191919191:  70%|███████   | 99/141 [00:42<00:17,  2.35it/s]avg_loss = 1.8428125:  70%|███████   | 99/141 [00:42<00:17,  2.35it/s]         avg_loss = 1.8428125:  71%|███████   | 100/141 [00:42<00:17,  2.35it/s]avg_loss = 1.841197400990099:  71%|███████   | 100/141 [00:42<00:17,  2.35it/s]avg_loss = 1.841197400990099:  72%|███████▏  | 101/141 [00:42<00:17,  2.34it/s]avg_loss = 1.8412224264705883:  72%|███████▏  | 101/141 [00:43<00:17,  2.34it/s]avg_loss = 1.8412224264705883:  72%|███████▏  | 102/141 [00:43<00:16,  2.35it/s]avg_loss = 1.8388956310679612:  72%|███████▏  | 102/141 [00:43<00:16,  2.35it/s]avg_loss = 1.8388956310679612:  73%|███████▎  | 103/141 [00:43<00:16,  2.35it/s]avg_loss = 1.8411959134615385:  73%|███████▎  | 103/141 [00:44<00:16,  2.35it/s]avg_loss = 1.8411959134615385:  74%|███████▍  | 104/141 [00:44<00:15,  2.35it/s]avg_loss = 1.8389136904761905:  74%|███████▍  | 104/141 [00:44<00:15,  2.35it/s]avg_loss = 1.8389136904761905:  74%|███████▍  | 105/141 [00:44<00:15,  2.35it/s]avg_loss = 1.8374115566037736:  74%|███████▍  | 105/141 [00:45<00:15,  2.35it/s]avg_loss = 1.8374115566037736:  75%|███████▌  | 106/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8349883177570094:  75%|███████▌  | 106/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8349883177570094:  76%|███████▌  | 107/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8325376157407407:  76%|███████▌  | 107/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8325376157407407:  77%|███████▋  | 108/141 [00:45<00:14,  2.35it/s]avg_loss = 1.8298451834862386:  77%|███████▋  | 108/141 [00:46<00:14,  2.35it/s]avg_loss = 1.8298451834862386:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8274147727272727:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8274147727272727:  78%|███████▊  | 110/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8296734234234233:  78%|███████▊  | 110/141 [00:47<00:13,  2.34it/s]avg_loss = 1.8296734234234233:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8294503348214286:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8294503348214286:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8306139380530972:  79%|███████▉  | 112/141 [00:48<00:12,  2.34it/s]avg_loss = 1.8306139380530972:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8316200657894737:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8316200657894737:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.831046195652174:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s] avg_loss = 1.831046195652174:  82%|████████▏ | 115/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8295393318965518:  82%|████████▏ | 115/141 [00:49<00:11,  2.34it/s]avg_loss = 1.8295393318965518:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8316639957264957:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8316639957264957:  83%|████████▎ | 117/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8313691737288136:  83%|████████▎ | 117/141 [00:50<00:10,  2.34it/s]avg_loss = 1.8313691737288136:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.830094537815126:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s] avg_loss = 1.830094537815126:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8283854166666667:  84%|████████▍ | 119/141 [00:51<00:09,  2.34it/s]avg_loss = 1.8283854166666667:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 1.828254132231405:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s] avg_loss = 1.828254132231405:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8285732581967213:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8285732581967213:  87%|████████▋ | 122/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8285060975609757:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 1.8285060975609757:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8287550403225807:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8287550403225807:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8276875:  88%|████████▊ | 124/141 [00:53<00:07,  2.34it/s]         avg_loss = 1.8276875:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 1.828187003968254:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 1.828187003968254:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 1.828001968503937:  89%|████████▉ | 126/141 [00:54<00:06,  2.34it/s]avg_loss = 1.828001968503937:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]avg_loss = 1.82672119140625:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s] avg_loss = 1.82672119140625:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.8269743217054264:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.8269743217054264:  91%|█████████▏| 129/141 [00:54<00:05,  2.34it/s]avg_loss = 1.8277043269230768:  91%|█████████▏| 129/141 [00:55<00:05,  2.34it/s]avg_loss = 1.8277043269230768:  92%|█████████▏| 130/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8286020992366412:  92%|█████████▏| 130/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8286020992366412:  93%|█████████▎| 131/141 [00:55<00:04,  2.33it/s]avg_loss = 1.8292495265151516:  93%|█████████▎| 131/141 [00:56<00:04,  2.33it/s]avg_loss = 1.8292495265151516:  94%|█████████▎| 132/141 [00:56<00:03,  2.34it/s]avg_loss = 1.8264802631578947:  94%|█████████▎| 132/141 [00:56<00:03,  2.34it/s]avg_loss = 1.8264802631578947:  94%|█████████▍| 133/141 [00:56<00:03,  2.34it/s]avg_loss = 1.822119869402985:  94%|█████████▍| 133/141 [00:57<00:03,  2.34it/s] avg_loss = 1.822119869402985:  95%|█████████▌| 134/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8245949074074075:  95%|█████████▌| 134/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8245949074074075:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8280675551470589:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8280675551470589:  96%|█████████▋| 136/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8288663321167884:  96%|█████████▋| 136/141 [00:58<00:02,  2.33it/s]avg_loss = 1.8288663321167884:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]avg_loss = 1.8275022644927537:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]avg_loss = 1.8275022644927537:  98%|█████████▊| 138/141 [00:58<00:01,  2.33it/s]avg_loss = 1.8276753597122302:  98%|█████████▊| 138/141 [00:59<00:01,  2.33it/s]avg_loss = 1.8276753597122302:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8281808035714286:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8281808035714286:  99%|█████████▉| 140/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8293993794326242:  99%|█████████▉| 140/141 [01:00<00:00,  2.34it/s]avg_loss = 1.8293993794326242: 100%|██████████| 141/141 [01:00<00:00,  2.33it/s]avg_loss = 1.8293993794326242: 100%|██████████| 141/141 [01:00<00:00,  2.35it/s]
I0303 07:57:34.074005 3086042 eval_ppl.py:105] wikitext2 perplexity: 6.2301435470581055
wikitext2 perplexity: 6.230
Running with lmbda=10000
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  9.00it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.76it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.59it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.68it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.82it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:12,  2.52it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:11,  2.58it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.12it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:14,  1.96it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:15,  1.80it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:03<00:14,  1.76it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:14,  1.78it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:04<00:14,  1.65it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:05<00:13,  1.65it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:13,  1.68it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:06<00:12,  1.75it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:11,  1.78it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:07<00:10,  1.81it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:09,  1.87it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:08,  1.84it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:09<00:08,  1.84it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:09<00:07,  1.83it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:10<00:07,  1.84it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:10<00:06,  1.85it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:11<00:05,  1.94it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:05,  1.96it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:12<00:04,  1.97it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:12<00:04,  1.99it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:13<00:03,  2.04it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:13<00:02,  2.14it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:14<00:02,  2.19it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:14<00:01,  2.28it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:14<00:01,  2.37it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:15<00:00,  2.44it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:15<00:00,  2.39it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  2.27it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  1.97it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 07:58:19 - INFO - layer0_self_attn.q_proj | mse: 0.008747065255031316, bpp_loss: 6.326149219996296, bpp: 0
2025-03-03 07:58:27 - INFO - layer0_self_attn.k_proj | mse: 0.01669418752759487, bpp_loss: 7.1174844085471705, bpp: 0
2025-03-03 07:58:35 - INFO - layer0_self_attn.v_proj | mse: 0.0009503419516063153, bpp_loss: 5.405458504916169, bpp: 0
2025-03-03 07:58:44 - INFO - layer0_self_attn.o_proj | mse: 0.0005776249768070206, bpp_loss: 5.486253097653389, bpp: 0
2025-03-03 07:58:56 - INFO - layer0_mlp.gate_proj | mse: 0.000600995619680385, bpp_loss: 5.879956210963428, bpp: 0
2025-03-03 07:59:07 - INFO - layer0_mlp.up_proj | mse: 0.0005815087663022753, bpp_loss: 5.767660613437848, bpp: 0
2025-03-03 07:59:46 - INFO - layer0_mlp.down_proj | mse: 0.0005762137484787274, bpp_loss: 5.763571945950389, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:36<49:46, 96.35s/it]2025-03-03 07:59:55 - INFO - layer1_self_attn.q_proj | mse: 0.0012064619709739332, bpp_loss: 6.626982707763091, bpp: 0
2025-03-03 08:00:04 - INFO - layer1_self_attn.k_proj | mse: 0.0019468343345406596, bpp_loss: 7.647399872425012, bpp: 0
2025-03-03 08:00:12 - INFO - layer1_self_attn.v_proj | mse: 0.0007145359042036325, bpp_loss: 5.507132870261557, bpp: 0
2025-03-03 08:00:22 - INFO - layer1_self_attn.o_proj | mse: 0.000700498601297026, bpp_loss: 5.569750383729115, bpp: 0
2025-03-03 08:00:33 - INFO - layer1_mlp.gate_proj | mse: 0.0006142126521432045, bpp_loss: 5.8929201039884775, bpp: 0
2025-03-03 08:00:44 - INFO - layer1_mlp.up_proj | mse: 0.0005930210961445408, bpp_loss: 5.782368245800691, bpp: 0
2025-03-03 08:01:23 - INFO - layer1_mlp.down_proj | mse: 0.0006573049187752292, bpp_loss: 5.778680358980117, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [03:13<48:21, 96.72s/it]2025-03-03 08:01:32 - INFO - layer2_self_attn.q_proj | mse: 0.0008581467404714648, bpp_loss: 6.51518095319625, bpp: 0
2025-03-03 08:01:41 - INFO - layer2_self_attn.k_proj | mse: 0.0013149483388681913, bpp_loss: 7.671846720739268, bpp: 0
2025-03-03 08:01:49 - INFO - layer2_self_attn.v_proj | mse: 0.0005616499145517223, bpp_loss: 5.41517714294605, bpp: 0
2025-03-03 08:01:58 - INFO - layer2_self_attn.o_proj | mse: 0.0005424816776567446, bpp_loss: 5.516022559138946, bpp: 0
2025-03-03 08:02:10 - INFO - layer2_mlp.gate_proj | mse: 0.0005887375600409817, bpp_loss: 5.92855879770858, bpp: 0
2025-03-03 08:02:21 - INFO - layer2_mlp.up_proj | mse: 0.0005589621186417159, bpp_loss: 5.777009559662214, bpp: 0
2025-03-03 08:02:59 - INFO - layer2_mlp.down_proj | mse: 0.0005399369296902214, bpp_loss: 5.7808753496501595, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:50<46:45, 96.74s/it]2025-03-03 08:03:09 - INFO - layer3_self_attn.q_proj | mse: 0.0007440507928368015, bpp_loss: 6.546822565374896, bpp: 0
2025-03-03 08:03:18 - INFO - layer3_self_attn.k_proj | mse: 0.0010424486218776347, bpp_loss: 7.744399886927567, bpp: 0
2025-03-03 08:03:26 - INFO - layer3_self_attn.v_proj | mse: 0.0005158794937294928, bpp_loss: 5.509700907627121, bpp: 0
2025-03-03 08:03:35 - INFO - layer3_self_attn.o_proj | mse: 0.0005762069650018179, bpp_loss: 5.611526535707526, bpp: 0
2025-03-03 08:03:47 - INFO - layer3_mlp.gate_proj | mse: 0.0006032065287570605, bpp_loss: 6.009857726017279, bpp: 0
2025-03-03 08:03:58 - INFO - layer3_mlp.up_proj | mse: 0.0005556265362532281, bpp_loss: 5.7576268854151875, bpp: 0
2025-03-03 08:04:36 - INFO - layer3_mlp.down_proj | mse: 0.0005292287878255143, bpp_loss: 5.7556764474803845, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [06:26<45:08, 96.75s/it]2025-03-03 08:04:46 - INFO - layer4_self_attn.q_proj | mse: 0.0007493732032325023, bpp_loss: 6.510770689113997, bpp: 0
2025-03-03 08:04:54 - INFO - layer4_self_attn.k_proj | mse: 0.0010745053937678219, bpp_loss: 7.693667481187731, bpp: 0
2025-03-03 08:05:03 - INFO - layer4_self_attn.v_proj | mse: 0.0005303441104151046, bpp_loss: 5.557011852390133, bpp: 0
2025-03-03 08:05:12 - INFO - layer4_self_attn.o_proj | mse: 0.0006093131000302355, bpp_loss: 5.626274458714761, bpp: 0
2025-03-03 08:05:23 - INFO - layer4_mlp.gate_proj | mse: 0.0006168191627293294, bpp_loss: 6.089816434441933, bpp: 0
2025-03-03 08:05:35 - INFO - layer4_mlp.up_proj | mse: 0.000546983882274787, bpp_loss: 5.731319870134549, bpp: 0
2025-03-03 08:06:14 - INFO - layer4_mlp.down_proj | mse: 0.0005364261796920833, bpp_loss: 5.730163592346279, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [08:04<43:43, 97.17s/it]2025-03-03 08:06:24 - INFO - layer5_self_attn.q_proj | mse: 0.0007530375546863413, bpp_loss: 6.485864906921051, bpp: 0
2025-03-03 08:06:33 - INFO - layer5_self_attn.k_proj | mse: 0.0011261307828893533, bpp_loss: 7.662496854667552, bpp: 0
2025-03-03 08:06:41 - INFO - layer5_self_attn.v_proj | mse: 0.0005176112461917171, bpp_loss: 5.444820176693611, bpp: 0
2025-03-03 08:06:51 - INFO - layer5_self_attn.o_proj | mse: 0.0006160370000352346, bpp_loss: 5.568979136296548, bpp: 0
2025-03-03 08:07:02 - INFO - layer5_mlp.gate_proj | mse: 0.000611806296158892, bpp_loss: 6.090111132711172, bpp: 0
2025-03-03 08:07:13 - INFO - layer5_mlp.up_proj | mse: 0.0005436509899972565, bpp_loss: 5.736990236810276, bpp: 0
2025-03-03 08:07:53 - INFO - layer5_mlp.down_proj | mse: 0.0005398949225729632, bpp_loss: 5.735004888448332, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [09:43<42:18, 97.64s/it]2025-03-03 08:08:02 - INFO - layer6_self_attn.q_proj | mse: 0.0007376602790587487, bpp_loss: 6.537715453770943, bpp: 0
2025-03-03 08:08:11 - INFO - layer6_self_attn.k_proj | mse: 0.0010399516427804444, bpp_loss: 7.7208983327727765, bpp: 0
2025-03-03 08:08:20 - INFO - layer6_self_attn.v_proj | mse: 0.0005106935611985909, bpp_loss: 5.491282637696713, bpp: 0
2025-03-03 08:08:29 - INFO - layer6_self_attn.o_proj | mse: 0.0006278488763192537, bpp_loss: 5.601170428446494, bpp: 0
2025-03-03 08:08:40 - INFO - layer6_mlp.gate_proj | mse: 0.0006134871499111504, bpp_loss: 6.097927839495242, bpp: 0
2025-03-03 08:08:52 - INFO - layer6_mlp.up_proj | mse: 0.0005432747883264424, bpp_loss: 5.7365466715501885, bpp: 0
2025-03-03 08:09:31 - INFO - layer6_mlp.down_proj | mse: 0.0005455869386943421, bpp_loss: 5.734517544441458, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [11:21<40:45, 97.82s/it]2025-03-03 08:09:40 - INFO - layer7_self_attn.q_proj | mse: 0.0007188746328481089, bpp_loss: 6.44625759369228, bpp: 0
2025-03-03 08:09:49 - INFO - layer7_self_attn.k_proj | mse: 0.0010230534650701407, bpp_loss: 7.755968642653897, bpp: 0
2025-03-03 08:09:58 - INFO - layer7_self_attn.v_proj | mse: 0.000515017351967318, bpp_loss: 5.487553482176736, bpp: 0
2025-03-03 08:10:07 - INFO - layer7_self_attn.o_proj | mse: 0.0006435130949600998, bpp_loss: 5.613929991028272, bpp: 0
2025-03-03 08:10:18 - INFO - layer7_mlp.gate_proj | mse: 0.0006094640889743333, bpp_loss: 6.068441722675094, bpp: 0
2025-03-03 08:10:30 - INFO - layer7_mlp.up_proj | mse: 0.0005464650012574236, bpp_loss: 5.750525409754898, bpp: 0
2025-03-03 08:11:09 - INFO - layer7_mlp.down_proj | mse: 0.0005481010025827573, bpp_loss: 5.7490242296563725, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [12:59<39:10, 97.92s/it]2025-03-03 08:11:19 - INFO - layer8_self_attn.q_proj | mse: 0.0007259326433406966, bpp_loss: 6.435347670922056, bpp: 0
2025-03-03 08:11:28 - INFO - layer8_self_attn.k_proj | mse: 0.0010603482709911913, bpp_loss: 7.653552199946716, bpp: 0
2025-03-03 08:11:36 - INFO - layer8_self_attn.v_proj | mse: 0.0005212115458449954, bpp_loss: 5.512546017533168, bpp: 0
2025-03-03 08:11:45 - INFO - layer8_self_attn.o_proj | mse: 0.0006837363129897492, bpp_loss: 5.627199329552241, bpp: 0
2025-03-03 08:11:57 - INFO - layer8_mlp.gate_proj | mse: 0.0006064954997999208, bpp_loss: 6.075667269660959, bpp: 0
2025-03-03 08:12:08 - INFO - layer8_mlp.up_proj | mse: 0.0005423457171209761, bpp_loss: 5.74591077797647, bpp: 0
2025-03-03 08:12:47 - INFO - layer8_mlp.down_proj | mse: 0.0005500659734384414, bpp_loss: 5.746255677825372, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [14:38<37:35, 98.08s/it]2025-03-03 08:12:57 - INFO - layer9_self_attn.q_proj | mse: 0.0007196873438214411, bpp_loss: 6.445540877874009, bpp: 0
2025-03-03 08:13:06 - INFO - layer9_self_attn.k_proj | mse: 0.0010472167012841728, bpp_loss: 7.675443940446712, bpp: 0
2025-03-03 08:13:14 - INFO - layer9_self_attn.v_proj | mse: 0.000536621367935205, bpp_loss: 5.615913809160702, bpp: 0
2025-03-03 08:13:23 - INFO - layer9_self_attn.o_proj | mse: 0.0007027470684612992, bpp_loss: 5.68444049556274, bpp: 0
2025-03-03 08:13:35 - INFO - layer9_mlp.gate_proj | mse: 0.0006100906261628964, bpp_loss: 6.093776374922267, bpp: 0
2025-03-03 08:13:46 - INFO - layer9_mlp.up_proj | mse: 0.0005433851346085995, bpp_loss: 5.755459011266274, bpp: 0
2025-03-03 08:14:26 - INFO - layer9_mlp.down_proj | mse: 0.0005534599105415439, bpp_loss: 5.749479687406814, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [16:16<35:59, 98.15s/it]2025-03-03 08:14:35 - INFO - layer10_self_attn.q_proj | mse: 0.0007336673848710095, bpp_loss: 6.461607397766784, bpp: 0
2025-03-03 08:14:44 - INFO - layer10_self_attn.k_proj | mse: 0.0010908595612031165, bpp_loss: 7.687564443331212, bpp: 0
2025-03-03 08:14:53 - INFO - layer10_self_attn.v_proj | mse: 0.0005200166063176463, bpp_loss: 5.503700475208461, bpp: 0
2025-03-03 08:15:02 - INFO - layer10_self_attn.o_proj | mse: 0.0006572655371027997, bpp_loss: 5.618249361170456, bpp: 0
2025-03-03 08:15:14 - INFO - layer10_mlp.gate_proj | mse: 0.0006041015597123349, bpp_loss: 6.057489628637476, bpp: 0
2025-03-03 08:15:25 - INFO - layer10_mlp.up_proj | mse: 0.0005470883310059989, bpp_loss: 5.7720490728638, bpp: 0
2025-03-03 08:16:04 - INFO - layer10_mlp.down_proj | mse: 0.0005545548891670186, bpp_loss: 5.764722728669377, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [17:54<34:22, 98.21s/it]2025-03-03 08:16:14 - INFO - layer11_self_attn.q_proj | mse: 0.0006986348523327277, bpp_loss: 6.376420729327947, bpp: 0
2025-03-03 08:16:23 - INFO - layer11_self_attn.k_proj | mse: 0.0010330971495283658, bpp_loss: 7.672716069850139, bpp: 0
2025-03-03 08:16:31 - INFO - layer11_self_attn.v_proj | mse: 0.0005147532231642996, bpp_loss: 5.504009561962448, bpp: 0
2025-03-03 08:16:40 - INFO - layer11_self_attn.o_proj | mse: 0.00064727820917581, bpp_loss: 5.637209446053021, bpp: 0
2025-03-03 08:16:52 - INFO - layer11_mlp.gate_proj | mse: 0.0006004422845496056, bpp_loss: 6.037773765091385, bpp: 0
2025-03-03 08:17:03 - INFO - layer11_mlp.up_proj | mse: 0.000548362305475948, bpp_loss: 5.778473981523088, bpp: 0
2025-03-03 08:17:43 - INFO - layer11_mlp.down_proj | mse: 0.0005556707678853164, bpp_loss: 5.772624712803268, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [19:33<32:49, 98.46s/it]2025-03-03 08:17:52 - INFO - layer12_self_attn.q_proj | mse: 0.0007125479445391659, bpp_loss: 6.429621890070848, bpp: 0
2025-03-03 08:18:01 - INFO - layer12_self_attn.k_proj | mse: 0.0009981389895047986, bpp_loss: 7.6381089051719755, bpp: 0
2025-03-03 08:18:10 - INFO - layer12_self_attn.v_proj | mse: 0.0005374645431218075, bpp_loss: 5.621763494214974, bpp: 0
2025-03-03 08:18:19 - INFO - layer12_self_attn.o_proj | mse: 0.0006695628943486651, bpp_loss: 5.685567599954084, bpp: 0
2025-03-03 08:18:30 - INFO - layer12_mlp.gate_proj | mse: 0.0006005807217981065, bpp_loss: 6.0199490162943095, bpp: 0
2025-03-03 08:18:41 - INFO - layer12_mlp.up_proj | mse: 0.0005555968932997935, bpp_loss: 5.799035378332649, bpp: 0
2025-03-03 08:19:20 - INFO - layer12_mlp.down_proj | mse: 0.0005656389223051216, bpp_loss: 5.7876413365094255, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [21:10<31:01, 97.98s/it]2025-03-03 08:19:29 - INFO - layer13_self_attn.q_proj | mse: 0.0007354589793688105, bpp_loss: 6.416247940156609, bpp: 0
2025-03-03 08:19:38 - INFO - layer13_self_attn.k_proj | mse: 0.001152682540169379, bpp_loss: 7.700807953602634, bpp: 0
2025-03-03 08:19:47 - INFO - layer13_self_attn.v_proj | mse: 0.0005421297775171274, bpp_loss: 5.56204742542468, bpp: 0
2025-03-03 08:19:56 - INFO - layer13_self_attn.o_proj | mse: 0.0006795276343968705, bpp_loss: 5.664558103773743, bpp: 0
2025-03-03 08:20:07 - INFO - layer13_mlp.gate_proj | mse: 0.0006080325878146664, bpp_loss: 6.023276953957975, bpp: 0
2025-03-03 08:20:18 - INFO - layer13_mlp.up_proj | mse: 0.0005621209814334626, bpp_loss: 5.802337167119341, bpp: 0
2025-03-03 08:20:57 - INFO - layer13_mlp.down_proj | mse: 0.0005691214778711099, bpp_loss: 5.787751288053447, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [22:47<29:16, 97.61s/it]2025-03-03 08:21:06 - INFO - layer14_self_attn.q_proj | mse: 0.0007288584752707571, bpp_loss: 6.3781435646815225, bpp: 0
2025-03-03 08:21:15 - INFO - layer14_self_attn.k_proj | mse: 0.001175031956137147, bpp_loss: 7.636836934834719, bpp: 0
2025-03-03 08:21:23 - INFO - layer14_self_attn.v_proj | mse: 0.0005424109264452419, bpp_loss: 5.5539841203717515, bpp: 0
2025-03-03 08:21:32 - INFO - layer14_self_attn.o_proj | mse: 0.0006768934531742389, bpp_loss: 5.658865600358695, bpp: 0
2025-03-03 08:21:43 - INFO - layer14_mlp.gate_proj | mse: 0.0006147493810121121, bpp_loss: 6.059626463002393, bpp: 0
2025-03-03 08:21:55 - INFO - layer14_mlp.up_proj | mse: 0.0005605316949195626, bpp_loss: 5.797422984082784, bpp: 0
2025-03-03 08:22:33 - INFO - layer14_mlp.down_proj | mse: 0.0005662172961609662, bpp_loss: 5.7847111090419014, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [24:23<27:31, 97.12s/it]2025-03-03 08:22:42 - INFO - layer15_self_attn.q_proj | mse: 0.0007733226920244516, bpp_loss: 6.556269976194017, bpp: 0
2025-03-03 08:22:51 - INFO - layer15_self_attn.k_proj | mse: 0.0010910144624480058, bpp_loss: 7.662435488309711, bpp: 0
2025-03-03 08:23:00 - INFO - layer15_self_attn.v_proj | mse: 0.0005474931086391228, bpp_loss: 5.617203347268514, bpp: 0
2025-03-03 08:23:09 - INFO - layer15_self_attn.o_proj | mse: 0.0006373079466402064, bpp_loss: 5.68888245720882, bpp: 0
2025-03-03 08:23:20 - INFO - layer15_mlp.gate_proj | mse: 0.000626102942574987, bpp_loss: 6.09813949452447, bpp: 0
2025-03-03 08:23:31 - INFO - layer15_mlp.up_proj | mse: 0.000562575403253654, bpp_loss: 5.788774508982897, bpp: 0
2025-03-03 08:24:10 - INFO - layer15_mlp.down_proj | mse: 0.0005681131001253028, bpp_loss: 5.778703286545351, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [26:00<25:54, 97.15s/it]2025-03-03 08:24:19 - INFO - layer16_self_attn.q_proj | mse: 0.0007773745681882547, bpp_loss: 6.5102534933248535, bpp: 0
2025-03-03 08:24:30 - INFO - layer16_self_attn.k_proj | mse: 0.0012259250272166505, bpp_loss: 7.665626900154166, bpp: 0
2025-03-03 08:24:38 - INFO - layer16_self_attn.v_proj | mse: 0.000556112625076685, bpp_loss: 5.57090236467775, bpp: 0
2025-03-03 08:24:47 - INFO - layer16_self_attn.o_proj | mse: 0.0006745958720851543, bpp_loss: 5.669106868794188, bpp: 0
2025-03-03 08:24:58 - INFO - layer16_mlp.gate_proj | mse: 0.0006287420448900191, bpp_loss: 6.13493660664452, bpp: 0
2025-03-03 08:25:10 - INFO - layer16_mlp.up_proj | mse: 0.0005553205361318219, bpp_loss: 5.774449550945844, bpp: 0
2025-03-03 08:25:48 - INFO - layer16_mlp.down_proj | mse: 0.0005549125704585491, bpp_loss: 5.764597885610003, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [27:38<24:19, 97.29s/it]2025-03-03 08:25:57 - INFO - layer17_self_attn.q_proj | mse: 0.0007529054676516869, bpp_loss: 6.530252653290518, bpp: 0
2025-03-03 08:26:06 - INFO - layer17_self_attn.k_proj | mse: 0.0011726264149460573, bpp_loss: 7.699762884876691, bpp: 0
2025-03-03 08:26:14 - INFO - layer17_self_attn.v_proj | mse: 0.0005466938870202549, bpp_loss: 5.64451149944216, bpp: 0
2025-03-03 08:26:23 - INFO - layer17_self_attn.o_proj | mse: 0.0006233518514581268, bpp_loss: 5.6986149792792276, bpp: 0
2025-03-03 08:26:34 - INFO - layer17_mlp.gate_proj | mse: 0.0006324103215778752, bpp_loss: 6.151090765638011, bpp: 0
2025-03-03 08:26:45 - INFO - layer17_mlp.up_proj | mse: 0.0005551571118911588, bpp_loss: 5.77048886540745, bpp: 0
2025-03-03 08:27:24 - INFO - layer17_mlp.down_proj | mse: 0.0005547759438616541, bpp_loss: 5.762381235470197, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [29:15<22:40, 97.16s/it]2025-03-03 08:27:34 - INFO - layer18_self_attn.q_proj | mse: 0.0007496408628061525, bpp_loss: 6.513816280290484, bpp: 0
2025-03-03 08:27:43 - INFO - layer18_self_attn.k_proj | mse: 0.0011627367264069187, bpp_loss: 7.804554743692279, bpp: 0
2025-03-03 08:27:52 - INFO - layer18_self_attn.v_proj | mse: 0.0005313905312444754, bpp_loss: 5.565764039172791, bpp: 0
2025-03-03 08:28:01 - INFO - layer18_self_attn.o_proj | mse: 0.0006108162577272081, bpp_loss: 5.677176725817844, bpp: 0
2025-03-03 08:28:13 - INFO - layer18_mlp.gate_proj | mse: 0.0006279731904852282, bpp_loss: 6.15532424912921, bpp: 0
2025-03-03 08:28:24 - INFO - layer18_mlp.up_proj | mse: 0.0005488462667837679, bpp_loss: 5.765454423081662, bpp: 0
2025-03-03 08:29:04 - INFO - layer18_mlp.down_proj | mse: 0.000543348093850032, bpp_loss: 5.7597518137523105, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [30:54<21:11, 97.82s/it]2025-03-03 08:29:14 - INFO - layer19_self_attn.q_proj | mse: 0.0007404628961470241, bpp_loss: 6.516716344398446, bpp: 0
2025-03-03 08:29:23 - INFO - layer19_self_attn.k_proj | mse: 0.00110406871733145, bpp_loss: 7.6618631889577955, bpp: 0
2025-03-03 08:29:31 - INFO - layer19_self_attn.v_proj | mse: 0.0005300658585295596, bpp_loss: 5.608840651810169, bpp: 0
2025-03-03 08:29:40 - INFO - layer19_self_attn.o_proj | mse: 0.0005942758195079508, bpp_loss: 5.690413751988672, bpp: 0
2025-03-03 08:29:52 - INFO - layer19_mlp.gate_proj | mse: 0.000625301444708386, bpp_loss: 6.166075253193932, bpp: 0
2025-03-03 08:30:03 - INFO - layer19_mlp.up_proj | mse: 0.0005436837886577758, bpp_loss: 5.761475641413459, bpp: 0
2025-03-03 08:30:41 - INFO - layer19_mlp.down_proj | mse: 0.0005385776993960834, bpp_loss: 5.757468346705926, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [32:31<19:31, 97.65s/it]2025-03-03 08:30:50 - INFO - layer20_self_attn.q_proj | mse: 0.0007333541874094696, bpp_loss: 6.4862948363879696, bpp: 0
2025-03-03 08:30:59 - INFO - layer20_self_attn.k_proj | mse: 0.0011094646401823528, bpp_loss: 7.596473004086874, bpp: 0
2025-03-03 08:31:08 - INFO - layer20_self_attn.v_proj | mse: 0.0005402484199659613, bpp_loss: 5.646991009823978, bpp: 0
2025-03-03 08:31:17 - INFO - layer20_self_attn.o_proj | mse: 0.0005920972887619575, bpp_loss: 5.679884763318114, bpp: 0
2025-03-03 08:31:28 - INFO - layer20_mlp.gate_proj | mse: 0.0006244875309450582, bpp_loss: 6.166437244974077, bpp: 0
2025-03-03 08:31:39 - INFO - layer20_mlp.up_proj | mse: 0.0005434714250908489, bpp_loss: 5.765019139274955, bpp: 0
2025-03-03 08:32:17 - INFO - layer20_mlp.down_proj | mse: 0.0005368257646350657, bpp_loss: 5.76135760708712, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [34:07<17:49, 97.24s/it]2025-03-03 08:32:27 - INFO - layer21_self_attn.q_proj | mse: 0.0007272876897363022, bpp_loss: 6.475798893370666, bpp: 0
2025-03-03 08:32:35 - INFO - layer21_self_attn.k_proj | mse: 0.0010947179692428236, bpp_loss: 7.647217972786166, bpp: 0
2025-03-03 08:32:44 - INFO - layer21_self_attn.v_proj | mse: 0.0005434052457746513, bpp_loss: 5.673965102760121, bpp: 0
2025-03-03 08:32:53 - INFO - layer21_self_attn.o_proj | mse: 0.0006323282020609323, bpp_loss: 5.700518272467889, bpp: 0
2025-03-03 08:33:04 - INFO - layer21_mlp.gate_proj | mse: 0.0006296162274853736, bpp_loss: 6.179355746933392, bpp: 0
2025-03-03 08:33:15 - INFO - layer21_mlp.up_proj | mse: 0.0005463074228348028, bpp_loss: 5.768030854873359, bpp: 0
2025-03-03 08:33:53 - INFO - layer21_mlp.down_proj | mse: 0.0005435143634003616, bpp_loss: 5.763906416117346, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [35:43<16:08, 96.84s/it]2025-03-03 08:34:03 - INFO - layer22_self_attn.q_proj | mse: 0.0007273048003939784, bpp_loss: 6.428551146527752, bpp: 0
2025-03-03 08:34:11 - INFO - layer22_self_attn.k_proj | mse: 0.0011284036033177266, bpp_loss: 7.5633607362397015, bpp: 0
2025-03-03 08:34:20 - INFO - layer22_self_attn.v_proj | mse: 0.0005579561852755769, bpp_loss: 5.724985626409762, bpp: 0
2025-03-03 08:34:29 - INFO - layer22_self_attn.o_proj | mse: 0.0006110961844654884, bpp_loss: 5.722938223509118, bpp: 0
2025-03-03 08:34:40 - INFO - layer22_mlp.gate_proj | mse: 0.0006309276565771142, bpp_loss: 6.18042224938316, bpp: 0
2025-03-03 08:34:51 - INFO - layer22_mlp.up_proj | mse: 0.0005475759136170308, bpp_loss: 5.771750170072274, bpp: 0
2025-03-03 08:35:29 - INFO - layer22_mlp.down_proj | mse: 0.0005399127186916045, bpp_loss: 5.768004129707281, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [37:20<14:29, 96.63s/it]2025-03-03 08:35:39 - INFO - layer23_self_attn.q_proj | mse: 0.0007203365076884657, bpp_loss: 6.438355101970956, bpp: 0
2025-03-03 08:35:47 - INFO - layer23_self_attn.k_proj | mse: 0.0010837347376662693, bpp_loss: 7.558668537531048, bpp: 0
2025-03-03 08:35:56 - INFO - layer23_self_attn.v_proj | mse: 0.0005635319963635309, bpp_loss: 5.778526820475236, bpp: 0
2025-03-03 08:36:05 - INFO - layer23_self_attn.o_proj | mse: 0.0005805415744138908, bpp_loss: 5.74322596762795, bpp: 0
2025-03-03 08:36:16 - INFO - layer23_mlp.gate_proj | mse: 0.0006323328256891404, bpp_loss: 6.183163248135576, bpp: 0
2025-03-03 08:36:27 - INFO - layer23_mlp.up_proj | mse: 0.0005484981043463945, bpp_loss: 5.775864823987441, bpp: 0
2025-03-03 08:37:05 - INFO - layer23_mlp.down_proj | mse: 0.0005338615210245073, bpp_loss: 5.772679027934958, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [38:55<12:50, 96.36s/it]2025-03-03 08:37:14 - INFO - layer24_self_attn.q_proj | mse: 0.0007130177180983305, bpp_loss: 6.402345775393769, bpp: 0
2025-03-03 08:37:23 - INFO - layer24_self_attn.k_proj | mse: 0.0010577857463058653, bpp_loss: 7.352418950176798, bpp: 0
2025-03-03 08:37:32 - INFO - layer24_self_attn.v_proj | mse: 0.0005859628463872767, bpp_loss: 5.880249136709608, bpp: 0
2025-03-03 08:37:41 - INFO - layer24_self_attn.o_proj | mse: 0.0006133175371219626, bpp_loss: 5.787963659618981, bpp: 0
2025-03-03 08:37:52 - INFO - layer24_mlp.gate_proj | mse: 0.000629007900278676, bpp_loss: 6.190285029688051, bpp: 0
2025-03-03 08:38:03 - INFO - layer24_mlp.up_proj | mse: 0.0005462930410877611, bpp_loss: 5.7806932576266785, bpp: 0
2025-03-03 08:38:41 - INFO - layer24_mlp.down_proj | mse: 0.000528916734954454, bpp_loss: 5.777910017541477, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [40:31<11:13, 96.16s/it]2025-03-03 08:38:50 - INFO - layer25_self_attn.q_proj | mse: 0.0006976097066597269, bpp_loss: 6.37443399138283, bpp: 0
2025-03-03 08:38:59 - INFO - layer25_self_attn.k_proj | mse: 0.0010072368800966537, bpp_loss: 7.3322540851077065, bpp: 0
2025-03-03 08:39:07 - INFO - layer25_self_attn.v_proj | mse: 0.0005783411347834653, bpp_loss: 5.890160373179242, bpp: 0
2025-03-03 08:39:16 - INFO - layer25_self_attn.o_proj | mse: 0.0006141661442633829, bpp_loss: 5.7916334758047014, bpp: 0
2025-03-03 08:39:27 - INFO - layer25_mlp.gate_proj | mse: 0.0006286281807704561, bpp_loss: 6.201945578945534, bpp: 0
2025-03-03 08:39:38 - INFO - layer25_mlp.up_proj | mse: 0.000545656726380526, bpp_loss: 5.789971123848643, bpp: 0
2025-03-03 08:40:17 - INFO - layer25_mlp.down_proj | mse: 0.0005287060785733271, bpp_loss: 5.787005405839799, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [42:07<09:36, 96.08s/it]2025-03-03 08:40:26 - INFO - layer26_self_attn.q_proj | mse: 0.0007047571180753586, bpp_loss: 6.38530547474511, bpp: 0
2025-03-03 08:40:35 - INFO - layer26_self_attn.k_proj | mse: 0.0010764614406977336, bpp_loss: 7.434453674824908, bpp: 0
2025-03-03 08:40:43 - INFO - layer26_self_attn.v_proj | mse: 0.0005985726315677493, bpp_loss: 5.950419767177664, bpp: 0
2025-03-03 08:40:52 - INFO - layer26_self_attn.o_proj | mse: 0.0006681538000026218, bpp_loss: 5.814633887843229, bpp: 0
2025-03-03 08:41:03 - INFO - layer26_mlp.gate_proj | mse: 0.0006280441680281814, bpp_loss: 6.212959414747145, bpp: 0
2025-03-03 08:41:14 - INFO - layer26_mlp.up_proj | mse: 0.0005452915955509596, bpp_loss: 5.799094734447343, bpp: 0
2025-03-03 08:41:52 - INFO - layer26_mlp.down_proj | mse: 0.000527760452838892, bpp_loss: 5.795627857891044, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [43:42<07:59, 95.94s/it]2025-03-03 08:42:02 - INFO - layer27_self_attn.q_proj | mse: 0.0006864463152483801, bpp_loss: 6.351811912376434, bpp: 0
2025-03-03 08:42:10 - INFO - layer27_self_attn.k_proj | mse: 0.0010394307183134114, bpp_loss: 7.383077806443907, bpp: 0
2025-03-03 08:42:19 - INFO - layer27_self_attn.v_proj | mse: 0.0006105782475736055, bpp_loss: 6.046626026974991, bpp: 0
2025-03-03 08:42:28 - INFO - layer27_self_attn.o_proj | mse: 0.0006184299119313728, bpp_loss: 5.846282019279897, bpp: 0
2025-03-03 08:42:39 - INFO - layer27_mlp.gate_proj | mse: 0.0006271986454611042, bpp_loss: 6.227137406888817, bpp: 0
2025-03-03 08:42:50 - INFO - layer27_mlp.up_proj | mse: 0.0005449575044632097, bpp_loss: 5.813816794327328, bpp: 0
2025-03-03 08:43:28 - INFO - layer27_mlp.down_proj | mse: 0.0005322781837944554, bpp_loss: 5.807311191789007, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [45:18<06:23, 95.85s/it]2025-03-03 08:43:37 - INFO - layer28_self_attn.q_proj | mse: 0.0006836437434263948, bpp_loss: 6.359420306864195, bpp: 0
2025-03-03 08:43:46 - INFO - layer28_self_attn.k_proj | mse: 0.0009489515522381035, bpp_loss: 7.292810802697204, bpp: 0
2025-03-03 08:43:54 - INFO - layer28_self_attn.v_proj | mse: 0.0006180819952252888, bpp_loss: 6.106074537616223, bpp: 0
2025-03-03 08:44:03 - INFO - layer28_self_attn.o_proj | mse: 0.0006371743658179772, bpp_loss: 5.876904228236526, bpp: 0
2025-03-03 08:44:15 - INFO - layer28_mlp.gate_proj | mse: 0.0006266369813329374, bpp_loss: 6.215697777989719, bpp: 0
2025-03-03 08:44:26 - INFO - layer28_mlp.up_proj | mse: 0.0005507788528421567, bpp_loss: 5.837211525333779, bpp: 0
2025-03-03 08:45:04 - INFO - layer28_mlp.down_proj | mse: 0.0005393878366574901, bpp_loss: 5.824895722359153, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [46:55<04:48, 96.03s/it]2025-03-03 08:45:14 - INFO - layer29_self_attn.q_proj | mse: 0.0006727203538854173, bpp_loss: 6.345076383091509, bpp: 0
2025-03-03 08:45:23 - INFO - layer29_self_attn.k_proj | mse: 0.0009790075541037118, bpp_loss: 7.419319599634036, bpp: 0
2025-03-03 08:45:31 - INFO - layer29_self_attn.v_proj | mse: 0.0006335435114188484, bpp_loss: 6.175587136531249, bpp: 0
2025-03-03 08:45:40 - INFO - layer29_self_attn.o_proj | mse: 0.0006740954079812687, bpp_loss: 5.916650221333839, bpp: 0
2025-03-03 08:45:51 - INFO - layer29_mlp.gate_proj | mse: 0.0006291517694819948, bpp_loss: 6.210336392745376, bpp: 0
2025-03-03 08:46:03 - INFO - layer29_mlp.up_proj | mse: 0.0005601069677857089, bpp_loss: 5.870483297987708, bpp: 0
2025-03-03 08:46:41 - INFO - layer29_mlp.down_proj | mse: 0.0005512357061087904, bpp_loss: 5.842837089905515, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [48:31<03:12, 96.31s/it]2025-03-03 08:46:51 - INFO - layer30_self_attn.q_proj | mse: 0.000675306824438232, bpp_loss: 6.2452541993698105, bpp: 0
2025-03-03 08:47:00 - INFO - layer30_self_attn.k_proj | mse: 0.0009857687082655035, bpp_loss: 6.98609798878897, bpp: 0
2025-03-03 08:47:08 - INFO - layer30_self_attn.v_proj | mse: 0.0007314158848652963, bpp_loss: 6.506475026952103, bpp: 0
2025-03-03 08:47:17 - INFO - layer30_self_attn.o_proj | mse: 0.0007252821214849675, bpp_loss: 6.007705511641689, bpp: 0
2025-03-03 08:47:28 - INFO - layer30_mlp.gate_proj | mse: 0.0006436455182586238, bpp_loss: 6.270348566451243, bpp: 0
2025-03-03 08:47:40 - INFO - layer30_mlp.up_proj | mse: 0.0005679277928666591, bpp_loss: 5.9022794947294255, bpp: 0
2025-03-03 08:48:19 - INFO - layer30_mlp.down_proj | mse: 0.0005877519447725065, bpp_loss: 5.846764709667435, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [50:09<01:36, 96.58s/it]2025-03-03 08:48:28 - INFO - layer31_self_attn.q_proj | mse: 0.0007188466582807969, bpp_loss: 6.41981093713548, bpp: 0
2025-03-03 08:48:37 - INFO - layer31_self_attn.k_proj | mse: 0.0009918184574113159, bpp_loss: 7.2769367636647075, bpp: 0
2025-03-03 08:48:45 - INFO - layer31_self_attn.v_proj | mse: 0.0006681974819726154, bpp_loss: 6.282563545741141, bpp: 0
2025-03-03 08:48:54 - INFO - layer31_self_attn.o_proj | mse: 0.0007581129469366999, bpp_loss: 5.979727368685417, bpp: 0
2025-03-03 08:49:06 - INFO - layer31_mlp.gate_proj | mse: 0.0007407439868756226, bpp_loss: 6.523135050332972, bpp: 0
2025-03-03 08:49:17 - INFO - layer31_mlp.up_proj | mse: 0.000641557474826638, bpp_loss: 6.1090576908152014, bpp: 0
2025-03-03 08:49:56 - INFO - layer31_mlp.down_proj | mse: 0.0007637076534674846, bpp_loss: 5.878969153422596, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [51:46<00:00, 96.75s/it]pseudo compress quantization...: 100%|██████████| 32/32 [51:46<00:00, 97.07s/it]
2025-03-03 08:49:56 - INFO - #### Total | mse: 0.0006349533248025006, bpp_loss: 5.952347211778522, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda10000_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_10.96029_bpp_6.2788_MSE_0.0004_total_iter_140000.pth.tar/COL_MSE0.00063_bpploss5.9523_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda10000_rdloss_ql_encdim512_M16_batch_size2048_total_iter200000_lr0.0001_seed100/best_loss_model_loss_10.96029_bpp_6.2788_MSE_0.0004_total_iter_140000.pth.tar/COL_MSE0.00063_bpploss5.9523_bpp0
I0303 08:50:25.011632 3113022 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:02,  1.16it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.27it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.33it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s]
I0303 08:50:27.732603 3113022 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.515625:   0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.515625:   1%|          | 1/141 [00:00<01:19,  1.76it/s]avg_loss = 1.84375:   1%|          | 1/141 [00:00<01:19,  1.76it/s] avg_loss = 1.84375:   1%|▏         | 2/141 [00:00<01:06,  2.08it/s]avg_loss = 1.9791666666666667:   1%|▏         | 2/141 [00:01<01:06,  2.08it/s]avg_loss = 1.9791666666666667:   2%|▏         | 3/141 [00:01<01:02,  2.21it/s]avg_loss = 1.935546875:   2%|▏         | 3/141 [00:01<01:02,  2.21it/s]       avg_loss = 1.935546875:   3%|▎         | 4/141 [00:01<01:00,  2.27it/s]avg_loss = 1.8875:   3%|▎         | 4/141 [00:02<01:00,  2.27it/s]     avg_loss = 1.8875:   4%|▎         | 5/141 [00:02<00:59,  2.30it/s]avg_loss = 1.7916666666666667:   4%|▎         | 5/141 [00:02<00:59,  2.30it/s]avg_loss = 1.7916666666666667:   4%|▍         | 6/141 [00:02<00:58,  2.32it/s]avg_loss = 1.7265625:   4%|▍         | 6/141 [00:03<00:58,  2.32it/s]         avg_loss = 1.7265625:   5%|▍         | 7/141 [00:03<00:57,  2.34it/s]avg_loss = 1.7236328125:   5%|▍         | 7/141 [00:03<00:57,  2.34it/s]avg_loss = 1.7236328125:   6%|▌         | 8/141 [00:03<00:56,  2.35it/s]avg_loss = 1.7595486111111112:   6%|▌         | 8/141 [00:03<00:56,  2.35it/s]avg_loss = 1.7595486111111112:   6%|▋         | 9/141 [00:03<00:55,  2.36it/s]avg_loss = 1.765625:   6%|▋         | 9/141 [00:04<00:55,  2.36it/s]          avg_loss = 1.765625:   7%|▋         | 10/141 [00:04<00:55,  2.37it/s]avg_loss = 1.7627840909090908:   7%|▋         | 10/141 [00:04<00:55,  2.37it/s]avg_loss = 1.7627840909090908:   8%|▊         | 11/141 [00:04<00:54,  2.37it/s]avg_loss = 1.7864583333333333:   8%|▊         | 11/141 [00:05<00:54,  2.37it/s]avg_loss = 1.7864583333333333:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.7992788461538463:   9%|▊         | 12/141 [00:05<00:54,  2.37it/s]avg_loss = 1.7992788461538463:   9%|▉         | 13/141 [00:05<00:53,  2.38it/s]avg_loss = 1.8180803571428572:   9%|▉         | 13/141 [00:06<00:53,  2.38it/s]avg_loss = 1.8180803571428572:  10%|▉         | 14/141 [00:06<00:53,  2.38it/s]avg_loss = 1.828125:  10%|▉         | 14/141 [00:06<00:53,  2.38it/s]          avg_loss = 1.828125:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.8525390625:  11%|█         | 15/141 [00:06<00:53,  2.37it/s]avg_loss = 1.8525390625:  11%|█▏        | 16/141 [00:06<00:52,  2.37it/s]avg_loss = 1.8561580882352942:  11%|█▏        | 16/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8561580882352942:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8580729166666667:  12%|█▏        | 17/141 [00:07<00:52,  2.37it/s]avg_loss = 1.8580729166666667:  13%|█▎        | 18/141 [00:07<00:51,  2.37it/s]avg_loss = 1.8367598684210527:  13%|█▎        | 18/141 [00:08<00:51,  2.37it/s]avg_loss = 1.8367598684210527:  13%|█▎        | 19/141 [00:08<00:51,  2.37it/s]avg_loss = 1.835546875:  13%|█▎        | 19/141 [00:08<00:51,  2.37it/s]       avg_loss = 1.835546875:  14%|█▍        | 20/141 [00:08<00:51,  2.37it/s]avg_loss = 1.8407738095238095:  14%|█▍        | 20/141 [00:08<00:51,  2.37it/s]avg_loss = 1.8407738095238095:  15%|█▍        | 21/141 [00:08<00:50,  2.37it/s]avg_loss = 1.8433948863636365:  15%|█▍        | 21/141 [00:09<00:50,  2.37it/s]avg_loss = 1.8433948863636365:  16%|█▌        | 22/141 [00:09<00:50,  2.37it/s]avg_loss = 1.8451086956521738:  16%|█▌        | 22/141 [00:09<00:50,  2.37it/s]avg_loss = 1.8451086956521738:  16%|█▋        | 23/141 [00:09<00:49,  2.37it/s]avg_loss = 1.8502604166666667:  16%|█▋        | 23/141 [00:10<00:49,  2.37it/s]avg_loss = 1.8502604166666667:  17%|█▋        | 24/141 [00:10<00:49,  2.36it/s]avg_loss = 1.85625:  17%|█▋        | 24/141 [00:10<00:49,  2.36it/s]           avg_loss = 1.85625:  18%|█▊        | 25/141 [00:10<00:49,  2.36it/s]avg_loss = 1.8677884615384615:  18%|█▊        | 25/141 [00:11<00:49,  2.36it/s]avg_loss = 1.8677884615384615:  18%|█▊        | 26/141 [00:11<00:48,  2.36it/s]avg_loss = 1.8813657407407407:  18%|█▊        | 26/141 [00:11<00:48,  2.36it/s]avg_loss = 1.8813657407407407:  19%|█▉        | 27/141 [00:11<00:48,  2.36it/s]avg_loss = 1.8883928571428572:  19%|█▉        | 27/141 [00:11<00:48,  2.36it/s]avg_loss = 1.8883928571428572:  20%|█▉        | 28/141 [00:11<00:47,  2.36it/s]avg_loss = 1.8849676724137931:  20%|█▉        | 28/141 [00:12<00:47,  2.36it/s]avg_loss = 1.8849676724137931:  21%|██        | 29/141 [00:12<00:47,  2.36it/s]avg_loss = 1.8752604166666667:  21%|██        | 29/141 [00:12<00:47,  2.36it/s]avg_loss = 1.8752604166666667:  21%|██▏       | 30/141 [00:12<00:47,  2.36it/s]avg_loss = 1.8608870967741935:  21%|██▏       | 30/141 [00:13<00:47,  2.36it/s]avg_loss = 1.8608870967741935:  22%|██▏       | 31/141 [00:13<00:46,  2.36it/s]avg_loss = 1.8486328125:  22%|██▏       | 31/141 [00:13<00:46,  2.36it/s]      avg_loss = 1.8486328125:  23%|██▎       | 32/141 [00:13<00:46,  2.36it/s]avg_loss = 1.847774621212121:  23%|██▎       | 32/141 [00:14<00:46,  2.36it/s]avg_loss = 1.847774621212121:  23%|██▎       | 33/141 [00:14<00:45,  2.36it/s]avg_loss = 1.8465073529411764:  23%|██▎       | 33/141 [00:14<00:45,  2.36it/s]avg_loss = 1.8465073529411764:  24%|██▍       | 34/141 [00:14<00:45,  2.36it/s]avg_loss = 1.8495535714285714:  24%|██▍       | 34/141 [00:14<00:45,  2.36it/s]avg_loss = 1.8495535714285714:  25%|██▍       | 35/141 [00:14<00:44,  2.36it/s]avg_loss = 1.8333333333333333:  25%|██▍       | 35/141 [00:15<00:44,  2.36it/s]avg_loss = 1.8333333333333333:  26%|██▌       | 36/141 [00:15<00:44,  2.36it/s]avg_loss = 1.817989864864865:  26%|██▌       | 36/141 [00:15<00:44,  2.36it/s] avg_loss = 1.817989864864865:  26%|██▌       | 37/141 [00:15<00:44,  2.36it/s]avg_loss = 1.803248355263158:  26%|██▌       | 37/141 [00:16<00:44,  2.36it/s]avg_loss = 1.803248355263158:  27%|██▋       | 38/141 [00:16<00:43,  2.35it/s]avg_loss = 1.7890625:  27%|██▋       | 38/141 [00:16<00:43,  2.35it/s]        avg_loss = 1.7890625:  28%|██▊       | 39/141 [00:16<00:43,  2.36it/s]avg_loss = 1.780859375:  28%|██▊       | 39/141 [00:17<00:43,  2.36it/s]avg_loss = 1.780859375:  28%|██▊       | 40/141 [00:17<00:42,  2.35it/s]avg_loss = 1.7852515243902438:  28%|██▊       | 40/141 [00:17<00:42,  2.35it/s]avg_loss = 1.7852515243902438:  29%|██▉       | 41/141 [00:17<00:42,  2.35it/s]avg_loss = 1.802641369047619:  29%|██▉       | 41/141 [00:17<00:42,  2.35it/s] avg_loss = 1.802641369047619:  30%|██▉       | 42/141 [00:17<00:42,  2.35it/s]avg_loss = 1.8192223837209303:  30%|██▉       | 42/141 [00:18<00:42,  2.35it/s]avg_loss = 1.8192223837209303:  30%|███       | 43/141 [00:18<00:41,  2.35it/s]avg_loss = 1.8219105113636365:  30%|███       | 43/141 [00:18<00:41,  2.35it/s]avg_loss = 1.8219105113636365:  31%|███       | 44/141 [00:18<00:41,  2.35it/s]avg_loss = 1.8262152777777778:  31%|███       | 44/141 [00:19<00:41,  2.35it/s]avg_loss = 1.8262152777777778:  32%|███▏      | 45/141 [00:19<00:40,  2.35it/s]avg_loss = 1.8316915760869565:  32%|███▏      | 45/141 [00:19<00:40,  2.35it/s]avg_loss = 1.8316915760869565:  33%|███▎      | 46/141 [00:19<00:40,  2.35it/s]avg_loss = 1.838597074468085:  33%|███▎      | 46/141 [00:20<00:40,  2.35it/s] avg_loss = 1.838597074468085:  33%|███▎      | 47/141 [00:20<00:39,  2.35it/s]avg_loss = 1.8419596354166667:  33%|███▎      | 47/141 [00:20<00:39,  2.35it/s]avg_loss = 1.8419596354166667:  34%|███▍      | 48/141 [00:20<00:39,  2.35it/s]avg_loss = 1.840561224489796:  34%|███▍      | 48/141 [00:20<00:39,  2.35it/s] avg_loss = 1.840561224489796:  35%|███▍      | 49/141 [00:20<00:39,  2.35it/s]avg_loss = 1.8403125:  35%|███▍      | 49/141 [00:21<00:39,  2.35it/s]        avg_loss = 1.8403125:  35%|███▌      | 50/141 [00:21<00:38,  2.35it/s]avg_loss = 1.8337928921568627:  35%|███▌      | 50/141 [00:21<00:38,  2.35it/s]avg_loss = 1.8337928921568627:  36%|███▌      | 51/141 [00:21<00:38,  2.35it/s]avg_loss = 1.8302283653846154:  36%|███▌      | 51/141 [00:22<00:38,  2.35it/s]avg_loss = 1.8302283653846154:  37%|███▋      | 52/141 [00:22<00:37,  2.35it/s]avg_loss = 1.8239976415094339:  37%|███▋      | 52/141 [00:22<00:37,  2.35it/s]avg_loss = 1.8239976415094339:  38%|███▊      | 53/141 [00:22<00:37,  2.35it/s]avg_loss = 1.8211805555555556:  38%|███▊      | 53/141 [00:23<00:37,  2.35it/s]avg_loss = 1.8211805555555556:  38%|███▊      | 54/141 [00:23<00:37,  2.35it/s]avg_loss = 1.8136363636363637:  38%|███▊      | 54/141 [00:23<00:37,  2.35it/s]avg_loss = 1.8136363636363637:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8059430803571428:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8059430803571428:  40%|███▉      | 56/141 [00:23<00:36,  2.35it/s]avg_loss = 1.7992050438596492:  40%|███▉      | 56/141 [00:24<00:36,  2.35it/s]avg_loss = 1.7992050438596492:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.7964709051724137:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.7964709051724137:  41%|████      | 58/141 [00:24<00:35,  2.35it/s]avg_loss = 1.7988612288135593:  41%|████      | 58/141 [00:25<00:35,  2.35it/s]avg_loss = 1.7988612288135593:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8048177083333334:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8048177083333334:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8108350409836065:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8108350409836065:  43%|████▎     | 61/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8181703629032258:  43%|████▎     | 61/141 [00:26<00:34,  2.35it/s]avg_loss = 1.8181703629032258:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8087797619047619:  44%|████▍     | 62/141 [00:26<00:33,  2.35it/s]avg_loss = 1.8087797619047619:  45%|████▍     | 63/141 [00:26<00:33,  2.34it/s]avg_loss = 1.8067626953125:  45%|████▍     | 63/141 [00:27<00:33,  2.34it/s]   avg_loss = 1.8067626953125:  45%|████▌     | 64/141 [00:27<00:32,  2.34it/s]avg_loss = 1.8040865384615385:  45%|████▌     | 64/141 [00:27<00:32,  2.34it/s]avg_loss = 1.8040865384615385:  46%|████▌     | 65/141 [00:27<00:32,  2.34it/s]avg_loss = 1.7980587121212122:  46%|████▌     | 65/141 [00:28<00:32,  2.34it/s]avg_loss = 1.7980587121212122:  47%|████▋     | 66/141 [00:28<00:32,  2.34it/s]avg_loss = 1.7954757462686568:  47%|████▋     | 66/141 [00:28<00:32,  2.34it/s]avg_loss = 1.7954757462686568:  48%|████▊     | 67/141 [00:28<00:31,  2.34it/s]avg_loss = 1.7920496323529411:  48%|████▊     | 67/141 [00:28<00:31,  2.34it/s]avg_loss = 1.7920496323529411:  48%|████▊     | 68/141 [00:28<00:31,  2.34it/s]avg_loss = 1.7891757246376812:  48%|████▊     | 68/141 [00:29<00:31,  2.34it/s]avg_loss = 1.7891757246376812:  49%|████▉     | 69/141 [00:29<00:30,  2.34it/s]avg_loss = 1.7900669642857143:  49%|████▉     | 69/141 [00:29<00:30,  2.34it/s]avg_loss = 1.7900669642857143:  50%|████▉     | 70/141 [00:29<00:30,  2.34it/s]avg_loss = 1.7939040492957747:  50%|████▉     | 70/141 [00:30<00:30,  2.34it/s]avg_loss = 1.7939040492957747:  50%|█████     | 71/141 [00:30<00:29,  2.34it/s]avg_loss = 1.7963324652777777:  50%|█████     | 71/141 [00:30<00:29,  2.34it/s]avg_loss = 1.7963324652777777:  51%|█████     | 72/141 [00:30<00:29,  2.34it/s]avg_loss = 1.7950556506849316:  51%|█████     | 72/141 [00:31<00:29,  2.34it/s]avg_loss = 1.7950556506849316:  52%|█████▏    | 73/141 [00:31<00:29,  2.34it/s]avg_loss = 1.7967694256756757:  52%|█████▏    | 73/141 [00:31<00:29,  2.34it/s]avg_loss = 1.7967694256756757:  52%|█████▏    | 74/141 [00:31<00:28,  2.35it/s]avg_loss = 1.7971875:  52%|█████▏    | 74/141 [00:31<00:28,  2.35it/s]         avg_loss = 1.7971875:  53%|█████▎    | 75/141 [00:31<00:28,  2.35it/s]avg_loss = 1.7962582236842106:  53%|█████▎    | 75/141 [00:32<00:28,  2.35it/s]avg_loss = 1.7962582236842106:  54%|█████▍    | 76/141 [00:32<00:27,  2.35it/s]avg_loss = 1.7974837662337662:  54%|█████▍    | 76/141 [00:32<00:27,  2.35it/s]avg_loss = 1.7974837662337662:  55%|█████▍    | 77/141 [00:32<00:27,  2.35it/s]avg_loss = 1.7999799679487178:  55%|█████▍    | 77/141 [00:33<00:27,  2.35it/s]avg_loss = 1.7999799679487178:  55%|█████▌    | 78/141 [00:33<00:26,  2.35it/s]avg_loss = 1.8042919303797469:  55%|█████▌    | 78/141 [00:33<00:26,  2.35it/s]avg_loss = 1.8042919303797469:  56%|█████▌    | 79/141 [00:33<00:26,  2.35it/s]avg_loss = 1.80166015625:  56%|█████▌    | 79/141 [00:34<00:26,  2.35it/s]     avg_loss = 1.80166015625:  57%|█████▋    | 80/141 [00:34<00:25,  2.35it/s]avg_loss = 1.800733024691358:  57%|█████▋    | 80/141 [00:34<00:25,  2.35it/s]avg_loss = 1.800733024691358:  57%|█████▋    | 81/141 [00:34<00:25,  2.35it/s]avg_loss = 1.8001143292682926:  57%|█████▋    | 81/141 [00:34<00:25,  2.35it/s]avg_loss = 1.8001143292682926:  58%|█████▊    | 82/141 [00:34<00:25,  2.35it/s]avg_loss = 1.7983810240963856:  58%|█████▊    | 82/141 [00:35<00:25,  2.35it/s]avg_loss = 1.7983810240963856:  59%|█████▉    | 83/141 [00:35<00:24,  2.35it/s]avg_loss = 1.7963169642857142:  59%|█████▉    | 83/141 [00:35<00:24,  2.35it/s]avg_loss = 1.7963169642857142:  60%|█████▉    | 84/141 [00:35<00:24,  2.35it/s]avg_loss = 1.7940257352941176:  60%|█████▉    | 84/141 [00:36<00:24,  2.35it/s]avg_loss = 1.7940257352941176:  60%|██████    | 85/141 [00:36<00:23,  2.35it/s]avg_loss = 1.7957848837209303:  60%|██████    | 85/141 [00:36<00:23,  2.35it/s]avg_loss = 1.7957848837209303:  61%|██████    | 86/141 [00:36<00:23,  2.35it/s]avg_loss = 1.7977729885057472:  61%|██████    | 86/141 [00:37<00:23,  2.35it/s]avg_loss = 1.7977729885057472:  62%|██████▏   | 87/141 [00:37<00:23,  2.35it/s]avg_loss = 1.7979403409090908:  62%|██████▏   | 87/141 [00:37<00:23,  2.35it/s]avg_loss = 1.7979403409090908:  62%|██████▏   | 88/141 [00:37<00:22,  2.35it/s]avg_loss = 1.8067064606741574:  62%|██████▏   | 88/141 [00:37<00:22,  2.35it/s]avg_loss = 1.8067064606741574:  63%|██████▎   | 89/141 [00:37<00:22,  2.35it/s]avg_loss = 1.8142361111111112:  63%|██████▎   | 89/141 [00:38<00:22,  2.35it/s]avg_loss = 1.8142361111111112:  64%|██████▍   | 90/141 [00:38<00:21,  2.35it/s]avg_loss = 1.8174793956043955:  64%|██████▍   | 90/141 [00:38<00:21,  2.35it/s]avg_loss = 1.8174793956043955:  65%|██████▍   | 91/141 [00:38<00:21,  2.35it/s]avg_loss = 1.8225203804347827:  65%|██████▍   | 91/141 [00:39<00:21,  2.35it/s]avg_loss = 1.8225203804347827:  65%|██████▌   | 92/141 [00:39<00:20,  2.34it/s]avg_loss = 1.8276209677419355:  65%|██████▌   | 92/141 [00:39<00:20,  2.34it/s]avg_loss = 1.8276209677419355:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8287898936170213:  66%|██████▌   | 93/141 [00:40<00:20,  2.35it/s]avg_loss = 1.8287898936170213:  67%|██████▋   | 94/141 [00:40<00:20,  2.34it/s]avg_loss = 1.8325657894736842:  67%|██████▋   | 94/141 [00:40<00:20,  2.34it/s]avg_loss = 1.8325657894736842:  67%|██████▋   | 95/141 [00:40<00:19,  2.34it/s]avg_loss = 1.8334147135416667:  67%|██████▋   | 95/141 [00:40<00:19,  2.34it/s]avg_loss = 1.8334147135416667:  68%|██████▊   | 96/141 [00:40<00:19,  2.34it/s]avg_loss = 1.8354542525773196:  68%|██████▊   | 96/141 [00:41<00:19,  2.34it/s]avg_loss = 1.8354542525773196:  69%|██████▉   | 97/141 [00:41<00:18,  2.34it/s]avg_loss = 1.8298788265306123:  69%|██████▉   | 97/141 [00:41<00:18,  2.34it/s]avg_loss = 1.8298788265306123:  70%|██████▉   | 98/141 [00:41<00:18,  2.34it/s]avg_loss = 1.8304924242424243:  70%|██████▉   | 98/141 [00:42<00:18,  2.34it/s]avg_loss = 1.8304924242424243:  70%|███████   | 99/141 [00:42<00:17,  2.34it/s]avg_loss = 1.83203125:  70%|███████   | 99/141 [00:42<00:17,  2.34it/s]        avg_loss = 1.83203125:  71%|███████   | 100/141 [00:42<00:17,  2.34it/s]avg_loss = 1.830368193069307:  71%|███████   | 100/141 [00:43<00:17,  2.34it/s]avg_loss = 1.830368193069307:  72%|███████▏  | 101/141 [00:43<00:17,  2.34it/s]avg_loss = 1.8303462009803921:  72%|███████▏  | 101/141 [00:43<00:17,  2.34it/s]avg_loss = 1.8303462009803921:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]avg_loss = 1.8277457524271845:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]avg_loss = 1.8277457524271845:  73%|███████▎  | 103/141 [00:43<00:16,  2.34it/s]avg_loss = 1.8297025240384615:  73%|███████▎  | 103/141 [00:44<00:16,  2.34it/s]avg_loss = 1.8297025240384615:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8272321428571427:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8272321428571427:  74%|███████▍  | 105/141 [00:44<00:15,  2.33it/s]avg_loss = 1.825619103773585:  74%|███████▍  | 105/141 [00:45<00:15,  2.33it/s] avg_loss = 1.825619103773585:  75%|███████▌  | 106/141 [00:45<00:14,  2.34it/s]avg_loss = 1.823160046728972:  75%|███████▌  | 106/141 [00:45<00:14,  2.34it/s]avg_loss = 1.823160046728972:  76%|███████▌  | 107/141 [00:45<00:14,  2.33it/s]avg_loss = 1.8206018518518519:  76%|███████▌  | 107/141 [00:46<00:14,  2.33it/s]avg_loss = 1.8206018518518519:  77%|███████▋  | 108/141 [00:46<00:14,  2.34it/s]avg_loss = 1.817803899082569:  77%|███████▋  | 108/141 [00:46<00:14,  2.34it/s] avg_loss = 1.817803899082569:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8153409090909092:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8153409090909092:  78%|███████▊  | 110/141 [00:46<00:13,  2.33it/s]avg_loss = 1.8178490990990992:  78%|███████▊  | 110/141 [00:47<00:13,  2.33it/s]avg_loss = 1.8178490990990992:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8176618303571428:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8176618303571428:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s]avg_loss = 1.818929756637168:  79%|███████▉  | 112/141 [00:48<00:12,  2.34it/s] avg_loss = 1.818929756637168:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8199698464912282:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8199698464912282:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.819429347826087:  81%|████████  | 114/141 [00:49<00:11,  2.34it/s] avg_loss = 1.819429347826087:  82%|████████▏ | 115/141 [00:49<00:11,  2.34it/s]avg_loss = 1.8178879310344827:  82%|████████▏ | 115/141 [00:49<00:11,  2.34it/s]avg_loss = 1.8178879310344827:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8199786324786325:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8199786324786325:  83%|████████▎ | 117/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8197828389830508:  83%|████████▎ | 117/141 [00:50<00:10,  2.34it/s]avg_loss = 1.8197828389830508:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8184742647058822:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8184742647058822:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]avg_loss = 1.816796875:  84%|████████▍ | 119/141 [00:51<00:09,  2.34it/s]       avg_loss = 1.816796875:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8166322314049588:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8166322314049588:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8169185450819672:  86%|████████▌ | 121/141 [00:52<00:08,  2.34it/s]avg_loss = 1.8169185450819672:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 1.8168826219512195:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 1.8168826219512195:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8172253024193548:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.8172253024193548:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]avg_loss = 1.816125:  88%|████████▊ | 124/141 [00:53<00:07,  2.34it/s]          avg_loss = 1.816125:  89%|████████▊ | 125/141 [00:53<00:06,  2.33it/s]avg_loss = 1.8166542658730158:  89%|████████▊ | 125/141 [00:53<00:06,  2.33it/s]avg_loss = 1.8166542658730158:  89%|████████▉ | 126/141 [00:53<00:06,  2.33it/s]avg_loss = 1.8164985236220472:  89%|████████▉ | 126/141 [00:54<00:06,  2.33it/s]avg_loss = 1.8164985236220472:  90%|█████████ | 127/141 [00:54<00:06,  2.33it/s]avg_loss = 1.81512451171875:  90%|█████████ | 127/141 [00:54<00:06,  2.33it/s]  avg_loss = 1.81512451171875:  91%|█████████ | 128/141 [00:54<00:05,  2.33it/s]avg_loss = 1.815406976744186:  91%|█████████ | 128/141 [00:55<00:05,  2.33it/s]avg_loss = 1.815406976744186:  91%|█████████▏| 129/141 [00:55<00:05,  2.33it/s]avg_loss = 1.8161057692307692:  91%|█████████▏| 129/141 [00:55<00:05,  2.33it/s]avg_loss = 1.8161057692307692:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 1.8170920801526718:  92%|█████████▏| 130/141 [00:55<00:04,  2.33it/s]avg_loss = 1.8170920801526718:  93%|█████████▎| 131/141 [00:55<00:04,  2.33it/s]avg_loss = 1.817767518939394:  93%|█████████▎| 131/141 [00:56<00:04,  2.33it/s] avg_loss = 1.817767518939394:  94%|█████████▎| 132/141 [00:56<00:03,  2.33it/s]avg_loss = 1.8150258458646618:  94%|█████████▎| 132/141 [00:56<00:03,  2.33it/s]avg_loss = 1.8150258458646618:  94%|█████████▍| 133/141 [00:56<00:03,  2.33it/s]avg_loss = 1.8108092350746268:  94%|█████████▍| 133/141 [00:57<00:03,  2.33it/s]avg_loss = 1.8108092350746268:  95%|█████████▌| 134/141 [00:57<00:03,  2.33it/s]avg_loss = 1.8133680555555556:  95%|█████████▌| 134/141 [00:57<00:03,  2.33it/s]avg_loss = 1.8133680555555556:  96%|█████████▌| 135/141 [00:57<00:02,  2.33it/s]avg_loss = 1.8169232536764706:  96%|█████████▌| 135/141 [00:58<00:02,  2.33it/s]avg_loss = 1.8169232536764706:  96%|█████████▋| 136/141 [00:58<00:02,  2.33it/s]avg_loss = 1.8177463503649636:  96%|█████████▋| 136/141 [00:58<00:02,  2.33it/s]avg_loss = 1.8177463503649636:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]avg_loss = 1.81640625:  97%|█████████▋| 137/141 [00:58<00:01,  2.33it/s]        avg_loss = 1.81640625:  98%|█████████▊| 138/141 [00:58<00:01,  2.33it/s]avg_loss = 1.816546762589928:  98%|█████████▊| 138/141 [00:59<00:01,  2.33it/s]avg_loss = 1.816546762589928:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8170200892857142:  99%|█████████▊| 139/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8170200892857142:  99%|█████████▉| 140/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8183178191489362:  99%|█████████▉| 140/141 [01:00<00:00,  2.33it/s]avg_loss = 1.8183178191489362: 100%|██████████| 141/141 [01:00<00:00,  2.33it/s]avg_loss = 1.8183178191489362: 100%|██████████| 141/141 [01:00<00:00,  2.34it/s]
I0303 08:51:49.101977 3113022 eval_ppl.py:105] wikitext2 perplexity: 6.161484718322754
wikitext2 perplexity: 6.161
Running with lmbda=100000
/home/jgryu/Weight_compression/comp_llm/matmul_had.py:96: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("quip_lib::hadamard")
/home/jgryu/miniconda3/envs/nic/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  9.17it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  9.03it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.23it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.36it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.70it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.60it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.14it/s]
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:12,  2.47it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:12,  2.48it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:11,  2.46it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:11,  2.46it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:10,  2.47it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:10,  2.48it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:10,  2.47it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:10,  2.28it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:10,  2.16it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:10,  2.14it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:09,  2.17it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:08,  2.27it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.38it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.47it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:06,  2.54it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.29it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:07,  2.01it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:08<00:07,  1.86it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:07,  1.83it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:09<00:06,  1.80it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:09<00:06,  1.71it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:10<00:05,  1.68it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:11<00:05,  1.64it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:11<00:04,  1.69it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:12<00:04,  1.75it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:12<00:03,  1.73it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:13<00:02,  1.73it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:13<00:02,  1.81it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:14<00:01,  1.86it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:14<00:01,  1.91it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:15<00:00,  1.89it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  1.84it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  2.00it/s]
pseudo compress quantization...:   0%|          | 0/32 [00:00<?, ?it/s]2025-03-03 08:52:34 - INFO - layer0_self_attn.q_proj | mse: 0.009262572252459174, bpp_loss: 6.546601858688518, bpp: 0
2025-03-03 08:52:42 - INFO - layer0_self_attn.k_proj | mse: 0.018334746521685253, bpp_loss: 7.350394787150435, bpp: 0
2025-03-03 08:52:50 - INFO - layer0_self_attn.v_proj | mse: 0.0008866421417179016, bpp_loss: 5.651169508113526, bpp: 0
2025-03-03 08:52:59 - INFO - layer0_self_attn.o_proj | mse: 0.0004880261042762371, bpp_loss: 5.724975360906683, bpp: 0
2025-03-03 08:53:10 - INFO - layer0_mlp.gate_proj | mse: 0.00052464302810247, bpp_loss: 6.115788885259202, bpp: 0
2025-03-03 08:53:21 - INFO - layer0_mlp.up_proj | mse: 0.0005021725312751668, bpp_loss: 6.0063159541626066, bpp: 0
2025-03-03 08:54:00 - INFO - layer0_mlp.down_proj | mse: 0.0005000956621502349, bpp_loss: 6.00249843432435, bpp: 0
pseudo compress quantization...:   3%|▎         | 1/32 [01:34<48:58, 94.80s/it]2025-03-03 08:54:09 - INFO - layer1_self_attn.q_proj | mse: 0.001272427177619136, bpp_loss: 6.865789854200557, bpp: 0
2025-03-03 08:54:18 - INFO - layer1_self_attn.k_proj | mse: 0.0023133362929688085, bpp_loss: 7.9044961598701775, bpp: 0
2025-03-03 08:54:26 - INFO - layer1_self_attn.v_proj | mse: 0.0006246241058090502, bpp_loss: 5.751865159720182, bpp: 0
2025-03-03 08:54:35 - INFO - layer1_self_attn.o_proj | mse: 0.000603888614150249, bpp_loss: 5.808644197881222, bpp: 0
2025-03-03 08:54:46 - INFO - layer1_mlp.gate_proj | mse: 0.0005386529707699881, bpp_loss: 6.131123400426337, bpp: 0
2025-03-03 08:54:57 - INFO - layer1_mlp.up_proj | mse: 0.0005141196244344733, bpp_loss: 6.02161710416632, bpp: 0
2025-03-03 08:55:35 - INFO - layer1_mlp.down_proj | mse: 0.0006638963631486398, bpp_loss: 6.017918087708365, bpp: 0
pseudo compress quantization...:   6%|▋         | 2/32 [03:09<47:28, 94.96s/it]2025-03-03 08:55:44 - INFO - layer2_self_attn.q_proj | mse: 0.0008437310566455041, bpp_loss: 6.76071013242472, bpp: 0
2025-03-03 08:55:53 - INFO - layer2_self_attn.k_proj | mse: 0.0014341727761115579, bpp_loss: 7.944853188935667, bpp: 0
2025-03-03 08:56:01 - INFO - layer2_self_attn.v_proj | mse: 0.0004764098688982413, bpp_loss: 5.658620678354055, bpp: 0
2025-03-03 08:56:10 - INFO - layer2_self_attn.o_proj | mse: 0.00045670522646499976, bpp_loss: 5.753747253795154, bpp: 0
2025-03-03 08:56:21 - INFO - layer2_mlp.gate_proj | mse: 0.000517644549248041, bpp_loss: 6.166677790161755, bpp: 0
2025-03-03 08:56:32 - INFO - layer2_mlp.up_proj | mse: 0.00048382142205011724, bpp_loss: 6.016723068830158, bpp: 0
2025-03-03 08:57:10 - INFO - layer2_mlp.down_proj | mse: 0.000468248576649243, bpp_loss: 6.020065012920115, bpp: 0
pseudo compress quantization...:   9%|▉         | 3/32 [04:45<45:56, 95.06s/it]2025-03-03 08:57:19 - INFO - layer3_self_attn.q_proj | mse: 0.0007013362539962303, bpp_loss: 6.790894740028307, bpp: 0
2025-03-03 08:57:28 - INFO - layer3_self_attn.k_proj | mse: 0.0010493584305362753, bpp_loss: 8.020238445489667, bpp: 0
2025-03-03 08:57:36 - INFO - layer3_self_attn.v_proj | mse: 0.00043313104048467454, bpp_loss: 5.751971239456907, bpp: 0
2025-03-03 08:57:45 - INFO - layer3_self_attn.o_proj | mse: 0.0004884445911286632, bpp_loss: 5.850916618364863, bpp: 0
2025-03-03 08:57:56 - INFO - layer3_mlp.gate_proj | mse: 0.0005350750197308175, bpp_loss: 6.247838244640401, bpp: 0
2025-03-03 08:58:08 - INFO - layer3_mlp.up_proj | mse: 0.0004801672167118846, bpp_loss: 5.997050867016826, bpp: 0
2025-03-03 08:58:46 - INFO - layer3_mlp.down_proj | mse: 0.0004573990487605625, bpp_loss: 5.994994031764301, bpp: 0
pseudo compress quantization...:  12%|█▎        | 4/32 [06:21<44:36, 95.60s/it]2025-03-03 08:58:56 - INFO - layer4_self_attn.q_proj | mse: 0.0007085256272628299, bpp_loss: 6.7546471047680825, bpp: 0
2025-03-03 08:59:04 - INFO - layer4_self_attn.k_proj | mse: 0.0011128811586976267, bpp_loss: 7.96695132937748, bpp: 0
2025-03-03 08:59:13 - INFO - layer4_self_attn.v_proj | mse: 0.0004494264975416463, bpp_loss: 5.800642129732296, bpp: 0
2025-03-03 08:59:22 - INFO - layer4_self_attn.o_proj | mse: 0.0005204508911053343, bpp_loss: 5.866944071021862, bpp: 0
2025-03-03 08:59:33 - INFO - layer4_mlp.gate_proj | mse: 0.0005530470302424835, bpp_loss: 6.327987061148243, bpp: 0
2025-03-03 08:59:44 - INFO - layer4_mlp.up_proj | mse: 0.0004719628438878903, bpp_loss: 5.9708066425685375, bpp: 0
2025-03-03 09:00:23 - INFO - layer4_mlp.down_proj | mse: 0.0004613096423661983, bpp_loss: 5.969130856550431, bpp: 0
pseudo compress quantization...:  16%|█▌        | 5/32 [07:57<43:09, 95.89s/it]2025-03-03 09:00:32 - INFO - layer5_self_attn.q_proj | mse: 0.0007110783291631935, bpp_loss: 6.731290851603262, bpp: 0
2025-03-03 09:00:41 - INFO - layer5_self_attn.k_proj | mse: 0.0011677089567820281, bpp_loss: 7.935025255894288, bpp: 0
2025-03-03 09:00:49 - INFO - layer5_self_attn.v_proj | mse: 0.00043310451443864735, bpp_loss: 5.688466726569459, bpp: 0
2025-03-03 09:00:58 - INFO - layer5_self_attn.o_proj | mse: 0.0005221248385150384, bpp_loss: 5.807579953223467, bpp: 0
2025-03-03 09:01:09 - INFO - layer5_mlp.gate_proj | mse: 0.0005484597185323483, bpp_loss: 6.328378781809339, bpp: 0
2025-03-03 09:01:20 - INFO - layer5_mlp.up_proj | mse: 0.00046902100062434283, bpp_loss: 5.976740445542548, bpp: 0
2025-03-03 09:01:59 - INFO - layer5_mlp.down_proj | mse: 0.00046505862238277685, bpp_loss: 5.973787025581779, bpp: 0
pseudo compress quantization...:  19%|█▉        | 6/32 [09:33<41:35, 95.97s/it]2025-03-03 09:02:08 - INFO - layer6_self_attn.q_proj | mse: 0.0006939191007576017, bpp_loss: 6.784812337369658, bpp: 0
2025-03-03 09:02:17 - INFO - layer6_self_attn.k_proj | mse: 0.0010517702184754054, bpp_loss: 7.993188335094601, bpp: 0
2025-03-03 09:02:25 - INFO - layer6_self_attn.v_proj | mse: 0.0004280353689363293, bpp_loss: 5.735206768382341, bpp: 0
2025-03-03 09:02:34 - INFO - layer6_self_attn.o_proj | mse: 0.0005351685916191681, bpp_loss: 5.840540379285812, bpp: 0
2025-03-03 09:02:46 - INFO - layer6_mlp.gate_proj | mse: 0.000549746522762248, bpp_loss: 6.336086408368179, bpp: 0
2025-03-03 09:02:57 - INFO - layer6_mlp.up_proj | mse: 0.00046864350563095305, bpp_loss: 5.976499062430646, bpp: 0
2025-03-03 09:03:35 - INFO - layer6_mlp.down_proj | mse: 0.00047019244048049184, bpp_loss: 5.973065369496388, bpp: 0
pseudo compress quantization...:  22%|██▏       | 7/32 [11:10<40:00, 96.02s/it]2025-03-03 09:03:44 - INFO - layer7_self_attn.q_proj | mse: 0.000666640231058915, bpp_loss: 6.691637742915191, bpp: 0
2025-03-03 09:03:53 - INFO - layer7_self_attn.k_proj | mse: 0.001027771117829453, bpp_loss: 8.02988836041186, bpp: 0
2025-03-03 09:04:01 - INFO - layer7_self_attn.v_proj | mse: 0.000432021427914256, bpp_loss: 5.730612811516039, bpp: 0
2025-03-03 09:04:10 - INFO - layer7_self_attn.o_proj | mse: 0.0005469023835526804, bpp_loss: 5.853502115583979, bpp: 0
2025-03-03 09:04:21 - INFO - layer7_mlp.gate_proj | mse: 0.0005452916472838627, bpp_loss: 6.3067138902843, bpp: 0
2025-03-03 09:04:33 - INFO - layer7_mlp.up_proj | mse: 0.0004724838459542777, bpp_loss: 5.9904020849083155, bpp: 0
2025-03-03 09:05:11 - INFO - layer7_mlp.down_proj | mse: 0.0004737269876140225, bpp_loss: 5.987151603746627, bpp: 0
pseudo compress quantization...:  25%|██▌       | 8/32 [12:45<38:23, 95.97s/it]2025-03-03 09:05:20 - INFO - layer8_self_attn.q_proj | mse: 0.0006819605616935003, bpp_loss: 6.682281114044599, bpp: 0
2025-03-03 09:05:29 - INFO - layer8_self_attn.k_proj | mse: 0.0010865805387953466, bpp_loss: 7.928701969212852, bpp: 0
2025-03-03 09:05:37 - INFO - layer8_self_attn.v_proj | mse: 0.00044096740483637163, bpp_loss: 5.757047706283629, bpp: 0
2025-03-03 09:05:46 - INFO - layer8_self_attn.o_proj | mse: 0.0005832134171899261, bpp_loss: 5.867235827608965, bpp: 0
2025-03-03 09:05:58 - INFO - layer8_mlp.gate_proj | mse: 0.000543492376916575, bpp_loss: 6.314145205409399, bpp: 0
2025-03-03 09:06:09 - INFO - layer8_mlp.up_proj | mse: 0.0004682662175691753, bpp_loss: 5.9858073983341455, bpp: 0
2025-03-03 09:06:48 - INFO - layer8_mlp.down_proj | mse: 0.0004754956321027181, bpp_loss: 5.983961796886953, bpp: 0
pseudo compress quantization...:  28%|██▊       | 9/32 [14:22<36:53, 96.22s/it]2025-03-03 09:06:57 - INFO - layer9_self_attn.q_proj | mse: 0.0006761142845219069, bpp_loss: 6.690290175029077, bpp: 0
2025-03-03 09:07:06 - INFO - layer9_self_attn.k_proj | mse: 0.001066312647913783, bpp_loss: 7.950135454419069, bpp: 0
2025-03-03 09:07:14 - INFO - layer9_self_attn.v_proj | mse: 0.0004584498345536262, bpp_loss: 5.8598753466503695, bpp: 0
2025-03-03 09:07:23 - INFO - layer9_self_attn.o_proj | mse: 0.000605995578891517, bpp_loss: 5.924447918776423, bpp: 0
2025-03-03 09:07:34 - INFO - layer9_mlp.gate_proj | mse: 0.0005474808285412668, bpp_loss: 6.332005354442766, bpp: 0
2025-03-03 09:07:46 - INFO - layer9_mlp.up_proj | mse: 0.00046984184659667615, bpp_loss: 5.995145225764385, bpp: 0
2025-03-03 09:08:24 - INFO - layer9_mlp.down_proj | mse: 0.0004790806188167002, bpp_loss: 5.98728980676138, bpp: 0
pseudo compress quantization...:  31%|███▏      | 10/32 [15:58<35:15, 96.17s/it]2025-03-03 09:08:33 - INFO - layer10_self_attn.q_proj | mse: 0.0006908951767767886, bpp_loss: 6.710157980793156, bpp: 0
2025-03-03 09:08:42 - INFO - layer10_self_attn.k_proj | mse: 0.0011251011558536276, bpp_loss: 7.965706171351485, bpp: 0
2025-03-03 09:08:50 - INFO - layer10_self_attn.v_proj | mse: 0.00044101887260827085, bpp_loss: 5.748466418939643, bpp: 0
2025-03-03 09:08:59 - INFO - layer10_self_attn.o_proj | mse: 0.0005593218239830773, bpp_loss: 5.857826666091569, bpp: 0
2025-03-03 09:09:10 - INFO - layer10_mlp.gate_proj | mse: 0.0005393993730948652, bpp_loss: 6.295577681756446, bpp: 0
2025-03-03 09:09:21 - INFO - layer10_mlp.up_proj | mse: 0.00047378161755961927, bpp_loss: 6.011691331065127, bpp: 0
2025-03-03 09:10:00 - INFO - layer10_mlp.down_proj | mse: 0.0004808757505517458, bpp_loss: 6.002258581375437, bpp: 0
pseudo compress quantization...:  34%|███▍      | 11/32 [17:34<33:37, 96.08s/it]2025-03-03 09:10:09 - INFO - layer11_self_attn.q_proj | mse: 0.000650882990191813, bpp_loss: 6.622653650934808, bpp: 0
2025-03-03 09:10:18 - INFO - layer11_self_attn.k_proj | mse: 0.0010437356330391466, bpp_loss: 7.950429716147482, bpp: 0
2025-03-03 09:10:26 - INFO - layer11_self_attn.v_proj | mse: 0.00043551743403503134, bpp_loss: 5.746579430997372, bpp: 0
2025-03-03 09:10:35 - INFO - layer11_self_attn.o_proj | mse: 0.0005508607848273262, bpp_loss: 5.876496451091953, bpp: 0
2025-03-03 09:10:46 - INFO - layer11_mlp.gate_proj | mse: 0.0005359458914203783, bpp_loss: 6.275774076581001, bpp: 0
2025-03-03 09:10:57 - INFO - layer11_mlp.up_proj | mse: 0.00047567390368655, bpp_loss: 6.018505837369178, bpp: 0
2025-03-03 09:11:35 - INFO - layer11_mlp.down_proj | mse: 0.00048250880310160685, bpp_loss: 6.009905379930777, bpp: 0
pseudo compress quantization...:  38%|███▊      | 12/32 [19:10<31:59, 96.00s/it]2025-03-03 09:11:45 - INFO - layer12_self_attn.q_proj | mse: 0.0006682932201762802, bpp_loss: 6.6729218430118635, bpp: 0
2025-03-03 09:11:53 - INFO - layer12_self_attn.k_proj | mse: 0.000998983024750914, bpp_loss: 7.909415588364936, bpp: 0
2025-03-03 09:12:02 - INFO - layer12_self_attn.v_proj | mse: 0.00046155184288494607, bpp_loss: 5.864058144856244, bpp: 0
2025-03-03 09:12:11 - INFO - layer12_self_attn.o_proj | mse: 0.0005751927737710331, bpp_loss: 5.926001599873416, bpp: 0
2025-03-03 09:12:22 - INFO - layer12_mlp.gate_proj | mse: 0.0005361363719693246, bpp_loss: 6.258042283090098, bpp: 0
2025-03-03 09:12:33 - INFO - layer12_mlp.up_proj | mse: 0.0004831171820412073, bpp_loss: 6.039115330204368, bpp: 0
2025-03-03 09:13:11 - INFO - layer12_mlp.down_proj | mse: 0.0004921762341561147, bpp_loss: 6.025495128805882, bpp: 0
pseudo compress quantization...:  41%|████      | 13/32 [20:46<30:23, 95.97s/it]2025-03-03 09:13:20 - INFO - layer13_self_attn.q_proj | mse: 0.0006853284642131545, bpp_loss: 6.662138044135645, bpp: 0
2025-03-03 09:13:29 - INFO - layer13_self_attn.k_proj | mse: 0.001200348667956752, bpp_loss: 7.97721954039298, bpp: 0
2025-03-03 09:13:37 - INFO - layer13_self_attn.v_proj | mse: 0.00046413623118841393, bpp_loss: 5.80451330402866, bpp: 0
2025-03-03 09:13:46 - INFO - layer13_self_attn.o_proj | mse: 0.0005838186274892161, bpp_loss: 5.903707858524285, bpp: 0
2025-03-03 09:13:57 - INFO - layer13_mlp.gate_proj | mse: 0.0005429638218463456, bpp_loss: 6.2608544783932825, bpp: 0
2025-03-03 09:14:09 - INFO - layer13_mlp.up_proj | mse: 0.0004895765005802865, bpp_loss: 6.042499226118837, bpp: 0
2025-03-03 09:14:47 - INFO - layer13_mlp.down_proj | mse: 0.0004948761226322038, bpp_loss: 6.025827844726986, bpp: 0
pseudo compress quantization...:  44%|████▍     | 14/32 [22:22<28:45, 95.88s/it]2025-03-03 09:14:56 - INFO - layer14_self_attn.q_proj | mse: 0.0006837884597560007, bpp_loss: 6.625018360209651, bpp: 0
2025-03-03 09:15:05 - INFO - layer14_self_attn.k_proj | mse: 0.0012328706867770888, bpp_loss: 7.913333163247444, bpp: 0
2025-03-03 09:15:13 - INFO - layer14_self_attn.v_proj | mse: 0.0004652013922619063, bpp_loss: 5.795411378610879, bpp: 0
2025-03-03 09:15:22 - INFO - layer14_self_attn.o_proj | mse: 0.0005799162658817746, bpp_loss: 5.899187018396333, bpp: 0
2025-03-03 09:15:33 - INFO - layer14_mlp.gate_proj | mse: 0.0005502365368197222, bpp_loss: 6.296815014577338, bpp: 0
2025-03-03 09:15:45 - INFO - layer14_mlp.up_proj | mse: 0.00048805348391516424, bpp_loss: 6.038039366182472, bpp: 0
2025-03-03 09:16:23 - INFO - layer14_mlp.down_proj | mse: 0.0004921987897018345, bpp_loss: 6.023310361995494, bpp: 0
pseudo compress quantization...:  47%|████▋     | 15/32 [23:57<27:10, 95.89s/it]2025-03-03 09:16:32 - INFO - layer15_self_attn.q_proj | mse: 0.0007372110563953116, bpp_loss: 6.805396001087502, bpp: 0
2025-03-03 09:16:41 - INFO - layer15_self_attn.k_proj | mse: 0.0011312057677431006, bpp_loss: 7.932111878413707, bpp: 0
2025-03-03 09:16:49 - INFO - layer15_self_attn.v_proj | mse: 0.00047174553982872434, bpp_loss: 5.856979769072495, bpp: 0
2025-03-03 09:16:58 - INFO - layer15_self_attn.o_proj | mse: 0.000548303963694559, bpp_loss: 5.9286252236925066, bpp: 0
2025-03-03 09:17:09 - INFO - layer15_mlp.gate_proj | mse: 0.0005634746763069767, bpp_loss: 6.335375205613673, bpp: 0
2025-03-03 09:17:20 - INFO - layer15_mlp.up_proj | mse: 0.0004893296311670403, bpp_loss: 6.029270551965705, bpp: 0
2025-03-03 09:17:59 - INFO - layer15_mlp.down_proj | mse: 0.0004929396048731848, bpp_loss: 6.017614410724491, bpp: 0
pseudo compress quantization...:  50%|█████     | 16/32 [25:33<25:33, 95.87s/it]2025-03-03 09:18:08 - INFO - layer16_self_attn.q_proj | mse: 0.0007425427916467831, bpp_loss: 6.757863275357522, bpp: 0
2025-03-03 09:18:17 - INFO - layer16_self_attn.k_proj | mse: 0.00128271086394773, bpp_loss: 7.937176164938137, bpp: 0
2025-03-03 09:18:25 - INFO - layer16_self_attn.v_proj | mse: 0.000479921175025087, bpp_loss: 5.810121577233076, bpp: 0
2025-03-03 09:18:34 - INFO - layer16_self_attn.o_proj | mse: 0.0005771657502934605, bpp_loss: 5.909020533785224, bpp: 0
2025-03-03 09:18:45 - INFO - layer16_mlp.gate_proj | mse: 0.0005660540271190123, bpp_loss: 6.372613688265639, bpp: 0
2025-03-03 09:18:56 - INFO - layer16_mlp.up_proj | mse: 0.0004819331710896227, bpp_loss: 6.0147182966715524, bpp: 0
2025-03-03 09:19:34 - INFO - layer16_mlp.down_proj | mse: 0.0004803377800931654, bpp_loss: 6.003687084619222, bpp: 0
pseudo compress quantization...:  53%|█████▎    | 17/32 [27:09<23:57, 95.82s/it]2025-03-03 09:19:44 - INFO - layer17_self_attn.q_proj | mse: 0.0007126219096572691, bpp_loss: 6.777178151765838, bpp: 0
2025-03-03 09:19:52 - INFO - layer17_self_attn.k_proj | mse: 0.0012210279388831882, bpp_loss: 7.9681003130972385, bpp: 0
2025-03-03 09:20:01 - INFO - layer17_self_attn.v_proj | mse: 0.00047230910514107745, bpp_loss: 5.885728869703598, bpp: 0
2025-03-03 09:20:09 - INFO - layer17_self_attn.o_proj | mse: 0.0005367210443061128, bpp_loss: 5.93881530535873, bpp: 0
2025-03-03 09:20:21 - INFO - layer17_mlp.gate_proj | mse: 0.0005705351829121355, bpp_loss: 6.389277804376824, bpp: 0
2025-03-03 09:20:32 - INFO - layer17_mlp.up_proj | mse: 0.00048127812907149174, bpp_loss: 6.0104717787887365, bpp: 0
2025-03-03 09:21:10 - INFO - layer17_mlp.down_proj | mse: 0.0004798745119465564, bpp_loss: 6.001818149816245, bpp: 0
pseudo compress quantization...:  56%|█████▋    | 18/32 [28:44<22:19, 95.70s/it]2025-03-03 09:21:19 - INFO - layer18_self_attn.q_proj | mse: 0.0007128315831132385, bpp_loss: 6.760634293197654, bpp: 0
2025-03-03 09:21:28 - INFO - layer18_self_attn.k_proj | mse: 0.0012291735172628919, bpp_loss: 8.076229629688896, bpp: 0
2025-03-03 09:21:36 - INFO - layer18_self_attn.v_proj | mse: 0.0004543005453334228, bpp_loss: 5.804199472535402, bpp: 0
2025-03-03 09:21:45 - INFO - layer18_self_attn.o_proj | mse: 0.0005250548349437927, bpp_loss: 5.917132000206038, bpp: 0
2025-03-03 09:21:56 - INFO - layer18_mlp.gate_proj | mse: 0.0005660872913756588, bpp_loss: 6.393546686108623, bpp: 0
2025-03-03 09:22:07 - INFO - layer18_mlp.up_proj | mse: 0.00047509459863845084, bpp_loss: 6.005224137966122, bpp: 0
2025-03-03 09:22:45 - INFO - layer18_mlp.down_proj | mse: 0.00046989890798871525, bpp_loss: 5.999075812686767, bpp: 0
pseudo compress quantization...:  59%|█████▉    | 19/32 [30:20<20:41, 95.51s/it]2025-03-03 09:22:54 - INFO - layer19_self_attn.q_proj | mse: 0.0006997642010056511, bpp_loss: 6.762118592741899, bpp: 0
2025-03-03 09:23:03 - INFO - layer19_self_attn.k_proj | mse: 0.0011399034137974595, bpp_loss: 7.928065803251229, bpp: 0
2025-03-03 09:23:11 - INFO - layer19_self_attn.v_proj | mse: 0.000455463255262186, bpp_loss: 5.846998555352911, bpp: 0
2025-03-03 09:23:20 - INFO - layer19_self_attn.o_proj | mse: 0.0005071905388028424, bpp_loss: 5.930218271445483, bpp: 0
2025-03-03 09:23:31 - INFO - layer19_mlp.gate_proj | mse: 0.0005637131649899323, bpp_loss: 6.404451296531728, bpp: 0
2025-03-03 09:23:42 - INFO - layer19_mlp.up_proj | mse: 0.00047016124553996637, bpp_loss: 6.001105597774897, bpp: 0
2025-03-03 09:24:20 - INFO - layer19_mlp.down_proj | mse: 0.00046590973210338115, bpp_loss: 5.996768034362633, bpp: 0
pseudo compress quantization...:  62%|██████▎   | 20/32 [31:54<19:04, 95.34s/it]2025-03-03 09:24:29 - INFO - layer20_self_attn.q_proj | mse: 0.0006958515186840557, bpp_loss: 6.73091220355127, bpp: 0
2025-03-03 09:24:38 - INFO - layer20_self_attn.k_proj | mse: 0.001169898577769108, bpp_loss: 7.858897822559811, bpp: 0
2025-03-03 09:24:46 - INFO - layer20_self_attn.v_proj | mse: 0.000466300095656399, bpp_loss: 5.886991587118246, bpp: 0
2025-03-03 09:24:55 - INFO - layer20_self_attn.o_proj | mse: 0.0005069384508330035, bpp_loss: 5.920006409636699, bpp: 0
2025-03-03 09:25:06 - INFO - layer20_mlp.gate_proj | mse: 0.0005633968700208237, bpp_loss: 6.404781384393573, bpp: 0
2025-03-03 09:25:17 - INFO - layer20_mlp.up_proj | mse: 0.0004701779035347412, bpp_loss: 6.004629037609058, bpp: 0
2025-03-03 09:25:55 - INFO - layer20_mlp.down_proj | mse: 0.0004645185826080754, bpp_loss: 6.000700092042929, bpp: 0
pseudo compress quantization...:  66%|██████▌   | 21/32 [33:30<17:28, 95.28s/it]2025-03-03 09:26:04 - INFO - layer21_self_attn.q_proj | mse: 0.0006872717007829541, bpp_loss: 6.718692808412015, bpp: 0
2025-03-03 09:26:13 - INFO - layer21_self_attn.k_proj | mse: 0.0011377562525905394, bpp_loss: 7.911137884249911, bpp: 0
2025-03-03 09:26:21 - INFO - layer21_self_attn.v_proj | mse: 0.0004691276997368365, bpp_loss: 5.914336276007816, bpp: 0
2025-03-03 09:26:30 - INFO - layer21_self_attn.o_proj | mse: 0.0005455631803586269, bpp_loss: 5.9414148991927505, bpp: 0
2025-03-03 09:26:41 - INFO - layer21_mlp.gate_proj | mse: 0.0005688234446167699, bpp_loss: 6.417727527341673, bpp: 0
2025-03-03 09:26:52 - INFO - layer21_mlp.up_proj | mse: 0.0004727879319582719, bpp_loss: 6.007655890392406, bpp: 0
2025-03-03 09:27:30 - INFO - layer21_mlp.down_proj | mse: 0.0004713938336874936, bpp_loss: 6.003461260049205, bpp: 0
pseudo compress quantization...:  69%|██████▉   | 22/32 [35:05<15:52, 95.27s/it]2025-03-03 09:27:40 - INFO - layer22_self_attn.q_proj | mse: 0.0006867108967143001, bpp_loss: 6.670909332577139, bpp: 0
2025-03-03 09:27:48 - INFO - layer22_self_attn.k_proj | mse: 0.0011661412946215933, bpp_loss: 7.823080730740912, bpp: 0
2025-03-03 09:27:56 - INFO - layer22_self_attn.v_proj | mse: 0.0004864617918212734, bpp_loss: 5.964814726263285, bpp: 0
2025-03-03 09:28:05 - INFO - layer22_self_attn.o_proj | mse: 0.0005268410880193561, bpp_loss: 5.961651912308298, bpp: 0
2025-03-03 09:28:16 - INFO - layer22_mlp.gate_proj | mse: 0.0005698632242347146, bpp_loss: 6.41876910839762, bpp: 0
2025-03-03 09:28:28 - INFO - layer22_mlp.up_proj | mse: 0.0004742742182622447, bpp_loss: 6.011173740694566, bpp: 0
2025-03-03 09:29:05 - INFO - layer22_mlp.down_proj | mse: 0.0004676742896927375, bpp_loss: 6.007262842696426, bpp: 0
pseudo compress quantization...:  72%|███████▏  | 23/32 [36:40<14:17, 95.26s/it]2025-03-03 09:29:15 - INFO - layer23_self_attn.q_proj | mse: 0.0006789529335771409, bpp_loss: 6.679084669565782, bpp: 0
2025-03-03 09:29:23 - INFO - layer23_self_attn.k_proj | mse: 0.001115459979247406, bpp_loss: 7.817920189816505, bpp: 0
2025-03-03 09:29:31 - INFO - layer23_self_attn.v_proj | mse: 0.0004920287759826484, bpp_loss: 6.0186265907250345, bpp: 0
2025-03-03 09:29:40 - INFO - layer23_self_attn.o_proj | mse: 0.0005018629227837745, bpp_loss: 5.981407446204685, bpp: 0
2025-03-03 09:29:52 - INFO - layer23_mlp.gate_proj | mse: 0.0005705601181713947, bpp_loss: 6.421522322110832, bpp: 0
2025-03-03 09:30:03 - INFO - layer23_mlp.up_proj | mse: 0.00047524079582240584, bpp_loss: 6.0152932695512265, bpp: 0
2025-03-03 09:30:41 - INFO - layer23_mlp.down_proj | mse: 0.000462835711272599, bpp_loss: 6.0118077399009575, bpp: 0
pseudo compress quantization...:  75%|███████▌  | 24/32 [38:15<12:41, 95.19s/it]2025-03-03 09:30:50 - INFO - layer24_self_attn.q_proj | mse: 0.0006725658147708491, bpp_loss: 6.642132429173216, bpp: 0
2025-03-03 09:30:58 - INFO - layer24_self_attn.k_proj | mse: 0.0010939488949731947, bpp_loss: 7.607301136944443, bpp: 0
2025-03-03 09:31:07 - INFO - layer24_self_attn.v_proj | mse: 0.000519196290607569, bpp_loss: 6.12013196805492, bpp: 0
2025-03-03 09:31:16 - INFO - layer24_self_attn.o_proj | mse: 0.0005342897918622184, bpp_loss: 6.027384543907829, bpp: 0
2025-03-03 09:31:27 - INFO - layer24_mlp.gate_proj | mse: 0.0005684518989072281, bpp_loss: 6.4288837263094525, bpp: 0
2025-03-03 09:31:38 - INFO - layer24_mlp.up_proj | mse: 0.0004737794447776921, bpp_loss: 6.020021180356188, bpp: 0
2025-03-03 09:32:16 - INFO - layer24_mlp.down_proj | mse: 0.0004585192213098115, bpp_loss: 6.017006619334487, bpp: 0
pseudo compress quantization...:  78%|███████▊  | 25/32 [39:50<11:06, 95.21s/it]2025-03-03 09:32:25 - INFO - layer25_self_attn.q_proj | mse: 0.0006530610230086147, bpp_loss: 6.612769734696485, bpp: 0
2025-03-03 09:32:34 - INFO - layer25_self_attn.k_proj | mse: 0.0010261972994535583, bpp_loss: 7.591024972382002, bpp: 0
2025-03-03 09:32:42 - INFO - layer25_self_attn.v_proj | mse: 0.0005103537018921533, bpp_loss: 6.129885285161436, bpp: 0
2025-03-03 09:32:51 - INFO - layer25_self_attn.o_proj | mse: 0.0005371185275999098, bpp_loss: 6.031943235779181, bpp: 0
2025-03-03 09:33:02 - INFO - layer25_mlp.gate_proj | mse: 0.0005687947328555898, bpp_loss: 6.440765292117638, bpp: 0
2025-03-03 09:33:13 - INFO - layer25_mlp.up_proj | mse: 0.0004736962582696243, bpp_loss: 6.0292697596762865, bpp: 0
2025-03-03 09:33:51 - INFO - layer25_mlp.down_proj | mse: 0.00046070250501627046, bpp_loss: 6.026233553454014, bpp: 0
pseudo compress quantization...:  81%|████████▏ | 26/32 [41:26<09:31, 95.22s/it]2025-03-03 09:34:00 - INFO - layer26_self_attn.q_proj | mse: 0.0006628982026511806, bpp_loss: 6.623683437355794, bpp: 0
2025-03-03 09:34:09 - INFO - layer26_self_attn.k_proj | mse: 0.0011151853939313633, bpp_loss: 7.690238100127317, bpp: 0
2025-03-03 09:34:17 - INFO - layer26_self_attn.v_proj | mse: 0.0005338886419989195, bpp_loss: 6.194379757042043, bpp: 0
2025-03-03 09:34:26 - INFO - layer26_self_attn.o_proj | mse: 0.0005795326793390533, bpp_loss: 6.053731588413939, bpp: 0
2025-03-03 09:34:37 - INFO - layer26_mlp.gate_proj | mse: 0.0005690153219540979, bpp_loss: 6.4519269768414755, bpp: 0
2025-03-03 09:34:48 - INFO - layer26_mlp.up_proj | mse: 0.0004736133304260716, bpp_loss: 6.038265526161662, bpp: 0
2025-03-03 09:35:26 - INFO - layer26_mlp.down_proj | mse: 0.000459509285607947, bpp_loss: 6.035134985078392, bpp: 0
pseudo compress quantization...:  84%|████████▍ | 27/32 [43:00<07:55, 95.06s/it]2025-03-03 09:35:35 - INFO - layer27_self_attn.q_proj | mse: 0.0006424248480786315, bpp_loss: 6.590456647798419, bpp: 0
2025-03-03 09:35:44 - INFO - layer27_self_attn.k_proj | mse: 0.0010762239737396129, bpp_loss: 7.638780563138425, bpp: 0
2025-03-03 09:35:52 - INFO - layer27_self_attn.v_proj | mse: 0.0005498371329419003, bpp_loss: 6.28785801155027, bpp: 0
2025-03-03 09:36:01 - INFO - layer27_self_attn.o_proj | mse: 0.0005393726983167418, bpp_loss: 6.084113494376652, bpp: 0
2025-03-03 09:36:12 - INFO - layer27_mlp.gate_proj | mse: 0.0005696774513799437, bpp_loss: 6.465721449016461, bpp: 0
2025-03-03 09:36:23 - INFO - layer27_mlp.up_proj | mse: 0.00047424354065074954, bpp_loss: 6.052599627125476, bpp: 0
2025-03-03 09:37:01 - INFO - layer27_mlp.down_proj | mse: 0.0004647023896125312, bpp_loss: 6.047233341760667, bpp: 0
pseudo compress quantization...:  88%|████████▊ | 28/32 [44:35<06:20, 95.05s/it]2025-03-03 09:37:10 - INFO - layer28_self_attn.q_proj | mse: 0.0006396628348526196, bpp_loss: 6.596967818215489, bpp: 0
2025-03-03 09:37:18 - INFO - layer28_self_attn.k_proj | mse: 0.0009615233590011414, bpp_loss: 7.542034418787807, bpp: 0
2025-03-03 09:37:27 - INFO - layer28_self_attn.v_proj | mse: 0.0005584583694984881, bpp_loss: 6.351868509082124, bpp: 0
2025-03-03 09:37:36 - INFO - layer28_self_attn.o_proj | mse: 0.0005565631604625364, bpp_loss: 6.1138537438819185, bpp: 0
2025-03-03 09:37:47 - INFO - layer28_mlp.gate_proj | mse: 0.0005683555205088884, bpp_loss: 6.454274131916463, bpp: 0
2025-03-03 09:37:58 - INFO - layer28_mlp.up_proj | mse: 0.0004805461602265591, bpp_loss: 6.076021556875536, bpp: 0
2025-03-03 09:38:36 - INFO - layer28_mlp.down_proj | mse: 0.0004716309255820675, bpp_loss: 6.065669502929917, bpp: 0
pseudo compress quantization...:  91%|█████████ | 29/32 [46:10<04:45, 95.09s/it]2025-03-03 09:38:45 - INFO - layer29_self_attn.q_proj | mse: 0.0006244770356323566, bpp_loss: 6.581470501725562, bpp: 0
2025-03-03 09:38:54 - INFO - layer29_self_attn.k_proj | mse: 0.0009919615894207665, bpp_loss: 7.676445745397359, bpp: 0
2025-03-03 09:39:02 - INFO - layer29_self_attn.v_proj | mse: 0.0005756028863597816, bpp_loss: 6.42004659306258, bpp: 0
2025-03-03 09:39:11 - INFO - layer29_self_attn.o_proj | mse: 0.0005970789345254178, bpp_loss: 6.156975350575522, bpp: 0
2025-03-03 09:39:22 - INFO - layer29_mlp.gate_proj | mse: 0.0005693052331426627, bpp_loss: 6.448548676978264, bpp: 0
2025-03-03 09:39:33 - INFO - layer29_mlp.up_proj | mse: 0.0004907776868556761, bpp_loss: 6.108700366158571, bpp: 0
2025-03-03 09:40:11 - INFO - layer29_mlp.down_proj | mse: 0.00048449989907331953, bpp_loss: 6.085105907438057, bpp: 0
pseudo compress quantization...:  94%|█████████▍| 30/32 [47:46<03:10, 95.21s/it]2025-03-03 09:40:20 - INFO - layer30_self_attn.q_proj | mse: 0.0006283303285812767, bpp_loss: 6.480302930925973, bpp: 0
2025-03-03 09:40:29 - INFO - layer30_self_attn.k_proj | mse: 0.0010034652022688718, bpp_loss: 7.223263600841165, bpp: 0
2025-03-03 09:40:37 - INFO - layer30_self_attn.v_proj | mse: 0.0006876167657127587, bpp_loss: 6.756469797575846, bpp: 0
2025-03-03 09:40:46 - INFO - layer30_self_attn.o_proj | mse: 0.0006477446330295036, bpp_loss: 6.247587992344052, bpp: 0
2025-03-03 09:40:57 - INFO - layer30_mlp.gate_proj | mse: 0.0005842244850466907, bpp_loss: 6.50833107690726, bpp: 0
2025-03-03 09:41:08 - INFO - layer30_mlp.up_proj | mse: 0.0004987391219670544, bpp_loss: 6.1396337623841, bpp: 0
2025-03-03 09:41:47 - INFO - layer30_mlp.down_proj | mse: 0.0005229032505736636, bpp_loss: 6.090702890917393, bpp: 0
pseudo compress quantization...:  97%|█████████▋| 31/32 [49:21<01:35, 95.23s/it]2025-03-03 09:41:56 - INFO - layer31_self_attn.q_proj | mse: 0.0006743565492091372, bpp_loss: 6.658811894361861, bpp: 0
2025-03-03 09:42:05 - INFO - layer31_self_attn.k_proj | mse: 0.0010057565818762063, bpp_loss: 7.525734857772477, bpp: 0
2025-03-03 09:42:13 - INFO - layer31_self_attn.v_proj | mse: 0.000612699063799659, bpp_loss: 6.523481485317461, bpp: 0
2025-03-03 09:42:22 - INFO - layer31_self_attn.o_proj | mse: 0.0006813904327690757, bpp_loss: 6.223075980087742, bpp: 0
2025-03-03 09:42:33 - INFO - layer31_mlp.gate_proj | mse: 0.0006869836713787371, bpp_loss: 6.765372817138476, bpp: 0
2025-03-03 09:42:44 - INFO - layer31_mlp.up_proj | mse: 0.0005758343911008286, bpp_loss: 6.345779795731817, bpp: 0
2025-03-03 09:43:22 - INFO - layer31_mlp.down_proj | mse: 0.0007060307433482122, bpp_loss: 6.12393958271215, bpp: 0
pseudo compress quantization...: 100%|██████████| 32/32 [50:57<00:00, 95.31s/it]pseudo compress quantization...: 100%|██████████| 32/32 [50:57<00:00, 95.54s/it]
2025-03-03 09:43:22 - INFO - #### Total | mse: 0.0005715941175506796, bpp_loss: 6.19223432531418, bpp: 0 ####
## Strart saving /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda100000_rdloss_ql_encdim512_M16_batch_size1024_total_iter200000_lr0.0001_seed100/best_loss_model_loss_49.72731_bpp_6.30559_MSE_0.00042_total_iter_140000.pth.tar/COL_MSE0.00057_bpploss6.1922_bpp0
## End saving
Running evaluation for directory: /home/jgryu/Weight_compression/comp_llm/model_lm_reconstructed/ldlq/meta-llama--Meta-Llama-3-8B/block_seq_ql_random_col_16/lmbda100000_rdloss_ql_encdim512_M16_batch_size1024_total_iter200000_lr0.0001_seed100/best_loss_model_loss_49.72731_bpp_6.30559_MSE_0.00042_total_iter_140000.pth.tar/COL_MSE0.00057_bpploss6.1922_bpp0
I0303 09:43:55.729189 3139157 modeling.py:879] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:02,  1.49it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.48it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.61it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s]
I0303 09:43:58.545870 3139157 config.py:54] PyTorch version 2.4.1 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.515625:   0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.515625:   1%|          | 1/141 [00:00<01:13,  1.90it/s]avg_loss = 1.84375:   1%|          | 1/141 [00:00<01:13,  1.90it/s] avg_loss = 1.84375:   1%|▏         | 2/141 [00:00<01:04,  2.16it/s]avg_loss = 1.9791666666666667:   1%|▏         | 2/141 [00:01<01:04,  2.16it/s]avg_loss = 1.9791666666666667:   2%|▏         | 3/141 [00:01<01:01,  2.26it/s]avg_loss = 1.935546875:   2%|▏         | 3/141 [00:01<01:01,  2.26it/s]       avg_loss = 1.935546875:   3%|▎         | 4/141 [00:01<00:59,  2.31it/s]avg_loss = 1.8890625:   3%|▎         | 4/141 [00:02<00:59,  2.31it/s]  avg_loss = 1.8890625:   4%|▎         | 5/141 [00:02<00:58,  2.33it/s]avg_loss = 1.79296875:   4%|▎         | 5/141 [00:02<00:58,  2.33it/s]avg_loss = 1.79296875:   4%|▍         | 6/141 [00:02<00:57,  2.35it/s]avg_loss = 1.7276785714285714:   4%|▍         | 6/141 [00:03<00:57,  2.35it/s]avg_loss = 1.7276785714285714:   5%|▍         | 7/141 [00:03<00:56,  2.36it/s]avg_loss = 1.724609375:   5%|▍         | 7/141 [00:03<00:56,  2.36it/s]       avg_loss = 1.724609375:   6%|▌         | 8/141 [00:03<00:55,  2.38it/s]avg_loss = 1.7604166666666667:   6%|▌         | 8/141 [00:03<00:55,  2.38it/s]avg_loss = 1.7604166666666667:   6%|▋         | 9/141 [00:03<00:55,  2.38it/s]avg_loss = 1.76640625:   6%|▋         | 9/141 [00:04<00:55,  2.38it/s]        avg_loss = 1.76640625:   7%|▋         | 10/141 [00:04<00:54,  2.39it/s]avg_loss = 1.7634943181818181:   7%|▋         | 10/141 [00:04<00:54,  2.39it/s]avg_loss = 1.7634943181818181:   8%|▊         | 11/141 [00:04<00:54,  2.39it/s]avg_loss = 1.787109375:   8%|▊         | 11/141 [00:05<00:54,  2.39it/s]       avg_loss = 1.787109375:   9%|▊         | 12/141 [00:05<00:53,  2.39it/s]avg_loss = 1.7998798076923077:   9%|▊         | 12/141 [00:05<00:53,  2.39it/s]avg_loss = 1.7998798076923077:   9%|▉         | 13/141 [00:05<00:53,  2.39it/s]avg_loss = 1.8186383928571428:   9%|▉         | 13/141 [00:05<00:53,  2.39it/s]avg_loss = 1.8186383928571428:  10%|▉         | 14/141 [00:05<00:53,  2.39it/s]avg_loss = 1.8291666666666666:  10%|▉         | 14/141 [00:06<00:53,  2.39it/s]avg_loss = 1.8291666666666666:  11%|█         | 15/141 [00:06<00:52,  2.40it/s]avg_loss = 1.853515625:  11%|█         | 15/141 [00:06<00:52,  2.40it/s]       avg_loss = 1.853515625:  11%|█▏        | 16/141 [00:06<00:52,  2.39it/s]avg_loss = 1.857077205882353:  11%|█▏        | 16/141 [00:07<00:52,  2.39it/s]avg_loss = 1.857077205882353:  12%|█▏        | 17/141 [00:07<00:51,  2.39it/s]avg_loss = 1.8589409722222223:  12%|█▏        | 17/141 [00:07<00:51,  2.39it/s]avg_loss = 1.8589409722222223:  13%|█▎        | 18/141 [00:07<00:51,  2.39it/s]avg_loss = 1.8379934210526316:  13%|█▎        | 18/141 [00:08<00:51,  2.39it/s]avg_loss = 1.8379934210526316:  13%|█▎        | 19/141 [00:08<00:51,  2.39it/s]avg_loss = 1.83671875:  13%|█▎        | 19/141 [00:08<00:51,  2.39it/s]        avg_loss = 1.83671875:  14%|█▍        | 20/141 [00:08<00:50,  2.39it/s]avg_loss = 1.8415178571428572:  14%|█▍        | 20/141 [00:08<00:50,  2.39it/s]avg_loss = 1.8415178571428572:  15%|█▍        | 21/141 [00:08<00:50,  2.39it/s]avg_loss = 1.84375:  15%|█▍        | 21/141 [00:09<00:50,  2.39it/s]           avg_loss = 1.84375:  16%|█▌        | 22/141 [00:09<00:49,  2.39it/s]avg_loss = 1.8454483695652173:  16%|█▌        | 22/141 [00:09<00:49,  2.39it/s]avg_loss = 1.8454483695652173:  16%|█▋        | 23/141 [00:09<00:49,  2.38it/s]avg_loss = 1.8505859375:  16%|█▋        | 23/141 [00:10<00:49,  2.38it/s]      avg_loss = 1.8505859375:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]avg_loss = 1.8565625:  17%|█▋        | 24/141 [00:10<00:49,  2.38it/s]   avg_loss = 1.8565625:  18%|█▊        | 25/141 [00:10<00:48,  2.38it/s]avg_loss = 1.8686899038461537:  18%|█▊        | 25/141 [00:10<00:48,  2.38it/s]avg_loss = 1.8686899038461537:  18%|█▊        | 26/141 [00:10<00:48,  2.38it/s]avg_loss = 1.8816550925925926:  18%|█▊        | 26/141 [00:11<00:48,  2.38it/s]avg_loss = 1.8816550925925926:  19%|█▉        | 27/141 [00:11<00:47,  2.38it/s]avg_loss = 1.888671875:  19%|█▉        | 27/141 [00:11<00:47,  2.38it/s]       avg_loss = 1.888671875:  20%|█▉        | 28/141 [00:11<00:47,  2.38it/s]avg_loss = 1.8852370689655173:  20%|█▉        | 28/141 [00:12<00:47,  2.38it/s]avg_loss = 1.8852370689655173:  21%|██        | 29/141 [00:12<00:47,  2.38it/s]avg_loss = 1.8755208333333333:  21%|██        | 29/141 [00:12<00:47,  2.38it/s]avg_loss = 1.8755208333333333:  21%|██▏       | 30/141 [00:12<00:46,  2.37it/s]avg_loss = 1.8608870967741935:  21%|██▏       | 30/141 [00:13<00:46,  2.37it/s]avg_loss = 1.8608870967741935:  22%|██▏       | 31/141 [00:13<00:46,  2.37it/s]avg_loss = 1.8486328125:  22%|██▏       | 31/141 [00:13<00:46,  2.37it/s]      avg_loss = 1.8486328125:  23%|██▎       | 32/141 [00:13<00:45,  2.37it/s]avg_loss = 1.847774621212121:  23%|██▎       | 32/141 [00:13<00:45,  2.37it/s]avg_loss = 1.847774621212121:  23%|██▎       | 33/141 [00:13<00:45,  2.37it/s]avg_loss = 1.8465073529411764:  23%|██▎       | 33/141 [00:14<00:45,  2.37it/s]avg_loss = 1.8465073529411764:  24%|██▍       | 34/141 [00:14<00:45,  2.37it/s]avg_loss = 1.8493303571428572:  24%|██▍       | 34/141 [00:14<00:45,  2.37it/s]avg_loss = 1.8493303571428572:  25%|██▍       | 35/141 [00:14<00:44,  2.37it/s]avg_loss = 1.8331163194444444:  25%|██▍       | 35/141 [00:15<00:44,  2.37it/s]avg_loss = 1.8331163194444444:  26%|██▌       | 36/141 [00:15<00:44,  2.37it/s]avg_loss = 1.8177787162162162:  26%|██▌       | 36/141 [00:15<00:44,  2.37it/s]avg_loss = 1.8177787162162162:  26%|██▌       | 37/141 [00:15<00:43,  2.37it/s]avg_loss = 1.8030427631578947:  26%|██▌       | 37/141 [00:16<00:43,  2.37it/s]avg_loss = 1.8030427631578947:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 1.7888621794871795:  27%|██▋       | 38/141 [00:16<00:43,  2.36it/s]avg_loss = 1.7888621794871795:  28%|██▊       | 39/141 [00:16<00:43,  2.36it/s]avg_loss = 1.7806640625:  28%|██▊       | 39/141 [00:16<00:43,  2.36it/s]      avg_loss = 1.7806640625:  28%|██▊       | 40/141 [00:16<00:42,  2.36it/s]avg_loss = 1.7852515243902438:  28%|██▊       | 40/141 [00:17<00:42,  2.36it/s]avg_loss = 1.7852515243902438:  29%|██▉       | 41/141 [00:17<00:42,  2.36it/s]avg_loss = 1.802641369047619:  29%|██▉       | 41/141 [00:17<00:42,  2.36it/s] avg_loss = 1.802641369047619:  30%|██▉       | 42/141 [00:17<00:41,  2.36it/s]avg_loss = 1.8192223837209303:  30%|██▉       | 42/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8192223837209303:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8219105113636365:  30%|███       | 43/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8219105113636365:  31%|███       | 44/141 [00:18<00:41,  2.36it/s]avg_loss = 1.8262152777777778:  31%|███       | 44/141 [00:19<00:41,  2.36it/s]avg_loss = 1.8262152777777778:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8316915760869565:  32%|███▏      | 45/141 [00:19<00:40,  2.36it/s]avg_loss = 1.8316915760869565:  33%|███▎      | 46/141 [00:19<00:40,  2.36it/s]avg_loss = 1.838597074468085:  33%|███▎      | 46/141 [00:19<00:40,  2.36it/s] avg_loss = 1.838597074468085:  33%|███▎      | 47/141 [00:19<00:39,  2.36it/s]avg_loss = 1.8419596354166667:  33%|███▎      | 47/141 [00:20<00:39,  2.36it/s]avg_loss = 1.8419596354166667:  34%|███▍      | 48/141 [00:20<00:39,  2.36it/s]avg_loss = 1.840561224489796:  34%|███▍      | 48/141 [00:20<00:39,  2.36it/s] avg_loss = 1.840561224489796:  35%|███▍      | 49/141 [00:20<00:39,  2.36it/s]avg_loss = 1.84046875:  35%|███▍      | 49/141 [00:21<00:39,  2.36it/s]       avg_loss = 1.84046875:  35%|███▌      | 50/141 [00:21<00:38,  2.36it/s]avg_loss = 1.8339460784313726:  35%|███▌      | 50/141 [00:21<00:38,  2.36it/s]avg_loss = 1.8339460784313726:  36%|███▌      | 51/141 [00:21<00:38,  2.36it/s]avg_loss = 1.8303786057692308:  36%|███▌      | 51/141 [00:21<00:38,  2.36it/s]avg_loss = 1.8303786057692308:  37%|███▋      | 52/141 [00:21<00:37,  2.36it/s]avg_loss = 1.8239976415094339:  37%|███▋      | 52/141 [00:22<00:37,  2.36it/s]avg_loss = 1.8239976415094339:  38%|███▊      | 53/141 [00:22<00:37,  2.36it/s]avg_loss = 1.8211805555555556:  38%|███▊      | 53/141 [00:22<00:37,  2.36it/s]avg_loss = 1.8211805555555556:  38%|███▊      | 54/141 [00:22<00:36,  2.35it/s]avg_loss = 1.8136363636363637:  38%|███▊      | 54/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8136363636363637:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8059430803571428:  39%|███▉      | 55/141 [00:23<00:36,  2.35it/s]avg_loss = 1.8059430803571428:  40%|███▉      | 56/141 [00:23<00:36,  2.35it/s]avg_loss = 1.7992050438596492:  40%|███▉      | 56/141 [00:24<00:36,  2.35it/s]avg_loss = 1.7992050438596492:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.7964709051724137:  40%|████      | 57/141 [00:24<00:35,  2.35it/s]avg_loss = 1.7964709051724137:  41%|████      | 58/141 [00:24<00:35,  2.35it/s]avg_loss = 1.798728813559322:  41%|████      | 58/141 [00:24<00:35,  2.35it/s] avg_loss = 1.798728813559322:  42%|████▏     | 59/141 [00:24<00:34,  2.35it/s]avg_loss = 1.8046875:  42%|████▏     | 59/141 [00:25<00:34,  2.35it/s]        avg_loss = 1.8046875:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8107069672131149:  43%|████▎     | 60/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8107069672131149:  43%|████▎     | 61/141 [00:25<00:34,  2.35it/s]avg_loss = 1.8180443548387097:  43%|████▎     | 61/141 [00:26<00:34,  2.35it/s]avg_loss = 1.8180443548387097:  44%|████▍     | 62/141 [00:26<00:33,  2.36it/s]avg_loss = 1.808655753968254:  44%|████▍     | 62/141 [00:26<00:33,  2.36it/s] avg_loss = 1.808655753968254:  45%|████▍     | 63/141 [00:26<00:33,  2.36it/s]avg_loss = 1.806640625:  45%|████▍     | 63/141 [00:27<00:33,  2.36it/s]      avg_loss = 1.806640625:  45%|████▌     | 64/141 [00:27<00:32,  2.36it/s]avg_loss = 1.8039663461538462:  45%|████▌     | 64/141 [00:27<00:32,  2.36it/s]avg_loss = 1.8039663461538462:  46%|████▌     | 65/141 [00:27<00:32,  2.36it/s]avg_loss = 1.7979403409090908:  46%|████▌     | 65/141 [00:27<00:32,  2.36it/s]avg_loss = 1.7979403409090908:  47%|████▋     | 66/141 [00:27<00:31,  2.36it/s]avg_loss = 1.7954757462686568:  47%|████▋     | 66/141 [00:28<00:31,  2.36it/s]avg_loss = 1.7954757462686568:  48%|████▊     | 67/141 [00:28<00:31,  2.36it/s]avg_loss = 1.7921645220588236:  48%|████▊     | 67/141 [00:28<00:31,  2.36it/s]avg_loss = 1.7921645220588236:  48%|████▊     | 68/141 [00:28<00:30,  2.36it/s]avg_loss = 1.7891757246376812:  48%|████▊     | 68/141 [00:29<00:30,  2.36it/s]avg_loss = 1.7891757246376812:  49%|████▉     | 69/141 [00:29<00:30,  2.36it/s]avg_loss = 1.7900669642857143:  49%|████▉     | 69/141 [00:29<00:30,  2.36it/s]avg_loss = 1.7900669642857143:  50%|████▉     | 70/141 [00:29<00:30,  2.36it/s]avg_loss = 1.7939040492957747:  50%|████▉     | 70/141 [00:30<00:30,  2.36it/s]avg_loss = 1.7939040492957747:  50%|█████     | 71/141 [00:30<00:29,  2.36it/s]avg_loss = 1.7963324652777777:  50%|█████     | 71/141 [00:30<00:29,  2.36it/s]avg_loss = 1.7963324652777777:  51%|█████     | 72/141 [00:30<00:29,  2.36it/s]avg_loss = 1.7950556506849316:  51%|█████     | 72/141 [00:30<00:29,  2.36it/s]avg_loss = 1.7950556506849316:  52%|█████▏    | 73/141 [00:30<00:28,  2.36it/s]avg_loss = 1.796875:  52%|█████▏    | 73/141 [00:31<00:28,  2.36it/s]          avg_loss = 1.796875:  52%|█████▏    | 74/141 [00:31<00:28,  2.36it/s]avg_loss = 1.7972916666666667:  52%|█████▏    | 74/141 [00:31<00:28,  2.36it/s]avg_loss = 1.7972916666666667:  53%|█████▎    | 75/141 [00:31<00:28,  2.36it/s]avg_loss = 1.796361019736842:  53%|█████▎    | 75/141 [00:32<00:28,  2.36it/s] avg_loss = 1.796361019736842:  54%|█████▍    | 76/141 [00:32<00:27,  2.36it/s]avg_loss = 1.7976866883116882:  54%|█████▍    | 76/141 [00:32<00:27,  2.36it/s]avg_loss = 1.7976866883116882:  55%|█████▍    | 77/141 [00:32<00:27,  2.36it/s]avg_loss = 1.8002804487179487:  55%|█████▍    | 77/141 [00:33<00:27,  2.36it/s]avg_loss = 1.8002804487179487:  55%|█████▌    | 78/141 [00:33<00:26,  2.35it/s]avg_loss = 1.8045886075949367:  55%|█████▌    | 78/141 [00:33<00:26,  2.35it/s]avg_loss = 1.8045886075949367:  56%|█████▌    | 79/141 [00:33<00:26,  2.36it/s]avg_loss = 1.80205078125:  56%|█████▌    | 79/141 [00:33<00:26,  2.36it/s]     avg_loss = 1.80205078125:  57%|█████▋    | 80/141 [00:33<00:25,  2.35it/s]avg_loss = 1.8011188271604939:  57%|█████▋    | 80/141 [00:34<00:25,  2.35it/s]avg_loss = 1.8011188271604939:  57%|█████▋    | 81/141 [00:34<00:25,  2.36it/s]avg_loss = 1.8005907012195121:  57%|█████▋    | 81/141 [00:34<00:25,  2.36it/s]avg_loss = 1.8005907012195121:  58%|█████▊    | 82/141 [00:34<00:25,  2.35it/s]avg_loss = 1.798851656626506:  58%|█████▊    | 82/141 [00:35<00:25,  2.35it/s] avg_loss = 1.798851656626506:  59%|█████▉    | 83/141 [00:35<00:24,  2.35it/s]avg_loss = 1.796781994047619:  59%|█████▉    | 83/141 [00:35<00:24,  2.35it/s]avg_loss = 1.796781994047619:  60%|█████▉    | 84/141 [00:35<00:24,  2.35it/s]avg_loss = 1.794485294117647:  60%|█████▉    | 84/141 [00:36<00:24,  2.35it/s]avg_loss = 1.794485294117647:  60%|██████    | 85/141 [00:36<00:23,  2.35it/s]avg_loss = 1.7962390988372092:  60%|██████    | 85/141 [00:36<00:23,  2.35it/s]avg_loss = 1.7962390988372092:  61%|██████    | 86/141 [00:36<00:23,  2.35it/s]avg_loss = 1.7983117816091954:  61%|██████    | 86/141 [00:36<00:23,  2.35it/s]avg_loss = 1.7983117816091954:  62%|██████▏   | 87/141 [00:36<00:22,  2.35it/s]avg_loss = 1.7984730113636365:  62%|██████▏   | 87/141 [00:37<00:22,  2.35it/s]avg_loss = 1.7984730113636365:  62%|██████▏   | 88/141 [00:37<00:22,  2.35it/s]avg_loss = 1.8072331460674158:  62%|██████▏   | 88/141 [00:37<00:22,  2.35it/s]avg_loss = 1.8072331460674158:  63%|██████▎   | 89/141 [00:37<00:22,  2.35it/s]avg_loss = 1.8147569444444445:  63%|██████▎   | 89/141 [00:38<00:22,  2.35it/s]avg_loss = 1.8147569444444445:  64%|██████▍   | 90/141 [00:38<00:21,  2.35it/s]avg_loss = 1.8179945054945055:  64%|██████▍   | 90/141 [00:38<00:21,  2.35it/s]avg_loss = 1.8179945054945055:  65%|██████▍   | 91/141 [00:38<00:21,  2.35it/s]avg_loss = 1.823029891304348:  65%|██████▍   | 91/141 [00:38<00:21,  2.35it/s] avg_loss = 1.823029891304348:  65%|██████▌   | 92/141 [00:38<00:20,  2.35it/s]avg_loss = 1.828125:  65%|██████▌   | 92/141 [00:39<00:20,  2.35it/s]         avg_loss = 1.828125:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8292885638297873:  66%|██████▌   | 93/141 [00:39<00:20,  2.35it/s]avg_loss = 1.8292885638297873:  67%|██████▋   | 94/141 [00:39<00:20,  2.34it/s]avg_loss = 1.8330592105263157:  67%|██████▋   | 94/141 [00:40<00:20,  2.34it/s]avg_loss = 1.8330592105263157:  67%|██████▋   | 95/141 [00:40<00:19,  2.35it/s]avg_loss = 1.833984375:  67%|██████▋   | 95/141 [00:40<00:19,  2.35it/s]       avg_loss = 1.833984375:  68%|██████▊   | 96/141 [00:40<00:19,  2.35it/s]avg_loss = 1.8360180412371134:  68%|██████▊   | 96/141 [00:41<00:19,  2.35it/s]avg_loss = 1.8360180412371134:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s]avg_loss = 1.8302774234693877:  69%|██████▉   | 97/141 [00:41<00:18,  2.35it/s]avg_loss = 1.8302774234693877:  70%|██████▉   | 98/141 [00:41<00:18,  2.35it/s]avg_loss = 1.830886994949495:  70%|██████▉   | 98/141 [00:41<00:18,  2.35it/s] avg_loss = 1.830886994949495:  70%|███████   | 99/141 [00:41<00:17,  2.34it/s]avg_loss = 1.832421875:  70%|███████   | 99/141 [00:42<00:17,  2.34it/s]      avg_loss = 1.832421875:  71%|███████   | 100/141 [00:42<00:17,  2.35it/s]avg_loss = 1.8307549504950495:  71%|███████   | 100/141 [00:42<00:17,  2.35it/s]avg_loss = 1.8307549504950495:  72%|███████▏  | 101/141 [00:42<00:17,  2.34it/s]avg_loss = 1.8307291666666667:  72%|███████▏  | 101/141 [00:43<00:17,  2.34it/s]avg_loss = 1.8307291666666667:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]avg_loss = 1.828125:  72%|███████▏  | 102/141 [00:43<00:16,  2.34it/s]          avg_loss = 1.828125:  73%|███████▎  | 103/141 [00:43<00:16,  2.34it/s]avg_loss = 1.830078125:  73%|███████▎  | 103/141 [00:44<00:16,  2.34it/s]avg_loss = 1.830078125:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8276041666666667:  74%|███████▍  | 104/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8276041666666667:  74%|███████▍  | 105/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8259876179245282:  74%|███████▍  | 105/141 [00:44<00:15,  2.34it/s]avg_loss = 1.8259876179245282:  75%|███████▌  | 106/141 [00:44<00:14,  2.34it/s]avg_loss = 1.8234521028037383:  75%|███████▌  | 106/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8234521028037383:  76%|███████▌  | 107/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8208912037037037:  76%|███████▌  | 107/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8208912037037037:  77%|███████▋  | 108/141 [00:45<00:14,  2.34it/s]avg_loss = 1.8180189220183487:  77%|███████▋  | 108/141 [00:46<00:14,  2.34it/s]avg_loss = 1.8180189220183487:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8155539772727274:  77%|███████▋  | 109/141 [00:46<00:13,  2.34it/s]avg_loss = 1.8155539772727274:  78%|███████▊  | 110/141 [00:46<00:13,  2.34it/s]avg_loss = 1.817919481981982:  78%|███████▊  | 110/141 [00:47<00:13,  2.34it/s] avg_loss = 1.817919481981982:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8177315848214286:  79%|███████▊  | 111/141 [00:47<00:12,  2.34it/s]avg_loss = 1.8177315848214286:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s]avg_loss = 1.818929756637168:  79%|███████▉  | 112/141 [00:47<00:12,  2.34it/s] avg_loss = 1.818929756637168:  80%|████████  | 113/141 [00:47<00:11,  2.34it/s]avg_loss = 1.8199698464912282:  80%|████████  | 113/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8199698464912282:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8193614130434783:  81%|████████  | 114/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8193614130434783:  82%|████████▏ | 115/141 [00:48<00:11,  2.34it/s]avg_loss = 1.8178879310344827:  82%|████████▏ | 115/141 [00:49<00:11,  2.34it/s]avg_loss = 1.8178879310344827:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8199786324786325:  82%|████████▏ | 116/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8199786324786325:  83%|████████▎ | 117/141 [00:49<00:10,  2.34it/s]avg_loss = 1.8197828389830508:  83%|████████▎ | 117/141 [00:50<00:10,  2.34it/s]avg_loss = 1.8197828389830508:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8184742647058822:  84%|████████▎ | 118/141 [00:50<00:09,  2.34it/s]avg_loss = 1.8184742647058822:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]avg_loss = 1.816796875:  84%|████████▍ | 119/141 [00:50<00:09,  2.34it/s]       avg_loss = 1.816796875:  85%|████████▌ | 120/141 [00:50<00:08,  2.34it/s]avg_loss = 1.8166967975206612:  85%|████████▌ | 120/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8166967975206612:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s]avg_loss = 1.817046618852459:  86%|████████▌ | 121/141 [00:51<00:08,  2.34it/s] avg_loss = 1.817046618852459:  87%|████████▋ | 122/141 [00:51<00:08,  2.34it/s]avg_loss = 1.8170096544715446:  87%|████████▋ | 122/141 [00:52<00:08,  2.34it/s]avg_loss = 1.8170096544715446:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s]avg_loss = 1.817288306451613:  87%|████████▋ | 123/141 [00:52<00:07,  2.34it/s] avg_loss = 1.817288306451613:  88%|████████▊ | 124/141 [00:52<00:07,  2.34it/s]avg_loss = 1.81625:  88%|████████▊ | 124/141 [00:53<00:07,  2.34it/s]          avg_loss = 1.81625:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 1.8167162698412698:  89%|████████▊ | 125/141 [00:53<00:06,  2.34it/s]avg_loss = 1.8167162698412698:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 1.8164985236220472:  89%|████████▉ | 126/141 [00:53<00:06,  2.34it/s]avg_loss = 1.8164985236220472:  90%|█████████ | 127/141 [00:53<00:05,  2.34it/s]avg_loss = 1.81512451171875:  90%|█████████ | 127/141 [00:54<00:05,  2.34it/s]  avg_loss = 1.81512451171875:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.815406976744186:  91%|█████████ | 128/141 [00:54<00:05,  2.34it/s]avg_loss = 1.815406976744186:  91%|█████████▏| 129/141 [00:54<00:05,  2.34it/s]avg_loss = 1.816045673076923:  91%|█████████▏| 129/141 [00:55<00:05,  2.34it/s]avg_loss = 1.816045673076923:  92%|█████████▏| 130/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8170324427480915:  92%|█████████▏| 130/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8170324427480915:  93%|█████████▎| 131/141 [00:55<00:04,  2.34it/s]avg_loss = 1.8177083333333333:  93%|█████████▎| 131/141 [00:56<00:04,  2.34it/s]avg_loss = 1.8177083333333333:  94%|█████████▎| 132/141 [00:56<00:03,  2.34it/s]avg_loss = 1.814967105263158:  94%|█████████▎| 132/141 [00:56<00:03,  2.34it/s] avg_loss = 1.814967105263158:  94%|█████████▍| 133/141 [00:56<00:03,  2.34it/s]avg_loss = 1.810750932835821:  94%|█████████▍| 133/141 [00:56<00:03,  2.34it/s]avg_loss = 1.810750932835821:  95%|█████████▌| 134/141 [00:56<00:02,  2.34it/s]avg_loss = 1.8133101851851852:  95%|█████████▌| 134/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8133101851851852:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8168658088235294:  96%|█████████▌| 135/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8168658088235294:  96%|█████████▋| 136/141 [00:57<00:02,  2.34it/s]avg_loss = 1.8176893248175183:  96%|█████████▋| 136/141 [00:58<00:02,  2.34it/s]avg_loss = 1.8176893248175183:  97%|█████████▋| 137/141 [00:58<00:01,  2.34it/s]avg_loss = 1.8163496376811594:  97%|█████████▋| 137/141 [00:58<00:01,  2.34it/s]avg_loss = 1.8163496376811594:  98%|█████████▊| 138/141 [00:58<00:01,  2.34it/s]avg_loss = 1.816490557553957:  98%|█████████▊| 138/141 [00:59<00:01,  2.34it/s] avg_loss = 1.816490557553957:  99%|█████████▊| 139/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8169642857142858:  99%|█████████▊| 139/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8169642857142858:  99%|█████████▉| 140/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8182624113475176:  99%|█████████▉| 140/141 [00:59<00:00,  2.33it/s]avg_loss = 1.8182624113475176: 100%|██████████| 141/141 [00:59<00:00,  2.34it/s]avg_loss = 1.8182624113475176: 100%|██████████| 141/141 [00:59<00:00,  2.35it/s]
I0303 09:45:29.984651 3139157 eval_ppl.py:105] wikitext2 perplexity: 6.161143779754639
wikitext2 perplexity: 6.161
