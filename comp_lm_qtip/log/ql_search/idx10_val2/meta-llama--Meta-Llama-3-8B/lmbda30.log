I0410 04:14:44.705914 1917425 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:14:44.706007 1917425 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:14:44.706045 1917425 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:14:45.026368 1917425 config.py:54] PyTorch version 2.6.0 available.
W0410 04:14:45.213868 1917425 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:14:45.832051 1917425 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.13it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.62it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.87it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.05it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.11it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.19it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.29it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.08it/s]
I0410 04:14:47.265482 1917425 quantize_finetune_llama.py:163] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:21,  1.46it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:20,  1.45it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:02<00:19,  1.48it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:02<00:17,  1.64it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:03<00:15,  1.79it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:03<00:13,  1.89it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:12,  1.98it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:04<00:11,  2.04it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:11,  2.07it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:10,  2.10it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:05<00:09,  2.12it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:09,  2.14it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:06<00:08,  2.15it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:08,  2.15it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:07<00:07,  2.15it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:07,  2.12it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:08<00:07,  2.14it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:09<00:06,  2.11it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:09<00:06,  2.05it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:10<00:06,  1.91it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:10<00:05,  1.92it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:05,  1.98it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:11<00:04,  1.92it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:12<00:04,  1.90it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:12<00:03,  1.92it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:13<00:03,  1.92it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:13<00:02,  1.94it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:14<00:02,  1.52it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:15<00:01,  1.62it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:15<00:01,  1.70it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:16<00:00,  1.75it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  1.80it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  1.89it/s]
I0410 04:15:13.050203 1917425 quantize_finetune_llama.py:201] loaded compression model
I0410 04:15:34.740604 1917425 quantize_finetune_llama.py:205] loaded dataset and devset
I0410 04:15:37.280431 1917425 quantize_finetune_llama.py:225] layer 0 gpu 0
I0410 04:15:41.534624 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 0 in 4.079724073410034s
tensor(-4.7143e-06) tensor(0.0125)
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0410 04:15:54.172408 1918673 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:15:54.172519 1918673 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:15:54.172560 1918673 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:15:54.552422 1918673 config.py:54] PyTorch version 2.6.0 available.
W0410 04:15:54.764865 1918673 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:15:55.377580 1918673 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:15:55.381843 1917425 quantize_finetune_llama.py:225] layer 1 gpu 0
I0410 04:15:55.395846 1918673 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.20893007516860962 err 12.721094131469727 tr(WHW.T) 60.88684844970703
bpp_loss 1.6846774220466614
0_q proxy err 0.0004110773734282702 err 118.42919158935547 tr(WHW.T) 288094.65625
bpp_loss 2.4519084692001343
0_k proxy err 0.00036382683902047575 err 36.44844055175781 tr(WHW.T) 100180.734375
bpp_loss 2.9445894956588745
0_o proxy err 0.029903067275881767 err 93.39378356933594 tr(WHW.T) 3123.217529296875
bpp_loss 1.8001657128334045
0_up proxy err 0.060492753982543945 err 539.8646240234375 tr(WHW.T) 8924.451171875
bpp_loss 2.0922208513532365
0_gate proxy err 0.03555373474955559 err 560.990478515625 tr(WHW.T) 15778.666015625
bpp_loss 2.1976406233651296
0_down proxy err 0.04266523942351341 err 461.5613098144531 tr(WHW.T) 10818.205078125
bpp_loss 2.086120912006923
I0410 04:16:37.806264 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 1 in 0.8810675144195557s
I0410 04:16:41.771431 1919476 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:16:41.771557 1919476 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:16:41.771606 1919476 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:16:42.177735 1919476 config.py:54] PyTorch version 2.6.0 available.
W0410 04:16:42.407114 1919476 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:16:43.089179 1919476 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:16:43.093641 1917425 quantize_finetune_llama.py:225] layer 2 gpu 0
I0410 04:16:43.112259 1919476 data_utils.py:336] using 256 training seqs, 128 validation seqs
1_v proxy err 0.14767533540725708 err 16.10708999633789 tr(WHW.T) 109.07096099853516
bpp_loss 1.8151487112045288
1_q proxy err 0.0007187006995081902 err 104.08689880371094 tr(WHW.T) 144826.484375
bpp_loss 2.7218306064605713
1_k proxy err 0.00039947102777659893 err 30.175661087036133 tr(WHW.T) 75539.046875
bpp_loss 3.3235710859298706
1_o proxy err 0.060156140476465225 err 119.33968353271484 tr(WHW.T) 1983.8321533203125
bpp_loss 1.8821290731430054
1_up proxy err 0.06633812934160233 err 546.0172119140625 tr(WHW.T) 8230.8203125
bpp_loss 2.1065331867762973
1_gate proxy err 0.040670640766620636 err 567.45166015625 tr(WHW.T) 13952.365234375
bpp_loss 2.208733218056815
1_down proxy err 0.0020061370451003313 err 28.041845321655273 tr(WHW.T) 13978.03125
bpp_loss 2.10089533669608
I0410 04:17:21.112692 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 2 in 1.0738651752471924s
I0410 04:17:25.115076 1920119 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:17:25.115198 1920119 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:17:25.115239 1920119 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:17:25.531807 1920119 config.py:54] PyTorch version 2.6.0 available.
W0410 04:17:25.763553 1920119 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:17:26.432297 1920119 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:17:26.436756 1917425 quantize_finetune_llama.py:225] layer 3 gpu 0
I0410 04:17:26.452778 1920119 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.14844438433647156 err 23.15131187438965 tr(WHW.T) 155.95950317382812
bpp_loss 1.71983003616333
2_q proxy err 0.003331081010401249 err 138.1571044921875 tr(WHW.T) 41475.15625
bpp_loss 2.679665446281433
2_k proxy err 0.0017732592532411218 err 40.1014289855957 tr(WHW.T) 22614.533203125
bpp_loss 3.4244394302368164
2_o proxy err 0.05404764413833618 err 106.32915496826172 tr(WHW.T) 1967.3226318359375
bpp_loss 1.8369559049606323
2_up proxy err 0.07307139039039612 err 555.3772583007812 tr(WHW.T) 7600.474609375
bpp_loss 2.0987893513270786
2_gate proxy err 0.03851804882287979 err 582.1354370117188 tr(WHW.T) 15113.31640625
bpp_loss 2.2398565156119212
2_down proxy err 0.06431978195905685 err 496.9812927246094 tr(WHW.T) 7726.72509765625
bpp_loss 2.1033995832715715
I0410 04:18:04.207398 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 3 in 0.9710149765014648s
I0410 04:18:08.184174 1920808 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:18:08.184296 1920808 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:18:08.184337 1920808 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:18:08.594046 1920808 config.py:54] PyTorch version 2.6.0 available.
W0410 04:18:08.821209 1920808 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:18:09.497995 1920808 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:18:09.502597 1917425 quantize_finetune_llama.py:225] layer 4 gpu 0
I0410 04:18:09.524605 1920808 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.10121957212686539 err 29.286178588867188 tr(WHW.T) 289.3331604003906
bpp_loss 1.8263331055641174
3_q proxy err 0.0033984885085374117 err 161.6896514892578 tr(WHW.T) 47576.9296875
bpp_loss 2.720979690551758
3_k proxy err 0.0017719612224027514 err 46.380226135253906 tr(WHW.T) 26174.515625
bpp_loss 3.497908353805542
3_o proxy err 0.07010843604803085 err 130.20242309570312 tr(WHW.T) 1857.15771484375
bpp_loss 1.94123375415802
3_up proxy err 0.07272423803806305 err 548.0836791992188 tr(WHW.T) 7536.46484375
bpp_loss 2.0815252576555525
3_gate proxy err 0.028355702757835388 err 592.1903686523438 tr(WHW.T) 20884.34765625
bpp_loss 2.309978485107422
3_down proxy err 0.0737491324543953 err 516.1414184570312 tr(WHW.T) 6998.6103515625
bpp_loss 2.081653050013951
I0410 04:18:47.358174 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 4 in 0.9072551727294922s
I0410 04:18:51.366535 1921486 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:18:51.366656 1921486 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:18:51.366706 1921486 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:18:51.784932 1921486 config.py:54] PyTorch version 2.6.0 available.
W0410 04:18:52.017887 1921486 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:18:52.712099 1921486 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:18:52.716585 1917425 quantize_finetune_llama.py:225] layer 5 gpu 0
I0410 04:18:52.740466 1921486 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.09478600323200226 err 27.043123245239258 tr(WHW.T) 285.30712890625
bpp_loss 1.8702280521392822
4_q proxy err 0.0028963619843125343 err 145.15077209472656 tr(WHW.T) 50114.859375
bpp_loss 2.6876137256622314
4_k proxy err 0.0014453609474003315 err 42.3519287109375 tr(WHW.T) 29301.974609375
bpp_loss 3.4828044176101685
4_o proxy err 0.09127691388130188 err 118.4088134765625 tr(WHW.T) 1297.2481689453125
bpp_loss 1.9493895173072815
4_up proxy err 0.07220988720655441 err 533.1608276367188 tr(WHW.T) 7383.48779296875
bpp_loss 2.054471901484898
4_gate proxy err 0.02028506062924862 err 590.923583984375 tr(WHW.T) 29130.974609375
bpp_loss 2.3770216533115933
4_down proxy err 0.0827142596244812 err 529.0174560546875 tr(WHW.T) 6395.72265625
bpp_loss 2.0577762808118547
I0410 04:19:30.182417 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 5 in 0.8483214378356934s
I0410 04:19:34.188819 1922144 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:19:34.188934 1922144 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:19:34.188975 1922144 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:19:34.599511 1922144 config.py:54] PyTorch version 2.6.0 available.
W0410 04:19:34.826444 1922144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:19:35.497517 1922144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:19:35.501912 1917425 quantize_finetune_llama.py:225] layer 6 gpu 0
I0410 04:19:35.520473 1922144 data_utils.py:336] using 256 training seqs, 128 validation seqs
5_v proxy err 0.12709644436836243 err 26.540266036987305 tr(WHW.T) 208.81988525390625
bpp_loss 1.7567432522773743
5_q proxy err 0.004023056477308273 err 144.7963409423828 tr(WHW.T) 35991.625
bpp_loss 2.6631250381469727
5_k proxy err 0.001828203909099102 err 42.04458236694336 tr(WHW.T) 22997.75390625
bpp_loss 3.4552531242370605
5_o proxy err 0.10626985132694244 err 112.1770248413086 tr(WHW.T) 1055.5865478515625
bpp_loss 1.896180808544159
5_up proxy err 0.0692036971449852 err 529.8534545898438 tr(WHW.T) 7656.43310546875
bpp_loss 2.0598603657313754
5_gate proxy err 0.019317856058478355 err 587.0106811523438 tr(WHW.T) 30386.947265625
bpp_loss 2.3799495697021484
5_down proxy err 0.0811571255326271 err 520.308837890625 tr(WHW.T) 6411.12939453125
bpp_loss 2.0622627053942
I0410 04:20:13.169447 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 6 in 0.733163595199585s
I0410 04:20:17.182244 1922844 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:20:17.182420 1922844 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:20:17.182523 1922844 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:20:17.621951 1922844 config.py:54] PyTorch version 2.6.0 available.
W0410 04:20:17.846147 1922844 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:20:18.634550 1922844 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:20:18.638907 1917425 quantize_finetune_llama.py:225] layer 7 gpu 0
I0410 04:20:18.659564 1922844 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.10847195237874985 err 27.512149810791016 tr(WHW.T) 253.63377380371094
bpp_loss 1.8044180870056152
6_q proxy err 0.004205327946692705 err 149.8761444091797 tr(WHW.T) 35639.5859375
bpp_loss 2.707595109939575
6_k proxy err 0.0016935544554144144 err 44.309574127197266 tr(WHW.T) 26163.654296875
bpp_loss 3.5229077339172363
6_o proxy err 0.12149108201265335 err 122.60253143310547 tr(WHW.T) 1009.1483764648438
bpp_loss 1.9305211901664734
6_up proxy err 0.06576671451330185 err 521.1049194335938 tr(WHW.T) 7923.53564453125
bpp_loss 2.0591941561017717
6_gate proxy err 0.016202248632907867 err 579.204345703125 tr(WHW.T) 35748.39453125
bpp_loss 2.3841202599661693
6_down proxy err 0.08064228296279907 err 522.8490600585938 tr(WHW.T) 6483.5595703125
bpp_loss 2.063042095729283
I0410 04:20:57.993860 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 7 in 0.7596955299377441s
I0410 04:21:02.293392 1923529 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:21:02.293496 1923529 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:21:02.293539 1923529 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:21:02.712437 1923529 config.py:54] PyTorch version 2.6.0 available.
W0410 04:21:02.932696 1923529 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:21:03.627262 1923529 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:21:03.631639 1917425 quantize_finetune_llama.py:225] layer 8 gpu 0
I0410 04:21:03.652460 1923529 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.09107766300439835 err 28.181896209716797 tr(WHW.T) 309.4270935058594
bpp_loss 1.8025281429290771
7_q proxy err 0.0044327848590910435 err 155.79000854492188 tr(WHW.T) 35144.953125
bpp_loss 2.637367844581604
7_k proxy err 0.0017545598093420267 err 47.11079406738281 tr(WHW.T) 26850.4921875
bpp_loss 3.5417085886001587
7_o proxy err 0.1235940232872963 err 118.55330657958984 tr(WHW.T) 959.2155151367188
bpp_loss 1.9409180879592896
7_up proxy err 0.05993662029504776 err 517.1002197265625 tr(WHW.T) 8627.4501953125
bpp_loss 2.0713579995291576
7_gate proxy err 0.01628594659268856 err 568.4371337890625 tr(WHW.T) 34903.53515625
bpp_loss 2.356522423880441
7_down proxy err 0.08096864819526672 err 529.0999755859375 tr(WHW.T) 6534.6279296875
bpp_loss 2.0766972473689487
I0410 04:21:45.858608 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 8 in 0.9788169860839844s
I0410 04:21:50.286359 1924239 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:21:50.286522 1924239 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:21:50.286566 1924239 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:21:50.699970 1924239 config.py:54] PyTorch version 2.6.0 available.
W0410 04:21:50.921876 1924239 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:21:51.633862 1924239 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:21:51.638257 1917425 quantize_finetune_llama.py:225] layer 9 gpu 0
I0410 04:21:51.668283 1924239 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.10259221494197845 err 26.43855094909668 tr(WHW.T) 257.7052307128906
bpp_loss 1.821737289428711
8_q proxy err 0.005092139821499586 err 135.4558868408203 tr(WHW.T) 26600.9765625
bpp_loss 2.6248672008514404
8_k proxy err 0.0017942605772987008 err 40.42244338989258 tr(WHW.T) 22528.748046875
bpp_loss 3.461038112640381
8_o proxy err 0.16101223230361938 err 120.05170440673828 tr(WHW.T) 745.6061401367188
bpp_loss 1.9507015347480774
8_up proxy err 0.06059904769062996 err 514.792236328125 tr(WHW.T) 8495.0546875
bpp_loss 2.06728458404541
8_gate proxy err 0.015206586569547653 err 566.26513671875 tr(WHW.T) 37238.1484375
bpp_loss 2.360641751970564
8_down proxy err 0.0825096145272255 err 535.3898315429688 tr(WHW.T) 6488.8173828125
bpp_loss 2.074810368674142
I0410 04:22:33.623172 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 9 in 0.8969821929931641s
I0410 04:22:38.017137 1924978 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:22:38.017288 1924978 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:22:38.017330 1924978 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:22:38.458543 1924978 config.py:54] PyTorch version 2.6.0 available.
W0410 04:22:38.681516 1924978 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:22:39.366828 1924978 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:22:39.371281 1917425 quantize_finetune_llama.py:225] layer 10 gpu 0
I0410 04:22:39.386807 1924978 data_utils.py:336] using 256 training seqs, 128 validation seqs
9_v proxy err 0.07706370204687119 err 27.08240509033203 tr(WHW.T) 351.4288024902344
bpp_loss 1.9205366373062134
9_q proxy err 0.005267934408038855 err 135.13954162597656 tr(WHW.T) 25653.232421875
bpp_loss 2.6363896131515503
9_k proxy err 0.0019091354915872216 err 39.98233413696289 tr(WHW.T) 20942.638671875
bpp_loss 3.4791146516799927
9_o proxy err 0.15230780839920044 err 118.28250885009766 tr(WHW.T) 776.6017456054688
bpp_loss 2.0042662024497986
9_up proxy err 0.05780329927802086 err 518.5328979492188 tr(WHW.T) 8970.6455078125
bpp_loss 2.0763224193028043
9_gate proxy err 0.014508519321680069 err 571.8637084960938 tr(WHW.T) 39415.71875
bpp_loss 2.373028482709612
9_down proxy err 0.08360347896814346 err 524.4365844726562 tr(WHW.T) 6272.90380859375
bpp_loss 2.075998749051775
I0410 04:23:20.496640 1917425 quantize_finetune_llama.py:256] computed original embedding for layer 10 in 0.890066385269165s
I0410 04:23:24.581607 1925718 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 04:23:24.581704 1925718 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 04:23:24.581745 1925718 utils.py:162] NumExpr defaulting to 16 threads.
I0410 04:23:24.909765 1925718 config.py:54] PyTorch version 2.6.0 available.
W0410 04:23:25.106694 1925718 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 04:23:25.699440 1925718 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 04:23:25.703747 1917425 quantize_finetune_llama.py:225] layer 11 gpu 0
I0410 04:23:25.718918 1925718 data_utils.py:336] using 256 training seqs, 128 validation seqs
