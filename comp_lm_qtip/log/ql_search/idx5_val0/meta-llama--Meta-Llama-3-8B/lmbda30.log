I0410 06:31:46.266970 2016026 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:31:46.267076 2016026 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:31:46.267116 2016026 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:31:46.589884 2016026 config.py:54] PyTorch version 2.6.0 available.
W0410 06:31:46.777476 2016026 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:31:47.347731 2016026 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.19it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.53it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.68it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  7.81it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  7.89it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.01it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.13it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.92it/s]
I0410 06:31:48.803903 2016026 quantize_finetune_llama.py:163] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:21,  1.47it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:20,  1.46it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:02<00:19,  1.48it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:02<00:17,  1.62it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:03<00:15,  1.72it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:03<00:14,  1.79it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:04<00:13,  1.84it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:04<00:12,  1.87it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:05<00:12,  1.88it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:11,  1.90it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:06<00:10,  1.91it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:10,  1.92it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:07<00:09,  1.93it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:09,  1.92it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:08<00:08,  1.93it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:08,  1.92it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:09<00:07,  1.94it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:09<00:07,  1.95it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:10<00:06,  1.93it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:10<00:06,  1.94it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:11<00:05,  1.96it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:04,  2.02it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:12<00:04,  2.06it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:12<00:03,  2.10it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:13<00:03,  2.12it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:13<00:02,  2.13it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:14<00:02,  2.16it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:14<00:01,  2.18it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:14<00:01,  2.19it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:15<00:00,  2.19it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:15<00:00,  2.18it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  2.16it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:16<00:00,  1.96it/s]
I0410 06:32:14.781801 2016026 quantize_finetune_llama.py:201] loaded compression model
I0410 06:32:36.054235 2016026 quantize_finetune_llama.py:205] loaded dataset and devset
I0410 06:32:38.344824 2016026 quantize_finetune_llama.py:225] layer 0 gpu 0
I0410 06:32:40.694485 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 0 in 2.1685848236083984s
tensor(-4.7143e-06) tensor(0.0125)
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0410 06:32:53.290917 2017203 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:32:53.291152 2017203 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:32:53.291261 2017203 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:32:53.735522 2017203 config.py:54] PyTorch version 2.6.0 available.
W0410 06:32:53.979166 2017203 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:32:54.653855 2017203 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:32:54.675482 2016026 quantize_finetune_llama.py:225] layer 1 gpu 0
I0410 06:32:57.185044 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 1 in 0.6720452308654785s
I0410 06:33:01.603389 2017320 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:01.603481 2017320 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:01.603519 2017320 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:01.978847 2017320 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:02.178170 2017320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:02.872049 2017320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:02.875726 2016026 quantize_finetune_llama.py:225] layer 2 gpu 0
I0410 06:33:06.065734 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 2 in 1.3109281063079834s
I0410 06:33:10.521806 2017505 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:10.522018 2017505 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:10.522112 2017505 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:10.907808 2017505 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:11.129746 2017505 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:11.941419 2017505 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:11.945496 2016026 quantize_finetune_llama.py:225] layer 3 gpu 0
I0410 06:33:14.320662 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 3 in 0.8344709873199463s
I0410 06:33:18.254453 2017682 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:18.254567 2017682 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:18.254610 2017682 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:18.635028 2017682 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:18.848094 2017682 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:19.430506 2017682 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:19.434963 2016026 quantize_finetune_llama.py:225] layer 4 gpu 0
I0410 06:33:21.449143 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 4 in 0.7625336647033691s
I0410 06:33:25.620823 2017855 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:25.620936 2017855 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:25.620977 2017855 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:26.005019 2017855 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:26.222732 2017855 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:26.893871 2017855 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:26.898104 2016026 quantize_finetune_llama.py:225] layer 5 gpu 0
I0410 06:33:29.438974 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 5 in 1.0529863834381104s
I0410 06:33:33.690558 2017967 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:33.690711 2017967 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:33.690756 2017967 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:34.124217 2017967 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:34.357539 2017967 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:35.081190 2017967 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:35.085726 2016026 quantize_finetune_llama.py:225] layer 6 gpu 0
I0410 06:33:37.939720 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 6 in 0.9517621994018555s
I0410 06:33:41.944083 2018082 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:41.944194 2018082 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:41.944235 2018082 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:42.347283 2018082 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:42.563214 2018082 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:43.204560 2018082 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:43.208765 2016026 quantize_finetune_llama.py:225] layer 7 gpu 0
I0410 06:33:45.592492 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 7 in 0.8198986053466797s
I0410 06:33:49.812358 2018255 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:49.812494 2018255 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:49.812549 2018255 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:50.252280 2018255 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:50.471235 2018255 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:51.117109 2018255 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:51.121466 2016026 quantize_finetune_llama.py:225] layer 8 gpu 0
I0410 06:33:53.877204 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 8 in 1.0485236644744873s
I0410 06:33:57.831270 2018388 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:33:57.831384 2018388 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:33:57.831424 2018388 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:33:58.216442 2018388 config.py:54] PyTorch version 2.6.0 available.
W0410 06:33:58.441042 2018388 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:33:59.079864 2018388 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:33:59.084132 2016026 quantize_finetune_llama.py:225] layer 9 gpu 0
I0410 06:33:59.101033 2018388 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.10259221494197845 err 26.43855094909668 tr(WHW.T) 257.7052307128906
bpp_loss 1.821737289428711
8_q proxy err 0.005092139821499586 err 135.4558868408203 tr(WHW.T) 26600.9765625
bpp_loss 2.6248672008514404
8_k proxy err 0.0017942605772987008 err 40.42244338989258 tr(WHW.T) 22528.748046875
bpp_loss 3.461038112640381
8_o proxy err 0.16101223230361938 err 120.05170440673828 tr(WHW.T) 745.6061401367188
bpp_loss 1.9507015347480774
8_up proxy err 0.06059904769062996 err 514.792236328125 tr(WHW.T) 8495.0546875
bpp_loss 2.06728458404541
8_gate proxy err 0.015206586569547653 err 566.26513671875 tr(WHW.T) 37238.1484375
bpp_loss 2.360641751970564
8_down proxy err 0.0825096145272255 err 535.3898315429688 tr(WHW.T) 6488.8173828125
bpp_loss 2.074810368674142
I0410 06:34:41.565275 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 9 in 0.6370570659637451s
I0410 06:34:45.159763 2019020 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:34:45.159872 2019020 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:34:45.159919 2019020 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:34:45.514106 2019020 config.py:54] PyTorch version 2.6.0 available.
W0410 06:34:45.728919 2019020 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:34:46.374037 2019020 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:34:46.378358 2016026 quantize_finetune_llama.py:225] layer 10 gpu 0
I0410 06:34:46.393142 2019020 data_utils.py:336] using 256 training seqs, 128 validation seqs
9_v proxy err 0.07706370204687119 err 27.08240509033203 tr(WHW.T) 351.4288024902344
bpp_loss 1.9205366373062134
9_q proxy err 0.005267934408038855 err 135.13954162597656 tr(WHW.T) 25653.232421875
bpp_loss 2.6363896131515503
9_k proxy err 0.0019091354915872216 err 39.98233413696289 tr(WHW.T) 20942.638671875
bpp_loss 3.4791146516799927
9_o proxy err 0.15230780839920044 err 118.28250885009766 tr(WHW.T) 776.6017456054688
bpp_loss 2.0042662024497986
9_up proxy err 0.05780329927802086 err 518.5328979492188 tr(WHW.T) 8970.6455078125
bpp_loss 2.0763224193028043
9_gate proxy err 0.014508519321680069 err 571.8637084960938 tr(WHW.T) 39415.71875
bpp_loss 2.373028482709612
9_down proxy err 0.08360347896814346 err 524.4365844726562 tr(WHW.T) 6272.90380859375
bpp_loss 2.075998749051775
I0410 06:35:28.456569 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 10 in 0.6327695846557617s
I0410 06:35:32.200462 2019771 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:35:32.200559 2019771 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:35:32.200598 2019771 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:35:32.542958 2019771 config.py:54] PyTorch version 2.6.0 available.
W0410 06:35:32.738699 2019771 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:35:33.348023 2019771 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:35:33.351973 2016026 quantize_finetune_llama.py:225] layer 11 gpu 0
I0410 06:35:33.365230 2019771 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.10172607749700546 err 25.61858367919922 tr(WHW.T) 251.83889770507812
bpp_loss 1.810444176197052
10_q proxy err 0.0056303637102246284 err 131.40231323242188 tr(WHW.T) 23338.15625
bpp_loss 2.632741332054138
10_k proxy err 0.0019838062580674887 err 39.16818618774414 tr(WHW.T) 19743.95703125
bpp_loss 3.477612257003784
10_o proxy err 0.16973312199115753 err 115.53123474121094 tr(WHW.T) 680.6640625
bpp_loss 1.9433330297470093
10_up proxy err 0.057028885930776596 err 524.61767578125 tr(WHW.T) 9199.1572265625
bpp_loss 2.093191010611398
10_gate proxy err 0.015318753197789192 err 572.9117431640625 tr(WHW.T) 37399.37109375
bpp_loss 2.345354897635324
10_down proxy err 0.08101324737071991 err 528.63037109375 tr(WHW.T) 6525.2333984375
bpp_loss 2.0923798084259033
I0410 06:36:16.426975 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 11 in 0.7371222972869873s
I0410 06:36:20.217563 2020422 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:36:20.217674 2020422 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:36:20.217715 2020422 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:36:20.597853 2020422 config.py:54] PyTorch version 2.6.0 available.
W0410 06:36:20.816864 2020422 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:36:21.473084 2020422 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:36:21.477302 2016026 quantize_finetune_llama.py:225] layer 12 gpu 0
I0410 06:36:21.491923 2020422 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.08286979794502258 err 26.482627868652344 tr(WHW.T) 319.5691223144531
bpp_loss 1.820645034313202
11_q proxy err 0.006038947496563196 err 134.00967407226562 tr(WHW.T) 22190.8984375
bpp_loss 2.5812803506851196
11_k proxy err 0.0022110752761363983 err 39.85999298095703 tr(WHW.T) 18027.423828125
bpp_loss 3.478442430496216
11_o proxy err 0.19481977820396423 err 110.25780487060547 tr(WHW.T) 565.9476928710938
bpp_loss 1.9625091552734375
11_up proxy err 0.05616606026887894 err 516.3118896484375 tr(WHW.T) 9192.595703125
bpp_loss 2.0973662648882185
11_gate proxy err 0.015218903310596943 err 561.33544921875 tr(WHW.T) 36884.09375
bpp_loss 2.3247263772147044
11_down proxy err 0.07806464284658432 err 519.5897216796875 tr(WHW.T) 6655.890625
bpp_loss 2.0993992260524204
I0410 06:37:04.050393 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 12 in 0.7261905670166016s
I0410 06:37:07.970153 2021110 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:37:07.970261 2021110 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:37:07.970302 2021110 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:37:08.388092 2021110 config.py:54] PyTorch version 2.6.0 available.
W0410 06:37:08.604022 2021110 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:37:09.286767 2021110 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:37:09.290978 2016026 quantize_finetune_llama.py:225] layer 13 gpu 0
I0410 06:37:09.305974 2021110 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.07779178023338318 err 28.286911010742188 tr(WHW.T) 363.6233825683594
bpp_loss 1.9373193383216858
12_q proxy err 0.004358019679784775 err 148.61990356445312 tr(WHW.T) 34102.625
bpp_loss 2.6389036178588867
12_k proxy err 0.0018920714501291513 err 43.62556838989258 tr(WHW.T) 23057.041015625
bpp_loss 3.481645107269287
12_o proxy err 0.15197059512138367 err 118.50231170654297 tr(WHW.T) 779.7713012695312
bpp_loss 2.0080376863479614
12_up proxy err 0.05058971419930458 err 507.27093505859375 tr(WHW.T) 10027.1552734375
bpp_loss 2.1150503158569336
12_gate proxy err 0.01468851137906313 err 548.3823852539062 tr(WHW.T) 37334.1015625
bpp_loss 2.3052428109305247
12_down proxy err 0.07515048235654831 err 512.7301025390625 tr(WHW.T) 6822.7119140625
bpp_loss 2.1109847341265
I0410 06:37:52.826283 2016026 quantize_finetune_llama.py:256] computed original embedding for layer 13 in 0.7591514587402344s
I0410 06:37:56.851862 2022066 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0410 06:37:56.851982 2022066 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0410 06:37:56.852023 2022066 utils.py:162] NumExpr defaulting to 16 threads.
I0410 06:37:57.282423 2022066 config.py:54] PyTorch version 2.6.0 available.
W0410 06:37:57.512099 2022066 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0410 06:37:58.227730 2022066 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0410 06:37:58.232089 2016026 quantize_finetune_llama.py:225] layer 14 gpu 0
I0410 06:37:58.248102 2022066 data_utils.py:336] using 256 training seqs, 128 validation seqs
