I0324 08:39:20.738709 4089730 config.py:54] PyTorch version 2.6.0 available.
W0324 08:39:21.019680 4089730 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:39:21.909327 4089730 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.54it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.00it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.59it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  7.91it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.03it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.19it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.38it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.11it/s]
I0324 08:39:23.340558 4089730 quantize_finetune_llama.py:150] loaded model
I0324 08:39:23.628867 4089730 quantize_finetune_llama.py:185] loaded compression model
I0324 08:39:41.633106 4089730 quantize_finetune_llama.py:189] loaded dataset and devset
I0324 08:39:47.171726 4089730 quantize_finetune_llama.py:209] layer 0 gpu 0
I0324 08:39:49.451517 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 2.1332216262817383s
Use train scale and shift
tensor(-1.5053e-07, device='cuda:0') tensor(0.0156, device='cuda:0')
tensor(0.0156, device='cuda:0') tensor(-1.5053e-07, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0324 08:40:07.771537 4090345 config.py:54] PyTorch version 2.6.0 available.
W0324 08:40:08.052302 4090345 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:40:08.934018 4090345 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:40:08.938069 4089730 quantize_finetune_llama.py:209] layer 1 gpu 1
I0324 08:40:09.103178 4090345 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:40:13.016701 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 3.9141907691955566s
I0324 08:40:16.412647 4090484 config.py:54] PyTorch version 2.6.0 available.
W0324 08:40:16.690707 4090484 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:40:17.556583 4090484 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:40:17.560404 4089730 quantize_finetune_llama.py:209] layer 2 gpu 2
I0324 08:40:17.865734 4090484 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:40:20.883917 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 3.180274724960327s
I0324 08:40:24.241058 4090630 config.py:54] PyTorch version 2.6.0 available.
W0324 08:40:24.524285 4090630 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:40:25.390304 4090630 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:40:25.394207 4089730 quantize_finetune_llama.py:209] layer 3 gpu 3
I0324 08:40:25.807938 4090630 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:40:28.255553 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 2.726602792739868s
I0324 08:40:31.844396 4090772 config.py:54] PyTorch version 2.6.0 available.
W0324 08:40:32.131810 4090772 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:40:33.047312 4090772 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:40:33.051189 4089730 quantize_finetune_llama.py:209] layer 4 gpu 0
I0324 08:40:33.334152 4090772 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.013733859173953533 tr(WHW.T) 59.12685012817383
bpp_loss 3.4110325515503064
0_q proxy err 8.468770101899281e-05 tr(WHW.T) 288042.3125
bpp_loss 2.7093841615132987
0_k proxy err 6.713192124152556e-05 tr(WHW.T) 100153.140625
bpp_loss 3.8179009179002605
0_o proxy err 0.005205107852816582 tr(WHW.T) 3114.052734375
bpp_loss 2.325228101806715
0_up proxy err 0.06204240024089813 tr(WHW.T) 8860.3681640625
bpp_loss 1.8161902270013732
0_gate proxy err 0.03674330934882164 tr(WHW.T) 15700.7783203125
bpp_loss 1.8876700343431108
0_down proxy err 0.03194107115268707 tr(WHW.T) 10754.4326171875
bpp_loss 2.177541685007912
1_v proxy err 0.03165123984217644 tr(WHW.T) 106.5717544555664
bpp_loss 3.321062954433728
1_q proxy err 0.00020007535931654274 tr(WHW.T) 144770.28125
bpp_loss 2.7845836673513986
1_k proxy err 0.0001135383135988377 tr(WHW.T) 75510.3359375
bpp_loss 3.9662315335008316
1_o proxy err 0.01914464868605137 tr(WHW.T) 1971.9923095703125
bpp_loss 2.222532377229072
1_up proxy err 0.07109110802412033 tr(WHW.T) 8164.80224609375
bpp_loss 1.8265909767110966
1_gate proxy err 0.043716832995414734 tr(WHW.T) 13872.5791015625
bpp_loss 1.8980471778527968
1_down proxy err 0.0006964168278500438 tr(WHW.T) 13912.466796875
bpp_loss 2.243378310148338
I0324 08:42:46.924134 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 1.0800952911376953s
I0324 08:42:50.849804 4092191 config.py:54] PyTorch version 2.6.0 available.
W0324 08:42:51.204705 4092191 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:42:52.288087 4092191 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:42:52.292317 4089730 quantize_finetune_llama.py:209] layer 5 gpu 1
I0324 08:42:52.494591 4092191 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.020827578380703926 tr(WHW.T) 154.19476318359375
bpp_loss 3.348376774985809
2_q proxy err 0.0021252769511193037 tr(WHW.T) 41424.31640625
bpp_loss 2.6438762514153495
2_k proxy err 0.00122758187353611 tr(WHW.T) 22584.57421875
bpp_loss 3.7940170513466
2_o proxy err 0.02109174244105816 tr(WHW.T) 1957.2958984375
bpp_loss 2.1733629846712574
2_up proxy err 0.08449505269527435 tr(WHW.T) 7535.0859375
bpp_loss 1.809600161554824
2_gate proxy err 0.044734761118888855 tr(WHW.T) 15028.9306640625
bpp_loss 1.9083514986227132
2_down proxy err 0.05021001771092415 tr(WHW.T) 7660.9140625
bpp_loss 2.170079273238246
I0324 08:42:55.035669 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 0.9574565887451172s
I0324 08:42:58.729586 4092337 config.py:54] PyTorch version 2.6.0 available.
W0324 08:42:59.058576 4092337 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:43:00.029230 4092337 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:43:00.033166 4089730 quantize_finetune_llama.py:209] layer 6 gpu 2
3_v proxy err 0.016420073807239532 tr(WHW.T) 286.84423828125
bpp_loss 3.3679927841876633
3_q proxy err 0.003188897157087922 tr(WHW.T) 47525.6328125
bpp_loss 2.5254992987029254
3_k proxy err 0.00180243665818125 tr(WHW.T) 26144.59765625
bpp_loss 3.5533460061997175
3_o proxy err 0.029340581968426704 tr(WHW.T) 1844.0562744140625
bpp_loss 2.1748682403122075
3_up proxy err 0.08386826515197754 tr(WHW.T) 7473.4931640625
bpp_loss 1.7960735162986177
3_gate proxy err 0.032770078629255295 tr(WHW.T) 20789.244140625
bpp_loss 1.9640555494198841
3_down proxy err 0.05356445163488388 tr(WHW.T) 6935.875
bpp_loss 2.165124360937625
I0324 08:43:00.265058 4092337 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:43:02.106423 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.8466665744781494s
I0324 08:43:05.553745 4092511 config.py:54] PyTorch version 2.6.0 available.
W0324 08:43:05.834078 4092511 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:43:06.722488 4092511 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:43:06.726319 4089730 quantize_finetune_llama.py:209] layer 7 gpu 3
I0324 08:43:06.881059 4092511 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:43:08.008421 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 0.8301682472229004s
I0324 08:43:11.416189 4092634 config.py:54] PyTorch version 2.6.0 available.
W0324 08:43:11.696262 4092634 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:43:12.598469 4092634 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:43:12.602704 4089730 quantize_finetune_llama.py:209] layer 8 gpu 0
I0324 08:43:12.807963 4092634 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.01963960938155651 tr(WHW.T) 282.4102478027344
bpp_loss 3.351343339367304
4_q proxy err 0.002591946395114064 tr(WHW.T) 50064.87109375
bpp_loss 2.556366166798398
4_k proxy err 0.0013875523582100868 tr(WHW.T) 29273.04296875
bpp_loss 3.620212044683285
4_o proxy err 0.034803055226802826 tr(WHW.T) 1283.5389404296875
bpp_loss 2.186509033665061
4_up proxy err 0.08489812910556793 tr(WHW.T) 7323.67578125
bpp_loss 1.7797970873569804
4_gate proxy err 0.02401476725935936 tr(WHW.T) 29024.958984375
bpp_loss 2.0178084523816193
4_down proxy err 0.0530136413872242 tr(WHW.T) 6336.10888671875
bpp_loss 2.1668699494662826
5_v proxy err 0.01854899898171425 tr(WHW.T) 206.8320770263672
bpp_loss 3.355106529954355
5_q proxy err 0.0035595614463090897 tr(WHW.T) 35942.19921875
bpp_loss 2.559438810625579
5_k proxy err 0.0017604397144168615 tr(WHW.T) 22968.5703125
bpp_loss 3.633269474899862
5_o proxy err 0.0352611169219017 tr(WHW.T) 1043.85205078125
bpp_loss 2.185052189801354
5_up proxy err 0.08221375197172165 tr(WHW.T) 7595.9208984375
bpp_loss 1.7826053487203484
5_gate proxy err 0.023031385615468025 tr(WHW.T) 30281.02734375
bpp_loss 2.0177611514726386
5_down proxy err 0.0525670163333416 tr(WHW.T) 6350.9873046875
bpp_loss 2.1623904143426835
I0324 08:45:27.639970 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.178053379058838s
I0324 08:45:31.463924 4094350 config.py:54] PyTorch version 2.6.0 available.
W0324 08:45:31.807117 4094350 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

6_v proxy err 0.017885925248265266 tr(WHW.T) 251.27548217773438
bpp_loss 3.3506352016120218
6_q proxy err 0.003976786509156227 tr(WHW.T) 35588.1328125
bpp_loss 2.551444807322696
6_k proxy err 0.00169079820625484 tr(WHW.T) 26134.55859375
bpp_loss 3.573054950335063
6_o proxy err 0.04411209747195244 tr(WHW.T) 996.3651733398438
bpp_loss 2.1707951178541407
6_up proxy err 0.07762718200683594 tr(WHW.T) 7863.052734375
bpp_loss 1.7863132942002267
6_gate proxy err 0.019159015268087387 tr(WHW.T) 35641.328125
bpp_loss 2.0282268205857172
6_down proxy err 0.05014719441533089 tr(WHW.T) 6423.478515625
bpp_loss 2.1626106157865643
W0324 08:45:32.778622 4094350 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:45:32.782745 4089730 quantize_finetune_llama.py:209] layer 9 gpu 1
I0324 08:45:32.988238 4094350 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:45:34.913513 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 0.8381061553955078s
I0324 08:45:38.536019 4094505 config.py:54] PyTorch version 2.6.0 available.
W0324 08:45:38.851872 4094505 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:45:39.810565 4094505 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:45:39.814673 4089730 quantize_finetune_llama.py:209] layer 10 gpu 2
I0324 08:45:39.961472 4094505 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.014103374443948269 tr(WHW.T) 307.1083068847656
bpp_loss 3.354309616261162
7_q proxy err 0.004097313154488802 tr(WHW.T) 35097.69140625
bpp_loss 2.487634282093495
7_k proxy err 0.0017167736077681184 tr(WHW.T) 26820.87890625
bpp_loss 3.5497368595097214
7_o proxy err 0.04262252897024155 tr(WHW.T) 945.9965209960938
bpp_loss 2.1703533419640735
7_up proxy err 0.07081729918718338 tr(WHW.T) 8565.2685546875
bpp_loss 1.7979447165437574
7_gate proxy err 0.01921740360558033 tr(WHW.T) 34800.38671875
bpp_loss 2.0121077787064547
7_down proxy err 0.050600629299879074 tr(WHW.T) 6472.80322265625
bpp_loss 2.1650641910964623
I0324 08:45:43.867060 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.8691847324371338s
I0324 08:45:47.187031 4094689 config.py:54] PyTorch version 2.6.0 available.
W0324 08:45:47.468868 4094689 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:45:48.350565 4094689 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:45:48.354530 4089730 quantize_finetune_llama.py:209] layer 11 gpu 3
I0324 08:45:48.541791 4094689 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:45:49.721896 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 0.918473482131958s
I0324 08:45:53.139482 4094812 config.py:54] PyTorch version 2.6.0 available.
W0324 08:45:53.447096 4094812 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:45:54.402904 4094812 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:45:54.407126 4089730 quantize_finetune_llama.py:209] layer 12 gpu 0
I0324 08:45:54.717277 4094812 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.018957823514938354 tr(WHW.T) 255.14593505859375
bpp_loss 3.343268829456065
8_q proxy err 0.005389111582189798 tr(WHW.T) 26553.384765625
bpp_loss 2.503471963631455
8_k proxy err 0.0020504994317889214 tr(WHW.T) 22499.607421875
bpp_loss 3.5520392426406033
8_o proxy err 0.0546908937394619 tr(WHW.T) 731.8719482421875
bpp_loss 2.166731330449693
8_up proxy err 0.07271929085254669 tr(WHW.T) 8433.421875
bpp_loss 1.7958682875281997
8_gate proxy err 0.018249845132231712 tr(WHW.T) 37134.01171875
bpp_loss 2.019083505562906
8_down proxy err 0.050394173711538315 tr(WHW.T) 6427.3955078125
bpp_loss 2.1687352859381854
9_v proxy err 0.019055897369980812 tr(WHW.T) 347.97332763671875
bpp_loss 3.3359160571708344
9_q proxy err 0.005811565089970827 tr(WHW.T) 25605.623046875
bpp_loss 2.4939586072578095
9_k proxy err 0.002299501793459058 tr(WHW.T) 20913.580078125
bpp_loss 3.5322919860482216
9_o proxy err 0.052760642021894455 tr(WHW.T) 760.8590087890625
bpp_loss 2.1900603800313547
9_up proxy err 0.06899842619895935 tr(WHW.T) 8907.896484375
bpp_loss 1.8009792567297285
9_gate proxy err 0.017289744690060616 tr(WHW.T) 39308.97265625
bpp_loss 2.0307932204367325
9_down proxy err 0.05150747671723366 tr(WHW.T) 6211.091796875
bpp_loss 2.1623733927429254
I0324 08:48:07.439485 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 0.9904575347900391s
I0324 08:48:11.406962 4096517 config.py:54] PyTorch version 2.6.0 available.
W0324 08:48:11.753134 4096517 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:48:12.806035 4096517 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:48:12.810374 4089730 quantize_finetune_llama.py:209] layer 13 gpu 1
I0324 08:48:13.041399 4096517 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.018904611468315125 tr(WHW.T) 249.34664916992188
bpp_loss 3.3371016633464023
10_q proxy err 0.005901027005165815 tr(WHW.T) 23288.728515625
bpp_loss 2.5424199257977307
10_k proxy err 0.0022463928908109665 tr(WHW.T) 19714.28515625
bpp_loss 3.6009106104029343
10_o proxy err 0.056051310151815414 tr(WHW.T) 667.2440185546875
bpp_loss 2.1721702202921733
10_up proxy err 0.0682266503572464 tr(WHW.T) 9134.4111328125
bpp_loss 1.8104309457952954
10_gate proxy err 0.01820959709584713 tr(WHW.T) 37297.75
bpp_loss 2.004298925233473
10_down proxy err 0.05129241198301315 tr(WHW.T) 6461.62451171875
bpp_loss 2.1636817908479964
I0324 08:48:17.663496 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 1.008406162261963s
I0324 08:48:21.381452 4096709 config.py:54] PyTorch version 2.6.0 available.
W0324 08:48:21.707968 4096709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.01488907728344202 tr(WHW.T) 317.1318664550781
bpp_loss 3.347550253092777
11_q proxy err 0.0065229544416069984 tr(WHW.T) 22146.5234375
bpp_loss 2.4574500623275526
11_k proxy err 0.0026379497721791267 tr(WHW.T) 17998.525390625
bpp_loss 3.5349696468911134
11_o proxy err 0.05884160101413727 tr(WHW.T) 551.9363403320312
bpp_loss 2.184949217888061
11_up proxy err 0.06680507212877274 tr(WHW.T) 9126.9775390625
bpp_loss 1.8186801916453987
11_gate proxy err 0.01800394058227539 tr(WHW.T) 36784.98046875
bpp_loss 1.994566043805597
11_down proxy err 0.050728507339954376 tr(WHW.T) 6591.28369140625
bpp_loss 2.161916874315856
W0324 08:48:22.626559 4096709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:48:22.630296 4089730 quantize_finetune_llama.py:209] layer 14 gpu 2
I0324 08:48:22.788696 4096709 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:48:24.424283 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 1.0885112285614014s
I0324 08:48:27.794331 4096849 config.py:54] PyTorch version 2.6.0 available.
W0324 08:48:28.076960 4096849 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:48:28.949701 4096849 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:48:28.953635 4089730 quantize_finetune_llama.py:209] layer 15 gpu 3
I0324 08:48:29.141250 4096849 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:48:30.259222 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.8536803722381592s
I0324 08:48:33.689838 4096994 config.py:54] PyTorch version 2.6.0 available.
W0324 08:48:34.012910 4096994 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:48:34.976541 4096994 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:48:34.980614 4089730 quantize_finetune_llama.py:209] layer 16 gpu 0
I0324 08:48:35.158342 4096994 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.01813850924372673 tr(WHW.T) 360.2216491699219
bpp_loss 3.345779547758866
12_q proxy err 0.004512069746851921 tr(WHW.T) 34057.0703125
bpp_loss 2.452333502995316
12_k proxy err 0.0021086197812110186 tr(WHW.T) 23029.533203125
bpp_loss 3.4723885805578902
12_o proxy err 0.05417942628264427 tr(WHW.T) 764.130126953125
bpp_loss 2.176234101818409
12_up proxy err 0.059982992708683014 tr(WHW.T) 9958.9345703125
bpp_loss 1.8391801672655024
12_gate proxy err 0.017314137890934944 tr(WHW.T) 37237.28125
bpp_loss 1.9869029452092946
12_down proxy err 0.049746233969926834 tr(WHW.T) 6756.125
bpp_loss 2.166236698411272
13_v proxy err 0.020225010812282562 tr(WHW.T) 277.2493591308594
bpp_loss 3.3425242173252627
13_q proxy err 0.006947750691324472 tr(WHW.T) 20850.80078125
bpp_loss 2.4910135800018907
13_k proxy err 0.0027039693668484688 tr(WHW.T) 17769.314453125
bpp_loss 3.548348107957281
13_o proxy err 0.056012097746133804 tr(WHW.T) 660.2918090820312
bpp_loss 2.1744905381347053
13_up proxy err 0.05863053724169731 tr(WHW.T) 9941.6767578125
bpp_loss 1.8421206900384277
13_gate proxy err 0.01627657748758793 tr(WHW.T) 38824.0078125
bpp_loss 1.988583398118083
13_down proxy err 0.0509735643863678 tr(WHW.T) 6493.9638671875
bpp_loss 2.163398622202554
I0324 08:50:51.909945 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 1.0271975994110107s
I0324 08:50:55.776584 4098758 config.py:54] PyTorch version 2.6.0 available.
W0324 08:50:56.130576 4098758 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:50:57.200161 4098758 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:50:57.204216 4089730 quantize_finetune_llama.py:209] layer 17 gpu 1
I0324 08:50:57.394959 4098758 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.019527770578861237 tr(WHW.T) 278.4917907714844
bpp_loss 3.3437600025208667
14_q proxy err 0.006380327511578798 tr(WHW.T) 20837.234375
bpp_loss 2.4853057348518632
14_k proxy err 0.0023924773558974266 tr(WHW.T) 18590.26171875
bpp_loss 3.5770228364272043
14_o proxy err 0.054969362914562225 tr(WHW.T) 671.5200805664062
bpp_loss 2.1773168027284555
14_up proxy err 0.06281076371669769 tr(WHW.T) 9096.203125
bpp_loss 1.8426646756873066
14_gate proxy err 0.01515920739620924 tr(WHW.T) 41683.65625
bpp_loss 2.0111667182562605
14_down proxy err 0.05343015119433403 tr(WHW.T) 6324.6708984375
bpp_loss 2.1705685428376973
I0324 08:50:59.954133 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.8968167304992676s
15_v proxy err 0.023336010053753853 tr(WHW.T) 280.6507568359375
bpp_loss 3.345610957359895
15_q proxy err 0.005597343202680349 tr(WHW.T) 28024.77734375
bpp_loss 2.575340895971749
15_k proxy err 0.0025718703400343657 tr(WHW.T) 18843.455078125
bpp_loss 3.5116083725588396
15_o proxy err 0.053339846432209015 tr(WHW.T) 812.0530395507812
bpp_loss 2.1979500385350548
15_up proxy err 0.06415297836065292 tr(WHW.T) 8927.576171875
bpp_loss 1.8339668683973807
15_gate proxy err 0.013905645348131657 tr(WHW.T) 46110.5703125
bpp_loss 2.0349328372560973
15_down proxy err 0.05250139907002449 tr(WHW.T) 6333.8271484375
bpp_loss 2.169892009563877
I0324 08:51:03.355533 4098903 config.py:54] PyTorch version 2.6.0 available.
W0324 08:51:03.637354 4098903 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:51:04.531074 4098903 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:51:04.534886 4089730 quantize_finetune_llama.py:209] layer 18 gpu 2
I0324 08:51:04.677300 4098903 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:51:05.814828 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.8433406352996826s
I0324 08:51:09.212052 4099043 config.py:54] PyTorch version 2.6.0 available.
W0324 08:51:09.496656 4099043 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:51:10.383965 4099043 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:51:10.387832 4089730 quantize_finetune_llama.py:209] layer 19 gpu 3
I0324 08:51:10.536648 4099043 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:51:11.756266 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 19 in 0.9085016250610352s
I0324 08:51:15.182749 4099188 config.py:54] PyTorch version 2.6.0 available.
W0324 08:51:15.480242 4099188 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:51:16.401663 4099188 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:51:16.405344 4089730 quantize_finetune_llama.py:209] layer 20 gpu 0
I0324 08:51:16.564155 4099188 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.02115260437130928 tr(WHW.T) 271.31622314453125
bpp_loss 3.3514011836377904
16_q proxy err 0.005570667330175638 tr(WHW.T) 24435.859375
bpp_loss 2.56730477133533
16_k proxy err 0.0022319264244288206 tr(WHW.T) 19477.728515625
bpp_loss 3.59151229361305
16_o proxy err 0.046732500195503235 tr(WHW.T) 953.9540405273438
bpp_loss 2.186985149164684
16_up proxy err 0.07286343723535538 tr(WHW.T) 8266.0234375
bpp_loss 1.8158090292542641
16_gate proxy err 0.016535446047782898 tr(WHW.T) 41063.65234375
bpp_loss 2.053503427288628
16_down proxy err 0.0547976940870285 tr(WHW.T) 6224.45166015625
bpp_loss 2.1649658795712248
17_v proxy err 0.025406239554286003 tr(WHW.T) 280.38623046875
bpp_loss 3.346878607815597
17_q proxy err 0.005596661474555731 tr(WHW.T) 27519.69921875
bpp_loss 2.5484980340697803
17_k proxy err 0.0028331668581813574 tr(WHW.T) 17400.859375
bpp_loss 3.528733951796312
17_o proxy err 0.04439939931035042 tr(WHW.T) 1090.4486083984375
bpp_loss 2.2082799480995163
17_up proxy err 0.07208527624607086 tr(WHW.T) 8387.9111328125
bpp_loss 1.810425934381783
17_gate proxy err 0.01643289253115654 tr(WHW.T) 41602.7890625
bpp_loss 2.0622094170456484
17_down proxy err 0.0552629716694355 tr(WHW.T) 6148.6953125
bpp_loss 2.164742808223569
I0324 08:53:31.016781 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 20 in 1.3026456832885742s
I0324 08:53:34.925885 4100906 config.py:54] PyTorch version 2.6.0 available.
W0324 08:53:35.280021 4100906 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:53:36.426708 4100906 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:53:36.431033 4089730 quantize_finetune_llama.py:209] layer 21 gpu 1
I0324 08:53:36.607258 4100906 data_utils.py:336] using 256 training seqs, 128 validation seqs
18_v proxy err 0.020180772989988327 tr(WHW.T) 284.69989013671875
bpp_loss 3.3591420594602823
18_q proxy err 0.006949619855731726 tr(WHW.T) 22349.49609375
bpp_loss 2.521128992724698
18_k proxy err 0.0029568285681307316 tr(WHW.T) 17364.392578125
bpp_loss 3.536562390974723
18_o proxy err 0.04585575312376022 tr(WHW.T) 1187.7923583984375
bpp_loss 2.195534195518121
18_up proxy err 0.07979866862297058 tr(WHW.T) 7918.9404296875
bpp_loss 1.7995500502043538
18_gate proxy err 0.020277129486203194 tr(WHW.T) 35128.28125
bpp_loss 2.0595049797557294
18_down proxy err 0.05723738297820091 tr(WHW.T) 6163.37109375
bpp_loss 2.160923986047107
I0324 08:53:39.704909 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 21 in 0.9987387657165527s
19_v proxy err 0.019413741305470467 tr(WHW.T) 337.79034423828125
bpp_loss 3.364282567985356
19_q proxy err 0.006683810148388147 tr(WHW.T) 23987.85546875
bpp_loss 2.51479115820257
19_k proxy err 0.003280764212831855 tr(WHW.T) 15525.201171875
bpp_loss 3.4818310649716295
19_o proxy err 0.051149316132068634 tr(WHW.T) 1153.098876953125
bpp_loss 2.1833096596528776
19_up proxy err 0.08466870337724686 tr(WHW.T) 7585.85546875
bpp_loss 1.794329121775393
19_gate proxy err 0.022171925753355026 tr(WHW.T) 32695.314453125
bpp_loss 2.0645976295096
19_down proxy err 0.05854828655719757 tr(WHW.T) 6119.80810546875
bpp_loss 2.1615830009769916
I0324 08:53:43.356561 4101087 config.py:54] PyTorch version 2.6.0 available.
W0324 08:53:43.638118 4101087 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:53:44.515242 4101087 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:53:44.519047 4089730 quantize_finetune_llama.py:209] layer 22 gpu 2
I0324 08:53:44.674224 4101087 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:53:45.862588 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 22 in 0.9222619533538818s
I0324 08:53:49.219780 4101228 config.py:54] PyTorch version 2.6.0 available.
W0324 08:53:49.504442 4101228 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:53:50.381171 4101228 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:53:50.385013 4089730 quantize_finetune_llama.py:209] layer 23 gpu 3
I0324 08:53:50.525601 4101228 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:53:51.696788 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 23 in 0.8759987354278564s
I0324 08:53:55.068778 4101365 config.py:54] PyTorch version 2.6.0 available.
W0324 08:53:55.388134 4101365 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:53:56.308178 4101365 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:53:56.311905 4089730 quantize_finetune_llama.py:209] layer 24 gpu 0
I0324 08:53:56.526238 4101365 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.022363699972629547 tr(WHW.T) 326.5905456542969
bpp_loss 3.35537180013489
20_q proxy err 0.007343325763940811 tr(WHW.T) 20688.703125
bpp_loss 2.5211584107019007
20_k proxy err 0.0031889788806438446 tr(WHW.T) 15368.4912109375
bpp_loss 3.490363967837766
20_o proxy err 0.05097809433937073 tr(WHW.T) 1189.6593017578125
bpp_loss 2.1859034844092093
20_up proxy err 0.08615804463624954 tr(WHW.T) 7535.79443359375
bpp_loss 1.7952270782885276
20_gate proxy err 0.023950934410095215 tr(WHW.T) 30548.365234375
bpp_loss 2.0629150637625053
20_down proxy err 0.05844767764210701 tr(WHW.T) 6237.4736328125
bpp_loss 2.1594789835424826
21_v proxy err 0.02165917493402958 tr(WHW.T) 359.03216552734375
bpp_loss 3.3597689936868846
21_q proxy err 0.005986947566270828 tr(WHW.T) 25790.224609375
bpp_loss 2.4975364357815124
21_k proxy err 0.0029679862782359123 tr(WHW.T) 16759.76171875
bpp_loss 3.4920053586829454
21_o proxy err 0.0385652557015419 tr(WHW.T) 1250.4415283203125
bpp_loss 2.220008098462131
21_up proxy err 0.08271094411611557 tr(WHW.T) 7708.326171875
bpp_loss 1.7981884075062615
21_gate proxy err 0.022893734276294708 tr(WHW.T) 31447.8125
bpp_loss 2.0727999905523444
21_down proxy err 0.05695952847599983 tr(WHW.T) 6287.7109375
bpp_loss 2.1599948201328516
I0324 08:56:15.861609 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 24 in 1.0210862159729004s
22_v proxy err 0.024656478315591812 tr(WHW.T) 341.8212890625
bpp_loss 3.3458175358828157
22_q proxy err 0.007015346549451351 tr(WHW.T) 20274.177734375
bpp_loss 2.4867250930401497
22_k proxy err 0.0031598443165421486 tr(WHW.T) 14697.5322265625
bpp_loss 3.49667286319891
22_o proxy err 0.057372935116291046 tr(WHW.T) 1205.021240234375
bpp_loss 2.1706302925013006
22_up proxy err 0.08651851117610931 tr(WHW.T) 7482.60498046875
bpp_loss 1.797964523446613
22_gate proxy err 0.02471793256700039 tr(WHW.T) 29415.544921875
bpp_loss 2.0721183423884213
22_down proxy err 0.05659780278801918 tr(WHW.T) 6465.3056640625
bpp_loss 2.160244624878812
I0324 08:56:19.628879 4103166 config.py:54] PyTorch version 2.6.0 available.
W0324 08:56:19.952780 4103166 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:56:20.922295 4103166 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:56:20.926873 4089730 quantize_finetune_llama.py:209] layer 25 gpu 1
I0324 08:56:21.101856 4103166 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:56:22.482742 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 25 in 1.070439100265503s
23_v proxy err 0.023927906528115273 tr(WHW.T) 393.1842041015625
bpp_loss 3.347659008926712
23_q proxy err 0.006894524209201336 tr(WHW.T) 22563.107421875
bpp_loss 2.461562456737738
23_k proxy err 0.003357268637046218 tr(WHW.T) 14831.095703125
bpp_loss 3.4427414543461055
23_o proxy err 0.04694854095578194 tr(WHW.T) 1727.0145263671875
bpp_loss 2.175947093463037
23_up proxy err 0.08811809122562408 tr(WHW.T) 7354.04541015625
bpp_loss 1.7999545751871275
23_gate proxy err 0.026699399575591087 tr(WHW.T) 27172.716796875
bpp_loss 2.0740594828967005
23_down proxy err 0.05758414790034294 tr(WHW.T) 6602.26123046875
bpp_loss 2.158652163426658
I0324 08:56:26.250843 4103327 config.py:54] PyTorch version 2.6.0 available.
W0324 08:56:26.526400 4103327 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:56:27.430117 4103327 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:56:27.433896 4089730 quantize_finetune_llama.py:209] layer 26 gpu 2
I0324 08:56:27.619140 4103327 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:56:28.714198 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 26 in 0.8380382061004639s
I0324 08:56:32.118391 4103460 config.py:54] PyTorch version 2.6.0 available.
W0324 08:56:32.401679 4103460 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:56:33.268771 4103460 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:56:33.272594 4089730 quantize_finetune_llama.py:209] layer 27 gpu 3
I0324 08:56:33.493839 4103460 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:56:34.579174 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 27 in 0.8581440448760986s
I0324 08:56:37.907098 4103601 config.py:54] PyTorch version 2.6.0 available.
W0324 08:56:38.225478 4103601 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:56:39.146281 4103601 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:56:39.150015 4089730 quantize_finetune_llama.py:209] layer 28 gpu 0
I0324 08:56:39.322575 4103601 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.024458952248096466 tr(WHW.T) 461.59027099609375
bpp_loss 3.3500713657122105
24_q proxy err 0.006722539197653532 tr(WHW.T) 22391.7734375
bpp_loss 2.450572804082185
24_k proxy err 0.003273009555414319 tr(WHW.T) 14159.55078125
bpp_loss 3.4121344812447205
24_o proxy err 0.050030749291181564 tr(WHW.T) 1570.388427734375
bpp_loss 2.1912568755215034
24_up proxy err 0.09052584320306778 tr(WHW.T) 7245.40576171875
bpp_loss 1.8016834991451884
24_gate proxy err 0.02846314199268818 tr(WHW.T) 25757.33203125
bpp_loss 2.077906708199797
24_down proxy err 0.05874466523528099 tr(WHW.T) 6676.57958984375
bpp_loss 2.1546856195200235
25_v proxy err 0.02083677425980568 tr(WHW.T) 552.045654296875
bpp_loss 3.353554095083382
25_q proxy err 0.005929388105869293 tr(WHW.T) 26069.1015625
bpp_loss 2.418533250456676
25_k proxy err 0.0032487637363374233 tr(WHW.T) 14392.994140625
bpp_loss 3.4038347809109837
25_o proxy err 0.041003696620464325 tr(WHW.T) 1971.1920166015625
bpp_loss 2.2025007387273945
25_up proxy err 0.08972114324569702 tr(WHW.T) 7315.31396484375
bpp_loss 1.8080897411730672
25_gate proxy err 0.02798992395401001 tr(WHW.T) 26185.79296875
bpp_loss 2.0864145054947585
25_down proxy err 0.061640314757823944 tr(WHW.T) 6549.46630859375
bpp_loss 2.153404610397826
I0324 08:59:00.472622 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 28 in 1.0239181518554688s
I0324 08:59:04.527190 4105391 config.py:54] PyTorch version 2.6.0 available.
W0324 08:59:04.910408 4105391 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.029733851552009583 tr(WHW.T) 428.18212890625
bpp_loss 3.3378551257774234
26_q proxy err 0.006832279730588198 tr(WHW.T) 21359.736328125
bpp_loss 2.4492162734968588
26_k proxy err 0.003039309987798333 tr(WHW.T) 15400.359375
bpp_loss 3.4464733202476054
26_o proxy err 0.02964049018919468 tr(WHW.T) 2368.6396484375
bpp_loss 2.22505274892319
26_up proxy err 0.0868133157491684 tr(WHW.T) 7577.68359375
bpp_loss 1.8143202831103866
26_gate proxy err 0.025527039542794228 tr(WHW.T) 28778.099609375
bpp_loss 2.0945950070994774
26_down proxy err 0.0624556764960289 tr(WHW.T) 6551.21533203125
bpp_loss 2.155725857991326
W0324 08:59:06.060609 4105391 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:59:06.064846 4089730 quantize_finetune_llama.py:209] layer 29 gpu 1
I0324 08:59:06.250972 4105391 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:59:08.272307 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 29 in 0.8922634124755859s
I0324 08:59:11.848240 4105548 config.py:54] PyTorch version 2.6.0 available.
W0324 08:59:12.165612 4105548 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:59:13.147086 4105548 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:59:13.151081 4089730 quantize_finetune_llama.py:209] layer 30 gpu 2
I0324 08:59:13.324856 4105548 data_utils.py:336] using 256 training seqs, 128 validation seqs
27_v proxy err 0.0218253955245018 tr(WHW.T) 670.343017578125
bpp_loss 3.353546216210816
27_q proxy err 0.0072235772386193275 tr(WHW.T) 21263.849609375
bpp_loss 2.408608313940931
27_k proxy err 0.0034309313632547855 tr(WHW.T) 13986.966796875
bpp_loss 3.405965054873377
27_o proxy err 0.03434445708990097 tr(WHW.T) 2138.783203125
bpp_loss 2.223279733909294
27_up proxy err 0.07940265536308289 tr(WHW.T) 8405.8671875
bpp_loss 1.8218282314483076
27_gate proxy err 0.022745156660676003 tr(WHW.T) 32683.65234375
bpp_loss 2.1025684079421416
27_down proxy err 0.05768946185708046 tr(WHW.T) 6474.22314453125
bpp_loss 2.153454238814967
I0324 08:59:15.524888 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 30 in 0.8091599941253662s
I0324 08:59:18.897115 4105703 config.py:54] PyTorch version 2.6.0 available.
W0324 08:59:19.182973 4105703 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:59:20.080150 4105703 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:59:20.084083 4089730 quantize_finetune_llama.py:209] layer 31 gpu 3
I0324 08:59:20.310824 4105703 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 08:59:21.559868 4089730 quantize_finetune_llama.py:240] computed original embedding for layer 31 in 1.0365333557128906s
I0324 08:59:24.970787 4105843 config.py:54] PyTorch version 2.6.0 available.
W0324 08:59:25.256818 4105843 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 08:59:26.145149 4105843 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 08:59:26.353184 4105843 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.02644839510321617 tr(WHW.T) 593.5634155273438
bpp_loss 3.342823961400427
28_q proxy err 0.006629172712564468 tr(WHW.T) 23121.744140625
bpp_loss 2.4066035540308803
28_k proxy err 0.0029512939509004354 tr(WHW.T) 14971.8525390625
bpp_loss 3.392580410814844
28_o proxy err 0.03053639456629753 tr(WHW.T) 2489.129638671875
bpp_loss 2.2417715374031104
28_up proxy err 0.06421176344156265 tr(WHW.T) 10173.3935546875
bpp_loss 1.8409148498571344
28_gate proxy err 0.02016279473900795 tr(WHW.T) 35797.04296875
bpp_loss 2.098245965982122
28_down proxy err 0.05141006037592888 tr(WHW.T) 7138.55908203125
bpp_loss 2.1883888841174275
29_v proxy err 0.019870372489094734 tr(WHW.T) 841.8088989257812
bpp_loss 3.357623776246328
29_q proxy err 0.008055828511714935 tr(WHW.T) 20611.560546875
bpp_loss 2.349563109863084
29_k proxy err 0.002871310105547309 tr(WHW.T) 16341.275390625
bpp_loss 3.3955627445830032
29_o proxy err 0.01980752684175968 tr(WHW.T) 3078.978271484375
bpp_loss 2.3101250917534344
29_up proxy err 0.05019620433449745 tr(WHW.T) 12791.73828125
bpp_loss 1.862838946748525
29_gate proxy err 0.018330678343772888 tr(WHW.T) 38241.23046875
bpp_loss 2.0957068289364025
29_down proxy err 0.0423087552189827 tr(WHW.T) 7396.3740234375
bpp_loss 2.2281239642096415
30_v proxy err 0.02727930061519146 tr(WHW.T) 850.650634765625
bpp_loss 3.3467634051921777
30_q proxy err 0.005905854050070047 tr(WHW.T) 24012.763671875
bpp_loss 2.3495289416750893
30_k proxy err 0.002421965589746833 tr(WHW.T) 14011.7353515625
bpp_loss 3.398565855808556
30_o proxy err 0.017197711393237114 tr(WHW.T) 4841.84814453125
bpp_loss 2.2671924600726925
30_up proxy err 0.029696540907025337 tr(WHW.T) 21630.490234375
bpp_loss 1.8809609989901739
30_gate proxy err 0.013564188033342361 tr(WHW.T) 51822.3203125
bpp_loss 2.135407827861075
30_down proxy err 0.021578660234808922 tr(WHW.T) 8734.9560546875
bpp_loss 2.296915579587221
31_v proxy err 0.009442070499062538 tr(WHW.T) 1798.8880615234375
bpp_loss 3.383995655865874
31_q proxy err 0.0034166285768151283 tr(WHW.T) 46129.9609375
bpp_loss 2.391436013043858
31_k proxy err 0.0018099674489349127 tr(WHW.T) 20445.2890625
bpp_loss 3.4142445314791985
31_o proxy err 0.011521550826728344 tr(WHW.T) 2186.948974609375
bpp_loss 2.3903432227671146
31_up proxy err 0.009206741116940975 tr(WHW.T) 68910.7734375
bpp_loss 2.0232476320317283
31_gate proxy err 0.00479078060016036 tr(WHW.T) 144280.90625
bpp_loss 2.310438971567367
31_down proxy err 0.005322087090462446 tr(WHW.T) 9880.068359375
bpp_loss 2.415491328923963
I0324 09:02:12.219458 4107914 config.py:54] PyTorch version 2.6.0 available.
W0324 09:02:12.537502 4107914 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 09:02:12.785676 4107914 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  3.06it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:01,  4.31it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  5.09it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  4.96it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:01<00:00,  5.34it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  5.08it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  4.14it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:01,  4.60it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  4.97it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  4.83it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:01<00:00,  5.17it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  5.51it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.08it/s]
I0324 09:02:17.268130 4107914 hfize_llama.py:153] loaded layer 0
I0324 09:02:18.043792 4107914 hfize_llama.py:153] loaded layer 1
I0324 09:02:18.667967 4107914 hfize_llama.py:153] loaded layer 2
I0324 09:02:19.265404 4107914 hfize_llama.py:153] loaded layer 3
I0324 09:02:19.899138 4107914 hfize_llama.py:153] loaded layer 4
I0324 09:02:20.641807 4107914 hfize_llama.py:153] loaded layer 5
I0324 09:02:21.262285 4107914 hfize_llama.py:153] loaded layer 6
I0324 09:02:21.846510 4107914 hfize_llama.py:153] loaded layer 7
I0324 09:02:22.440656 4107914 hfize_llama.py:153] loaded layer 8
I0324 09:02:23.020785 4107914 hfize_llama.py:153] loaded layer 9
I0324 09:02:23.592836 4107914 hfize_llama.py:153] loaded layer 10
I0324 09:02:24.175254 4107914 hfize_llama.py:153] loaded layer 11
I0324 09:02:24.736677 4107914 hfize_llama.py:153] loaded layer 12
I0324 09:02:25.337076 4107914 hfize_llama.py:153] loaded layer 13
I0324 09:02:25.927904 4107914 hfize_llama.py:153] loaded layer 14
I0324 09:02:26.530584 4107914 hfize_llama.py:153] loaded layer 15
I0324 09:02:27.091631 4107914 hfize_llama.py:153] loaded layer 16
I0324 09:02:27.629759 4107914 hfize_llama.py:153] loaded layer 17
I0324 09:02:28.203387 4107914 hfize_llama.py:153] loaded layer 18
I0324 09:02:28.771359 4107914 hfize_llama.py:153] loaded layer 19
I0324 09:02:29.374210 4107914 hfize_llama.py:153] loaded layer 20
I0324 09:02:29.915903 4107914 hfize_llama.py:153] loaded layer 21
I0324 09:02:30.467914 4107914 hfize_llama.py:153] loaded layer 22
I0324 09:02:30.967019 4107914 hfize_llama.py:153] loaded layer 23
I0324 09:02:31.584588 4107914 hfize_llama.py:153] loaded layer 24
I0324 09:02:32.140916 4107914 hfize_llama.py:153] loaded layer 25
I0324 09:02:32.703224 4107914 hfize_llama.py:153] loaded layer 26
I0324 09:02:33.279181 4107914 hfize_llama.py:153] loaded layer 27
I0324 09:02:33.916742 4107914 hfize_llama.py:153] loaded layer 28
I0324 09:02:34.504013 4107914 hfize_llama.py:153] loaded layer 29
I0324 09:02:35.138462 4107914 hfize_llama.py:153] loaded layer 30
I0324 09:02:35.703868 4107914 hfize_llama.py:153] loaded layer 31
I0324 09:02:35.703978 4107914 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:06,  1.11s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.02s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.09s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.10s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.08s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.02it/s]
I0324 09:03:16.227554 4107914 hfize_llama.py:167] successfully loaded hfized model
W0324 09:03:20.434161 4109016 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 09:03:20.955115 4109016 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:05,  1.00it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.24s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.30s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:06<00:02,  1.27s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:07<00:01,  1.22s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.03s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.13s/it]
I0324 09:03:29.354861 4109016 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 2.130955696105957:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 2.130955696105957:   1%|          | 1/141 [00:01<04:26,  1.90s/it]avg_loss = 2.5499720573425293:   1%|          | 1/141 [00:03<04:26,  1.90s/it]avg_loss = 2.5499720573425293:   1%|▏         | 2/141 [00:03<03:46,  1.63s/it]avg_loss = 2.6728854179382324:   1%|▏         | 2/141 [00:04<03:46,  1.63s/it]avg_loss = 2.6728854179382324:   2%|▏         | 3/141 [00:04<03:33,  1.55s/it]avg_loss = 2.618884861469269:   2%|▏         | 3/141 [00:06<03:33,  1.55s/it] avg_loss = 2.618884861469269:   3%|▎         | 4/141 [00:06<03:26,  1.51s/it]avg_loss = 2.564708614349365:   3%|▎         | 4/141 [00:07<03:26,  1.51s/it]avg_loss = 2.564708614349365:   4%|▎         | 5/141 [00:07<03:22,  1.49s/it]avg_loss = 2.5244863430658975:   4%|▎         | 5/141 [00:09<03:22,  1.49s/it]avg_loss = 2.5244863430658975:   4%|▍         | 6/141 [00:09<03:19,  1.48s/it]avg_loss = 2.5032385076795305:   4%|▍         | 6/141 [00:10<03:19,  1.48s/it]avg_loss = 2.5032385076795305:   5%|▍         | 7/141 [00:10<03:17,  1.48s/it]avg_loss = 2.478364735841751:   5%|▍         | 7/141 [00:12<03:17,  1.48s/it] avg_loss = 2.478364735841751:   6%|▌         | 8/141 [00:12<03:16,  1.47s/it]avg_loss = 2.5216921965281167:   6%|▌         | 8/141 [00:13<03:16,  1.47s/it]avg_loss = 2.5216921965281167:   6%|▋         | 9/141 [00:13<03:14,  1.47s/it]avg_loss = 2.500384879112244:   6%|▋         | 9/141 [00:15<03:14,  1.47s/it] avg_loss = 2.500384879112244:   7%|▋         | 10/141 [00:15<03:13,  1.47s/it]avg_loss = 2.48442740873857:   7%|▋         | 10/141 [00:16<03:13,  1.47s/it] avg_loss = 2.48442740873857:   8%|▊         | 11/141 [00:16<03:12,  1.48s/it]avg_loss = 2.495922883351644:   8%|▊         | 11/141 [00:18<03:12,  1.48s/it]avg_loss = 2.495922883351644:   9%|▊         | 12/141 [00:18<03:10,  1.48s/it]avg_loss = 2.49238344339224:   9%|▊         | 12/141 [00:19<03:10,  1.48s/it] avg_loss = 2.49238344339224:   9%|▉         | 13/141 [00:19<03:09,  1.48s/it]avg_loss = 2.501599975994655:   9%|▉         | 13/141 [00:20<03:09,  1.48s/it]avg_loss = 2.501599975994655:  10%|▉         | 14/141 [00:20<03:08,  1.48s/it]avg_loss = 2.4996641159057615:  10%|▉         | 14/141 [00:22<03:08,  1.48s/it]avg_loss = 2.4996641159057615:  11%|█         | 15/141 [00:22<03:07,  1.48s/it]avg_loss = 2.5331806987524033:  11%|█         | 15/141 [00:23<03:07,  1.48s/it]avg_loss = 2.5331806987524033:  11%|█▏        | 16/141 [00:23<03:05,  1.49s/it]avg_loss = 2.5354249196894028:  11%|█▏        | 16/141 [00:25<03:05,  1.49s/it]avg_loss = 2.5354249196894028:  12%|█▏        | 17/141 [00:25<03:04,  1.49s/it]avg_loss = 2.535542289415995:  12%|█▏        | 17/141 [00:26<03:04,  1.49s/it] avg_loss = 2.535542289415995:  13%|█▎        | 18/141 [00:26<03:03,  1.49s/it]avg_loss = 2.51678655022069:  13%|█▎        | 18/141 [00:28<03:03,  1.49s/it] avg_loss = 2.51678655022069:  13%|█▎        | 19/141 [00:28<03:02,  1.50s/it]avg_loss = 2.5191295385360717:  13%|█▎        | 19/141 [00:29<03:02,  1.50s/it]avg_loss = 2.5191295385360717:  14%|█▍        | 20/141 [00:29<03:01,  1.50s/it]avg_loss = 2.519106864929199:  14%|█▍        | 20/141 [00:31<03:01,  1.50s/it] avg_loss = 2.519106864929199:  15%|█▍        | 21/141 [00:31<03:00,  1.50s/it]avg_loss = 2.5139418732036245:  15%|█▍        | 21/141 [00:32<03:00,  1.50s/it]avg_loss = 2.5139418732036245:  16%|█▌        | 22/141 [00:32<02:58,  1.50s/it]avg_loss = 2.5198759618012803:  16%|█▌        | 22/141 [00:34<02:58,  1.50s/it]avg_loss = 2.5198759618012803:  16%|█▋        | 23/141 [00:34<02:57,  1.51s/it]avg_loss = 2.5227835178375244:  16%|█▋        | 23/141 [00:36<02:57,  1.51s/it]avg_loss = 2.5227835178375244:  17%|█▋        | 24/141 [00:36<02:56,  1.51s/it]avg_loss = 2.529436206817627:  17%|█▋        | 24/141 [00:37<02:56,  1.51s/it] avg_loss = 2.529436206817627:  18%|█▊        | 25/141 [00:37<02:55,  1.51s/it]avg_loss = 2.5463443260926466:  18%|█▊        | 25/141 [00:39<02:55,  1.51s/it]avg_loss = 2.5463443260926466:  18%|█▊        | 26/141 [00:39<02:54,  1.51s/it]avg_loss = 2.554260147942437:  18%|█▊        | 26/141 [00:40<02:54,  1.51s/it] avg_loss = 2.554260147942437:  19%|█▉        | 27/141 [00:40<02:52,  1.52s/it]avg_loss = 2.562770766871316:  19%|█▉        | 27/141 [00:42<02:52,  1.52s/it]avg_loss = 2.562770766871316:  20%|█▉        | 28/141 [00:42<02:51,  1.52s/it]avg_loss = 2.5640055475563837:  20%|█▉        | 28/141 [00:43<02:51,  1.52s/it]avg_loss = 2.5640055475563837:  21%|██        | 29/141 [00:43<02:50,  1.52s/it]avg_loss = 2.5570560614267985:  21%|██        | 29/141 [00:45<02:50,  1.52s/it]avg_loss = 2.5570560614267985:  21%|██▏       | 30/141 [00:45<02:49,  1.52s/it]avg_loss = 2.5461459775124826:  21%|██▏       | 30/141 [00:46<02:49,  1.52s/it]avg_loss = 2.5461459775124826:  22%|██▏       | 31/141 [00:46<02:47,  1.53s/it]avg_loss = 2.535903424024582:  22%|██▏       | 31/141 [00:48<02:47,  1.53s/it] avg_loss = 2.535903424024582:  23%|██▎       | 32/141 [00:48<02:46,  1.53s/it]avg_loss = 2.53333627093922:  23%|██▎       | 32/141 [00:49<02:46,  1.53s/it] avg_loss = 2.53333627093922:  23%|██▎       | 33/141 [00:49<02:45,  1.53s/it]avg_loss = 2.5283911298303043:  23%|██▎       | 33/141 [00:51<02:45,  1.53s/it]avg_loss = 2.5283911298303043:  24%|██▍       | 34/141 [00:51<02:43,  1.53s/it]avg_loss = 2.5429560252598353:  24%|██▍       | 34/141 [00:52<02:43,  1.53s/it]avg_loss = 2.5429560252598353:  25%|██▍       | 35/141 [00:52<02:42,  1.53s/it]avg_loss = 2.5229333440462747:  25%|██▍       | 35/141 [00:54<02:42,  1.53s/it]avg_loss = 2.5229333440462747:  26%|██▌       | 36/141 [00:54<02:41,  1.54s/it]avg_loss = 2.5054175467104525:  26%|██▌       | 36/141 [00:55<02:41,  1.54s/it]avg_loss = 2.5054175467104525:  26%|██▌       | 37/141 [00:55<02:39,  1.54s/it]avg_loss = 2.491695109166597:  26%|██▌       | 37/141 [00:57<02:39,  1.54s/it] avg_loss = 2.491695109166597:  27%|██▋       | 38/141 [00:57<02:38,  1.54s/it]avg_loss = 2.483315632893489:  27%|██▋       | 38/141 [00:58<02:38,  1.54s/it]avg_loss = 2.483315632893489:  28%|██▊       | 39/141 [00:58<02:37,  1.54s/it]avg_loss = 2.498409849405289:  28%|██▊       | 39/141 [01:00<02:37,  1.54s/it]avg_loss = 2.498409849405289:  28%|██▊       | 40/141 [01:00<02:35,  1.54s/it]avg_loss = 2.5041184716108367:  28%|██▊       | 40/141 [01:02<02:35,  1.54s/it]avg_loss = 2.5041184716108367:  29%|██▉       | 41/141 [01:02<02:34,  1.54s/it]avg_loss = 2.5197675228118896:  29%|██▉       | 41/141 [01:03<02:34,  1.54s/it]avg_loss = 2.5197675228118896:  30%|██▉       | 42/141 [01:03<02:33,  1.55s/it]avg_loss = 2.5352716224138128:  30%|██▉       | 42/141 [01:05<02:33,  1.55s/it]avg_loss = 2.5352716224138128:  30%|███       | 43/141 [01:05<02:31,  1.55s/it]avg_loss = 2.5402855602177707:  30%|███       | 43/141 [01:06<02:31,  1.55s/it]avg_loss = 2.5402855602177707:  31%|███       | 44/141 [01:06<02:30,  1.55s/it]avg_loss = 2.5551467153761123:  31%|███       | 44/141 [01:08<02:30,  1.55s/it]avg_loss = 2.5551467153761123:  32%|███▏      | 45/141 [01:08<02:28,  1.55s/it]avg_loss = 2.556322543517403:  32%|███▏      | 45/141 [01:09<02:28,  1.55s/it] avg_loss = 2.556322543517403:  33%|███▎      | 46/141 [01:09<02:27,  1.55s/it]avg_loss = 2.55986580442875:  33%|███▎      | 46/141 [01:11<02:27,  1.55s/it] avg_loss = 2.55986580442875:  33%|███▎      | 47/141 [01:11<02:26,  1.55s/it]avg_loss = 2.558808128039042:  33%|███▎      | 47/141 [01:12<02:26,  1.55s/it]avg_loss = 2.558808128039042:  34%|███▍      | 48/141 [01:12<02:24,  1.55s/it]avg_loss = 2.557060197908051:  34%|███▍      | 48/141 [01:14<02:24,  1.55s/it]avg_loss = 2.557060197908051:  35%|███▍      | 49/141 [01:14<02:23,  1.55s/it]avg_loss = 2.553942012786865:  35%|███▍      | 49/141 [01:16<02:23,  1.55s/it]avg_loss = 2.553942012786865:  35%|███▌      | 50/141 [01:16<02:21,  1.56s/it]avg_loss = 2.5545932124642765:  35%|███▌      | 50/141 [01:17<02:21,  1.56s/it]avg_loss = 2.5545932124642765:  36%|███▌      | 51/141 [01:17<02:20,  1.56s/it]avg_loss = 2.5478335939920864:  36%|███▌      | 51/141 [01:19<02:20,  1.56s/it]avg_loss = 2.5478335939920864:  37%|███▋      | 52/141 [01:19<02:18,  1.56s/it]avg_loss = 2.5417630672454834:  37%|███▋      | 52/141 [01:20<02:18,  1.56s/it]avg_loss = 2.5417630672454834:  38%|███▊      | 53/141 [01:20<02:17,  1.56s/it]avg_loss = 2.544409332451997:  38%|███▊      | 53/141 [01:22<02:17,  1.56s/it] avg_loss = 2.544409332451997:  38%|███▊      | 54/141 [01:22<02:15,  1.56s/it]avg_loss = 2.5369662284851073:  38%|███▊      | 54/141 [01:23<02:15,  1.56s/it]avg_loss = 2.5369662284851073:  39%|███▉      | 55/141 [01:23<02:14,  1.56s/it]avg_loss = 2.5297019481658936:  39%|███▉      | 55/141 [01:25<02:14,  1.56s/it]avg_loss = 2.5297019481658936:  40%|███▉      | 56/141 [01:25<02:12,  1.56s/it]avg_loss = 2.5273130358311167:  40%|███▉      | 56/141 [01:27<02:12,  1.56s/it]avg_loss = 2.5273130358311167:  40%|████      | 57/141 [01:27<02:11,  1.56s/it]avg_loss = 2.5232434848259233:  40%|████      | 57/141 [01:28<02:11,  1.56s/it]avg_loss = 2.5232434848259233:  41%|████      | 58/141 [01:28<02:09,  1.56s/it]avg_loss = 2.529077166217869:  41%|████      | 58/141 [01:30<02:09,  1.56s/it] avg_loss = 2.529077166217869:  42%|████▏     | 59/141 [01:30<02:08,  1.56s/it]avg_loss = 2.5373019178708396:  42%|████▏     | 59/141 [01:31<02:08,  1.56s/it]avg_loss = 2.5373019178708396:  43%|████▎     | 60/141 [01:31<02:06,  1.56s/it]avg_loss = 2.5394327445108384:  43%|████▎     | 60/141 [01:33<02:06,  1.56s/it]avg_loss = 2.5394327445108384:  43%|████▎     | 61/141 [01:33<02:05,  1.56s/it]avg_loss = 2.5457449036259807:  43%|████▎     | 61/141 [01:34<02:05,  1.56s/it]avg_loss = 2.5457449036259807:  44%|████▍     | 62/141 [01:34<02:03,  1.56s/it]avg_loss = 2.53838502793085:  44%|████▍     | 62/141 [01:36<02:03,  1.56s/it]  avg_loss = 2.53838502793085:  45%|████▍     | 63/141 [01:36<02:02,  1.57s/it]avg_loss = 2.544972278177738:  45%|████▍     | 63/141 [01:37<02:02,  1.57s/it]avg_loss = 2.544972278177738:  45%|████▌     | 64/141 [01:37<02:00,  1.57s/it]avg_loss = 2.5466928151937633:  45%|████▌     | 64/141 [01:39<02:00,  1.57s/it]avg_loss = 2.5466928151937633:  46%|████▌     | 65/141 [01:39<01:59,  1.57s/it]avg_loss = 2.5402203798294067:  46%|████▌     | 65/141 [01:41<01:59,  1.57s/it]avg_loss = 2.5402203798294067:  47%|████▋     | 66/141 [01:41<01:57,  1.57s/it]avg_loss = 2.5352046311791265:  47%|████▋     | 66/141 [01:42<01:57,  1.57s/it]avg_loss = 2.5352046311791265:  48%|████▊     | 67/141 [01:42<01:56,  1.57s/it]avg_loss = 2.535282790660858:  48%|████▊     | 67/141 [01:44<01:56,  1.57s/it] avg_loss = 2.535282790660858:  48%|████▊     | 68/141 [01:44<01:54,  1.57s/it]avg_loss = 2.5351497297701626:  48%|████▊     | 68/141 [01:45<01:54,  1.57s/it]avg_loss = 2.5351497297701626:  49%|████▉     | 69/141 [01:45<01:53,  1.57s/it]avg_loss = 2.53451156275613:  49%|████▉     | 69/141 [01:47<01:53,  1.57s/it]  avg_loss = 2.53451156275613:  50%|████▉     | 70/141 [01:47<01:51,  1.57s/it]avg_loss = 2.536522643666872:  50%|████▉     | 70/141 [01:48<01:51,  1.57s/it]avg_loss = 2.536522643666872:  50%|█████     | 71/141 [01:48<01:50,  1.57s/it]avg_loss = 2.5391531619760723:  50%|█████     | 71/141 [01:50<01:50,  1.57s/it]avg_loss = 2.5391531619760723:  51%|█████     | 72/141 [01:50<01:48,  1.57s/it]avg_loss = 2.5350774640906346:  51%|█████     | 72/141 [01:52<01:48,  1.57s/it]avg_loss = 2.5350774640906346:  52%|█████▏    | 73/141 [01:52<01:47,  1.57s/it]avg_loss = 2.534145799843041:  52%|█████▏    | 73/141 [01:53<01:47,  1.57s/it] avg_loss = 2.534145799843041:  52%|█████▏    | 74/141 [01:53<01:45,  1.58s/it]avg_loss = 2.54001784324646:  52%|█████▏    | 74/141 [01:55<01:45,  1.58s/it] avg_loss = 2.54001784324646:  53%|█████▎    | 75/141 [01:55<01:44,  1.58s/it]avg_loss = 2.536092504074699:  53%|█████▎    | 75/141 [01:56<01:44,  1.58s/it]avg_loss = 2.536092504074699:  54%|█████▍    | 76/141 [01:56<01:42,  1.58s/it]avg_loss = 2.5362955718845517:  54%|█████▍    | 76/141 [01:58<01:42,  1.58s/it]avg_loss = 2.5362955718845517:  55%|█████▍    | 77/141 [01:58<01:40,  1.58s/it]avg_loss = 2.539669877443558:  55%|█████▍    | 77/141 [02:00<01:40,  1.58s/it] avg_loss = 2.539669877443558:  55%|█████▌    | 78/141 [02:00<01:39,  1.58s/it]avg_loss = 2.5419274644006657:  55%|█████▌    | 78/141 [02:01<01:39,  1.58s/it]avg_loss = 2.5419274644006657:  56%|█████▌    | 79/141 [02:01<01:37,  1.58s/it]avg_loss = 2.5346305072307587:  56%|█████▌    | 79/141 [02:03<01:37,  1.58s/it]avg_loss = 2.5346305072307587:  57%|█████▋    | 80/141 [02:03<01:36,  1.58s/it]avg_loss = 2.5298193325231106:  57%|█████▋    | 80/141 [02:04<01:36,  1.58s/it]avg_loss = 2.5298193325231106:  57%|█████▋    | 81/141 [02:04<01:34,  1.58s/it]avg_loss = 2.5273165353914586:  57%|█████▋    | 81/141 [02:06<01:34,  1.58s/it]avg_loss = 2.5273165353914586:  58%|█████▊    | 82/141 [02:06<01:33,  1.58s/it]avg_loss = 2.5272742983806564:  58%|█████▊    | 82/141 [02:07<01:33,  1.58s/it]avg_loss = 2.5272742983806564:  59%|█████▉    | 83/141 [02:07<01:31,  1.58s/it]avg_loss = 2.52730807803926:  59%|█████▉    | 83/141 [02:09<01:31,  1.58s/it]  avg_loss = 2.52730807803926:  60%|█████▉    | 84/141 [02:09<01:30,  1.58s/it]avg_loss = 2.5232446053448845:  60%|█████▉    | 84/141 [02:11<01:30,  1.58s/it]avg_loss = 2.5232446053448845:  60%|██████    | 85/141 [02:11<01:28,  1.58s/it]avg_loss = 2.5227547024571617:  60%|██████    | 85/141 [02:12<01:28,  1.58s/it]avg_loss = 2.5227547024571617:  61%|██████    | 86/141 [02:12<01:26,  1.58s/it]avg_loss = 2.522909126062503:  61%|██████    | 86/141 [02:14<01:26,  1.58s/it] avg_loss = 2.522909126062503:  62%|██████▏   | 87/141 [02:14<01:25,  1.58s/it]avg_loss = 2.523417453874241:  62%|██████▏   | 87/141 [02:15<01:25,  1.58s/it]avg_loss = 2.523417453874241:  62%|██████▏   | 88/141 [02:15<01:23,  1.58s/it]avg_loss = 2.5315235357606007:  62%|██████▏   | 88/141 [02:17<01:23,  1.58s/it]avg_loss = 2.5315235357606007:  63%|██████▎   | 89/141 [02:17<01:22,  1.58s/it]avg_loss = 2.5370210700564915:  63%|██████▎   | 89/141 [02:19<01:22,  1.58s/it]avg_loss = 2.5370210700564915:  64%|██████▍   | 90/141 [02:19<01:20,  1.58s/it]avg_loss = 2.5415490721608256:  64%|██████▍   | 90/141 [02:20<01:20,  1.58s/it]avg_loss = 2.5415490721608256:  65%|██████▍   | 91/141 [02:20<01:19,  1.59s/it]avg_loss = 2.5500615342803625:  65%|██████▍   | 91/141 [02:22<01:19,  1.59s/it]avg_loss = 2.5500615342803625:  65%|██████▌   | 92/141 [02:22<01:17,  1.58s/it]avg_loss = 2.553701610975368:  65%|██████▌   | 92/141 [02:23<01:17,  1.58s/it] avg_loss = 2.553701610975368:  66%|██████▌   | 93/141 [02:23<01:16,  1.59s/it]avg_loss = 2.555104760413474:  66%|██████▌   | 93/141 [02:25<01:16,  1.59s/it]avg_loss = 2.555104760413474:  67%|██████▋   | 94/141 [02:25<01:14,  1.59s/it]avg_loss = 2.5607567912653875:  67%|██████▋   | 94/141 [02:26<01:14,  1.59s/it]avg_loss = 2.5607567912653875:  67%|██████▋   | 95/141 [02:26<01:12,  1.59s/it]avg_loss = 2.560358412563801:  67%|██████▋   | 95/141 [02:28<01:12,  1.59s/it] avg_loss = 2.560358412563801:  68%|██████▊   | 96/141 [02:28<01:11,  1.59s/it]avg_loss = 2.559888471033155:  68%|██████▊   | 96/141 [02:30<01:11,  1.59s/it]avg_loss = 2.559888471033155:  69%|██████▉   | 97/141 [02:30<01:09,  1.59s/it]avg_loss = 2.557372672217233:  69%|██████▉   | 97/141 [02:31<01:09,  1.59s/it]avg_loss = 2.557372672217233:  70%|██████▉   | 98/141 [02:31<01:08,  1.59s/it]avg_loss = 2.55694490008884:  70%|██████▉   | 98/141 [02:33<01:08,  1.59s/it] avg_loss = 2.55694490008884:  70%|███████   | 99/141 [02:33<01:06,  1.59s/it]avg_loss = 2.560491600036621:  70%|███████   | 99/141 [02:34<01:06,  1.59s/it]avg_loss = 2.560491600036621:  71%|███████   | 100/141 [02:34<01:05,  1.59s/it]avg_loss = 2.560628666736112:  71%|███████   | 100/141 [02:36<01:05,  1.59s/it]avg_loss = 2.560628666736112:  72%|███████▏  | 101/141 [02:36<01:03,  1.59s/it]avg_loss = 2.5602292079551545:  72%|███████▏  | 101/141 [02:38<01:03,  1.59s/it]avg_loss = 2.5602292079551545:  72%|███████▏  | 102/141 [02:38<01:01,  1.59s/it]avg_loss = 2.561174582509161:  72%|███████▏  | 102/141 [02:39<01:01,  1.59s/it] avg_loss = 2.561174582509161:  73%|███████▎  | 103/141 [02:39<01:00,  1.59s/it]avg_loss = 2.569076038323916:  73%|███████▎  | 103/141 [02:41<01:00,  1.59s/it]avg_loss = 2.569076038323916:  74%|███████▍  | 104/141 [02:41<00:58,  1.59s/it]avg_loss = 2.5685518650781543:  74%|███████▍  | 104/141 [02:42<00:58,  1.59s/it]avg_loss = 2.5685518650781543:  74%|███████▍  | 105/141 [02:42<00:57,  1.59s/it]avg_loss = 2.571350153887047:  74%|███████▍  | 105/141 [02:44<00:57,  1.59s/it] avg_loss = 2.571350153887047:  75%|███████▌  | 106/141 [02:44<00:55,  1.59s/it]avg_loss = 2.5708897180646377:  75%|███████▌  | 106/141 [02:45<00:55,  1.59s/it]avg_loss = 2.5708897180646377:  76%|███████▌  | 107/141 [02:45<00:53,  1.59s/it]avg_loss = 2.568633735179901:  76%|███████▌  | 107/141 [02:47<00:53,  1.59s/it] avg_loss = 2.568633735179901:  77%|███████▋  | 108/141 [02:47<00:52,  1.59s/it]avg_loss = 2.5679102468928066:  77%|███████▋  | 108/141 [02:49<00:52,  1.59s/it]avg_loss = 2.5679102468928066:  77%|███████▋  | 109/141 [02:49<00:50,  1.59s/it]avg_loss = 2.564435351978649:  77%|███████▋  | 109/141 [02:50<00:50,  1.59s/it] avg_loss = 2.564435351978649:  78%|███████▊  | 110/141 [02:50<00:49,  1.59s/it]avg_loss = 2.5765284396506645:  78%|███████▊  | 110/141 [02:52<00:49,  1.59s/it]avg_loss = 2.5765284396506645:  79%|███████▊  | 111/141 [02:52<00:47,  1.59s/it]avg_loss = 2.5748088381120136:  79%|███████▊  | 111/141 [02:53<00:47,  1.59s/it]avg_loss = 2.5748088381120136:  79%|███████▉  | 112/141 [02:53<00:46,  1.59s/it]avg_loss = 2.574799033392847:  79%|███████▉  | 112/141 [02:55<00:46,  1.59s/it] avg_loss = 2.574799033392847:  80%|████████  | 113/141 [02:55<00:44,  1.59s/it]avg_loss = 2.574599307880067:  80%|████████  | 113/141 [02:57<00:44,  1.59s/it]avg_loss = 2.574599307880067:  81%|████████  | 114/141 [02:57<00:42,  1.59s/it]avg_loss = 2.573288975591245:  81%|████████  | 114/141 [02:58<00:42,  1.59s/it]avg_loss = 2.573288975591245:  82%|████████▏ | 115/141 [02:58<00:41,  1.59s/it]avg_loss = 2.571651890360076:  82%|████████▏ | 115/141 [03:00<00:41,  1.59s/it]avg_loss = 2.571651890360076:  82%|████████▏ | 116/141 [03:00<00:39,  1.59s/it]avg_loss = 2.5730648387191644:  82%|████████▏ | 116/141 [03:01<00:39,  1.59s/it]avg_loss = 2.5730648387191644:  83%|████████▎ | 117/141 [03:01<00:38,  1.59s/it]avg_loss = 2.5714395389718523:  83%|████████▎ | 117/141 [03:03<00:38,  1.59s/it]avg_loss = 2.5714395389718523:  84%|████████▎ | 118/141 [03:03<00:36,  1.59s/it]avg_loss = 2.5685973608193278:  84%|████████▎ | 118/141 [03:05<00:36,  1.59s/it]avg_loss = 2.5685973608193278:  84%|████████▍ | 119/141 [03:05<00:35,  1.59s/it]avg_loss = 2.5708984037240348:  84%|████████▍ | 119/141 [03:06<00:35,  1.59s/it]avg_loss = 2.5708984037240348:  85%|████████▌ | 120/141 [03:06<00:33,  1.59s/it]avg_loss = 2.5703092843047846:  85%|████████▌ | 120/141 [03:08<00:33,  1.59s/it]avg_loss = 2.5703092843047846:  86%|████████▌ | 121/141 [03:08<00:31,  1.59s/it]avg_loss = 2.570787652594144:  86%|████████▌ | 121/141 [03:09<00:31,  1.59s/it] avg_loss = 2.570787652594144:  87%|████████▋ | 122/141 [03:09<00:30,  1.59s/it]avg_loss = 2.569430686594025:  87%|████████▋ | 122/141 [03:11<00:30,  1.59s/it]avg_loss = 2.569430686594025:  87%|████████▋ | 123/141 [03:11<00:28,  1.59s/it]avg_loss = 2.5682446322133465:  87%|████████▋ | 123/141 [03:13<00:28,  1.59s/it]avg_loss = 2.5682446322133465:  88%|████████▊ | 124/141 [03:13<00:27,  1.59s/it]avg_loss = 2.5656880741119386:  88%|████████▊ | 124/141 [03:14<00:27,  1.59s/it]avg_loss = 2.5656880741119386:  89%|████████▊ | 125/141 [03:14<00:25,  1.60s/it]avg_loss = 2.564715515999567:  89%|████████▊ | 125/141 [03:16<00:25,  1.60s/it] avg_loss = 2.564715515999567:  89%|████████▉ | 126/141 [03:16<00:23,  1.60s/it]avg_loss = 2.5672042482481228:  89%|████████▉ | 126/141 [03:17<00:23,  1.60s/it]avg_loss = 2.5672042482481228:  90%|█████████ | 127/141 [03:17<00:22,  1.60s/it]avg_loss = 2.5648723673075438:  90%|█████████ | 127/141 [03:19<00:22,  1.60s/it]avg_loss = 2.5648723673075438:  91%|█████████ | 128/141 [03:19<00:20,  1.60s/it]avg_loss = 2.5636246574017427:  91%|█████████ | 128/141 [03:21<00:20,  1.60s/it]avg_loss = 2.5636246574017427:  91%|█████████▏| 129/141 [03:21<00:19,  1.60s/it]avg_loss = 2.563494168795072:  91%|█████████▏| 129/141 [03:22<00:19,  1.60s/it] avg_loss = 2.563494168795072:  92%|█████████▏| 130/141 [03:22<00:17,  1.60s/it]avg_loss = 2.563306892191181:  92%|█████████▏| 130/141 [03:24<00:17,  1.60s/it]avg_loss = 2.563306892191181:  93%|█████████▎| 131/141 [03:24<00:15,  1.60s/it]avg_loss = 2.563325414151856:  93%|█████████▎| 131/141 [03:25<00:15,  1.60s/it]avg_loss = 2.563325414151856:  94%|█████████▎| 132/141 [03:25<00:14,  1.60s/it]avg_loss = 2.558782089921765:  94%|█████████▎| 132/141 [03:27<00:14,  1.60s/it]avg_loss = 2.558782089921765:  94%|█████████▍| 133/141 [03:27<00:12,  1.60s/it]avg_loss = 2.5520058131929653:  94%|█████████▍| 133/141 [03:29<00:12,  1.60s/it]avg_loss = 2.5520058131929653:  95%|█████████▌| 134/141 [03:29<00:11,  1.60s/it]avg_loss = 2.5541358832959777:  95%|█████████▌| 134/141 [03:30<00:11,  1.60s/it]avg_loss = 2.5541358832959777:  96%|█████████▌| 135/141 [03:30<00:09,  1.60s/it]avg_loss = 2.557579081724672:  96%|█████████▌| 135/141 [03:32<00:09,  1.60s/it] avg_loss = 2.557579081724672:  96%|█████████▋| 136/141 [03:32<00:07,  1.60s/it]avg_loss = 2.5584577878896337:  96%|█████████▋| 136/141 [03:33<00:07,  1.60s/it]avg_loss = 2.5584577878896337:  97%|█████████▋| 137/141 [03:33<00:06,  1.60s/it]avg_loss = 2.558224027571471:  97%|█████████▋| 137/141 [03:35<00:06,  1.60s/it] avg_loss = 2.558224027571471:  98%|█████████▊| 138/141 [03:35<00:04,  1.60s/it]avg_loss = 2.5590423740071357:  98%|█████████▊| 138/141 [03:37<00:04,  1.60s/it]avg_loss = 2.5590423740071357:  99%|█████████▊| 139/141 [03:37<00:03,  1.60s/it]avg_loss = 2.559401899576187:  99%|█████████▊| 139/141 [03:38<00:03,  1.60s/it] avg_loss = 2.559401899576187:  99%|█████████▉| 140/141 [03:38<00:01,  1.60s/it]avg_loss = 2.5596706672763148:  99%|█████████▉| 140/141 [03:40<00:01,  1.60s/it]avg_loss = 2.5596706672763148: 100%|██████████| 141/141 [03:40<00:00,  1.60s/it]avg_loss = 2.5596706672763148: 100%|██████████| 141/141 [03:40<00:00,  1.56s/it]
I0324 09:07:38.985083 4109016 eval_ppl.py:107] wikitext2 perplexity: 12.931557655334473
wikitext2 perplexity: 12.932
