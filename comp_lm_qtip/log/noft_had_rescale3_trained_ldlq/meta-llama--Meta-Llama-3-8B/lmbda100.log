I0324 09:36:24.658830 4137507 config.py:54] PyTorch version 2.6.0 available.
W0324 09:36:24.941430 4137507 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:36:25.827747 4137507 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.06it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.77it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.99it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.13it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.23it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.28it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.91it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.97it/s]
I0324 09:36:27.279185 4137507 quantize_finetune_llama.py:150] loaded model
I0324 09:36:27.580814 4137507 quantize_finetune_llama.py:185] loaded compression model
I0324 09:36:45.225248 4137507 quantize_finetune_llama.py:189] loaded dataset and devset
I0324 09:36:51.406346 4137507 quantize_finetune_llama.py:209] layer 0 gpu 0
I0324 09:36:54.976755 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 3.426269054412842s
Use train scale and shift
tensor(-1.5053e-07, device='cuda:0') tensor(0.0156, device='cuda:0')
tensor(0.0156, device='cuda:0') tensor(-1.5053e-07, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0324 09:37:07.423385 4138245 config.py:54] PyTorch version 2.6.0 available.
W0324 09:37:07.705862 4138245 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:37:08.590524 4138245 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:37:08.594635 4137507 quantize_finetune_llama.py:209] layer 1 gpu 1
I0324 09:37:08.740664 4138245 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:37:11.302968 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 2.5450172424316406s
I0324 09:37:14.626190 4138413 config.py:54] PyTorch version 2.6.0 available.
W0324 09:37:14.908894 4138413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:37:15.790706 4138413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:37:15.794591 4137507 quantize_finetune_llama.py:209] layer 2 gpu 2
I0324 09:37:15.939449 4138413 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:37:17.828198 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 1.885974645614624s
I0324 09:37:21.220593 4138586 config.py:54] PyTorch version 2.6.0 available.
W0324 09:37:21.500455 4138586 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:37:22.412361 4138586 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:37:22.416131 4137507 quantize_finetune_llama.py:209] layer 3 gpu 3
I0324 09:37:22.613664 4138586 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:37:25.345211 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 2.7865195274353027s
I0324 09:37:28.806654 4138822 config.py:54] PyTorch version 2.6.0 available.
W0324 09:37:29.144921 4138822 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:37:30.259108 4138822 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:37:30.263288 4137507 quantize_finetune_llama.py:209] layer 4 gpu 0
I0324 09:37:30.425132 4138822 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.0012750393943861127 tr(WHW.T) 59.12685012817383
bpp_loss 5.188858851091936
0_q proxy err 7.454601018253015e-06 tr(WHW.T) 288042.3125
bpp_loss 4.244144291325938
0_k proxy err 5.900948053749744e-06 tr(WHW.T) 100153.140625
bpp_loss 5.4996757820481434
0_o proxy err 0.0004999772645533085 tr(WHW.T) 3114.052734375
bpp_loss 3.876241262536496
0_up proxy err 0.006280645728111267 tr(WHW.T) 8860.3681640625
bpp_loss 3.443046833920692
0_gate proxy err 0.0036959208082407713 tr(WHW.T) 15700.7783203125
bpp_loss 3.5124087149410377
0_down proxy err 0.003208079608157277 tr(WHW.T) 10754.4326171875
bpp_loss 3.831896440242417
1_v proxy err 0.0029740906320512295 tr(WHW.T) 106.5717544555664
bpp_loss 5.16442763118539
1_q proxy err 1.8422038920107298e-05 tr(WHW.T) 144770.28125
bpp_loss 4.412617313326336
1_k proxy err 1.0283507435815409e-05 tr(WHW.T) 75510.3359375
bpp_loss 5.730912311701104
1_o proxy err 0.0019023054046556354 tr(WHW.T) 1971.9923095703125
bpp_loss 3.8506715194671415
1_up proxy err 0.007190877106040716 tr(WHW.T) 8164.80224609375
bpp_loss 3.4532186963728497
1_gate proxy err 0.004397930111736059 tr(WHW.T) 13872.5791015625
bpp_loss 3.5241156057454646
1_down proxy err 7.292732334462926e-05 tr(WHW.T) 13912.466796875
bpp_loss 3.926213709687415
I0324 09:39:43.744916 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 1.0507819652557373s
I0324 09:39:47.700407 4140957 config.py:54] PyTorch version 2.6.0 available.
W0324 09:39:48.030907 4140957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

2_v proxy err 0.0019417696166783571 tr(WHW.T) 154.19476318359375
bpp_loss 5.161437260103412
2_q proxy err 0.0002032148913713172 tr(WHW.T) 41424.31640625
bpp_loss 4.282324573025107
2_k proxy err 0.00011362114310031757 tr(WHW.T) 22584.57421875
bpp_loss 5.583991622901522
2_o proxy err 0.002115537179633975 tr(WHW.T) 1957.2958984375
bpp_loss 3.822655301366467
2_up proxy err 0.008577643893659115 tr(WHW.T) 7535.0859375
bpp_loss 3.4418727939150164
2_gate proxy err 0.004509719554334879 tr(WHW.T) 15028.9306640625
bpp_loss 3.5417257980443537
2_down proxy err 0.005052190739661455 tr(WHW.T) 7660.9140625
bpp_loss 3.8281281227412234
W0324 09:39:49.008857 4140957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:39:49.013407 4137507 quantize_finetune_llama.py:209] layer 5 gpu 1
I0324 09:39:49.228609 4140957 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:39:50.718932 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 0.9607930183410645s
I0324 09:39:54.491934 4141091 config.py:54] PyTorch version 2.6.0 available.
W0324 09:39:54.825883 4141091 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:39:55.803522 4141091 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:39:55.807778 4137507 quantize_finetune_llama.py:209] layer 6 gpu 2
I0324 09:39:55.969535 4141091 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.001525189378298819 tr(WHW.T) 286.84423828125
bpp_loss 5.165373604395427
3_q proxy err 0.00031032192055135965 tr(WHW.T) 47525.6328125
bpp_loss 4.170425584772602
3_k proxy err 0.00016656531079206616 tr(WHW.T) 26144.59765625
bpp_loss 5.33497848873958
3_o proxy err 0.0029454482719302177 tr(WHW.T) 1844.0562744140625
bpp_loss 3.825112193415407
3_up proxy err 0.008529916405677795 tr(WHW.T) 7473.4931640625
bpp_loss 3.430389923309641
3_gate proxy err 0.003294777125120163 tr(WHW.T) 20789.244140625
bpp_loss 3.599070255312004
3_down proxy err 0.0053901029750704765 tr(WHW.T) 6935.875
bpp_loss 3.8227647772956908
I0324 09:39:59.327526 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.8159780502319336s
I0324 09:40:02.727220 4141288 config.py:54] PyTorch version 2.6.0 available.
W0324 09:40:03.005287 4141288 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:40:03.892991 4141288 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:40:03.896766 4137507 quantize_finetune_llama.py:209] layer 7 gpu 3
I0324 09:40:04.062209 4141288 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:40:05.195027 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 0.8620495796203613s
I0324 09:40:08.607904 4141418 config.py:54] PyTorch version 2.6.0 available.
W0324 09:40:08.892006 4141418 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:40:09.831377 4141418 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:40:09.835585 4137507 quantize_finetune_llama.py:209] layer 8 gpu 0
I0324 09:40:10.053354 4141418 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.0018301240634173155 tr(WHW.T) 282.4102478027344
bpp_loss 5.162565053789876
4_q proxy err 0.00025129583082161844 tr(WHW.T) 50064.87109375
bpp_loss 4.201741124037653
4_k proxy err 0.00012833162327297032 tr(WHW.T) 29273.04296875
bpp_loss 5.409101268276572
4_o proxy err 0.0035062110982835293 tr(WHW.T) 1283.5389404296875
bpp_loss 3.844094831205439
4_up proxy err 0.008657993748784065 tr(WHW.T) 7323.67578125
bpp_loss 3.41769031102636
4_gate proxy err 0.0024125301279127598 tr(WHW.T) 29024.958984375
bpp_loss 3.6572063311801424
4_down proxy err 0.005329214036464691 tr(WHW.T) 6336.10888671875
bpp_loss 3.821262226722735
5_v proxy err 0.0017270317766815424 tr(WHW.T) 206.8320770263672
bpp_loss 5.161954235751182
5_q proxy err 0.00034495655563659966 tr(WHW.T) 35942.19921875
bpp_loss 4.20311320736073
5_k proxy err 0.00016290317580569535 tr(WHW.T) 22968.5703125
bpp_loss 5.422241038409993
5_o proxy err 0.003547047032043338 tr(WHW.T) 1043.85205078125
bpp_loss 3.8378597506089136
5_up proxy err 0.00838825199753046 tr(WHW.T) 7595.9208984375
bpp_loss 3.4225261180794666
5_gate proxy err 0.002314948011189699 tr(WHW.T) 30281.02734375
bpp_loss 3.658728218970022
5_down proxy err 0.005288375075906515 tr(WHW.T) 6350.9873046875
bpp_loss 3.819411611566985
I0324 09:42:23.709894 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.2859225273132324s
I0324 09:42:27.600631 4143219 config.py:54] PyTorch version 2.6.0 available.
W0324 09:42:27.954013 4143219 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:42:28.982335 4143219 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:42:28.986528 4137507 quantize_finetune_llama.py:209] layer 9 gpu 1
6_v proxy err 0.001666527008637786 tr(WHW.T) 251.27548217773438
bpp_loss 5.162370125530288
6_q proxy err 0.00038663469604216516 tr(WHW.T) 35588.1328125
bpp_loss 4.200725241797045
6_k proxy err 0.00015644489030819386 tr(WHW.T) 26134.55859375
bpp_loss 5.360327549977228
6_o proxy err 0.004447214771062136 tr(WHW.T) 996.3651733398438
bpp_loss 3.8281320325331762
6_up proxy err 0.007918043062090874 tr(WHW.T) 7863.052734375
bpp_loss 3.427000120082604
6_gate proxy err 0.001924346201121807 tr(WHW.T) 35641.328125
bpp_loss 3.6687284127942155
6_down proxy err 0.0050453245639801025 tr(WHW.T) 6423.478515625
bpp_loss 3.8200067574923326
I0324 09:42:29.212709 4143219 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:42:31.249430 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 0.9401285648345947s
I0324 09:42:34.959343 4143371 config.py:54] PyTorch version 2.6.0 available.
W0324 09:42:35.287920 4143371 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.0013133663451299071 tr(WHW.T) 307.1083068847656
bpp_loss 5.1615120597416535
7_q proxy err 0.00040079044993035495 tr(WHW.T) 35097.69140625
bpp_loss 4.134417139226571
7_k proxy err 0.00015879298734944314 tr(WHW.T) 26820.87890625
bpp_loss 5.336156835663132
7_o proxy err 0.00429944321513176 tr(WHW.T) 945.9965209960938
bpp_loss 3.828870468540117
7_up proxy err 0.007215803489089012 tr(WHW.T) 8565.2685546875
bpp_loss 3.4394296926579306
7_gate proxy err 0.0019309531198814511 tr(WHW.T) 34800.38671875
bpp_loss 3.652708358131349
7_down proxy err 0.005088862497359514 tr(WHW.T) 6472.80322265625
bpp_loss 3.8211441026900763
W0324 09:42:36.200119 4143371 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:42:36.203929 4137507 quantize_finetune_llama.py:209] layer 10 gpu 2
I0324 09:42:36.430655 4143371 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:42:38.014304 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.8480539321899414s
I0324 09:42:41.437016 4143524 config.py:54] PyTorch version 2.6.0 available.
W0324 09:42:41.716103 4143524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:42:42.602167 4143524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:42:42.605982 4137507 quantize_finetune_llama.py:209] layer 11 gpu 3
I0324 09:42:42.758006 4143524 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:42:43.889015 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 0.8504462242126465s
I0324 09:42:47.255948 4143656 config.py:54] PyTorch version 2.6.0 available.
W0324 09:42:47.553143 4143656 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:42:48.440944 4143656 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:42:48.444768 4137507 quantize_finetune_llama.py:209] layer 12 gpu 0
I0324 09:42:48.667663 4143656 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.001769177382811904 tr(WHW.T) 255.14593505859375
bpp_loss 5.160570661071688
8_q proxy err 0.0005263090133666992 tr(WHW.T) 26553.384765625
bpp_loss 4.15007846581284
8_k proxy err 0.0001897239126265049 tr(WHW.T) 22499.607421875
bpp_loss 5.335729060461745
8_o proxy err 0.005524800159037113 tr(WHW.T) 731.8719482421875
bpp_loss 3.8280290695256554
8_up proxy err 0.007411330007016659 tr(WHW.T) 8433.421875
bpp_loss 3.4373822047907328
8_gate proxy err 0.00183299055788666 tr(WHW.T) 37134.01171875
bpp_loss 3.6591464348935654
8_down proxy err 0.00506290839985013 tr(WHW.T) 6427.3955078125
bpp_loss 3.821063104384978
9_v proxy err 0.0017799410270527005 tr(WHW.T) 347.97332763671875
bpp_loss 5.160065298667178
9_q proxy err 0.0005688174278475344 tr(WHW.T) 25605.623046875
bpp_loss 4.142186101700645
9_k proxy err 0.00021270487923175097 tr(WHW.T) 20913.580078125
bpp_loss 5.315358557738364
9_o proxy err 0.005330774001777172 tr(WHW.T) 760.8590087890625
bpp_loss 3.852025935659185
9_up proxy err 0.007028916850686073 tr(WHW.T) 8907.896484375
bpp_loss 3.442749964738531
9_gate proxy err 0.0017358968034386635 tr(WHW.T) 39308.97265625
bpp_loss 3.671364015966122
9_down proxy err 0.005181138403713703 tr(WHW.T) 6211.091796875
bpp_loss 3.819670389323229
I0324 09:45:04.606462 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 0.9324839115142822s
I0324 09:45:08.459077 4145433 config.py:54] PyTorch version 2.6.0 available.
10_v proxy err 0.0017655713018029928 tr(WHW.T) 249.34664916992188
bpp_loss 5.158886780845933
10_q proxy err 0.0005745684029534459 tr(WHW.T) 23288.728515625
bpp_loss 4.192539071664214
10_k proxy err 0.0002078388788504526 tr(WHW.T) 19714.28515625
bpp_loss 5.391395317972638
10_o proxy err 0.005670575890690088 tr(WHW.T) 667.2440185546875
bpp_loss 3.839283659995999
10_up proxy err 0.006944966036826372 tr(WHW.T) 9134.4111328125
bpp_loss 3.452546402678958
10_gate proxy err 0.0018302181269973516 tr(WHW.T) 37297.75
bpp_loss 3.6449367231689394
10_down proxy err 0.005158805754035711 tr(WHW.T) 6461.62451171875
bpp_loss 3.8197703177408715
W0324 09:45:08.792092 4145433 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:45:09.769342 4145433 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:45:09.773511 4137507 quantize_finetune_llama.py:209] layer 13 gpu 1
I0324 09:45:09.943864 4145433 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:45:11.209940 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 0.9460246562957764s
I0324 09:45:14.889153 4145574 config.py:54] PyTorch version 2.6.0 available.
W0324 09:45:15.223353 4145574 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:45:16.177766 4145574 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:45:16.181861 4137507 quantize_finetune_llama.py:209] layer 14 gpu 2
I0324 09:45:16.338040 4145574 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.0013893450377508998 tr(WHW.T) 317.1318664550781
bpp_loss 5.1620238029863685
11_q proxy err 0.0006411839858628809 tr(WHW.T) 22146.5234375
bpp_loss 4.107707867049612
11_k proxy err 0.00024410823243670166 tr(WHW.T) 17998.525390625
bpp_loss 5.322598158149049
11_o proxy err 0.005954804830253124 tr(WHW.T) 551.9363403320312
bpp_loss 3.850876382261049
11_up proxy err 0.0067978412844240665 tr(WHW.T) 9126.9775390625
bpp_loss 3.461780612822622
11_gate proxy err 0.001810119254514575 tr(WHW.T) 36784.98046875
bpp_loss 3.6354425941993083
11_down proxy err 0.005105824209749699 tr(WHW.T) 6591.28369140625
bpp_loss 3.820207035667928
I0324 09:45:18.640876 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 1.0458974838256836s
I0324 09:45:22.023172 4145748 config.py:54] PyTorch version 2.6.0 available.
W0324 09:45:22.301674 4145748 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:45:23.171830 4145748 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:45:23.175584 4137507 quantize_finetune_llama.py:209] layer 15 gpu 3
I0324 09:45:23.344551 4145748 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:45:24.498307 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.8773643970489502s
I0324 09:45:27.879516 4145879 config.py:54] PyTorch version 2.6.0 available.
W0324 09:45:28.159257 4145879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:45:29.065554 4145879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:45:29.069308 4137507 quantize_finetune_llama.py:209] layer 16 gpu 0
I0324 09:45:29.237151 4145879 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.0016914159059524536 tr(WHW.T) 360.2216491699219
bpp_loss 5.160845460835844
12_q proxy err 0.0004433366993907839 tr(WHW.T) 34057.0703125
bpp_loss 4.100935531838331
12_k proxy err 0.00019512342987582088 tr(WHW.T) 23029.533203125
bpp_loss 5.254857613588683
12_o proxy err 0.005463001783937216 tr(WHW.T) 764.130126953125
bpp_loss 3.8333508308278397
12_up proxy err 0.006092743948101997 tr(WHW.T) 9958.9345703125
bpp_loss 3.4822838637046516
12_gate proxy err 0.0017409465508535504 tr(WHW.T) 37237.28125
bpp_loss 3.6273033909632693
12_down proxy err 0.005004435777664185 tr(WHW.T) 6756.125
bpp_loss 3.8235109688248485
13_v proxy err 0.0018875831738114357 tr(WHW.T) 277.2493591308594
bpp_loss 5.16129986429587
13_q proxy err 0.0006803987198509276 tr(WHW.T) 20850.80078125
bpp_loss 4.140463117219042
13_k proxy err 0.0002500235568732023 tr(WHW.T) 17769.314453125
bpp_loss 5.330506502999924
13_o proxy err 0.005677378736436367 tr(WHW.T) 660.2918090820312
bpp_loss 3.844568297092337
13_up proxy err 0.005953347310423851 tr(WHW.T) 9941.6767578125
bpp_loss 3.4848550843474055
13_gate proxy err 0.0016358800930902362 tr(WHW.T) 38824.0078125
bpp_loss 3.628072913935674
13_down proxy err 0.005131241399794817 tr(WHW.T) 6493.9638671875
bpp_loss 3.822453123351027
I0324 09:47:44.505183 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 0.8720207214355469s
I0324 09:47:48.330897 4147633 config.py:54] PyTorch version 2.6.0 available.
W0324 09:47:48.679180 4147633 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:47:49.709886 4147633 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:47:49.714260 4137507 quantize_finetune_llama.py:209] layer 17 gpu 1
I0324 09:47:49.880125 4147633 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.0018215213203802705 tr(WHW.T) 278.4917907714844
bpp_loss 5.16104179515969
14_q proxy err 0.0006252931198105216 tr(WHW.T) 20837.234375
bpp_loss 4.135641005646903
14_k proxy err 0.00022130781144369394 tr(WHW.T) 18590.26171875
bpp_loss 5.362454053596593
14_o proxy err 0.0055459123104810715 tr(WHW.T) 671.5200805664062
bpp_loss 3.8352456432185136
14_up proxy err 0.006379678845405579 tr(WHW.T) 9096.203125
bpp_loss 3.486033409767385
14_gate proxy err 0.0015229879645630717 tr(WHW.T) 41683.65625
bpp_loss 3.6516942412459423
14_down proxy err 0.005372165702283382 tr(WHW.T) 6324.6708984375
bpp_loss 3.8263611111157974
I0324 09:47:58.074409 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.8989992141723633s
15_v proxy err 0.002177668269723654 tr(WHW.T) 280.6507568359375
bpp_loss 5.161895345430821
15_q proxy err 0.0005430509336292744 tr(WHW.T) 28024.77734375
bpp_loss 4.225709898862988
15_k proxy err 0.0002376079064561054 tr(WHW.T) 18843.455078125
bpp_loss 5.288627887959592
15_o proxy err 0.005377074703574181 tr(WHW.T) 812.0530395507812
bpp_loss 3.856830322474707
15_up proxy err 0.006519921123981476 tr(WHW.T) 8927.576171875
bpp_loss 3.4771277169430896
15_gate proxy err 0.0013951448490843177 tr(WHW.T) 46110.5703125
bpp_loss 3.6753309042459086
15_down proxy err 0.005276940297335386 tr(WHW.T) 6333.8271484375
bpp_loss 3.8244140977705166
I0324 09:48:01.502614 4147872 config.py:54] PyTorch version 2.6.0 available.
W0324 09:48:01.796228 4147872 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:48:02.699059 4147872 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:48:02.702792 4137507 quantize_finetune_llama.py:209] layer 18 gpu 2
I0324 09:48:02.903597 4147872 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:48:03.908791 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.7512896060943604s
I0324 09:48:07.345746 4148022 config.py:54] PyTorch version 2.6.0 available.
W0324 09:48:07.625870 4148022 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:48:08.524044 4148022 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:48:08.527931 4137507 quantize_finetune_llama.py:209] layer 19 gpu 3
I0324 09:48:08.738832 4148022 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:48:09.808545 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 19 in 0.836122989654541s
I0324 09:48:13.419315 4148157 config.py:54] PyTorch version 2.6.0 available.
W0324 09:48:13.721482 4148157 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:48:14.609639 4148157 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:48:14.613402 4137507 quantize_finetune_llama.py:209] layer 20 gpu 0
I0324 09:48:14.778740 4148157 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.0019713889341801405 tr(WHW.T) 271.31622314453125
bpp_loss 5.16275954071898
16_q proxy err 0.0005413979524746537 tr(WHW.T) 24435.859375
bpp_loss 4.2191472257254645
16_k proxy err 0.00020647179917432368 tr(WHW.T) 19477.728515625
bpp_loss 5.377999741118401
16_o proxy err 0.0047013587318360806 tr(WHW.T) 953.9540405273438
bpp_loss 3.8408505747793242
16_up proxy err 0.007417026907205582 tr(WHW.T) 8266.0234375
bpp_loss 3.459007233913456
16_gate proxy err 0.0016602607211098075 tr(WHW.T) 41063.65234375
bpp_loss 3.6956600738423213
16_down proxy err 0.00551350275054574 tr(WHW.T) 6224.45166015625
bpp_loss 3.8221149867999236
17_v proxy err 0.002369324443861842 tr(WHW.T) 280.38623046875
bpp_loss 5.1619116445071995
17_q proxy err 0.0005448442534543574 tr(WHW.T) 27519.69921875
bpp_loss 4.199881323729642
17_k proxy err 0.000261846580542624 tr(WHW.T) 17400.859375
bpp_loss 5.309116602526046
17_o proxy err 0.004457814618945122 tr(WHW.T) 1090.4486083984375
bpp_loss 3.858856329054106
17_up proxy err 0.007338843774050474 tr(WHW.T) 8387.9111328125
bpp_loss 3.452765291290624
17_gate proxy err 0.0016494197770953178 tr(WHW.T) 41602.7890625
bpp_loss 3.704616620338389
17_down proxy err 0.005557675380259752 tr(WHW.T) 6148.6953125
bpp_loss 3.8204123025726795
I0324 09:50:38.724519 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 20 in 1.0794496536254883s
I0324 09:50:42.598219 4150025 config.py:54] PyTorch version 2.6.0 available.
W0324 09:50:42.956235 4150025 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.0018780960235744715 tr(WHW.T) 284.69989013671875
bpp_loss 5.163463137927465
18_q proxy err 0.000679422402754426 tr(WHW.T) 22349.49609375
bpp_loss 4.173977974220179
18_k proxy err 0.00027346829301677644 tr(WHW.T) 17364.392578125
bpp_loss 5.319645794923417
18_o proxy err 0.004608909599483013 tr(WHW.T) 1187.7923583984375
bpp_loss 3.849044530070387
18_up proxy err 0.008134094066917896 tr(WHW.T) 7918.9404296875
bpp_loss 3.4419561269959167
18_gate proxy err 0.0020367982797324657 tr(WHW.T) 35128.28125
bpp_loss 3.7034598282272264
18_down proxy err 0.0057606929913163185 tr(WHW.T) 6163.37109375
bpp_loss 3.8193820822884197
W0324 09:50:43.947298 4150025 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:50:43.951620 4137507 quantize_finetune_llama.py:209] layer 21 gpu 1
I0324 09:50:44.194380 4150025 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:50:45.319317 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 21 in 0.8883862495422363s
19_v proxy err 0.0018043285235762596 tr(WHW.T) 337.79034423828125
bpp_loss 5.164640021161176
19_q proxy err 0.000653839495498687 tr(WHW.T) 23987.85546875
bpp_loss 4.166428736760281
19_k proxy err 0.00030330350273288786 tr(WHW.T) 15525.201171875
bpp_loss 5.261985800345428
19_o proxy err 0.005156780127435923 tr(WHW.T) 1153.098876953125
bpp_loss 3.8440317591885105
19_up proxy err 0.008634586818516254 tr(WHW.T) 7585.85546875
bpp_loss 3.437187386809715
19_gate proxy err 0.002227939199656248 tr(WHW.T) 32695.314453125
bpp_loss 3.7094945207770382
19_down proxy err 0.00589193869382143 tr(WHW.T) 6119.80810546875
bpp_loss 3.819292746600695
I0324 09:50:48.977300 4150165 config.py:54] PyTorch version 2.6.0 available.
W0324 09:50:49.260391 4150165 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:50:50.157467 4150165 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:50:50.161237 4137507 quantize_finetune_llama.py:209] layer 22 gpu 2
I0324 09:50:50.381846 4150165 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:50:51.282404 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 22 in 0.687863826751709s
I0324 09:50:54.592180 4150301 config.py:54] PyTorch version 2.6.0 available.
W0324 09:50:54.890760 4150301 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:50:55.816062 4150301 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:50:55.819859 4137507 quantize_finetune_llama.py:209] layer 23 gpu 3
I0324 09:50:55.970719 4150301 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:50:56.948553 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 23 in 0.7353827953338623s
I0324 09:51:00.329329 4150436 config.py:54] PyTorch version 2.6.0 available.
W0324 09:51:00.633358 4150436 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:51:01.587104 4150436 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:51:01.590826 4137507 quantize_finetune_llama.py:209] layer 24 gpu 0
I0324 09:51:01.746023 4150436 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.002081485465168953 tr(WHW.T) 326.5905456542969
bpp_loss 5.1629538387060165
20_q proxy err 0.000718022754881531 tr(WHW.T) 20688.703125
bpp_loss 4.1723929105792195
20_k proxy err 0.00029468166758306324 tr(WHW.T) 15368.4912109375
bpp_loss 5.2696759613463655
20_o proxy err 0.005128112155944109 tr(WHW.T) 1189.6593017578125
bpp_loss 3.84110883140238
20_up proxy err 0.00878782570362091 tr(WHW.T) 7535.79443359375
bpp_loss 3.438452645870192
20_gate proxy err 0.002407495630905032 tr(WHW.T) 30548.365234375
bpp_loss 3.7085119016867663
20_down proxy err 0.005885138642042875 tr(WHW.T) 6237.4736328125
bpp_loss 3.8189330064092895
21_v proxy err 0.0020153599325567484 tr(WHW.T) 359.03216552734375
bpp_loss 5.165068223956041
21_q proxy err 0.0005862381658516824 tr(WHW.T) 25790.224609375
bpp_loss 4.148680208309088
21_k proxy err 0.00027429457986727357 tr(WHW.T) 16759.76171875
bpp_loss 5.272823519306257
21_o proxy err 0.0038787773810327053 tr(WHW.T) 1250.4415283203125
bpp_loss 3.8767912653274834
21_up proxy err 0.008434676565229893 tr(WHW.T) 7708.326171875
bpp_loss 3.441529905290476
21_gate proxy err 0.002300775144249201 tr(WHW.T) 31447.8125
bpp_loss 3.7184882461359456
21_down proxy err 0.005735340062528849 tr(WHW.T) 6287.7109375
bpp_loss 3.81948753566082
I0324 09:53:24.522030 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 24 in 0.8536367416381836s
22_v proxy err 0.0023001215886324644 tr(WHW.T) 341.8212890625
bpp_loss 5.161947182612494
22_q proxy err 0.0006881323060952127 tr(WHW.T) 20274.177734375
bpp_loss 4.137793230765965
22_k proxy err 0.0002921025734394789 tr(WHW.T) 14697.5322265625
bpp_loss 5.276865407358855
22_o proxy err 0.005785677582025528 tr(WHW.T) 1205.021240234375
bpp_loss 3.8302491441136226
22_up proxy err 0.008823877200484276 tr(WHW.T) 7482.60498046875
bpp_loss 3.4415306789534434
22_gate proxy err 0.0024842629209160805 tr(WHW.T) 29415.544921875
bpp_loss 3.718180326545345
22_down proxy err 0.005697325803339481 tr(WHW.T) 6465.3056640625
bpp_loss 3.819054837272103
I0324 09:53:28.391499 4152317 config.py:54] PyTorch version 2.6.0 available.
W0324 09:53:28.743854 4152317 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:53:29.698902 4152317 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:53:29.703263 4137507 quantize_finetune_llama.py:209] layer 25 gpu 1
I0324 09:53:29.866979 4152317 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:53:31.233283 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 25 in 1.0663230419158936s
23_v proxy err 0.002228652825579047 tr(WHW.T) 393.1842041015625
bpp_loss 5.160607398254797
23_q proxy err 0.0006780214607715607 tr(WHW.T) 22563.107421875
bpp_loss 4.112209406099282
23_k proxy err 0.0003103394410572946 tr(WHW.T) 14831.095703125
bpp_loss 5.220631108852103
23_o proxy err 0.0047218408435583115 tr(WHW.T) 1727.0145263671875
bpp_loss 3.830331142351497
23_up proxy err 0.00898711383342743 tr(WHW.T) 7354.04541015625
bpp_loss 3.4440164630567387
23_gate proxy err 0.0026838472113013268 tr(WHW.T) 27172.716796875
bpp_loss 3.720669372605958
23_down proxy err 0.005798989441245794 tr(WHW.T) 6602.26123046875
bpp_loss 3.8187631863901124
I0324 09:53:34.730869 4152464 config.py:54] PyTorch version 2.6.0 available.
W0324 09:53:35.014625 4152464 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:53:35.908807 4152464 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:53:35.912716 4137507 quantize_finetune_llama.py:209] layer 26 gpu 2
I0324 09:53:36.081478 4152464 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:53:37.174782 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 26 in 0.8277590274810791s
I0324 09:53:40.594641 4152602 config.py:54] PyTorch version 2.6.0 available.
W0324 09:53:40.888252 4152602 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:53:41.787140 4152602 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:53:41.791003 4137507 quantize_finetune_llama.py:209] layer 27 gpu 3
I0324 09:53:41.982130 4152602 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:53:43.004911 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 27 in 0.7695400714874268s
I0324 09:53:46.403895 4152734 config.py:54] PyTorch version 2.6.0 available.
W0324 09:53:46.716178 4152734 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:53:47.609956 4152734 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:53:47.613825 4137507 quantize_finetune_llama.py:209] layer 28 gpu 0
I0324 09:53:47.807627 4152734 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.002279962645843625 tr(WHW.T) 461.59027099609375
bpp_loss 5.162442265078425
24_q proxy err 0.0006614120211452246 tr(WHW.T) 22391.7734375
bpp_loss 4.099300381960347
24_k proxy err 0.0003023598110303283 tr(WHW.T) 14159.55078125
bpp_loss 5.185410833451897
24_o proxy err 0.005038746166974306 tr(WHW.T) 1570.388427734375
bpp_loss 3.8498801056994125
24_up proxy err 0.009233246557414532 tr(WHW.T) 7245.40576171875
bpp_loss 3.4463716379499862
24_gate proxy err 0.0028618730138987303 tr(WHW.T) 25757.33203125
bpp_loss 3.725255656056106
24_down proxy err 0.005921974312514067 tr(WHW.T) 6676.57958984375
bpp_loss 3.818171794792371
25_v proxy err 0.0019403387559577823 tr(WHW.T) 552.045654296875
bpp_loss 5.162725904374383
25_q proxy err 0.0005851641180925071 tr(WHW.T) 26069.1015625
bpp_loss 4.067984746710863
25_k proxy err 0.0003004196332767606 tr(WHW.T) 14392.994140625
bpp_loss 5.180175905814394
25_o proxy err 0.004115792457014322 tr(WHW.T) 1971.1920166015625
bpp_loss 3.8541747379349545
25_up proxy err 0.00914911087602377 tr(WHW.T) 7315.31396484375
bpp_loss 3.4535239511169493
25_gate proxy err 0.0028141289949417114 tr(WHW.T) 26185.79296875
bpp_loss 3.7343574298013533
25_down proxy err 0.006216210313141346 tr(WHW.T) 6549.46630859375
bpp_loss 3.8182783333551407
I0324 09:56:09.192777 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 28 in 0.9239118099212646s
I0324 09:56:13.123483 4154564 config.py:54] PyTorch version 2.6.0 available.
W0324 09:56:13.543864 4154564 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.0027766269631683826 tr(WHW.T) 428.18212890625
bpp_loss 5.160900027258322
26_q proxy err 0.0006725475541315973 tr(WHW.T) 21359.736328125
bpp_loss 4.098332709749229
26_k proxy err 0.00028085883241146803 tr(WHW.T) 15400.359375
bpp_loss 5.224785266793333
26_o proxy err 0.002980780089274049 tr(WHW.T) 2368.6396484375
bpp_loss 3.8821774746174924
26_up proxy err 0.008848514407873154 tr(WHW.T) 7577.68359375
bpp_loss 3.4601397175075754
26_gate proxy err 0.002566118724644184 tr(WHW.T) 28778.099609375
bpp_loss 3.7426590537652373
26_down proxy err 0.006296420004218817 tr(WHW.T) 6551.21533203125
bpp_loss 3.8186118919734975
W0324 09:56:14.561614 4154564 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:56:14.565703 4137507 quantize_finetune_llama.py:209] layer 29 gpu 1
I0324 09:56:14.796557 4154564 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:56:15.802116 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 29 in 0.7704401016235352s
I0324 09:56:19.638303 4154705 config.py:54] PyTorch version 2.6.0 available.
W0324 09:56:20.037547 4154705 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:56:21.094337 4154705 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:56:21.098512 4137507 quantize_finetune_llama.py:209] layer 30 gpu 2
I0324 09:56:21.294085 4154705 data_utils.py:336] using 256 training seqs, 128 validation seqs
27_v proxy err 0.0020331311970949173 tr(WHW.T) 670.343017578125
bpp_loss 5.16201861272566
27_q proxy err 0.0007139891386032104 tr(WHW.T) 21263.849609375
bpp_loss 4.058679860027041
27_k proxy err 0.00031703480635769665 tr(WHW.T) 13986.966796875
bpp_loss 5.180541886948049
27_o proxy err 0.0034505317453294992 tr(WHW.T) 2138.783203125
bpp_loss 3.877452850807458
27_up proxy err 0.00808842945843935 tr(WHW.T) 8405.8671875
bpp_loss 3.4679964548642084
27_gate proxy err 0.0022852979600429535 tr(WHW.T) 32683.65234375
bpp_loss 3.7508789306240424
27_down proxy err 0.005855852738022804 tr(WHW.T) 6474.22314453125
bpp_loss 3.842906759669339
I0324 09:56:26.275551 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 30 in 0.7138192653656006s
I0324 09:56:29.648184 4154918 config.py:54] PyTorch version 2.6.0 available.
W0324 09:56:29.924527 4154918 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:56:30.795528 4154918 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:56:30.799396 4137507 quantize_finetune_llama.py:209] layer 31 gpu 3
I0324 09:56:30.982281 4154918 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:56:32.075928 4137507 quantize_finetune_llama.py:240] computed original embedding for layer 31 in 0.8412606716156006s
I0324 09:56:35.667097 4155052 config.py:54] PyTorch version 2.6.0 available.
W0324 09:56:36.003998 4155052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:56:37.082658 4155052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:56:37.315269 4155052 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.002468203194439411 tr(WHW.T) 593.5634155273438
bpp_loss 5.161640366888605
28_q proxy err 0.0006554475985467434 tr(WHW.T) 23121.744140625
bpp_loss 4.057464788202196
28_k proxy err 0.00027276790933683515 tr(WHW.T) 14971.8525390625
bpp_loss 5.165020769811235
28_o proxy err 0.0030711037106812 tr(WHW.T) 2489.129638671875
bpp_loss 3.902407789370045
28_up proxy err 0.0065300799906253815 tr(WHW.T) 10173.3935546875
bpp_loss 3.487643395949687
28_gate proxy err 0.0020258675795048475 tr(WHW.T) 35797.04296875
bpp_loss 3.746118162292987
28_down proxy err 0.005184219218790531 tr(WHW.T) 7138.55908203125
bpp_loss 3.8562991061647023
29_v proxy err 0.0018489842768758535 tr(WHW.T) 841.8088989257812
bpp_loss 5.163391209789552
29_q proxy err 0.0008004402043297887 tr(WHW.T) 20611.560546875
bpp_loss 4.001114821643569
29_k proxy err 0.0002656037686392665 tr(WHW.T) 16341.275390625
bpp_loss 5.174672891153023
29_o proxy err 0.001976221101358533 tr(WHW.T) 3078.978271484375
bpp_loss 3.960280495346524
29_up proxy err 0.005095619708299637 tr(WHW.T) 12791.73828125
bpp_loss 3.5091432988909737
29_gate proxy err 0.0018413686193525791 tr(WHW.T) 38241.23046875
bpp_loss 3.7427403876957084
29_down proxy err 0.004263666458427906 tr(WHW.T) 7396.3740234375
bpp_loss 3.9004866872315427
30_v proxy err 0.0025440938770771027 tr(WHW.T) 850.650634765625
bpp_loss 5.161651521921158
30_q proxy err 0.0005851856549270451 tr(WHW.T) 24012.763671875
bpp_loss 3.993809565610718
30_k proxy err 0.00022348054335452616 tr(WHW.T) 14011.7353515625
bpp_loss 5.165037271101028
30_o proxy err 0.0017189879436045885 tr(WHW.T) 4841.84814453125
bpp_loss 3.9140585064305924
30_up proxy err 0.003008100437000394 tr(WHW.T) 21630.490234375
bpp_loss 3.52559192724792
30_gate proxy err 0.0013599336380138993 tr(WHW.T) 51822.3203125
bpp_loss 3.781222035443144
30_down proxy err 0.00217158580198884 tr(WHW.T) 8734.9560546875
bpp_loss 3.977279400968525
31_v proxy err 0.0008741060155443847 tr(WHW.T) 1798.8880615234375
bpp_loss 5.167862068628892
31_q proxy err 0.0003369511687196791 tr(WHW.T) 46129.9609375
bpp_loss 4.0342728982213885
31_k proxy err 0.000167023332323879 tr(WHW.T) 20445.2890625
bpp_loss 5.183161260792986
31_o proxy err 0.0011540224077180028 tr(WHW.T) 2186.948974609375
bpp_loss 4.06405014754273
31_up proxy err 0.0009240942308679223 tr(WHW.T) 68910.7734375
bpp_loss 3.6633381866184727
31_gate proxy err 0.0004760026640724391 tr(WHW.T) 144280.90625
bpp_loss 3.9536260588626777
31_down proxy err 0.0005272747948765755 tr(WHW.T) 9880.068359375
bpp_loss 4.078570509312807
I0324 09:59:19.504644 4157150 config.py:54] PyTorch version 2.6.0 available.
W0324 09:59:19.814579 4157150 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 09:59:20.069824 4157150 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:02,  2.66it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:01,  3.85it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  4.30it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  4.76it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:01<00:00,  5.00it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  4.79it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.03it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.61it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  5.57it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  5.68it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  5.05it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  4.79it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:01<00:00,  4.68it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  4.62it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.60it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.77it/s]
I0324 09:59:24.720765 4157150 hfize_llama.py:153] loaded layer 0
I0324 09:59:25.520825 4157150 hfize_llama.py:153] loaded layer 1
I0324 09:59:26.145624 4157150 hfize_llama.py:153] loaded layer 2
I0324 09:59:26.710756 4157150 hfize_llama.py:153] loaded layer 3
I0324 09:59:27.280732 4157150 hfize_llama.py:153] loaded layer 4
I0324 09:59:27.857099 4157150 hfize_llama.py:153] loaded layer 5
I0324 09:59:28.457351 4157150 hfize_llama.py:153] loaded layer 6
I0324 09:59:29.022327 4157150 hfize_llama.py:153] loaded layer 7
I0324 09:59:29.582777 4157150 hfize_llama.py:153] loaded layer 8
I0324 09:59:30.149352 4157150 hfize_llama.py:153] loaded layer 9
I0324 09:59:30.739652 4157150 hfize_llama.py:153] loaded layer 10
I0324 09:59:31.287974 4157150 hfize_llama.py:153] loaded layer 11
I0324 09:59:31.928599 4157150 hfize_llama.py:153] loaded layer 12
I0324 09:59:32.545243 4157150 hfize_llama.py:153] loaded layer 13
I0324 09:59:33.159475 4157150 hfize_llama.py:153] loaded layer 14
I0324 09:59:33.788777 4157150 hfize_llama.py:153] loaded layer 15
I0324 09:59:34.392297 4157150 hfize_llama.py:153] loaded layer 16
I0324 09:59:35.055788 4157150 hfize_llama.py:153] loaded layer 17
I0324 09:59:35.672755 4157150 hfize_llama.py:153] loaded layer 18
I0324 09:59:36.359811 4157150 hfize_llama.py:153] loaded layer 19
I0324 09:59:36.953762 4157150 hfize_llama.py:153] loaded layer 20
I0324 09:59:37.563618 4157150 hfize_llama.py:153] loaded layer 21
I0324 09:59:38.220741 4157150 hfize_llama.py:153] loaded layer 22
I0324 09:59:38.804841 4157150 hfize_llama.py:153] loaded layer 23
I0324 09:59:39.383517 4157150 hfize_llama.py:153] loaded layer 24
I0324 09:59:39.951927 4157150 hfize_llama.py:153] loaded layer 25
I0324 09:59:40.556830 4157150 hfize_llama.py:153] loaded layer 26
I0324 09:59:41.136181 4157150 hfize_llama.py:153] loaded layer 27
I0324 09:59:41.723852 4157150 hfize_llama.py:153] loaded layer 28
I0324 09:59:42.320410 4157150 hfize_llama.py:153] loaded layer 29
I0324 09:59:42.904341 4157150 hfize_llama.py:153] loaded layer 30
I0324 09:59:43.478097 4157150 hfize_llama.py:153] loaded layer 31
I0324 09:59:43.478239 4157150 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:07,  1.24s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.09s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.07s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:05<00:04,  1.35s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:06<00:02,  1.26s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:07<00:01,  1.15s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.10s/it]
I0324 10:00:41.362398 4157150 hfize_llama.py:167] successfully loaded hfized model
W0324 10:00:45.592839 4158482 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 10:00:46.107212 4158482 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:08,  1.46s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:07,  1.44s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:04<00:05,  1.40s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:05<00:04,  1.37s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:06<00:02,  1.34s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:08<00:01,  1.28s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:08<00:00,  1.10s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:08<00:00,  1.25s/it]
I0324 10:00:55.308793 4158482 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.5909968614578247:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.5909968614578247:   1%|          | 1/141 [00:01<04:21,  1.87s/it]avg_loss = 1.9002204537391663:   1%|          | 1/141 [00:03<04:21,  1.87s/it]avg_loss = 1.9002204537391663:   1%|▏         | 2/141 [00:03<03:46,  1.63s/it]avg_loss = 2.0355553229649863:   1%|▏         | 2/141 [00:04<03:46,  1.63s/it]avg_loss = 2.0355553229649863:   2%|▏         | 3/141 [00:04<03:35,  1.56s/it]avg_loss = 1.9875111877918243:   2%|▏         | 3/141 [00:06<03:35,  1.56s/it]avg_loss = 1.9875111877918243:   3%|▎         | 4/141 [00:06<03:29,  1.53s/it]avg_loss = 1.9411763429641724:   3%|▎         | 4/141 [00:07<03:29,  1.53s/it]avg_loss = 1.9411763429641724:   4%|▎         | 5/141 [00:07<03:25,  1.51s/it]avg_loss = 1.8434595465660095:   4%|▎         | 5/141 [00:09<03:25,  1.51s/it]avg_loss = 1.8434595465660095:   4%|▍         | 6/141 [00:09<03:22,  1.50s/it]avg_loss = 1.7813060964856828:   4%|▍         | 6/141 [00:10<03:22,  1.50s/it]avg_loss = 1.7813060964856828:   5%|▍         | 7/141 [00:10<03:20,  1.50s/it]avg_loss = 1.7759382724761963:   5%|▍         | 7/141 [00:12<03:20,  1.50s/it]avg_loss = 1.7759382724761963:   6%|▌         | 8/141 [00:12<03:19,  1.50s/it]avg_loss = 1.8098814487457275:   6%|▌         | 8/141 [00:13<03:19,  1.50s/it]avg_loss = 1.8098814487457275:   6%|▋         | 9/141 [00:13<03:17,  1.50s/it]avg_loss = 1.8128549695014953:   6%|▋         | 9/141 [00:15<03:17,  1.50s/it]avg_loss = 1.8128549695014953:   7%|▋         | 10/141 [00:15<03:16,  1.50s/it]avg_loss = 1.80852041461251:   7%|▋         | 10/141 [00:16<03:16,  1.50s/it]  avg_loss = 1.80852041461251:   8%|▊         | 11/141 [00:16<03:15,  1.50s/it]avg_loss = 1.8306293586889903:   8%|▊         | 11/141 [00:18<03:15,  1.50s/it]avg_loss = 1.8306293586889903:   9%|▊         | 12/141 [00:18<03:14,  1.50s/it]avg_loss = 1.8425514606329112:   9%|▊         | 12/141 [00:19<03:14,  1.50s/it]avg_loss = 1.8425514606329112:   9%|▉         | 13/141 [00:19<03:12,  1.51s/it]avg_loss = 1.8597917812211173:   9%|▉         | 13/141 [00:21<03:12,  1.51s/it]avg_loss = 1.8597917812211173:  10%|▉         | 14/141 [00:21<03:12,  1.51s/it]avg_loss = 1.8695302406946819:  10%|▉         | 14/141 [00:22<03:12,  1.51s/it]avg_loss = 1.8695302406946819:  11%|█         | 15/141 [00:22<03:10,  1.52s/it]avg_loss = 1.8941773995757103:  11%|█         | 15/141 [00:24<03:10,  1.52s/it]avg_loss = 1.8941773995757103:  11%|█▏        | 16/141 [00:24<03:09,  1.52s/it]avg_loss = 1.8977943799074959:  11%|█▏        | 16/141 [00:25<03:09,  1.52s/it]avg_loss = 1.8977943799074959:  12%|█▏        | 17/141 [00:25<03:08,  1.52s/it]avg_loss = 1.8998891843689814:  12%|█▏        | 17/141 [00:27<03:08,  1.52s/it]avg_loss = 1.8998891843689814:  13%|█▎        | 18/141 [00:27<03:07,  1.52s/it]avg_loss = 1.8834335239310014:  13%|█▎        | 18/141 [00:28<03:07,  1.52s/it]avg_loss = 1.8834335239310014:  13%|█▎        | 19/141 [00:28<03:05,  1.52s/it]avg_loss = 1.881817001104355:  13%|█▎        | 19/141 [00:30<03:05,  1.52s/it] avg_loss = 1.881817001104355:  14%|█▍        | 20/141 [00:30<03:04,  1.52s/it]avg_loss = 1.886311372121175:  14%|█▍        | 20/141 [00:31<03:04,  1.52s/it]avg_loss = 1.886311372121175:  15%|█▍        | 21/141 [00:31<03:03,  1.53s/it]avg_loss = 1.888791631568562:  15%|█▍        | 21/141 [00:33<03:03,  1.53s/it]avg_loss = 1.888791631568562:  16%|█▌        | 22/141 [00:33<03:02,  1.53s/it]avg_loss = 1.8902368338211724:  16%|█▌        | 22/141 [00:35<03:02,  1.53s/it]avg_loss = 1.8902368338211724:  16%|█▋        | 23/141 [00:35<03:00,  1.53s/it]avg_loss = 1.8950073619683583:  16%|█▋        | 23/141 [00:36<03:00,  1.53s/it]avg_loss = 1.8950073619683583:  17%|█▋        | 24/141 [00:36<02:59,  1.54s/it]avg_loss = 1.9008666896820068:  17%|█▋        | 24/141 [00:38<02:59,  1.54s/it]avg_loss = 1.9008666896820068:  18%|█▊        | 25/141 [00:38<02:58,  1.54s/it]avg_loss = 1.912392442043011:  18%|█▊        | 25/141 [00:39<02:58,  1.54s/it] avg_loss = 1.912392442043011:  18%|█▊        | 26/141 [00:39<02:57,  1.54s/it]avg_loss = 1.925204497796518:  18%|█▊        | 26/141 [00:41<02:57,  1.54s/it]avg_loss = 1.925204497796518:  19%|█▉        | 27/141 [00:41<02:56,  1.54s/it]avg_loss = 1.9315844178199768:  19%|█▉        | 27/141 [00:42<02:56,  1.54s/it]avg_loss = 1.9315844178199768:  20%|█▉        | 28/141 [00:42<02:54,  1.55s/it]avg_loss = 1.9281501975552788:  20%|█▉        | 28/141 [00:44<02:54,  1.55s/it]avg_loss = 1.9281501975552788:  21%|██        | 29/141 [00:44<02:53,  1.55s/it]avg_loss = 1.9187558094660442:  21%|██        | 29/141 [00:45<02:53,  1.55s/it]avg_loss = 1.9187558094660442:  21%|██▏       | 30/141 [00:45<02:51,  1.55s/it]avg_loss = 1.9047642907788676:  21%|██▏       | 30/141 [00:47<02:51,  1.55s/it]avg_loss = 1.9047642907788676:  22%|██▏       | 31/141 [00:47<02:50,  1.55s/it]avg_loss = 1.8930738419294357:  22%|██▏       | 31/141 [00:49<02:50,  1.55s/it]avg_loss = 1.8930738419294357:  23%|██▎       | 32/141 [00:49<02:49,  1.55s/it]avg_loss = 1.8915512706294204:  23%|██▎       | 32/141 [00:50<02:49,  1.55s/it]avg_loss = 1.8915512706294204:  23%|██▎       | 33/141 [00:50<02:47,  1.55s/it]avg_loss = 1.8897089782883139:  23%|██▎       | 33/141 [00:52<02:47,  1.55s/it]avg_loss = 1.8897089782883139:  24%|██▍       | 34/141 [00:52<02:46,  1.55s/it]avg_loss = 1.8922145128250123:  24%|██▍       | 34/141 [00:53<02:46,  1.55s/it]avg_loss = 1.8922145128250123:  25%|██▍       | 35/141 [00:53<02:44,  1.56s/it]avg_loss = 1.875308397743437:  25%|██▍       | 35/141 [00:55<02:44,  1.56s/it] avg_loss = 1.875308397743437:  26%|██▌       | 36/141 [00:55<02:43,  1.56s/it]avg_loss = 1.8600210499119114:  26%|██▌       | 36/141 [00:56<02:43,  1.56s/it]avg_loss = 1.8600210499119114:  26%|██▌       | 37/141 [00:56<02:42,  1.56s/it]avg_loss = 1.8454026140664752:  26%|██▌       | 37/141 [00:58<02:42,  1.56s/it]avg_loss = 1.8454026140664752:  27%|██▋       | 38/141 [00:58<02:40,  1.56s/it]avg_loss = 1.831159885113056:  27%|██▋       | 38/141 [00:59<02:40,  1.56s/it] avg_loss = 1.831159885113056:  28%|██▊       | 39/141 [00:59<02:39,  1.56s/it]avg_loss = 1.8228756070137024:  28%|██▊       | 39/141 [01:01<02:39,  1.56s/it]avg_loss = 1.8228756070137024:  28%|██▊       | 40/141 [01:01<02:37,  1.56s/it]avg_loss = 1.828038611063143:  28%|██▊       | 40/141 [01:03<02:37,  1.56s/it] avg_loss = 1.828038611063143:  29%|██▉       | 41/141 [01:03<02:36,  1.56s/it]avg_loss = 1.8448267039798556:  29%|██▉       | 41/141 [01:04<02:36,  1.56s/it]avg_loss = 1.8448267039798556:  30%|██▉       | 42/141 [01:04<02:34,  1.56s/it]avg_loss = 1.8611365085424378:  30%|██▉       | 42/141 [01:06<02:34,  1.56s/it]avg_loss = 1.8611365085424378:  30%|███       | 43/141 [01:06<02:33,  1.57s/it]avg_loss = 1.864542928608981:  30%|███       | 43/141 [01:07<02:33,  1.57s/it] avg_loss = 1.864542928608981:  31%|███       | 44/141 [01:07<02:32,  1.57s/it]avg_loss = 1.868797853257921:  31%|███       | 44/141 [01:09<02:32,  1.57s/it]avg_loss = 1.868797853257921:  32%|███▏      | 45/141 [01:09<02:30,  1.57s/it]avg_loss = 1.8739558821139128:  32%|███▏      | 45/141 [01:10<02:30,  1.57s/it]avg_loss = 1.8739558821139128:  33%|███▎      | 46/141 [01:10<02:29,  1.57s/it]avg_loss = 1.880490668276523:  33%|███▎      | 46/141 [01:12<02:29,  1.57s/it] avg_loss = 1.880490668276523:  33%|███▎      | 47/141 [01:12<02:27,  1.57s/it]avg_loss = 1.8837199260791142:  33%|███▎      | 47/141 [01:14<02:27,  1.57s/it]avg_loss = 1.8837199260791142:  34%|███▍      | 48/141 [01:14<02:26,  1.57s/it]avg_loss = 1.8825785651498912:  34%|███▍      | 48/141 [01:15<02:26,  1.57s/it]avg_loss = 1.8825785651498912:  35%|███▍      | 49/141 [01:15<02:24,  1.58s/it]avg_loss = 1.8820984840393067:  35%|███▍      | 49/141 [01:17<02:24,  1.58s/it]avg_loss = 1.8820984840393067:  35%|███▌      | 50/141 [01:17<02:23,  1.58s/it]avg_loss = 1.8758964935938518:  35%|███▌      | 50/141 [01:18<02:23,  1.58s/it]avg_loss = 1.8758964935938518:  36%|███▌      | 51/141 [01:18<02:22,  1.58s/it]avg_loss = 1.872147044310203:  36%|███▌      | 51/141 [01:20<02:22,  1.58s/it] avg_loss = 1.872147044310203:  37%|███▋      | 52/141 [01:20<02:20,  1.58s/it]avg_loss = 1.8655954441934262:  37%|███▋      | 52/141 [01:21<02:20,  1.58s/it]avg_loss = 1.8655954441934262:  38%|███▊      | 53/141 [01:21<02:18,  1.58s/it]avg_loss = 1.8625080011509083:  38%|███▊      | 53/141 [01:23<02:18,  1.58s/it]avg_loss = 1.8625080011509083:  38%|███▊      | 54/141 [01:23<02:17,  1.58s/it]avg_loss = 1.8549405228007922:  38%|███▊      | 54/141 [01:25<02:17,  1.58s/it]avg_loss = 1.8549405228007922:  39%|███▉      | 55/141 [01:25<02:15,  1.58s/it]avg_loss = 1.8471132623297828:  39%|███▉      | 55/141 [01:26<02:15,  1.58s/it]avg_loss = 1.8471132623297828:  40%|███▉      | 56/141 [01:26<02:14,  1.58s/it]avg_loss = 1.8412277510291652:  40%|███▉      | 56/141 [01:28<02:14,  1.58s/it]avg_loss = 1.8412277510291652:  40%|████      | 57/141 [01:28<02:12,  1.58s/it]avg_loss = 1.8383976837684368:  40%|████      | 57/141 [01:29<02:12,  1.58s/it]avg_loss = 1.8383976837684368:  41%|████      | 58/141 [01:29<02:11,  1.58s/it]avg_loss = 1.8406293109311895:  41%|████      | 58/141 [01:31<02:11,  1.58s/it]avg_loss = 1.8406293109311895:  42%|████▏     | 59/141 [01:31<02:09,  1.58s/it]avg_loss = 1.846116042137146:  42%|████▏     | 59/141 [01:33<02:09,  1.58s/it] avg_loss = 1.846116042137146:  43%|████▎     | 60/141 [01:33<02:08,  1.58s/it]avg_loss = 1.8520258411032255:  43%|████▎     | 60/141 [01:34<02:08,  1.58s/it]avg_loss = 1.8520258411032255:  43%|████▎     | 61/141 [01:34<02:06,  1.58s/it]avg_loss = 1.85941441212931:  43%|████▎     | 61/141 [01:36<02:06,  1.58s/it]  avg_loss = 1.85941441212931:  44%|████▍     | 62/141 [01:36<02:05,  1.58s/it]avg_loss = 1.8504085635382033:  44%|████▍     | 62/141 [01:37<02:05,  1.58s/it]avg_loss = 1.8504085635382033:  45%|████▍     | 63/141 [01:37<02:03,  1.58s/it]avg_loss = 1.8482036869972944:  45%|████▍     | 63/141 [01:39<02:03,  1.58s/it]avg_loss = 1.8482036869972944:  45%|████▌     | 64/141 [01:39<02:02,  1.59s/it]avg_loss = 1.8455702066421509:  45%|████▌     | 64/141 [01:40<02:02,  1.59s/it]avg_loss = 1.8455702066421509:  46%|████▌     | 65/141 [01:40<02:00,  1.58s/it]avg_loss = 1.839458608266079:  46%|████▌     | 65/141 [01:42<02:00,  1.58s/it] avg_loss = 1.839458608266079:  47%|████▋     | 66/141 [01:42<01:58,  1.59s/it]avg_loss = 1.8368584042164817:  47%|████▋     | 66/141 [01:44<01:58,  1.59s/it]avg_loss = 1.8368584042164817:  48%|████▊     | 67/141 [01:44<01:57,  1.59s/it]avg_loss = 1.8335631559876835:  48%|████▊     | 67/141 [01:45<01:57,  1.59s/it]avg_loss = 1.8335631559876835:  48%|████▊     | 68/141 [01:45<01:55,  1.59s/it]avg_loss = 1.830667469812476:  48%|████▊     | 68/141 [01:47<01:55,  1.59s/it] avg_loss = 1.830667469812476:  49%|████▉     | 69/141 [01:47<01:54,  1.59s/it]avg_loss = 1.831485036441258:  49%|████▉     | 69/141 [01:48<01:54,  1.59s/it]avg_loss = 1.831485036441258:  50%|████▉     | 70/141 [01:48<01:52,  1.59s/it]avg_loss = 1.8351630963070291:  50%|████▉     | 70/141 [01:50<01:52,  1.59s/it]avg_loss = 1.8351630963070291:  50%|█████     | 71/141 [01:50<01:51,  1.59s/it]avg_loss = 1.8376515573925443:  50%|█████     | 71/141 [01:52<01:51,  1.59s/it]avg_loss = 1.8376515573925443:  51%|█████     | 72/141 [01:52<01:49,  1.59s/it]avg_loss = 1.8362039099000904:  51%|█████     | 72/141 [01:53<01:49,  1.59s/it]avg_loss = 1.8362039099000904:  52%|█████▏    | 73/141 [01:53<01:47,  1.59s/it]avg_loss = 1.8378063520869694:  52%|█████▏    | 73/141 [01:55<01:47,  1.59s/it]avg_loss = 1.8378063520869694:  52%|█████▏    | 74/141 [01:55<01:46,  1.59s/it]avg_loss = 1.8380197938283285:  52%|█████▏    | 74/141 [01:56<01:46,  1.59s/it]avg_loss = 1.8380197938283285:  53%|█████▎    | 75/141 [01:56<01:44,  1.59s/it]avg_loss = 1.8370147959182137:  53%|█████▎    | 75/141 [01:58<01:44,  1.59s/it]avg_loss = 1.8370147959182137:  54%|█████▍    | 76/141 [01:58<01:43,  1.59s/it]avg_loss = 1.8382266326384111:  54%|█████▍    | 76/141 [02:00<01:43,  1.59s/it]avg_loss = 1.8382266326384111:  55%|█████▍    | 77/141 [02:00<01:41,  1.59s/it]avg_loss = 1.840582937766344:  55%|█████▍    | 77/141 [02:01<01:41,  1.59s/it] avg_loss = 1.840582937766344:  55%|█████▌    | 78/141 [02:01<01:40,  1.59s/it]avg_loss = 1.8446766741668121:  55%|█████▌    | 78/141 [02:03<01:40,  1.59s/it]avg_loss = 1.8446766741668121:  56%|█████▌    | 79/141 [02:03<01:38,  1.59s/it]avg_loss = 1.8418024003505706:  56%|█████▌    | 79/141 [02:04<01:38,  1.59s/it]avg_loss = 1.8418024003505706:  57%|█████▋    | 80/141 [02:04<01:37,  1.59s/it]avg_loss = 1.8406565086341198:  57%|█████▋    | 80/141 [02:06<01:37,  1.59s/it]avg_loss = 1.8406565086341198:  57%|█████▋    | 81/141 [02:06<01:35,  1.59s/it]avg_loss = 1.839854252047655:  57%|█████▋    | 81/141 [02:07<01:35,  1.59s/it] avg_loss = 1.839854252047655:  58%|█████▊    | 82/141 [02:07<01:33,  1.59s/it]avg_loss = 1.8380594354077995:  58%|█████▊    | 82/141 [02:09<01:33,  1.59s/it]avg_loss = 1.8380594354077995:  59%|█████▉    | 83/141 [02:09<01:32,  1.59s/it]avg_loss = 1.8358376579625266:  59%|█████▉    | 83/141 [02:11<01:32,  1.59s/it]avg_loss = 1.8358376579625266:  60%|█████▉    | 84/141 [02:11<01:30,  1.59s/it]avg_loss = 1.8335167127497056:  60%|█████▉    | 84/141 [02:12<01:30,  1.59s/it]avg_loss = 1.8335167127497056:  60%|██████    | 85/141 [02:12<01:29,  1.59s/it]avg_loss = 1.8352192820504654:  60%|██████    | 85/141 [02:14<01:29,  1.59s/it]avg_loss = 1.8352192820504654:  61%|██████    | 86/141 [02:14<01:27,  1.59s/it]avg_loss = 1.8372260660960757:  61%|██████    | 86/141 [02:15<01:27,  1.59s/it]avg_loss = 1.8372260660960757:  62%|██████▏   | 87/141 [02:15<01:25,  1.59s/it]avg_loss = 1.8377133580771359:  62%|██████▏   | 87/141 [02:17<01:25,  1.59s/it]avg_loss = 1.8377133580771359:  62%|██████▏   | 88/141 [02:17<01:24,  1.59s/it]avg_loss = 1.8464901554450561:  62%|██████▏   | 88/141 [02:19<01:24,  1.59s/it]avg_loss = 1.8464901554450561:  63%|██████▎   | 89/141 [02:19<01:22,  1.59s/it]avg_loss = 1.853971717092726:  63%|██████▎   | 89/141 [02:20<01:22,  1.59s/it] avg_loss = 1.853971717092726:  64%|██████▍   | 90/141 [02:20<01:21,  1.59s/it]avg_loss = 1.8570950083680204:  64%|██████▍   | 90/141 [02:22<01:21,  1.59s/it]avg_loss = 1.8570950083680204:  65%|██████▍   | 91/141 [02:22<01:19,  1.59s/it]avg_loss = 1.8621491712072622:  65%|██████▍   | 91/141 [02:23<01:19,  1.59s/it]avg_loss = 1.8621491712072622:  65%|██████▌   | 92/141 [02:23<01:18,  1.59s/it]avg_loss = 1.867213080006261:  65%|██████▌   | 92/141 [02:25<01:18,  1.59s/it] avg_loss = 1.867213080006261:  66%|██████▌   | 93/141 [02:25<01:16,  1.59s/it]avg_loss = 1.868217020592791:  66%|██████▌   | 93/141 [02:27<01:16,  1.59s/it]avg_loss = 1.868217020592791:  67%|██████▋   | 94/141 [02:27<01:14,  1.59s/it]avg_loss = 1.8720562144329673:  67%|██████▋   | 94/141 [02:28<01:14,  1.59s/it]avg_loss = 1.8720562144329673:  67%|██████▋   | 95/141 [02:28<01:13,  1.59s/it]avg_loss = 1.872795194387436:  67%|██████▋   | 95/141 [02:30<01:13,  1.59s/it] avg_loss = 1.872795194387436:  68%|██████▊   | 96/141 [02:30<01:11,  1.60s/it]avg_loss = 1.874597084890936:  68%|██████▊   | 96/141 [02:31<01:11,  1.60s/it]avg_loss = 1.874597084890936:  69%|██████▉   | 97/141 [02:31<01:10,  1.60s/it]avg_loss = 1.8704786969690907:  69%|██████▉   | 97/141 [02:33<01:10,  1.60s/it]avg_loss = 1.8704786969690907:  70%|██████▉   | 98/141 [02:33<01:08,  1.60s/it]avg_loss = 1.8713633556558629:  70%|██████▉   | 98/141 [02:35<01:08,  1.60s/it]avg_loss = 1.8713633556558629:  70%|███████   | 99/141 [02:35<01:06,  1.60s/it]avg_loss = 1.8733618831634522:  70%|███████   | 99/141 [02:36<01:06,  1.60s/it]avg_loss = 1.8733618831634522:  71%|███████   | 100/141 [02:36<01:05,  1.59s/it]avg_loss = 1.8720713086647562:  71%|███████   | 100/141 [02:38<01:05,  1.59s/it]avg_loss = 1.8720713086647562:  72%|███████▏  | 101/141 [02:38<01:03,  1.59s/it]avg_loss = 1.8722492316189934:  72%|███████▏  | 101/141 [02:39<01:03,  1.59s/it]avg_loss = 1.8722492316189934:  72%|███████▏  | 102/141 [02:39<01:02,  1.59s/it]avg_loss = 1.8706377871985573:  72%|███████▏  | 102/141 [02:41<01:02,  1.59s/it]avg_loss = 1.8706377871985573:  73%|███████▎  | 103/141 [02:41<01:00,  1.59s/it]avg_loss = 1.873308117573078:  73%|███████▎  | 103/141 [02:43<01:00,  1.59s/it] avg_loss = 1.873308117573078:  74%|███████▍  | 104/141 [02:43<00:58,  1.59s/it]avg_loss = 1.8718865031287784:  74%|███████▍  | 104/141 [02:44<00:58,  1.59s/it]avg_loss = 1.8718865031287784:  74%|███████▍  | 105/141 [02:44<00:57,  1.59s/it]avg_loss = 1.8708301523946367:  74%|███████▍  | 105/141 [02:46<00:57,  1.59s/it]avg_loss = 1.8708301523946367:  75%|███████▌  | 106/141 [02:46<00:55,  1.59s/it]avg_loss = 1.868658235139936:  75%|███████▌  | 106/141 [02:47<00:55,  1.59s/it] avg_loss = 1.868658235139936:  76%|███████▌  | 107/141 [02:47<00:54,  1.59s/it]avg_loss = 1.8664144067852586:  76%|███████▌  | 107/141 [02:49<00:54,  1.59s/it]avg_loss = 1.8664144067852586:  77%|███████▋  | 108/141 [02:49<00:52,  1.59s/it]avg_loss = 1.8639260596091594:  77%|███████▋  | 108/141 [02:51<00:52,  1.59s/it]avg_loss = 1.8639260596091594:  77%|███████▋  | 109/141 [02:51<00:51,  1.59s/it]avg_loss = 1.8616623184897683:  77%|███████▋  | 109/141 [02:52<00:51,  1.59s/it]avg_loss = 1.8616623184897683:  78%|███████▊  | 110/141 [02:52<00:49,  1.60s/it]avg_loss = 1.8642734235471434:  78%|███████▊  | 110/141 [02:54<00:49,  1.60s/it]avg_loss = 1.8642734235471434:  79%|███████▊  | 111/141 [02:54<00:47,  1.60s/it]avg_loss = 1.863909658576761:  79%|███████▊  | 111/141 [02:55<00:47,  1.60s/it] avg_loss = 1.863909658576761:  79%|███████▉  | 112/141 [02:55<00:46,  1.60s/it]avg_loss = 1.8650068814775584:  79%|███████▉  | 112/141 [02:57<00:46,  1.60s/it]avg_loss = 1.8650068814775584:  80%|████████  | 113/141 [02:57<00:44,  1.60s/it]avg_loss = 1.8660245339075725:  80%|████████  | 113/141 [02:59<00:44,  1.60s/it]avg_loss = 1.8660245339075725:  81%|████████  | 114/141 [02:59<00:43,  1.60s/it]avg_loss = 1.865335874972136:  81%|████████  | 114/141 [03:00<00:43,  1.60s/it] avg_loss = 1.865335874972136:  82%|████████▏ | 115/141 [03:00<00:41,  1.60s/it]avg_loss = 1.8638868465505798:  82%|████████▏ | 115/141 [03:02<00:41,  1.60s/it]avg_loss = 1.8638868465505798:  82%|████████▏ | 116/141 [03:02<00:39,  1.60s/it]avg_loss = 1.8659480789787748:  82%|████████▏ | 116/141 [03:03<00:39,  1.60s/it]avg_loss = 1.8659480789787748:  83%|████████▎ | 117/141 [03:03<00:38,  1.60s/it]avg_loss = 1.865541607646619:  83%|████████▎ | 117/141 [03:05<00:38,  1.60s/it] avg_loss = 1.865541607646619:  84%|████████▎ | 118/141 [03:05<00:36,  1.60s/it]avg_loss = 1.8641311962063574:  84%|████████▎ | 118/141 [03:07<00:36,  1.60s/it]avg_loss = 1.8641311962063574:  84%|████████▍ | 119/141 [03:07<00:35,  1.60s/it]avg_loss = 1.8624313354492188:  84%|████████▍ | 119/141 [03:08<00:35,  1.60s/it]avg_loss = 1.8624313354492188:  85%|████████▌ | 120/141 [03:08<00:33,  1.60s/it]avg_loss = 1.862287212994473:  85%|████████▌ | 120/141 [03:10<00:33,  1.60s/it] avg_loss = 1.862287212994473:  86%|████████▌ | 121/141 [03:10<00:31,  1.60s/it]avg_loss = 1.862763388235061:  86%|████████▌ | 121/141 [03:11<00:31,  1.60s/it]avg_loss = 1.862763388235061:  87%|████████▋ | 122/141 [03:11<00:30,  1.60s/it]avg_loss = 1.8625755862491886:  87%|████████▋ | 122/141 [03:13<00:30,  1.60s/it]avg_loss = 1.8625755862491886:  87%|████████▋ | 123/141 [03:13<00:28,  1.60s/it]avg_loss = 1.862677885640052:  87%|████████▋ | 123/141 [03:15<00:28,  1.60s/it] avg_loss = 1.862677885640052:  88%|████████▊ | 124/141 [03:15<00:27,  1.60s/it]avg_loss = 1.8614284687042237:  88%|████████▊ | 124/141 [03:16<00:27,  1.60s/it]avg_loss = 1.8614284687042237:  89%|████████▊ | 125/141 [03:16<00:25,  1.60s/it]avg_loss = 1.8617963488139804:  89%|████████▊ | 125/141 [03:18<00:25,  1.60s/it]avg_loss = 1.8617963488139804:  89%|████████▉ | 126/141 [03:18<00:23,  1.60s/it]avg_loss = 1.8614934898736908:  89%|████████▉ | 126/141 [03:19<00:23,  1.60s/it]avg_loss = 1.8614934898736908:  90%|█████████ | 127/141 [03:19<00:22,  1.60s/it]avg_loss = 1.8602263191714883:  90%|█████████ | 127/141 [03:21<00:22,  1.60s/it]avg_loss = 1.8602263191714883:  91%|█████████ | 128/141 [03:21<00:20,  1.60s/it]avg_loss = 1.8602926010309264:  91%|█████████ | 128/141 [03:22<00:20,  1.60s/it]avg_loss = 1.8602926010309264:  91%|█████████▏| 129/141 [03:22<00:19,  1.60s/it]avg_loss = 1.8610672620626596:  91%|█████████▏| 129/141 [03:24<00:19,  1.60s/it]avg_loss = 1.8610672620626596:  92%|█████████▏| 130/141 [03:24<00:17,  1.60s/it]avg_loss = 1.8618994468951042:  92%|█████████▏| 130/141 [03:26<00:17,  1.60s/it]avg_loss = 1.8618994468951042:  93%|█████████▎| 131/141 [03:26<00:15,  1.60s/it]avg_loss = 1.862493499661937:  93%|█████████▎| 131/141 [03:27<00:15,  1.60s/it] avg_loss = 1.862493499661937:  94%|█████████▎| 132/141 [03:27<00:14,  1.60s/it]avg_loss = 1.859717373561142:  94%|█████████▎| 132/141 [03:29<00:14,  1.60s/it]avg_loss = 1.859717373561142:  94%|█████████▍| 133/141 [03:29<00:12,  1.60s/it]avg_loss = 1.855271932794087:  94%|█████████▍| 133/141 [03:30<00:12,  1.60s/it]avg_loss = 1.855271932794087:  95%|█████████▌| 134/141 [03:30<00:11,  1.60s/it]avg_loss = 1.8578051222695244:  95%|█████████▌| 134/141 [03:32<00:11,  1.60s/it]avg_loss = 1.8578051222695244:  96%|█████████▌| 135/141 [03:32<00:09,  1.60s/it]avg_loss = 1.8613512594910229:  96%|█████████▌| 135/141 [03:34<00:09,  1.60s/it]avg_loss = 1.8613512594910229:  96%|█████████▋| 136/141 [03:34<00:07,  1.60s/it]avg_loss = 1.8624386465462455:  96%|█████████▋| 136/141 [03:35<00:07,  1.60s/it]avg_loss = 1.8624386465462455:  97%|█████████▋| 137/141 [03:35<00:06,  1.60s/it]avg_loss = 1.8611798260522925:  97%|█████████▋| 137/141 [03:37<00:06,  1.60s/it]avg_loss = 1.8611798260522925:  98%|█████████▊| 138/141 [03:37<00:04,  1.60s/it]avg_loss = 1.8614546978216377:  98%|█████████▊| 138/141 [03:38<00:04,  1.60s/it]avg_loss = 1.8614546978216377:  99%|█████████▊| 139/141 [03:38<00:03,  1.60s/it]avg_loss = 1.861952522822789:  99%|█████████▊| 139/141 [03:40<00:03,  1.60s/it] avg_loss = 1.861952522822789:  99%|█████████▉| 140/141 [03:40<00:01,  1.60s/it]avg_loss = 1.8631774178633453:  99%|█████████▉| 140/141 [03:42<00:01,  1.60s/it]avg_loss = 1.8631774178633453: 100%|██████████| 141/141 [03:42<00:00,  1.60s/it]avg_loss = 1.8631774178633453: 100%|██████████| 141/141 [03:42<00:00,  1.58s/it]
I0324 10:05:09.071414 4158482 eval_ppl.py:107] wikitext2 perplexity: 6.444180011749268
wikitext2 perplexity: 6.444
