I0324 09:07:46.815348 4112990 config.py:54] PyTorch version 2.6.0 available.
W0324 09:07:47.095437 4112990 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:07:47.976680 4112990 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.10it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.83it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.07it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.23it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.30it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.24it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.93it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.00it/s]
I0324 09:07:49.424096 4112990 quantize_finetune_llama.py:150] loaded model
I0324 09:07:49.802872 4112990 quantize_finetune_llama.py:185] loaded compression model
I0324 09:08:07.516474 4112990 quantize_finetune_llama.py:189] loaded dataset and devset
I0324 09:08:13.069787 4112990 quantize_finetune_llama.py:209] layer 0 gpu 0
I0324 09:08:15.939593 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 2.722024440765381s
Use train scale and shift
tensor(-1.5053e-07, device='cuda:0') tensor(0.0156, device='cuda:0')
tensor(0.0156, device='cuda:0') tensor(-1.5053e-07, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0324 09:08:30.675246 4113699 config.py:54] PyTorch version 2.6.0 available.
W0324 09:08:30.952932 4113699 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:08:31.818881 4113699 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:08:31.822796 4112990 quantize_finetune_llama.py:209] layer 1 gpu 1
I0324 09:08:32.299746 4113699 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:08:34.940889 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 2.960601329803467s
I0324 09:08:38.231281 4113843 config.py:54] PyTorch version 2.6.0 available.
W0324 09:08:38.508409 4113843 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:08:39.378627 4113843 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:08:39.382613 4112990 quantize_finetune_llama.py:209] layer 2 gpu 2
I0324 09:08:39.617786 4113843 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:08:41.869984 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 2.352607488632202s
I0324 09:08:45.266661 4114012 config.py:54] PyTorch version 2.6.0 available.
W0324 09:08:45.545973 4114012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:08:46.438693 4114012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:08:46.442615 4112990 quantize_finetune_llama.py:209] layer 3 gpu 3
I0324 09:08:46.778509 4114012 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:08:48.878584 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 2.2946360111236572s
I0324 09:08:52.339902 4114166 config.py:54] PyTorch version 2.6.0 available.
W0324 09:08:52.642565 4114166 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:08:53.633533 4114166 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:08:53.637646 4112990 quantize_finetune_llama.py:209] layer 4 gpu 0
I0324 09:08:53.825228 4114166 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.002629338763654232 tr(WHW.T) 59.12685012817383
bpp_loss 4.639855396118946
0_q proxy err 1.5159365830186289e-05 tr(WHW.T) 288042.3125
bpp_loss 3.759706451324746
0_k proxy err 1.2323473129072227e-05 tr(WHW.T) 100153.140625
bpp_loss 4.949503074516542
0_o proxy err 0.0009996994631364942 tr(WHW.T) 3114.052734375
bpp_loss 3.394187080732081
0_up proxy err 0.012563254684209824 tr(WHW.T) 8860.3681640625
bpp_loss 2.9441666125452945
0_gate proxy err 0.007382199168205261 tr(WHW.T) 15700.7783203125
bpp_loss 3.015275108228837
0_down proxy err 0.006380227394402027 tr(WHW.T) 10754.4326171875
bpp_loss 3.336127126739094
1_v proxy err 0.006114209070801735 tr(WHW.T) 106.5717544555664
bpp_loss 4.611856087460183
1_q proxy err 3.734006531885825e-05 tr(WHW.T) 144770.28125
bpp_loss 3.914486211433541
1_k proxy err 2.1440358977997676e-05 tr(WHW.T) 75510.3359375
bpp_loss 5.158954287995584
1_o proxy err 0.003787575289607048 tr(WHW.T) 1971.9923095703125
bpp_loss 3.358315139252227
1_up proxy err 0.014380930922925472 tr(WHW.T) 8164.80224609375
bpp_loss 2.9546496311335693
1_gate proxy err 0.008781635202467442 tr(WHW.T) 13872.5791015625
bpp_loss 3.0271634842003032
1_down proxy err 0.00014453775656875223 tr(WHW.T) 13912.466796875
bpp_loss 3.4254385546415245
I0324 09:11:09.184548 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 1.08193039894104s
I0324 09:11:13.077719 4115915 config.py:54] PyTorch version 2.6.0 available.
W0324 09:11:13.414287 4115915 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

2_v proxy err 0.003997147548943758 tr(WHW.T) 154.19476318359375
bpp_loss 4.612087970948778
2_q proxy err 0.0004087156557943672 tr(WHW.T) 41424.31640625
bpp_loss 3.785875534929801
2_k proxy err 0.00023604249872732908 tr(WHW.T) 22584.57421875
bpp_loss 5.016018269932829
2_o proxy err 0.004208392463624477 tr(WHW.T) 1957.2958984375
bpp_loss 3.3273227849276736
2_up proxy err 0.017154734581708908 tr(WHW.T) 7535.0859375
bpp_loss 2.9423378747222677
2_gate proxy err 0.008999057114124298 tr(WHW.T) 15028.9306640625
bpp_loss 3.0442316310613284
2_down proxy err 0.01004618126899004 tr(WHW.T) 7660.9140625
bpp_loss 3.3320257284379164
W0324 09:11:14.376657 4115915 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:11:14.380779 4112990 quantize_finetune_llama.py:209] layer 5 gpu 1
I0324 09:11:14.580693 4115915 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:11:15.986396 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 0.9463005065917969s
I0324 09:11:19.711489 4116053 config.py:54] PyTorch version 2.6.0 available.
W0324 09:11:20.032371 4116053 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:11:20.991854 4116053 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:11:20.996034 4112990 quantize_finetune_llama.py:209] layer 6 gpu 2
I0324 09:11:21.201839 4116053 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.0031408725772053003 tr(WHW.T) 286.84423828125
bpp_loss 4.617397372727282
3_q proxy err 0.0006216183537617326 tr(WHW.T) 47525.6328125
bpp_loss 3.6749309760634787
3_k proxy err 0.0003444772446528077 tr(WHW.T) 26144.59765625
bpp_loss 4.780442843330093
3_o proxy err 0.0058586508966982365 tr(WHW.T) 1844.0562744140625
bpp_loss 3.3298967456794344
3_up proxy err 0.017062468454241753 tr(WHW.T) 7473.4931640625
bpp_loss 2.930234135461173
3_gate proxy err 0.006567941978573799 tr(WHW.T) 20789.244140625
bpp_loss 3.1024650554837927
3_down proxy err 0.010717922821640968 tr(WHW.T) 6935.875
bpp_loss 3.3267127688408697
I0324 09:11:23.610905 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.8402976989746094s
I0324 09:11:27.100632 4116220 config.py:54] PyTorch version 2.6.0 available.
W0324 09:11:27.381035 4116220 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:11:28.266067 4116220 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:11:28.269946 4112990 quantize_finetune_llama.py:209] layer 7 gpu 3
I0324 09:11:28.460027 4116220 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:11:29.605312 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 0.8983044624328613s
I0324 09:11:32.986949 4116350 config.py:54] PyTorch version 2.6.0 available.
W0324 09:11:33.269132 4116350 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:11:34.146618 4116350 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:11:34.150287 4112990 quantize_finetune_llama.py:209] layer 8 gpu 0
I0324 09:11:34.312694 4116350 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.00376763753592968 tr(WHW.T) 282.4102478027344
bpp_loss 4.613306204904802
4_q proxy err 0.0005038926610723138 tr(WHW.T) 50064.87109375
bpp_loss 3.7057259038556367
4_k proxy err 0.000265764188952744 tr(WHW.T) 29273.04296875
bpp_loss 4.850291132344864
4_o proxy err 0.006971386726945639 tr(WHW.T) 1283.5389404296875
bpp_loss 3.348104786942713
4_up proxy err 0.017320850864052773 tr(WHW.T) 7323.67578125
bpp_loss 2.9166813299858143
4_gate proxy err 0.0048045325092971325 tr(WHW.T) 29024.958984375
bpp_loss 3.1610845411861583
4_down proxy err 0.010598168708384037 tr(WHW.T) 6336.10888671875
bpp_loss 3.3255819851100177
5_v proxy err 0.0035560980904847383 tr(WHW.T) 206.8320770263672
bpp_loss 4.6129763833014295
5_q proxy err 0.0006916998536325991 tr(WHW.T) 35942.19921875
bpp_loss 3.7072789454832673
5_k proxy err 0.00033742186496965587 tr(WHW.T) 22968.5703125
bpp_loss 4.8625683195423335
5_o proxy err 0.007053121458739042 tr(WHW.T) 1043.85205078125
bpp_loss 3.3424429027945735
5_up proxy err 0.01677798666059971 tr(WHW.T) 7595.9208984375
bpp_loss 2.921323803120426
5_gate proxy err 0.004609812516719103 tr(WHW.T) 30281.02734375
bpp_loss 3.162421745115093
5_down proxy err 0.010515676811337471 tr(WHW.T) 6350.9873046875
bpp_loss 3.323339935009634
I0324 09:13:47.897794 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.2470932006835938s
I0324 09:13:51.735535 4118079 config.py:54] PyTorch version 2.6.0 available.
W0324 09:13:52.076130 4118079 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:13:53.081901 4118079 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:13:53.086351 4112990 quantize_finetune_llama.py:209] layer 9 gpu 1
I0324 09:13:53.258589 4118079 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.003430783748626709 tr(WHW.T) 251.27548217773438
bpp_loss 4.612683151033707
6_q proxy err 0.0007750020595267415 tr(WHW.T) 35588.1328125
bpp_loss 3.7042550242622383
6_k proxy err 0.0003236468182876706 tr(WHW.T) 26134.55859375
bpp_loss 4.803771780687384
6_o proxy err 0.008841708302497864 tr(WHW.T) 996.3651733398438
bpp_loss 3.33212079515215
6_up proxy err 0.015835212543606758 tr(WHW.T) 7863.052734375
bpp_loss 2.925798299256712
6_gate proxy err 0.003831778885796666 tr(WHW.T) 35641.328125
bpp_loss 3.1726302352201725
6_down proxy err 0.01003255695104599 tr(WHW.T) 6423.478515625
bpp_loss 3.323868336338949
I0324 09:13:56.010169 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 0.961536169052124s
I0324 09:13:59.698304 4118234 config.py:54] PyTorch version 2.6.0 available.
W0324 09:14:00.017861 4118234 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:14:00.992150 4118234 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:14:00.996276 4112990 quantize_finetune_llama.py:209] layer 10 gpu 2
I0324 09:14:01.208103 4118234 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.0027035537641495466 tr(WHW.T) 307.1083068847656
bpp_loss 4.613104651332833
7_q proxy err 0.0008017854997888207 tr(WHW.T) 35097.69140625
bpp_loss 3.6390719329938293
7_k proxy err 0.00032842211658135056 tr(WHW.T) 26820.87890625
bpp_loss 4.7811648428905755
7_o proxy err 0.008547194302082062 tr(WHW.T) 945.9965209960938
bpp_loss 3.332750924746506
7_up proxy err 0.014426336623728275 tr(WHW.T) 8565.2685546875
bpp_loss 2.938381463621876
7_gate proxy err 0.0038456707261502743 tr(WHW.T) 34800.38671875
bpp_loss 3.156288632391287
7_down proxy err 0.010119414888322353 tr(WHW.T) 6472.80322265625
bpp_loss 3.32521367793171
I0324 09:14:03.575415 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.7709352970123291s
I0324 09:14:06.937633 4118398 config.py:54] PyTorch version 2.6.0 available.
W0324 09:14:07.218739 4118398 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:14:08.112264 4118398 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:14:08.116081 4112990 quantize_finetune_llama.py:209] layer 11 gpu 3
I0324 09:14:08.428825 4118398 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:14:09.413678 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 0.8732614517211914s
I0324 09:14:13.100762 4118524 config.py:54] PyTorch version 2.6.0 available.
W0324 09:14:13.379151 4118524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:14:14.386424 4118524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:14:14.390465 4112990 quantize_finetune_llama.py:209] layer 12 gpu 0
I0324 09:14:14.804706 4118524 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.0036415979266166687 tr(WHW.T) 255.14593505859375
bpp_loss 4.6101321739843115
8_q proxy err 0.001053494866937399 tr(WHW.T) 26553.384765625
bpp_loss 3.6544715800555423
8_k proxy err 0.00039231148548424244 tr(WHW.T) 22499.607421875
bpp_loss 4.780914606759325
8_o proxy err 0.010981154628098011 tr(WHW.T) 731.8719482421875
bpp_loss 3.3315963456989266
8_up proxy err 0.014817987568676472 tr(WHW.T) 8433.421875
bpp_loss 2.9362726740406027
8_gate proxy err 0.0036504026502370834 tr(WHW.T) 37134.01171875
bpp_loss 3.1628959295339882
8_down proxy err 0.010069075971841812 tr(WHW.T) 6427.3955078125
bpp_loss 3.325645910276632
9_v proxy err 0.003662906587123871 tr(WHW.T) 347.97332763671875
bpp_loss 4.608566071023233
9_q proxy err 0.001138192368671298 tr(WHW.T) 25605.623046875
bpp_loss 3.6464885632740334
9_k proxy err 0.0004397736629471183 tr(WHW.T) 20913.580078125
bpp_loss 4.7614082612562925
9_o proxy err 0.010595216415822506 tr(WHW.T) 760.8590087890625
bpp_loss 3.3556626650388353
9_up proxy err 0.014051594771444798 tr(WHW.T) 8907.896484375
bpp_loss 2.941727602654802
9_gate proxy err 0.0034564356319606304 tr(WHW.T) 39308.97265625
bpp_loss 3.175261741903211
9_down proxy err 0.01030276995152235 tr(WHW.T) 6211.091796875
bpp_loss 3.323571049974167
I0324 09:16:27.094321 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 1.0760412216186523s
I0324 09:16:31.017194 4120243 config.py:54] PyTorch version 2.6.0 available.
W0324 09:16:31.369778 4120243 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:16:32.429372 4120243 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:16:32.433841 4112990 quantize_finetune_llama.py:209] layer 13 gpu 1
I0324 09:16:32.602875 4120243 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.003633541753515601 tr(WHW.T) 249.34664916992188
bpp_loss 4.608123063109815
10_q proxy err 0.001151380012743175 tr(WHW.T) 23288.728515625
bpp_loss 3.6960858625825495
10_k proxy err 0.0004303061868995428 tr(WHW.T) 19714.28515625
bpp_loss 4.8330219578929245
10_o proxy err 0.011269464157521725 tr(WHW.T) 667.2440185546875
bpp_loss 3.3422327250009403
10_up proxy err 0.013880276121199131 tr(WHW.T) 9134.4111328125
bpp_loss 2.95171105209738
10_gate proxy err 0.003645390970632434 tr(WHW.T) 37297.75
bpp_loss 3.148364616890571
10_down proxy err 0.01025888230651617 tr(WHW.T) 6461.62451171875
bpp_loss 3.3238446536540454
I0324 09:16:37.244987 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 0.9171855449676514s
11_v proxy err 0.002860227134078741 tr(WHW.T) 317.1318664550781
bpp_loss 4.611202850355767
11_q proxy err 0.0012813113862648606 tr(WHW.T) 22146.5234375
bpp_loss 3.6122483081999235
11_k proxy err 0.0005045245634391904 tr(WHW.T) 17998.525390625
bpp_loss 4.768086773343384
11_o proxy err 0.011833194643259048 tr(WHW.T) 551.9363403320312
bpp_loss 3.354017299192492
11_up proxy err 0.013582311570644379 tr(WHW.T) 9126.9775390625
bpp_loss 2.96104046921911
11_gate proxy err 0.003605731064453721 tr(WHW.T) 36784.98046875
bpp_loss 3.1386493987935995
11_down proxy err 0.010152324102818966 tr(WHW.T) 6591.28369140625
bpp_loss 3.3239812145641605
I0324 09:16:40.910940 4120437 config.py:54] PyTorch version 2.6.0 available.
W0324 09:16:41.196349 4120437 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:16:42.122563 4120437 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:16:42.126417 4112990 quantize_finetune_llama.py:209] layer 14 gpu 2
I0324 09:16:42.288004 4120437 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:16:43.677705 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 1.1018962860107422s
I0324 09:16:47.045112 4120567 config.py:54] PyTorch version 2.6.0 available.
W0324 09:16:47.331011 4120567 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:16:48.210606 4120567 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:16:48.214349 4112990 quantize_finetune_llama.py:209] layer 15 gpu 3
I0324 09:16:48.382675 4120567 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:16:49.483746 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.8516442775726318s
I0324 09:16:52.839585 4120712 config.py:54] PyTorch version 2.6.0 available.
W0324 09:16:53.141982 4120712 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:16:54.093330 4120712 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:16:54.097661 4112990 quantize_finetune_llama.py:209] layer 16 gpu 0
I0324 09:16:54.290758 4120712 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.0034826823975890875 tr(WHW.T) 360.2216491699219
bpp_loss 4.609969106153585
12_q proxy err 0.0008860336383804679 tr(WHW.T) 34057.0703125
bpp_loss 3.605584900942631
12_k proxy err 0.0004027456743642688 tr(WHW.T) 23029.533203125
bpp_loss 4.70430753484834
12_o proxy err 0.010860081762075424 tr(WHW.T) 764.130126953125
bpp_loss 3.3374255743110552
12_up proxy err 0.012168205343186855 tr(WHW.T) 9958.9345703125
bpp_loss 2.982021522575191
12_gate proxy err 0.0034682792611420155 tr(WHW.T) 37237.28125
bpp_loss 3.130427464244089
12_down proxy err 0.009951320476830006 tr(WHW.T) 6756.125
bpp_loss 3.3274322852957994
13_v proxy err 0.003885609097778797 tr(WHW.T) 277.2493591308594
bpp_loss 4.61137897556182
13_q proxy err 0.0013614640338346362 tr(WHW.T) 20850.80078125
bpp_loss 3.6445579766877927
13_k proxy err 0.000517036416567862 tr(WHW.T) 17769.314453125
bpp_loss 4.775957457488403
13_o proxy err 0.01128008496016264 tr(WHW.T) 660.2918090820312
bpp_loss 3.3471401736605912
13_up proxy err 0.011889096349477768 tr(WHW.T) 9941.6767578125
bpp_loss 2.984696936128395
13_gate proxy err 0.0032591894268989563 tr(WHW.T) 38824.0078125
bpp_loss 3.131306581465261
13_down proxy err 0.010202175937592983 tr(WHW.T) 6493.9638671875
bpp_loss 3.326133417830403
I0324 09:19:12.478048 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 0.9509813785552979s
14_v proxy err 0.0037496036384254694 tr(WHW.T) 278.4917907714844
bpp_loss 4.610813468229026
14_q proxy err 0.0012507356004789472 tr(WHW.T) 20837.234375
bpp_loss 3.6398960390361026
14_k proxy err 0.00045790086733177304 tr(WHW.T) 18590.26171875
bpp_loss 4.806077905464917
14_o proxy err 0.01102422084659338 tr(WHW.T) 671.5200805664062
bpp_loss 3.3392919079051353
14_up proxy err 0.012739209458231926 tr(WHW.T) 9096.203125
bpp_loss 2.985849278180727
14_gate proxy err 0.003033314598724246 tr(WHW.T) 41683.65625
bpp_loss 3.1552349095498875
14_down proxy err 0.010683359578251839 tr(WHW.T) 6324.6708984375
bpp_loss 3.3305498858015716
I0324 09:19:16.279870 4122479 config.py:54] PyTorch version 2.6.0 available.
W0324 09:19:16.606426 4122479 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:19:17.581200 4122479 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:19:17.585440 4112990 quantize_finetune_llama.py:209] layer 17 gpu 1
I0324 09:19:17.780449 4122479 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:19:19.026968 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.9573273658752441s
15_v proxy err 0.004482231102883816 tr(WHW.T) 280.6507568359375
bpp_loss 4.611789908027276
15_q proxy err 0.001089265919290483 tr(WHW.T) 28024.77734375
bpp_loss 3.728889247344341
15_k proxy err 0.0004910470452159643 tr(WHW.T) 18843.455078125
bpp_loss 4.737432757625356
15_o proxy err 0.010689693503081799 tr(WHW.T) 812.0530395507812
bpp_loss 3.360912819101941
15_up proxy err 0.013022635132074356 tr(WHW.T) 8927.576171875
bpp_loss 2.976750151453806
15_gate proxy err 0.0027779939118772745 tr(WHW.T) 46110.5703125
bpp_loss 3.1793074067016796
15_down proxy err 0.010494302958250046 tr(WHW.T) 6333.8271484375
bpp_loss 3.3287525341147557
I0324 09:19:22.858777 4122611 config.py:54] PyTorch version 2.6.0 available.
W0324 09:19:23.141085 4122611 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:19:24.014140 4122611 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:19:24.017981 4112990 quantize_finetune_llama.py:209] layer 18 gpu 2
I0324 09:19:24.330418 4122611 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:19:25.250071 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.8307957649230957s
I0324 09:19:28.577760 4122741 config.py:54] PyTorch version 2.6.0 available.
W0324 09:19:28.876361 4122741 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:19:29.749821 4122741 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:19:29.753709 4112990 quantize_finetune_llama.py:209] layer 19 gpu 3
I0324 09:19:29.981874 4122741 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:19:31.039747 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 19 in 0.8604650497436523s
I0324 09:19:34.384754 4122891 config.py:54] PyTorch version 2.6.0 available.
W0324 09:19:34.677406 4122891 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:19:35.567533 4122891 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:19:35.571651 4112990 quantize_finetune_llama.py:209] layer 20 gpu 0
I0324 09:19:35.739455 4122891 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.004057792015373707 tr(WHW.T) 271.31622314453125
bpp_loss 4.613386360695586
16_q proxy err 0.0010855515720322728 tr(WHW.T) 24435.859375
bpp_loss 3.722276845073793
16_k proxy err 0.00042731905705295503 tr(WHW.T) 19477.728515625
bpp_loss 4.820823399815708
16_o proxy err 0.009348588064312935 tr(WHW.T) 953.9540405273438
bpp_loss 3.345372909505386
16_up proxy err 0.014820425771176815 tr(WHW.T) 8266.0234375
bpp_loss 2.9582001962033764
16_gate proxy err 0.0033048258628696203 tr(WHW.T) 41063.65234375
bpp_loss 3.1997842573826865
16_down proxy err 0.010963331907987595 tr(WHW.T) 6224.45166015625
bpp_loss 3.3260672369173596
17_v proxy err 0.004877949133515358 tr(WHW.T) 280.38623046875
bpp_loss 4.611826200736687
17_q proxy err 0.0010918870102614164 tr(WHW.T) 27519.69921875
bpp_loss 3.7033313444117084
17_k proxy err 0.000541163026355207 tr(WHW.T) 17400.859375
bpp_loss 4.756103024818003
17_o proxy err 0.008866088464856148 tr(WHW.T) 1090.4486083984375
bpp_loss 3.36392288695788
17_up proxy err 0.014666823670268059 tr(WHW.T) 8387.9111328125
bpp_loss 2.95192141870835
17_gate proxy err 0.0032829628325998783 tr(WHW.T) 41602.7890625
bpp_loss 3.2088640950886265
17_down proxy err 0.011052325367927551 tr(WHW.T) 6148.6953125
bpp_loss 3.324567909934558
I0324 09:21:56.316558 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 20 in 1.1205339431762695s
I0324 09:22:00.260127 4124697 config.py:54] PyTorch version 2.6.0 available.
18_v proxy err 0.003866536309942603 tr(WHW.T) 284.69989013671875
bpp_loss 4.614498108043335
18_q proxy err 0.001360344234853983 tr(WHW.T) 22349.49609375
bpp_loss 3.677500130899716
18_k proxy err 0.000565391790587455 tr(WHW.T) 17364.392578125
bpp_loss 4.765881222207099
18_o proxy err 0.00916555617004633 tr(WHW.T) 1187.7923583984375
bpp_loss 3.353645325056277
18_up proxy err 0.016260044649243355 tr(WHW.T) 7918.9404296875
bpp_loss 2.9408725041763057
18_gate proxy err 0.004053858574479818 tr(WHW.T) 35128.28125
bpp_loss 3.207520733853536
18_down proxy err 0.01145463902503252 tr(WHW.T) 6163.37109375
bpp_loss 3.323178749415092
W0324 09:22:00.587422 4124697 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:22:01.600492 4124697 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:22:01.604686 4112990 quantize_finetune_llama.py:209] layer 21 gpu 1
I0324 09:22:01.834665 4124697 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:22:03.086317 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 21 in 1.0315752029418945s
I0324 09:22:06.781597 4124833 config.py:54] PyTorch version 2.6.0 available.
W0324 09:22:07.067042 4124833 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.003715893952175975 tr(WHW.T) 337.79034423828125
bpp_loss 4.616468136780895
19_q proxy err 0.0013088048435747623 tr(WHW.T) 23987.85546875
bpp_loss 3.6702066729194485
19_k proxy err 0.0006264172261580825 tr(WHW.T) 15525.201171875
bpp_loss 4.711284496006556
19_o proxy err 0.010252443142235279 tr(WHW.T) 1153.098876953125
bpp_loss 3.3477795207872987
19_up proxy err 0.017262732610106468 tr(WHW.T) 7585.85546875
bpp_loss 2.9359200654684434
19_gate proxy err 0.004433917813003063 tr(WHW.T) 32695.314453125
bpp_loss 3.213550033713026
19_down proxy err 0.011716262437403202 tr(WHW.T) 6119.80810546875
bpp_loss 3.323204764796953
W0324 09:22:07.939406 4124833 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:22:07.943168 4112990 quantize_finetune_llama.py:209] layer 22 gpu 2
I0324 09:22:08.090604 4124833 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:22:09.167089 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 22 in 0.7838823795318604s
I0324 09:22:12.470748 4124963 config.py:54] PyTorch version 2.6.0 available.
W0324 09:22:12.772827 4124963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:22:13.640979 4124963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:22:13.644765 4112990 quantize_finetune_llama.py:209] layer 23 gpu 3
I0324 09:22:13.818262 4124963 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:22:14.907497 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 23 in 0.821591854095459s
I0324 09:22:18.225842 4125106 config.py:54] PyTorch version 2.6.0 available.
W0324 09:22:18.518066 4125106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:22:19.420531 4125106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:22:19.424417 4112990 quantize_finetune_llama.py:209] layer 24 gpu 0
I0324 09:22:19.590450 4125106 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.004286083392798901 tr(WHW.T) 326.5905456542969
bpp_loss 4.6139463289873675
20_q proxy err 0.0014374243328347802 tr(WHW.T) 20688.703125
bpp_loss 3.6762818826246075
20_k proxy err 0.0006086843786761165 tr(WHW.T) 15368.4912109375
bpp_loss 4.718506090575829
20_o proxy err 0.01019696518778801 tr(WHW.T) 1189.6593017578125
bpp_loss 3.3454968953155912
20_up proxy err 0.017568321898579597 tr(WHW.T) 7535.79443359375
bpp_loss 2.937185443405594
20_gate proxy err 0.004790920298546553 tr(WHW.T) 30548.365234375
bpp_loss 3.2124738405857767
20_down proxy err 0.011701682582497597 tr(WHW.T) 6237.4736328125
bpp_loss 3.3226189598707214
21_v proxy err 0.004150443244725466 tr(WHW.T) 359.03216552734375
bpp_loss 4.616263161180541
21_q proxy err 0.0011731567792594433 tr(WHW.T) 25790.224609375
bpp_loss 3.652772589644883
21_k proxy err 0.0005665764911100268 tr(WHW.T) 16759.76171875
bpp_loss 4.721556807053275
21_o proxy err 0.007713187951594591 tr(WHW.T) 1250.4415283203125
bpp_loss 3.381193080509547
21_up proxy err 0.01686062291264534 tr(WHW.T) 7708.326171875
bpp_loss 2.940316306826259
21_gate proxy err 0.004578255582600832 tr(WHW.T) 31447.8125
bpp_loss 3.2225789072524225
21_down proxy err 0.011403551325201988 tr(WHW.T) 6287.7109375
bpp_loss 3.3231912375693873
I0324 09:24:42.467116 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 24 in 1.0264205932617188s
22_v proxy err 0.004734942689538002 tr(WHW.T) 341.8212890625
bpp_loss 4.611751141957939
22_q proxy err 0.0013763871975243092 tr(WHW.T) 20274.177734375
bpp_loss 3.6419748917687684
22_k proxy err 0.0006034031976014376 tr(WHW.T) 14697.5322265625
bpp_loss 4.725718873669393
22_o proxy err 0.011502358131110668 tr(WHW.T) 1205.021240234375
bpp_loss 3.3340697591775097
22_up proxy err 0.017638443037867546 tr(WHW.T) 7482.60498046875
bpp_loss 2.9402946211131558
22_gate proxy err 0.004943364299833775 tr(WHW.T) 29415.544921875
bpp_loss 3.2222420855957483
22_down proxy err 0.01132868230342865 tr(WHW.T) 6465.3056640625
bpp_loss 3.3228177862474695
I0324 09:24:46.141387 4126930 config.py:54] PyTorch version 2.6.0 available.
W0324 09:24:46.473650 4126930 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:24:47.435101 4126930 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:24:47.439199 4112990 quantize_finetune_llama.py:209] layer 25 gpu 1
I0324 09:24:47.680788 4126930 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:24:48.980838 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 25 in 1.0672695636749268s
I0324 09:24:52.691585 4127068 config.py:54] PyTorch version 2.6.0 available.
23_v proxy err 0.004588174168020487 tr(WHW.T) 393.1842041015625
bpp_loss 4.611239361343905
23_q proxy err 0.0013550735311582685 tr(WHW.T) 22563.107421875
bpp_loss 3.6168214941280894
23_k proxy err 0.000640307494904846 tr(WHW.T) 14831.095703125
bpp_loss 4.672389758517966
23_o proxy err 0.009389563463628292 tr(WHW.T) 1727.0145263671875
bpp_loss 3.334690672112629
23_up proxy err 0.017963845282793045 tr(WHW.T) 7354.04541015625
bpp_loss 2.942782179785094
23_gate proxy err 0.005340223666280508 tr(WHW.T) 27172.716796875
bpp_loss 3.2247053386776576
23_down proxy err 0.011529950425028801 tr(WHW.T) 6602.26123046875
bpp_loss 3.322366888950845
W0324 09:24:52.968518 4127068 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:24:53.865266 4127068 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:24:53.868983 4112990 quantize_finetune_llama.py:209] layer 26 gpu 2
I0324 09:24:54.029965 4127068 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:24:55.118964 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 26 in 0.8047041893005371s
I0324 09:24:58.486258 4127206 config.py:54] PyTorch version 2.6.0 available.
W0324 09:24:58.782686 4127206 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:24:59.674448 4127206 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:24:59.678251 4112990 quantize_finetune_llama.py:209] layer 27 gpu 3
I0324 09:24:59.848171 4127206 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:25:00.886395 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 27 in 0.7710249423980713s
I0324 09:25:04.211273 4127346 config.py:54] PyTorch version 2.6.0 available.
W0324 09:25:04.502196 4127346 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:25:05.409725 4127346 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:25:05.413548 4112990 quantize_finetune_llama.py:209] layer 28 gpu 0
I0324 09:25:05.595182 4127346 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.004693080671131611 tr(WHW.T) 461.59027099609375
bpp_loss 4.6126309561077505
24_q proxy err 0.0013216128572821617 tr(WHW.T) 22391.7734375
bpp_loss 3.604205089272
24_k proxy err 0.0006233188323676586 tr(WHW.T) 14159.55078125
bpp_loss 4.6396361268125474
24_o proxy err 0.010018512606620789 tr(WHW.T) 1570.388427734375
bpp_loss 3.3538854180951603
24_up proxy err 0.018454233184456825 tr(WHW.T) 7245.40576171875
bpp_loss 2.9451162213060473
24_gate proxy err 0.0056942361406981945 tr(WHW.T) 25757.33203125
bpp_loss 3.2292767437174916
24_down proxy err 0.011773747391998768 tr(WHW.T) 6676.57958984375
bpp_loss 3.321344862342812
25_v proxy err 0.003994638565927744 tr(WHW.T) 552.045654296875
bpp_loss 4.613362508942373
25_q proxy err 0.0011681591859087348 tr(WHW.T) 26069.1015625
bpp_loss 3.5730845875805244
25_k proxy err 0.0006194687448441982 tr(WHW.T) 14392.994140625
bpp_loss 4.633977953460999
25_o proxy err 0.008185669779777527 tr(WHW.T) 1971.1920166015625
bpp_loss 3.3590368434088305
25_up proxy err 0.01828203909099102 tr(WHW.T) 7315.31396484375
bpp_loss 2.9523532503018424
25_gate proxy err 0.005598683375865221 tr(WHW.T) 26185.79296875
bpp_loss 3.238456179920052
25_down proxy err 0.012358546257019043 tr(WHW.T) 6549.46630859375
bpp_loss 3.321286688142988
I0324 09:27:28.956209 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 28 in 0.9183957576751709s
I0324 09:27:32.886945 4129182 config.py:54] PyTorch version 2.6.0 available.
W0324 09:27:33.243976 4129182 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.005714896600693464 tr(WHW.T) 428.18212890625
bpp_loss 4.6094554965384305
26_q proxy err 0.0013436928857117891 tr(WHW.T) 21359.736328125
bpp_loss 3.603266100632027
26_k proxy err 0.000579496962018311 tr(WHW.T) 15400.359375
bpp_loss 4.6760067217983305
26_o proxy err 0.005928017199039459 tr(WHW.T) 2368.6396484375
bpp_loss 3.386572574323509
26_up proxy err 0.01767825148999691 tr(WHW.T) 7577.68359375
bpp_loss 2.9590851397120526
26_gate proxy err 0.0051050083711743355 tr(WHW.T) 28778.099609375
bpp_loss 3.2468486075688685
26_down proxy err 0.012517820112407207 tr(WHW.T) 6551.21533203125
bpp_loss 3.321933003974014
W0324 09:27:34.262208 4129182 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:27:34.266382 4112990 quantize_finetune_llama.py:209] layer 29 gpu 1
I0324 09:27:34.456246 4129182 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:27:35.599019 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 29 in 0.8487765789031982s
27_v proxy err 0.004185322672128677 tr(WHW.T) 670.343017578125
bpp_loss 4.613067461061291
27_q proxy err 0.0014249753439798951 tr(WHW.T) 21263.849609375
bpp_loss 3.563773865636904
27_k proxy err 0.0006536325672641397 tr(WHW.T) 13986.966796875
bpp_loss 4.634583090082742
27_o proxy err 0.00686268974095583 tr(WHW.T) 2138.783203125
bpp_loss 3.3821470437105745
27_up proxy err 0.016156872734427452 tr(WHW.T) 8405.8671875
bpp_loss 2.967090095459883
27_gate proxy err 0.004546093754470348 tr(WHW.T) 32683.65234375
bpp_loss 3.2551359260188684
27_down proxy err 0.011632152833044529 tr(WHW.T) 6474.22314453125
bpp_loss 3.342841616133228
I0324 09:27:39.096570 4129320 config.py:54] PyTorch version 2.6.0 available.
W0324 09:27:39.379307 4129320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:27:40.258141 4129320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:27:40.261934 4112990 quantize_finetune_llama.py:209] layer 30 gpu 2
I0324 09:27:40.417946 4129320 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:27:41.422686 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 30 in 0.7372384071350098s
I0324 09:27:44.689368 4129462 config.py:54] PyTorch version 2.6.0 available.
W0324 09:27:44.978976 4129462 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:27:45.877135 4129462 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:27:45.880928 4112990 quantize_finetune_llama.py:209] layer 31 gpu 3
I0324 09:27:46.137827 4129462 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 09:27:47.173046 4112990 quantize_finetune_llama.py:240] computed original embedding for layer 31 in 0.8868036270141602s
I0324 09:27:50.496131 4129594 config.py:54] PyTorch version 2.6.0 available.
W0324 09:27:50.829320 4129594 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 09:27:51.879772 4129594 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 09:27:52.057801 4129594 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.005080074537545443 tr(WHW.T) 593.5634155273438
bpp_loss 4.61105542560108
28_q proxy err 0.0013080381322652102 tr(WHW.T) 23121.744140625
bpp_loss 3.562478054256644
28_k proxy err 0.0005621538148261607 tr(WHW.T) 14971.8525390625
bpp_loss 4.619892900343984
28_o proxy err 0.0061079659499228 tr(WHW.T) 2489.129638671875
bpp_loss 3.406520650431048
28_up proxy err 0.013038243167102337 tr(WHW.T) 10173.3935546875
bpp_loss 2.98712453997827
28_gate proxy err 0.00403031799942255 tr(WHW.T) 35797.04296875
bpp_loss 3.25035115717245
28_down proxy err 0.010305916890501976 tr(WHW.T) 7138.55908203125
bpp_loss 3.3593296425616637
29_v proxy err 0.003807767992839217 tr(WHW.T) 841.8088989257812
bpp_loss 4.614414488547482
29_q proxy err 0.001595327048562467 tr(WHW.T) 20611.560546875
bpp_loss 3.506326856848318
29_k proxy err 0.0005474381614476442 tr(WHW.T) 16341.275390625
bpp_loss 4.628448976553045
29_o proxy err 0.003935524728149176 tr(WHW.T) 3078.978271484375
bpp_loss 3.465575348061975
29_up proxy err 0.010169795714318752 tr(WHW.T) 12791.73828125
bpp_loss 3.009146276595337
29_gate proxy err 0.0036634195130318403 tr(WHW.T) 38241.23046875
bpp_loss 3.247032259857016
29_down proxy err 0.008478278294205666 tr(WHW.T) 7396.3740234375
bpp_loss 3.4031320635362396
30_v proxy err 0.005236038006842136 tr(WHW.T) 850.650634765625
bpp_loss 4.611493200180121
30_q proxy err 0.0011665932834148407 tr(WHW.T) 24012.763671875
bpp_loss 3.4998102873796597
30_k proxy err 0.000460751325590536 tr(WHW.T) 14011.7353515625
bpp_loss 4.620804341160692
30_o proxy err 0.0034212262835353613 tr(WHW.T) 4841.84814453125
bpp_loss 3.419783953402657
30_up proxy err 0.006001962348818779 tr(WHW.T) 21630.490234375
bpp_loss 3.02615288205977
30_gate proxy err 0.002705490682274103 tr(WHW.T) 51822.3203125
bpp_loss 3.286111161778016
30_down proxy err 0.004320601932704449 tr(WHW.T) 8734.9560546875
bpp_loss 3.4787266025086865
31_v proxy err 0.0018008950864896178 tr(WHW.T) 1798.8880615234375
bpp_loss 4.621649371343665
31_q proxy err 0.0006723148399032652 tr(WHW.T) 46129.9609375
bpp_loss 3.540387631917838
31_k proxy err 0.00034442139440216124 tr(WHW.T) 20445.2890625
bpp_loss 4.638068973901682
31_o proxy err 0.0022995974868535995 tr(WHW.T) 2186.948974609375
bpp_loss 3.565979174221866
31_up proxy err 0.0018403345020487905 tr(WHW.T) 68910.7734375
bpp_loss 3.1672111625916193
31_gate proxy err 0.0009481681045144796 tr(WHW.T) 144280.90625
bpp_loss 3.459896801904376
31_down proxy err 0.0010523179080337286 tr(WHW.T) 9880.068359375
bpp_loss 3.5815518696659376
I0324 09:30:40.912294 4131730 config.py:54] PyTorch version 2.6.0 available.
W0324 09:30:41.244580 4131730 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 09:30:41.489246 4131730 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  4.36it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  5.24it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  5.76it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  6.03it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  6.26it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  6.31it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  6.57it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  6.12it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  5.70it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  6.08it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  6.38it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  6.29it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  6.39it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  6.35it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  6.47it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  6.35it/s]
I0324 09:30:45.201826 4131730 hfize_llama.py:153] loaded layer 0
I0324 09:30:45.858523 4131730 hfize_llama.py:153] loaded layer 1
I0324 09:30:46.445223 4131730 hfize_llama.py:153] loaded layer 2
I0324 09:30:47.012135 4131730 hfize_llama.py:153] loaded layer 3
I0324 09:30:47.611566 4131730 hfize_llama.py:153] loaded layer 4
I0324 09:30:48.190021 4131730 hfize_llama.py:153] loaded layer 5
I0324 09:30:48.747672 4131730 hfize_llama.py:153] loaded layer 6
I0324 09:30:49.314045 4131730 hfize_llama.py:153] loaded layer 7
I0324 09:30:49.857954 4131730 hfize_llama.py:153] loaded layer 8
I0324 09:30:50.415907 4131730 hfize_llama.py:153] loaded layer 9
I0324 09:30:50.957102 4131730 hfize_llama.py:153] loaded layer 10
I0324 09:30:51.492219 4131730 hfize_llama.py:153] loaded layer 11
I0324 09:30:52.051105 4131730 hfize_llama.py:153] loaded layer 12
I0324 09:30:52.581296 4131730 hfize_llama.py:153] loaded layer 13
I0324 09:30:53.107778 4131730 hfize_llama.py:153] loaded layer 14
I0324 09:30:53.647747 4131730 hfize_llama.py:153] loaded layer 15
I0324 09:30:54.224846 4131730 hfize_llama.py:153] loaded layer 16
I0324 09:30:54.740291 4131730 hfize_llama.py:153] loaded layer 17
I0324 09:30:55.263651 4131730 hfize_llama.py:153] loaded layer 18
I0324 09:30:55.882498 4131730 hfize_llama.py:153] loaded layer 19
I0324 09:30:56.603846 4131730 hfize_llama.py:153] loaded layer 20
I0324 09:30:57.240848 4131730 hfize_llama.py:153] loaded layer 21
I0324 09:30:57.845591 4131730 hfize_llama.py:153] loaded layer 22
I0324 09:30:58.467952 4131730 hfize_llama.py:153] loaded layer 23
I0324 09:30:59.141001 4131730 hfize_llama.py:153] loaded layer 24
I0324 09:30:59.771243 4131730 hfize_llama.py:153] loaded layer 25
I0324 09:31:00.387164 4131730 hfize_llama.py:153] loaded layer 26
I0324 09:31:01.006596 4131730 hfize_llama.py:153] loaded layer 27
I0324 09:31:01.627907 4131730 hfize_llama.py:153] loaded layer 28
I0324 09:31:02.242861 4131730 hfize_llama.py:153] loaded layer 29
I0324 09:31:02.840609 4131730 hfize_llama.py:153] loaded layer 30
I0324 09:31:03.452227 4131730 hfize_llama.py:153] loaded layer 31
I0324 09:31:03.452360 4131730 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:07,  1.33s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.11s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.07s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.07s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.02s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:00,  1.00it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.17it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.03it/s]
I0324 09:31:59.867326 4131730 hfize_llama.py:167] successfully loaded hfized model
W0324 09:32:04.236372 4133024 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 09:32:04.743268 4133024 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:07,  1.22s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.14s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.15s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.15s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.12s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:01,  1.08s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.07it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.05s/it]
I0324 09:32:12.528084 4133024 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.6639454364776611:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.6639454364776611:   1%|          | 1/141 [00:01<04:15,  1.83s/it]avg_loss = 1.9594838619232178:   1%|          | 1/141 [00:03<04:15,  1.83s/it]avg_loss = 1.9594838619232178:   1%|▏         | 2/141 [00:03<03:42,  1.60s/it]avg_loss = 2.0908639430999756:   1%|▏         | 2/141 [00:04<03:42,  1.60s/it]avg_loss = 2.0908639430999756:   2%|▏         | 3/141 [00:04<03:31,  1.53s/it]avg_loss = 2.0401860177516937:   2%|▏         | 3/141 [00:06<03:31,  1.53s/it]avg_loss = 2.0401860177516937:   3%|▎         | 4/141 [00:06<03:25,  1.50s/it]avg_loss = 1.9949344396591187:   3%|▎         | 4/141 [00:07<03:25,  1.50s/it]avg_loss = 1.9949344396591187:   4%|▎         | 5/141 [00:07<03:22,  1.49s/it]avg_loss = 1.8971840341885884:   4%|▎         | 5/141 [00:09<03:22,  1.49s/it]avg_loss = 1.8971840341885884:   4%|▍         | 6/141 [00:09<03:19,  1.48s/it]avg_loss = 1.836288435118539:   4%|▍         | 6/141 [00:10<03:19,  1.48s/it] avg_loss = 1.836288435118539:   5%|▍         | 7/141 [00:10<03:17,  1.48s/it]avg_loss = 1.8289294838905334:   5%|▍         | 7/141 [00:12<03:17,  1.48s/it]avg_loss = 1.8289294838905334:   6%|▌         | 8/141 [00:12<03:16,  1.48s/it]avg_loss = 1.8616641097598605:   6%|▌         | 8/141 [00:13<03:16,  1.48s/it]avg_loss = 1.8616641097598605:   6%|▋         | 9/141 [00:13<03:15,  1.48s/it]avg_loss = 1.862165892124176:   6%|▋         | 9/141 [00:15<03:15,  1.48s/it] avg_loss = 1.862165892124176:   7%|▋         | 10/141 [00:15<03:14,  1.48s/it]avg_loss = 1.856585361740806:   7%|▋         | 10/141 [00:16<03:14,  1.48s/it]avg_loss = 1.856585361740806:   8%|▊         | 11/141 [00:16<03:13,  1.49s/it]avg_loss = 1.8778514762719472:   8%|▊         | 11/141 [00:18<03:13,  1.49s/it]avg_loss = 1.8778514762719472:   9%|▊         | 12/141 [00:18<03:12,  1.49s/it]avg_loss = 1.8892207970986:   9%|▊         | 12/141 [00:19<03:12,  1.49s/it]   avg_loss = 1.8892207970986:   9%|▉         | 13/141 [00:19<03:11,  1.49s/it]avg_loss = 1.9057511687278748:   9%|▉         | 13/141 [00:21<03:11,  1.49s/it]avg_loss = 1.9057511687278748:  10%|▉         | 14/141 [00:21<03:09,  1.49s/it]avg_loss = 1.9148563305536905:  10%|▉         | 14/141 [00:22<03:09,  1.49s/it]avg_loss = 1.9148563305536905:  11%|█         | 15/141 [00:22<03:08,  1.50s/it]avg_loss = 1.9388613924384117:  11%|█         | 15/141 [00:24<03:08,  1.50s/it]avg_loss = 1.9388613924384117:  11%|█▏        | 16/141 [00:24<03:07,  1.50s/it]avg_loss = 1.9422021964017082:  11%|█▏        | 16/141 [00:25<03:07,  1.50s/it]avg_loss = 1.9422021964017082:  12%|█▏        | 17/141 [00:25<03:06,  1.50s/it]avg_loss = 1.944625026649899:  12%|█▏        | 17/141 [00:27<03:06,  1.50s/it] avg_loss = 1.944625026649899:  13%|█▎        | 18/141 [00:27<03:05,  1.51s/it]avg_loss = 1.93195599003842:  13%|█▎        | 18/141 [00:28<03:05,  1.51s/it] avg_loss = 1.93195599003842:  13%|█▎        | 19/141 [00:28<03:04,  1.51s/it]avg_loss = 1.930102813243866:  13%|█▎        | 19/141 [00:30<03:04,  1.51s/it]avg_loss = 1.930102813243866:  14%|█▍        | 20/141 [00:30<03:03,  1.51s/it]avg_loss = 1.934149356115432:  14%|█▍        | 20/141 [00:31<03:03,  1.51s/it]avg_loss = 1.934149356115432:  15%|█▍        | 21/141 [00:31<03:02,  1.52s/it]avg_loss = 1.9363313859159297:  15%|█▍        | 21/141 [00:33<03:02,  1.52s/it]avg_loss = 1.9363313859159297:  16%|█▌        | 22/141 [00:33<03:00,  1.52s/it]avg_loss = 1.9375366905461187:  16%|█▌        | 22/141 [00:34<03:00,  1.52s/it]avg_loss = 1.9375366905461187:  16%|█▋        | 23/141 [00:34<02:59,  1.52s/it]avg_loss = 1.9420745919148128:  16%|█▋        | 23/141 [00:36<02:59,  1.52s/it]avg_loss = 1.9420745919148128:  17%|█▋        | 24/141 [00:36<02:58,  1.53s/it]avg_loss = 1.9479686117172241:  17%|█▋        | 24/141 [00:37<02:58,  1.53s/it]avg_loss = 1.9479686117172241:  18%|█▊        | 25/141 [00:37<02:57,  1.53s/it]avg_loss = 1.9592611560454736:  18%|█▊        | 25/141 [00:39<02:57,  1.53s/it]avg_loss = 1.9592611560454736:  18%|█▊        | 26/141 [00:39<02:56,  1.53s/it]avg_loss = 1.971562760847586:  18%|█▊        | 26/141 [00:40<02:56,  1.53s/it] avg_loss = 1.971562760847586:  19%|█▉        | 27/141 [00:40<02:54,  1.54s/it]avg_loss = 1.9774701978479112:  19%|█▉        | 27/141 [00:42<02:54,  1.54s/it]avg_loss = 1.9774701978479112:  20%|█▉        | 28/141 [00:42<02:53,  1.54s/it]avg_loss = 1.9741247029140079:  20%|█▉        | 28/141 [00:43<02:53,  1.54s/it]avg_loss = 1.9741247029140079:  21%|██        | 29/141 [00:43<02:52,  1.54s/it]avg_loss = 1.9650524814923604:  21%|██        | 29/141 [00:45<02:52,  1.54s/it]avg_loss = 1.9650524814923604:  21%|██▏       | 30/141 [00:45<02:51,  1.54s/it]avg_loss = 1.952066913727791:  21%|██▏       | 30/141 [00:47<02:51,  1.54s/it] avg_loss = 1.952066913727791:  22%|██▏       | 31/141 [00:47<02:49,  1.54s/it]avg_loss = 1.9409152083098888:  22%|██▏       | 31/141 [00:48<02:49,  1.54s/it]avg_loss = 1.9409152083098888:  23%|██▎       | 32/141 [00:48<02:48,  1.54s/it]avg_loss = 1.9390104575590654:  23%|██▎       | 32/141 [00:50<02:48,  1.54s/it]avg_loss = 1.9390104575590654:  23%|██▎       | 33/141 [00:50<02:47,  1.55s/it]avg_loss = 1.9367765889448278:  23%|██▎       | 33/141 [00:51<02:47,  1.55s/it]avg_loss = 1.9367765889448278:  24%|██▍       | 34/141 [00:51<02:45,  1.55s/it]avg_loss = 1.9389674254826137:  24%|██▍       | 34/141 [00:53<02:45,  1.55s/it]avg_loss = 1.9389674254826137:  25%|██▍       | 35/141 [00:53<02:44,  1.55s/it]avg_loss = 1.9216995073689356:  25%|██▍       | 35/141 [00:54<02:44,  1.55s/it]avg_loss = 1.9216995073689356:  26%|██▌       | 36/141 [00:54<02:42,  1.55s/it]avg_loss = 1.9065168967118133:  26%|██▌       | 36/141 [00:56<02:42,  1.55s/it]avg_loss = 1.9065168967118133:  26%|██▌       | 37/141 [00:56<02:41,  1.55s/it]avg_loss = 1.8918269213877226:  26%|██▌       | 37/141 [00:57<02:41,  1.55s/it]avg_loss = 1.8918269213877226:  27%|██▋       | 38/141 [00:57<02:40,  1.55s/it]avg_loss = 1.8773823884817271:  27%|██▋       | 38/141 [00:59<02:40,  1.55s/it]avg_loss = 1.8773823884817271:  28%|██▊       | 39/141 [00:59<02:38,  1.56s/it]avg_loss = 1.8689266204833985:  28%|██▊       | 39/141 [01:00<02:38,  1.56s/it]avg_loss = 1.8689266204833985:  28%|██▊       | 40/141 [01:00<02:37,  1.56s/it]avg_loss = 1.8742905535349033:  28%|██▊       | 40/141 [01:02<02:37,  1.56s/it]avg_loss = 1.8742905535349033:  29%|██▉       | 41/141 [01:02<02:36,  1.56s/it]avg_loss = 1.8905764364060902:  29%|██▉       | 41/141 [01:04<02:36,  1.56s/it]avg_loss = 1.8905764364060902:  30%|██▉       | 42/141 [01:04<02:34,  1.56s/it]avg_loss = 1.9066382452499036:  30%|██▉       | 42/141 [01:05<02:34,  1.56s/it]avg_loss = 1.9066382452499036:  30%|███       | 43/141 [01:05<02:33,  1.56s/it]avg_loss = 1.9106282646005803:  30%|███       | 43/141 [01:07<02:33,  1.56s/it]avg_loss = 1.9106282646005803:  31%|███       | 44/141 [01:07<02:31,  1.56s/it]avg_loss = 1.9149593194325765:  31%|███       | 44/141 [01:08<02:31,  1.56s/it]avg_loss = 1.9149593194325765:  32%|███▏      | 45/141 [01:08<02:30,  1.57s/it]avg_loss = 1.919645413108494:  32%|███▏      | 45/141 [01:10<02:30,  1.57s/it] avg_loss = 1.919645413108494:  33%|███▎      | 46/141 [01:10<02:28,  1.57s/it]avg_loss = 1.925746760469802:  33%|███▎      | 46/141 [01:11<02:28,  1.57s/it]avg_loss = 1.925746760469802:  33%|███▎      | 47/141 [01:11<02:27,  1.57s/it]avg_loss = 1.9286450544993083:  33%|███▎      | 47/141 [01:13<02:27,  1.57s/it]avg_loss = 1.9286450544993083:  34%|███▍      | 48/141 [01:13<02:25,  1.57s/it]avg_loss = 1.9280930660208877:  34%|███▍      | 48/141 [01:15<02:25,  1.57s/it]avg_loss = 1.9280930660208877:  35%|███▍      | 49/141 [01:15<02:24,  1.57s/it]avg_loss = 1.9276507306098938:  35%|███▍      | 49/141 [01:16<02:24,  1.57s/it]avg_loss = 1.9276507306098938:  35%|███▌      | 50/141 [01:16<02:22,  1.57s/it]avg_loss = 1.9219103677600038:  35%|███▌      | 50/141 [01:18<02:22,  1.57s/it]avg_loss = 1.9219103677600038:  36%|███▌      | 51/141 [01:18<02:21,  1.57s/it]avg_loss = 1.91798007946748:  36%|███▌      | 51/141 [01:19<02:21,  1.57s/it]  avg_loss = 1.91798007946748:  37%|███▋      | 52/141 [01:19<02:19,  1.57s/it]avg_loss = 1.9113608396278237:  37%|███▋      | 52/141 [01:21<02:19,  1.57s/it]avg_loss = 1.9113608396278237:  38%|███▊      | 53/141 [01:21<02:18,  1.57s/it]avg_loss = 1.9081582095887926:  38%|███▊      | 53/141 [01:22<02:18,  1.57s/it]avg_loss = 1.9081582095887926:  38%|███▊      | 54/141 [01:22<02:16,  1.57s/it]avg_loss = 1.9006131692366166:  38%|███▊      | 54/141 [01:24<02:16,  1.57s/it]avg_loss = 1.9006131692366166:  39%|███▉      | 55/141 [01:24<02:15,  1.57s/it]avg_loss = 1.8926970256226403:  39%|███▉      | 55/141 [01:26<02:15,  1.57s/it]avg_loss = 1.8926970256226403:  40%|███▉      | 56/141 [01:26<02:13,  1.58s/it]avg_loss = 1.8881130113936306:  40%|███▉      | 56/141 [01:27<02:13,  1.58s/it]avg_loss = 1.8881130113936306:  40%|████      | 57/141 [01:27<02:12,  1.58s/it]avg_loss = 1.8852541323365837:  40%|████      | 57/141 [01:29<02:12,  1.58s/it]avg_loss = 1.8852541323365837:  41%|████      | 58/141 [01:29<02:10,  1.58s/it]avg_loss = 1.8874380467301708:  41%|████      | 58/141 [01:30<02:10,  1.58s/it]avg_loss = 1.8874380467301708:  42%|████▏     | 59/141 [01:30<02:09,  1.58s/it]avg_loss = 1.8927298347155253:  42%|████▏     | 59/141 [01:32<02:09,  1.58s/it]avg_loss = 1.8927298347155253:  43%|████▎     | 60/141 [01:32<02:07,  1.58s/it]avg_loss = 1.8984377853205947:  43%|████▎     | 60/141 [01:34<02:07,  1.58s/it]avg_loss = 1.8984377853205947:  43%|████▎     | 61/141 [01:34<02:06,  1.58s/it]avg_loss = 1.9056581028046147:  43%|████▎     | 61/141 [01:35<02:06,  1.58s/it]avg_loss = 1.9056581028046147:  44%|████▍     | 62/141 [01:35<02:04,  1.58s/it]avg_loss = 1.8969820397240775:  44%|████▍     | 62/141 [01:37<02:04,  1.58s/it]avg_loss = 1.8969820397240775:  45%|████▍     | 63/141 [01:37<02:03,  1.58s/it]avg_loss = 1.894639516249299:  45%|████▍     | 63/141 [01:38<02:03,  1.58s/it] avg_loss = 1.894639516249299:  45%|████▌     | 64/141 [01:38<02:01,  1.58s/it]avg_loss = 1.892082689358638:  45%|████▌     | 64/141 [01:40<02:01,  1.58s/it]avg_loss = 1.892082689358638:  46%|████▌     | 65/141 [01:40<02:00,  1.58s/it]avg_loss = 1.8859288728598393:  46%|████▌     | 65/141 [01:41<02:00,  1.58s/it]avg_loss = 1.8859288728598393:  47%|████▋     | 66/141 [01:41<01:58,  1.58s/it]avg_loss = 1.8831725316261179:  47%|████▋     | 66/141 [01:43<01:58,  1.58s/it]avg_loss = 1.8831725316261179:  48%|████▊     | 67/141 [01:43<01:57,  1.58s/it]avg_loss = 1.8801577143809374:  48%|████▊     | 67/141 [01:45<01:57,  1.58s/it]avg_loss = 1.8801577143809374:  48%|████▊     | 68/141 [01:45<01:55,  1.59s/it]avg_loss = 1.8774127649224324:  48%|████▊     | 68/141 [01:46<01:55,  1.59s/it]avg_loss = 1.8774127649224324:  49%|████▉     | 69/141 [01:46<01:54,  1.58s/it]avg_loss = 1.878232456956591:  49%|████▉     | 69/141 [01:48<01:54,  1.58s/it] avg_loss = 1.878232456956591:  50%|████▉     | 70/141 [01:48<01:52,  1.58s/it]avg_loss = 1.8818724105055904:  50%|████▉     | 70/141 [01:49<01:52,  1.58s/it]avg_loss = 1.8818724105055904:  50%|█████     | 71/141 [01:49<01:51,  1.59s/it]avg_loss = 1.8843828058905072:  50%|█████     | 71/141 [01:51<01:51,  1.59s/it]avg_loss = 1.8843828058905072:  51%|█████     | 72/141 [01:51<01:49,  1.59s/it]avg_loss = 1.8827928631273034:  51%|█████     | 72/141 [01:53<01:49,  1.59s/it]avg_loss = 1.8827928631273034:  52%|█████▏    | 73/141 [01:53<01:47,  1.59s/it]avg_loss = 1.884252625542718:  52%|█████▏    | 73/141 [01:54<01:47,  1.59s/it] avg_loss = 1.884252625542718:  52%|█████▏    | 74/141 [01:54<01:46,  1.59s/it]avg_loss = 1.8842921177546184:  52%|█████▏    | 74/141 [01:56<01:46,  1.59s/it]avg_loss = 1.8842921177546184:  53%|█████▎    | 75/141 [01:56<01:44,  1.59s/it]avg_loss = 1.8831042082686174:  53%|█████▎    | 75/141 [01:57<01:44,  1.59s/it]avg_loss = 1.8831042082686174:  54%|█████▍    | 76/141 [01:57<01:43,  1.59s/it]avg_loss = 1.8841925255663983:  54%|█████▍    | 76/141 [01:59<01:43,  1.59s/it]avg_loss = 1.8841925255663983:  55%|█████▍    | 77/141 [01:59<01:41,  1.59s/it]avg_loss = 1.8863949164366112:  55%|█████▍    | 77/141 [02:00<01:41,  1.59s/it]avg_loss = 1.8863949164366112:  55%|█████▌    | 78/141 [02:00<01:39,  1.59s/it]avg_loss = 1.8902639497684528:  55%|█████▌    | 78/141 [02:02<01:39,  1.59s/it]avg_loss = 1.8902639497684528:  56%|█████▌    | 79/141 [02:02<01:38,  1.59s/it]avg_loss = 1.8871462047100067:  56%|█████▌    | 79/141 [02:04<01:38,  1.59s/it]avg_loss = 1.8871462047100067:  57%|█████▋    | 80/141 [02:04<01:36,  1.59s/it]avg_loss = 1.8858688760686804:  57%|█████▋    | 80/141 [02:05<01:36,  1.59s/it]avg_loss = 1.8858688760686804:  57%|█████▋    | 81/141 [02:05<01:35,  1.59s/it]avg_loss = 1.8849459639409694:  57%|█████▋    | 81/141 [02:07<01:35,  1.59s/it]avg_loss = 1.8849459639409694:  58%|█████▊    | 82/141 [02:07<01:33,  1.59s/it]avg_loss = 1.8830996407083718:  58%|█████▊    | 82/141 [02:08<01:33,  1.59s/it]avg_loss = 1.8830996407083718:  59%|█████▉    | 83/141 [02:08<01:32,  1.59s/it]avg_loss = 1.880792715719768:  59%|█████▉    | 83/141 [02:10<01:32,  1.59s/it] avg_loss = 1.880792715719768:  60%|█████▉    | 84/141 [02:10<01:30,  1.59s/it]avg_loss = 1.8784716059179867:  60%|█████▉    | 84/141 [02:12<01:30,  1.59s/it]avg_loss = 1.8784716059179867:  60%|██████    | 85/141 [02:12<01:28,  1.59s/it]avg_loss = 1.8800851259120674:  60%|██████    | 85/141 [02:13<01:28,  1.59s/it]avg_loss = 1.8800851259120674:  61%|██████    | 86/141 [02:13<01:27,  1.59s/it]avg_loss = 1.8820790326458283:  61%|██████    | 86/141 [02:15<01:27,  1.59s/it]avg_loss = 1.8820790326458283:  62%|██████▏   | 87/141 [02:15<01:25,  1.59s/it]avg_loss = 1.8829622973095288:  62%|██████▏   | 87/141 [02:16<01:25,  1.59s/it]avg_loss = 1.8829622973095288:  62%|██████▏   | 88/141 [02:16<01:24,  1.59s/it]avg_loss = 1.891697760378377:  62%|██████▏   | 88/141 [02:18<01:24,  1.59s/it] avg_loss = 1.891697760378377:  63%|██████▎   | 89/141 [02:18<01:22,  1.59s/it]avg_loss = 1.8990736299090916:  63%|██████▎   | 89/141 [02:20<01:22,  1.59s/it]avg_loss = 1.8990736299090916:  64%|██████▍   | 90/141 [02:20<01:21,  1.59s/it]avg_loss = 1.90214949125772:  64%|██████▍   | 90/141 [02:21<01:21,  1.59s/it]  avg_loss = 1.90214949125772:  65%|██████▍   | 91/141 [02:21<01:19,  1.59s/it]avg_loss = 1.9072364413219949:  65%|██████▍   | 91/141 [02:23<01:19,  1.59s/it]avg_loss = 1.9072364413219949:  65%|██████▌   | 92/141 [02:23<01:18,  1.59s/it]avg_loss = 1.9122778036261117:  65%|██████▌   | 92/141 [02:24<01:18,  1.59s/it]avg_loss = 1.9122778036261117:  66%|██████▌   | 93/141 [02:24<01:16,  1.59s/it]avg_loss = 1.9131204333711178:  66%|██████▌   | 93/141 [02:26<01:16,  1.59s/it]avg_loss = 1.9131204333711178:  67%|██████▋   | 94/141 [02:26<01:14,  1.59s/it]avg_loss = 1.916912401349921:  67%|██████▋   | 94/141 [02:28<01:14,  1.59s/it] avg_loss = 1.916912401349921:  67%|██████▋   | 95/141 [02:28<01:13,  1.59s/it]avg_loss = 1.9175373998781045:  67%|██████▋   | 95/141 [02:29<01:13,  1.59s/it]avg_loss = 1.9175373998781045:  68%|██████▊   | 96/141 [02:29<01:11,  1.59s/it]avg_loss = 1.9191557144381337:  68%|██████▊   | 96/141 [02:31<01:11,  1.59s/it]avg_loss = 1.9191557144381337:  69%|██████▉   | 97/141 [02:31<01:10,  1.59s/it]avg_loss = 1.9160062597722423:  69%|██████▉   | 97/141 [02:32<01:10,  1.59s/it]avg_loss = 1.9160062597722423:  70%|██████▉   | 98/141 [02:32<01:08,  1.59s/it]avg_loss = 1.9170025057262845:  70%|██████▉   | 98/141 [02:34<01:08,  1.59s/it]avg_loss = 1.9170025057262845:  70%|███████   | 99/141 [02:34<01:06,  1.59s/it]avg_loss = 1.919231504201889:  70%|███████   | 99/141 [02:35<01:06,  1.59s/it] avg_loss = 1.919231504201889:  71%|███████   | 100/141 [02:35<01:05,  1.59s/it]avg_loss = 1.9182622975642138:  71%|███████   | 100/141 [02:37<01:05,  1.59s/it]avg_loss = 1.9182622975642138:  72%|███████▏  | 101/141 [02:37<01:03,  1.59s/it]avg_loss = 1.9187167672549976:  72%|███████▏  | 101/141 [02:39<01:03,  1.59s/it]avg_loss = 1.9187167672549976:  72%|███████▏  | 102/141 [02:39<01:02,  1.59s/it]avg_loss = 1.9176677199243342:  72%|███████▏  | 102/141 [02:40<01:02,  1.59s/it]avg_loss = 1.9176677199243342:  73%|███████▎  | 103/141 [02:40<01:00,  1.60s/it]avg_loss = 1.9206840418852293:  73%|███████▎  | 103/141 [02:42<01:00,  1.60s/it]avg_loss = 1.9206840418852293:  74%|███████▍  | 104/141 [02:42<00:59,  1.60s/it]avg_loss = 1.9198810395740327:  74%|███████▍  | 104/141 [02:43<00:59,  1.60s/it]avg_loss = 1.9198810395740327:  74%|███████▍  | 105/141 [02:43<00:57,  1.60s/it]avg_loss = 1.919228030825561:  74%|███████▍  | 105/141 [02:45<00:57,  1.60s/it] avg_loss = 1.919228030825561:  75%|███████▌  | 106/141 [02:45<00:55,  1.60s/it]avg_loss = 1.91724003252582:  75%|███████▌  | 106/141 [02:47<00:55,  1.60s/it] avg_loss = 1.91724003252582:  76%|███████▌  | 107/141 [02:47<00:54,  1.60s/it]avg_loss = 1.9151384333769481:  76%|███████▌  | 107/141 [02:48<00:54,  1.60s/it]avg_loss = 1.9151384333769481:  77%|███████▋  | 108/141 [02:48<00:52,  1.60s/it]avg_loss = 1.9129107282796036:  77%|███████▋  | 108/141 [02:50<00:52,  1.60s/it]avg_loss = 1.9129107282796036:  77%|███████▋  | 109/141 [02:50<00:51,  1.60s/it]avg_loss = 1.9107602401213213:  77%|███████▋  | 109/141 [02:51<00:51,  1.60s/it]avg_loss = 1.9107602401213213:  78%|███████▊  | 110/141 [02:51<00:49,  1.60s/it]avg_loss = 1.9134168710794535:  78%|███████▊  | 110/141 [02:53<00:49,  1.60s/it]avg_loss = 1.9134168710794535:  79%|███████▊  | 111/141 [02:53<00:47,  1.60s/it]avg_loss = 1.9129963123372622:  79%|███████▊  | 111/141 [02:55<00:47,  1.60s/it]avg_loss = 1.9129963123372622:  79%|███████▉  | 112/141 [02:55<00:46,  1.60s/it]avg_loss = 1.914014758261959:  79%|███████▉  | 112/141 [02:56<00:46,  1.60s/it] avg_loss = 1.914014758261959:  80%|████████  | 113/141 [02:56<00:44,  1.60s/it]avg_loss = 1.915072032234125:  80%|████████  | 113/141 [02:58<00:44,  1.60s/it]avg_loss = 1.915072032234125:  81%|████████  | 114/141 [02:58<00:43,  1.60s/it]avg_loss = 1.9143224653990372:  81%|████████  | 114/141 [02:59<00:43,  1.60s/it]avg_loss = 1.9143224653990372:  82%|████████▏ | 115/141 [02:59<00:41,  1.59s/it]avg_loss = 1.913021796736224:  82%|████████▏ | 115/141 [03:01<00:41,  1.59s/it] avg_loss = 1.913021796736224:  82%|████████▏ | 116/141 [03:01<00:39,  1.59s/it]avg_loss = 1.9150465064578586:  82%|████████▏ | 116/141 [03:03<00:39,  1.59s/it]avg_loss = 1.9150465064578586:  83%|████████▎ | 117/141 [03:03<00:38,  1.59s/it]avg_loss = 1.9145280627881067:  83%|████████▎ | 117/141 [03:04<00:38,  1.59s/it]avg_loss = 1.9145280627881067:  84%|████████▎ | 118/141 [03:04<00:36,  1.59s/it]avg_loss = 1.91301323886679:  84%|████████▎ | 118/141 [03:06<00:36,  1.59s/it]  avg_loss = 1.91301323886679:  84%|████████▍ | 119/141 [03:06<00:35,  1.59s/it]avg_loss = 1.9112410803635915:  84%|████████▍ | 119/141 [03:07<00:35,  1.59s/it]avg_loss = 1.9112410803635915:  85%|████████▌ | 120/141 [03:07<00:33,  1.59s/it]avg_loss = 1.9111365542924108:  85%|████████▌ | 120/141 [03:09<00:33,  1.59s/it]avg_loss = 1.9111365542924108:  86%|████████▌ | 121/141 [03:09<00:31,  1.60s/it]avg_loss = 1.911748716088592:  86%|████████▌ | 121/141 [03:11<00:31,  1.60s/it] avg_loss = 1.911748716088592:  87%|████████▋ | 122/141 [03:11<00:30,  1.60s/it]avg_loss = 1.911439057288131:  87%|████████▋ | 122/141 [03:12<00:30,  1.60s/it]avg_loss = 1.911439057288131:  87%|████████▋ | 123/141 [03:12<00:28,  1.60s/it]avg_loss = 1.9113988405273807:  87%|████████▋ | 123/141 [03:14<00:28,  1.60s/it]avg_loss = 1.9113988405273807:  88%|████████▊ | 124/141 [03:14<00:27,  1.60s/it]avg_loss = 1.9100383520126343:  88%|████████▊ | 124/141 [03:15<00:27,  1.60s/it]avg_loss = 1.9100383520126343:  89%|████████▊ | 125/141 [03:15<00:25,  1.60s/it]avg_loss = 1.9102646150286235:  89%|████████▊ | 125/141 [03:17<00:25,  1.60s/it]avg_loss = 1.9102646150286235:  89%|████████▉ | 126/141 [03:17<00:23,  1.60s/it]avg_loss = 1.9099465974672574:  89%|████████▉ | 126/141 [03:19<00:23,  1.60s/it]avg_loss = 1.9099465974672574:  90%|█████████ | 127/141 [03:19<00:22,  1.60s/it]avg_loss = 1.9087516814470291:  90%|█████████ | 127/141 [03:20<00:22,  1.60s/it]avg_loss = 1.9087516814470291:  91%|█████████ | 128/141 [03:20<00:20,  1.60s/it]avg_loss = 1.9086816514185232:  91%|█████████ | 128/141 [03:22<00:20,  1.60s/it]avg_loss = 1.9086816514185232:  91%|█████████▏| 129/141 [03:22<00:19,  1.60s/it]avg_loss = 1.9096063742270837:  91%|█████████▏| 129/141 [03:23<00:19,  1.60s/it]avg_loss = 1.9096063742270837:  92%|█████████▏| 130/141 [03:23<00:17,  1.60s/it]avg_loss = 1.9103407714203113:  92%|█████████▏| 130/141 [03:25<00:17,  1.60s/it]avg_loss = 1.9103407714203113:  93%|█████████▎| 131/141 [03:25<00:15,  1.60s/it]avg_loss = 1.9108776251475017:  93%|█████████▎| 131/141 [03:27<00:15,  1.60s/it]avg_loss = 1.9108776251475017:  94%|█████████▎| 132/141 [03:27<00:14,  1.60s/it]avg_loss = 1.9080239265484917:  94%|█████████▎| 132/141 [03:28<00:14,  1.60s/it]avg_loss = 1.9080239265484917:  94%|█████████▍| 133/141 [03:28<00:12,  1.60s/it]avg_loss = 1.9034034138295188:  94%|█████████▍| 133/141 [03:30<00:12,  1.60s/it]avg_loss = 1.9034034138295188:  95%|█████████▌| 134/141 [03:30<00:11,  1.60s/it]avg_loss = 1.9058446954797816:  95%|█████████▌| 134/141 [03:31<00:11,  1.60s/it]avg_loss = 1.9058446954797816:  96%|█████████▌| 135/141 [03:31<00:09,  1.60s/it]avg_loss = 1.9093479987453013:  96%|█████████▌| 135/141 [03:33<00:09,  1.60s/it]avg_loss = 1.9093479987453013:  96%|█████████▋| 136/141 [03:33<00:07,  1.60s/it]avg_loss = 1.9106127606691234:  96%|█████████▋| 136/141 [03:35<00:07,  1.60s/it]avg_loss = 1.9106127606691234:  97%|█████████▋| 137/141 [03:35<00:06,  1.60s/it]avg_loss = 1.9094969284707222:  97%|█████████▋| 137/141 [03:36<00:06,  1.60s/it]avg_loss = 1.9094969284707222:  98%|█████████▊| 138/141 [03:36<00:04,  1.59s/it]avg_loss = 1.9098622507328609:  98%|█████████▊| 138/141 [03:38<00:04,  1.59s/it]avg_loss = 1.9098622507328609:  99%|█████████▊| 139/141 [03:38<00:03,  1.59s/it]avg_loss = 1.9104599356651306:  99%|█████████▊| 139/141 [03:39<00:03,  1.59s/it]avg_loss = 1.9104599356651306:  99%|█████████▉| 140/141 [03:39<00:01,  1.59s/it]avg_loss = 1.9116335439343823:  99%|█████████▉| 140/141 [03:41<00:01,  1.59s/it]avg_loss = 1.9116335439343823: 100%|██████████| 141/141 [03:41<00:00,  1.60s/it]avg_loss = 1.9116335439343823: 100%|██████████| 141/141 [03:41<00:00,  1.57s/it]
I0324 09:36:17.866553 4133024 eval_ppl.py:107] wikitext2 perplexity: 6.764129161834717
wikitext2 perplexity: 6.764
