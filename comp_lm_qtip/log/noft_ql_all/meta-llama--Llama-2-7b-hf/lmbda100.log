I0320 16:58:09.928789 1484726 config.py:54] PyTorch version 2.6.0 available.
W0320 16:58:10.210578 1484726 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 16:58:11.209148 1484726 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.43it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.90it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.07it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.17it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.22it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.81it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.92it/s]
I0320 16:58:12.170012 1484726 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:15,  2.05it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:14,  2.07it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.09it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:13,  2.09it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:12,  2.10it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:12,  2.09it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:12,  2.08it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:11,  2.08it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:11,  2.09it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:10,  2.07it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:05<00:10,  2.08it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:09,  2.09it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:06<00:09,  2.09it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:06<00:08,  2.09it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:07<00:08,  2.09it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:07<00:07,  2.08it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:08<00:07,  2.08it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:08<00:06,  2.08it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:09<00:06,  2.07it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:09<00:05,  2.09it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:10<00:05,  2.08it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:10<00:04,  2.09it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:11<00:04,  2.09it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:11<00:03,  2.10it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:11<00:03,  2.08it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:12<00:02,  2.08it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:13<00:01,  2.09it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:13<00:01,  2.10it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:14<00:00,  2.11it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:14<00:00,  2.08it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:15<00:00,  2.12it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:15<00:00,  2.09it/s]
I0320 16:58:32.774100 1484726 quantize_finetune_llama.py:179] loaded compression model
I0320 16:58:46.846662 1484726 quantize_finetune_llama.py:183] loaded dataset and devset
I0320 16:58:51.775694 1484726 quantize_finetune_llama.py:203] layer 0 gpu 0
I0320 16:58:54.202072 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 2.2808995246887207s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0320 16:59:07.087304 1485464 config.py:54] PyTorch version 2.6.0 available.
W0320 16:59:07.368707 1485464 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 16:59:08.261750 1485464 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 16:59:08.265823 1484726 quantize_finetune_llama.py:203] layer 1 gpu 1
I0320 16:59:08.280595 1485464 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 16:59:10.936436 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 2.4995596408843994s
I0320 16:59:14.484758 1485591 config.py:54] PyTorch version 2.6.0 available.
W0320 16:59:14.775067 1485591 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 16:59:15.691373 1485591 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 16:59:15.695445 1484726 quantize_finetune_llama.py:203] layer 2 gpu 2
I0320 16:59:15.710197 1485591 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 16:59:18.174269 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 2.3115322589874268s
I0320 16:59:22.130643 1485733 config.py:54] PyTorch version 2.6.0 available.
W0320 16:59:22.483426 1485733 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 16:59:23.502900 1485733 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 16:59:23.506960 1484726 quantize_finetune_llama.py:203] layer 3 gpu 3
I0320 16:59:23.588304 1485733 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 16:59:26.730317 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 2.8560729026794434s
I0320 16:59:30.904011 1485887 config.py:54] PyTorch version 2.6.0 available.
W0320 16:59:31.278312 1485887 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 16:59:32.506605 1485887 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 16:59:32.510764 1484726 quantize_finetune_llama.py:203] layer 4 gpu 0
I0320 16:59:32.553666 1485887 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.03568205237388611 tr(WHW.T) 4.225186347961426
bpp_loss 2.6133774518966675
0_q proxy err 0.00014226758503355086 tr(WHW.T) 2710.363037109375
bpp_loss 2.6230472326278687
0_k proxy err 0.0001805307256290689 tr(WHW.T) 1698.7349853515625
bpp_loss 2.725191831588745
0_o proxy err 0.007269628811627626 tr(WHW.T) 0.9668058156967163
bpp_loss 2.458583116531372
0_up proxy err 0.011569160968065262 tr(WHW.T) 43.27138900756836
bpp_loss 2.9000545767850654
0_gate proxy err 0.008006798103451729 tr(WHW.T) 63.47430419921875
bpp_loss 2.9120576548021893
0_down proxy err 0.009521611966192722 tr(WHW.T) 0.656814694404602
bpp_loss 2.93598263762718
1_v proxy err 0.047742340713739395 tr(WHW.T) 16.465883255004883
bpp_loss 2.5771641731262207
1_q proxy err 0.00024816655786708 tr(WHW.T) 4778.43994140625
bpp_loss 3.296558976173401
1_k proxy err 0.0002473545027896762 tr(WHW.T) 4995.39208984375
bpp_loss 3.303309917449951
1_o proxy err 0.02876160852611065 tr(WHW.T) 1.1115814447402954
bpp_loss 2.4982287883758545
1_up proxy err 0.014490786008536816 tr(WHW.T) 109.66383361816406
bpp_loss 2.958331529484239
1_gate proxy err 0.007440771907567978 tr(WHW.T) 221.3038787841797
bpp_loss 3.0148485760356105
1_down proxy err 0.0007485494716092944 tr(WHW.T) 2041.4736328125
bpp_loss 2.972688364428143
I0320 17:00:18.885993 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 1.2106268405914307s
I0320 17:00:23.186923 1486455 config.py:54] PyTorch version 2.6.0 available.
W0320 17:00:23.527324 1486455 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:00:24.699598 1486455 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:00:24.724026 1484726 quantize_finetune_llama.py:203] layer 5 gpu 1
I0320 17:00:24.792358 1486455 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.017280539497733116 tr(WHW.T) 136.67332458496094
bpp_loss 2.8064725399017334
2_q proxy err 0.0003946558281313628 tr(WHW.T) 7752.85205078125
bpp_loss 3.4666125774383545
2_k proxy err 0.0003110100806225091 tr(WHW.T) 10205.837890625
bpp_loss 3.5206964015960693
2_o proxy err 0.02301739901304245 tr(WHW.T) 1.4603197574615479
bpp_loss 2.7715578079223633
2_up proxy err 0.017306750640273094 tr(WHW.T) 193.43603515625
bpp_loss 2.977665745934775
2_gate proxy err 0.01125738862901926 tr(WHW.T) 306.6622619628906
bpp_loss 3.0513786493345747
2_down proxy err 0.01983167976140976 tr(WHW.T) 3.010739803314209
bpp_loss 2.983909717825956
I0320 17:00:28.248733 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 1.1905455589294434s
I0320 17:00:32.486790 1486625 config.py:54] PyTorch version 2.6.0 available.
W0320 17:00:32.908379 1486625 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

3_v proxy err 0.02282487414777279 tr(WHW.T) 284.77557373046875
bpp_loss 2.769738793373108
3_q proxy err 0.0010841613402590156 tr(WHW.T) 7217.63720703125
bpp_loss 3.417885422706604
3_k proxy err 0.0007921327487565577 tr(WHW.T) 10074.73828125
bpp_loss 3.4701746702194214
3_o proxy err 0.022701691836118698 tr(WHW.T) 3.3527450561523438
bpp_loss 2.740147590637207
3_up proxy err 0.019564537331461906 tr(WHW.T) 284.7950744628906
bpp_loss 2.9850116108739098
3_gate proxy err 0.012028520926833153 tr(WHW.T) 478.13714599609375
bpp_loss 3.0671257196470747
3_down proxy err 0.020219992846250534 tr(WHW.T) 6.133229732513428
bpp_loss 2.986699326093807
W0320 17:00:34.038231 1486625 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:00:34.043158 1484726 quantize_finetune_llama.py:203] layer 6 gpu 2
I0320 17:00:34.079057 1486625 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:00:36.812399 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 1.3709464073181152s
I0320 17:00:41.201015 1486774 config.py:54] PyTorch version 2.6.0 available.
W0320 17:00:41.533549 1486774 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:00:42.549386 1486774 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:00:42.553377 1484726 quantize_finetune_llama.py:203] layer 7 gpu 3
I0320 17:00:42.567719 1486774 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:00:44.052381 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 1.043837547302246s
I0320 17:00:48.267073 1486902 config.py:54] PyTorch version 2.6.0 available.
W0320 17:00:48.607081 1486902 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:00:49.725467 1486902 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:00:49.729869 1484726 quantize_finetune_llama.py:203] layer 8 gpu 0
I0320 17:00:49.746017 1486902 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.021002111956477165 tr(WHW.T) 274.6131286621094
bpp_loss 2.8107627630233765
4_q proxy err 0.0010096807964146137 tr(WHW.T) 6914.9892578125
bpp_loss 3.4931366443634033
4_k proxy err 0.000687326246406883 tr(WHW.T) 10415.33203125
bpp_loss 3.521383285522461
4_o proxy err 0.02282007411122322 tr(WHW.T) 5.139806270599365
bpp_loss 2.7814096212387085
4_up proxy err 0.01851111650466919 tr(WHW.T) 397.6960144042969
bpp_loss 2.981313661087391
4_gate proxy err 0.00928964652121067 tr(WHW.T) 821.1856689453125
bpp_loss 3.095971573230832
4_down proxy err 0.020215773954987526 tr(WHW.T) 11.562739372253418
bpp_loss 2.9744154686151547
5_v proxy err 0.021755604073405266 tr(WHW.T) 298.47540283203125
bpp_loss 2.8292988538742065
5_q proxy err 0.0011495966464281082 tr(WHW.T) 6770.97509765625
bpp_loss 3.509285807609558
5_k proxy err 0.0007397533627226949 tr(WHW.T) 10841.955078125
bpp_loss 3.564251661300659
5_o proxy err 0.030871935188770294 tr(WHW.T) 7.947142601013184
bpp_loss 2.8008344173431396
5_up proxy err 0.01815906912088394 tr(WHW.T) 506.6408386230469
bpp_loss 2.982553703840389
5_gate proxy err 0.008649012073874474 tr(WHW.T) 1104.867919921875
bpp_loss 3.1027817837027616
5_down proxy err 0.021348029375076294 tr(WHW.T) 15.6494779586792
bpp_loss 2.975243013958598
I0320 17:01:22.651506 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 1.101180076599121s
I0320 17:01:26.469330 1487347 config.py:54] PyTorch version 2.6.0 available.
6_v proxy err 0.023307504132390022 tr(WHW.T) 443.5464782714844
bpp_loss 2.774959921836853
6_q proxy err 0.0016083776718005538 tr(WHW.T) 7576.53857421875
bpp_loss 3.407036781311035
6_k proxy err 0.0011878744699060917 tr(WHW.T) 10409.4033203125
bpp_loss 3.433461308479309
6_o proxy err 0.02967177703976631 tr(WHW.T) 11.564380645751953
bpp_loss 2.7492905855178833
6_up proxy err 0.017998971045017242 tr(WHW.T) 617.2608642578125
bpp_loss 2.9806642754133357
6_gate proxy err 0.0074792527593672276 tr(WHW.T) 1554.7271728515625
bpp_loss 3.1245000085165335
6_down proxy err 0.022035013884305954 tr(WHW.T) 22.988168716430664
bpp_loss 2.9695609114890873
W0320 17:01:26.786608 1487347 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:01:27.762401 1487347 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:01:27.766599 1484726 quantize_finetune_llama.py:203] layer 9 gpu 1
I0320 17:01:27.781644 1487347 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:01:29.268433 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 1.0450291633605957s
I0320 17:01:33.062712 1487478 config.py:54] PyTorch version 2.6.0 available.
7_v proxy err 0.02304878830909729 tr(WHW.T) 489.9357604980469
bpp_loss 2.786306142807007
7_q proxy err 0.0017307954840362072 tr(WHW.T) 7672.17919921875
bpp_loss 3.407675266265869
7_k proxy err 0.0013167826691642404 tr(WHW.T) 10198.3701171875
bpp_loss 3.418493628501892
7_o proxy err 0.03331428021192551 tr(WHW.T) 15.11335563659668
bpp_loss 2.754899501800537
7_up proxy err 0.017297744750976562 tr(WHW.T) 735.8538818359375
bpp_loss 2.987864472145258
7_gate proxy err 0.00708500063046813 tr(WHW.T) 1876.0390625
bpp_loss 3.128405903660974
7_down proxy err 0.02220073528587818 tr(WHW.T) 30.58672523498535
bpp_loss 2.971064345781193
W0320 17:01:33.399147 1487478 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:01:34.353026 1487478 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:01:34.357267 1484726 quantize_finetune_llama.py:203] layer 10 gpu 2
I0320 17:01:34.372041 1487478 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:01:35.833576 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 1.0733158588409424s
I0320 17:01:39.610562 1487597 config.py:54] PyTorch version 2.6.0 available.
W0320 17:01:39.933201 1487597 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:01:40.870160 1487597 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:01:40.874316 1484726 quantize_finetune_llama.py:203] layer 11 gpu 3
I0320 17:01:40.892028 1487597 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:01:42.689498 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.3669261932373047s
I0320 17:01:46.728504 1487735 config.py:54] PyTorch version 2.6.0 available.
W0320 17:01:47.087630 1487735 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:01:48.103389 1487735 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:01:48.107597 1484726 quantize_finetune_llama.py:203] layer 12 gpu 0
I0320 17:01:48.127534 1487735 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.020936699584126472 tr(WHW.T) 530.9967041015625
bpp_loss 2.8055626153945923
8_q proxy err 0.0017892721807584167 tr(WHW.T) 7228.1201171875
bpp_loss 3.415647268295288
8_k proxy err 0.0012389421463012695 tr(WHW.T) 10639.1015625
bpp_loss 3.433198094367981
8_o proxy err 0.03769434988498688 tr(WHW.T) 20.092191696166992
bpp_loss 2.778944253921509
8_up proxy err 0.01572401076555252 tr(WHW.T) 866.312744140625
bpp_loss 3.0030824528184046
8_gate proxy err 0.007147062104195356 tr(WHW.T) 1970.857177734375
bpp_loss 3.1124159347179323
8_down proxy err 0.022018857300281525 tr(WHW.T) 37.177734375
bpp_loss 2.9815210519835005
9_v proxy err 0.020823102444410324 tr(WHW.T) 565.0663452148438
bpp_loss 2.819767117500305
9_q proxy err 0.0019670859910547733 tr(WHW.T) 6970.3359375
bpp_loss 3.4368852376937866
9_k proxy err 0.0012710019946098328 tr(WHW.T) 10987.3515625
bpp_loss 3.4723803997039795
9_o proxy err 0.037378400564193726 tr(WHW.T) 25.610172271728516
bpp_loss 2.796140670776367
9_up proxy err 0.015084217302501202 tr(WHW.T) 970.8984375
bpp_loss 3.0116222292877906
9_gate proxy err 0.007073199842125177 tr(WHW.T) 2132.69384765625
bpp_loss 3.1022376127021256
9_down proxy err 0.022259825840592384 tr(WHW.T) 42.99482727050781
bpp_loss 2.9881996775782387
I0320 17:02:20.684476 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 1.1428642272949219s
I0320 17:02:24.538755 1488176 config.py:54] PyTorch version 2.6.0 available.
10_v proxy err 0.020800022408366203 tr(WHW.T) 578.807373046875
bpp_loss 2.814239263534546
10_q proxy err 0.0020261197350919247 tr(WHW.T) 6915.87109375
bpp_loss 3.428606152534485
10_k proxy err 0.0012969535309821367 tr(WHW.T) 10996.2431640625
bpp_loss 3.468509793281555
10_o proxy err 0.038853731006383896 tr(WHW.T) 35.184165954589844
bpp_loss 2.793745756149292
10_up proxy err 0.014248513616621494 tr(WHW.T) 1080.198486328125
bpp_loss 3.0222079254860104
10_gate proxy err 0.006982711143791676 tr(WHW.T) 2260.88330078125
bpp_loss 3.094554989836937
10_down proxy err 0.021159982308745384 tr(WHW.T) 52.33584976196289
bpp_loss 2.9968690428622935
W0320 17:02:24.904343 1488176 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:02:25.978342 1488176 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:02:25.982487 1484726 quantize_finetune_llama.py:203] layer 13 gpu 1
I0320 17:02:25.997897 1488176 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:02:27.707024 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 1.2159373760223389s
I0320 17:02:31.706743 1488314 config.py:54] PyTorch version 2.6.0 available.
W0320 17:02:32.150713 1488314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:02:33.215094 1488314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:02:33.220290 1484726 quantize_finetune_llama.py:203] layer 14 gpu 2
I0320 17:02:33.248737 1488314 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.02054857462644577 tr(WHW.T) 723.1956176757812
bpp_loss 2.8518495559692383
11_q proxy err 0.002376393647864461 tr(WHW.T) 7027.10986328125
bpp_loss 3.341537833213806
11_k proxy err 0.001609809696674347 tr(WHW.T) 10511.23046875
bpp_loss 3.3481262922286987
11_o proxy err 0.038441386073827744 tr(WHW.T) 36.654052734375
bpp_loss 2.8237802982330322
11_up proxy err 0.014639541506767273 tr(WHW.T) 1139.6044921875
bpp_loss 3.031377393145894
11_gate proxy err 0.007134427782148123 tr(WHW.T) 2392.716552734375
bpp_loss 3.091959931129633
11_down proxy err 0.021782541647553444 tr(WHW.T) 56.13530731201172
bpp_loss 3.00384745486947
I0320 17:02:35.880021 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 1.2472059726715088s
I0320 17:02:39.818663 1488459 config.py:54] PyTorch version 2.6.0 available.
W0320 17:02:40.224934 1488459 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:02:41.284817 1488459 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:02:41.291101 1484726 quantize_finetune_llama.py:203] layer 15 gpu 3
I0320 17:02:41.337545 1488459 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:02:43.070060 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 1.2626004219055176s
I0320 17:02:47.373682 1488582 config.py:54] PyTorch version 2.6.0 available.
W0320 17:02:47.769805 1488582 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:02:49.034261 1488582 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:02:49.038568 1484726 quantize_finetune_llama.py:203] layer 16 gpu 0
I0320 17:02:49.056187 1488582 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.02117510512471199 tr(WHW.T) 703.318603515625
bpp_loss 2.8402678966522217
12_q proxy err 0.002415936440229416 tr(WHW.T) 7045.6435546875
bpp_loss 3.3925042152404785
12_k proxy err 0.0015921868616715074 tr(WHW.T) 10893.65625
bpp_loss 3.4363373517990112
12_o proxy err 0.038811009377241135 tr(WHW.T) 39.29071044921875
bpp_loss 2.816776990890503
12_up proxy err 0.014562373049557209 tr(WHW.T) 1228.298583984375
bpp_loss 3.042368156965389
12_gate proxy err 0.007648879196494818 tr(WHW.T) 2381.994873046875
bpp_loss 3.0867575711982194
12_down proxy err 0.021736210212111473 tr(WHW.T) 64.17745208740234
bpp_loss 3.01283674461897
13_v proxy err 0.021796835586428642 tr(WHW.T) 714.5677490234375
bpp_loss 2.874215841293335
13_q proxy err 0.002526473021134734 tr(WHW.T) 6956.03564453125
bpp_loss 3.38758647441864
13_k proxy err 0.001713353325612843 tr(WHW.T) 10426.6318359375
bpp_loss 3.414112687110901
13_o proxy err 0.03479677066206932 tr(WHW.T) 45.8377571105957
bpp_loss 2.8445440530776978
13_up proxy err 0.01401068177074194 tr(WHW.T) 1367.6221923828125
bpp_loss 3.0538136681845023
13_gate proxy err 0.007476561702787876 tr(WHW.T) 2601.504638671875
bpp_loss 3.0833126334256904
13_down proxy err 0.02173755317926407 tr(WHW.T) 79.3589096069336
bpp_loss 3.0212949486665948
I0320 17:03:28.616748 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 1.3691906929016113s
I0320 17:03:32.621937 1489123 config.py:54] PyTorch version 2.6.0 available.
W0320 17:03:32.989914 1489123 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:03:34.085552 1489123 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:03:34.094681 1484726 quantize_finetune_llama.py:203] layer 17 gpu 1
I0320 17:03:34.125942 1489123 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.02270190231502056 tr(WHW.T) 706.1612548828125
bpp_loss 2.8680258989334106
14_q proxy err 0.002566809067502618 tr(WHW.T) 7077.06103515625
bpp_loss 3.398217558860779
14_k proxy err 0.001630999962799251 tr(WHW.T) 11295.16796875
bpp_loss 3.4296975135803223
14_o proxy err 0.03886397182941437 tr(WHW.T) 50.921180725097656
bpp_loss 2.828451991081238
14_up proxy err 0.014307461678981781 tr(WHW.T) 1464.7159423828125
bpp_loss 3.055833151174146
14_gate proxy err 0.007922331802546978 tr(WHW.T) 2682.584716796875
bpp_loss 3.0813376848087755
14_down proxy err 0.022279417142271996 tr(WHW.T) 90.28684997558594
bpp_loss 3.022572628287382
I0320 17:03:37.383055 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.460423231124878s
I0320 17:03:41.714953 1489266 config.py:54] PyTorch version 2.6.0 available.
15_v proxy err 0.0205395370721817 tr(WHW.T) 762.7275390625
bpp_loss 2.8998879194259644
15_q proxy err 0.0024238962214440107 tr(WHW.T) 7252.0009765625
bpp_loss 3.3835822343826294
15_k proxy err 0.0016193940537050366 tr(WHW.T) 11072.3974609375
bpp_loss 3.432442784309387
15_o proxy err 0.03242183476686478 tr(WHW.T) 59.61664962768555
bpp_loss 2.8612900972366333
15_up proxy err 0.013896127231419086 tr(WHW.T) 1641.0228271484375
bpp_loss 3.0629222781159156
15_gate proxy err 0.007954812608659267 tr(WHW.T) 2905.140380859375
bpp_loss 3.0878620591274526
15_down proxy err 0.0221392922103405 tr(WHW.T) 114.09001922607422
bpp_loss 3.026225999344227
W0320 17:03:42.064786 1489266 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:03:43.135157 1489266 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:03:43.139225 1484726 quantize_finetune_llama.py:203] layer 18 gpu 2
I0320 17:03:43.191732 1489266 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:03:44.872204 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 1.1892132759094238s
I0320 17:03:48.994870 1489401 config.py:54] PyTorch version 2.6.0 available.
W0320 17:03:49.360314 1489401 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:03:50.514354 1489401 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:03:50.518393 1484726 quantize_finetune_llama.py:203] layer 19 gpu 3
I0320 17:03:50.535013 1489401 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:03:52.359141 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 1.3094291687011719s
I0320 17:03:56.643255 1489534 config.py:54] PyTorch version 2.6.0 available.
W0320 17:03:57.050781 1489534 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:03:58.252024 1489534 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:03:58.256459 1484726 quantize_finetune_llama.py:203] layer 20 gpu 0
I0320 17:03:58.273777 1489534 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.021226003766059875 tr(WHW.T) 780.7407836914062
bpp_loss 2.951687216758728
16_q proxy err 0.0025462766643613577 tr(WHW.T) 7193.3974609375
bpp_loss 3.3866597414016724
16_k proxy err 0.001603992423042655 tr(WHW.T) 11630.361328125
bpp_loss 3.4280331134796143
16_o proxy err 0.02568397857248783 tr(WHW.T) 88.22785186767578
bpp_loss 2.900785446166992
16_up proxy err 0.013887643814086914 tr(WHW.T) 1890.9385986328125
bpp_loss 3.063466094260992
16_gate proxy err 0.007932140491902828 tr(WHW.T) 3369.859130859375
bpp_loss 3.097229891045149
16_down proxy err 0.022255506366491318 tr(WHW.T) 152.0294952392578
bpp_loss 3.026342591574026
17_v proxy err 0.019539589062333107 tr(WHW.T) 845.7654418945312
bpp_loss 3.006527066230774
17_q proxy err 0.0025340670254081488 tr(WHW.T) 7163.2734375
bpp_loss 3.4764654636383057
17_k proxy err 0.0017184937605634332 tr(WHW.T) 10697.431640625
bpp_loss 3.5112709999084473
17_o proxy err 0.02825874648988247 tr(WHW.T) 58.14826965332031
bpp_loss 2.8996572494506836
17_up proxy err 0.015433586202561855 tr(WHW.T) 1921.07861328125
bpp_loss 3.057776872501817
17_gate proxy err 0.008478176780045033 tr(WHW.T) 3571.31640625
bpp_loss 3.1064951697061227
17_down proxy err 0.022307783365249634 tr(WHW.T) 165.43495178222656
bpp_loss 3.0254564950632497
I0320 17:04:32.536141 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.2537813186645508s
18_v proxy err 0.013896854594349861 tr(WHW.T) 1003.7705078125
bpp_loss 3.276023507118225
18_q proxy err 0.0019734196830540895 tr(WHW.T) 7510.48046875
bpp_loss 3.761513829231262
18_k proxy err 0.0014276591828092933 tr(WHW.T) 10462.6650390625
bpp_loss 3.797447443008423
18_o proxy err 0.024321548640727997 tr(WHW.T) 69.96558380126953
bpp_loss 2.9373196363449097
18_up proxy err 0.016471801325678825 tr(WHW.T) 2023.183837890625
bpp_loss 3.054929334063863
18_gate proxy err 0.009025879204273224 tr(WHW.T) 3783.076416015625
bpp_loss 3.117321103118187
18_down proxy err 0.02201896347105503 tr(WHW.T) 198.52699279785156
bpp_loss 3.025476721830146
I0320 17:04:36.333219 1490012 config.py:54] PyTorch version 2.6.0 available.
W0320 17:04:36.677472 1490012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:04:37.684901 1490012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:04:37.688960 1484726 quantize_finetune_llama.py:203] layer 21 gpu 1
I0320 17:04:37.706294 1490012 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:04:39.281898 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 1.1319034099578857s
19_v proxy err 0.013648671098053455 tr(WHW.T) 1019.1412353515625
bpp_loss 3.288204312324524
19_q proxy err 0.002112771850079298 tr(WHW.T) 6944.4130859375
bpp_loss 3.7302225828170776
19_k proxy err 0.0014057522639632225 tr(WHW.T) 10548.4892578125
bpp_loss 3.7632023096084595
19_o proxy err 0.024611741304397583 tr(WHW.T) 62.291683197021484
bpp_loss 2.9469937086105347
19_up proxy err 0.01658806949853897 tr(WHW.T) 2149.330322265625
bpp_loss 3.0574896169263264
19_gate proxy err 0.009888824075460434 tr(WHW.T) 3687.5126953125
bpp_loss 3.1255086854446765
19_down proxy err 0.021536462008953094 tr(WHW.T) 222.93177795410156
bpp_loss 3.0278605084086574
I0320 17:04:42.990379 1490131 config.py:54] PyTorch version 2.6.0 available.
W0320 17:04:43.302954 1490131 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:04:44.224782 1490131 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:04:44.228807 1484726 quantize_finetune_llama.py:203] layer 22 gpu 2
I0320 17:04:44.243128 1490131 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:04:45.702916 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 1.0182185173034668s
I0320 17:04:49.576516 1490254 config.py:54] PyTorch version 2.6.0 available.
W0320 17:04:49.908504 1490254 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:04:50.938742 1490254 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:04:50.942511 1484726 quantize_finetune_llama.py:203] layer 23 gpu 3
I0320 17:04:50.957561 1490254 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:04:52.803691 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.3874027729034424s
I0320 17:04:56.682815 1490389 config.py:54] PyTorch version 2.6.0 available.
W0320 17:04:57.030125 1490389 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:04:58.017864 1490389 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:04:58.022212 1484726 quantize_finetune_llama.py:203] layer 24 gpu 0
I0320 17:04:58.037801 1490389 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.013394706882536411 tr(WHW.T) 990.5983276367188
bpp_loss 3.3574888706207275
20_q proxy err 0.0019460348412394524 tr(WHW.T) 7150.947265625
bpp_loss 3.797939658164978
20_k proxy err 0.0013520298525691032 tr(WHW.T) 10386.2470703125
bpp_loss 3.8295540809631348
20_o proxy err 0.018129577860236168 tr(WHW.T) 100.31707000732422
bpp_loss 2.9670822620391846
20_up proxy err 0.01634172536432743 tr(WHW.T) 2340.89453125
bpp_loss 3.0565597179324127
20_gate proxy err 0.009744130074977875 tr(WHW.T) 4024.62744140625
bpp_loss 3.132297249727471
20_down proxy err 0.02095876634120941 tr(WHW.T) 274.8815002441406
bpp_loss 3.02914657149204
21_v proxy err 0.011356263421475887 tr(WHW.T) 1144.5655517578125
bpp_loss 3.50376558303833
21_q proxy err 0.0018953050021082163 tr(WHW.T) 7064.314453125
bpp_loss 3.8715440034866333
21_k proxy err 0.0013563917018473148 tr(WHW.T) 9976.4658203125
bpp_loss 3.8884857892990112
21_o proxy err 0.019730208441615105 tr(WHW.T) 75.50972747802734
bpp_loss 2.989308714866638
21_up proxy err 0.017228251323103905 tr(WHW.T) 2361.650390625
bpp_loss 3.054468554119731
21_gate proxy err 0.010423636063933372 tr(WHW.T) 4004.37646484375
bpp_loss 3.1402648216070133
21_down proxy err 0.02153739146888256 tr(WHW.T) 276.5857849121094
bpp_loss 3.0284589501314385
I0320 17:05:30.061990 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 1.067152976989746s
I0320 17:05:33.821538 1490842 config.py:54] PyTorch version 2.6.0 available.
W0320 17:05:34.157216 1490842 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.010681433603167534 tr(WHW.T) 1243.2529296875
bpp_loss 3.5150550603866577
22_q proxy err 0.0017756617162376642 tr(WHW.T) 7746.84765625
bpp_loss 3.9342024326324463
22_k proxy err 0.0013094956520944834 tr(WHW.T) 10603.2041015625
bpp_loss 3.9561073780059814
22_o proxy err 0.016485312953591347 tr(WHW.T) 114.30065155029297
bpp_loss 2.9881155490875244
22_up proxy err 0.01732780598104 tr(WHW.T) 2474.510498046875
bpp_loss 3.0565563468045966
22_gate proxy err 0.010605310089886189 tr(WHW.T) 4156.64013671875
bpp_loss 3.1504466921784156
22_down proxy err 0.02134343422949314 tr(WHW.T) 311.8800048828125
bpp_loss 3.029461461444234
W0320 17:05:35.181483 1490842 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:05:35.185734 1484726 quantize_finetune_llama.py:203] layer 25 gpu 1
I0320 17:05:35.202461 1490842 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:05:36.932633 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 1.021031141281128s
I0320 17:05:40.718215 1490963 config.py:54] PyTorch version 2.6.0 available.
W0320 17:05:41.076368 1490963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.009968065656721592 tr(WHW.T) 1486.037353515625
bpp_loss 3.6173778772354126
23_q proxy err 0.0020724893547594547 tr(WHW.T) 7346.60986328125
bpp_loss 3.9504473209381104
23_k proxy err 0.0015342606930062175 tr(WHW.T) 9982.2392578125
bpp_loss 3.963747978210449
23_o proxy err 0.01962483674287796 tr(WHW.T) 85.13458251953125
bpp_loss 3.0452126264572144
23_up proxy err 0.01788792759180069 tr(WHW.T) 2533.51025390625
bpp_loss 3.0647403805754907
23_gate proxy err 0.011353198438882828 tr(WHW.T) 4097.51953125
bpp_loss 3.1540802356808686
23_down proxy err 0.021474996581673622 tr(WHW.T) 321.33892822265625
bpp_loss 3.035534193349439
W0320 17:05:42.064015 1490963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:05:42.068343 1484726 quantize_finetune_llama.py:203] layer 26 gpu 2
I0320 17:05:42.092651 1490963 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:05:43.698696 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 1.0012145042419434s
I0320 17:05:47.876945 1491097 config.py:54] PyTorch version 2.6.0 available.
W0320 17:05:48.224743 1491097 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:05:49.338920 1491097 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:05:49.343605 1484726 quantize_finetune_llama.py:203] layer 27 gpu 3
I0320 17:05:49.380209 1491097 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:05:51.068310 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 1.2189149856567383s
I0320 17:05:55.438229 1491225 config.py:54] PyTorch version 2.6.0 available.
W0320 17:05:55.929566 1491225 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:05:57.159502 1491225 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:05:57.163605 1484726 quantize_finetune_llama.py:203] layer 28 gpu 0
I0320 17:05:57.187953 1491225 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.01030574832111597 tr(WHW.T) 1394.900634765625
bpp_loss 3.596340537071228
24_q proxy err 0.002099108649417758 tr(WHW.T) 7020.447265625
bpp_loss 3.856656551361084
24_k proxy err 0.001438124687410891 tr(WHW.T) 10323.43359375
bpp_loss 3.8624461889266968
24_o proxy err 0.015053599141538143 tr(WHW.T) 133.98797607421875
bpp_loss 3.0311293601989746
24_up proxy err 0.017987290397286415 tr(WHW.T) 2621.76513671875
bpp_loss 3.0777871775072674
24_gate proxy err 0.011326321400702 tr(WHW.T) 4262.74853515625
bpp_loss 3.1674369989439497
24_down proxy err 0.02122468501329422 tr(WHW.T) 340.22412109375
bpp_loss 3.0405103993970295
25_v proxy err 0.009291369467973709 tr(WHW.T) 1707.664794921875
bpp_loss 3.796692728996277
25_q proxy err 0.0022608640138059855 tr(WHW.T) 7162.16357421875
bpp_loss 4.036495923995972
25_k proxy err 0.0016913758590817451 tr(WHW.T) 9611.58984375
bpp_loss 4.042545557022095
25_o proxy err 0.018863379955291748 tr(WHW.T) 83.535888671875
bpp_loss 3.075039505958557
25_up proxy err 0.01675530895590782 tr(WHW.T) 2805.728515625
bpp_loss 3.1396975849950035
25_gate proxy err 0.0102999834343791 tr(WHW.T) 4666.4404296875
bpp_loss 3.232257044592569
25_down proxy err 0.020468421280384064 tr(WHW.T) 373.460693359375
bpp_loss 3.0493217956188112
I0320 17:06:37.739459 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 1.2428948879241943s
I0320 17:06:41.695240 1491750 config.py:54] PyTorch version 2.6.0 available.
W0320 17:06:42.046316 1491750 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.009285136125981808 tr(WHW.T) 1668.8843994140625
bpp_loss 3.7610427141189575
26_q proxy err 0.002115070354193449 tr(WHW.T) 7469.98291015625
bpp_loss 3.9328174591064453
26_k proxy err 0.0015197476604953408 tr(WHW.T) 10487.8740234375
bpp_loss 3.94600510597229
26_o proxy err 0.012322255410254002 tr(WHW.T) 202.88172912597656
bpp_loss 3.0963566303253174
26_up proxy err 0.013095100410282612 tr(WHW.T) 3154.75146484375
bpp_loss 3.305978819381359
26_gate proxy err 0.007939784787595272 tr(WHW.T) 5302.16455078125
bpp_loss 3.4108826393304867
26_down proxy err 0.021358294412493706 tr(WHW.T) 401.19390869140625
bpp_loss 3.0538795604262243
W0320 17:06:43.126418 1491750 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:06:43.130472 1484726 quantize_finetune_llama.py:203] layer 29 gpu 1
I0320 17:06:43.182317 1491750 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:06:45.149479 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 1.4815473556518555s
I0320 17:06:49.134354 1491873 config.py:54] PyTorch version 2.6.0 available.
W0320 17:06:49.558402 1491873 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.008767329156398773 tr(WHW.T) 1799.3350830078125
bpp_loss 3.8238372802734375
27_q proxy err 0.0021010320633649826 tr(WHW.T) 7691.708984375
bpp_loss 4.095790863037109
27_k proxy err 0.0015323346015065908 tr(WHW.T) 10618.70703125
bpp_loss 4.118942499160767
27_o proxy err 0.017003118991851807 tr(WHW.T) 126.13690185546875
bpp_loss 3.1098328828811646
27_up proxy err 0.009189896285533905 tr(WHW.T) 3691.557861328125
bpp_loss 3.51126542202262
27_gate proxy err 0.005729686934500933 tr(WHW.T) 5990.82568359375
bpp_loss 3.6231739132903344
27_down proxy err 0.02051360532641411 tr(WHW.T) 466.9318542480469
bpp_loss 3.0717087235561635
W0320 17:06:50.545352 1491873 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:06:50.549355 1484726 quantize_finetune_llama.py:203] layer 30 gpu 2
I0320 17:06:50.612308 1491873 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:06:53.206742 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 1.3233790397644043s
I0320 17:06:57.203405 1492018 config.py:54] PyTorch version 2.6.0 available.
W0320 17:06:57.562084 1492018 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:06:58.685477 1492018 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:06:58.689783 1484726 quantize_finetune_llama.py:203] layer 31 gpu 3
I0320 17:06:58.720161 1492018 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:07:00.336405 1484726 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.124368667602539s
I0320 17:07:04.670115 1492144 config.py:54] PyTorch version 2.6.0 available.
W0320 17:07:05.056489 1492144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:07:06.199525 1492144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:07:06.248310 1492144 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.0074872965924441814 tr(WHW.T) 2018.944091796875
bpp_loss 4.094095230102539
28_q proxy err 0.0020072869956493378 tr(WHW.T) 7651.126953125
bpp_loss 4.2385900020599365
28_k proxy err 0.0014627068303525448 tr(WHW.T) 10544.8251953125
bpp_loss 4.267897367477417
28_o proxy err 0.014104699715971947 tr(WHW.T) 194.8240966796875
bpp_loss 3.145039439201355
28_up proxy err 0.006928964518010616 tr(WHW.T) 4661.2666015625
bpp_loss 3.5982905543127726
28_gate proxy err 0.004962377715855837 tr(WHW.T) 6547.48193359375
bpp_loss 3.6859542491824127
28_down proxy err 0.018248870968818665 tr(WHW.T) 603.8403930664062
bpp_loss 3.1055506550988485
29_v proxy err 0.008639452047646046 tr(WHW.T) 1801.7730712890625
bpp_loss 3.8493250608444214
29_q proxy err 0.002194963628426194 tr(WHW.T) 7227.0009765625
bpp_loss 3.902173161506653
29_k proxy err 0.0015133512206375599 tr(WHW.T) 10558.609375
bpp_loss 3.9228017330169678
29_o proxy err 0.012405653484165668 tr(WHW.T) 207.9054412841797
bpp_loss 3.1552168130874634
29_up proxy err 0.005417058244347572 tr(WHW.T) 6070.0498046875
bpp_loss 3.630006479662518
29_gate proxy err 0.004472134169191122 tr(WHW.T) 7369.6142578125
bpp_loss 3.7033710923305776
29_down proxy err 0.01574258878827095 tr(WHW.T) 782.2448120117188
bpp_loss 3.161113605942837
30_v proxy err 0.006909210234880447 tr(WHW.T) 2261.489501953125
bpp_loss 4.090211629867554
30_q proxy err 0.002034511649981141 tr(WHW.T) 7815.9453125
bpp_loss 4.121120929718018
30_k proxy err 0.0015214962186291814 tr(WHW.T) 10521.625
bpp_loss 4.1584858894348145
30_o proxy err 0.011986861936748028 tr(WHW.T) 251.96908569335938
bpp_loss 3.195015788078308
30_up proxy err 0.0033376163337379694 tr(WHW.T) 10016.376953125
bpp_loss 3.6493895774663883
30_gate proxy err 0.003033165354281664 tr(WHW.T) 11001.119140625
bpp_loss 3.7341232299804688
30_down proxy err 0.004404283128678799 tr(WHW.T) 3582.617919921875
bpp_loss 3.2693583022716433
31_v proxy err 0.009882044047117233 tr(WHW.T) 1268.2034912109375
bpp_loss 3.566523790359497
31_q proxy err 0.0019246344454586506 tr(WHW.T) 6858.09130859375
bpp_loss 3.805748462677002
31_k proxy err 0.001308908686041832 tr(WHW.T) 10233.677734375
bpp_loss 3.866689085960388
31_o proxy err 0.006851800251752138 tr(WHW.T) 457.7950744628906
bpp_loss 3.1585599184036255
31_up proxy err 0.003267318243160844 tr(WHW.T) 14563.890625
bpp_loss 3.2970742513967113
31_gate proxy err 0.003229271387681365 tr(WHW.T) 14836.2939453125
bpp_loss 3.372129041095113
31_down proxy err 0.0014258709270507097 tr(WHW.T) 17873.55859375
bpp_loss 3.4791099415269007
I0320 17:08:01.089999 1492795 config.py:54] PyTorch version 2.6.0 available.
W0320 17:08:01.388801 1492795 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0320 17:08:01.624432 1492795 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Llama-2-7b-hf",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "max_position_embeddings": 4096,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 32000
}

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  8.72it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  9.70it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  9.62it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.05it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  9.86it/s]
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  9.66it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00, 10.04it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  9.95it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.06it/s]
I0320 17:08:04.953408 1492795 hfize_llama.py:153] loaded layer 0
I0320 17:08:06.792581 1492795 hfize_llama.py:153] loaded layer 1
I0320 17:08:08.581735 1492795 hfize_llama.py:153] loaded layer 2
I0320 17:08:10.279711 1492795 hfize_llama.py:153] loaded layer 3
I0320 17:08:11.969496 1492795 hfize_llama.py:153] loaded layer 4
I0320 17:08:13.710444 1492795 hfize_llama.py:153] loaded layer 5
I0320 17:08:15.457943 1492795 hfize_llama.py:153] loaded layer 6
I0320 17:08:17.183619 1492795 hfize_llama.py:153] loaded layer 7
I0320 17:08:18.931923 1492795 hfize_llama.py:153] loaded layer 8
I0320 17:08:20.667116 1492795 hfize_llama.py:153] loaded layer 9
I0320 17:08:22.425636 1492795 hfize_llama.py:153] loaded layer 10
I0320 17:08:24.159387 1492795 hfize_llama.py:153] loaded layer 11
I0320 17:08:25.950908 1492795 hfize_llama.py:153] loaded layer 12
I0320 17:08:27.737022 1492795 hfize_llama.py:153] loaded layer 13
I0320 17:08:29.523789 1492795 hfize_llama.py:153] loaded layer 14
I0320 17:08:31.303242 1492795 hfize_llama.py:153] loaded layer 15
I0320 17:08:32.925796 1492795 hfize_llama.py:153] loaded layer 16
I0320 17:08:34.718681 1492795 hfize_llama.py:153] loaded layer 17
I0320 17:08:36.513236 1492795 hfize_llama.py:153] loaded layer 18
I0320 17:08:38.297618 1492795 hfize_llama.py:153] loaded layer 19
I0320 17:08:40.071933 1492795 hfize_llama.py:153] loaded layer 20
I0320 17:08:41.814513 1492795 hfize_llama.py:153] loaded layer 21
I0320 17:08:43.571352 1492795 hfize_llama.py:153] loaded layer 22
I0320 17:08:45.243967 1492795 hfize_llama.py:153] loaded layer 23
I0320 17:08:46.879845 1492795 hfize_llama.py:153] loaded layer 24
I0320 17:08:48.453649 1492795 hfize_llama.py:153] loaded layer 25
I0320 17:08:50.046214 1492795 hfize_llama.py:153] loaded layer 26
I0320 17:08:51.679989 1492795 hfize_llama.py:153] loaded layer 27
I0320 17:08:53.234383 1492795 hfize_llama.py:153] loaded layer 28
I0320 17:08:54.859642 1492795 hfize_llama.py:153] loaded layer 29
I0320 17:08:56.484947 1492795 hfize_llama.py:153] loaded layer 30
I0320 17:08:58.099233 1492795 hfize_llama.py:153] loaded layer 31
I0320 17:08:58.099429 1492795 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:05,  1.02s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.10it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.15it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.17it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.19it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.40it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.25it/s]
I0320 17:09:31.869743 1492795 hfize_llama.py:167] successfully loaded hfized model
