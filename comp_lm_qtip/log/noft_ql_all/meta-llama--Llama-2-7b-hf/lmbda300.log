I0320 17:33:00.594137 1504852 config.py:54] PyTorch version 2.6.0 available.
W0320 17:33:00.875855 1504852 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:33:01.869311 1504852 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.51it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.98it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.15it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.24it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.29it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.38it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.24it/s]
I0320 17:33:02.800094 1504852 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:14,  2.09it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:13,  2.18it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:12,  2.27it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:11,  2.34it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:11,  2.36it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:11,  2.36it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:10,  2.38it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:10,  2.39it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:09,  2.40it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:09,  2.40it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.41it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:08,  2.41it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.41it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.40it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:07,  2.40it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.40it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:06,  2.39it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.38it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:05,  2.38it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:08<00:05,  2.39it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.39it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:09<00:04,  2.38it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.38it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:10<00:03,  2.39it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:10<00:02,  2.40it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.41it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:11<00:02,  2.41it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.42it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:12<00:01,  2.41it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:12<00:00,  2.41it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:13<00:00,  2.39it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.41it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.38it/s]
I0320 17:33:20.925155 1504852 quantize_finetune_llama.py:179] loaded compression model
I0320 17:33:35.073727 1504852 quantize_finetune_llama.py:183] loaded dataset and devset
I0320 17:33:39.985228 1504852 quantize_finetune_llama.py:203] layer 0 gpu 0
I0320 17:33:42.155726 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 2.0103800296783447s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0320 17:33:53.608047 1505039 config.py:54] PyTorch version 2.6.0 available.
W0320 17:33:53.888366 1505039 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:33:54.765085 1505039 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:33:54.769214 1504852 quantize_finetune_llama.py:203] layer 1 gpu 1
I0320 17:33:54.783656 1505039 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:33:57.166783 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 2.2037503719329834s
I0320 17:34:00.652967 1505100 config.py:54] PyTorch version 2.6.0 available.
W0320 17:34:00.939526 1505100 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:34:01.853487 1505100 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:34:01.857473 1504852 quantize_finetune_llama.py:203] layer 2 gpu 2
I0320 17:34:01.874828 1505100 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:34:04.222951 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 2.1962015628814697s
I0320 17:34:07.950397 1505161 config.py:54] PyTorch version 2.6.0 available.
W0320 17:34:08.283897 1505161 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:34:09.283614 1505161 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:34:09.288401 1504852 quantize_finetune_llama.py:203] layer 3 gpu 3
I0320 17:34:09.304804 1505161 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:34:11.727505 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 2.256988048553467s
I0320 17:34:15.678522 1505222 config.py:54] PyTorch version 2.6.0 available.
W0320 17:34:16.022799 1505222 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:34:17.014282 1505222 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:34:17.018556 1504852 quantize_finetune_llama.py:203] layer 4 gpu 0
I0320 17:34:17.033795 1505222 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.013756132684648037 tr(WHW.T) 4.225186347961426
bpp_loss 3.390763282775879
0_q proxy err 0.0002713431022129953 tr(WHW.T) 2710.363037109375
bpp_loss 3.4119006395339966
0_k proxy err 0.00026616084505803883 tr(WHW.T) 1698.7349853515625
bpp_loss 3.5160316228866577
0_o proxy err 0.0027516046538949013 tr(WHW.T) 0.9668058156967163
bpp_loss 3.238954544067383
0_up proxy err 0.003978892229497433 tr(WHW.T) 43.27138900756836
bpp_loss 3.680421696152798
0_gate proxy err 0.002756873844191432 tr(WHW.T) 63.47430419921875
bpp_loss 3.694018696629724
0_down proxy err 0.0032942292746156454 tr(WHW.T) 0.656814694404602
bpp_loss 3.7192905115526775
1_v proxy err 0.01871226169168949 tr(WHW.T) 16.465883255004883
bpp_loss 3.3528698682785034
1_q proxy err 0.00024771716562099755 tr(WHW.T) 4778.43994140625
bpp_loss 4.151789903640747
1_k proxy err 0.0002754871384240687 tr(WHW.T) 4995.39208984375
bpp_loss 4.158625364303589
1_o proxy err 0.010514296591281891 tr(WHW.T) 1.1115814447402954
bpp_loss 3.276771664619446
1_up proxy err 0.004935105796903372 tr(WHW.T) 109.66383361816406
bpp_loss 3.7428970336914062
1_gate proxy err 0.0025040965992957354 tr(WHW.T) 221.3038787841797
bpp_loss 3.805266801701036
1_down proxy err 0.0005943268188275397 tr(WHW.T) 2041.4736328125
bpp_loss 3.7582756530406862
I0320 17:34:47.140274 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.9104411602020264s
I0320 17:34:50.947301 1505317 config.py:54] PyTorch version 2.6.0 available.
W0320 17:34:51.269906 1505317 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:34:52.255699 1505317 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:34:52.259828 1504852 quantize_finetune_llama.py:203] layer 5 gpu 1
I0320 17:34:52.275030 1505317 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.006244414485991001 tr(WHW.T) 136.67332458496094
bpp_loss 3.581518054008484
2_q proxy err 0.00026579597033560276 tr(WHW.T) 7752.85205078125
bpp_loss 4.327027797698975
2_k proxy err 0.00024204837973229587 tr(WHW.T) 10205.837890625
bpp_loss 4.396406888961792
2_o proxy err 0.008137551136314869 tr(WHW.T) 1.4603197574615479
bpp_loss 3.5463510751724243
2_up proxy err 0.0058785174041986465 tr(WHW.T) 193.43603515625
bpp_loss 3.763473333314408
2_gate proxy err 0.003753158263862133 tr(WHW.T) 306.6622619628906
bpp_loss 3.8439458802688953
2_down proxy err 0.006755218841135502 tr(WHW.T) 3.010739803314209
bpp_loss 3.7701445512993392
I0320 17:34:54.521089 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 0.8750836849212646s
I0320 17:34:58.323258 1505379 config.py:54] PyTorch version 2.6.0 available.
W0320 17:34:58.667515 1505379 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:34:59.670183 1505379 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:34:59.674667 1504852 quantize_finetune_llama.py:203] layer 6 gpu 2
I0320 17:34:59.690285 1505379 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.008213096298277378 tr(WHW.T) 284.77557373046875
bpp_loss 3.542982578277588
3_q proxy err 0.00048607736243866384 tr(WHW.T) 7217.63720703125
bpp_loss 4.261178970336914
3_k proxy err 0.00039061246206983924 tr(WHW.T) 10074.73828125
bpp_loss 4.3242292404174805
3_o proxy err 0.008166423998773098 tr(WHW.T) 3.3527450561523438
bpp_loss 3.5140140056610107
3_up proxy err 0.006651787087321281 tr(WHW.T) 284.7950744628906
bpp_loss 3.771445340888445
3_gate proxy err 0.00400762353092432 tr(WHW.T) 478.13714599609375
bpp_loss 3.8615777658861736
3_down proxy err 0.006897802464663982 tr(WHW.T) 6.133229732513428
bpp_loss 3.7732580539792084
I0320 17:35:02.107289 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 0.8377714157104492s
I0320 17:35:05.872336 1505438 config.py:54] PyTorch version 2.6.0 available.
W0320 17:35:06.216168 1505438 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:35:07.245304 1505438 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:35:07.249654 1504852 quantize_finetune_llama.py:203] layer 7 gpu 3
I0320 17:35:07.265605 1505438 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:35:08.669849 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 0.8971660137176514s
I0320 17:35:12.546894 1505497 config.py:54] PyTorch version 2.6.0 available.
W0320 17:35:12.888676 1505497 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:35:13.976144 1505497 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:35:13.980534 1504852 quantize_finetune_llama.py:203] layer 8 gpu 0
I0320 17:35:13.997941 1505497 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.007520286366343498 tr(WHW.T) 274.6131286621094
bpp_loss 3.585033655166626
4_q proxy err 0.0004863485519308597 tr(WHW.T) 6914.9892578125
bpp_loss 4.345574855804443
4_k proxy err 0.0003838306583929807 tr(WHW.T) 10415.33203125
bpp_loss 4.3809494972229
4_o proxy err 0.008070948533713818 tr(WHW.T) 5.139806270599365
bpp_loss 3.5559312105178833
4_up proxy err 0.006309575866907835 tr(WHW.T) 397.6960144042969
bpp_loss 3.767212446345839
4_gate proxy err 0.00311605678871274 tr(WHW.T) 821.1856689453125
bpp_loss 3.8927014373069584
4_down proxy err 0.006920440588146448 tr(WHW.T) 11.562739372253418
bpp_loss 3.75997687495032
5_v proxy err 0.007763453759253025 tr(WHW.T) 298.47540283203125
bpp_loss 3.60504150390625
5_q proxy err 0.0004830121761187911 tr(WHW.T) 6770.97509765625
bpp_loss 4.363271236419678
5_k proxy err 0.0003628874255809933 tr(WHW.T) 10841.955078125
bpp_loss 4.429543972015381
5_o proxy err 0.011063928715884686 tr(WHW.T) 7.947142601013184
bpp_loss 3.576495409011841
5_up proxy err 0.006187666207551956 tr(WHW.T) 506.6408386230469
bpp_loss 3.768439536870912
5_gate proxy err 0.0028979878406971693 tr(WHW.T) 1104.867919921875
bpp_loss 3.9005382449127906
5_down proxy err 0.007302793674170971 tr(WHW.T) 15.6494779586792
bpp_loss 3.7609717790470567
I0320 17:35:44.960528 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 0.9934682846069336s
I0320 17:35:48.745270 1505595 config.py:54] PyTorch version 2.6.0 available.
W0320 17:35:49.086384 1505595 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:35:50.087653 1505595 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:35:50.092098 1504852 quantize_finetune_llama.py:203] layer 9 gpu 1
I0320 17:35:50.109567 1505595 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.008386757224798203 tr(WHW.T) 443.5464782714844
bpp_loss 3.548099160194397
6_q proxy err 0.0006191235152073205 tr(WHW.T) 7576.53857421875
bpp_loss 4.2458882331848145
6_k proxy err 0.0004899436607956886 tr(WHW.T) 10409.4033203125
bpp_loss 4.277311563491821
6_o proxy err 0.010580021888017654 tr(WHW.T) 11.564380645751953
bpp_loss 3.5232558250427246
6_up proxy err 0.006140817888081074 tr(WHW.T) 617.2608642578125
bpp_loss 3.766394149425418
6_gate proxy err 0.0025081620551645756 tr(WHW.T) 1554.7271728515625
bpp_loss 3.924549014069313
6_down proxy err 0.007543484680354595 tr(WHW.T) 22.988168716430664
bpp_loss 3.7547684602959213
I0320 17:35:52.929888 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 0.9189696311950684s
I0320 17:35:56.729459 1505654 config.py:54] PyTorch version 2.6.0 available.
7_v proxy err 0.008277150802314281 tr(WHW.T) 489.9357604980469
bpp_loss 3.559770345687866
7_q proxy err 0.0006527407094836235 tr(WHW.T) 7672.17919921875
bpp_loss 4.2460784912109375
7_k proxy err 0.0005236676661297679 tr(WHW.T) 10198.3701171875
bpp_loss 4.258477210998535
7_o proxy err 0.011876330710947514 tr(WHW.T) 15.11335563659668
bpp_loss 3.529243588447571
7_up proxy err 0.005910010077059269 tr(WHW.T) 735.8538818359375
bpp_loss 3.7737290138422055
7_gate proxy err 0.0024047561455518007 tr(WHW.T) 1876.0390625
bpp_loss 3.928102892498637
7_down proxy err 0.007596978452056646 tr(WHW.T) 30.58672523498535
bpp_loss 3.7564535362775935
W0320 17:35:57.011199 1505654 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:35:57.991738 1505654 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:35:57.995751 1504852 quantize_finetune_llama.py:203] layer 10 gpu 2
I0320 17:35:58.010409 1505654 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:35:59.269545 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 0.8137314319610596s
I0320 17:36:03.004666 1505713 config.py:54] PyTorch version 2.6.0 available.
W0320 17:36:03.320761 1505713 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:36:04.334125 1505713 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:36:04.338536 1504852 quantize_finetune_llama.py:203] layer 11 gpu 3
I0320 17:36:04.353819 1505713 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:36:05.915727 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.1110191345214844s
I0320 17:36:09.842475 1505772 config.py:54] PyTorch version 2.6.0 available.
W0320 17:36:10.203245 1505772 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:36:11.286104 1505772 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:36:11.290300 1504852 quantize_finetune_llama.py:203] layer 12 gpu 0
I0320 17:36:11.309807 1505772 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.007499428000301123 tr(WHW.T) 530.9967041015625
bpp_loss 3.579428791999817
8_q proxy err 0.0007062522927299142 tr(WHW.T) 7228.1201171875
bpp_loss 4.25591254234314
8_k proxy err 0.0005356619949452579 tr(WHW.T) 10639.1015625
bpp_loss 4.2760233879089355
8_o proxy err 0.01342566404491663 tr(WHW.T) 20.092191696166992
bpp_loss 3.5534850358963013
8_up proxy err 0.005364163313060999 tr(WHW.T) 866.312744140625
bpp_loss 3.7898304074309594
8_gate proxy err 0.0024454144295305014 tr(WHW.T) 1970.857177734375
bpp_loss 3.910263416378997
8_down proxy err 0.007518045138567686 tr(WHW.T) 37.177734375
bpp_loss 3.767790195553802
9_v proxy err 0.007411090657114983 tr(WHW.T) 565.0663452148438
bpp_loss 3.594611167907715
9_q proxy err 0.0007345281192101538 tr(WHW.T) 6970.3359375
bpp_loss 4.277915000915527
9_k proxy err 0.0005258296732790768 tr(WHW.T) 10987.3515625
bpp_loss 4.319610595703125
9_o proxy err 0.013293060474097729 tr(WHW.T) 25.610172271728516
bpp_loss 3.571322798728943
9_up proxy err 0.005143280141055584 tr(WHW.T) 970.8984375
bpp_loss 3.7988973218341204
9_gate proxy err 0.0024345917627215385 tr(WHW.T) 2132.69384765625
bpp_loss 3.89878650044286
9_down proxy err 0.007590233348309994 tr(WHW.T) 42.99482727050781
bpp_loss 3.775100042653638
I0320 17:36:43.533409 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 0.8938171863555908s
I0320 17:36:47.278755 1505870 config.py:54] PyTorch version 2.6.0 available.
W0320 17:36:47.620968 1505870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.007433769293129444 tr(WHW.T) 578.807373046875
bpp_loss 3.5881916284561157
10_q proxy err 0.0007595164352096617 tr(WHW.T) 6915.87109375
bpp_loss 4.270083904266357
10_k proxy err 0.0005362668889574707 tr(WHW.T) 10996.2431640625
bpp_loss 4.316834449768066
10_o proxy err 0.013795902021229267 tr(WHW.T) 35.184165954589844
bpp_loss 3.5685452222824097
10_up proxy err 0.004851747304201126 tr(WHW.T) 1080.198486328125
bpp_loss 3.8104505317155706
10_gate proxy err 0.0023998019751161337 tr(WHW.T) 2260.88330078125
bpp_loss 3.8914241347202037
10_down proxy err 0.007214545272290707 tr(WHW.T) 52.33584976196289
bpp_loss 3.784629378207894
W0320 17:36:48.592555 1505870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:36:48.596739 1504852 quantize_finetune_llama.py:203] layer 13 gpu 1
I0320 17:36:48.611531 1505870 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:36:49.926973 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 0.848968505859375s
I0320 17:36:53.797101 1505929 config.py:54] PyTorch version 2.6.0 available.
W0320 17:36:54.122702 1505929 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.0072782705537974834 tr(WHW.T) 723.1956176757812
bpp_loss 3.627719759941101
11_q proxy err 0.0008765942766331136 tr(WHW.T) 7027.10986328125
bpp_loss 4.171015501022339
11_k proxy err 0.0006454578251577914 tr(WHW.T) 10511.23046875
bpp_loss 4.178045034408569
11_o proxy err 0.013601699844002724 tr(WHW.T) 36.654052734375
bpp_loss 3.6006155014038086
11_up proxy err 0.004970633424818516 tr(WHW.T) 1139.6044921875
bpp_loss 3.8203903907953305
11_gate proxy err 0.002442846307530999 tr(WHW.T) 2392.716552734375
bpp_loss 3.888241790061773
11_down proxy err 0.0074097635224461555 tr(WHW.T) 56.13530731201172
bpp_loss 3.7921099773673124
W0320 17:36:55.065068 1505929 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:36:55.069083 1504852 quantize_finetune_llama.py:203] layer 14 gpu 2
I0320 17:36:55.083488 1505929 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:36:56.385767 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 0.8766360282897949s
I0320 17:37:00.135190 1505988 config.py:54] PyTorch version 2.6.0 available.
W0320 17:37:00.459808 1505988 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:37:01.384185 1505988 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:37:01.388281 1504852 quantize_finetune_llama.py:203] layer 15 gpu 3
I0320 17:37:01.404028 1505988 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:37:02.700214 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 0.8955175876617432s
I0320 17:37:06.751059 1506047 config.py:54] PyTorch version 2.6.0 available.
W0320 17:37:07.097669 1506047 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:37:08.183553 1506047 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:37:08.187766 1504852 quantize_finetune_llama.py:203] layer 16 gpu 0
I0320 17:37:08.205261 1506047 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.007505022455006838 tr(WHW.T) 703.318603515625
bpp_loss 3.6154316663742065
12_q proxy err 0.0008797362097539008 tr(WHW.T) 7045.6435546875
bpp_loss 4.2261903285980225
12_k proxy err 0.0006185699021443725 tr(WHW.T) 10893.65625
bpp_loss 4.276978492736816
12_o proxy err 0.01373379398137331 tr(WHW.T) 39.29071044921875
bpp_loss 3.59284508228302
12_up proxy err 0.004938792437314987 tr(WHW.T) 1228.298583984375
bpp_loss 3.831962230593659
12_gate proxy err 0.0026179736014455557 tr(WHW.T) 2381.994873046875
bpp_loss 3.8818955532340116
12_down proxy err 0.0073798643425107 tr(WHW.T) 64.17745208740234
bpp_loss 3.8018639143123183
13_v proxy err 0.00767852645367384 tr(WHW.T) 714.5677490234375
bpp_loss 3.650740146636963
13_q proxy err 0.0009087577345781028 tr(WHW.T) 6956.03564453125
bpp_loss 4.2190001010894775
13_k proxy err 0.000656892778351903 tr(WHW.T) 10426.6318359375
bpp_loss 4.249396324157715
13_o proxy err 0.012252087704837322 tr(WHW.T) 45.8377571105957
bpp_loss 3.6221121549606323
13_up proxy err 0.00474219536408782 tr(WHW.T) 1367.6221923828125
bpp_loss 3.8445438118868096
13_gate proxy err 0.002558730076998472 tr(WHW.T) 2601.504638671875
bpp_loss 3.877988416095113
13_down proxy err 0.007385049015283585 tr(WHW.T) 79.3589096069336
bpp_loss 3.8110605506009834
I0320 17:37:40.566994 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 0.8972616195678711s
I0320 17:37:44.243743 1506145 config.py:54] PyTorch version 2.6.0 available.
14_v proxy err 0.008022173307836056 tr(WHW.T) 706.1612548828125
bpp_loss 3.643521785736084
14_q proxy err 0.0009147159871645272 tr(WHW.T) 7077.06103515625
bpp_loss 4.228405952453613
14_k proxy err 0.0006286509451456368 tr(WHW.T) 11295.16796875
bpp_loss 4.263707399368286
14_o proxy err 0.01368984580039978 tr(WHW.T) 50.921180725097656
bpp_loss 3.604910969734192
14_up proxy err 0.0048429337330162525 tr(WHW.T) 1464.7159423828125
bpp_loss 3.846486823503361
14_gate proxy err 0.0027017169632017612 tr(WHW.T) 2682.584716796875
bpp_loss 3.875813683798147
14_down proxy err 0.0075584519654512405 tr(WHW.T) 90.28684997558594
bpp_loss 3.812439186628475
W0320 17:37:44.576864 1506145 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:37:45.561759 1506145 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:37:45.566509 1504852 quantize_finetune_llama.py:203] layer 17 gpu 1
I0320 17:37:45.583677 1506145 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:37:47.100511 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.0438544750213623s
I0320 17:37:50.920414 1506204 config.py:54] PyTorch version 2.6.0 available.
15_v proxy err 0.007218244019895792 tr(WHW.T) 762.7275390625
bpp_loss 3.6769282817840576
15_q proxy err 0.0008750410634092987 tr(WHW.T) 7252.0009765625
bpp_loss 4.211461067199707
15_k proxy err 0.0006202367949299514 tr(WHW.T) 11072.3974609375
bpp_loss 4.267405033111572
15_o proxy err 0.011384672485291958 tr(WHW.T) 59.61664962768555
bpp_loss 3.6393508911132812
15_up proxy err 0.004696582444012165 tr(WHW.T) 1641.0228271484375
bpp_loss 3.854123137718023
15_gate proxy err 0.002701791236177087 tr(WHW.T) 2905.140380859375
bpp_loss 3.8831059655477835
15_down proxy err 0.007516318932175636 tr(WHW.T) 114.09001922607422
bpp_loss 3.8164917923683346
W0320 17:37:51.233153 1506204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:37:52.142907 1506204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:37:52.147052 1504852 quantize_finetune_llama.py:203] layer 18 gpu 2
I0320 17:37:52.163340 1506204 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:37:53.377516 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.8111369609832764s
I0320 17:37:57.230426 1506263 config.py:54] PyTorch version 2.6.0 available.
W0320 17:37:57.559134 1506263 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:37:58.555926 1506263 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:37:58.560587 1504852 quantize_finetune_llama.py:203] layer 19 gpu 3
I0320 17:37:58.576913 1506263 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:37:59.901955 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 0.9017064571380615s
I0320 17:38:03.885964 1506322 config.py:54] PyTorch version 2.6.0 available.
W0320 17:38:04.242385 1506322 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:38:05.317722 1506322 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:38:05.322077 1504852 quantize_finetune_llama.py:203] layer 20 gpu 0
I0320 17:38:05.337220 1506322 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.00740042794495821 tr(WHW.T) 780.7407836914062
bpp_loss 3.7308017015457153
16_q proxy err 0.0009022184531204402 tr(WHW.T) 7193.3974609375
bpp_loss 4.212730169296265
16_k proxy err 0.0006087599322199821 tr(WHW.T) 11630.361328125
bpp_loss 4.259861469268799
16_o proxy err 0.008917207829654217 tr(WHW.T) 88.22785186767578
bpp_loss 3.68117094039917
16_up proxy err 0.004682573024183512 tr(WHW.T) 1890.9385986328125
bpp_loss 3.854224448980287
16_gate proxy err 0.0026736499276012182 tr(WHW.T) 3369.859130859375
bpp_loss 3.8927308903184046
16_down proxy err 0.007550544571131468 tr(WHW.T) 152.0294952392578
bpp_loss 3.816517896430437
17_v proxy err 0.006830341648310423 tr(WHW.T) 845.7654418945312
bpp_loss 3.7840267419815063
17_q proxy err 0.0008960335399024189 tr(WHW.T) 7163.2734375
bpp_loss 4.296354055404663
17_k proxy err 0.0006394466618075967 tr(WHW.T) 10697.431640625
bpp_loss 4.335733413696289
17_o proxy err 0.009829294867813587 tr(WHW.T) 58.14826965332031
bpp_loss 3.6801708936691284
17_up proxy err 0.005201347172260284 tr(WHW.T) 1921.07861328125
bpp_loss 3.848060075626817
17_gate proxy err 0.002835470251739025 tr(WHW.T) 3571.31640625
bpp_loss 3.902998635935229
17_down proxy err 0.007566533517092466 tr(WHW.T) 165.43495178222656
bpp_loss 3.815402164015659
I0320 17:38:37.688497 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 0.9044961929321289s
I0320 17:38:41.439513 1506423 config.py:54] PyTorch version 2.6.0 available.
W0320 17:38:41.769611 1506423 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.004912002012133598 tr(WHW.T) 1003.7705078125
bpp_loss 4.0516674518585205
18_q proxy err 0.0007442781352438033 tr(WHW.T) 7510.48046875
bpp_loss 4.566597938537598
18_k proxy err 0.0005690946709364653 tr(WHW.T) 10462.6650390625
bpp_loss 4.606999158859253
18_o proxy err 0.008406756445765495 tr(WHW.T) 69.96558380126953
bpp_loss 3.720171809196472
18_up proxy err 0.005552688613533974 tr(WHW.T) 2023.183837890625
bpp_loss 3.844894231751908
18_gate proxy err 0.0030122234020382166 tr(WHW.T) 3783.076416015625
bpp_loss 3.9147988252861556
18_down proxy err 0.007469498552381992 tr(WHW.T) 198.52699279785156
bpp_loss 3.815280847771223
W0320 17:38:42.748886 1506423 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:38:42.753098 1504852 quantize_finetune_llama.py:203] layer 21 gpu 1
I0320 17:38:42.768193 1506423 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:38:44.140691 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 0.9252035617828369s
I0320 17:38:47.970907 1506479 config.py:54] PyTorch version 2.6.0 available.
W0320 17:38:48.299978 1506479 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.004825064446777105 tr(WHW.T) 1019.1412353515625
bpp_loss 4.064368963241577
19_q proxy err 0.0007952787564136088 tr(WHW.T) 6944.4130859375
bpp_loss 4.533786058425903
19_k proxy err 0.0005705012590624392 tr(WHW.T) 10548.4892578125
bpp_loss 4.571469068527222
19_o proxy err 0.008487466722726822 tr(WHW.T) 62.291683197021484
bpp_loss 3.7309402227401733
19_up proxy err 0.005591934081166983 tr(WHW.T) 2149.330322265625
bpp_loss 3.8472180033839027
19_gate proxy err 0.003305047284811735 tr(WHW.T) 3687.5126953125
bpp_loss 3.92287746695585
19_down proxy err 0.007298497948795557 tr(WHW.T) 222.93177795410156
bpp_loss 3.817881184954976
W0320 17:38:49.268347 1506479 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:38:49.272535 1504852 quantize_finetune_llama.py:203] layer 22 gpu 2
I0320 17:38:49.288392 1506479 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:38:50.569022 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 0.8573024272918701s
I0320 17:38:54.342061 1506538 config.py:54] PyTorch version 2.6.0 available.
W0320 17:38:54.651793 1506538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:38:55.567333 1506538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:38:55.570994 1504852 quantize_finetune_llama.py:203] layer 23 gpu 3
I0320 17:38:55.585356 1506538 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:38:57.058978 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.028153896331787s
I0320 17:39:00.986528 1506597 config.py:54] PyTorch version 2.6.0 available.
W0320 17:39:01.339777 1506597 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:39:02.392739 1506597 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:39:02.396794 1504852 quantize_finetune_llama.py:203] layer 24 gpu 0
I0320 17:39:02.413467 1506597 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.004740479867905378 tr(WHW.T) 990.5983276367188
bpp_loss 4.133100509643555
20_q proxy err 0.0007489709532819688 tr(WHW.T) 7150.947265625
bpp_loss 4.6014792919158936
20_k proxy err 0.0005595993716269732 tr(WHW.T) 10386.2470703125
bpp_loss 4.637406826019287
20_o proxy err 0.006218489725142717 tr(WHW.T) 100.31707000732422
bpp_loss 3.7521355152130127
20_up proxy err 0.0055100335739552975 tr(WHW.T) 2340.89453125
bpp_loss 3.84612167713254
20_gate proxy err 0.003243959043174982 tr(WHW.T) 4024.62744140625
bpp_loss 3.9300794379655706
20_down proxy err 0.007106982637196779 tr(WHW.T) 274.8815002441406
bpp_loss 3.818936126176701
21_v proxy err 0.004064597655087709 tr(WHW.T) 1144.5655517578125
bpp_loss 4.277987957000732
21_q proxy err 0.0007516400655731559 tr(WHW.T) 7064.314453125
bpp_loss 4.667463541030884
21_k proxy err 0.000570788630284369 tr(WHW.T) 9976.4658203125
bpp_loss 4.687987327575684
21_o proxy err 0.006729930639266968 tr(WHW.T) 75.50972747802734
bpp_loss 3.776288390159607
21_up proxy err 0.00580971036106348 tr(WHW.T) 2361.650390625
bpp_loss 3.843965929608012
21_gate proxy err 0.003468727460131049 tr(WHW.T) 4004.37646484375
bpp_loss 3.9388315954873727
21_down proxy err 0.00729038380086422 tr(WHW.T) 276.5857849121094
bpp_loss 3.818366205969522
I0320 17:39:34.700582 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 0.8940179347991943s
I0320 17:39:38.349567 1506698 config.py:54] PyTorch version 2.6.0 available.
W0320 17:39:38.660405 1506698 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.00383370160125196 tr(WHW.T) 1243.2529296875
bpp_loss 4.288894414901733
22_q proxy err 0.0007070876308716834 tr(WHW.T) 7746.84765625
bpp_loss 4.731000661849976
22_k proxy err 0.0005524644511751831 tr(WHW.T) 10603.2041015625
bpp_loss 4.756588697433472
22_o proxy err 0.005656085908412933 tr(WHW.T) 114.30065155029297
bpp_loss 3.775463581085205
22_up proxy err 0.005842961370944977 tr(WHW.T) 2474.510498046875
bpp_loss 3.845813662506813
22_gate proxy err 0.003524464089423418 tr(WHW.T) 4156.64013671875
bpp_loss 3.949647592943768
22_down proxy err 0.0072269132360816 tr(WHW.T) 311.8800048828125
bpp_loss 3.8193220315977583
W0320 17:39:39.601776 1506698 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:39:39.605811 1504852 quantize_finetune_llama.py:203] layer 25 gpu 1
I0320 17:39:39.620182 1506698 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:39:40.951166 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 0.8575301170349121s
I0320 17:39:44.672542 1506754 config.py:54] PyTorch version 2.6.0 available.
W0320 17:39:45.007685 1506754 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.0035732118412852287 tr(WHW.T) 1486.037353515625
bpp_loss 4.390946626663208
23_q proxy err 0.0008155844989232719 tr(WHW.T) 7346.60986328125
bpp_loss 4.74250602722168
23_k proxy err 0.0006362937856465578 tr(WHW.T) 9982.2392578125
bpp_loss 4.75816535949707
23_o proxy err 0.006667091511189938 tr(WHW.T) 85.13458251953125
bpp_loss 3.8372554779052734
23_up proxy err 0.0060334946028888226 tr(WHW.T) 2533.51025390625
bpp_loss 3.8544710735942043
23_gate proxy err 0.003775048302486539 tr(WHW.T) 4097.51953125
bpp_loss 3.9529337328533796
23_down proxy err 0.007262523286044598 tr(WHW.T) 321.33892822265625
bpp_loss 3.825976305229719
W0320 17:39:45.939624 1506754 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:39:45.943341 1504852 quantize_finetune_llama.py:203] layer 26 gpu 2
I0320 17:39:45.956985 1506754 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:39:47.397445 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 0.8388938903808594s
I0320 17:39:51.038989 1506813 config.py:54] PyTorch version 2.6.0 available.
W0320 17:39:51.377400 1506813 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:39:52.350443 1506813 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:39:52.354466 1504852 quantize_finetune_llama.py:203] layer 27 gpu 3
I0320 17:39:52.376508 1506813 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:39:53.738070 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 0.9734299182891846s
I0320 17:39:57.674086 1506872 config.py:54] PyTorch version 2.6.0 available.
W0320 17:39:58.023036 1506872 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:39:59.094559 1506872 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:39:59.098829 1504852 quantize_finetune_llama.py:203] layer 28 gpu 0
I0320 17:39:59.116596 1506872 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.0036971906665712595 tr(WHW.T) 1394.900634765625
bpp_loss 4.369882106781006
24_q proxy err 0.000820410146843642 tr(WHW.T) 7020.447265625
bpp_loss 4.648888111114502
24_k proxy err 0.000612989766523242 tr(WHW.T) 10323.43359375
bpp_loss 4.657242059707642
24_o proxy err 0.005125853233039379 tr(WHW.T) 133.98797607421875
bpp_loss 3.821428894996643
24_up proxy err 0.006065269000828266 tr(WHW.T) 2621.76513671875
bpp_loss 3.86754501697629
24_gate proxy err 0.0037708000745624304 tr(WHW.T) 4262.74853515625
bpp_loss 3.966377435728561
24_down proxy err 0.007182355038821697 tr(WHW.T) 340.22412109375
bpp_loss 3.8312509004459825
25_v proxy err 0.0033454089425504208 tr(WHW.T) 1707.664794921875
bpp_loss 4.559191942214966
25_q proxy err 0.0008822614909149706 tr(WHW.T) 7162.16357421875
bpp_loss 4.815589904785156
25_k proxy err 0.0006862044101580977 tr(WHW.T) 9611.58984375
bpp_loss 4.822749137878418
25_o proxy err 0.006341410335153341 tr(WHW.T) 83.535888671875
bpp_loss 3.869811177253723
25_up proxy err 0.00567007577046752 tr(WHW.T) 2805.728515625
bpp_loss 3.9284194236577945
25_gate proxy err 0.0034521634224802256 tr(WHW.T) 4666.4404296875
bpp_loss 4.030154738315316
25_down proxy err 0.006929675117135048 tr(WHW.T) 373.460693359375
bpp_loss 3.8403485985689385
I0320 17:40:30.904990 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 0.903691291809082s
I0320 17:40:34.645905 1506970 config.py:54] PyTorch version 2.6.0 available.
W0320 17:40:34.996868 1506970 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.0033395870123058558 tr(WHW.T) 1668.8843994140625
bpp_loss 4.530550003051758
26_q proxy err 0.0008312485297210515 tr(WHW.T) 7469.98291015625
bpp_loss 4.716678619384766
26_k proxy err 0.0006296037463471293 tr(WHW.T) 10487.8740234375
bpp_loss 4.7325074672698975
26_o proxy err 0.004185800906270742 tr(WHW.T) 202.88172912597656
bpp_loss 3.894237518310547
26_up proxy err 0.004487534053623676 tr(WHW.T) 3154.75146484375
bpp_loss 4.090546541435774
26_gate proxy err 0.0027092820964753628 tr(WHW.T) 5302.16455078125
bpp_loss 4.205905648164971
26_down proxy err 0.0072377887554466724 tr(WHW.T) 401.19390869140625
bpp_loss 3.845283308694529
W0320 17:40:36.046674 1506970 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:40:36.051079 1504852 quantize_finetune_llama.py:203] layer 29 gpu 1
I0320 17:40:36.066561 1506970 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:40:37.633610 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 0.9560120105743408s
I0320 17:40:41.383539 1507029 config.py:54] PyTorch version 2.6.0 available.
W0320 17:40:41.714487 1507029 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.003151312004774809 tr(WHW.T) 1799.3350830078125
bpp_loss 4.587735891342163
27_q proxy err 0.0008106260211206973 tr(WHW.T) 7691.708984375
bpp_loss 4.875518798828125
27_k proxy err 0.0006094542914070189 tr(WHW.T) 10618.70703125
bpp_loss 4.901391983032227
27_o proxy err 0.005718524567782879 tr(WHW.T) 126.13690185546875
bpp_loss 3.908113121986389
27_up proxy err 0.003229927271604538 tr(WHW.T) 3691.557861328125
bpp_loss 4.290739369946857
27_gate proxy err 0.0020276836585253477 tr(WHW.T) 5990.82568359375
bpp_loss 4.415251266124637
27_down proxy err 0.006971252150833607 tr(WHW.T) 466.9318542480469
bpp_loss 3.8629520771115327
W0320 17:40:42.628305 1507029 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:40:42.632438 1504852 quantize_finetune_llama.py:203] layer 30 gpu 2
I0320 17:40:42.650038 1507029 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:40:43.973743 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 0.9177746772766113s
I0320 17:40:47.742461 1507088 config.py:54] PyTorch version 2.6.0 available.
W0320 17:40:48.070090 1507088 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:40:49.075435 1507088 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:40:49.079422 1504852 quantize_finetune_llama.py:203] layer 31 gpu 3
I0320 17:40:49.093684 1507088 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 17:40:50.327150 1504852 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 0.8389854431152344s
I0320 17:40:54.374894 1507147 config.py:54] PyTorch version 2.6.0 available.
W0320 17:40:54.730983 1507147 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 17:40:55.779833 1507147 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 17:40:55.799035 1507147 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.002729024738073349 tr(WHW.T) 2018.944091796875
bpp_loss 4.839526176452637
28_q proxy err 0.0007937324116937816 tr(WHW.T) 7651.126953125
bpp_loss 4.996570348739624
28_k proxy err 0.000601328385528177 tr(WHW.T) 10544.8251953125
bpp_loss 5.0287816524505615
28_o proxy err 0.004707372281700373 tr(WHW.T) 194.8240966796875
bpp_loss 3.9471386671066284
28_up proxy err 0.002473143395036459 tr(WHW.T) 4661.2666015625
bpp_loss 4.3763252080873
28_gate proxy err 0.0017910337774083018 tr(WHW.T) 6547.48193359375
bpp_loss 4.477615711300872
28_down proxy err 0.00622887909412384 tr(WHW.T) 603.8403930664062
bpp_loss 3.8955014694568724
29_v proxy err 0.0031015321146696806 tr(WHW.T) 1801.7730712890625
bpp_loss 4.619523763656616
29_q proxy err 0.0008477282244712114 tr(WHW.T) 7227.0009765625
bpp_loss 4.6832451820373535
29_k proxy err 0.0006124071660451591 tr(WHW.T) 10558.609375
bpp_loss 4.7065393924713135
29_o proxy err 0.004125512205064297 tr(WHW.T) 207.9054412841797
bpp_loss 3.959160566329956
29_up proxy err 0.001955704065039754 tr(WHW.T) 6070.0498046875
bpp_loss 4.409024615620458
29_gate proxy err 0.0016289361519739032 tr(WHW.T) 7369.6142578125
bpp_loss 4.497716859329579
29_down proxy err 0.005439681466668844 tr(WHW.T) 782.2448120117188
bpp_loss 3.9471924582193063
30_v proxy err 0.002513400511816144 tr(WHW.T) 2261.489501953125
bpp_loss 4.843739032745361
30_q proxy err 0.0007992431055754423 tr(WHW.T) 7815.9453125
bpp_loss 4.8846435546875
30_k proxy err 0.0006164018413983285 tr(WHW.T) 10521.625
bpp_loss 4.923952341079712
30_o proxy err 0.003992271143943071 tr(WHW.T) 251.96908569335938
bpp_loss 4.0019451379776
30_up proxy err 0.0012250562431290746 tr(WHW.T) 10016.376953125
bpp_loss 4.4319033955418785
30_gate proxy err 0.0011227285722270608 tr(WHW.T) 11001.119140625
bpp_loss 4.534001195153524
30_down proxy err 0.0017334532458335161 tr(WHW.T) 3582.617919921875
bpp_loss 4.045468729595806
31_v proxy err 0.003492057090625167 tr(WHW.T) 1268.2034912109375
bpp_loss 4.345358610153198
31_q proxy err 0.0007371220854111016 tr(WHW.T) 6858.09130859375
bpp_loss 4.598567247390747
31_k proxy err 0.0005196222919039428 tr(WHW.T) 10233.677734375
bpp_loss 4.668623447418213
31_o proxy err 0.0024276841431856155 tr(WHW.T) 457.7950744628906
bpp_loss 3.948493003845215
31_up proxy err 0.0010929155396297574 tr(WHW.T) 14563.890625
bpp_loss 4.095482582269713
31_gate proxy err 0.0010756916599348187 tr(WHW.T) 14836.2939453125
bpp_loss 4.1820219172987825
31_down proxy err 0.0007090877625159919 tr(WHW.T) 17873.55859375
bpp_loss 4.236065731492153
I0320 17:41:47.773571 1507269 config.py:54] PyTorch version 2.6.0 available.
W0320 17:41:48.070979 1507269 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0320 17:41:48.307971 1507269 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Llama-2-7b-hf",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "max_position_embeddings": 4096,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 32000
}

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  8.87it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  9.92it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  9.54it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.08it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  9.90it/s]
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00, 10.18it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00, 10.23it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.22it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.21it/s]
I0320 17:41:51.528171 1507269 hfize_llama.py:153] loaded layer 0
I0320 17:41:53.021294 1507269 hfize_llama.py:153] loaded layer 1
I0320 17:41:54.649018 1507269 hfize_llama.py:153] loaded layer 2
I0320 17:41:56.308326 1507269 hfize_llama.py:153] loaded layer 3
I0320 17:41:57.877999 1507269 hfize_llama.py:153] loaded layer 4
I0320 17:41:59.494255 1507269 hfize_llama.py:153] loaded layer 5
I0320 17:42:01.055312 1507269 hfize_llama.py:153] loaded layer 6
I0320 17:42:02.719850 1507269 hfize_llama.py:153] loaded layer 7
I0320 17:42:04.375700 1507269 hfize_llama.py:153] loaded layer 8
I0320 17:42:06.019451 1507269 hfize_llama.py:153] loaded layer 9
I0320 17:42:07.703598 1507269 hfize_llama.py:153] loaded layer 10
I0320 17:42:09.301710 1507269 hfize_llama.py:153] loaded layer 11
I0320 17:42:10.954238 1507269 hfize_llama.py:153] loaded layer 12
I0320 17:42:12.629716 1507269 hfize_llama.py:153] loaded layer 13
I0320 17:42:14.304564 1507269 hfize_llama.py:153] loaded layer 14
I0320 17:42:15.999182 1507269 hfize_llama.py:153] loaded layer 15
I0320 17:42:17.627329 1507269 hfize_llama.py:153] loaded layer 16
I0320 17:42:19.326843 1507269 hfize_llama.py:153] loaded layer 17
I0320 17:42:21.041247 1507269 hfize_llama.py:153] loaded layer 18
I0320 17:42:22.755522 1507269 hfize_llama.py:153] loaded layer 19
I0320 17:42:24.410033 1507269 hfize_llama.py:153] loaded layer 20
I0320 17:42:26.054952 1507269 hfize_llama.py:153] loaded layer 21
I0320 17:42:27.733625 1507269 hfize_llama.py:153] loaded layer 22
I0320 17:42:29.345991 1507269 hfize_llama.py:153] loaded layer 23
I0320 17:42:30.922238 1507269 hfize_llama.py:153] loaded layer 24
I0320 17:42:32.473661 1507269 hfize_llama.py:153] loaded layer 25
I0320 17:42:34.046265 1507269 hfize_llama.py:153] loaded layer 26
I0320 17:42:35.613592 1507269 hfize_llama.py:153] loaded layer 27
I0320 17:42:37.126614 1507269 hfize_llama.py:153] loaded layer 28
I0320 17:42:38.685119 1507269 hfize_llama.py:153] loaded layer 29
I0320 17:42:40.191256 1507269 hfize_llama.py:153] loaded layer 30
I0320 17:42:41.728526 1507269 hfize_llama.py:153] loaded layer 31
I0320 17:42:41.728717 1507269 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:05,  1.06s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.07it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.11it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.14it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.14it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.20it/s]
I0320 17:43:19.029268 1507269 hfize_llama.py:167] successfully loaded hfized model
