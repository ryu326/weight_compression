I0323 16:31:36.955390 3888047 config.py:54] PyTorch version 2.6.0 available.
W0323 16:31:37.239467 3888047 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:31:38.120442 3888047 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.01it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.71it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.95it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.13it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.24it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.12it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.00it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.98it/s]
I0323 16:31:39.579884 3888047 quantize_finetune_llama.py:150] loaded model
I0323 16:31:39.858252 3888047 quantize_finetune_llama.py:185] loaded compression model
I0323 16:31:57.895524 3888047 quantize_finetune_llama.py:189] loaded dataset and devset
I0323 16:32:03.011143 3888047 quantize_finetune_llama.py:209] layer 0 gpu 0
I0323 16:32:05.341250 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 2.1836097240448s
Use train scale and shift
tensor(8.8814e-08, device='cuda:0') tensor(0.0134, device='cuda:0')
tensor(0.0134, device='cuda:0') tensor(8.8814e-08, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0323 16:32:18.501880 3888860 config.py:54] PyTorch version 2.6.0 available.
W0323 16:32:18.781988 3888860 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:32:19.648947 3888860 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:32:19.652843 3888047 quantize_finetune_llama.py:209] layer 1 gpu 1
I0323 16:32:19.794903 3888860 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:32:22.102702 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 2.277747869491577s
I0323 16:32:25.763520 3889012 config.py:54] PyTorch version 2.6.0 available.
W0323 16:32:26.065413 3889012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:32:26.996575 3889012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:32:27.000701 3888047 quantize_finetune_llama.py:209] layer 2 gpu 2
I0323 16:32:27.153601 3889012 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:32:30.250427 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 3.094933271408081s
I0323 16:32:33.898492 3889220 config.py:54] PyTorch version 2.6.0 available.
W0323 16:32:34.214632 3889220 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:32:35.193996 3889220 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:32:35.198240 3888047 quantize_finetune_llama.py:209] layer 3 gpu 3
I0323 16:32:35.401722 3889220 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:32:38.112615 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 2.7658417224884033s
I0323 16:32:42.022960 3889408 config.py:54] PyTorch version 2.6.0 available.
W0323 16:32:42.383539 3889408 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:32:43.584406 3889408 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:32:43.588847 3888047 quantize_finetune_llama.py:209] layer 4 gpu 0
I0323 16:32:43.754321 3889408 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.06257936358451843 tr(WHW.T) 59.109249114990234
bpp_loss 3.720215082168579
0_q proxy err 0.004228309262543917 tr(WHW.T) 288041.78125
bpp_loss 2.3009226322174072
0_k proxy err 0.0015007653273642063 tr(WHW.T) 100152.8671875
bpp_loss 3.6946728229522705
0_o proxy err 0.02089676819741726 tr(WHW.T) 3113.9609375
bpp_loss 2.3439136743545532
0_up proxy err 0.11953314393758774 tr(WHW.T) 8859.7275390625
bpp_loss 1.6836912972586495
0_gate proxy err 0.08768749237060547 tr(WHW.T) 15700.0
bpp_loss 1.6836754253932409
0_down proxy err 0.038395486772060394 tr(WHW.T) 10753.7939453125
bpp_loss 2.3484983103615895
1_v proxy err 0.04955342039465904 tr(WHW.T) 106.54676055908203
bpp_loss 3.7186672687530518
1_q proxy err 0.005659676156938076 tr(WHW.T) 144769.71875
bpp_loss 2.329316258430481
1_k proxy err 0.0016310116043314338 tr(WHW.T) 75510.046875
bpp_loss 3.702528953552246
1_o proxy err 0.03880665451288223 tr(WHW.T) 1971.8739013671875
bpp_loss 2.348097562789917
1_up proxy err 0.13145525753498077 tr(WHW.T) 8164.14208984375
bpp_loss 1.6837143898010254
1_gate proxy err 0.0988285019993782 tr(WHW.T) 13871.78125
bpp_loss 1.6837053980146135
1_down proxy err 0.01517577189952135 tr(WHW.T) 13911.810546875
bpp_loss 1.7088966880525862
I0323 16:33:38.892433 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 1.0407867431640625s
I0323 16:33:42.789638 3890488 config.py:54] PyTorch version 2.6.0 available.
W0323 16:33:43.129585 3890488 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:33:44.123416 3890488 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:33:44.127732 3888047 quantize_finetune_llama.py:209] layer 5 gpu 1
I0323 16:33:44.410324 3890488 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.02449791133403778 tr(WHW.T) 154.1771240234375
bpp_loss 3.720945119857788
2_q proxy err 0.011144286952912807 tr(WHW.T) 41423.8046875
bpp_loss 2.3445969820022583
2_k proxy err 0.0034374273382127285 tr(WHW.T) 22584.275390625
bpp_loss 3.7174737453460693
2_o proxy err 0.03359837457537651 tr(WHW.T) 1957.195556640625
bpp_loss 2.346716523170471
2_up proxy err 0.13972140848636627 tr(WHW.T) 7534.43212890625
bpp_loss 1.68373932157244
2_gate proxy err 0.09686611592769623 tr(WHW.T) 15028.0859375
bpp_loss 1.683654717036656
2_down proxy err 0.05362791195511818 tr(WHW.T) 7660.255859375
bpp_loss 2.3486123425619945
I0323 16:33:47.769631 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 0.9925844669342041s
I0323 16:33:51.630990 3890666 config.py:54] PyTorch version 2.6.0 available.
W0323 16:33:51.961538 3890666 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:33:52.943627 3890666 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:33:52.947868 3888047 quantize_finetune_llama.py:209] layer 6 gpu 2
I0323 16:33:53.133015 3890666 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.018817605450749397 tr(WHW.T) 286.8193664550781
bpp_loss 3.723039984703064
3_q proxy err 0.010161520913243294 tr(WHW.T) 47525.1171875
bpp_loss 2.344227433204651
3_k proxy err 0.003081818111240864 tr(WHW.T) 26144.298828125
bpp_loss 3.715970754623413
3_o proxy err 0.04506199434399605 tr(WHW.T) 1843.92529296875
bpp_loss 2.348053216934204
3_up proxy err 0.13626839220523834 tr(WHW.T) 7472.86376953125
bpp_loss 1.6837419782366072
3_gate proxy err 0.08225716650485992 tr(WHW.T) 20788.29296875
bpp_loss 1.6836111204964774
3_down proxy err 0.05622950941324234 tr(WHW.T) 6935.24755859375
bpp_loss 2.348592894417899
I0323 16:33:56.028287 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.9766671657562256s
I0323 16:33:59.676938 3890870 config.py:54] PyTorch version 2.6.0 available.
W0323 16:34:00.004819 3890870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:34:00.976495 3890870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:34:00.980802 3888047 quantize_finetune_llama.py:209] layer 7 gpu 3
I0323 16:34:01.190923 3890870 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:34:02.451809 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 0.9716253280639648s
I0323 16:34:06.269131 3891040 config.py:54] PyTorch version 2.6.0 available.
W0323 16:34:06.609458 3891040 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:34:07.586320 3891040 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:34:07.590535 3888047 quantize_finetune_llama.py:209] layer 8 gpu 0
I0323 16:34:07.766201 3891040 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.022052422165870667 tr(WHW.T) 282.38128662109375
bpp_loss 3.722913980484009
4_q proxy err 0.009709821082651615 tr(WHW.T) 50064.37109375
bpp_loss 2.3440457582473755
4_k proxy err 0.002751496620476246 tr(WHW.T) 29272.75390625
bpp_loss 3.7149531841278076
4_o proxy err 0.06555678695440292 tr(WHW.T) 1283.4017333984375
bpp_loss 2.34794282913208
4_up proxy err 0.1326260268688202 tr(WHW.T) 7323.07763671875
bpp_loss 1.6837002890450614
4_gate proxy err 0.06928817182779312 tr(WHW.T) 29023.8984375
bpp_loss 1.6834310804094588
4_down proxy err 0.058280203491449356 tr(WHW.T) 6335.5126953125
bpp_loss 2.34859037399292
5_v proxy err 0.02071257494390011 tr(WHW.T) 206.8122100830078
bpp_loss 3.722284436225891
5_q proxy err 0.011853344738483429 tr(WHW.T) 35941.703125
bpp_loss 2.3439488410949707
5_k proxy err 0.0033654626458883286 tr(WHW.T) 22968.27734375
bpp_loss 3.7150747776031494
5_o proxy err 0.06883697956800461 tr(WHW.T) 1043.734619140625
bpp_loss 2.3480218648910522
5_up proxy err 0.12976327538490295 tr(WHW.T) 7595.3154296875
bpp_loss 1.6836975642613001
5_gate proxy err 0.06691783666610718 tr(WHW.T) 30279.96875
bpp_loss 1.6834003584725517
5_down proxy err 0.05868414789438248 tr(WHW.T) 6350.38623046875
bpp_loss 2.348701238632202
I0323 16:35:05.257324 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.2667183876037598s
I0323 16:35:09.227519 3892071 config.py:54] PyTorch version 2.6.0 available.
W0323 16:35:09.579725 3892071 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:35:10.593729 3892071 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:35:10.598045 3888047 quantize_finetune_llama.py:209] layer 9 gpu 1
I0323 16:35:10.825684 3892071 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.020270707085728645 tr(WHW.T) 251.2519073486328
bpp_loss 3.72304368019104
6_q proxy err 0.012296168133616447 tr(WHW.T) 35587.6171875
bpp_loss 2.3446003198623657
6_k proxy err 0.0030150404199957848 tr(WHW.T) 26134.267578125
bpp_loss 3.716430902481079
6_o proxy err 0.07783909887075424 tr(WHW.T) 996.2373657226562
bpp_loss 2.3479124307632446
6_up proxy err 0.1260438859462738 tr(WHW.T) 7862.4482421875
bpp_loss 1.6835616656712122
6_gate proxy err 0.05985657870769501 tr(WHW.T) 35640.2578125
bpp_loss 1.6833716801234655
6_down proxy err 0.057938817888498306 tr(WHW.T) 6422.8779296875
bpp_loss 2.3485525335584367
I0323 16:35:13.399389 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 0.8753805160522461s
I0323 16:35:17.295969 3892269 config.py:54] PyTorch version 2.6.0 available.
W0323 16:35:17.620033 3892269 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.016414552927017212 tr(WHW.T) 307.0851135253906
bpp_loss 3.720686674118042
7_q proxy err 0.011789049953222275 tr(WHW.T) 35097.21875
bpp_loss 2.3444576263427734
7_k proxy err 0.0030485449824482203 tr(WHW.T) 26820.58203125
bpp_loss 3.7146852016448975
7_o proxy err 0.08452154695987701 tr(WHW.T) 945.8643798828125
bpp_loss 2.348415493965149
7_up proxy err 0.1198543980717659 tr(WHW.T) 8564.646484375
bpp_loss 1.6837409564426966
7_gate proxy err 0.05928013473749161 tr(WHW.T) 34799.35546875
bpp_loss 1.6832462038312639
7_down proxy err 0.059102121740579605 tr(WHW.T) 6472.18505859375
bpp_loss 2.348703043801444
W0323 16:35:18.598312 3892269 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:35:18.602133 3888047 quantize_finetune_llama.py:209] layer 10 gpu 2
I0323 16:35:18.768261 3892269 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:35:19.891401 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.8161191940307617s
I0323 16:35:23.622376 3892431 config.py:54] PyTorch version 2.6.0 available.
W0323 16:35:23.946861 3892431 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:35:24.903338 3892431 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:35:24.907431 3888047 quantize_finetune_llama.py:209] layer 11 gpu 3
I0323 16:35:25.104205 3892431 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:35:26.442590 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 1.0423893928527832s
I0323 16:35:30.312305 3892581 config.py:54] PyTorch version 2.6.0 available.
W0323 16:35:30.706080 3892581 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:35:31.862643 3892581 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:35:31.866782 3888047 quantize_finetune_llama.py:209] layer 12 gpu 0
I0323 16:35:32.229780 3892581 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.021624574437737465 tr(WHW.T) 255.12034606933594
bpp_loss 3.7219635248184204
8_q proxy err 0.014337918721139431 tr(WHW.T) 26552.91015625
bpp_loss 2.3434927463531494
8_k proxy err 0.003399799345061183 tr(WHW.T) 22499.31640625
bpp_loss 3.7141506671905518
8_o proxy err 0.1117032915353775 tr(WHW.T) 731.734619140625
bpp_loss 2.3482013940811157
8_up proxy err 0.12057745456695557 tr(WHW.T) 8432.8056640625
bpp_loss 1.6835983821323939
8_gate proxy err 0.056767143309116364 tr(WHW.T) 37132.96875
bpp_loss 1.6830436842782157
8_down proxy err 0.05908183008432388 tr(WHW.T) 6426.78076171875
bpp_loss 2.348649195262364
9_v proxy err 0.02138873189687729 tr(WHW.T) 347.93878173828125
bpp_loss 3.722123384475708
9_q proxy err 0.014624862000346184 tr(WHW.T) 25605.146484375
bpp_loss 2.342665195465088
9_k proxy err 0.0036500443238765 tr(WHW.T) 20913.2890625
bpp_loss 3.716655135154724
9_o proxy err 0.12264078855514526 tr(WHW.T) 760.7015380859375
bpp_loss 2.348322868347168
9_up proxy err 0.11693008244037628 tr(WHW.T) 8907.26953125
bpp_loss 1.683603150503976
9_gate proxy err 0.05569060146808624 tr(WHW.T) 39307.90625
bpp_loss 1.683112621307373
9_down proxy err 0.06141987815499306 tr(WHW.T) 6210.4736328125
bpp_loss 2.3486194610595703
I0323 16:36:30.454234 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 1.005235195159912s
I0323 16:36:34.394333 3893634 config.py:54] PyTorch version 2.6.0 available.
W0323 16:36:34.738160 3893634 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.021568812429904938 tr(WHW.T) 249.3217315673828
bpp_loss 3.7204490900039673
10_q proxy err 0.01624956540763378 tr(WHW.T) 23288.234375
bpp_loss 2.3444989919662476
10_k proxy err 0.0038531445898115635 tr(WHW.T) 19713.98828125
bpp_loss 3.7157870531082153
10_o proxy err 0.1194695308804512 tr(WHW.T) 667.1098022460938
bpp_loss 2.348188281059265
10_up proxy err 0.11751861870288849 tr(WHW.T) 9133.763671875
bpp_loss 1.6837186813354492
10_gate proxy err 0.055789366364479065 tr(WHW.T) 37296.734375
bpp_loss 1.6831630298069544
10_down proxy err 0.06074799224734306 tr(WHW.T) 6460.98828125
bpp_loss 2.34852739742824
W0323 16:36:35.900217 3893634 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:36:35.904525 3888047 quantize_finetune_llama.py:209] layer 13 gpu 1
I0323 16:36:36.083304 3893634 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:36:37.310324 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 0.9437403678894043s
I0323 16:36:41.150448 3893793 config.py:54] PyTorch version 2.6.0 available.
W0323 16:36:41.479087 3893793 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.016670774668455124 tr(WHW.T) 317.10748291015625
bpp_loss 3.7230926752090454
11_q proxy err 0.015407389961183071 tr(WHW.T) 22146.080078125
bpp_loss 2.3421519994735718
11_k proxy err 0.0040582045912742615 tr(WHW.T) 17998.236328125
bpp_loss 3.713374137878418
11_o proxy err 0.14999932050704956 tr(WHW.T) 551.7962036132812
bpp_loss 2.3482149839401245
11_up proxy err 0.11890274286270142 tr(WHW.T) 9126.3212890625
bpp_loss 1.6836588042122977
11_gate proxy err 0.055382173508405685 tr(WHW.T) 36783.98828125
bpp_loss 1.6829888480050224
11_down proxy err 0.06057332828640938 tr(WHW.T) 6590.6376953125
bpp_loss 2.3485284532819475
W0323 16:36:42.477805 3893793 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:36:42.481876 3888047 quantize_finetune_llama.py:209] layer 14 gpu 2
I0323 16:36:42.647046 3893793 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:36:44.212349 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 1.1245546340942383s
I0323 16:36:47.944603 3893975 config.py:54] PyTorch version 2.6.0 available.
W0323 16:36:48.261353 3893975 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:36:49.209453 3893975 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:36:49.213468 3888047 quantize_finetune_llama.py:209] layer 15 gpu 3
I0323 16:36:49.456430 3893975 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:36:50.618342 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.9624631404876709s
I0323 16:36:54.551227 3894132 config.py:54] PyTorch version 2.6.0 available.
W0323 16:36:54.908302 3894132 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:36:56.062766 3894132 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:36:56.067121 3888047 quantize_finetune_llama.py:209] layer 16 gpu 0
I0323 16:36:56.384468 3894132 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.020344221964478493 tr(WHW.T) 360.1876220703125
bpp_loss 3.721865653991699
12_q proxy err 0.011654961854219437 tr(WHW.T) 34056.6171875
bpp_loss 2.3435298204421997
12_k proxy err 0.003242031903937459 tr(WHW.T) 23029.2578125
bpp_loss 3.716037392616272
12_o proxy err 0.12156148999929428 tr(WHW.T) 763.9736938476562
bpp_loss 2.3480950593948364
12_up proxy err 0.11415603756904602 tr(WHW.T) 9958.251953125
bpp_loss 1.683586801801409
12_gate proxy err 0.05385651811957359 tr(WHW.T) 37236.3125
bpp_loss 1.6830833298819405
12_down proxy err 0.060801953077316284 tr(WHW.T) 6755.458984375
bpp_loss 2.348449570792062
13_v proxy err 0.022484000772237778 tr(WHW.T) 277.2203063964844
bpp_loss 3.721752405166626
13_q proxy err 0.01688356138765812 tr(WHW.T) 20850.333984375
bpp_loss 2.3436297178268433
13_k proxy err 0.004188124556094408 tr(WHW.T) 17769.017578125
bpp_loss 3.71555757522583
13_o proxy err 0.1337522715330124 tr(WHW.T) 660.1426391601562
bpp_loss 2.3480112552642822
13_up proxy err 0.11489000916481018 tr(WHW.T) 9940.990234375
bpp_loss 1.683621951511928
13_gate proxy err 0.05281592905521393 tr(WHW.T) 38823.03515625
bpp_loss 1.6831450462341309
13_down proxy err 0.06309249997138977 tr(WHW.T) 6493.29833984375
bpp_loss 2.348561934062413
I0323 16:37:53.811650 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 0.9930033683776855s
I0323 16:37:57.765690 3895175 config.py:54] PyTorch version 2.6.0 available.
W0323 16:37:58.113388 3895175 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:37:59.279033 3895175 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:37:59.283127 3888047 quantize_finetune_llama.py:209] layer 17 gpu 1
14_v proxy err 0.02204209752380848 tr(WHW.T) 278.4633483886719
bpp_loss 3.7218985557556152
14_q proxy err 0.016404209658503532 tr(WHW.T) 20836.7890625
bpp_loss 2.3445818424224854
14_k proxy err 0.003984068986028433 tr(WHW.T) 18589.970703125
bpp_loss 3.7166595458984375
14_o proxy err 0.13048921525478363 tr(WHW.T) 671.372314453125
bpp_loss 2.3484413623809814
14_up proxy err 0.12297609448432922 tr(WHW.T) 9095.5224609375
bpp_loss 1.6836145945957728
14_gate proxy err 0.052017007023096085 tr(WHW.T) 41682.6328125
bpp_loss 1.683330740247454
14_down proxy err 0.06437559425830841 tr(WHW.T) 6324.00830078125
bpp_loss 2.348578316824777
I0323 16:37:59.677748 3895175 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:38:01.783457 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.9916067123413086s
I0323 16:38:05.634107 3895351 config.py:54] PyTorch version 2.6.0 available.
15_v proxy err 0.02574266865849495 tr(WHW.T) 280.61700439453125
bpp_loss 3.7230114936828613
15_q proxy err 0.015197456814348698 tr(WHW.T) 28024.23046875
bpp_loss 2.3447288274765015
15_k proxy err 0.0038245778996497393 tr(WHW.T) 18843.171875
bpp_loss 3.7168489694595337
15_o proxy err 0.11651648581027985 tr(WHW.T) 811.894287109375
bpp_loss 2.348127245903015
15_up proxy err 0.12330593913793564 tr(WHW.T) 8926.90625
bpp_loss 1.6837078503199987
15_gate proxy err 0.050240207463502884 tr(WHW.T) 46109.49609375
bpp_loss 1.6832215445382255
15_down proxy err 0.06366226822137833 tr(WHW.T) 6333.17138671875
bpp_loss 2.3486872059958324
W0323 16:38:05.964427 3895351 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:38:06.871667 3895351 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:38:06.875346 3888047 quantize_finetune_llama.py:209] layer 18 gpu 2
I0323 16:38:07.326516 3895351 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:38:08.192721 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.9124119281768799s
I0323 16:38:11.908093 3895538 config.py:54] PyTorch version 2.6.0 available.
W0323 16:38:12.244361 3895538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:38:13.204202 3895538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:38:13.208355 3888047 quantize_finetune_llama.py:209] layer 19 gpu 3
I0323 16:38:13.660104 3895538 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:38:14.641685 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 19 in 0.9953093528747559s
I0323 16:38:18.538871 3895693 config.py:54] PyTorch version 2.6.0 available.
W0323 16:38:18.901729 3895693 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:38:19.987194 3895693 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:38:19.991509 3888047 quantize_finetune_llama.py:209] layer 20 gpu 0
I0323 16:38:20.195140 3895693 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.02352120541036129 tr(WHW.T) 271.2865905761719
bpp_loss 3.7221570014953613
16_q proxy err 0.016055336222052574 tr(WHW.T) 24435.3515625
bpp_loss 2.3446661233901978
16_k proxy err 0.003785379696637392 tr(WHW.T) 19477.44140625
bpp_loss 3.7171852588653564
16_o proxy err 0.09533191472291946 tr(WHW.T) 953.8026733398438
bpp_loss 2.3481826782226562
16_up proxy err 0.1287299394607544 tr(WHW.T) 8265.3720703125
bpp_loss 1.6837291036333357
16_gate proxy err 0.05606989935040474 tr(WHW.T) 41062.52734375
bpp_loss 1.6833179337637765
16_down proxy err 0.06315992772579193 tr(WHW.T) 6223.8134765625
bpp_loss 2.3485407488686696
17_v proxy err 0.027335764840245247 tr(WHW.T) 280.3503723144531
bpp_loss 3.7225396633148193
17_q proxy err 0.014842662028968334 tr(WHW.T) 27519.18359375
bpp_loss 2.344693183898926
17_k proxy err 0.004155460745096207 tr(WHW.T) 17400.5703125
bpp_loss 3.71826171875
17_o proxy err 0.08985253423452377 tr(WHW.T) 1090.2861328125
bpp_loss 2.3482710123062134
17_up proxy err 0.1261090338230133 tr(WHW.T) 8387.2646484375
bpp_loss 1.6837194306509835
17_gate proxy err 0.056447312235832214 tr(WHW.T) 41601.640625
bpp_loss 1.6834050587245397
17_down proxy err 0.06373284012079239 tr(WHW.T) 6148.05908203125
bpp_loss 2.348594835826329
I0323 16:39:18.874225 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 20 in 1.1564087867736816s
I0323 16:39:22.703643 3896741 config.py:54] PyTorch version 2.6.0 available.
W0323 16:39:23.024420 3896741 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.022093869745731354 tr(WHW.T) 284.6707763671875
bpp_loss 3.722134828567505
18_q proxy err 0.016964735463261604 tr(WHW.T) 22348.99609375
bpp_loss 2.3459956645965576
18_k proxy err 0.004363373387604952 tr(WHW.T) 17364.087890625
bpp_loss 3.7173290252685547
18_o proxy err 0.0785791203379631 tr(WHW.T) 1187.6383056640625
bpp_loss 2.3483892679214478
18_up proxy err 0.1312902420759201 tr(WHW.T) 7918.30078125
bpp_loss 1.6837831905909948
18_gate proxy err 0.06379035860300064 tr(WHW.T) 35127.12890625
bpp_loss 1.683591093335833
18_down proxy err 0.06320485472679138 tr(WHW.T) 6162.73876953125
bpp_loss 2.348506041935512
W0323 16:39:23.975216 3896741 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:39:23.980002 3888047 quantize_finetune_llama.py:209] layer 21 gpu 1
I0323 16:39:24.215550 3896741 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:39:25.415963 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 21 in 0.9546501636505127s
I0323 16:39:29.149444 3896894 config.py:54] PyTorch version 2.6.0 available.
19_v proxy err 0.020808253437280655 tr(WHW.T) 337.7576599121094
bpp_loss 3.7227115631103516
19_q proxy err 0.016092127189040184 tr(WHW.T) 23987.353515625
bpp_loss 2.3455634117126465
19_k proxy err 0.004496230743825436 tr(WHW.T) 15524.9208984375
bpp_loss 3.7185816764831543
19_o proxy err 0.08279258012771606 tr(WHW.T) 1152.94091796875
bpp_loss 2.3481428623199463
19_up proxy err 0.1353558599948883 tr(WHW.T) 7585.220703125
bpp_loss 1.6837549890790666
19_gate proxy err 0.06801239401102066 tr(WHW.T) 32694.146484375
bpp_loss 1.6835672514779227
19_down proxy err 0.06325476616621017 tr(WHW.T) 6119.1787109375
bpp_loss 2.3485336984906877
W0323 16:39:29.484669 3896894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:39:30.500826 3896894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:39:30.504973 3888047 quantize_finetune_llama.py:209] layer 22 gpu 2
I0323 16:39:30.770672 3896894 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:39:31.696106 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 22 in 0.7389328479766846s
I0323 16:39:35.363906 3897049 config.py:54] PyTorch version 2.6.0 available.
W0323 16:39:35.715392 3897049 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:39:36.716632 3897049 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:39:36.720818 3888047 quantize_finetune_llama.py:209] layer 23 gpu 3
I0323 16:39:36.903430 3897049 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:39:37.912366 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 23 in 0.797518253326416s
I0323 16:39:41.676615 3897204 config.py:54] PyTorch version 2.6.0 available.
W0323 16:39:42.037461 3897204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:39:43.185001 3897204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:39:43.189568 3888047 quantize_finetune_llama.py:209] layer 24 gpu 0
I0323 16:39:43.404157 3897204 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.023721784353256226 tr(WHW.T) 326.5545349121094
bpp_loss 3.7217172384262085
20_q proxy err 0.017789160832762718 tr(WHW.T) 20688.212890625
bpp_loss 2.345839023590088
20_k proxy err 0.004398969002068043 tr(WHW.T) 15368.2177734375
bpp_loss 3.718307375907898
20_o proxy err 0.07884664088487625 tr(WHW.T) 1189.504638671875
bpp_loss 2.3487709760665894
20_up proxy err 0.1368788480758667 tr(WHW.T) 7535.15576171875
bpp_loss 1.6836810793195451
20_gate proxy err 0.07155746221542358 tr(WHW.T) 30547.197265625
bpp_loss 1.683591570172991
20_down proxy err 0.06260015070438385 tr(WHW.T) 6236.83935546875
bpp_loss 2.3486929621015276
21_v proxy err 0.02302117645740509 tr(WHW.T) 358.9937438964844
bpp_loss 3.7232165336608887
21_q proxy err 0.014698576182126999 tr(WHW.T) 25789.74609375
bpp_loss 2.3448516130447388
21_k proxy err 0.004144093953073025 tr(WHW.T) 16759.484375
bpp_loss 3.718803644180298
21_o proxy err 0.07872120290994644 tr(WHW.T) 1250.279296875
bpp_loss 2.348637580871582
21_up proxy err 0.1349254697561264 tr(WHW.T) 7707.68359375
bpp_loss 1.6837043081011092
21_gate proxy err 0.0709441602230072 tr(WHW.T) 31446.626953125
bpp_loss 1.683600834437779
21_down proxy err 0.06247207149863243 tr(WHW.T) 6287.07373046875
bpp_loss 2.3486275332314626
I0323 16:40:41.893919 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 24 in 0.95989990234375s
I0323 16:40:45.685164 3898260 config.py:54] PyTorch version 2.6.0 available.
W0323 16:40:46.016480 3898260 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.02661399357020855 tr(WHW.T) 341.7787170410156
bpp_loss 3.7235535383224487
22_q proxy err 0.01689443364739418 tr(WHW.T) 20273.72265625
bpp_loss 2.345347285270691
22_k proxy err 0.004457944072782993 tr(WHW.T) 14697.265625
bpp_loss 3.717391610145569
22_o proxy err 0.0842362493276596 tr(WHW.T) 1204.8531494140625
bpp_loss 2.3485084772109985
22_up proxy err 0.13922007381916046 tr(WHW.T) 7481.95849609375
bpp_loss 1.6837457248142786
22_gate proxy err 0.07452354580163956 tr(WHW.T) 29414.359375
bpp_loss 1.6835949080330985
22_down proxy err 0.06124148890376091 tr(WHW.T) 6464.6640625
bpp_loss 2.3485938821520125
W0323 16:40:47.032105 3898260 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:40:47.036230 3888047 quantize_finetune_llama.py:209] layer 25 gpu 1
I0323 16:40:47.482733 3898260 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:40:48.540044 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 25 in 1.0036289691925049s
I0323 16:40:52.223444 3898435 config.py:54] PyTorch version 2.6.0 available.
W0323 16:40:52.540279 3898435 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.02573789842426777 tr(WHW.T) 393.136962890625
bpp_loss 3.7209562063217163
23_q proxy err 0.01578475534915924 tr(WHW.T) 22562.6484375
bpp_loss 2.3453534841537476
23_k proxy err 0.004424029961228371 tr(WHW.T) 14830.83203125
bpp_loss 3.7186777591705322
23_o proxy err 0.06225809082388878 tr(WHW.T) 1726.8399658203125
bpp_loss 2.348392367362976
23_up proxy err 0.1422698050737381 tr(WHW.T) 7353.39404296875
bpp_loss 1.6837522642953056
23_gate proxy err 0.07927066832780838 tr(WHW.T) 27171.52734375
bpp_loss 1.6835646629333496
23_down proxy err 0.0605296865105629 tr(WHW.T) 6601.61376953125
bpp_loss 2.348568950380598
W0323 16:40:53.506536 3898435 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:40:53.511070 3888047 quantize_finetune_llama.py:209] layer 26 gpu 2
I0323 16:40:53.914573 3898435 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:40:54.690435 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 26 in 0.7543880939483643s
I0323 16:40:58.409156 3898588 config.py:54] PyTorch version 2.6.0 available.
W0323 16:40:58.762034 3898588 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:40:59.756389 3898588 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:40:59.760709 3888047 quantize_finetune_llama.py:209] layer 27 gpu 3
I0323 16:41:00.035954 3898588 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:41:00.987297 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 27 in 0.801802396774292s
I0323 16:41:04.849425 3898743 config.py:54] PyTorch version 2.6.0 available.
W0323 16:41:05.224596 3898743 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:41:06.378711 3898743 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:41:06.382893 3888047 quantize_finetune_llama.py:209] layer 28 gpu 0
I0323 16:41:06.561217 3898743 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.026330484077334404 tr(WHW.T) 461.53338623046875
bpp_loss 3.722852110862732
24_q proxy err 0.01542358472943306 tr(WHW.T) 22391.330078125
bpp_loss 2.3461811542510986
24_k proxy err 0.004225602839142084 tr(WHW.T) 14159.3115234375
bpp_loss 3.7188669443130493
24_o proxy err 0.07406939566135406 tr(WHW.T) 1570.1973876953125
bpp_loss 2.348075270652771
24_up proxy err 0.14522649347782135 tr(WHW.T) 7244.748046875
bpp_loss 1.6836957931518555
24_gate proxy err 0.08329635113477707 tr(WHW.T) 25756.130859375
bpp_loss 1.683579581124442
24_down proxy err 0.06047036498785019 tr(WHW.T) 6675.92578125
bpp_loss 2.3487045083727156
25_v proxy err 0.022420017048716545 tr(WHW.T) 551.988037109375
bpp_loss 3.722773313522339
25_q proxy err 0.013593307696282864 tr(WHW.T) 26068.671875
bpp_loss 2.3459599018096924
25_k proxy err 0.0041136532090604305 tr(WHW.T) 14392.7578125
bpp_loss 3.7198792695999146
25_o proxy err 0.0604550763964653 tr(WHW.T) 1970.9990234375
bpp_loss 2.3483766317367554
25_up proxy err 0.14624610543251038 tr(WHW.T) 7314.64501953125
bpp_loss 1.6837059429713659
25_gate proxy err 0.08319158107042313 tr(WHW.T) 26184.576171875
bpp_loss 1.683560848236084
25_down proxy err 0.06254301965236664 tr(WHW.T) 6548.80126953125
bpp_loss 2.348339217049735
I0323 16:42:03.693999 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 28 in 0.941047191619873s
I0323 16:42:07.660667 3899799 config.py:54] PyTorch version 2.6.0 available.
W0323 16:42:08.004661 3899799 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.03169168904423714 tr(WHW.T) 428.11846923828125
bpp_loss 3.723087430000305
26_q proxy err 0.015853356570005417 tr(WHW.T) 21359.30078125
bpp_loss 2.3460190296173096
26_k proxy err 0.004125866107642651 tr(WHW.T) 15400.1064453125
bpp_loss 3.7182483673095703
26_o proxy err 0.052803877741098404 tr(WHW.T) 2368.438720703125
bpp_loss 2.3481799364089966
26_up proxy err 0.14383664727210999 tr(WHW.T) 7577.00390625
bpp_loss 1.6837513106209892
26_gate proxy err 0.07824324071407318 tr(WHW.T) 28776.8671875
bpp_loss 1.6836724281311035
26_down proxy err 0.06354905664920807 tr(WHW.T) 6550.5390625
bpp_loss 2.348679099764143
W0323 16:42:09.046733 3899799 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:42:09.051036 3888047 quantize_finetune_llama.py:209] layer 29 gpu 1
I0323 16:42:09.236445 3899799 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:42:10.271702 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 29 in 0.6505126953125s
I0323 16:42:14.026237 3899957 config.py:54] PyTorch version 2.6.0 available.
W0323 16:42:14.368711 3899957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.023560648784041405 tr(WHW.T) 670.2694702148438
bpp_loss 3.721855401992798
27_q proxy err 0.015552785247564316 tr(WHW.T) 21263.427734375
bpp_loss 2.3465893268585205
27_k proxy err 0.004391205031424761 tr(WHW.T) 13986.7197265625
bpp_loss 3.7189345359802246
27_o proxy err 0.06088848039507866 tr(WHW.T) 2138.571533203125
bpp_loss 2.348225474357605
27_up proxy err 0.13448914885520935 tr(WHW.T) 8405.169921875
bpp_loss 1.6836737905229842
27_gate proxy err 0.0718085840344429 tr(WHW.T) 32682.3984375
bpp_loss 1.6836928640093123
27_down proxy err 0.06563116610050201 tr(WHW.T) 6473.53173828125
bpp_loss 2.348554951804025
W0323 16:42:15.395406 3899957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:42:15.399454 3888047 quantize_finetune_llama.py:209] layer 30 gpu 2
I0323 16:42:15.685154 3899957 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:42:17.052248 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 30 in 0.8258888721466064s
I0323 16:42:20.828904 3900112 config.py:54] PyTorch version 2.6.0 available.
W0323 16:42:21.178774 3900112 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:42:22.168027 3900112 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:42:22.172130 3888047 quantize_finetune_llama.py:209] layer 31 gpu 3
I0323 16:42:22.331519 3900112 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 16:42:23.622779 3888047 quantize_finetune_llama.py:240] computed original embedding for layer 31 in 0.9898972511291504s
I0323 16:42:27.471607 3900297 config.py:54] PyTorch version 2.6.0 available.
W0323 16:42:27.827217 3900297 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 16:42:28.955481 3900297 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 16:42:29.255563 3900297 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.02845473773777485 tr(WHW.T) 593.4841918945312
bpp_loss 3.722240447998047
28_q proxy err 0.014637907035648823 tr(WHW.T) 23121.322265625
bpp_loss 2.346709966659546
28_k proxy err 0.0037918451707810163 tr(WHW.T) 14971.62890625
bpp_loss 3.7192258834838867
28_o proxy err 0.05548088997602463 tr(WHW.T) 2488.906494140625
bpp_loss 2.348105788230896
28_up proxy err 0.11834316700696945 tr(WHW.T) 10172.6669921875
bpp_loss 1.6836321013314384
28_gate proxy err 0.06666012108325958 tr(WHW.T) 35795.8046875
bpp_loss 1.683628967830113
28_down proxy err 0.06177423149347305 tr(WHW.T) 7137.84375
bpp_loss 2.3485919748033797
29_v proxy err 0.022000320255756378 tr(WHW.T) 841.72265625
bpp_loss 3.7222702503204346
29_q proxy err 0.01595117896795273 tr(WHW.T) 20611.14453125
bpp_loss 2.3473435640335083
29_k proxy err 0.0038622082211077213 tr(WHW.T) 16341.0302734375
bpp_loss 3.7196993827819824
29_o proxy err 0.04850912094116211 tr(WHW.T) 3078.73974609375
bpp_loss 2.34701669216156
29_up proxy err 0.1020222008228302 tr(WHW.T) 12790.9697265625
bpp_loss 1.6838065556117467
29_gate proxy err 0.06344428658485413 tr(WHW.T) 38239.99609375
bpp_loss 1.6836352348327637
29_down proxy err 0.0616980604827404 tr(WHW.T) 7395.6328125
bpp_loss 2.3483584948948453
30_v proxy err 0.03116232343018055 tr(WHW.T) 850.5265502929688
bpp_loss 3.722715735435486
30_q proxy err 0.013317656703293324 tr(WHW.T) 24012.384765625
bpp_loss 2.346704125404358
30_k proxy err 0.0035332830157130957 tr(WHW.T) 14011.546875
bpp_loss 3.717869520187378
30_o proxy err 0.03648122027516365 tr(WHW.T) 4841.5751953125
bpp_loss 2.347872018814087
30_up proxy err 0.07062026113271713 tr(WHW.T) 21629.68359375
bpp_loss 1.6837026732308524
30_gate proxy err 0.053838253021240234 tr(WHW.T) 51821.0
bpp_loss 1.683647973196847
30_down proxy err 0.05369571968913078 tr(WHW.T) 8734.203125
bpp_loss 2.3485310077667236
31_v proxy err 0.012086918577551842 tr(WHW.T) 1798.7896728515625
bpp_loss 3.7227283716201782
31_q proxy err 0.009990015998482704 tr(WHW.T) 46129.50390625
bpp_loss 2.347163200378418
31_k proxy err 0.0029823712538927794 tr(WHW.T) 20445.06640625
bpp_loss 3.7199290990829468
31_o proxy err 0.07414677739143372 tr(WHW.T) 2186.682373046875
bpp_loss 2.3471498489379883
31_up proxy err 0.04012134671211243 tr(WHW.T) 68909.6796875
bpp_loss 1.6833137784685408
31_gate proxy err 0.03474847972393036 tr(WHW.T) 144279.1875
bpp_loss 1.6834314210074288
31_down proxy err 0.05074692517518997 tr(WHW.T) 9879.267578125
bpp_loss 2.3458751269749234
I0323 16:43:48.221810 3901617 config.py:54] PyTorch version 2.6.0 available.
W0323 16:43:48.550532 3901617 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0323 16:43:48.791448 3901617 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.45it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.65it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.11it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.35it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.50it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.57it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.43it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.30it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.89it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.65it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.99it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.09it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.34it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.48it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.44it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.26it/s]
I0323 16:43:52.123250 3901617 hfize_llama.py:153] loaded layer 0
I0323 16:43:52.983258 3901617 hfize_llama.py:153] loaded layer 1
I0323 16:43:53.926548 3901617 hfize_llama.py:153] loaded layer 2
I0323 16:43:54.731317 3901617 hfize_llama.py:153] loaded layer 3
I0323 16:43:55.533574 3901617 hfize_llama.py:153] loaded layer 4
I0323 16:43:56.317781 3901617 hfize_llama.py:153] loaded layer 5
I0323 16:43:57.093808 3901617 hfize_llama.py:153] loaded layer 6
I0323 16:43:57.896265 3901617 hfize_llama.py:153] loaded layer 7
I0323 16:43:58.704204 3901617 hfize_llama.py:153] loaded layer 8
I0323 16:43:59.496850 3901617 hfize_llama.py:153] loaded layer 9
I0323 16:44:00.304771 3901617 hfize_llama.py:153] loaded layer 10
I0323 16:44:01.085278 3901617 hfize_llama.py:153] loaded layer 11
I0323 16:44:01.875512 3901617 hfize_llama.py:153] loaded layer 12
I0323 16:44:02.704265 3901617 hfize_llama.py:153] loaded layer 13
I0323 16:44:03.475125 3901617 hfize_llama.py:153] loaded layer 14
I0323 16:44:04.275400 3901617 hfize_llama.py:153] loaded layer 15
I0323 16:44:05.036136 3901617 hfize_llama.py:153] loaded layer 16
I0323 16:44:05.768582 3901617 hfize_llama.py:153] loaded layer 17
I0323 16:44:06.600617 3901617 hfize_llama.py:153] loaded layer 18
I0323 16:44:07.354108 3901617 hfize_llama.py:153] loaded layer 19
I0323 16:44:08.101660 3901617 hfize_llama.py:153] loaded layer 20
I0323 16:44:08.836823 3901617 hfize_llama.py:153] loaded layer 21
I0323 16:44:09.587969 3901617 hfize_llama.py:153] loaded layer 22
I0323 16:44:10.316759 3901617 hfize_llama.py:153] loaded layer 23
I0323 16:44:11.072494 3901617 hfize_llama.py:153] loaded layer 24
I0323 16:44:11.786715 3901617 hfize_llama.py:153] loaded layer 25
I0323 16:44:12.490806 3901617 hfize_llama.py:153] loaded layer 26
I0323 16:44:13.220483 3901617 hfize_llama.py:153] loaded layer 27
I0323 16:44:13.895883 3901617 hfize_llama.py:153] loaded layer 28
I0323 16:44:14.563544 3901617 hfize_llama.py:153] loaded layer 29
I0323 16:44:15.281851 3901617 hfize_llama.py:153] loaded layer 30
I0323 16:44:16.040183 3901617 hfize_llama.py:153] loaded layer 31
I0323 16:44:16.040381 3901617 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:08,  1.42s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:06,  1.24s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.05s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:02,  1.04it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:04<00:01,  1.10it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:05<00:00,  1.18it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.38it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.13it/s]
I0323 16:44:56.389002 3901617 hfize_llama.py:167] successfully loaded hfized model
W0323 16:45:00.909538 3902990 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0323 16:45:01.387710 3902990 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:06,  1.07s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.02s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.09s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.13s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.17s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:01,  1.17s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.01s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.07s/it]
I0323 16:45:09.347673 3902990 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 4.523651123046875:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 4.523651123046875:   1%|          | 1/141 [00:01<04:09,  1.79s/it]avg_loss = 9.315269947052002:   1%|          | 1/141 [00:03<04:09,  1.79s/it]avg_loss = 9.315269947052002:   1%|▏         | 2/141 [00:03<03:35,  1.55s/it]avg_loss = 9.709357579549154:   1%|▏         | 2/141 [00:04<03:35,  1.55s/it]avg_loss = 9.709357579549154:   2%|▏         | 3/141 [00:04<03:25,  1.49s/it]avg_loss = 10.025046348571777:   2%|▏         | 3/141 [00:05<03:25,  1.49s/it]avg_loss = 10.025046348571777:   3%|▎         | 4/141 [00:05<03:19,  1.45s/it]avg_loss = 9.150342273712159:   3%|▎         | 4/141 [00:07<03:19,  1.45s/it] avg_loss = 9.150342273712159:   4%|▎         | 5/141 [00:07<03:17,  1.45s/it]avg_loss = 9.329709450403849:   4%|▎         | 5/141 [00:08<03:17,  1.45s/it]avg_loss = 9.329709450403849:   4%|▍         | 6/141 [00:08<03:14,  1.44s/it]avg_loss = 9.770088808877128:   4%|▍         | 6/141 [00:10<03:14,  1.44s/it]avg_loss = 9.770088808877128:   5%|▍         | 7/141 [00:10<03:11,  1.43s/it]avg_loss = 9.21437692642212:   5%|▍         | 7/141 [00:11<03:11,  1.43s/it] avg_loss = 9.21437692642212:   6%|▌         | 8/141 [00:11<03:10,  1.44s/it]avg_loss = 9.349571969774034:   6%|▌         | 8/141 [00:13<03:10,  1.44s/it]avg_loss = 9.349571969774034:   6%|▋         | 9/141 [00:13<03:09,  1.43s/it]avg_loss = 9.085586214065552:   6%|▋         | 9/141 [00:14<03:09,  1.43s/it]avg_loss = 9.085586214065552:   7%|▋         | 10/141 [00:14<03:08,  1.44s/it]avg_loss = 9.170129125768488:   7%|▋         | 10/141 [00:16<03:08,  1.44s/it]avg_loss = 9.170129125768488:   8%|▊         | 11/141 [00:16<03:08,  1.45s/it]avg_loss = 9.27901566028595:   8%|▊         | 11/141 [00:17<03:08,  1.45s/it] avg_loss = 9.27901566028595:   9%|▊         | 12/141 [00:17<03:07,  1.45s/it]avg_loss = 9.305537187136137:   9%|▊         | 12/141 [00:18<03:07,  1.45s/it]avg_loss = 9.305537187136137:   9%|▉         | 13/141 [00:18<03:06,  1.45s/it]avg_loss = 9.40077771459307:   9%|▉         | 13/141 [00:20<03:06,  1.45s/it] avg_loss = 9.40077771459307:  10%|▉         | 14/141 [00:20<03:05,  1.46s/it]avg_loss = 9.15019343694051:  10%|▉         | 14/141 [00:21<03:05,  1.46s/it]avg_loss = 9.15019343694051:  11%|█         | 15/141 [00:21<03:04,  1.47s/it]avg_loss = 9.273588210344315:  11%|█         | 15/141 [00:23<03:04,  1.47s/it]avg_loss = 9.273588210344315:  11%|█▏        | 16/141 [00:23<03:02,  1.46s/it]avg_loss = 9.431298227871165:  11%|█▏        | 16/141 [00:24<03:02,  1.46s/it]avg_loss = 9.431298227871165:  12%|█▏        | 17/141 [00:24<03:01,  1.46s/it]avg_loss = 9.580986473295424:  12%|█▏        | 17/141 [00:26<03:01,  1.46s/it]avg_loss = 9.580986473295424:  13%|█▎        | 18/141 [00:26<02:59,  1.46s/it]avg_loss = 9.3393090649655:  13%|█▎        | 18/141 [00:27<02:59,  1.46s/it]  avg_loss = 9.3393090649655:  13%|█▎        | 19/141 [00:27<02:59,  1.47s/it]avg_loss = 9.267561793327332:  13%|█▎        | 19/141 [00:29<02:59,  1.47s/it]avg_loss = 9.267561793327332:  14%|█▍        | 20/141 [00:29<02:58,  1.48s/it]avg_loss = 9.16835033325922:  14%|█▍        | 20/141 [00:30<02:58,  1.48s/it] avg_loss = 9.16835033325922:  15%|█▍        | 21/141 [00:30<02:58,  1.49s/it]avg_loss = 9.010223973881114:  15%|█▍        | 21/141 [00:32<02:58,  1.49s/it]avg_loss = 9.010223973881114:  16%|█▌        | 22/141 [00:32<02:57,  1.49s/it]avg_loss = 9.094850395036781:  16%|█▌        | 22/141 [00:33<02:57,  1.49s/it]avg_loss = 9.094850395036781:  16%|█▋        | 23/141 [00:33<02:55,  1.49s/it]avg_loss = 9.167195618152618:  16%|█▋        | 23/141 [00:35<02:55,  1.49s/it]avg_loss = 9.167195618152618:  17%|█▋        | 24/141 [00:35<02:54,  1.49s/it]avg_loss = 9.344561595916748:  17%|█▋        | 24/141 [00:36<02:54,  1.49s/it]avg_loss = 9.344561595916748:  18%|█▊        | 25/141 [00:36<02:52,  1.49s/it]avg_loss = 9.507851912425114:  18%|█▊        | 25/141 [00:38<02:52,  1.49s/it]avg_loss = 9.507851912425114:  18%|█▊        | 26/141 [00:38<02:51,  1.49s/it]avg_loss = 9.586070855458578:  18%|█▊        | 26/141 [00:39<02:51,  1.49s/it]avg_loss = 9.586070855458578:  19%|█▉        | 27/141 [00:39<02:49,  1.49s/it]avg_loss = 9.655216540609088:  19%|█▉        | 27/141 [00:41<02:49,  1.49s/it]avg_loss = 9.655216540609088:  20%|█▉        | 28/141 [00:41<02:48,  1.49s/it]avg_loss = 9.742428269879571:  20%|█▉        | 28/141 [00:42<02:48,  1.49s/it]avg_loss = 9.742428269879571:  21%|██        | 29/141 [00:42<02:47,  1.49s/it]avg_loss = 9.773306639989217:  21%|██        | 29/141 [00:44<02:47,  1.49s/it]avg_loss = 9.773306639989217:  21%|██▏       | 30/141 [00:44<02:45,  1.49s/it]avg_loss = 9.79242467880249:  21%|██▏       | 30/141 [00:45<02:45,  1.49s/it] avg_loss = 9.79242467880249:  22%|██▏       | 31/141 [00:45<02:44,  1.50s/it]avg_loss = 9.785470023751259:  22%|██▏       | 31/141 [00:47<02:44,  1.50s/it]avg_loss = 9.785470023751259:  23%|██▎       | 32/141 [00:47<02:44,  1.51s/it]avg_loss = 9.750975420980742:  23%|██▎       | 32/141 [00:48<02:44,  1.51s/it]avg_loss = 9.750975420980742:  23%|██▎       | 33/141 [00:48<02:43,  1.51s/it]avg_loss = 9.785118790233836:  23%|██▎       | 33/141 [00:50<02:43,  1.51s/it]avg_loss = 9.785118790233836:  24%|██▍       | 34/141 [00:50<02:41,  1.51s/it]avg_loss = 9.867323344094412:  24%|██▍       | 34/141 [00:51<02:41,  1.51s/it]avg_loss = 9.867323344094412:  25%|██▍       | 35/141 [00:51<02:39,  1.51s/it]avg_loss = 9.890064941512215:  25%|██▍       | 35/141 [00:53<02:39,  1.51s/it]avg_loss = 9.890064941512215:  26%|██▌       | 36/141 [00:53<02:38,  1.51s/it]avg_loss = 9.81604850614393:  26%|██▌       | 36/141 [00:54<02:38,  1.51s/it] avg_loss = 9.81604850614393:  26%|██▌       | 37/141 [00:54<02:37,  1.52s/it]avg_loss = 9.856065913250571:  26%|██▌       | 37/141 [00:56<02:37,  1.52s/it]avg_loss = 9.856065913250571:  27%|██▋       | 38/141 [00:56<02:35,  1.51s/it]avg_loss = 9.882556316180107:  27%|██▋       | 38/141 [00:57<02:35,  1.51s/it]avg_loss = 9.882556316180107:  28%|██▊       | 39/141 [00:57<02:34,  1.52s/it]avg_loss = 9.890693724155426:  28%|██▊       | 39/141 [00:59<02:34,  1.52s/it]avg_loss = 9.890693724155426:  28%|██▊       | 40/141 [00:59<02:33,  1.52s/it]avg_loss = 9.935733992878983:  28%|██▊       | 40/141 [01:00<02:33,  1.52s/it]avg_loss = 9.935733992878983:  29%|██▉       | 41/141 [01:00<02:31,  1.52s/it]avg_loss = 9.947980437959943:  29%|██▉       | 41/141 [01:02<02:31,  1.52s/it]avg_loss = 9.947980437959943:  30%|██▉       | 42/141 [01:02<02:30,  1.52s/it]avg_loss = 9.994805657586387:  30%|██▉       | 42/141 [01:03<02:30,  1.52s/it]avg_loss = 9.994805657586387:  30%|███       | 43/141 [01:03<02:29,  1.52s/it]avg_loss = 9.929835785518993:  30%|███       | 43/141 [01:05<02:29,  1.52s/it]avg_loss = 9.929835785518993:  31%|███       | 44/141 [01:05<02:28,  1.53s/it]avg_loss = 9.956360467274983:  31%|███       | 44/141 [01:07<02:28,  1.53s/it]avg_loss = 9.956360467274983:  32%|███▏      | 45/141 [01:07<02:26,  1.53s/it]avg_loss = 9.941826581954956:  32%|███▏      | 45/141 [01:08<02:26,  1.53s/it]avg_loss = 9.941826581954956:  33%|███▎      | 46/141 [01:08<02:25,  1.53s/it]avg_loss = 9.97009458947689:  33%|███▎      | 46/141 [01:10<02:25,  1.53s/it] avg_loss = 9.97009458947689:  33%|███▎      | 47/141 [01:10<02:24,  1.53s/it]avg_loss = 9.946871807177862:  33%|███▎      | 47/141 [01:11<02:24,  1.53s/it]avg_loss = 9.946871807177862:  34%|███▍      | 48/141 [01:11<02:22,  1.54s/it]avg_loss = 9.916655861601537:  34%|███▍      | 48/141 [01:13<02:22,  1.54s/it]avg_loss = 9.916655861601537:  35%|███▍      | 49/141 [01:13<02:21,  1.54s/it]avg_loss = 9.856824998855592:  35%|███▍      | 49/141 [01:14<02:21,  1.54s/it]avg_loss = 9.856824998855592:  35%|███▌      | 50/141 [01:14<02:20,  1.55s/it]avg_loss = 9.942882023605646:  35%|███▌      | 50/141 [01:16<02:20,  1.55s/it]avg_loss = 9.942882023605646:  36%|███▌      | 51/141 [01:16<02:18,  1.54s/it]avg_loss = 9.970511922469505:  36%|███▌      | 51/141 [01:17<02:18,  1.54s/it]avg_loss = 9.970511922469505:  37%|███▋      | 52/141 [01:17<02:17,  1.54s/it]avg_loss = 9.988322968752879:  37%|███▋      | 52/141 [01:19<02:17,  1.54s/it]avg_loss = 9.988322968752879:  38%|███▊      | 53/141 [01:19<02:15,  1.54s/it]avg_loss = 10.03428465348703:  38%|███▊      | 53/141 [01:20<02:15,  1.54s/it]avg_loss = 10.03428465348703:  38%|███▊      | 54/141 [01:20<02:13,  1.54s/it]avg_loss = 10.018045659498735:  38%|███▊      | 54/141 [01:22<02:13,  1.54s/it]avg_loss = 10.018045659498735:  39%|███▉      | 55/141 [01:22<02:12,  1.54s/it]avg_loss = 9.987169138022832:  39%|███▉      | 55/141 [01:24<02:12,  1.54s/it] avg_loss = 9.987169138022832:  40%|███▉      | 56/141 [01:24<02:11,  1.55s/it]avg_loss = 9.940731115508498:  40%|███▉      | 56/141 [01:25<02:11,  1.55s/it]avg_loss = 9.940731115508498:  40%|████      | 57/141 [01:25<02:10,  1.55s/it]avg_loss = 9.943566881377121:  40%|████      | 57/141 [01:27<02:10,  1.55s/it]avg_loss = 9.943566881377121:  41%|████      | 58/141 [01:27<02:09,  1.56s/it]avg_loss = 9.955278639066018:  41%|████      | 58/141 [01:28<02:09,  1.56s/it]avg_loss = 9.955278639066018:  42%|████▏     | 59/141 [01:28<02:07,  1.55s/it]avg_loss = 9.996271181106568:  42%|████▏     | 59/141 [01:30<02:07,  1.55s/it]avg_loss = 9.996271181106568:  43%|████▎     | 60/141 [01:30<02:05,  1.55s/it]avg_loss = 9.962022273266902:  43%|████▎     | 60/141 [01:31<02:05,  1.55s/it]avg_loss = 9.962022273266902:  43%|████▎     | 61/141 [01:31<02:04,  1.56s/it]avg_loss = 9.943296024876256:  43%|████▎     | 61/141 [01:33<02:04,  1.56s/it]avg_loss = 9.943296024876256:  44%|████▍     | 62/141 [01:33<02:03,  1.56s/it]avg_loss = 9.91692888925946:  44%|████▍     | 62/141 [01:34<02:03,  1.56s/it] avg_loss = 9.91692888925946:  45%|████▍     | 63/141 [01:34<02:01,  1.56s/it]avg_loss = 9.933956868946552:  45%|████▍     | 63/141 [01:36<02:01,  1.56s/it]avg_loss = 9.933956868946552:  45%|████▌     | 64/141 [01:36<01:59,  1.56s/it]avg_loss = 9.972046918135423:  45%|████▌     | 64/141 [01:38<01:59,  1.56s/it]avg_loss = 9.972046918135423:  46%|████▌     | 65/141 [01:38<01:57,  1.55s/it]avg_loss = 9.967484019019388:  46%|████▌     | 65/141 [01:39<01:57,  1.55s/it]avg_loss = 9.967484019019388:  47%|████▋     | 66/141 [01:39<01:56,  1.55s/it]avg_loss = 9.981437789860056:  47%|████▋     | 66/141 [01:41<01:56,  1.55s/it]avg_loss = 9.981437789860056:  48%|████▊     | 67/141 [01:41<01:54,  1.55s/it]avg_loss = 9.98604447000167:  48%|████▊     | 67/141 [01:42<01:54,  1.55s/it] avg_loss = 9.98604447000167:  48%|████▊     | 68/141 [01:42<01:52,  1.55s/it]avg_loss = 9.989700628363568:  48%|████▊     | 68/141 [01:44<01:52,  1.55s/it]avg_loss = 9.989700628363568:  49%|████▉     | 69/141 [01:44<01:51,  1.55s/it]avg_loss = 10.014428962979999:  49%|████▉     | 69/141 [01:45<01:51,  1.55s/it]avg_loss = 10.014428962979999:  50%|████▉     | 70/141 [01:45<01:50,  1.55s/it]avg_loss = 9.97897886222517:  50%|████▉     | 70/141 [01:47<01:50,  1.55s/it]  avg_loss = 9.97897886222517:  50%|█████     | 71/141 [01:47<01:48,  1.56s/it]avg_loss = 10.010105338361528:  50%|█████     | 71/141 [01:48<01:48,  1.56s/it]avg_loss = 10.010105338361528:  51%|█████     | 72/141 [01:48<01:47,  1.55s/it]avg_loss = 10.023637046552684:  51%|█████     | 72/141 [01:50<01:47,  1.55s/it]avg_loss = 10.023637046552684:  52%|█████▏    | 73/141 [01:50<01:45,  1.55s/it]avg_loss = 10.013802341512731:  52%|█████▏    | 73/141 [01:52<01:45,  1.55s/it]avg_loss = 10.013802341512731:  52%|█████▏    | 74/141 [01:52<01:44,  1.56s/it]avg_loss = 10.037842744191488:  52%|█████▏    | 74/141 [01:53<01:44,  1.56s/it]avg_loss = 10.037842744191488:  53%|█████▎    | 75/141 [01:53<01:42,  1.55s/it]avg_loss = 10.051960073019329:  53%|█████▎    | 75/141 [01:55<01:42,  1.55s/it]avg_loss = 10.051960073019329:  54%|█████▍    | 76/141 [01:55<01:40,  1.55s/it]avg_loss = 10.059667506775298:  54%|█████▍    | 76/141 [01:56<01:40,  1.55s/it]avg_loss = 10.059667506775298:  55%|█████▍    | 77/141 [01:56<01:39,  1.55s/it]avg_loss = 10.05538882353367:  55%|█████▍    | 77/141 [01:58<01:39,  1.55s/it] avg_loss = 10.05538882353367:  55%|█████▌    | 78/141 [01:58<01:37,  1.55s/it]avg_loss = 10.0575714050969:  55%|█████▌    | 78/141 [01:59<01:37,  1.55s/it] avg_loss = 10.0575714050969:  56%|█████▌    | 79/141 [01:59<01:36,  1.56s/it]avg_loss = 10.079346889257431:  56%|█████▌    | 79/141 [02:01<01:36,  1.56s/it]avg_loss = 10.079346889257431:  57%|█████▋    | 80/141 [02:01<01:34,  1.56s/it]avg_loss = 10.01373956232895:  57%|█████▋    | 80/141 [02:02<01:34,  1.56s/it] avg_loss = 10.01373956232895:  57%|█████▋    | 81/141 [02:02<01:33,  1.56s/it]avg_loss = 10.027516865148776:  57%|█████▋    | 81/141 [02:04<01:33,  1.56s/it]avg_loss = 10.027516865148776:  58%|█████▊    | 82/141 [02:04<01:31,  1.56s/it]avg_loss = 10.023207181907562:  58%|█████▊    | 82/141 [02:06<01:31,  1.56s/it]avg_loss = 10.023207181907562:  59%|█████▉    | 83/141 [02:06<01:30,  1.56s/it]avg_loss = 10.001382680166335:  59%|█████▉    | 83/141 [02:07<01:30,  1.56s/it]avg_loss = 10.001382680166335:  60%|█████▉    | 84/141 [02:07<01:29,  1.56s/it]avg_loss = 9.996490893644445:  60%|█████▉    | 84/141 [02:09<01:29,  1.56s/it] avg_loss = 9.996490893644445:  60%|██████    | 85/141 [02:09<01:27,  1.56s/it]avg_loss = 10.032986130825309:  60%|██████    | 85/141 [02:10<01:27,  1.56s/it]avg_loss = 10.032986130825309:  61%|██████    | 86/141 [02:10<01:25,  1.56s/it]avg_loss = 10.05171228825361:  61%|██████    | 86/141 [02:12<01:25,  1.56s/it] avg_loss = 10.05171228825361:  62%|██████▏   | 87/141 [02:12<01:24,  1.56s/it]avg_loss = 10.050181399692189:  62%|██████▏   | 87/141 [02:13<01:24,  1.56s/it]avg_loss = 10.050181399692189:  62%|██████▏   | 88/141 [02:13<01:22,  1.56s/it]avg_loss = 10.061964945846729:  62%|██████▏   | 88/141 [02:15<01:22,  1.56s/it]avg_loss = 10.061964945846729:  63%|██████▎   | 89/141 [02:15<01:21,  1.56s/it]avg_loss = 10.069160927666559:  63%|██████▎   | 89/141 [02:16<01:21,  1.56s/it]avg_loss = 10.069160927666559:  64%|██████▍   | 90/141 [02:16<01:19,  1.56s/it]avg_loss = 10.075347816551124:  64%|██████▍   | 90/141 [02:18<01:19,  1.56s/it]avg_loss = 10.075347816551124:  65%|██████▍   | 91/141 [02:18<01:18,  1.56s/it]avg_loss = 10.064296971196713:  65%|██████▍   | 91/141 [02:20<01:18,  1.56s/it]avg_loss = 10.064296971196713:  65%|██████▌   | 92/141 [02:20<01:16,  1.57s/it]avg_loss = 10.0852690563407:  65%|██████▌   | 92/141 [02:21<01:16,  1.57s/it]  avg_loss = 10.0852690563407:  66%|██████▌   | 93/141 [02:21<01:15,  1.56s/it]avg_loss = 10.109537794234905:  66%|██████▌   | 93/141 [02:23<01:15,  1.56s/it]avg_loss = 10.109537794234905:  67%|██████▋   | 94/141 [02:23<01:13,  1.56s/it]avg_loss = 10.130384836698834:  67%|██████▋   | 94/141 [02:24<01:13,  1.56s/it]avg_loss = 10.130384836698834:  67%|██████▋   | 95/141 [02:24<01:11,  1.55s/it]avg_loss = 10.134587953488031:  67%|██████▋   | 95/141 [02:26<01:11,  1.55s/it]avg_loss = 10.134587953488031:  68%|██████▊   | 96/141 [02:26<01:10,  1.56s/it]avg_loss = 10.156149333285303:  68%|██████▊   | 96/141 [02:27<01:10,  1.56s/it]avg_loss = 10.156149333285303:  69%|██████▉   | 97/141 [02:27<01:08,  1.55s/it]avg_loss = 10.157585124580228:  69%|██████▉   | 97/141 [02:29<01:08,  1.55s/it]avg_loss = 10.157585124580228:  70%|██████▉   | 98/141 [02:29<01:06,  1.55s/it]avg_loss = 10.118151457622798:  70%|██████▉   | 98/141 [02:30<01:06,  1.55s/it]avg_loss = 10.118151457622798:  70%|███████   | 99/141 [02:30<01:05,  1.56s/it]avg_loss = 10.142283692359925:  70%|███████   | 99/141 [02:32<01:05,  1.56s/it]avg_loss = 10.142283692359925:  71%|███████   | 100/141 [02:32<01:03,  1.56s/it]avg_loss = 10.15966787904796:  71%|███████   | 100/141 [02:34<01:03,  1.56s/it] avg_loss = 10.15966787904796:  72%|███████▏  | 101/141 [02:34<01:02,  1.56s/it]avg_loss = 10.124343110065833:  72%|███████▏  | 101/141 [02:35<01:02,  1.56s/it]avg_loss = 10.124343110065833:  72%|███████▏  | 102/141 [02:35<01:01,  1.57s/it]avg_loss = 10.144711887952193:  72%|███████▏  | 102/141 [02:37<01:01,  1.57s/it]avg_loss = 10.144711887952193:  73%|███████▎  | 103/141 [02:37<00:59,  1.56s/it]avg_loss = 10.169603049755096:  73%|███████▎  | 103/141 [02:38<00:59,  1.56s/it]avg_loss = 10.169603049755096:  74%|███████▍  | 104/141 [02:38<00:57,  1.56s/it]avg_loss = 10.144769732157389:  74%|███████▍  | 104/141 [02:40<00:57,  1.56s/it]avg_loss = 10.144769732157389:  74%|███████▍  | 105/141 [02:40<00:56,  1.57s/it]avg_loss = 10.155554141638413:  74%|███████▍  | 105/141 [02:41<00:56,  1.57s/it]avg_loss = 10.155554141638413:  75%|███████▌  | 106/141 [02:41<00:54,  1.57s/it]avg_loss = 10.145874219520069:  75%|███████▌  | 106/141 [02:43<00:54,  1.57s/it]avg_loss = 10.145874219520069:  76%|███████▌  | 107/141 [02:43<00:53,  1.57s/it]avg_loss = 10.140749595783374:  76%|███████▌  | 107/141 [02:45<00:53,  1.57s/it]avg_loss = 10.140749595783374:  77%|███████▋  | 108/141 [02:45<00:51,  1.58s/it]avg_loss = 10.128967985100703:  77%|███████▋  | 108/141 [02:46<00:51,  1.58s/it]avg_loss = 10.128967985100703:  77%|███████▋  | 109/141 [02:46<00:50,  1.58s/it]avg_loss = 10.118100608478892:  77%|███████▋  | 109/141 [02:48<00:50,  1.58s/it]avg_loss = 10.118100608478892:  78%|███████▊  | 110/141 [02:48<00:48,  1.58s/it]avg_loss = 10.155276418806196:  78%|███████▊  | 110/141 [02:49<00:48,  1.58s/it]avg_loss = 10.155276418806196:  79%|███████▊  | 111/141 [02:49<00:47,  1.57s/it]avg_loss = 10.135861132826124:  79%|███████▊  | 111/141 [02:51<00:47,  1.57s/it]avg_loss = 10.135861132826124:  79%|███████▉  | 112/141 [02:51<00:45,  1.58s/it]avg_loss = 10.116846168990683:  79%|███████▉  | 112/141 [02:53<00:45,  1.58s/it]avg_loss = 10.116846168990683:  80%|████████  | 113/141 [02:53<00:44,  1.58s/it]avg_loss = 10.08822991136919:  80%|████████  | 113/141 [02:54<00:44,  1.58s/it] avg_loss = 10.08822991136919:  81%|████████  | 114/141 [02:54<00:42,  1.58s/it]avg_loss = 10.10793982381406:  81%|████████  | 114/141 [02:56<00:42,  1.58s/it]avg_loss = 10.10793982381406:  82%|████████▏ | 115/141 [02:56<00:40,  1.57s/it]avg_loss = 10.127480379466352:  82%|████████▏ | 115/141 [02:57<00:40,  1.57s/it]avg_loss = 10.127480379466352:  82%|████████▏ | 116/141 [02:57<00:39,  1.57s/it]avg_loss = 10.107855866097996:  82%|████████▏ | 116/141 [02:59<00:39,  1.57s/it]avg_loss = 10.107855866097996:  83%|████████▎ | 117/141 [02:59<00:37,  1.58s/it]avg_loss = 10.118093858330937:  83%|████████▎ | 117/141 [03:00<00:37,  1.58s/it]avg_loss = 10.118093858330937:  84%|████████▎ | 118/141 [03:00<00:36,  1.57s/it]avg_loss = 10.124975360742136:  84%|████████▎ | 118/141 [03:02<00:36,  1.57s/it]avg_loss = 10.124975360742136:  84%|████████▍ | 119/141 [03:02<00:34,  1.56s/it]avg_loss = 10.148926548163097:  84%|████████▍ | 119/141 [03:03<00:34,  1.56s/it]avg_loss = 10.148926548163097:  85%|████████▌ | 120/141 [03:03<00:32,  1.56s/it]avg_loss = 10.11180407941834:  85%|████████▌ | 120/141 [03:05<00:32,  1.56s/it] avg_loss = 10.11180407941834:  86%|████████▌ | 121/141 [03:05<00:31,  1.57s/it]avg_loss = 10.111153500979064:  86%|████████▌ | 121/141 [03:07<00:31,  1.57s/it]avg_loss = 10.111153500979064:  87%|████████▋ | 122/141 [03:07<00:29,  1.57s/it]avg_loss = 10.127560972198237:  87%|████████▋ | 122/141 [03:08<00:29,  1.57s/it]avg_loss = 10.127560972198237:  87%|████████▋ | 123/141 [03:08<00:28,  1.56s/it]avg_loss = 10.136719134546095:  87%|████████▋ | 123/141 [03:10<00:28,  1.56s/it]avg_loss = 10.136719134546095:  88%|████████▊ | 124/141 [03:10<00:26,  1.56s/it]avg_loss = 10.134017738342285:  88%|████████▊ | 124/141 [03:11<00:26,  1.56s/it]avg_loss = 10.134017738342285:  89%|████████▊ | 125/141 [03:11<00:24,  1.56s/it]avg_loss = 10.136117359948537:  89%|████████▊ | 125/141 [03:13<00:24,  1.56s/it]avg_loss = 10.136117359948537:  89%|████████▉ | 126/141 [03:13<00:23,  1.56s/it]avg_loss = 10.147073798292265:  89%|████████▉ | 126/141 [03:14<00:23,  1.56s/it]avg_loss = 10.147073798292265:  90%|█████████ | 127/141 [03:14<00:21,  1.56s/it]avg_loss = 10.147466614842415:  90%|█████████ | 127/141 [03:16<00:21,  1.56s/it]avg_loss = 10.147466614842415:  91%|█████████ | 128/141 [03:16<00:20,  1.56s/it]avg_loss = 10.16030843867812:  91%|█████████ | 128/141 [03:18<00:20,  1.56s/it] avg_loss = 10.16030843867812:  91%|█████████▏| 129/141 [03:18<00:18,  1.56s/it]avg_loss = 10.125086681659406:  91%|█████████▏| 129/141 [03:19<00:18,  1.56s/it]avg_loss = 10.125086681659406:  92%|█████████▏| 130/141 [03:19<00:17,  1.57s/it]avg_loss = 10.11909034233967:  92%|█████████▏| 130/141 [03:21<00:17,  1.57s/it] avg_loss = 10.11909034233967:  93%|█████████▎| 131/141 [03:21<00:15,  1.57s/it]avg_loss = 10.134004925236557:  93%|█████████▎| 131/141 [03:22<00:15,  1.57s/it]avg_loss = 10.134004925236557:  94%|█████████▎| 132/141 [03:22<00:14,  1.57s/it]avg_loss = 10.132925937050267:  94%|█████████▎| 132/141 [03:24<00:14,  1.57s/it]avg_loss = 10.132925937050267:  94%|█████████▍| 133/141 [03:24<00:12,  1.57s/it]avg_loss = 10.090787293306038:  94%|█████████▍| 133/141 [03:25<00:12,  1.57s/it]avg_loss = 10.090787293306038:  95%|█████████▌| 134/141 [03:25<00:11,  1.57s/it]avg_loss = 10.084271653493245:  95%|█████████▌| 134/141 [03:27<00:11,  1.57s/it]avg_loss = 10.084271653493245:  96%|█████████▌| 135/141 [03:27<00:09,  1.57s/it]avg_loss = 10.09051108710906:  96%|█████████▌| 135/141 [03:29<00:09,  1.57s/it] avg_loss = 10.09051108710906:  96%|█████████▋| 136/141 [03:29<00:07,  1.57s/it]avg_loss = 10.099607923605147:  96%|█████████▋| 136/141 [03:30<00:07,  1.57s/it]avg_loss = 10.099607923605147:  97%|█████████▋| 137/141 [03:30<00:06,  1.56s/it]avg_loss = 10.105829650077267:  97%|█████████▋| 137/141 [03:32<00:06,  1.56s/it]avg_loss = 10.105829650077267:  98%|█████████▊| 138/141 [03:32<00:04,  1.56s/it]avg_loss = 10.107279417326124:  98%|█████████▊| 138/141 [03:33<00:04,  1.56s/it]avg_loss = 10.107279417326124:  99%|█████████▊| 139/141 [03:33<00:03,  1.56s/it]avg_loss = 10.102165273257665:  99%|█████████▊| 139/141 [03:35<00:03,  1.56s/it]avg_loss = 10.102165273257665:  99%|█████████▉| 140/141 [03:35<00:01,  1.57s/it]avg_loss = 10.098891599803952:  99%|█████████▉| 140/141 [03:36<00:01,  1.57s/it]avg_loss = 10.098891599803952: 100%|██████████| 141/141 [03:36<00:00,  1.57s/it]avg_loss = 10.098891599803952: 100%|██████████| 141/141 [03:36<00:00,  1.54s/it]
I0323 16:49:13.181417 3902990 eval_ppl.py:107] wikitext2 perplexity: 24316.03515625
wikitext2 perplexity: 24316.035
