I0323 17:07:24.088859 3928311 config.py:54] PyTorch version 2.6.0 available.
W0323 17:07:24.373350 3928311 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:07:25.255824 3928311 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.07it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.68it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.97it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.15it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.21it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.27it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.88it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.95it/s]
I0323 17:07:26.705010 3928311 quantize_finetune_llama.py:150] loaded model
I0323 17:07:27.009514 3928311 quantize_finetune_llama.py:185] loaded compression model
I0323 17:07:46.265956 3928311 quantize_finetune_llama.py:189] loaded dataset and devset
I0323 17:07:52.210513 3928311 quantize_finetune_llama.py:209] layer 0 gpu 0
I0323 17:07:55.581977 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 3.217416524887085s
Use train scale and shift
tensor(8.8814e-08, device='cuda:0') tensor(0.0134, device='cuda:0')
tensor(0.0134, device='cuda:0') tensor(8.8814e-08, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0323 17:08:08.581337 3929343 config.py:54] PyTorch version 2.6.0 available.
W0323 17:08:08.889278 3929343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:08:09.889620 3929343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:08:09.893937 3928311 quantize_finetune_llama.py:209] layer 1 gpu 1
I0323 17:08:10.285709 3929343 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:08:12.992960 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 2.9221513271331787s
I0323 17:08:16.749485 3929526 config.py:54] PyTorch version 2.6.0 available.
W0323 17:08:17.068242 3929526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:08:18.136936 3929526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:08:18.140908 3928311 quantize_finetune_llama.py:209] layer 2 gpu 2
I0323 17:08:18.495199 3929526 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:08:21.079808 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 2.7807772159576416s
I0323 17:08:24.988349 3929730 config.py:54] PyTorch version 2.6.0 available.
W0323 17:08:25.330514 3929730 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:08:26.372630 3929730 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:08:26.376682 3928311 quantize_finetune_llama.py:209] layer 3 gpu 3
I0323 17:08:26.613496 3929730 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:08:29.555503 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 2.9891557693481445s
I0323 17:08:33.700514 3929934 config.py:54] PyTorch version 2.6.0 available.
W0323 17:08:34.039605 3929934 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:08:35.026344 3929934 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:08:35.030645 3928311 quantize_finetune_llama.py:209] layer 4 gpu 0
I0323 17:08:35.267433 3929934 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.005973249673843384 tr(WHW.T) 59.109249114990234
bpp_loss 5.512251853942871
0_q proxy err 0.00014814260066486895 tr(WHW.T) 288041.78125
bpp_loss 3.9796385765075684
0_k proxy err 7.769562944304198e-05 tr(WHW.T) 100152.8671875
bpp_loss 5.478221893310547
0_o proxy err 0.001822733785957098 tr(WHW.T) 3113.9609375
bpp_loss 4.019473552703857
0_up proxy err 0.011710678227245808 tr(WHW.T) 8859.7275390625
bpp_loss 3.3441974094935825
0_gate proxy err 0.008093031123280525 tr(WHW.T) 15700.0
bpp_loss 3.3441032682146346
0_down proxy err 0.003639958566054702 tr(WHW.T) 10753.7939453125
bpp_loss 4.0250782285417825
1_v proxy err 0.004689852241426706 tr(WHW.T) 106.54676055908203
bpp_loss 5.518040418624878
1_q proxy err 0.00027633848367258906 tr(WHW.T) 144769.71875
bpp_loss 4.0087666511535645
1_k proxy err 9.435629181098193e-05 tr(WHW.T) 75510.046875
bpp_loss 5.493572235107422
1_o proxy err 0.0036824538838118315 tr(WHW.T) 1971.8739013671875
bpp_loss 4.024685859680176
1_up proxy err 0.013067455030977726 tr(WHW.T) 8164.14208984375
bpp_loss 3.344204902648926
1_gate proxy err 0.00935477763414383 tr(WHW.T) 13871.78125
bpp_loss 3.3441901888166154
1_down proxy err 0.002232202095910907 tr(WHW.T) 13911.810546875
bpp_loss 3.598458630698068
I0323 17:09:42.124608 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 1.0255742073059082s
I0323 17:09:46.207719 3931085 config.py:54] PyTorch version 2.6.0 available.
W0323 17:09:46.576050 3931085 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:09:47.620187 3931085 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:09:47.624633 3928311 quantize_finetune_llama.py:209] layer 5 gpu 1
I0323 17:09:47.988248 3931085 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.0022959995549172163 tr(WHW.T) 154.1771240234375
bpp_loss 5.520109415054321
2_q proxy err 0.0007917273323982954 tr(WHW.T) 41423.8046875
bpp_loss 4.0222978591918945
2_k proxy err 0.0002795916807372123 tr(WHW.T) 22584.275390625
bpp_loss 5.515949487686157
2_o proxy err 0.003145672148093581 tr(WHW.T) 1957.195556640625
bpp_loss 4.022979497909546
2_up proxy err 0.014012167230248451 tr(WHW.T) 7534.43212890625
bpp_loss 3.3442626680646623
2_gate proxy err 0.00913383811712265 tr(WHW.T) 15028.0859375
bpp_loss 3.344235828944615
2_down proxy err 0.00524664344266057 tr(WHW.T) 7660.255859375
bpp_loss 4.025381292615618
I0323 17:09:52.683938 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 1.009838342666626s
I0323 17:09:56.655782 3931324 config.py:54] PyTorch version 2.6.0 available.
W0323 17:09:57.019812 3931324 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:09:58.132352 3931324 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:09:58.136587 3928311 quantize_finetune_llama.py:209] layer 6 gpu 2
I0323 17:09:58.489132 3931324 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.001747789210639894 tr(WHW.T) 286.8193664550781
bpp_loss 5.520841360092163
3_q proxy err 0.0007024907972663641 tr(WHW.T) 47525.1171875
bpp_loss 4.021624803543091
3_k proxy err 0.0002445836435072124 tr(WHW.T) 26144.298828125
bpp_loss 5.513791084289551
3_o proxy err 0.004347801674157381 tr(WHW.T) 1843.92529296875
bpp_loss 4.024764776229858
3_up proxy err 0.013615692034363747 tr(WHW.T) 7472.86376953125
bpp_loss 3.3442629405430386
3_gate proxy err 0.007476947270333767 tr(WHW.T) 20788.29296875
bpp_loss 3.3441197531563893
3_down proxy err 0.005521685816347599 tr(WHW.T) 6935.24755859375
bpp_loss 4.02542918069022
I0323 17:10:01.343745 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.8283240795135498s
I0323 17:10:05.304079 3931516 config.py:54] PyTorch version 2.6.0 available.
W0323 17:10:05.648847 3931516 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:10:06.613796 3931516 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:10:06.617677 3928311 quantize_finetune_llama.py:209] layer 7 gpu 3
I0323 17:10:06.788117 3931516 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:10:08.193455 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 1.0916118621826172s
I0323 17:10:12.747977 3931696 config.py:54] PyTorch version 2.6.0 available.
W0323 17:10:13.126587 3931696 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:10:14.322036 3931696 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:10:14.326263 3928311 quantize_finetune_llama.py:209] layer 8 gpu 0
I0323 17:10:14.724220 3931696 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.0020595090463757515 tr(WHW.T) 282.38128662109375
bpp_loss 5.520511865615845
4_q proxy err 0.0006516758585348725 tr(WHW.T) 50064.37109375
bpp_loss 4.020586967468262
4_k proxy err 0.00021045260655228049 tr(WHW.T) 29272.75390625
bpp_loss 5.51171612739563
4_o proxy err 0.006509112194180489 tr(WHW.T) 1283.4017333984375
bpp_loss 4.0246429443359375
4_up proxy err 0.013198559172451496 tr(WHW.T) 7323.07763671875
bpp_loss 3.344240188598633
4_gate proxy err 0.006009194068610668 tr(WHW.T) 29023.8984375
bpp_loss 3.3440542221069336
4_down proxy err 0.005738545209169388 tr(WHW.T) 6335.5126953125
bpp_loss 4.025481837136405
5_v proxy err 0.0019324433524161577 tr(WHW.T) 206.8122100830078
bpp_loss 5.519184589385986
5_q proxy err 0.0008795956382527947 tr(WHW.T) 35941.703125
bpp_loss 4.0212485790252686
5_k proxy err 0.000267189898295328 tr(WHW.T) 22968.27734375
bpp_loss 5.512710809707642
5_o proxy err 0.006853621918708086 tr(WHW.T) 1043.734619140625
bpp_loss 4.024617671966553
5_up proxy err 0.012873008847236633 tr(WHW.T) 7595.3154296875
bpp_loss 3.3443290165492465
5_gate proxy err 0.005761140026152134 tr(WHW.T) 30279.96875
bpp_loss 3.3438566752842496
5_down proxy err 0.00577808590605855 tr(WHW.T) 6350.38623046875
bpp_loss 4.025629247937884
I0323 17:11:26.824565 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.5363483428955078s
I0323 17:11:30.759045 3932942 config.py:54] PyTorch version 2.6.0 available.
W0323 17:11:31.097779 3932942 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

6_v proxy err 0.001888167462311685 tr(WHW.T) 251.2519073486328
bpp_loss 5.520186901092529
6_q proxy err 0.0009226618567481637 tr(WHW.T) 35587.6171875
bpp_loss 4.021861553192139
6_k proxy err 0.0002366519474890083 tr(WHW.T) 26134.267578125
bpp_loss 5.513695001602173
6_o proxy err 0.0078056855127215385 tr(WHW.T) 996.2373657226562
bpp_loss 4.024825572967529
6_up proxy err 0.012443735264241695 tr(WHW.T) 7862.4482421875
bpp_loss 3.344245229448591
6_gate proxy err 0.0049753631465137005 tr(WHW.T) 35640.2578125
bpp_loss 3.3438546316964284
6_down proxy err 0.005703116301447153 tr(WHW.T) 6422.8779296875
bpp_loss 4.0253923279898505
W0323 17:11:32.087739 3932942 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:11:32.091993 3928311 quantize_finetune_llama.py:209] layer 9 gpu 1
I0323 17:11:32.270465 3932942 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:11:33.525662 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 0.9612295627593994s
I0323 17:11:37.246831 3933117 config.py:54] PyTorch version 2.6.0 available.
W0323 17:11:37.592823 3933117 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.0015177539316937327 tr(WHW.T) 307.0851135253906
bpp_loss 5.519613027572632
7_q proxy err 0.0008657589205540717 tr(WHW.T) 35097.21875
bpp_loss 4.02197003364563
7_k proxy err 0.00023627682821825147 tr(WHW.T) 26820.58203125
bpp_loss 5.513005971908569
7_o proxy err 0.0085068354383111 tr(WHW.T) 945.8643798828125
bpp_loss 4.025108575820923
7_up proxy err 0.011748888529837132 tr(WHW.T) 8564.646484375
bpp_loss 3.3442513602120534
7_gate proxy err 0.004910686053335667 tr(WHW.T) 34799.35546875
bpp_loss 3.3437352861676897
7_down proxy err 0.005824817810207605 tr(WHW.T) 6472.18505859375
bpp_loss 4.02553163255964
W0323 17:11:38.643033 3933117 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:11:38.647218 3928311 quantize_finetune_llama.py:209] layer 10 gpu 2
I0323 17:11:38.807833 3933117 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:11:40.633968 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.8488500118255615s
I0323 17:11:44.277808 3933287 config.py:54] PyTorch version 2.6.0 available.
W0323 17:11:44.601890 3933287 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:11:45.508397 3933287 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:11:45.512150 3928311 quantize_finetune_llama.py:209] layer 11 gpu 3
I0323 17:11:45.770058 3933287 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:11:46.862679 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 0.9210679531097412s
I0323 17:11:50.732029 3933440 config.py:54] PyTorch version 2.6.0 available.
W0323 17:11:51.080994 3933440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:11:52.216054 3933440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:11:52.220328 3928311 quantize_finetune_llama.py:209] layer 12 gpu 0
I0323 17:11:52.399496 3933440 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.002017219318076968 tr(WHW.T) 255.12034606933594
bpp_loss 5.519868612289429
8_q proxy err 0.0011357119074091315 tr(WHW.T) 26552.91015625
bpp_loss 4.0203142166137695
8_k proxy err 0.00027292652521282434 tr(WHW.T) 22499.31640625
bpp_loss 5.511282920837402
8_o proxy err 0.01138158980756998 tr(WHW.T) 731.734619140625
bpp_loss 4.024928331375122
8_up proxy err 0.011825977824628353 tr(WHW.T) 8432.8056640625
bpp_loss 3.3442281995500838
8_gate proxy err 0.00464665936306119 tr(WHW.T) 37132.96875
bpp_loss 3.343707493373326
8_down proxy err 0.005823927465826273 tr(WHW.T) 6426.78076171875
bpp_loss 4.025525024959019
9_v proxy err 0.001996788429096341 tr(WHW.T) 347.93878173828125
bpp_loss 5.519757270812988
9_q proxy err 0.0011716013541445136 tr(WHW.T) 25605.146484375
bpp_loss 4.020018577575684
9_k proxy err 0.00029359664767980576 tr(WHW.T) 20913.2890625
bpp_loss 5.512899398803711
9_o proxy err 0.012534121982753277 tr(WHW.T) 760.7015380859375
bpp_loss 4.025141477584839
9_up proxy err 0.011410192586481571 tr(WHW.T) 8907.26953125
bpp_loss 3.3442065375191823
9_gate proxy err 0.004511731676757336 tr(WHW.T) 39307.90625
bpp_loss 3.3436532701764787
9_down proxy err 0.006069995928555727 tr(WHW.T) 6210.4736328125
bpp_loss 4.025487082345145
I0323 17:12:52.934772 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 0.9606249332427979s
I0323 17:12:56.732667 3934532 config.py:54] PyTorch version 2.6.0 available.
W0323 17:12:57.078840 3934532 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:12:58.156244 3934532 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:12:58.160727 3928311 quantize_finetune_llama.py:209] layer 13 gpu 1
I0323 17:12:58.366850 3934532 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.002010971074923873 tr(WHW.T) 249.3217315673828
bpp_loss 5.519282817840576
10_q proxy err 0.0013286462053656578 tr(WHW.T) 23288.234375
bpp_loss 4.021646976470947
10_k proxy err 0.0003141901397611946 tr(WHW.T) 19713.98828125
bpp_loss 5.513183832168579
10_o proxy err 0.012197878211736679 tr(WHW.T) 667.1098022460938
bpp_loss 4.025076627731323
10_up proxy err 0.011480695568025112 tr(WHW.T) 9133.763671875
bpp_loss 3.344250406537737
10_gate proxy err 0.004527759738266468 tr(WHW.T) 37296.734375
bpp_loss 3.343600409371512
10_down proxy err 0.005997139029204845 tr(WHW.T) 6460.98828125
bpp_loss 4.025537150246756
I0323 17:13:00.878606 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 0.8997898101806641s
11_v proxy err 0.0015473058447241783 tr(WHW.T) 317.10748291015625
bpp_loss 5.519186973571777
11_q proxy err 0.0012574074789881706 tr(WHW.T) 22146.080078125
bpp_loss 4.022219181060791
11_k proxy err 0.00033618774614296854 tr(WHW.T) 17998.236328125
bpp_loss 5.512562274932861
11_o proxy err 0.015416127629578114 tr(WHW.T) 551.7962036132812
bpp_loss 4.025017023086548
11_up proxy err 0.011643163859844208 tr(WHW.T) 9126.3212890625
bpp_loss 3.3441807883126393
11_gate proxy err 0.00448157312348485 tr(WHW.T) 36783.98828125
bpp_loss 3.343509946550642
11_down proxy err 0.005978283938020468 tr(WHW.T) 6590.6376953125
bpp_loss 4.025474480220249
I0323 17:13:04.598808 3934712 config.py:54] PyTorch version 2.6.0 available.
W0323 17:13:04.891506 3934712 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:13:05.810968 3934712 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:13:05.815433 3928311 quantize_finetune_llama.py:209] layer 14 gpu 2
I0323 17:13:05.971498 3934712 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:13:07.208227 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 0.9791073799133301s
I0323 17:13:10.847409 3934870 config.py:54] PyTorch version 2.6.0 available.
W0323 17:13:11.142704 3934870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:13:12.066917 3934870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:13:12.070937 3928311 quantize_finetune_llama.py:209] layer 15 gpu 3
I0323 17:13:12.277060 3934870 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:13:13.598834 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.9680233001708984s
I0323 17:13:17.482422 3935048 config.py:54] PyTorch version 2.6.0 available.
W0323 17:13:17.856322 3935048 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:13:18.927804 3935048 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:13:18.932261 3928311 quantize_finetune_llama.py:209] layer 16 gpu 0
I0323 17:13:19.189156 3935048 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.0018964698538184166 tr(WHW.T) 360.1876220703125
bpp_loss 5.519012212753296
12_q proxy err 0.0008565843454562128 tr(WHW.T) 34056.6171875
bpp_loss 4.020587205886841
12_k proxy err 0.0002551569778006524 tr(WHW.T) 23029.2578125
bpp_loss 5.513578176498413
12_o proxy err 0.012419028207659721 tr(WHW.T) 763.9736938476562
bpp_loss 4.024939298629761
12_up proxy err 0.011095029301941395 tr(WHW.T) 9958.251953125
bpp_loss 3.344285692487444
12_gate proxy err 0.004325452260673046 tr(WHW.T) 37236.3125
bpp_loss 3.3435217993600026
12_down proxy err 0.006007110234349966 tr(WHW.T) 6755.458984375
bpp_loss 4.025284971509661
13_v proxy err 0.0020995279774069786 tr(WHW.T) 277.2203063964844
bpp_loss 5.52028226852417
13_q proxy err 0.0013977764174342155 tr(WHW.T) 20850.333984375
bpp_loss 4.020261526107788
13_k proxy err 0.00034673145273700356 tr(WHW.T) 17769.017578125
bpp_loss 5.513298749923706
13_o proxy err 0.013700469397008419 tr(WHW.T) 660.1426391601562
bpp_loss 4.024761199951172
13_up proxy err 0.011179381050169468 tr(WHW.T) 9940.990234375
bpp_loss 3.3442441395350864
13_gate proxy err 0.004177621100097895 tr(WHW.T) 38823.03515625
bpp_loss 3.3437675748552596
13_down proxy err 0.006246637552976608 tr(WHW.T) 6493.29833984375
bpp_loss 4.025381360735212
I0323 17:14:24.880162 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 0.9406166076660156s
14_v proxy err 0.0020586075261235237 tr(WHW.T) 278.4633483886719
bpp_loss 5.519150018692017
14_q proxy err 0.0013418147573247552 tr(WHW.T) 20836.7890625
bpp_loss 4.022112846374512
14_k proxy err 0.00032842368818819523 tr(WHW.T) 18589.970703125
bpp_loss 5.514740228652954
14_o proxy err 0.013356160372495651 tr(WHW.T) 671.372314453125
bpp_loss 4.025322437286377
14_up proxy err 0.012103112414479256 tr(WHW.T) 9095.5224609375
bpp_loss 3.344215529305594
14_gate proxy err 0.004091806709766388 tr(WHW.T) 41682.6328125
bpp_loss 3.3439185278756276
14_down proxy err 0.006381136365234852 tr(WHW.T) 6324.00830078125
bpp_loss 4.025458472115653
I0323 17:14:28.657709 3936251 config.py:54] PyTorch version 2.6.0 available.
W0323 17:14:28.985193 3936251 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0323 17:14:29.958675 3936251 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:14:29.962932 3928311 quantize_finetune_llama.py:209] layer 17 gpu 1
I0323 17:14:30.175522 3936251 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:14:31.275278 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.8512749671936035s
I0323 17:14:35.075297 3936400 config.py:54] PyTorch version 2.6.0 available.
W0323 17:14:35.418259 3936400 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.002415964612737298 tr(WHW.T) 280.61700439453125
bpp_loss 5.520244359970093
15_q proxy err 0.0012231559958308935 tr(WHW.T) 28024.23046875
bpp_loss 4.022270679473877
15_k proxy err 0.0003133799182251096 tr(WHW.T) 18843.171875
bpp_loss 5.515873670578003
15_o proxy err 0.011881250888109207 tr(WHW.T) 811.894287109375
bpp_loss 4.024853706359863
15_up proxy err 0.01213814690709114 tr(WHW.T) 8926.90625
bpp_loss 3.344268117632185
15_gate proxy err 0.00389813887886703 tr(WHW.T) 46109.49609375
bpp_loss 3.343650681631906
15_down proxy err 0.006305272690951824 tr(WHW.T) 6333.17138671875
bpp_loss 4.025602749415806
W0323 17:14:36.395551 3936400 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0323 17:14:36.399561 3928311 quantize_finetune_llama.py:209] layer 18 gpu 2
I0323 17:14:36.580612 3936400 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0323 17:14:38.212735 3928311 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.8216040134429932s
