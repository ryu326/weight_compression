I0320 18:02:46.789325 1510985 config.py:54] PyTorch version 2.6.0 available.
W0320 18:02:47.073244 1510985 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:02:48.034140 1510985 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.39it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.91it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.10it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.21it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.27it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.96it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.01it/s]
I0320 18:02:48.986498 1510985 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:14,  2.11it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:13,  2.26it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:12,  2.35it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:11,  2.42it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:10,  2.47it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:10,  2.50it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:09,  2.52it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:09,  2.53it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:09,  2.53it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:08,  2.54it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.54it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:04<00:07,  2.54it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.54it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.55it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:06,  2.54it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.54it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:06<00:05,  2.53it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.53it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:07<00:05,  2.53it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:07<00:04,  2.53it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.51it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:08<00:03,  2.52it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.52it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:09<00:03,  2.53it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:09<00:02,  2.52it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.54it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:10<00:01,  2.55it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.52it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:11<00:01,  2.54it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:11<00:00,  2.55it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.51it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.53it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.51it/s]
I0320 18:03:06.080456 1510985 quantize_finetune_llama.py:179] loaded compression model
I0320 18:03:20.609063 1510985 quantize_finetune_llama.py:183] loaded dataset and devset
I0320 18:03:25.653894 1510985 quantize_finetune_llama.py:203] layer 0 gpu 0
I0320 18:03:27.760961 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 1.9385194778442383s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0320 18:03:44.613568 1511177 config.py:54] PyTorch version 2.6.0 available.
W0320 18:03:44.893795 1511177 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:03:45.787912 1511177 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:03:45.803270 1510985 quantize_finetune_llama.py:203] layer 1 gpu 1
I0320 18:03:45.806887 1511177 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:03:47.960457 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 1.9966981410980225s
I0320 18:03:51.490279 1511238 config.py:54] PyTorch version 2.6.0 available.
W0320 18:03:51.782437 1511238 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:03:52.672335 1511238 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:03:52.676715 1510985 quantize_finetune_llama.py:203] layer 2 gpu 2
I0320 18:03:52.692904 1511238 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:03:55.662633 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 2.811018466949463s
I0320 18:03:59.482191 1511299 config.py:54] PyTorch version 2.6.0 available.
W0320 18:03:59.826100 1511299 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:04:00.833677 1511299 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:04:00.837968 1510985 quantize_finetune_llama.py:203] layer 3 gpu 3
I0320 18:04:00.854375 1511299 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:04:04.987121 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 3.962118148803711s
I0320 18:04:08.822276 1511363 config.py:54] PyTorch version 2.6.0 available.
W0320 18:04:09.196910 1511363 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:04:10.296981 1511363 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:04:10.301519 1510985 quantize_finetune_llama.py:203] layer 4 gpu 0
I0320 18:04:10.318312 1511363 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.031434882432222366 tr(WHW.T) 4.225186347961426
bpp_loss 2.1154738664627075
0_q proxy err 0.0008438107324764132 tr(WHW.T) 2710.363037109375
bpp_loss 2.0998228788375854
0_k proxy err 0.0011484596179798245 tr(WHW.T) 1698.7349853515625
bpp_loss 2.20475435256958
0_o proxy err 0.014495850540697575 tr(WHW.T) 0.9668058156967163
bpp_loss 1.9566206336021423
0_up proxy err 0.023848960176110268 tr(WHW.T) 43.27138900756836
bpp_loss 2.4009579503258993
0_gate proxy err 0.016607854515314102 tr(WHW.T) 63.47430419921875
bpp_loss 2.4129375191622002
0_down proxy err 0.019412316381931305 tr(WHW.T) 0.656814694404602
bpp_loss 2.437018483184105
1_v proxy err 0.05555896461009979 tr(WHW.T) 16.465883255004883
bpp_loss 2.100206732749939
1_q proxy err 0.0007237334502860904 tr(WHW.T) 4778.43994140625
bpp_loss 2.7628965377807617
1_k proxy err 0.0007371738902293146 tr(WHW.T) 4995.39208984375
bpp_loss 2.770904779434204
1_o proxy err 0.04734179005026817 tr(WHW.T) 1.1115814447402954
bpp_loss 1.9968346953392029
1_up proxy err 0.029408970847725868 tr(WHW.T) 109.66383361816406
bpp_loss 2.4595506357592205
1_gate proxy err 0.01567198522388935 tr(WHW.T) 221.3038787841797
bpp_loss 2.5154738315316134
1_down proxy err 0.001583016011863947 tr(WHW.T) 2041.4736328125
bpp_loss 2.4738366548405137
I0320 18:04:37.137797 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.8655552864074707s
I0320 18:04:41.066239 1511455 config.py:54] PyTorch version 2.6.0 available.
W0320 18:04:41.420738 1511455 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:04:42.415552 1511455 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:04:42.419708 1510985 quantize_finetune_llama.py:203] layer 5 gpu 1
I0320 18:04:42.435216 1511455 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.03429179638624191 tr(WHW.T) 136.67332458496094
bpp_loss 2.3105764389038086
2_q proxy err 0.0008991188951767981 tr(WHW.T) 7752.85205078125
bpp_loss 2.9410903453826904
2_k proxy err 0.0007174039492383599 tr(WHW.T) 10205.837890625
bpp_loss 2.9891988039016724
2_o proxy err 0.04637794569134712 tr(WHW.T) 1.4603197574615479
bpp_loss 2.2715728282928467
2_up proxy err 0.034978196024894714 tr(WHW.T) 193.43603515625
bpp_loss 2.478853092637173
2_gate proxy err 0.023070836439728737 tr(WHW.T) 306.6622619628906
bpp_loss 2.5526346605877546
2_down proxy err 0.039881739765405655 tr(WHW.T) 3.010739803314209
bpp_loss 2.4851280700328737
I0320 18:04:45.198291 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 0.8374054431915283s
I0320 18:04:48.989681 1511517 config.py:54] PyTorch version 2.6.0 available.
W0320 18:04:49.318817 1511517 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:04:50.307806 1511517 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:04:50.312201 1510985 quantize_finetune_llama.py:203] layer 6 gpu 2
I0320 18:04:50.328706 1511517 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.04459451511502266 tr(WHW.T) 284.77557373046875
bpp_loss 2.2861180305480957
3_q proxy err 0.0022724117152392864 tr(WHW.T) 7217.63720703125
bpp_loss 2.9030544757843018
3_k proxy err 0.001673122518695891 tr(WHW.T) 10074.73828125
bpp_loss 2.9505615234375
3_o proxy err 0.04559674859046936 tr(WHW.T) 3.3527450561523438
bpp_loss 2.2399299144744873
3_up proxy err 0.03923487663269043 tr(WHW.T) 284.7950744628906
bpp_loss 2.4866832467012627
3_gate proxy err 0.024702463299036026 tr(WHW.T) 478.13714599609375
bpp_loss 2.5680424002713935
3_down proxy err 0.04062977433204651 tr(WHW.T) 6.133229732513428
bpp_loss 2.4878879147906634
I0320 18:04:55.034836 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 0.8106622695922852s
I0320 18:04:58.845638 1511579 config.py:54] PyTorch version 2.6.0 available.
W0320 18:04:59.197826 1511579 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:05:00.211342 1511579 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:05:00.215605 1510985 quantize_finetune_llama.py:203] layer 7 gpu 3
I0320 18:05:00.231890 1511579 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:05:01.653710 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 0.9487709999084473s
I0320 18:05:05.492959 1511638 config.py:54] PyTorch version 2.6.0 available.
W0320 18:05:05.865492 1511638 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:05:06.949498 1511638 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:05:06.953803 1510985 quantize_finetune_llama.py:203] layer 8 gpu 0
I0320 18:05:06.970677 1511638 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.041864849627017975 tr(WHW.T) 274.6131286621094
bpp_loss 2.316724419593811
4_q proxy err 0.002094517694786191 tr(WHW.T) 6914.9892578125
bpp_loss 2.9783358573913574
4_k proxy err 0.0014440995873883367 tr(WHW.T) 10415.33203125
bpp_loss 2.9982380867004395
4_o proxy err 0.04587684944272041 tr(WHW.T) 5.139806270599365
bpp_loss 2.281483769416809
4_up proxy err 0.037650901824235916 tr(WHW.T) 397.6960144042969
bpp_loss 2.481393947157749
4_gate proxy err 0.019990526139736176 tr(WHW.T) 821.1856689453125
bpp_loss 2.5897073080373363
4_down proxy err 0.040584784001111984 tr(WHW.T) 11.562739372253418
bpp_loss 2.475574249445006
5_v proxy err 0.04317142069339752 tr(WHW.T) 298.47540283203125
bpp_loss 2.33823299407959
5_q proxy err 0.0023980499245226383 tr(WHW.T) 6770.97509765625
bpp_loss 2.996482014656067
5_k proxy err 0.001571395667269826 tr(WHW.T) 10841.955078125
bpp_loss 3.042120933532715
5_o proxy err 0.0573713593184948 tr(WHW.T) 7.947142601013184
bpp_loss 2.303250551223755
5_up proxy err 0.03701382502913475 tr(WHW.T) 506.6408386230469
bpp_loss 2.4813455980877546
5_gate proxy err 0.018704107031226158 tr(WHW.T) 1104.867919921875
bpp_loss 2.5948122601176418
5_down proxy err 0.04271789267659187 tr(WHW.T) 15.6494779586792
bpp_loss 2.476400530615518
I0320 18:05:35.145837 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 0.8602275848388672s
I0320 18:05:38.970958 1511733 config.py:54] PyTorch version 2.6.0 available.
W0320 18:05:39.295900 1511733 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:05:40.249749 1511733 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:05:40.253902 1510985 quantize_finetune_llama.py:203] layer 9 gpu 1
I0320 18:05:40.269162 1511733 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.03982945531606674 tr(WHW.T) 443.5464782714844
bpp_loss 2.3823647499084473
6_q proxy err 0.0033754233736544847 tr(WHW.T) 7576.53857421875
bpp_loss 2.8906577825546265
6_k proxy err 0.002513185376301408 tr(WHW.T) 10409.4033203125
bpp_loss 2.9143117666244507
6_o proxy err 0.05880223959684372 tr(WHW.T) 11.564380645751953
bpp_loss 2.249267339706421
6_up proxy err 0.03668912500143051 tr(WHW.T) 617.2608642578125
bpp_loss 2.479033714117006
6_gate proxy err 0.01617673970758915 tr(WHW.T) 1554.7271728515625
bpp_loss 2.6146278381347656
6_down proxy err 0.04394726827740669 tr(WHW.T) 22.988168716430664
bpp_loss 2.4707627407340116
I0320 18:05:45.043183 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 0.822089672088623s
I0320 18:05:48.966583 1511798 config.py:54] PyTorch version 2.6.0 available.
7_v proxy err 0.03675096482038498 tr(WHW.T) 489.9357604980469
bpp_loss 2.447405695915222
7_q proxy err 0.0036420298274606466 tr(WHW.T) 7672.17919921875
bpp_loss 2.8867326974868774
7_k proxy err 0.0027871220372617245 tr(WHW.T) 10198.3701171875
bpp_loss 2.8958150148391724
7_o proxy err 0.06500392407178879 tr(WHW.T) 15.11335563659668
bpp_loss 2.256474018096924
7_up proxy err 0.03518626093864441 tr(WHW.T) 735.8538818359375
bpp_loss 2.4860733387082123
7_gate proxy err 0.015384044498205185 tr(WHW.T) 1876.0390625
bpp_loss 2.614727729974791
7_down proxy err 0.04432962089776993 tr(WHW.T) 30.58672523498535
bpp_loss 2.472257924634357
W0320 18:05:49.272731 1511798 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:05:50.156962 1511798 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:05:50.161199 1510985 quantize_finetune_llama.py:203] layer 10 gpu 2
I0320 18:05:50.176652 1511798 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:05:51.484472 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 0.8418121337890625s
I0320 18:05:55.128421 1511854 config.py:54] PyTorch version 2.6.0 available.
W0320 18:05:55.474264 1511854 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:05:56.470017 1511854 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:05:56.474116 1510985 quantize_finetune_llama.py:203] layer 11 gpu 3
I0320 18:05:56.489472 1511854 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:05:57.947461 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.0040934085845947s
I0320 18:06:01.967217 1511913 config.py:54] PyTorch version 2.6.0 available.
W0320 18:06:02.305630 1511913 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:06:03.228318 1511913 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:06:03.232383 1510985 quantize_finetune_llama.py:203] layer 12 gpu 0
I0320 18:06:03.247276 1511913 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.03755516931414604 tr(WHW.T) 530.9967041015625
bpp_loss 2.386865496635437
8_q proxy err 0.003727265866473317 tr(WHW.T) 7228.1201171875
bpp_loss 2.90063214302063
8_k proxy err 0.002590218558907509 tr(WHW.T) 10639.1015625
bpp_loss 2.914947032928467
8_o proxy err 0.0734814703464508 tr(WHW.T) 20.092191696166992
bpp_loss 2.2810062170028687
8_up proxy err 0.032064054161310196 tr(WHW.T) 866.312744140625
bpp_loss 2.4996335229208304
8_gate proxy err 0.015422680415213108 tr(WHW.T) 1970.857177734375
bpp_loss 2.5984563605729925
8_down proxy err 0.04412549361586571 tr(WHW.T) 37.177734375
bpp_loss 2.482704195865365
9_v proxy err 0.037799619138240814 tr(WHW.T) 565.0663452148438
bpp_loss 2.394407033920288
9_q proxy err 0.00408259266987443 tr(WHW.T) 6970.3359375
bpp_loss 2.9220945835113525
9_k proxy err 0.0026665183249861 tr(WHW.T) 10987.3515625
bpp_loss 2.950002908706665
9_o proxy err 0.07294190675020218 tr(WHW.T) 25.610172271728516
bpp_loss 2.298195004463196
9_up proxy err 0.030819794163107872 tr(WHW.T) 970.8984375
bpp_loss 2.5070888608001
9_gate proxy err 0.01510872133076191 tr(WHW.T) 2132.69384765625
bpp_loss 2.5878079436546146
9_down proxy err 0.04457510635256767 tr(WHW.T) 42.99482727050781
bpp_loss 2.489385438519855
I0320 18:06:35.330242 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 0.944932222366333s
I0320 18:06:39.051315 1512014 config.py:54] PyTorch version 2.6.0 available.
W0320 18:06:39.369577 1512014 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.036092307418584824 tr(WHW.T) 578.807373046875
bpp_loss 2.4182350635528564
10_q proxy err 0.004201722797006369 tr(WHW.T) 6915.87109375
bpp_loss 2.9115177392959595
10_k proxy err 0.002722636330872774 tr(WHW.T) 10996.2431640625
bpp_loss 2.944008946418762
10_o proxy err 0.07628142833709717 tr(WHW.T) 35.184165954589844
bpp_loss 2.2963439226150513
10_up proxy err 0.029093021526932716 tr(WHW.T) 1080.198486328125
bpp_loss 2.518433415612509
10_gate proxy err 0.014867917634546757 tr(WHW.T) 2260.88330078125
bpp_loss 2.5815749944642534
10_down proxy err 0.042410124093294144 tr(WHW.T) 52.33584976196289
bpp_loss 2.4980471411416696
W0320 18:06:40.411257 1512014 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:06:40.415382 1510985 quantize_finetune_llama.py:203] layer 13 gpu 1
I0320 18:06:40.431399 1512014 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:06:41.739290 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 0.8179070949554443s
I0320 18:06:45.504329 1512073 config.py:54] PyTorch version 2.6.0 available.
W0320 18:06:45.822298 1512073 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.028466491028666496 tr(WHW.T) 723.1956176757812
bpp_loss 2.6194759607315063
11_q proxy err 0.004962264094501734 tr(WHW.T) 7027.10986328125
bpp_loss 2.815266251564026
11_k proxy err 0.003396945307031274 tr(WHW.T) 10511.23046875
bpp_loss 2.815849184989929
11_o proxy err 0.07440236955881119 tr(WHW.T) 36.654052734375
bpp_loss 2.3283421993255615
11_up proxy err 0.029831303283572197 tr(WHW.T) 1139.6044921875
bpp_loss 2.527559147324673
11_gate proxy err 0.015212995931506157 tr(WHW.T) 2392.716552734375
bpp_loss 2.5776921649311864
11_down proxy err 0.043636903166770935 tr(WHW.T) 56.13530731201172
bpp_loss 2.5050176243449367
W0320 18:06:46.767377 1512073 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:06:46.771104 1510985 quantize_finetune_llama.py:203] layer 14 gpu 2
I0320 18:06:46.785583 1512073 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:06:47.990096 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 0.7782814502716064s
I0320 18:06:51.760939 1512129 config.py:54] PyTorch version 2.6.0 available.
W0320 18:06:52.087792 1512129 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:06:53.013615 1512129 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:06:53.017638 1510985 quantize_finetune_llama.py:203] layer 15 gpu 3
I0320 18:06:53.032683 1512129 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:06:54.304343 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 0.8717715740203857s
I0320 18:06:58.327768 1512188 config.py:54] PyTorch version 2.6.0 available.
W0320 18:06:58.674360 1512188 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:06:59.712020 1512188 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:06:59.716470 1510985 quantize_finetune_llama.py:203] layer 16 gpu 0
I0320 18:06:59.732491 1512188 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.027125997468829155 tr(WHW.T) 703.318603515625
bpp_loss 2.6486732959747314
12_q proxy err 0.005001113284379244 tr(WHW.T) 7045.6435546875
bpp_loss 2.872862696647644
12_k proxy err 0.0033341646194458008 tr(WHW.T) 10893.65625
bpp_loss 2.907505512237549
12_o proxy err 0.07569663226604462 tr(WHW.T) 39.29071044921875
bpp_loss 2.3205294609069824
12_up proxy err 0.02967400848865509 tr(WHW.T) 1228.298583984375
bpp_loss 2.5384395510651343
12_gate proxy err 0.01634378917515278 tr(WHW.T) 2381.994873046875
bpp_loss 2.571417520212573
12_down proxy err 0.043549202382564545 tr(WHW.T) 64.17745208740234
bpp_loss 2.514020176820977
13_v proxy err 0.029132815077900887 tr(WHW.T) 714.5677490234375
bpp_loss 2.6661707162857056
13_q proxy err 0.005284933373332024 tr(WHW.T) 6956.03564453125
bpp_loss 2.8627485036849976
13_k proxy err 0.003610828658565879 tr(WHW.T) 10426.6318359375
bpp_loss 2.882185697555542
13_o proxy err 0.06770014017820358 tr(WHW.T) 45.8377571105957
bpp_loss 2.349604845046997
13_up proxy err 0.028527742251753807 tr(WHW.T) 1367.6221923828125
bpp_loss 2.550511737202489
13_gate proxy err 0.015917321667075157 tr(WHW.T) 2601.504638671875
bpp_loss 2.5687869759493096
13_down proxy err 0.043471768498420715 tr(WHW.T) 79.3589096069336
bpp_loss 2.5225304448327353
I0320 18:07:31.635738 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 0.868640661239624s
I0320 18:07:35.367341 1512289 config.py:54] PyTorch version 2.6.0 available.
W0320 18:07:35.685842 1512289 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.02639869414269924 tr(WHW.T) 706.1612548828125
bpp_loss 2.75364887714386
14_q proxy err 0.005450258031487465 tr(WHW.T) 7077.06103515625
bpp_loss 2.856567621231079
14_k proxy err 0.003515093820169568 tr(WHW.T) 11295.16796875
bpp_loss 2.876703977584839
14_o proxy err 0.07595302164554596 tr(WHW.T) 50.921180725097656
bpp_loss 2.3330094814300537
14_up proxy err 0.029169254004955292 tr(WHW.T) 1464.7159423828125
bpp_loss 2.5517932980559594
14_gate proxy err 0.01675228215754032 tr(WHW.T) 2682.584716796875
bpp_loss 2.567248677098474
14_down proxy err 0.044466279447078705 tr(WHW.T) 90.28684997558594
bpp_loss 2.5238920699718386
W0320 18:07:36.733351 1512289 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:07:36.737552 1510985 quantize_finetune_llama.py:203] layer 17 gpu 1
I0320 18:07:36.755666 1512289 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:07:38.165156 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 0.9556634426116943s
I0320 18:07:41.918533 1512348 config.py:54] PyTorch version 2.6.0 available.
W0320 18:07:42.260382 1512348 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.030189326032996178 tr(WHW.T) 762.7275390625
bpp_loss 2.6426433324813843
15_q proxy err 0.005117274820804596 tr(WHW.T) 7252.0009765625
bpp_loss 2.8482675552368164
15_k proxy err 0.003471607808023691 tr(WHW.T) 11072.3974609375
bpp_loss 2.887312889099121
15_o proxy err 0.06278670579195023 tr(WHW.T) 59.61664962768555
bpp_loss 2.36858069896698
15_up proxy err 0.028223153203725815 tr(WHW.T) 1641.0228271484375
bpp_loss 2.560561956361283
15_gate proxy err 0.016670413315296173 tr(WHW.T) 2905.140380859375
bpp_loss 2.575439985408339
15_down proxy err 0.044304490089416504 tr(WHW.T) 114.09001922607422
bpp_loss 2.527490649112435
W0320 18:07:43.211257 1512348 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:07:43.215798 1510985 quantize_finetune_llama.py:203] layer 18 gpu 2
I0320 18:07:43.231698 1512348 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:07:44.494952 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.875906229019165s
I0320 18:07:48.192513 1512407 config.py:54] PyTorch version 2.6.0 available.
W0320 18:07:48.516057 1512407 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:07:49.472756 1512407 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:07:49.476507 1510985 quantize_finetune_llama.py:203] layer 19 gpu 3
I0320 18:07:49.491921 1512407 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:07:50.730922 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 0.8426930904388428s
I0320 18:07:54.735603 1512463 config.py:54] PyTorch version 2.6.0 available.
W0320 18:07:55.093518 1512463 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:07:56.187542 1512463 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:07:56.191773 1510985 quantize_finetune_llama.py:203] layer 20 gpu 0
I0320 18:07:56.206952 1512463 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.03257912024855614 tr(WHW.T) 780.7407836914062
bpp_loss 2.6726566553115845
16_q proxy err 0.005483442917466164 tr(WHW.T) 7193.3974609375
bpp_loss 2.830431818962097
16_k proxy err 0.0035049833822995424 tr(WHW.T) 11630.361328125
bpp_loss 2.861319065093994
16_o proxy err 0.05087890103459358 tr(WHW.T) 88.22785186767578
bpp_loss 2.404949903488159
16_up proxy err 0.028339648619294167 tr(WHW.T) 1890.9385986328125
bpp_loss 2.5580615553745005
16_gate proxy err 0.01678386703133583 tr(WHW.T) 3369.859130859375
bpp_loss 2.5807265348212662
16_down proxy err 0.04429719224572182 tr(WHW.T) 152.0294952392578
bpp_loss 2.5282313102899594
17_v proxy err 0.026040099561214447 tr(WHW.T) 845.7654418945312
bpp_loss 2.8298546075820923
17_q proxy err 0.005923631135374308 tr(WHW.T) 7163.2734375
bpp_loss 2.8307355642318726
17_k proxy err 0.004095733631402254 tr(WHW.T) 10697.431640625
bpp_loss 2.8544998168945312
17_o proxy err 0.055650003254413605 tr(WHW.T) 58.14826965332031
bpp_loss 2.4036213159561157
17_up proxy err 0.03149595856666565 tr(WHW.T) 1921.07861328125
bpp_loss 2.550636735073356
17_gate proxy err 0.01795061118900776 tr(WHW.T) 3571.31640625
bpp_loss 2.5891363454419514
17_down proxy err 0.044468361884355545 tr(WHW.T) 165.43495178222656
bpp_loss 2.5271157220352527
I0320 18:08:28.026990 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 0.8502702713012695s
I0320 18:08:31.788948 1512564 config.py:54] PyTorch version 2.6.0 available.
W0320 18:08:32.104082 1512564 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.023080918937921524 tr(WHW.T) 1003.7705078125
bpp_loss 2.949591875076294
18_q proxy err 0.00629418483003974 tr(WHW.T) 7510.48046875
bpp_loss 2.8115134239196777
18_k proxy err 0.00463539082556963 tr(WHW.T) 10462.6650390625
bpp_loss 2.831521153450012
18_o proxy err 0.04832055792212486 tr(WHW.T) 69.96558380126953
bpp_loss 2.4404796361923218
18_up proxy err 0.033523790538311005 tr(WHW.T) 2023.183837890625
bpp_loss 2.5474659232206123
18_gate proxy err 0.018967900425195694 tr(WHW.T) 3783.076416015625
bpp_loss 2.6002672772074855
18_down proxy err 0.043644677847623825 tr(WHW.T) 198.52699279785156
bpp_loss 2.5282992540403852
W0320 18:08:33.062657 1512564 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:08:33.066754 1510985 quantize_finetune_llama.py:203] layer 21 gpu 1
I0320 18:08:33.083344 1512564 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:08:34.430650 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 0.9157867431640625s
I0320 18:08:38.324040 1512623 config.py:54] PyTorch version 2.6.0 available.
W0320 18:08:38.655582 1512623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.0237711351364851 tr(WHW.T) 1019.1412353515625
bpp_loss 2.920824646949768
19_q proxy err 0.006726385094225407 tr(WHW.T) 6944.4130859375
bpp_loss 2.78691303730011
19_k proxy err 0.004551240708678961 tr(WHW.T) 10548.4892578125
bpp_loss 2.80512273311615
19_o proxy err 0.04864053800702095 tr(WHW.T) 62.291683197021484
bpp_loss 2.4506524801254272
19_up proxy err 0.03378869965672493 tr(WHW.T) 2149.330322265625
bpp_loss 2.548083638035974
19_gate proxy err 0.02071552351117134 tr(WHW.T) 3687.5126953125
bpp_loss 2.6057901604231013
19_down proxy err 0.04260760545730591 tr(WHW.T) 222.93177795410156
bpp_loss 2.5318040404208872
W0320 18:08:39.565637 1512623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:08:39.569850 1510985 quantize_finetune_llama.py:203] layer 22 gpu 2
I0320 18:08:39.585805 1512623 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:08:40.821974 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 0.7875807285308838s
I0320 18:08:44.523038 1512682 config.py:54] PyTorch version 2.6.0 available.
W0320 18:08:44.852870 1512682 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:08:45.803412 1512682 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:08:45.807180 1510985 quantize_finetune_llama.py:203] layer 23 gpu 3
I0320 18:08:45.821801 1512682 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:08:47.247106 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.0142109394073486s
I0320 18:08:51.253066 1512738 config.py:54] PyTorch version 2.6.0 available.
W0320 18:08:51.599065 1512738 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:08:52.636442 1512738 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:08:52.640434 1510985 quantize_finetune_llama.py:203] layer 24 gpu 0
I0320 18:08:52.658383 1512738 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.025599626824259758 tr(WHW.T) 990.5983276367188
bpp_loss 2.922903895378113
20_q proxy err 0.006671094801276922 tr(WHW.T) 7150.947265625
bpp_loss 2.790815830230713
20_k proxy err 0.004697610158473253 tr(WHW.T) 10386.2470703125
bpp_loss 2.8088937997817993
20_o proxy err 0.03591402620077133 tr(WHW.T) 100.31707000732422
bpp_loss 2.470090627670288
20_up proxy err 0.03331831842660904 tr(WHW.T) 2340.89453125
bpp_loss 2.5460962694744733
20_gate proxy err 0.020413188263773918 tr(WHW.T) 4024.62744140625
bpp_loss 2.612140655517578
20_down proxy err 0.04175780713558197 tr(WHW.T) 274.8815002441406
bpp_loss 2.5314499611078305
21_v proxy err 0.022408489137887955 tr(WHW.T) 1144.5655517578125
bpp_loss 3.052006721496582
21_q proxy err 0.007422583643347025 tr(WHW.T) 7064.314453125
bpp_loss 2.7673686742782593
21_k proxy err 0.005370130762457848 tr(WHW.T) 9976.4658203125
bpp_loss 2.7720049619674683
21_o proxy err 0.03946826979517937 tr(WHW.T) 75.50972747802734
bpp_loss 2.4906325340270996
21_up proxy err 0.03505429998040199 tr(WHW.T) 2361.650390625
bpp_loss 2.545046872870867
21_gate proxy err 0.021722713485360146 tr(WHW.T) 4004.37646484375
bpp_loss 2.620601920194404
21_down proxy err 0.04282695800065994 tr(WHW.T) 276.5857849121094
bpp_loss 2.5312012184497923
I0320 18:09:24.407709 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 0.836355447769165s
I0320 18:09:28.098070 1512839 config.py:54] PyTorch version 2.6.0 available.
W0320 18:09:28.429510 1512839 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.02078832872211933 tr(WHW.T) 1243.2529296875
bpp_loss 3.0805892944335938
22_q proxy err 0.007034976035356522 tr(WHW.T) 7746.84765625
bpp_loss 2.7994868755340576
22_k proxy err 0.005227561108767986 tr(WHW.T) 10603.2041015625
bpp_loss 2.8102458715438843
22_o proxy err 0.03300269693136215 tr(WHW.T) 114.30065155029297
bpp_loss 2.4906957149505615
22_up proxy err 0.03540246561169624 tr(WHW.T) 2474.510498046875
bpp_loss 2.5425541012786157
22_gate proxy err 0.02215554006397724 tr(WHW.T) 4156.64013671875
bpp_loss 2.627660085988599
22_down proxy err 0.042328160256147385 tr(WHW.T) 311.8800048828125
bpp_loss 2.5339073802149574
W0320 18:09:29.398396 1512839 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:09:29.402684 1510985 quantize_finetune_llama.py:203] layer 25 gpu 1
I0320 18:09:29.418586 1512839 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:09:30.744201 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 0.841911792755127s
I0320 18:09:34.510590 1512898 config.py:54] PyTorch version 2.6.0 available.
W0320 18:09:34.840926 1512898 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.01951298862695694 tr(WHW.T) 1486.037353515625
bpp_loss 3.1602059602737427
23_q proxy err 0.008024509996175766 tr(WHW.T) 7346.60986328125
bpp_loss 2.822830319404602
23_k proxy err 0.006042953580617905 tr(WHW.T) 9982.2392578125
bpp_loss 2.819345712661743
23_o proxy err 0.03904656320810318 tr(WHW.T) 85.13458251953125
bpp_loss 2.5476901531219482
23_up proxy err 0.03663242608308792 tr(WHW.T) 2533.51025390625
bpp_loss 2.5477979793105017
23_gate proxy err 0.023682503029704094 tr(WHW.T) 4097.51953125
bpp_loss 2.62884521484375
23_down proxy err 0.042651526629924774 tr(WHW.T) 321.33892822265625
bpp_loss 2.538362990978152
W0320 18:09:35.777955 1512898 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:09:35.781633 1510985 quantize_finetune_llama.py:203] layer 26 gpu 2
I0320 18:09:35.796175 1512898 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:09:37.065258 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 0.8060956001281738s
I0320 18:09:40.847804 1512957 config.py:54] PyTorch version 2.6.0 available.
W0320 18:09:41.167519 1512957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:09:42.082950 1512957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:09:42.087233 1510985 quantize_finetune_llama.py:203] layer 27 gpu 3
I0320 18:09:42.103934 1512957 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:09:43.384676 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 0.8727684020996094s
I0320 18:09:47.367080 1513013 config.py:54] PyTorch version 2.6.0 available.
W0320 18:09:47.726445 1513013 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:09:48.796644 1513013 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:09:48.800760 1510985 quantize_finetune_llama.py:203] layer 28 gpu 0
I0320 18:09:48.816323 1513013 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.020240971818566322 tr(WHW.T) 1394.900634765625
bpp_loss 3.1448798179626465
24_q proxy err 0.00783701054751873 tr(WHW.T) 7020.447265625
bpp_loss 2.794136166572571
24_k proxy err 0.005468934308737516 tr(WHW.T) 10323.43359375
bpp_loss 2.784211754798889
24_o proxy err 0.030122529715299606 tr(WHW.T) 133.98797607421875
bpp_loss 2.533393621444702
24_up proxy err 0.037235409021377563 tr(WHW.T) 2621.76513671875
bpp_loss 2.5506596232569496
24_gate proxy err 0.023866670206189156 tr(WHW.T) 4262.74853515625
bpp_loss 2.631912054017533
24_down proxy err 0.04217590391635895 tr(WHW.T) 340.22412109375
bpp_loss 2.544432440469431
25_v proxy err 0.018851274624466896 tr(WHW.T) 1707.664794921875
bpp_loss 3.2454521656036377
25_q proxy err 0.006031918805092573 tr(WHW.T) 7162.16357421875
bpp_loss 3.1931426525115967
25_k proxy err 0.00459632184356451 tr(WHW.T) 9611.58984375
bpp_loss 3.1848262548446655
25_o proxy err 0.037779681384563446 tr(WHW.T) 83.535888671875
bpp_loss 2.576415777206421
25_up proxy err 0.03681928664445877 tr(WHW.T) 2805.728515625
bpp_loss 2.5565441930016806
25_gate proxy err 0.022989261895418167 tr(WHW.T) 4666.4404296875
bpp_loss 2.6355846316315406
25_down proxy err 0.04054029658436775 tr(WHW.T) 373.460693359375
bpp_loss 2.5542843064596488
I0320 18:10:20.630914 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 0.8618345260620117s
I0320 18:10:24.401123 1513114 config.py:54] PyTorch version 2.6.0 available.
W0320 18:10:24.718767 1513114 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.018710695207118988 tr(WHW.T) 1668.8843994140625
bpp_loss 3.2356061935424805
26_q proxy err 0.006033467594534159 tr(WHW.T) 7469.98291015625
bpp_loss 3.0858746767044067
26_k proxy err 0.00458166329190135 tr(WHW.T) 10487.8740234375
bpp_loss 3.050769090652466
26_o proxy err 0.024601424112915993 tr(WHW.T) 202.88172912597656
bpp_loss 2.5989387035369873
26_up proxy err 0.034672532230615616 tr(WHW.T) 3154.75146484375
bpp_loss 2.560219165890716
26_gate proxy err 0.021474400535225868 tr(WHW.T) 5302.16455078125
bpp_loss 2.6370453058287153
26_down proxy err 0.041576072573661804 tr(WHW.T) 401.19390869140625
bpp_loss 2.5640353823817055
W0320 18:10:25.651725 1513114 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:10:25.655838 1510985 quantize_finetune_llama.py:203] layer 29 gpu 1
I0320 18:10:25.671070 1513114 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:10:27.045742 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 0.9154708385467529s
I0320 18:10:30.781859 1513173 config.py:54] PyTorch version 2.6.0 available.
W0320 18:10:31.100855 1513173 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.01785413548350334 tr(WHW.T) 1799.3350830078125
bpp_loss 3.262221336364746
27_q proxy err 0.006971648428589106 tr(WHW.T) 7691.708984375
bpp_loss 3.0553637742996216
27_k proxy err 0.005557323805987835 tr(WHW.T) 10618.70703125
bpp_loss 2.9871697425842285
27_o proxy err 0.033981505781412125 tr(WHW.T) 126.13690185546875
bpp_loss 2.611733078956604
27_up proxy err 0.031625449657440186 tr(WHW.T) 3691.557861328125
bpp_loss 2.567088992096657
27_gate proxy err 0.020141860470175743 tr(WHW.T) 5990.82568359375
bpp_loss 2.6388466413630995
27_down proxy err 0.039284396916627884 tr(WHW.T) 466.9318542480469
bpp_loss 2.5933890342712402
W0320 18:10:32.012620 1513173 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:10:32.016602 1510985 quantize_finetune_llama.py:203] layer 30 gpu 2
I0320 18:10:32.031301 1513173 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:10:33.299942 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 0.8488247394561768s
I0320 18:10:37.093084 1513232 config.py:54] PyTorch version 2.6.0 available.
W0320 18:10:37.422293 1513232 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:10:38.374096 1513232 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:10:38.378446 1510985 quantize_finetune_llama.py:203] layer 31 gpu 3
I0320 18:10:38.394148 1513232 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:10:39.674432 1510985 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 0.8655176162719727s
I0320 18:10:43.675510 1513288 config.py:54] PyTorch version 2.6.0 available.
W0320 18:10:44.022501 1513288 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:10:45.082927 1513288 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:10:45.102306 1513288 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.01657433807849884 tr(WHW.T) 2018.944091796875
bpp_loss 3.320663332939148
28_q proxy err 0.005132119171321392 tr(WHW.T) 7651.126953125
bpp_loss 3.2953916788101196
28_k proxy err 0.004062802065163851 tr(WHW.T) 10544.8251953125
bpp_loss 3.256669282913208
28_o proxy err 0.02818107046186924 tr(WHW.T) 194.8240966796875
bpp_loss 2.647050380706787
28_up proxy err 0.026511792093515396 tr(WHW.T) 4661.2666015625
bpp_loss 2.580263891885447
28_gate proxy err 0.019315574318170547 tr(WHW.T) 6547.48193359375
bpp_loss 2.633391358131586
28_down proxy err 0.034619517624378204 tr(WHW.T) 603.8403930664062
bpp_loss 2.6382526020671047
29_v proxy err 0.018553663045167923 tr(WHW.T) 1801.7730712890625
bpp_loss 3.2586660385131836
29_q proxy err 0.0051061310805380344 tr(WHW.T) 7227.0009765625
bpp_loss 3.223981499671936
29_k proxy err 0.003739092033356428 tr(WHW.T) 10558.609375
bpp_loss 3.1974992752075195
29_o proxy err 0.024820303544402122 tr(WHW.T) 207.9054412841797
bpp_loss 2.657450795173645
29_up proxy err 0.02141987718641758 tr(WHW.T) 6070.0498046875
bpp_loss 2.591349579567133
29_gate proxy err 0.017840029671788216 tr(WHW.T) 7369.6142578125
bpp_loss 2.6341704435126725
29_down proxy err 0.029610807076096535 tr(WHW.T) 782.2448120117188
bpp_loss 2.704755051191463
30_v proxy err 0.01516211498528719 tr(WHW.T) 2261.489501953125
bpp_loss 3.3319287300109863
30_q proxy err 0.004642845597118139 tr(WHW.T) 7815.9453125
bpp_loss 3.3227428197860718
30_k proxy err 0.003539102151989937 tr(WHW.T) 10521.625
bpp_loss 3.3415114879608154
30_o proxy err 0.02390245534479618 tr(WHW.T) 251.96908569335938
bpp_loss 2.6984091997146606
30_up proxy err 0.013592305593192577 tr(WHW.T) 10016.376953125
bpp_loss 2.6004278493482014
30_gate proxy err 0.012319647707045078 tr(WHW.T) 11001.119140625
bpp_loss 2.6506890585256175
30_down proxy err 0.00822499394416809 tr(WHW.T) 3582.617919921875
bpp_loss 2.8255335120267646
31_v proxy err 0.028554700314998627 tr(WHW.T) 1268.2034912109375
bpp_loss 2.7994112968444824
31_q proxy err 0.0076160975731909275 tr(WHW.T) 6858.09130859375
bpp_loss 2.7435715198516846
31_k proxy err 0.005336453672498465 tr(WHW.T) 10233.677734375
bpp_loss 2.7783905267715454
31_o proxy err 0.01351473294198513 tr(WHW.T) 457.7950744628906
bpp_loss 2.665047764778137
31_up proxy err 0.008409291505813599 tr(WHW.T) 14563.890625
bpp_loss 2.6424208352732106
31_gate proxy err 0.008158793672919273 tr(WHW.T) 14836.2939453125
bpp_loss 2.7069418263989826
31_down proxy err 0.0027065135072916746 tr(WHW.T) 17873.55859375
bpp_loss 3.045966148376465
I0320 18:11:36.789927 1513410 config.py:54] PyTorch version 2.6.0 available.
W0320 18:11:37.087522 1513410 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0320 18:11:37.324348 1513410 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Llama-2-7b-hf",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "max_position_embeddings": 4096,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 32000
}

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  8.84it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  9.95it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  9.51it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.00it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  9.85it/s]
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00, 10.23it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00, 10.16it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.36it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.31it/s]
I0320 18:11:40.457540 1513410 hfize_llama.py:153] loaded layer 0
I0320 18:11:42.099620 1513410 hfize_llama.py:153] loaded layer 1
I0320 18:11:43.705186 1513410 hfize_llama.py:153] loaded layer 2
I0320 18:11:45.284652 1513410 hfize_llama.py:153] loaded layer 3
I0320 18:11:46.821307 1513410 hfize_llama.py:153] loaded layer 4
I0320 18:11:48.434081 1513410 hfize_llama.py:153] loaded layer 5
I0320 18:11:50.026591 1513410 hfize_llama.py:153] loaded layer 6
I0320 18:11:51.616396 1513410 hfize_llama.py:153] loaded layer 7
I0320 18:11:53.216070 1513410 hfize_llama.py:153] loaded layer 8
I0320 18:11:54.812482 1513410 hfize_llama.py:153] loaded layer 9
I0320 18:11:56.503742 1513410 hfize_llama.py:153] loaded layer 10
I0320 18:11:58.082030 1513410 hfize_llama.py:153] loaded layer 11
I0320 18:11:59.703022 1513410 hfize_llama.py:153] loaded layer 12
I0320 18:12:01.323270 1513410 hfize_llama.py:153] loaded layer 13
I0320 18:12:02.922649 1513410 hfize_llama.py:153] loaded layer 14
I0320 18:12:04.554605 1513410 hfize_llama.py:153] loaded layer 15
I0320 18:12:06.176554 1513410 hfize_llama.py:153] loaded layer 16
I0320 18:12:07.776693 1513410 hfize_llama.py:153] loaded layer 17
I0320 18:12:09.418362 1513410 hfize_llama.py:153] loaded layer 18
I0320 18:12:11.035249 1513410 hfize_llama.py:153] loaded layer 19
I0320 18:12:12.669677 1513410 hfize_llama.py:153] loaded layer 20
I0320 18:12:14.280066 1513410 hfize_llama.py:153] loaded layer 21
I0320 18:12:15.932684 1513410 hfize_llama.py:153] loaded layer 22
I0320 18:12:17.492194 1513410 hfize_llama.py:153] loaded layer 23
I0320 18:12:18.999304 1513410 hfize_llama.py:153] loaded layer 24
I0320 18:12:20.499975 1513410 hfize_llama.py:153] loaded layer 25
I0320 18:12:22.063494 1513410 hfize_llama.py:153] loaded layer 26
I0320 18:12:23.556807 1513410 hfize_llama.py:153] loaded layer 27
I0320 18:12:25.010710 1513410 hfize_llama.py:153] loaded layer 28
I0320 18:12:26.505669 1513410 hfize_llama.py:153] loaded layer 29
I0320 18:12:28.040307 1513410 hfize_llama.py:153] loaded layer 30
I0320 18:12:29.600300 1513410 hfize_llama.py:153] loaded layer 31
I0320 18:12:29.600484 1513410 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:05,  1.12s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:01<00:03,  1.08it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:02<00:02,  1.12it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:03<00:01,  1.15it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:04<00:00,  1.16it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.35it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:04<00:00,  1.21it/s]
I0320 18:13:03.106411 1513410 hfize_llama.py:167] successfully loaded hfized model
