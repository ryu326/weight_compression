I0320 18:32:34.085240 1517129 config.py:54] PyTorch version 2.6.0 available.
W0320 18:32:34.362793 1517129 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:32:35.302317 1517129 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.08it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.76it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.00it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.14it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.22it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.07it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.00it/s]
I0320 18:32:36.257504 1517129 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:14,  2.10it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:13,  2.27it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:12,  2.39it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:11,  2.47it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:10,  2.50it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:10,  2.52it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:09,  2.53it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:09,  2.54it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:09,  2.55it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:08,  2.56it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.57it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:04<00:07,  2.59it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.58it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:06,  2.59it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:05<00:06,  2.60it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.60it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:06<00:05,  2.61it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.60it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:07<00:04,  2.60it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:07<00:04,  2.61it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.59it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:08<00:03,  2.60it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.57it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:09<00:03,  2.59it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:09<00:02,  2.61it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.59it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:10<00:01,  2.60it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:10<00:01,  2.62it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:11<00:01,  2.61it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:11<00:00,  2.62it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.62it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.58it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.57it/s]
I0320 18:32:54.021756 1517129 quantize_finetune_llama.py:179] loaded compression model
I0320 18:33:08.388961 1517129 quantize_finetune_llama.py:183] loaded dataset and devset
I0320 18:33:13.841558 1517129 quantize_finetune_llama.py:203] layer 0 gpu 0
I0320 18:33:16.600896 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 2.5907015800476074s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0320 18:33:31.610553 1517315 config.py:54] PyTorch version 2.6.0 available.
W0320 18:33:31.890068 1517315 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:33:32.761136 1517315 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:33:32.765155 1517129 quantize_finetune_llama.py:203] layer 1 gpu 1
I0320 18:33:32.780320 1517315 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:33:36.626161 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 3.6845860481262207s
I0320 18:33:40.211881 1517379 config.py:54] PyTorch version 2.6.0 available.
W0320 18:33:40.526852 1517379 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:33:41.484824 1517379 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:33:41.488619 1517129 quantize_finetune_llama.py:203] layer 2 gpu 2
I0320 18:33:41.503960 1517379 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:33:44.096402 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 2.450953960418701s
I0320 18:33:47.745364 1517440 config.py:54] PyTorch version 2.6.0 available.
W0320 18:33:48.077839 1517440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:33:49.073918 1517440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:33:49.078127 1517129 quantize_finetune_llama.py:203] layer 3 gpu 3
I0320 18:33:49.094055 1517440 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:33:52.178809 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 2.9165451526641846s
I0320 18:33:56.063980 1517504 config.py:54] PyTorch version 2.6.0 available.
W0320 18:33:56.414172 1517504 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:33:57.566324 1517504 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:33:57.570758 1517129 quantize_finetune_llama.py:203] layer 4 gpu 0
I0320 18:33:57.587368 1517504 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.006420207675546408 tr(WHW.T) 4.225186347961426
bpp_loss 3.394748330116272
0_q proxy err 0.00027139633311890066 tr(WHW.T) 2710.363037109375
bpp_loss 3.3932632207870483
0_k proxy err 0.00027398529346100986 tr(WHW.T) 1698.7349853515625
bpp_loss 3.4991146326065063
0_o proxy err 0.0027516046538949013 tr(WHW.T) 0.9668058156967163
bpp_loss 3.238954544067383
0_up proxy err 0.003978892229497433 tr(WHW.T) 43.27138900756836
bpp_loss 3.680421696152798
0_gate proxy err 0.002756873844191432 tr(WHW.T) 63.47430419921875
bpp_loss 3.694018696629724
0_down proxy err 0.0032942292746156454 tr(WHW.T) 0.656814694404602
bpp_loss 3.7192905115526775
1_v proxy err 0.011173544451594353 tr(WHW.T) 16.465883255004883
bpp_loss 3.375208020210266
1_q proxy err 0.0002658478624653071 tr(WHW.T) 4778.43994140625
bpp_loss 4.126788854598999
1_k proxy err 0.00027878046967089176 tr(WHW.T) 4995.39208984375
bpp_loss 4.133458375930786
1_o proxy err 0.008611973375082016 tr(WHW.T) 1.1115814447402954
bpp_loss 3.277146577835083
1_up proxy err 0.0049200039356946945 tr(WHW.T) 109.66383361816406
bpp_loss 3.7429305675417877
1_gate proxy err 0.0025302062276750803 tr(WHW.T) 221.3038787841797
bpp_loss 3.8047838432844294
1_down proxy err 0.0005852069589309394 tr(WHW.T) 2041.4736328125
bpp_loss 3.758256113806436
I0320 18:34:25.998429 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.8369255065917969s
I0320 18:34:29.842726 1517599 config.py:54] PyTorch version 2.6.0 available.
W0320 18:34:30.197163 1517599 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:34:31.193151 1517599 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:34:31.197362 1517129 quantize_finetune_llama.py:203] layer 5 gpu 1
I0320 18:34:31.213227 1517599 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.006141807418316603 tr(WHW.T) 136.67332458496094
bpp_loss 3.584715247154236
2_q proxy err 0.00029400826315395534 tr(WHW.T) 7752.85205078125
bpp_loss 4.308031797409058
2_k proxy err 0.0002562569279689342 tr(WHW.T) 10205.837890625
bpp_loss 4.373161315917969
2_o proxy err 0.008137551136314869 tr(WHW.T) 1.4603197574615479
bpp_loss 3.5463510751724243
2_up proxy err 0.0058785174041986465 tr(WHW.T) 193.43603515625
bpp_loss 3.763473333314408
2_gate proxy err 0.003753158263862133 tr(WHW.T) 306.6622619628906
bpp_loss 3.8439458802688953
2_down proxy err 0.006755218841135502 tr(WHW.T) 3.010739803314209
bpp_loss 3.7701445512993392
I0320 18:34:33.855498 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 0.8299806118011475s
I0320 18:34:37.609907 1517661 config.py:54] PyTorch version 2.6.0 available.
W0320 18:34:37.915066 1517661 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:34:38.874020 1517661 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:34:38.878294 1517129 quantize_finetune_llama.py:203] layer 6 gpu 2
I0320 18:34:38.894411 1517661 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.007969657890498638 tr(WHW.T) 284.77557373046875
bpp_loss 3.5575058460235596
3_q proxy err 0.00048280105693265796 tr(WHW.T) 7217.63720703125
bpp_loss 4.251274347305298
3_k proxy err 0.000394726317608729 tr(WHW.T) 10074.73828125
bpp_loss 4.311078071594238
3_o proxy err 0.008166423998773098 tr(WHW.T) 3.3527450561523438
bpp_loss 3.5140140056610107
3_up proxy err 0.006625063251703978 tr(WHW.T) 284.7950744628906
bpp_loss 3.7719345092773438
3_gate proxy err 0.004031504038721323 tr(WHW.T) 478.13714599609375
bpp_loss 3.8612241523210393
3_down proxy err 0.006897802464663982 tr(WHW.T) 6.133229732513428
bpp_loss 3.7732580539792084
I0320 18:34:41.782137 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 0.8867478370666504s
I0320 18:34:45.462882 1517720 config.py:54] PyTorch version 2.6.0 available.
W0320 18:34:45.798881 1517720 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:34:46.858960 1517720 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:34:46.863456 1517129 quantize_finetune_llama.py:203] layer 7 gpu 3
I0320 18:34:46.880748 1517720 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:34:48.279158 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 0.9161827564239502s
I0320 18:34:52.076698 1517779 config.py:54] PyTorch version 2.6.0 available.
W0320 18:34:52.434687 1517779 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:34:53.512577 1517779 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:34:53.516764 1517129 quantize_finetune_llama.py:203] layer 8 gpu 0
I0320 18:34:53.532008 1517779 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.007441437337547541 tr(WHW.T) 274.6131286621094
bpp_loss 3.5896931886672974
4_q proxy err 0.00046080147149041295 tr(WHW.T) 6914.9892578125
bpp_loss 4.335981845855713
4_k proxy err 0.0003747277951333672 tr(WHW.T) 10415.33203125
bpp_loss 4.364338636398315
4_o proxy err 0.008070948533713818 tr(WHW.T) 5.139806270599365
bpp_loss 3.5559312105178833
4_up proxy err 0.006374563556164503 tr(WHW.T) 397.6960144042969
bpp_loss 3.7660405358602835
4_gate proxy err 0.0032400148920714855 tr(WHW.T) 821.1856689453125
bpp_loss 3.8855340647142986
4_down proxy err 0.006920440588146448 tr(WHW.T) 11.562739372253418
bpp_loss 3.75997687495032
5_v proxy err 0.007646279875189066 tr(WHW.T) 298.47540283203125
bpp_loss 3.6121890544891357
5_q proxy err 0.00048801119555719197 tr(WHW.T) 6770.97509765625
bpp_loss 4.3549463748931885
5_k proxy err 0.00036846453440375626 tr(WHW.T) 10841.955078125
bpp_loss 4.4136693477630615
5_o proxy err 0.010251509957015514 tr(WHW.T) 7.947142601013184
bpp_loss 3.5785261392593384
5_up proxy err 0.006262618582695723 tr(WHW.T) 506.6408386230469
bpp_loss 3.766074247138445
5_gate proxy err 0.0030079942662268877 tr(WHW.T) 1104.867919921875
bpp_loss 3.891852800236192
5_down proxy err 0.007279668934643269 tr(WHW.T) 15.6494779586792
bpp_loss 3.76098202550134
I0320 18:35:23.372508 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 0.8476965427398682s
I0320 18:35:27.081173 1517874 config.py:54] PyTorch version 2.6.0 available.
W0320 18:35:27.397245 1517874 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:35:28.441511 1517874 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:35:28.445644 1517129 quantize_finetune_llama.py:203] layer 9 gpu 1
I0320 18:35:28.468475 1517874 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.0071634831838309765 tr(WHW.T) 443.5464782714844
bpp_loss 3.649949073791504
6_q proxy err 0.0006166752427816391 tr(WHW.T) 7576.53857421875
bpp_loss 4.233880043029785
6_k proxy err 0.0004869761469308287 tr(WHW.T) 10409.4033203125
bpp_loss 4.263760566711426
6_o proxy err 0.01044399943202734 tr(WHW.T) 11.564380645751953
bpp_loss 3.5234769582748413
6_up proxy err 0.006216246634721756 tr(WHW.T) 617.2608642578125
bpp_loss 3.7634942697924236
6_gate proxy err 0.0025892495177686214 tr(WHW.T) 1554.7271728515625
bpp_loss 3.9140380149663883
6_down proxy err 0.007494537625461817 tr(WHW.T) 22.988168716430664
bpp_loss 3.754823374193768
I0320 18:35:31.557221 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 0.8547499179840088s
I0320 18:35:35.270290 1517936 config.py:54] PyTorch version 2.6.0 available.
W0320 18:35:35.580754 1517936 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.006604587193578482 tr(WHW.T) 489.9357604980469
bpp_loss 3.712562084197998
7_q proxy err 0.0006480440497398376 tr(WHW.T) 7672.17919921875
bpp_loss 4.229955196380615
7_k proxy err 0.0005130487261340022 tr(WHW.T) 10198.3701171875
bpp_loss 4.241146087646484
7_o proxy err 0.011586322449147701 tr(WHW.T) 15.11335563659668
bpp_loss 3.5308218002319336
7_up proxy err 0.005968551617115736 tr(WHW.T) 735.8538818359375
bpp_loss 3.770715225574582
7_gate proxy err 0.002479053568094969 tr(WHW.T) 1876.0390625
bpp_loss 3.9140294984329578
7_down proxy err 0.007564308121800423 tr(WHW.T) 30.58672523498535
bpp_loss 3.7565006877100746
W0320 18:35:36.534931 1517936 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:35:36.538984 1517129 quantize_finetune_llama.py:203] layer 10 gpu 2
I0320 18:35:36.554392 1517936 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:35:37.784477 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 0.7837488651275635s
I0320 18:35:41.390949 1517995 config.py:54] PyTorch version 2.6.0 available.
W0320 18:35:41.730802 1517995 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:35:42.775444 1517995 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:35:42.779555 1517129 quantize_finetune_llama.py:203] layer 11 gpu 3
I0320 18:35:42.794396 1517995 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:35:44.406123 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.1512322425842285s
I0320 18:35:48.354870 1518054 config.py:54] PyTorch version 2.6.0 available.
W0320 18:35:48.715895 1518054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:35:49.708508 1518054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:35:49.712498 1517129 quantize_finetune_llama.py:203] layer 12 gpu 0
I0320 18:35:49.727085 1518054 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.006696428172290325 tr(WHW.T) 530.9967041015625
bpp_loss 3.656752824783325
8_q proxy err 0.0006793064530938864 tr(WHW.T) 7228.1201171875
bpp_loss 4.245445489883423
8_k proxy err 0.0005015901406295598 tr(WHW.T) 10639.1015625
bpp_loss 4.262974262237549
8_o proxy err 0.013123973272740841 tr(WHW.T) 20.092191696166992
bpp_loss 3.555400013923645
8_up proxy err 0.005420196335762739 tr(WHW.T) 866.312744140625
bpp_loss 3.7853395328965296
8_gate proxy err 0.002507921773940325 tr(WHW.T) 1970.857177734375
bpp_loss 3.89591784809911
8_down proxy err 0.007518045138567686 tr(WHW.T) 37.177734375
bpp_loss 3.767790195553802
9_v proxy err 0.0067018065601587296 tr(WHW.T) 565.0663452148438
bpp_loss 3.6654305458068848
9_q proxy err 0.000725079677067697 tr(WHW.T) 6970.3359375
bpp_loss 4.266991138458252
9_k proxy err 0.0005277133313938975 tr(WHW.T) 10987.3515625
bpp_loss 4.302664518356323
9_o proxy err 0.012997178360819817 tr(WHW.T) 25.610172271728516
bpp_loss 3.57309353351593
9_up proxy err 0.005204390734434128 tr(WHW.T) 970.8984375
bpp_loss 3.793383931004724
9_gate proxy err 0.002476849826052785 tr(WHW.T) 2132.69384765625
bpp_loss 3.8841059485147165
9_down proxy err 0.007583842612802982 tr(WHW.T) 42.99482727050781
bpp_loss 3.7751066961953805
I0320 18:36:21.305768 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 0.829758882522583s
I0320 18:36:25.016567 1518152 config.py:54] PyTorch version 2.6.0 available.
W0320 18:36:25.347242 1518152 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.0064277611672878265 tr(WHW.T) 578.807373046875
bpp_loss 3.6877756118774414
10_q proxy err 0.0007387067307718098 tr(WHW.T) 6915.87109375
bpp_loss 4.256830453872681
10_k proxy err 0.0005250026588328183 tr(WHW.T) 10996.2431640625
bpp_loss 4.298248767852783
10_o proxy err 0.013593907468020916 tr(WHW.T) 35.184165954589844
bpp_loss 3.570770740509033
10_up proxy err 0.004903522320091724 tr(WHW.T) 1080.198486328125
bpp_loss 3.80569014438363
10_gate proxy err 0.0024426705203950405 tr(WHW.T) 2260.88330078125
bpp_loss 3.878036321595658
10_down proxy err 0.007214545272290707 tr(WHW.T) 52.33584976196289
bpp_loss 3.784629378207894
W0320 18:36:26.285123 1518152 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:36:26.289374 1517129 quantize_finetune_llama.py:203] layer 13 gpu 1
I0320 18:36:26.305799 1518152 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:36:27.669319 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 0.8995869159698486s
I0320 18:36:31.741290 1518211 config.py:54] PyTorch version 2.6.0 available.
W0320 18:36:32.096737 1518211 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.005106005817651749 tr(WHW.T) 723.1956176757812
bpp_loss 3.884864926338196
11_q proxy err 0.0008655008277855814 tr(WHW.T) 7027.10986328125
bpp_loss 4.149260520935059
11_k proxy err 0.0006309544551186264 tr(WHW.T) 10511.23046875
bpp_loss 4.150985240936279
11_o proxy err 0.013232405297458172 tr(WHW.T) 36.654052734375
bpp_loss 3.6046018600463867
11_up proxy err 0.005020530428737402 tr(WHW.T) 1139.6044921875
bpp_loss 3.8155572580736736
11_gate proxy err 0.0024898755364120007 tr(WHW.T) 2392.716552734375
bpp_loss 3.873632918956668
11_down proxy err 0.0074097635224461555 tr(WHW.T) 56.13530731201172
bpp_loss 3.7921099773673124
W0320 18:36:33.062745 1518211 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:36:33.067038 1517129 quantize_finetune_llama.py:203] layer 14 gpu 2
I0320 18:36:33.084791 1518211 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:36:34.457518 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 0.8039352893829346s
I0320 18:36:38.153172 1518270 config.py:54] PyTorch version 2.6.0 available.
W0320 18:36:38.481832 1518270 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:36:39.423503 1518270 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:36:39.427764 1517129 quantize_finetune_llama.py:203] layer 15 gpu 3
I0320 18:36:39.443452 1518270 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:36:40.690242 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 0.844951868057251s
I0320 18:36:44.709139 1518329 config.py:54] PyTorch version 2.6.0 available.
W0320 18:36:45.069199 1518329 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:36:46.164822 1518329 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:36:46.168932 1517129 quantize_finetune_llama.py:203] layer 16 gpu 0
I0320 18:36:46.184225 1518329 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.004890273790806532 tr(WHW.T) 703.318603515625
bpp_loss 3.9131654500961304
12_q proxy err 0.0008686063229106367 tr(WHW.T) 7045.6435546875
bpp_loss 4.210166931152344
12_k proxy err 0.000612298958003521 tr(WHW.T) 10893.65625
bpp_loss 4.253687620162964
12_o proxy err 0.013458015397191048 tr(WHW.T) 39.29071044921875
bpp_loss 3.596039891242981
12_up proxy err 0.004986670799553394 tr(WHW.T) 1228.298583984375
bpp_loss 3.827024770337482
12_gate proxy err 0.0026775228325277567 tr(WHW.T) 2381.994873046875
bpp_loss 3.8662987642509994
12_down proxy err 0.0073798643425107 tr(WHW.T) 64.17745208740234
bpp_loss 3.8018639143123183
13_v proxy err 0.005219904240220785 tr(WHW.T) 714.5677490234375
bpp_loss 3.932163119316101
13_q proxy err 0.0009102029725909233 tr(WHW.T) 6956.03564453125
bpp_loss 4.19814395904541
13_k proxy err 0.0006460165604948997 tr(WHW.T) 10426.6318359375
bpp_loss 4.222560167312622
13_o proxy err 0.011961925774812698 tr(WHW.T) 45.8377571105957
bpp_loss 3.626278281211853
13_up proxy err 0.004782154690474272 tr(WHW.T) 1367.6221923828125
bpp_loss 3.840201976687409
13_gate proxy err 0.002609524643048644 tr(WHW.T) 2601.504638671875
bpp_loss 3.863174615904342
13_down proxy err 0.007374215871095657 tr(WHW.T) 79.3589096069336
bpp_loss 3.8111057503278865
I0320 18:37:17.792050 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 0.8850576877593994s
I0320 18:37:21.454424 1518427 config.py:54] PyTorch version 2.6.0 available.
W0320 18:37:21.787302 1518427 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.004796250257641077 tr(WHW.T) 706.1612548828125
bpp_loss 4.013688087463379
14_q proxy err 0.0009246659465134144 tr(WHW.T) 7077.06103515625
bpp_loss 4.191063404083252
14_k proxy err 0.0006309021264314651 tr(WHW.T) 11295.16796875
bpp_loss 4.216766119003296
14_o proxy err 0.013454016298055649 tr(WHW.T) 50.921180725097656
bpp_loss 3.608695387840271
14_up proxy err 0.004888305906206369 tr(WHW.T) 1464.7159423828125
bpp_loss 3.841510683991188
14_gate proxy err 0.0027490444481372833 tr(WHW.T) 2682.584716796875
bpp_loss 3.8613762079283247
14_down proxy err 0.007534236181527376 tr(WHW.T) 90.28684997558594
bpp_loss 3.8125651603521304
W0320 18:37:22.741309 1518427 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:37:22.745367 1517129 quantize_finetune_llama.py:203] layer 17 gpu 1
I0320 18:37:22.761075 1518427 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:37:24.168764 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 0.9668526649475098s
I0320 18:37:27.956908 1518486 config.py:54] PyTorch version 2.6.0 available.
W0320 18:37:28.278141 1518486 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.005370585713535547 tr(WHW.T) 762.7275390625
bpp_loss 3.909884810447693
15_q proxy err 0.000879103725310415 tr(WHW.T) 7252.0009765625
bpp_loss 4.179652690887451
15_k proxy err 0.0006170733831822872 tr(WHW.T) 11072.3974609375
bpp_loss 4.227781295776367
15_o proxy err 0.011050917208194733 tr(WHW.T) 59.61664962768555
bpp_loss 3.6455624103546143
15_up proxy err 0.004726003389805555 tr(WHW.T) 1641.0228271484375
bpp_loss 3.850723444029342
15_gate proxy err 0.002746420446783304 tr(WHW.T) 2905.140380859375
bpp_loss 3.8702658719794694
15_down proxy err 0.007511679083108902 tr(WHW.T) 114.09001922607422
bpp_loss 3.816522576088129
W0320 18:37:29.199571 1518486 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:37:29.203593 1517129 quantize_finetune_llama.py:203] layer 18 gpu 2
I0320 18:37:29.219398 1518486 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:37:30.532439 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.7848927974700928s
I0320 18:37:34.219323 1518545 config.py:54] PyTorch version 2.6.0 available.
W0320 18:37:34.548046 1518545 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:37:35.482883 1518545 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:37:35.487010 1517129 quantize_finetune_llama.py:203] layer 19 gpu 3
I0320 18:37:35.503252 1518545 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:37:36.695908 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 0.8408317565917969s
I0320 18:37:40.451904 1518601 config.py:54] PyTorch version 2.6.0 available.
W0320 18:37:40.802690 1518601 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:37:41.873354 1518601 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:37:41.877519 1517129 quantize_finetune_llama.py:203] layer 20 gpu 0
I0320 18:37:41.892665 1518601 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.005763989873230457 tr(WHW.T) 780.7407836914062
bpp_loss 3.941884756088257
16_q proxy err 0.0009275050251744688 tr(WHW.T) 7193.3974609375
bpp_loss 4.160856008529663
16_k proxy err 0.0006288108415901661 tr(WHW.T) 11630.361328125
bpp_loss 4.199368000030518
16_o proxy err 0.008818983100354671 tr(WHW.T) 88.22785186767578
bpp_loss 3.6841652393341064
16_up proxy err 0.004728509578853846 tr(WHW.T) 1890.9385986328125
bpp_loss 3.847983959109284
16_gate proxy err 0.0027251869905740023 tr(WHW.T) 3369.859130859375
bpp_loss 3.8761921372524526
16_down proxy err 0.007505438290536404 tr(WHW.T) 152.0294952392578
bpp_loss 3.81710613605588
17_v proxy err 0.004675511736422777 tr(WHW.T) 845.7654418945312
bpp_loss 4.0922746658325195
17_q proxy err 0.0009924126788973808 tr(WHW.T) 7163.2734375
bpp_loss 4.158669948577881
17_k proxy err 0.0007105214754119515 tr(WHW.T) 10697.431640625
bpp_loss 4.188227415084839
17_o proxy err 0.009697489440441132 tr(WHW.T) 58.14826965332031
bpp_loss 3.682922601699829
17_up proxy err 0.0052595497108995914 tr(WHW.T) 1921.07861328125
bpp_loss 3.840190976165062
17_gate proxy err 0.0029073439072817564 tr(WHW.T) 3571.31640625
bpp_loss 3.88569836283839
17_down proxy err 0.007531799376010895 tr(WHW.T) 165.43495178222656
bpp_loss 3.8158312065656794
I0320 18:38:14.411944 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 0.9175305366516113s
18_v proxy err 0.004160304553806782 tr(WHW.T) 1003.7705078125
bpp_loss 4.210981369018555
18_q proxy err 0.0010439116740599275 tr(WHW.T) 7510.48046875
bpp_loss 4.134464740753174
18_k proxy err 0.0007849009125493467 tr(WHW.T) 10462.6650390625
bpp_loss 4.160380125045776
18_o proxy err 0.008347014896571636 tr(WHW.T) 69.96558380126953
bpp_loss 3.722064971923828
18_up proxy err 0.005607933737337589 tr(WHW.T) 2023.183837890625
bpp_loss 3.836698132891988
18_gate proxy err 0.0030791389290243387 tr(WHW.T) 3783.076416015625
bpp_loss 3.8976103316905886
18_down proxy err 0.007391737774014473 tr(WHW.T) 198.52699279785156
bpp_loss 3.8167450039885766
I0320 18:38:18.190842 1518702 config.py:54] PyTorch version 2.6.0 available.
W0320 18:38:18.521270 1518702 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:38:19.511862 1518702 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:38:19.516044 1517129 quantize_finetune_llama.py:203] layer 21 gpu 1
I0320 18:38:19.533889 1518702 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:38:20.799828 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 0.8244426250457764s
19_v proxy err 0.004263040143996477 tr(WHW.T) 1019.1412353515625
bpp_loss 4.185075044631958
19_q proxy err 0.0011233403347432613 tr(WHW.T) 6944.4130859375
bpp_loss 4.108338356018066
19_k proxy err 0.0007980792433954775 tr(WHW.T) 10548.4892578125
bpp_loss 4.131817817687988
19_o proxy err 0.008385321125388145 tr(WHW.T) 62.291683197021484
bpp_loss 3.733311891555786
19_up proxy err 0.005654049571603537 tr(WHW.T) 2149.330322265625
bpp_loss 3.8372304162313773
19_gate proxy err 0.0033740371000021696 tr(WHW.T) 3687.5126953125
bpp_loss 3.9033721214117008
19_down proxy err 0.00720489164814353 tr(WHW.T) 222.93177795410156
bpp_loss 3.820352221644202
I0320 18:38:24.580518 1518761 config.py:54] PyTorch version 2.6.0 available.
W0320 18:38:24.905156 1518761 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:38:25.832591 1518761 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:38:25.836375 1517129 quantize_finetune_llama.py:203] layer 22 gpu 2
I0320 18:38:25.855913 1518761 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:38:27.037835 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 0.7742047309875488s
I0320 18:38:30.720798 1518820 config.py:54] PyTorch version 2.6.0 available.
W0320 18:38:31.060312 1518820 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:38:31.996876 1518820 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:38:32.000946 1517129 quantize_finetune_llama.py:203] layer 23 gpu 3
I0320 18:38:32.016685 1518820 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:38:33.408885 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.0158803462982178s
I0320 18:38:37.416140 1518879 config.py:54] PyTorch version 2.6.0 available.
W0320 18:38:37.768378 1518879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:38:38.884741 1518879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:38:38.888967 1517129 quantize_finetune_llama.py:203] layer 24 gpu 0
I0320 18:38:38.904903 1518879 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.004562292248010635 tr(WHW.T) 990.5983276367188
bpp_loss 4.189011096954346
20_q proxy err 0.0011242851614952087 tr(WHW.T) 7150.947265625
bpp_loss 4.114539384841919
20_k proxy err 0.0008247101213783026 tr(WHW.T) 10386.2470703125
bpp_loss 4.13733172416687
20_o proxy err 0.006129846908152103 tr(WHW.T) 100.31707000732422
bpp_loss 3.75391161441803
20_up proxy err 0.005569101311266422 tr(WHW.T) 2340.89453125
bpp_loss 3.835193722747093
20_gate proxy err 0.0033123744651675224 tr(WHW.T) 4024.62744140625
bpp_loss 3.9102298825286157
20_down proxy err 0.007066558580845594 tr(WHW.T) 274.8815002441406
bpp_loss 3.8198843889458236
21_v proxy err 0.004040862433612347 tr(WHW.T) 1144.5655517578125
bpp_loss 4.316064119338989
21_q proxy err 0.001259567216038704 tr(WHW.T) 7064.314453125
bpp_loss 4.08660364151001
21_k proxy err 0.0009382846183143556 tr(WHW.T) 9976.4658203125
bpp_loss 4.094631671905518
21_o proxy err 0.006711671128869057 tr(WHW.T) 75.50972747802734
bpp_loss 3.776450276374817
21_up proxy err 0.005870097316801548 tr(WHW.T) 2361.650390625
bpp_loss 3.8338681598042332
21_gate proxy err 0.0035354900173842907 tr(WHW.T) 4004.37646484375
bpp_loss 3.919330685637718
21_down proxy err 0.0072365375235676765 tr(WHW.T) 276.5857849121094
bpp_loss 3.8197570845138196
I0320 18:39:13.196050 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 0.8061153888702393s
22_v proxy err 0.0037595408502966166 tr(WHW.T) 1243.2529296875
bpp_loss 4.343078136444092
22_q proxy err 0.00118669040966779 tr(WHW.T) 7746.84765625
bpp_loss 4.122129440307617
22_k proxy err 0.0009017543052323163 tr(WHW.T) 10603.2041015625
bpp_loss 4.136304616928101
22_o proxy err 0.005631496198475361 tr(WHW.T) 114.30065155029297
bpp_loss 3.7767971754074097
22_up proxy err 0.005928763188421726 tr(WHW.T) 2474.510498046875
bpp_loss 3.831418591876363
22_gate proxy err 0.0036048877518624067 tr(WHW.T) 4156.64013671875
bpp_loss 3.9271795583325764
22_down proxy err 0.007153423503041267 tr(WHW.T) 311.8800048828125
bpp_loss 3.8222742967827377
I0320 18:39:16.951208 1518980 config.py:54] PyTorch version 2.6.0 available.
W0320 18:39:17.283240 1518980 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:39:18.262765 1518980 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:39:18.267104 1517129 quantize_finetune_llama.py:203] layer 25 gpu 1
I0320 18:39:18.282482 1518980 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:39:19.513309 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 0.7898075580596924s
I0320 18:39:23.246247 1519039 config.py:54] PyTorch version 2.6.0 available.
W0320 18:39:23.578897 1519039 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.003524077357724309 tr(WHW.T) 1486.037353515625
bpp_loss 4.424861907958984
23_q proxy err 0.0013535725884139538 tr(WHW.T) 7346.60986328125
bpp_loss 4.141901731491089
23_k proxy err 0.0010368855437263846 tr(WHW.T) 9982.2392578125
bpp_loss 4.141306400299072
23_o proxy err 0.00662229722365737 tr(WHW.T) 85.13458251953125
bpp_loss 3.838439464569092
23_up proxy err 0.006138736382126808 tr(WHW.T) 2533.51025390625
bpp_loss 3.8372004309365915
23_gate proxy err 0.0038658641278743744 tr(WHW.T) 4097.51953125
bpp_loss 3.9280897628429323
23_down proxy err 0.0072051119059324265 tr(WHW.T) 321.33892822265625
bpp_loss 3.827456984409066
W0320 18:39:24.561899 1519039 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:39:24.565724 1517129 quantize_finetune_llama.py:203] layer 26 gpu 2
I0320 18:39:24.580211 1519039 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:39:25.748704 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 0.7506897449493408s
I0320 18:39:29.514307 1519098 config.py:54] PyTorch version 2.6.0 available.
W0320 18:39:29.834617 1519098 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:39:30.800869 1519098 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:39:30.804971 1517129 quantize_finetune_llama.py:203] layer 27 gpu 3
I0320 18:39:30.821026 1519098 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:39:32.103761 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 0.9170935153961182s
I0320 18:39:36.002614 1519157 config.py:54] PyTorch version 2.6.0 available.
W0320 18:39:36.367046 1519157 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:39:37.343808 1519157 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:39:37.348042 1517129 quantize_finetune_llama.py:203] layer 28 gpu 0
I0320 18:39:37.364096 1519157 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.0036605517379939556 tr(WHW.T) 1394.900634765625
bpp_loss 4.40854549407959
24_q proxy err 0.0013362410245463252 tr(WHW.T) 7020.447265625
bpp_loss 4.1091227531433105
24_k proxy err 0.0009615659946575761 tr(WHW.T) 10323.43359375
bpp_loss 4.10171914100647
24_o proxy err 0.005113044288009405 tr(WHW.T) 133.98797607421875
bpp_loss 3.8224047422409058
24_up proxy err 0.006238146685063839 tr(WHW.T) 2621.76513671875
bpp_loss 3.840353854866915
24_gate proxy err 0.0038987172301858664 tr(WHW.T) 4262.74853515625
bpp_loss 3.9313177064407703
24_down proxy err 0.007122018840163946 tr(WHW.T) 340.22412109375
bpp_loss 3.833683191343795
25_v proxy err 0.003407176584005356 tr(WHW.T) 1707.664794921875
bpp_loss 4.508008003234863
25_q proxy err 0.0011024200357496738 tr(WHW.T) 7162.16357421875
bpp_loss 4.490513563156128
25_k proxy err 0.000863905472215265 tr(WHW.T) 9611.58984375
bpp_loss 4.484373331069946
25_o proxy err 0.006332870572805405 tr(WHW.T) 83.535888671875
bpp_loss 3.869900941848755
25_up proxy err 0.006167169660329819 tr(WHW.T) 2805.728515625
bpp_loss 3.8466628318609195
25_gate proxy err 0.003767549991607666 tr(WHW.T) 4666.4404296875
bpp_loss 3.93523318268532
25_down proxy err 0.006865350529551506 tr(WHW.T) 373.460693359375
bpp_loss 3.843747249869413
I0320 18:40:13.684916 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 0.8773188591003418s
I0320 18:40:17.488187 1519261 config.py:54] PyTorch version 2.6.0 available.
26_v proxy err 0.0033821810502558947 tr(WHW.T) 1668.8843994140625
bpp_loss 4.502530097961426
26_q proxy err 0.0010925107635557652 tr(WHW.T) 7469.98291015625
bpp_loss 4.385056495666504
26_k proxy err 0.0008457200019620359 tr(WHW.T) 10487.8740234375
bpp_loss 4.354666471481323
26_o proxy err 0.004169565159827471 tr(WHW.T) 202.88172912597656
bpp_loss 3.895730972290039
26_up proxy err 0.005796489771455526 tr(WHW.T) 3154.75146484375
bpp_loss 3.8507181211959485
26_gate proxy err 0.0035101170651614666 tr(WHW.T) 5302.16455078125
bpp_loss 3.937480837799782
26_down proxy err 0.007031600922346115 tr(WHW.T) 401.19390869140625
bpp_loss 3.853451085645099
W0320 18:40:17.804783 1519261 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:40:18.814227 1519261 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:40:18.818520 1517129 quantize_finetune_llama.py:203] layer 29 gpu 1
I0320 18:40:18.835358 1519261 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:40:20.181885 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 0.9041132926940918s
I0320 18:40:23.938019 1519320 config.py:54] PyTorch version 2.6.0 available.
W0320 18:40:24.280496 1519320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.00322040356695652 tr(WHW.T) 1799.3350830078125
bpp_loss 4.527406454086304
27_q proxy err 0.0011963947908952832 tr(WHW.T) 7691.708984375
bpp_loss 4.361953258514404
27_k proxy err 0.0009495099657215178 tr(WHW.T) 10618.70703125
bpp_loss 4.300724744796753
27_o proxy err 0.00569580402225256 tr(WHW.T) 126.13690185546875
bpp_loss 3.9088746309280396
27_up proxy err 0.005263224244117737 tr(WHW.T) 3691.557861328125
bpp_loss 3.858109762502271
27_gate proxy err 0.003292009001597762 tr(WHW.T) 5990.82568359375
bpp_loss 3.939797334892805
27_down proxy err 0.006657862104475498 tr(WHW.T) 466.9318542480469
bpp_loss 3.8813384300054508
W0320 18:40:25.247586 1519320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:40:25.251317 1517129 quantize_finetune_llama.py:203] layer 30 gpu 2
I0320 18:40:25.265854 1519320 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:40:26.685274 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 0.8529832363128662s
I0320 18:40:30.437672 1519379 config.py:54] PyTorch version 2.6.0 available.
W0320 18:40:30.775235 1519379 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:40:31.721448 1519379 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:40:31.725703 1517129 quantize_finetune_llama.py:203] layer 31 gpu 3
I0320 18:40:31.744858 1519379 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0320 18:40:33.151691 1517129 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.0041582584381104s
I0320 18:40:37.280607 1519438 config.py:54] PyTorch version 2.6.0 available.
W0320 18:40:37.669999 1519438 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0320 18:40:38.793766 1519438 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0320 18:40:38.814904 1519438 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.0029924765694886446 tr(WHW.T) 2018.944091796875
bpp_loss 4.587397813796997
28_q proxy err 0.0009513162658549845 tr(WHW.T) 7651.126953125
bpp_loss 4.585522890090942
28_k proxy err 0.0007611511391587555 tr(WHW.T) 10544.8251953125
bpp_loss 4.552215337753296
28_o proxy err 0.004683270119130611 tr(WHW.T) 194.8240966796875
bpp_loss 3.9480557441711426
28_up proxy err 0.004383343271911144 tr(WHW.T) 4661.2666015625
bpp_loss 3.872377794842387
28_gate proxy err 0.00316247483715415 tr(WHW.T) 6547.48193359375
bpp_loss 3.9342278768849925
28_down proxy err 0.005914763081818819 tr(WHW.T) 603.8403930664062
bpp_loss 3.923672409944756
29_v proxy err 0.003312019631266594 tr(WHW.T) 1801.7730712890625
bpp_loss 4.530510187149048
29_q proxy err 0.0009574117721058428 tr(WHW.T) 7227.0009765625
bpp_loss 4.512848854064941
29_k proxy err 0.0007119729998521507 tr(WHW.T) 10558.609375
bpp_loss 4.4912941455841064
29_o proxy err 0.0041103423573076725 tr(WHW.T) 207.9054412841797
bpp_loss 3.9601718187332153
29_up proxy err 0.0034955500159412622 tr(WHW.T) 6070.0498046875
bpp_loss 3.884424786235011
29_gate proxy err 0.0029080172535032034 tr(WHW.T) 7369.6142578125
bpp_loss 3.9356284917787066
29_down proxy err 0.005108651705086231 tr(WHW.T) 782.2448120117188
bpp_loss 3.9850732448489166
30_v proxy err 0.002732453402131796 tr(WHW.T) 2261.489501953125
bpp_loss 4.604867219924927
30_q proxy err 0.0008813960594125092 tr(WHW.T) 7815.9453125
bpp_loss 4.608014822006226
30_k proxy err 0.0006849754718132317 tr(WHW.T) 10521.625
bpp_loss 4.629769802093506
30_o proxy err 0.003966269548982382 tr(WHW.T) 251.96908569335938
bpp_loss 4.0041663646698
30_up proxy err 0.0021698735654354095 tr(WHW.T) 10016.376953125
bpp_loss 3.8963804023210393
30_gate proxy err 0.001990566262975335 tr(WHW.T) 11001.119140625
bpp_loss 3.956390913142714
30_down proxy err 0.0016422938788309693 tr(WHW.T) 3582.617919921875
bpp_loss 4.094458202983057
31_v proxy err 0.004866037052124739 tr(WHW.T) 1268.2034912109375
bpp_loss 4.082740068435669
31_q proxy err 0.001180708990432322 tr(WHW.T) 6858.09130859375
bpp_loss 4.056077480316162
31_k proxy err 0.0008165093022398651 tr(WHW.T) 10233.677734375
bpp_loss 4.099411725997925
31_o proxy err 0.0023800835479050875 tr(WHW.T) 457.7950744628906
bpp_loss 3.9533822536468506
31_up proxy err 0.0012707789428532124 tr(WHW.T) 14563.890625
bpp_loss 3.9441975438317587
31_gate proxy err 0.0012540689203888178 tr(WHW.T) 14836.2939453125
bpp_loss 4.019333418025527
31_down proxy err 0.0006919762818142772 tr(WHW.T) 17873.55859375
bpp_loss 4.294251929881961
I0320 18:41:37.107644 1519569 config.py:54] PyTorch version 2.6.0 available.
W0320 18:41:37.406319 1519569 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0320 18:41:37.643174 1519569 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Llama-2-7b-hf",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "max_position_embeddings": 4096,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 32000
}

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  8.69it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  9.32it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00, 10.00it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  9.75it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  9.84it/s]
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00, 10.22it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00, 10.13it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.33it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00, 10.28it/s]
I0320 18:41:40.777238 1519569 hfize_llama.py:153] loaded layer 0
I0320 18:41:42.387898 1519569 hfize_llama.py:153] loaded layer 1
I0320 18:41:43.865602 1519569 hfize_llama.py:153] loaded layer 2
I0320 18:41:45.431865 1519569 hfize_llama.py:153] loaded layer 3
I0320 18:41:46.900902 1519569 hfize_llama.py:153] loaded layer 4
I0320 18:41:48.482547 1519569 hfize_llama.py:153] loaded layer 5
I0320 18:41:50.024571 1519569 hfize_llama.py:153] loaded layer 6
I0320 18:41:51.536474 1519569 hfize_llama.py:153] loaded layer 7
I0320 18:41:53.089328 1519569 hfize_llama.py:153] loaded layer 8
I0320 18:41:54.419320 1519569 hfize_llama.py:153] loaded layer 9
I0320 18:41:55.462514 1519569 hfize_llama.py:153] loaded layer 10
I0320 18:41:56.317165 1519569 hfize_llama.py:153] loaded layer 11
I0320 18:41:57.161840 1519569 hfize_llama.py:153] loaded layer 12
I0320 18:41:57.995428 1519569 hfize_llama.py:153] loaded layer 13
I0320 18:41:58.830288 1519569 hfize_llama.py:153] loaded layer 14
I0320 18:41:59.661568 1519569 hfize_llama.py:153] loaded layer 15
I0320 18:42:00.543854 1519569 hfize_llama.py:153] loaded layer 16
I0320 18:42:01.385823 1519569 hfize_llama.py:153] loaded layer 17
I0320 18:42:02.234088 1519569 hfize_llama.py:153] loaded layer 18
I0320 18:42:03.149691 1519569 hfize_llama.py:153] loaded layer 19
I0320 18:42:04.081645 1519569 hfize_llama.py:153] loaded layer 20
I0320 18:42:05.073085 1519569 hfize_llama.py:153] loaded layer 21
I0320 18:42:05.910364 1519569 hfize_llama.py:153] loaded layer 22
I0320 18:42:06.799548 1519569 hfize_llama.py:153] loaded layer 23
I0320 18:42:07.817843 1519569 hfize_llama.py:153] loaded layer 24
I0320 18:42:08.778180 1519569 hfize_llama.py:153] loaded layer 25
I0320 18:42:09.701963 1519569 hfize_llama.py:153] loaded layer 26
I0320 18:42:10.650003 1519569 hfize_llama.py:153] loaded layer 27
I0320 18:42:11.668752 1519569 hfize_llama.py:153] loaded layer 28
I0320 18:42:12.693463 1519569 hfize_llama.py:153] loaded layer 29
I0320 18:42:13.743800 1519569 hfize_llama.py:153] loaded layer 30
I0320 18:42:14.704099 1519569 hfize_llama.py:153] loaded layer 31
I0320 18:42:14.704265 1519569 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:08,  1.65s/it]Loading checkpoint shards:  33%|███▎      | 2/6 [00:02<00:05,  1.39s/it]Loading checkpoint shards:  50%|█████     | 3/6 [00:04<00:03,  1.31s/it]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:05<00:02,  1.19s/it]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:06<00:01,  1.11s/it]Loading checkpoint shards: 100%|██████████| 6/6 [00:06<00:00,  1.07it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:06<00:00,  1.11s/it]
I0320 18:43:18.229525 1519569 hfize_llama.py:167] successfully loaded hfized model
