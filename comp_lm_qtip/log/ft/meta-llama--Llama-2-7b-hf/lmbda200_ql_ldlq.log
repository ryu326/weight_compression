I0319 10:11:00.101410 1000640 config.py:54] PyTorch version 2.6.0 available.
W0319 10:11:00.389479 1000640 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:11:01.294469 1000640 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.08it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.74it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.05it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.23it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.34it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.92it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.96it/s]
I0319 10:11:02.248345 1000640 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:13,  2.24it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:14,  2.14it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.11it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:12,  2.17it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:12,  2.20it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:12,  2.12it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:11,  2.12it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:11,  2.16it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:10,  2.16it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:10,  2.10it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:05<00:09,  2.13it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:09,  2.17it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:06<00:08,  2.12it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:06<00:08,  2.15it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:07<00:07,  2.14it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:07<00:07,  2.13it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:07,  2.12it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:08<00:06,  2.09it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:06,  2.09it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:09<00:05,  2.08it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:09<00:05,  2.07it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:10<00:04,  2.07it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:10<00:04,  2.07it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:11<00:03,  2.08it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:11<00:03,  2.07it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:12<00:02,  2.09it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:12<00:02,  2.10it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:13<00:01,  2.12it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:13<00:01,  2.16it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:14<00:00,  2.22it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:14<00:00,  2.25it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:14<00:00,  2.27it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:14<00:00,  2.14it/s]
I0319 10:11:22.509002 1000640 quantize_finetune_llama.py:179] loaded compression model
I0319 10:11:36.732419 1000640 quantize_finetune_llama.py:183] loaded dataset and devset
I0319 10:11:41.098422 1000640 quantize_finetune_llama.py:203] layer 0 gpu 0
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
I0319 10:13:08.232345 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 86.98548817634583s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0319 10:13:33.388652 1002597 config.py:54] PyTorch version 2.6.0 available.
W0319 10:13:33.668031 1002597 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:13:34.538533 1002597 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:13:34.542611 1000640 quantize_finetune_llama.py:203] layer 1 gpu 1
I0319 10:14:33.875242 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 59.15218997001648s
I0319 10:14:45.815454 1003475 config.py:54] PyTorch version 2.6.0 available.
W0319 10:14:46.095436 1003475 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:14:46.962780 1003475 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:14:46.966829 1000640 quantize_finetune_llama.py:203] layer 2 gpu 2
I0319 10:15:48.882451 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 61.7420117855072s
I0319 10:15:59.829615 1004314 config.py:54] PyTorch version 2.6.0 available.
W0319 10:16:00.104661 1004314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:16:00.985980 1004314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:16:00.990053 1000640 quantize_finetune_llama.py:203] layer 3 gpu 0
I0319 10:17:00.513858 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 57.89723825454712s
I0319 10:17:03.826975 1004927 config.py:54] PyTorch version 2.6.0 available.
W0319 10:17:04.106439 1004927 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:17:04.974110 1004927 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:17:04.978060 1000640 quantize_finetune_llama.py:203] layer 4 gpu 1
I0319 10:18:02.207292 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 56.8335747718811s
I0319 10:18:05.533751 1005524 config.py:54] PyTorch version 2.6.0 available.
W0319 10:18:05.813252 1005524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:18:06.679274 1005524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:18:06.683151 1000640 quantize_finetune_llama.py:203] layer 5 gpu 2
I0319 10:19:04.657890 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 57.58145213127136s
I0319 10:19:07.858591 1006133 config.py:54] PyTorch version 2.6.0 available.
W0319 10:19:08.139554 1006133 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:19:09.040739 1006133 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:19:09.044657 1000640 quantize_finetune_llama.py:203] layer 6 gpu 0
I0319 10:20:08.400646 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 57.50306582450867s
I0319 10:20:11.707090 1006770 config.py:54] PyTorch version 2.6.0 available.
W0319 10:20:11.986890 1006770 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:20:12.879755 1006770 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:20:12.883579 1000640 quantize_finetune_llama.py:203] layer 7 gpu 1
I0319 10:21:10.301200 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 57.02350115776062s
I0319 10:21:13.595964 1007378 config.py:54] PyTorch version 2.6.0 available.
W0319 10:21:13.874771 1007378 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:21:14.749842 1007378 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:21:14.753766 1000640 quantize_finetune_llama.py:203] layer 8 gpu 2
I0319 10:22:12.297081 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 57.172157526016235s
I0319 10:22:15.510499 1007996 config.py:54] PyTorch version 2.6.0 available.
W0319 10:22:15.790591 1007996 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:22:16.662277 1007996 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:22:16.666170 1000640 quantize_finetune_llama.py:203] layer 9 gpu 0
I0319 10:23:15.303014 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 57.10133957862854s
I0319 10:23:18.498782 1008614 config.py:54] PyTorch version 2.6.0 available.
W0319 10:23:18.781211 1008614 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:23:19.654923 1008614 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:23:19.658827 1000640 quantize_finetune_llama.py:203] layer 10 gpu 1
I0319 10:24:15.783921 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 55.77543830871582s
I0319 10:24:19.103315 1009212 config.py:54] PyTorch version 2.6.0 available.
W0319 10:24:19.384218 1009212 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:24:20.277292 1009212 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:24:20.281163 1000640 quantize_finetune_llama.py:203] layer 11 gpu 2
I0319 10:25:17.702156 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 57.025487184524536s
I0319 10:25:20.905767 1009826 config.py:54] PyTorch version 2.6.0 available.
W0319 10:25:21.186080 1009826 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:25:22.059796 1009826 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:25:22.063733 1000640 quantize_finetune_llama.py:203] layer 12 gpu 0
I0319 10:26:20.779089 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 57.17409682273865s
I0319 10:26:23.947809 1010444 config.py:54] PyTorch version 2.6.0 available.
W0319 10:26:24.228717 1010444 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:26:25.096879 1010444 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:26:25.100735 1000640 quantize_finetune_llama.py:203] layer 13 gpu 1
I0319 10:27:21.608108 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 56.137619495391846s
I0319 10:27:24.918222 1011052 config.py:54] PyTorch version 2.6.0 available.
W0319 10:27:25.198834 1011052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:27:26.077804 1011052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:27:26.081683 1000640 quantize_finetune_llama.py:203] layer 14 gpu 2
I0319 10:28:22.954405 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 56.503257036209106s
I0319 10:28:26.143756 1011656 config.py:54] PyTorch version 2.6.0 available.
W0319 10:28:26.423256 1011656 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:28:27.295273 1011656 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:28:27.299242 1000640 quantize_finetune_llama.py:203] layer 15 gpu 0
I0319 10:29:25.427509 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 56.58692169189453s
I0319 10:29:28.740574 1012274 config.py:54] PyTorch version 2.6.0 available.
W0319 10:29:29.022210 1012274 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:29:29.906406 1012274 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:29:29.910313 1000640 quantize_finetune_llama.py:203] layer 16 gpu 1
I0319 10:30:26.147336 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 55.87378787994385s
I0319 10:30:29.333844 1012879 config.py:54] PyTorch version 2.6.0 available.
W0319 10:30:29.613812 1012879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:30:30.487174 1012879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:30:30.491151 1000640 quantize_finetune_llama.py:203] layer 17 gpu 2
I0319 10:31:27.703025 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 56.83401346206665s
I0319 10:31:30.906902 1013487 config.py:54] PyTorch version 2.6.0 available.
W0319 10:31:31.186691 1013487 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:31:32.056764 1013487 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:31:32.060638 1000640 quantize_finetune_llama.py:203] layer 18 gpu 0
I0319 10:32:30.550226 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 56.95719003677368s
I0319 10:32:33.745218 1014106 config.py:54] PyTorch version 2.6.0 available.
W0319 10:32:34.024580 1014106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:32:34.900038 1014106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:32:34.903984 1000640 quantize_finetune_llama.py:203] layer 19 gpu 1
I0319 10:33:31.864059 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 56.59451341629028s
I0319 10:33:35.174990 1014717 config.py:54] PyTorch version 2.6.0 available.
W0319 10:33:35.454702 1014717 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:33:36.321770 1014717 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:33:36.325636 1000640 quantize_finetune_llama.py:203] layer 20 gpu 2
I0319 10:34:33.701273 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 57.00899267196655s
I0319 10:34:36.896911 1015328 config.py:54] PyTorch version 2.6.0 available.
W0319 10:34:37.178310 1015328 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:34:38.046820 1015328 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:34:38.050810 1000640 quantize_finetune_llama.py:203] layer 21 gpu 0
I0319 10:35:36.465645 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 56.89620089530945s
I0319 10:35:39.774513 1015950 config.py:54] PyTorch version 2.6.0 available.
W0319 10:35:40.054559 1015950 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:35:40.926903 1015950 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:35:40.930815 1000640 quantize_finetune_llama.py:203] layer 22 gpu 1
I0319 10:36:37.504248 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 56.21762299537659s
I0319 10:36:40.806782 1016554 config.py:54] PyTorch version 2.6.0 available.
W0319 10:36:41.087719 1016554 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:36:41.960145 1016554 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:36:41.964068 1000640 quantize_finetune_llama.py:203] layer 23 gpu 2
I0319 10:37:39.062776 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 56.72734189033508s
I0319 10:37:42.257329 1017162 config.py:54] PyTorch version 2.6.0 available.
W0319 10:37:42.537701 1017162 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:37:43.408208 1017162 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:37:43.412038 1000640 quantize_finetune_llama.py:203] layer 24 gpu 0
I0319 10:38:41.625265 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 56.67456340789795s
I0319 10:38:44.801682 1017834 config.py:54] PyTorch version 2.6.0 available.
W0319 10:38:45.081772 1017834 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:38:45.945760 1017834 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:38:45.949649 1000640 quantize_finetune_llama.py:203] layer 25 gpu 1
I0319 10:39:42.218319 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 55.90829110145569s
I0319 10:39:45.409483 1018095 config.py:54] PyTorch version 2.6.0 available.
W0319 10:39:45.691498 1018095 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:39:46.563338 1018095 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:39:46.567235 1000640 quantize_finetune_llama.py:203] layer 26 gpu 2
I0319 10:40:43.844463 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 56.8993444442749s
I0319 10:40:47.028281 1018264 config.py:54] PyTorch version 2.6.0 available.
W0319 10:40:47.309108 1018264 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:40:48.174122 1018264 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:40:48.178009 1000640 quantize_finetune_llama.py:203] layer 27 gpu 0
I0319 10:40:48.190998 1018264 data_utils.py:336] using 256 training seqs, 128 validation seqs
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
I0319 10:41:06.364843 1018264 finetune.py:45] layer 26_v initial loss 0.0003586832608561963
W0319 10:41:06.365135 1018264 warnings.py:109] /workspace/Weight_compression/comp_lm_qtip/lib/algo/finetune.py:46: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=(orig_dtype==torch.float16))

I0319 10:41:37.731655 1018264 finetune.py:68] layer 26_v @ epoch 0 new loss 0.0001936191983986646 old loss 0.0003586832608561963 BETTER
I0319 10:41:47.224725 1000640 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 57.542027711868286s
I0319 10:41:50.579766 1018482 config.py:54] PyTorch version 2.6.0 available.
W0319 10:41:50.872287 1018482 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0319 10:41:51.795183 1018482 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0319 10:41:51.798886 1000640 quantize_finetune_llama.py:203] layer 28 gpu 1
I0319 10:41:51.811542 1018482 data_utils.py:336] using 256 training seqs, 128 validation seqs
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
I0319 10:42:08.829297 1018482 finetune.py:45] layer 27_v initial loss 0.00039904098957777023
W0319 10:42:08.829531 1018482 warnings.py:109] /workspace/Weight_compression/comp_lm_qtip/lib/algo/finetune.py:46: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=(orig_dtype==torch.float16))

I0319 10:42:09.893859 1018264 finetune.py:68] layer 26_v @ epoch 1 new loss 0.00018334937340114266 old loss 0.0001936191983986646 BETTER
I0319 10:42:41.100870 1018482 finetune.py:68] layer 27_v @ epoch 0 new loss 0.0001769147056620568 old loss 0.00039904098957777023 BETTER
I0319 10:42:42.363787 1018264 finetune.py:68] layer 26_v @ epoch 2 new loss 0.0001787187356967479 old loss 0.00018334937340114266 BETTER
I0319 10:43:14.713362 1018482 finetune.py:68] layer 27_v @ epoch 1 new loss 0.0001685149472905323 old loss 0.0001769147056620568 BETTER
I0319 10:43:15.114778 1018264 finetune.py:68] layer 26_v @ epoch 3 new loss 0.0001759061706252396 old loss 0.0001787187356967479 BETTER
I0319 10:43:48.064440 1018264 finetune.py:68] layer 26_v @ epoch 4 new loss 0.00017386562831234187 old loss 0.0001759061706252396 BETTER
I0319 10:43:48.853126 1018482 finetune.py:68] layer 27_v @ epoch 2 new loss 0.0001649660844122991 old loss 0.0001685149472905323 BETTER
I0319 10:44:06.205638 1018264 finetune.py:45] layer 26_q initial loss 0.00021892516815569252
I0319 10:44:23.520638 1018482 finetune.py:68] layer 27_v @ epoch 3 new loss 0.0001626020239200443 old loss 0.0001649660844122991 BETTER
I0319 10:44:37.629053 1018264 finetune.py:68] layer 26_q @ epoch 0 new loss 0.00021408995962701738 old loss 0.00021892516815569252 BETTER
I0319 10:44:58.271199 1018482 finetune.py:68] layer 27_v @ epoch 4 new loss 0.00016074615996330976 old loss 0.0001626020239200443 BETTER
I0319 10:45:09.678126 1018264 finetune.py:68] layer 26_q @ epoch 1 new loss 0.000211230362765491 old loss 0.00021408995962701738 BETTER
I0319 10:45:16.191765 1018482 finetune.py:45] layer 27_q initial loss 0.00020820574718527496
