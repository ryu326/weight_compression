I0324 05:56:45.067677 4003803 config.py:54] PyTorch version 2.6.0 available.
W0324 05:56:45.351065 4003803 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:56:46.239629 4003803 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.03it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.88it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.05it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.28it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.42it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.49it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.18it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.16it/s]
I0324 05:56:47.668344 4003803 quantize_finetune_llama.py:150] loaded model
I0324 05:56:47.938759 4003803 quantize_finetune_llama.py:185] loaded compression model
I0324 05:57:05.593179 4003803 quantize_finetune_llama.py:189] loaded dataset and devset
I0324 05:57:11.103604 4003803 quantize_finetune_llama.py:209] layer 0 gpu 0
I0324 05:57:14.707686 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 3.457179546356201s
Use train scale and shift
tensor(-1.5053e-07, device='cuda:0') tensor(0.0156, device='cuda:0')
tensor(0.0156, device='cuda:0') tensor(-1.5053e-07, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0324 05:57:26.636292 4004343 config.py:54] PyTorch version 2.6.0 available.
W0324 05:57:26.916454 4004343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:57:27.796228 4004343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:57:27.800288 4003803 quantize_finetune_llama.py:209] layer 1 gpu 1
I0324 05:57:27.948549 4004343 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:57:31.102171 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 3.1335203647613525s
I0324 05:57:34.561510 4004477 config.py:54] PyTorch version 2.6.0 available.
W0324 05:57:34.845794 4004477 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:57:35.753089 4004477 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:57:35.756865 4003803 quantize_finetune_llama.py:209] layer 2 gpu 2
I0324 05:57:35.962862 4004477 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:57:38.449277 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 2.5476529598236084s
I0324 05:57:42.044100 4004623 config.py:54] PyTorch version 2.6.0 available.
W0324 05:57:42.395278 4004623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:57:43.341614 4004623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:57:43.345719 4003803 quantize_finetune_llama.py:209] layer 3 gpu 3
I0324 05:57:43.546762 4004623 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:57:45.782742 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 2.270921468734741s
I0324 05:57:49.556217 4004758 config.py:54] PyTorch version 2.6.0 available.
W0324 05:57:49.888091 4004758 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:57:50.980367 4004758 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:57:50.988613 4003803 quantize_finetune_llama.py:209] layer 4 gpu 0
I0324 05:57:51.191851 4004758 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.0003301617398392409 tr(WHW.T) 59.109249114990234
bpp_loss 7.233761787414551
0_q proxy err 1.831246117944829e-05 tr(WHW.T) 288041.78125
bpp_loss 5.964721918106079
0_k proxy err 1.6255591617664322e-05 tr(WHW.T) 100152.8671875
bpp_loss 7.616129398345947
0_o proxy err 0.0001659177796682343 tr(WHW.T) 3113.9609375
bpp_loss 5.511214733123779
0_up proxy err 0.0011062531266361475 tr(WHW.T) 8859.7275390625
bpp_loss 5.032526288713727
0_gate proxy err 0.000657184049487114 tr(WHW.T) 15700.0
bpp_loss 5.107035773141043
0_down proxy err 0.00044162405538372695 tr(WHW.T) 10753.7939453125
bpp_loss 5.474735804966518
1_v proxy err 0.00040345758316107094 tr(WHW.T) 106.54676055908203
bpp_loss 7.211158990859985
1_q proxy err 1.855579284892883e-05 tr(WHW.T) 144769.71875
bpp_loss 6.188850164413452
1_k proxy err 1.3842960470356047e-05 tr(WHW.T) 75510.046875
bpp_loss 7.9465014934539795
1_o proxy err 0.00039819860830903053 tr(WHW.T) 1971.8739013671875
bpp_loss 5.492891311645508
1_up proxy err 0.0012056356063112617 tr(WHW.T) 8164.14208984375
bpp_loss 5.043294906616211
1_gate proxy err 0.0007377255242317915 tr(WHW.T) 13871.78125
bpp_loss 5.11986323765346
1_down proxy err 2.3711598259978928e-05 tr(WHW.T) 13911.810546875
bpp_loss 5.764376640319824
I0324 05:58:44.459358 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 0.9842996597290039s
I0324 05:58:48.216699 4005378 config.py:54] PyTorch version 2.6.0 available.
W0324 05:58:48.562546 4005378 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:58:49.618581 4005378 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:58:49.622813 4003803 quantize_finetune_llama.py:209] layer 5 gpu 1
I0324 05:58:49.807031 4005378 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.0002299503976246342 tr(WHW.T) 154.1771240234375
bpp_loss 7.19884729385376
2_q proxy err 4.571300814859569e-05 tr(WHW.T) 41423.8046875
bpp_loss 6.026169538497925
2_k proxy err 2.5930037736543454e-05 tr(WHW.T) 22584.275390625
bpp_loss 7.756422996520996
2_o proxy err 0.00039049042970873415 tr(WHW.T) 1957.195556640625
bpp_loss 5.463270664215088
2_up proxy err 0.0013480144552886486 tr(WHW.T) 7534.43212890625
bpp_loss 5.031932013375418
2_gate proxy err 0.0007033220026642084 tr(WHW.T) 15028.0859375
bpp_loss 5.140156064714704
2_down proxy err 0.0006426458130590618 tr(WHW.T) 7660.255859375
bpp_loss 5.470563343593052
I0324 05:58:53.482048 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 0.8721294403076172s
I0324 05:58:57.267303 4005525 config.py:54] PyTorch version 2.6.0 available.
W0324 05:58:57.606364 4005525 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:58:58.589038 4005525 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:58:58.593231 4003803 quantize_finetune_llama.py:209] layer 6 gpu 2
I0324 05:58:58.765784 4005525 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.0001777184515958652 tr(WHW.T) 286.8193664550781
bpp_loss 7.199767351150513
3_q proxy err 5.6053599109873176e-05 tr(WHW.T) 47525.1171875
bpp_loss 5.886507034301758
3_k proxy err 2.9477749194484204e-05 tr(WHW.T) 26144.298828125
bpp_loss 7.422930717468262
3_o proxy err 0.0005359969800338149 tr(WHW.T) 1843.92529296875
bpp_loss 5.4659082889556885
3_up proxy err 0.0013410253450274467 tr(WHW.T) 7472.86376953125
bpp_loss 5.020130429949079
3_gate proxy err 0.0005110804922878742 tr(WHW.T) 20788.29296875
bpp_loss 5.203993388584682
3_down proxy err 0.0006881100125610828 tr(WHW.T) 6935.24755859375
bpp_loss 5.463965552193778
I0324 05:59:01.047497 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.9065163135528564s
I0324 05:59:04.729004 4005655 config.py:54] PyTorch version 2.6.0 available.
W0324 05:59:05.063838 4005655 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:59:06.014469 4005655 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:59:06.018529 4003803 quantize_finetune_llama.py:209] layer 7 gpu 3
I0324 05:59:06.297251 4005655 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:59:07.363427 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 0.8708605766296387s
I0324 05:59:11.290894 4005770 config.py:54] PyTorch version 2.6.0 available.
W0324 05:59:11.646771 4005770 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:59:12.736336 4005770 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:59:12.740576 4003803 quantize_finetune_llama.py:209] layer 8 gpu 0
I0324 05:59:12.896327 4005770 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.0002076572272926569 tr(WHW.T) 282.38128662109375
bpp_loss 7.199082612991333
4_q proxy err 4.7270674258470535e-05 tr(WHW.T) 50064.37109375
bpp_loss 5.925714492797852
4_k proxy err 2.525239688111469e-05 tr(WHW.T) 29272.75390625
bpp_loss 7.521921634674072
4_o proxy err 0.0007255589007399976 tr(WHW.T) 1283.4017333984375
bpp_loss 5.48965048789978
4_up proxy err 0.0013285491149872541 tr(WHW.T) 7323.07763671875
bpp_loss 5.007305417742048
4_gate proxy err 0.0003651364822871983 tr(WHW.T) 29023.8984375
bpp_loss 5.270045689174107
4_down proxy err 0.0007194576319307089 tr(WHW.T) 6335.5126953125
bpp_loss 5.461755343845913
5_v proxy err 0.00019547237025108188 tr(WHW.T) 206.8122100830078
bpp_loss 7.197780609130859
5_q proxy err 6.0544221923919395e-05 tr(WHW.T) 35941.703125
bpp_loss 5.926958322525024
5_k proxy err 2.855266211554408e-05 tr(WHW.T) 22968.27734375
bpp_loss 7.540953874588013
5_o proxy err 0.000778676534537226 tr(WHW.T) 1043.734619140625
bpp_loss 5.481205224990845
5_up proxy err 0.0012748937588185072 tr(WHW.T) 7595.3154296875
bpp_loss 5.012755257742746
5_gate proxy err 0.00034654419869184494 tr(WHW.T) 30279.96875
bpp_loss 5.272087369646345
5_down proxy err 0.0007278662524186075 tr(WHW.T) 6350.38623046875
bpp_loss 5.460103443690708
I0324 06:00:07.873276 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.1680562496185303s
I0324 06:00:11.617156 4006401 config.py:54] PyTorch version 2.6.0 available.
W0324 06:00:11.966176 4006401 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:00:12.957613 4006401 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:00:12.961970 4003803 quantize_finetune_llama.py:209] layer 9 gpu 1
I0324 06:00:13.167164 4006401 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.00019141875964123756 tr(WHW.T) 251.2519073486328
bpp_loss 7.199035406112671
6_q proxy err 6.501145981019363e-05 tr(WHW.T) 35587.6171875
bpp_loss 5.925264358520508
6_k proxy err 2.8430127713363618e-05 tr(WHW.T) 26134.267578125
bpp_loss 7.459616661071777
6_o proxy err 0.0009384368313476443 tr(WHW.T) 996.2373657226562
bpp_loss 5.470422983169556
6_up proxy err 0.0012053442187607288 tr(WHW.T) 7862.4482421875
bpp_loss 5.017608370099749
6_gate proxy err 0.00028996230685152113 tr(WHW.T) 35640.2578125
bpp_loss 5.283373151506696
6_down proxy err 0.00071697001112625 tr(WHW.T) 6422.8779296875
bpp_loss 5.460834980010986
I0324 06:00:16.060055 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 0.9019050598144531s
I0324 06:00:19.855247 4006547 config.py:54] PyTorch version 2.6.0 available.
W0324 06:00:20.170312 4006547 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.00015616991731803864 tr(WHW.T) 307.0851135253906
bpp_loss 7.1980907917022705
7_q proxy err 6.803933501942083e-05 tr(WHW.T) 35097.21875
bpp_loss 5.841691970825195
7_k proxy err 2.837295141944196e-05 tr(WHW.T) 26820.58203125
bpp_loss 7.426253080368042
7_o proxy err 0.0010196438524872065 tr(WHW.T) 945.8643798828125
bpp_loss 5.4714133739471436
7_up proxy err 0.0010931909782812 tr(WHW.T) 8564.646484375
bpp_loss 5.030970437186105
7_gate proxy err 0.0002914010838139802 tr(WHW.T) 34799.35546875
bpp_loss 5.265257699148996
7_down proxy err 0.0007300383877009153 tr(WHW.T) 6472.18505859375
bpp_loss 5.461954866136823
W0324 06:00:21.113859 4006547 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:00:21.117915 4003803 quantize_finetune_llama.py:209] layer 10 gpu 2
I0324 06:00:21.269776 4006547 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:00:22.357819 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.6969265937805176s
I0324 06:00:26.077077 4006667 config.py:54] PyTorch version 2.6.0 available.
W0324 06:00:26.404546 4006667 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:00:27.378989 4006667 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:00:27.383091 4003803 quantize_finetune_llama.py:209] layer 11 gpu 3
I0324 06:00:27.586359 4006667 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:00:28.808166 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 0.9196557998657227s
I0324 06:00:32.596794 4006784 config.py:54] PyTorch version 2.6.0 available.
W0324 06:00:32.957978 4006784 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:00:34.045297 4006784 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:00:34.049578 4003803 quantize_finetune_llama.py:209] layer 12 gpu 0
I0324 06:00:34.245634 4006784 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.00020424873218871653 tr(WHW.T) 255.12034606933594
bpp_loss 7.199676275253296
8_q proxy err 8.344213711097836e-05 tr(WHW.T) 26552.91015625
bpp_loss 5.861394882202148
8_k proxy err 3.192133954144083e-05 tr(WHW.T) 22499.31640625
bpp_loss 7.42721152305603
8_o proxy err 0.0013679707190021873 tr(WHW.T) 731.734619140625
bpp_loss 5.470827341079712
8_up proxy err 0.0011031911708414555 tr(WHW.T) 8432.8056640625
bpp_loss 5.02882194519043
8_gate proxy err 0.00027176845469512045 tr(WHW.T) 37132.96875
bpp_loss 5.272445133754185
8_down proxy err 0.0007314077811315656 tr(WHW.T) 6426.78076171875
bpp_loss 5.461149283817837
9_v proxy err 0.00020167675393167883 tr(WHW.T) 347.93878173828125
bpp_loss 7.1993584632873535
9_q proxy err 8.78345817909576e-05 tr(WHW.T) 25605.146484375
bpp_loss 5.852590799331665
9_k proxy err 3.4231346944579855e-05 tr(WHW.T) 20913.2890625
bpp_loss 7.397948503494263
9_o proxy err 0.0013642484555020928 tr(WHW.T) 760.7015380859375
bpp_loss 5.4993767738342285
9_up proxy err 0.0010514719178900123 tr(WHW.T) 8907.26953125
bpp_loss 5.034564699445452
9_gate proxy err 0.00025871885009109974 tr(WHW.T) 39307.90625
bpp_loss 5.286407743181501
9_down proxy err 0.000763828051276505 tr(WHW.T) 6210.4736328125
bpp_loss 5.460486888885498
I0324 06:01:31.174095 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 0.8871078491210938s
I0324 06:01:35.094149 4007431 config.py:54] PyTorch version 2.6.0 available.
W0324 06:01:35.441168 4007431 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:01:36.469811 4007431 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:01:36.474100 4003803 quantize_finetune_llama.py:209] layer 13 gpu 1
I0324 06:01:36.678736 4007431 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.00020338079775683582 tr(WHW.T) 249.3217315673828
bpp_loss 7.197802782058716
10_q proxy err 8.90413430170156e-05 tr(WHW.T) 23288.234375
bpp_loss 5.914762258529663
10_k proxy err 3.309439853182994e-05 tr(WHW.T) 19713.98828125
bpp_loss 7.500270128250122
10_o proxy err 0.0013792579993605614 tr(WHW.T) 667.1098022460938
bpp_loss 5.4850013256073
10_up proxy err 0.0010340025182813406 tr(WHW.T) 9133.763671875
bpp_loss 5.045087814331055
10_gate proxy err 0.00027256718021817505 tr(WHW.T) 37296.734375
bpp_loss 5.25653920854841
10_down proxy err 0.0007551743765361607 tr(WHW.T) 6460.98828125
bpp_loss 5.460247107914516
I0324 06:01:38.915883 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 0.8239576816558838s
11_v proxy err 0.00015787914162501693 tr(WHW.T) 317.10748291015625
bpp_loss 7.199824571609497
11_q proxy err 9.673577005742118e-05 tr(WHW.T) 22146.080078125
bpp_loss 5.809713363647461
11_k proxy err 3.776254379772581e-05 tr(WHW.T) 17998.236328125
bpp_loss 7.412844896316528
11_o proxy err 0.001650652033276856 tr(WHW.T) 551.7962036132812
bpp_loss 5.498551607131958
11_up proxy err 0.0010132560273632407 tr(WHW.T) 9126.3212890625
bpp_loss 5.055099759783063
11_gate proxy err 0.00027127822977490723 tr(WHW.T) 36783.98828125
bpp_loss 5.2458327157156805
11_down proxy err 0.0007508366834372282 tr(WHW.T) 6590.6376953125
bpp_loss 5.461136817932129
I0324 06:01:42.668156 4007558 config.py:54] PyTorch version 2.6.0 available.
W0324 06:01:42.969595 4007558 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:01:43.879095 4007558 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:01:43.882770 4003803 quantize_finetune_llama.py:209] layer 14 gpu 2
I0324 06:01:44.056413 4007558 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:01:45.296415 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 0.9834380149841309s
I0324 06:01:49.135380 4007701 config.py:54] PyTorch version 2.6.0 available.
W0324 06:01:49.449024 4007701 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:01:50.362382 4007701 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:01:50.366436 4003803 quantize_finetune_llama.py:209] layer 15 gpu 3
I0324 06:01:50.557137 4007701 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:01:51.747567 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.9021661281585693s
I0324 06:01:55.611476 4007828 config.py:54] PyTorch version 2.6.0 available.
W0324 06:01:55.972006 4007828 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:01:57.057915 4007828 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:01:57.062134 4003803 quantize_finetune_llama.py:209] layer 16 gpu 0
I0324 06:01:57.239364 4007828 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.00019212158804293722 tr(WHW.T) 360.1876220703125
bpp_loss 7.199023962020874
12_q proxy err 7.184305286500603e-05 tr(WHW.T) 34056.6171875
bpp_loss 5.80044960975647
12_k proxy err 3.2953412301139906e-05 tr(WHW.T) 23029.2578125
bpp_loss 7.31854248046875
12_o proxy err 0.001470697345212102 tr(WHW.T) 763.9736938476562
bpp_loss 5.476521968841553
12_up proxy err 0.0009022117592394352 tr(WHW.T) 9958.251953125
bpp_loss 5.0771010262625555
12_gate proxy err 0.0002630826784297824 tr(WHW.T) 37236.3125
bpp_loss 5.236632210867746
12_down proxy err 0.000746586243622005 tr(WHW.T) 6755.458984375
bpp_loss 5.464957645961216
13_v proxy err 0.00021176323934923857 tr(WHW.T) 277.2203063964844
bpp_loss 7.1987550258636475
13_q proxy err 0.00010223357094218954 tr(WHW.T) 20850.333984375
bpp_loss 5.850327253341675
13_k proxy err 3.836334144580178e-05 tr(WHW.T) 17769.017578125
bpp_loss 7.418684959411621
13_o proxy err 0.0015244202222675085 tr(WHW.T) 660.1426391601562
bpp_loss 5.491691827774048
13_up proxy err 0.0009026405168697238 tr(WHW.T) 9940.990234375
bpp_loss 5.079862867082868
13_gate proxy err 0.00025484993238933384 tr(WHW.T) 38823.03515625
bpp_loss 5.237382888793945
13_down proxy err 0.0007783558103255928 tr(WHW.T) 6493.29833984375
bpp_loss 5.463985647474017
I0324 06:02:58.931785 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 0.8780612945556641s
I0324 06:03:02.712419 4008506 config.py:54] PyTorch version 2.6.0 available.
W0324 06:03:03.055780 4008506 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.0002075719239655882 tr(WHW.T) 278.4633483886719
bpp_loss 7.19879150390625
14_q proxy err 9.530765964882448e-05 tr(WHW.T) 20836.7890625
bpp_loss 5.844202518463135
14_k proxy err 3.573611320462078e-05 tr(WHW.T) 18589.970703125
bpp_loss 7.460539817810059
14_o proxy err 0.0015627974644303322 tr(WHW.T) 671.372314453125
bpp_loss 5.478816509246826
14_up proxy err 0.0009631672292016447 tr(WHW.T) 9095.5224609375
bpp_loss 5.081188474382673
14_gate proxy err 0.0002403413236606866 tr(WHW.T) 41682.6328125
bpp_loss 5.264104843139648
14_down proxy err 0.0007860801415517926 tr(WHW.T) 6324.00830078125
bpp_loss 5.467969485691616
W0324 06:03:04.008655 4008506 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:03:04.012808 4003803 quantize_finetune_llama.py:209] layer 17 gpu 1
I0324 06:03:04.163649 4008506 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:03:06.143094 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.8665218353271484s
I0324 06:03:10.016423 4008632 config.py:54] PyTorch version 2.6.0 available.
W0324 06:03:10.346712 4008632 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.00024177992600016296 tr(WHW.T) 280.61700439453125
bpp_loss 7.19983172416687
15_q proxy err 8.208321378333494e-05 tr(WHW.T) 28024.23046875
bpp_loss 5.956661224365234
15_k proxy err 3.5997119994135574e-05 tr(WHW.T) 18843.171875
bpp_loss 7.361757278442383
15_o proxy err 0.0012693068711087108 tr(WHW.T) 811.894287109375
bpp_loss 5.504443407058716
15_up proxy err 0.0009957789443433285 tr(WHW.T) 8926.90625
bpp_loss 5.071587698800223
15_gate proxy err 0.00022169995645526797 tr(WHW.T) 46109.49609375
bpp_loss 5.2909954616001675
15_down proxy err 0.0007821171311661601 tr(WHW.T) 6333.17138671875
bpp_loss 5.46544885635376
W0324 06:03:11.230720 4008632 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:03:11.234938 4003803 quantize_finetune_llama.py:209] layer 18 gpu 2
I0324 06:03:11.447842 4008632 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:03:12.464463 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.8019778728485107s
I0324 06:03:16.222692 4008761 config.py:54] PyTorch version 2.6.0 available.
W0324 06:03:16.547681 4008761 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:03:17.495126 4008761 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:03:17.498852 4003803 quantize_finetune_llama.py:209] layer 19 gpu 3
I0324 06:03:17.697906 4008761 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:03:18.801280 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 19 in 0.8863916397094727s
I0324 06:03:22.816029 4008881 config.py:54] PyTorch version 2.6.0 available.
W0324 06:03:23.215036 4008881 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:03:24.460560 4008881 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:03:24.464706 4003803 quantize_finetune_llama.py:209] layer 20 gpu 0
I0324 06:03:24.652332 4008881 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.0002210763341281563 tr(WHW.T) 271.2865905761719
bpp_loss 7.19963264465332
16_q proxy err 8.11492936918512e-05 tr(WHW.T) 24435.3515625
bpp_loss 5.948072195053101
16_k proxy err 3.1193660106509924e-05 tr(WHW.T) 19477.44140625
bpp_loss 7.4820191860198975
16_o proxy err 0.0011055597569793463 tr(WHW.T) 953.8026733398438
bpp_loss 5.484929800033569
16_up proxy err 0.0011182058369740844 tr(WHW.T) 8265.3720703125
bpp_loss 5.052131380353655
16_gate proxy err 0.00025336298858746886 tr(WHW.T) 41062.52734375
bpp_loss 5.314363207135882
16_down proxy err 0.0007802246836945415 tr(WHW.T) 6223.8134765625
bpp_loss 5.463220119476318
17_v proxy err 0.0002565096947364509 tr(WHW.T) 280.3503723144531
bpp_loss 7.1997809410095215
17_q proxy err 8.08009208412841e-05 tr(WHW.T) 27519.18359375
bpp_loss 5.924480199813843
17_k proxy err 3.763785935007036e-05 tr(WHW.T) 17400.5703125
bpp_loss 7.389760494232178
17_o proxy err 0.0009706392302177846 tr(WHW.T) 1090.2861328125
bpp_loss 5.505742788314819
17_up proxy err 0.0011202790774405003 tr(WHW.T) 8387.2646484375
bpp_loss 5.045314243861607
17_gate proxy err 0.00025277884560637176 tr(WHW.T) 41601.640625
bpp_loss 5.324699401855469
17_down proxy err 0.0007923810626380146 tr(WHW.T) 6148.05908203125
bpp_loss 5.460974012102399
I0324 06:04:31.570854 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 20 in 1.0729224681854248s
I0324 06:04:35.775183 4009612 config.py:54] PyTorch version 2.6.0 available.
W0324 06:04:36.113581 4009612 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.00020810269052162766 tr(WHW.T) 284.6707763671875
bpp_loss 7.1990251541137695
18_q proxy err 9.956428402801976e-05 tr(WHW.T) 22348.99609375
bpp_loss 5.892336368560791
18_k proxy err 4.0176990296458825e-05 tr(WHW.T) 17364.087890625
bpp_loss 7.405554533004761
18_o proxy err 0.000873326207511127 tr(WHW.T) 1187.6383056640625
bpp_loss 5.494643926620483
18_up proxy err 0.001224856241606176 tr(WHW.T) 7918.30078125
bpp_loss 5.033743722098214
18_gate proxy err 0.00030299133504740894 tr(WHW.T) 35127.12890625
bpp_loss 5.323578425816128
18_down proxy err 0.0007878529140725732 tr(WHW.T) 6162.73876953125
bpp_loss 5.460092544555664
W0324 06:04:37.138150 4009612 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:04:37.142296 4003803 quantize_finetune_llama.py:209] layer 21 gpu 1
I0324 06:04:37.330931 4009612 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:04:38.445157 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 21 in 0.8082990646362305s
I0324 06:04:42.228370 4009732 config.py:54] PyTorch version 2.6.0 available.
W0324 06:04:42.580085 4009732 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:04:43.595911 4009732 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:04:43.600406 4003803 quantize_finetune_llama.py:209] layer 22 gpu 2
I0324 06:04:43.773128 4009732 data_utils.py:336] using 256 training seqs, 128 validation seqs
19_v proxy err 0.00019621280080173165 tr(WHW.T) 337.7576599121094
bpp_loss 7.199640512466431
19_q proxy err 9.593152208253741e-05 tr(WHW.T) 23987.353515625
bpp_loss 5.88221287727356
19_k proxy err 4.4535692723002285e-05 tr(WHW.T) 15524.9208984375
bpp_loss 7.327508926391602
19_o proxy err 0.0009435552638024092 tr(WHW.T) 1152.94091796875
bpp_loss 5.4895851612091064
19_up proxy err 0.0012883866438642144 tr(WHW.T) 7585.220703125
bpp_loss 5.028775896344866
19_gate proxy err 0.00032622061553411186 tr(WHW.T) 32694.146484375
bpp_loss 5.330509185791016
19_down proxy err 0.0007889755070209503 tr(WHW.T) 6119.1787109375
bpp_loss 5.4599127769470215
I0324 06:04:46.411057 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 22 in 0.5985276699066162s
I0324 06:04:50.104375 4009894 config.py:54] PyTorch version 2.6.0 available.
W0324 06:04:50.399628 4009894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:04:51.320458 4009894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:04:51.324500 4003803 quantize_finetune_llama.py:209] layer 23 gpu 3
I0324 06:04:51.548105 4009894 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:04:52.464438 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 23 in 0.7080323696136475s
I0324 06:04:56.372956 4010009 config.py:54] PyTorch version 2.6.0 available.
W0324 06:04:56.733943 4010009 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:04:57.733125 4010009 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:04:57.737294 4003803 quantize_finetune_llama.py:209] layer 24 gpu 0
I0324 06:04:57.922208 4010009 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.00022308851475827396 tr(WHW.T) 326.5545349121094
bpp_loss 7.199589967727661
20_q proxy err 0.00010204346472164616 tr(WHW.T) 20688.212890625
bpp_loss 5.889685153961182
20_k proxy err 4.147559593548067e-05 tr(WHW.T) 15368.2177734375
bpp_loss 7.33664870262146
20_o proxy err 0.0009089700179174542 tr(WHW.T) 1189.504638671875
bpp_loss 5.485422849655151
20_up proxy err 0.001303552882745862 tr(WHW.T) 7535.15576171875
bpp_loss 5.030131748744419
20_gate proxy err 0.0003491354582365602 tr(WHW.T) 30547.197265625
bpp_loss 5.329451969691685
20_down proxy err 0.0007806495996192098 tr(WHW.T) 6236.83935546875
bpp_loss 5.459757259913853
21_v proxy err 0.00021616749290842563 tr(WHW.T) 358.9937438964844
bpp_loss 7.2009875774383545
21_q proxy err 8.677770529175177e-05 tr(WHW.T) 25789.74609375
bpp_loss 5.860615253448486
21_k proxy err 3.890256994054653e-05 tr(WHW.T) 16759.484375
bpp_loss 7.340221166610718
21_o proxy err 0.0007724293973296881 tr(WHW.T) 1250.279296875
bpp_loss 5.528141021728516
21_up proxy err 0.0012698109494522214 tr(WHW.T) 7707.68359375
bpp_loss 5.033453532627651
21_gate proxy err 0.00033913395600393414 tr(WHW.T) 31446.626953125
bpp_loss 5.340918132237026
21_down proxy err 0.000777379609644413 tr(WHW.T) 6287.07373046875
bpp_loss 5.460414069039481
I0324 06:06:03.989120 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 24 in 0.8558022975921631s
I0324 06:06:07.896036 4010733 config.py:54] PyTorch version 2.6.0 available.
W0324 06:06:08.251112 4010733 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:06:09.258660 4010733 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:06:09.262887 4003803 quantize_finetune_llama.py:209] layer 25 gpu 1
I0324 06:06:09.415499 4010733 data_utils.py:336] using 256 training seqs, 128 validation seqs
22_v proxy err 0.0002499585971236229 tr(WHW.T) 341.7787170410156
bpp_loss 7.199816942214966
22_q proxy err 9.988499368773773e-05 tr(WHW.T) 20273.72265625
bpp_loss 5.846459865570068
22_k proxy err 4.200347393634729e-05 tr(WHW.T) 14697.265625
bpp_loss 7.3466715812683105
22_o proxy err 0.0010218616807833314 tr(WHW.T) 1204.8531494140625
bpp_loss 5.473142623901367
22_up proxy err 0.0013224758440628648 tr(WHW.T) 7481.95849609375
bpp_loss 5.033473968505859
22_gate proxy err 0.000361310550943017 tr(WHW.T) 29414.359375
bpp_loss 5.340576444353376
22_down proxy err 0.0007628799066878855 tr(WHW.T) 6464.6640625
bpp_loss 5.459753240857806
I0324 06:06:13.899266 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 25 in 0.9243896007537842s
I0324 06:06:17.570944 4010888 config.py:54] PyTorch version 2.6.0 available.
W0324 06:06:17.882789 4010888 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:06:18.839494 4010888 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:06:18.843668 4003803 quantize_finetune_llama.py:209] layer 26 gpu 2
23_v proxy err 0.00024158800079021603 tr(WHW.T) 393.136962890625
bpp_loss 7.197788238525391
23_q proxy err 9.967042569769546e-05 tr(WHW.T) 22562.6484375
bpp_loss 5.8145458698272705
23_k proxy err 4.412968337419443e-05 tr(WHW.T) 14830.83203125
bpp_loss 7.270679473876953
23_o proxy err 0.0007463807705789804 tr(WHW.T) 1726.8399658203125
bpp_loss 5.472529411315918
23_up proxy err 0.001347018638625741 tr(WHW.T) 7353.39404296875
bpp_loss 5.036182676042829
23_gate proxy err 0.0003886510676238686 tr(WHW.T) 27171.52734375
bpp_loss 5.343547821044922
23_down proxy err 0.0007538690697401762 tr(WHW.T) 6601.61376953125
bpp_loss 5.45958001273019
I0324 06:06:19.064571 4010888 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:06:20.743311 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 26 in 0.6914448738098145s
I0324 06:06:24.402080 4011010 config.py:54] PyTorch version 2.6.0 available.
W0324 06:06:24.735266 4011010 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:06:25.657397 4011010 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:06:25.661114 4003803 quantize_finetune_llama.py:209] layer 27 gpu 3
I0324 06:06:25.855278 4011010 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:06:27.223056 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 27 in 1.0484132766723633s
I0324 06:06:31.253332 4011134 config.py:54] PyTorch version 2.6.0 available.
W0324 06:06:31.640587 4011134 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:06:32.694660 4011134 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:06:32.698775 4003803 quantize_finetune_llama.py:209] layer 28 gpu 0
I0324 06:06:32.880564 4011134 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.00024751469027251005 tr(WHW.T) 461.53338623046875
bpp_loss 7.199007034301758
24_q proxy err 9.672909072833136e-05 tr(WHW.T) 22391.330078125
bpp_loss 5.798243284225464
24_k proxy err 4.250269921612926e-05 tr(WHW.T) 14159.3115234375
bpp_loss 7.225865364074707
24_o proxy err 0.0008383694221265614 tr(WHW.T) 1570.1973876953125
bpp_loss 5.496212482452393
24_up proxy err 0.0013737678527832031 tr(WHW.T) 7244.748046875
bpp_loss 5.0387420654296875
24_gate proxy err 0.00041039171628654003 tr(WHW.T) 25756.130859375
bpp_loss 5.348972865513393
24_down proxy err 0.0007532925228588283 tr(WHW.T) 6675.92578125
bpp_loss 5.45946877343314
25_v proxy err 0.00021134881535544991 tr(WHW.T) 551.988037109375
bpp_loss 7.199036121368408
25_q proxy err 8.809842984192073e-05 tr(WHW.T) 26068.671875
bpp_loss 5.759718656539917
25_k proxy err 4.188925231574103e-05 tr(WHW.T) 14392.7578125
bpp_loss 7.218463897705078
25_o proxy err 0.0006683961837552488 tr(WHW.T) 1970.9990234375
bpp_loss 5.5005316734313965
25_up proxy err 0.0013557443162426353 tr(WHW.T) 7314.64501953125
bpp_loss 5.046496527535575
25_gate proxy err 0.00040230288868770003 tr(WHW.T) 26184.576171875
bpp_loss 5.359477996826172
25_down proxy err 0.000780585512984544 tr(WHW.T) 6548.80126953125
bpp_loss 5.4596719060625345
I0324 06:07:39.490582 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 28 in 0.7879879474639893s
I0324 06:07:43.310826 4011875 config.py:54] PyTorch version 2.6.0 available.
W0324 06:07:43.676139 4011875 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.00029647437622770667 tr(WHW.T) 428.11846923828125
bpp_loss 7.198934078216553
26_q proxy err 9.965613571694121e-05 tr(WHW.T) 21359.30078125
bpp_loss 5.79677152633667
26_k proxy err 4.153158442932181e-05 tr(WHW.T) 15400.1064453125
bpp_loss 7.276921033859253
26_o proxy err 0.0005248422967270017 tr(WHW.T) 2368.438720703125
bpp_loss 5.534443616867065
26_up proxy err 0.0013073422014713287 tr(WHW.T) 7577.00390625
bpp_loss 5.05363518851144
26_gate proxy err 0.0003668062563519925 tr(WHW.T) 28776.8671875
bpp_loss 5.369101388113839
26_down proxy err 0.0007933568558655679 tr(WHW.T) 6550.5390625
bpp_loss 5.459743635995047
W0324 06:07:44.641396 4011875 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:07:44.645699 4003803 quantize_finetune_llama.py:209] layer 29 gpu 1
I0324 06:07:44.807864 4011875 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:07:46.486346 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 29 in 0.6953701972961426s
I0324 06:07:50.205212 4012006 config.py:54] PyTorch version 2.6.0 available.
W0324 06:07:50.551760 4012006 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:07:51.560394 4012006 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:07:51.564731 4003803 quantize_finetune_llama.py:209] layer 30 gpu 2
I0324 06:07:51.731636 4012006 data_utils.py:336] using 256 training seqs, 128 validation seqs
27_v proxy err 0.00022175299818627536 tr(WHW.T) 670.2694702148438
bpp_loss 7.198752164840698
27_q proxy err 0.00010494537855265662 tr(WHW.T) 21263.427734375
bpp_loss 5.748058080673218
27_k proxy err 4.438711766852066e-05 tr(WHW.T) 13986.7197265625
bpp_loss 7.217870712280273
27_o proxy err 0.0006290486780926585 tr(WHW.T) 2138.571533203125
bpp_loss 5.528250694274902
27_up proxy err 0.0011921492405235767 tr(WHW.T) 8405.169921875
bpp_loss 5.062088557652065
27_gate proxy err 0.0003261558013036847 tr(WHW.T) 32682.3984375
bpp_loss 5.378710883004325
27_down proxy err 0.0007487231050617993 tr(WHW.T) 6473.53173828125
bpp_loss 5.492935725620815
I0324 06:07:55.307834 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 30 in 0.6094655990600586s
I0324 06:07:59.151720 4012160 config.py:54] PyTorch version 2.6.0 available.
W0324 06:07:59.518037 4012160 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:08:00.526032 4012160 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:08:00.530122 4003803 quantize_finetune_llama.py:209] layer 31 gpu 3
I0324 06:08:00.725749 4012160 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 06:08:02.178298 4003803 quantize_finetune_llama.py:240] computed original embedding for layer 31 in 1.0869128704071045s
I0324 06:08:06.139728 4012284 config.py:54] PyTorch version 2.6.0 available.
W0324 06:08:06.576457 4012284 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 06:08:07.835054 4012284 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 06:08:08.051543 4012284 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.00026693055406212807 tr(WHW.T) 593.4841918945312
bpp_loss 7.198907852172852
28_q proxy err 9.705756383482367e-05 tr(WHW.T) 23121.322265625
bpp_loss 5.74664568901062
28_k proxy err 3.943742558476515e-05 tr(WHW.T) 14971.62890625
bpp_loss 7.197331666946411
28_o proxy err 0.0005265487707220018 tr(WHW.T) 2488.906494140625
bpp_loss 5.559111595153809
28_up proxy err 0.0009735486237332225 tr(WHW.T) 10172.6669921875
bpp_loss 5.083330426897321
28_gate proxy err 0.000295875157462433 tr(WHW.T) 35795.8046875
bpp_loss 5.373125348772321
28_down proxy err 0.0006808388279750943 tr(WHW.T) 7137.84375
bpp_loss 5.504997525896345
29_v proxy err 0.0002070029149763286 tr(WHW.T) 841.72265625
bpp_loss 7.198521614074707
29_q proxy err 0.00012305706331972033 tr(WHW.T) 20611.14453125
bpp_loss 5.677756071090698
29_k proxy err 4.1795792640186846e-05 tr(WHW.T) 16341.0302734375
bpp_loss 7.2107203006744385
29_o proxy err 0.0003725250717252493 tr(WHW.T) 3078.73974609375
bpp_loss 5.627673149108887
29_up proxy err 0.0007805111818015575 tr(WHW.T) 12790.9697265625
bpp_loss 5.106624058314732
29_gate proxy err 0.0002780290669761598 tr(WHW.T) 38239.99609375
bpp_loss 5.369095393589565
29_down proxy err 0.0005793125601485372 tr(WHW.T) 7395.6328125
bpp_loss 5.558509486062186
30_v proxy err 0.0002915069053415209 tr(WHW.T) 850.5265502929688
bpp_loss 7.1988537311553955
30_q proxy err 9.674134344095364e-05 tr(WHW.T) 24012.384765625
bpp_loss 5.668025732040405
30_k proxy err 3.78693439415656e-05 tr(WHW.T) 14011.546875
bpp_loss 7.1969311237335205
30_o proxy err 0.0003434407990425825 tr(WHW.T) 4841.5751953125
bpp_loss 5.571086883544922
30_up proxy err 0.0004801542090717703 tr(WHW.T) 21629.68359375
bpp_loss 5.124369212559292
30_gate proxy err 0.0002127114130416885 tr(WHW.T) 51821.0
bpp_loss 5.413746425083706
30_down proxy err 0.00034323320141993463 tr(WHW.T) 8734.203125
bpp_loss 5.652978760855539
31_v proxy err 0.00011589128553168848 tr(WHW.T) 1798.7896728515625
bpp_loss 7.200978994369507
31_q proxy err 6.344677967717871e-05 tr(WHW.T) 46129.50390625
bpp_loss 5.71686863899231
31_k proxy err 3.2216859835898504e-05 tr(WHW.T) 20445.06640625
bpp_loss 7.2198662757873535
31_o proxy err 0.00036048362380824983 tr(WHW.T) 2186.682373046875
bpp_loss 5.758180618286133
31_up proxy err 0.00016717513790354133 tr(WHW.T) 68909.6796875
bpp_loss 5.277129581996372
31_gate proxy err 8.565768075641245e-05 tr(WHW.T) 144279.1875
bpp_loss 5.618278230939593
31_down proxy err 0.00015521036402788013 tr(WHW.T) 9879.267578125
bpp_loss 5.774678434644427
I0324 06:09:42.580147 4013256 config.py:54] PyTorch version 2.6.0 available.
W0324 06:09:43.015437 4013256 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 06:09:43.264146 4013256 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  3.54it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:01,  4.70it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  5.08it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  5.47it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  5.70it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  5.64it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.86it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.44it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  5.31it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  6.12it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  5.83it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  5.72it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  5.67it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  5.63it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.64it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.68it/s]
I0324 06:09:47.603153 4013256 hfize_llama.py:153] loaded layer 0
I0324 06:09:48.473622 4013256 hfize_llama.py:153] loaded layer 1
I0324 06:09:49.064596 4013256 hfize_llama.py:153] loaded layer 2
I0324 06:09:49.644172 4013256 hfize_llama.py:153] loaded layer 3
I0324 06:09:50.232115 4013256 hfize_llama.py:153] loaded layer 4
I0324 06:09:50.793954 4013256 hfize_llama.py:153] loaded layer 5
I0324 06:09:51.582391 4013256 hfize_llama.py:153] loaded layer 6
I0324 06:09:52.698080 4013256 hfize_llama.py:153] loaded layer 7
I0324 06:09:53.568895 4013256 hfize_llama.py:153] loaded layer 8
I0324 06:09:54.455606 4013256 hfize_llama.py:153] loaded layer 9
I0324 06:09:55.342452 4013256 hfize_llama.py:153] loaded layer 10
I0324 06:09:56.125473 4013256 hfize_llama.py:153] loaded layer 11
I0324 06:09:56.854084 4013256 hfize_llama.py:153] loaded layer 12
I0324 06:09:57.576675 4013256 hfize_llama.py:153] loaded layer 13
I0324 06:09:58.340064 4013256 hfize_llama.py:153] loaded layer 14
I0324 06:09:59.093555 4013256 hfize_llama.py:153] loaded layer 15
I0324 06:09:59.799363 4013256 hfize_llama.py:153] loaded layer 16
I0324 06:10:00.494644 4013256 hfize_llama.py:153] loaded layer 17
I0324 06:10:01.217433 4013256 hfize_llama.py:153] loaded layer 18
I0324 06:10:01.901038 4013256 hfize_llama.py:153] loaded layer 19
I0324 06:10:02.536711 4013256 hfize_llama.py:153] loaded layer 20
I0324 06:10:03.178545 4013256 hfize_llama.py:153] loaded layer 21
I0324 06:10:03.879897 4013256 hfize_llama.py:153] loaded layer 22
I0324 06:10:04.581102 4013256 hfize_llama.py:153] loaded layer 23
I0324 06:10:05.232436 4013256 hfize_llama.py:153] loaded layer 24
I0324 06:10:05.920778 4013256 hfize_llama.py:153] loaded layer 25
I0324 06:10:06.573635 4013256 hfize_llama.py:153] loaded layer 26
I0324 06:10:07.227802 4013256 hfize_llama.py:153] loaded layer 27
I0324 06:10:07.864946 4013256 hfize_llama.py:153] loaded layer 28
I0324 06:10:08.491175 4013256 hfize_llama.py:153] loaded layer 29
I0324 06:10:09.197666 4013256 hfize_llama.py:153] loaded layer 30
I0324 06:10:09.815697 4013256 hfize_llama.py:153] loaded layer 31
I0324 06:10:09.815806 4013256 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:07,  1.22s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.08s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.01s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:01,  1.02it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:05<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.22it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.07it/s]
I0324 06:11:04.259380 4013256 hfize_llama.py:167] successfully loaded hfized model
W0324 06:11:08.476319 4014319 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 06:11:09.018843 4014319 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:06,  1.07s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.20s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.23s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.26s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:06<00:02,  1.25s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:07<00:01,  1.20s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.02s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.13s/it]
I0324 06:11:17.395761 4014319 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.5160783529281616:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.5160783529281616:   1%|          | 1/141 [00:01<04:18,  1.84s/it]avg_loss = 1.8408933281898499:   1%|          | 1/141 [00:03<04:18,  1.84s/it]avg_loss = 1.8408933281898499:   1%|▏         | 2/141 [00:03<03:43,  1.61s/it]avg_loss = 1.9802974462509155:   1%|▏         | 2/141 [00:04<03:43,  1.61s/it]avg_loss = 1.9802974462509155:   2%|▏         | 3/141 [00:04<03:32,  1.54s/it]avg_loss = 1.9377752542495728:   2%|▏         | 3/141 [00:06<03:32,  1.54s/it]avg_loss = 1.9377752542495728:   3%|▎         | 4/141 [00:06<03:26,  1.51s/it]avg_loss = 1.890444850921631:   3%|▎         | 4/141 [00:07<03:26,  1.51s/it] avg_loss = 1.890444850921631:   4%|▎         | 5/141 [00:07<03:22,  1.49s/it]avg_loss = 1.7943368554115295:   4%|▎         | 5/141 [00:09<03:22,  1.49s/it]avg_loss = 1.7943368554115295:   4%|▍         | 6/141 [00:09<03:20,  1.48s/it]avg_loss = 1.7287576028278895:   4%|▍         | 6/141 [00:10<03:20,  1.48s/it]avg_loss = 1.7287576028278895:   5%|▍         | 7/141 [00:10<03:18,  1.48s/it]avg_loss = 1.7264799624681473:   5%|▍         | 7/141 [00:12<03:18,  1.48s/it]avg_loss = 1.7264799624681473:   6%|▌         | 8/141 [00:12<03:16,  1.48s/it]avg_loss = 1.7615366114510431:   6%|▌         | 8/141 [00:13<03:16,  1.48s/it]avg_loss = 1.7615366114510431:   6%|▋         | 9/141 [00:13<03:15,  1.48s/it]avg_loss = 1.7674459218978882:   6%|▋         | 9/141 [00:15<03:15,  1.48s/it]avg_loss = 1.7674459218978882:   7%|▋         | 10/141 [00:15<03:14,  1.48s/it]avg_loss = 1.7644865079359575:   7%|▋         | 10/141 [00:16<03:14,  1.48s/it]avg_loss = 1.7644865079359575:   8%|▊         | 11/141 [00:16<03:12,  1.48s/it]avg_loss = 1.7877223094304402:   8%|▊         | 11/141 [00:18<03:12,  1.48s/it]avg_loss = 1.7877223094304402:   9%|▊         | 12/141 [00:18<03:11,  1.49s/it]avg_loss = 1.800833747937129:   9%|▊         | 12/141 [00:19<03:11,  1.49s/it] avg_loss = 1.800833747937129:   9%|▉         | 13/141 [00:19<03:10,  1.49s/it]avg_loss = 1.8197328448295593:   9%|▉         | 13/141 [00:21<03:10,  1.49s/it]avg_loss = 1.8197328448295593:  10%|▉         | 14/141 [00:21<03:09,  1.49s/it]avg_loss = 1.829786523183187:  10%|▉         | 14/141 [00:22<03:09,  1.49s/it] avg_loss = 1.829786523183187:  11%|█         | 15/141 [00:22<03:08,  1.49s/it]avg_loss = 1.8547570407390594:  11%|█         | 15/141 [00:24<03:08,  1.49s/it]avg_loss = 1.8547570407390594:  11%|█▏        | 16/141 [00:24<03:06,  1.50s/it]avg_loss = 1.8582454709445728:  11%|█▏        | 16/141 [00:25<03:06,  1.50s/it]avg_loss = 1.8582454709445728:  12%|█▏        | 17/141 [00:25<03:05,  1.50s/it]avg_loss = 1.8606726196077135:  12%|█▏        | 17/141 [00:27<03:05,  1.50s/it]avg_loss = 1.8606726196077135:  13%|█▎        | 18/141 [00:27<03:04,  1.50s/it]avg_loss = 1.8396643713900918:  13%|█▎        | 18/141 [00:28<03:04,  1.50s/it]avg_loss = 1.8396643713900918:  13%|█▎        | 19/141 [00:28<03:03,  1.50s/it]avg_loss = 1.8386079132556916:  13%|█▎        | 19/141 [00:30<03:03,  1.50s/it]avg_loss = 1.8386079132556916:  14%|█▍        | 20/141 [00:30<03:02,  1.51s/it]avg_loss = 1.8435687791733515:  14%|█▍        | 20/141 [00:31<03:02,  1.51s/it]avg_loss = 1.8435687791733515:  15%|█▍        | 21/141 [00:31<03:01,  1.51s/it]avg_loss = 1.84607717665759:  15%|█▍        | 21/141 [00:33<03:01,  1.51s/it]  avg_loss = 1.84607717665759:  16%|█▌        | 22/141 [00:33<03:00,  1.52s/it]avg_loss = 1.847708769466566:  16%|█▌        | 22/141 [00:34<03:00,  1.52s/it]avg_loss = 1.847708769466566:  16%|█▋        | 23/141 [00:34<02:59,  1.52s/it]avg_loss = 1.8527835210164387:  16%|█▋        | 23/141 [00:36<02:59,  1.52s/it]avg_loss = 1.8527835210164387:  17%|█▋        | 24/141 [00:36<02:57,  1.52s/it]avg_loss = 1.8588289737701416:  17%|█▋        | 24/141 [00:37<02:57,  1.52s/it]avg_loss = 1.8588289737701416:  18%|█▊        | 25/141 [00:37<02:56,  1.52s/it]avg_loss = 1.8706378111472497:  18%|█▊        | 25/141 [00:39<02:56,  1.52s/it]avg_loss = 1.8706378111472497:  18%|█▊        | 26/141 [00:39<02:55,  1.53s/it]avg_loss = 1.8837777332023338:  18%|█▊        | 26/141 [00:40<02:55,  1.53s/it]avg_loss = 1.8837777332023338:  19%|█▉        | 27/141 [00:40<02:54,  1.53s/it]avg_loss = 1.8907453843525477:  19%|█▉        | 27/141 [00:42<02:54,  1.53s/it]avg_loss = 1.8907453843525477:  20%|█▉        | 28/141 [00:42<02:52,  1.53s/it]avg_loss = 1.887535810470581:  20%|█▉        | 28/141 [00:43<02:52,  1.53s/it] avg_loss = 1.887535810470581:  21%|██        | 29/141 [00:43<02:51,  1.53s/it]avg_loss = 1.8778421799341838:  21%|██        | 29/141 [00:45<02:51,  1.53s/it]avg_loss = 1.8778421799341838:  21%|██▏       | 30/141 [00:45<02:50,  1.53s/it]avg_loss = 1.8632377539911578:  21%|██▏       | 30/141 [00:46<02:50,  1.53s/it]avg_loss = 1.8632377539911578:  22%|██▏       | 31/141 [00:46<02:48,  1.54s/it]avg_loss = 1.8510341309010983:  22%|██▏       | 31/141 [00:48<02:48,  1.54s/it]avg_loss = 1.8510341309010983:  23%|██▎       | 32/141 [00:48<02:47,  1.54s/it]avg_loss = 1.8499822183088823:  23%|██▎       | 32/141 [00:49<02:47,  1.54s/it]avg_loss = 1.8499822183088823:  23%|██▎       | 33/141 [00:49<02:46,  1.54s/it]avg_loss = 1.8486948959967668:  23%|██▎       | 33/141 [00:51<02:46,  1.54s/it]avg_loss = 1.8486948959967668:  24%|██▍       | 34/141 [00:51<02:45,  1.54s/it]avg_loss = 1.8516756534576415:  24%|██▍       | 34/141 [00:53<02:45,  1.54s/it]avg_loss = 1.8516756534576415:  25%|██▍       | 35/141 [00:53<02:43,  1.54s/it]avg_loss = 1.8353272709581587:  25%|██▍       | 35/141 [00:54<02:43,  1.54s/it]avg_loss = 1.8353272709581587:  26%|██▌       | 36/141 [00:54<02:42,  1.55s/it]avg_loss = 1.8199887146820892:  26%|██▌       | 36/141 [00:56<02:42,  1.55s/it]avg_loss = 1.8199887146820892:  26%|██▌       | 37/141 [00:56<02:40,  1.55s/it]avg_loss = 1.8052245503977726:  26%|██▌       | 37/141 [00:57<02:40,  1.55s/it]avg_loss = 1.8052245503977726:  27%|██▋       | 38/141 [00:57<02:39,  1.55s/it]avg_loss = 1.7911979601933405:  27%|██▋       | 38/141 [00:59<02:39,  1.55s/it]avg_loss = 1.7911979601933405:  28%|██▊       | 39/141 [00:59<02:38,  1.55s/it]avg_loss = 1.782940924167633:  28%|██▊       | 39/141 [01:00<02:38,  1.55s/it] avg_loss = 1.782940924167633:  28%|██▊       | 40/141 [01:00<02:36,  1.55s/it]avg_loss = 1.787666207406579:  28%|██▊       | 40/141 [01:02<02:36,  1.55s/it]avg_loss = 1.787666207406579:  29%|██▉       | 41/141 [01:02<02:35,  1.55s/it]avg_loss = 1.8050945003827412:  29%|██▉       | 41/141 [01:03<02:35,  1.55s/it]avg_loss = 1.8050945003827412:  30%|██▉       | 42/141 [01:03<02:34,  1.56s/it]avg_loss = 1.8216357203417046:  30%|██▉       | 42/141 [01:05<02:34,  1.56s/it]avg_loss = 1.8216357203417046:  30%|███       | 43/141 [01:05<02:32,  1.56s/it]avg_loss = 1.8242160813374952:  30%|███       | 43/141 [01:07<02:32,  1.56s/it]avg_loss = 1.8242160813374952:  31%|███       | 44/141 [01:07<02:31,  1.56s/it]avg_loss = 1.8285061756769816:  31%|███       | 44/141 [01:08<02:31,  1.56s/it]avg_loss = 1.8285061756769816:  32%|███▏      | 45/141 [01:08<02:29,  1.56s/it]avg_loss = 1.8342066925504934:  32%|███▏      | 45/141 [01:10<02:29,  1.56s/it]avg_loss = 1.8342066925504934:  33%|███▎      | 46/141 [01:10<02:28,  1.56s/it]avg_loss = 1.8409835607447522:  33%|███▎      | 46/141 [01:11<02:28,  1.56s/it]avg_loss = 1.8409835607447522:  33%|███▎      | 47/141 [01:11<02:26,  1.56s/it]avg_loss = 1.8444067512949307:  33%|███▎      | 47/141 [01:13<02:26,  1.56s/it]avg_loss = 1.8444067512949307:  34%|███▍      | 48/141 [01:13<02:25,  1.56s/it]avg_loss = 1.84302742383918:  34%|███▍      | 48/141 [01:14<02:25,  1.56s/it]  avg_loss = 1.84302742383918:  35%|███▍      | 49/141 [01:14<02:24,  1.57s/it]avg_loss = 1.842809600830078:  35%|███▍      | 49/141 [01:16<02:24,  1.57s/it]avg_loss = 1.842809600830078:  35%|███▌      | 50/141 [01:16<02:22,  1.57s/it]avg_loss = 1.83623688361224:  35%|███▌      | 50/141 [01:18<02:22,  1.57s/it] avg_loss = 1.83623688361224:  36%|███▌      | 51/141 [01:18<02:21,  1.57s/it]avg_loss = 1.8325828405526967:  36%|███▌      | 51/141 [01:19<02:21,  1.57s/it]avg_loss = 1.8325828405526967:  37%|███▋      | 52/141 [01:19<02:19,  1.57s/it]avg_loss = 1.8261843492399972:  37%|███▋      | 52/141 [01:21<02:19,  1.57s/it]avg_loss = 1.8261843492399972:  38%|███▊      | 53/141 [01:21<02:18,  1.57s/it]avg_loss = 1.8233621937257272:  38%|███▊      | 53/141 [01:22<02:18,  1.57s/it]avg_loss = 1.8233621937257272:  38%|███▊      | 54/141 [01:22<02:16,  1.57s/it]avg_loss = 1.8157708709890192:  38%|███▊      | 54/141 [01:24<02:16,  1.57s/it]avg_loss = 1.8157708709890192:  39%|███▉      | 55/141 [01:24<02:15,  1.57s/it]avg_loss = 1.808129444718361:  39%|███▉      | 55/141 [01:25<02:15,  1.57s/it] avg_loss = 1.808129444718361:  40%|███▉      | 56/141 [01:25<02:13,  1.57s/it]avg_loss = 1.8013541217435871:  40%|███▉      | 56/141 [01:27<02:13,  1.57s/it]avg_loss = 1.8013541217435871:  40%|████      | 57/141 [01:27<02:12,  1.57s/it]avg_loss = 1.7986699938774109:  40%|████      | 57/141 [01:29<02:12,  1.57s/it]avg_loss = 1.7986699938774109:  41%|████      | 58/141 [01:29<02:10,  1.57s/it]avg_loss = 1.8009788787971108:  41%|████      | 58/141 [01:30<02:10,  1.57s/it]avg_loss = 1.8009788787971108:  42%|████▏     | 59/141 [01:30<02:09,  1.58s/it]avg_loss = 1.8067915439605713:  42%|████▏     | 59/141 [01:32<02:09,  1.58s/it]avg_loss = 1.8067915439605713:  43%|████▎     | 60/141 [01:32<02:07,  1.58s/it]avg_loss = 1.8128906195280983:  43%|████▎     | 60/141 [01:33<02:07,  1.58s/it]avg_loss = 1.8128906195280983:  43%|████▎     | 61/141 [01:33<02:06,  1.58s/it]avg_loss = 1.8203364418398948:  43%|████▎     | 61/141 [01:35<02:06,  1.58s/it]avg_loss = 1.8203364418398948:  44%|████▍     | 62/141 [01:35<02:04,  1.58s/it]avg_loss = 1.8110358733979484:  44%|████▍     | 62/141 [01:36<02:04,  1.58s/it]avg_loss = 1.8110358733979484:  45%|████▍     | 63/141 [01:36<02:03,  1.58s/it]avg_loss = 1.8090205453336239:  45%|████▍     | 63/141 [01:38<02:03,  1.58s/it]avg_loss = 1.8090205453336239:  45%|████▌     | 64/141 [01:38<02:01,  1.58s/it]avg_loss = 1.8064469979359554:  45%|████▌     | 64/141 [01:40<02:01,  1.58s/it]avg_loss = 1.8064469979359554:  46%|████▌     | 65/141 [01:40<02:00,  1.58s/it]avg_loss = 1.800444301330682:  46%|████▌     | 65/141 [01:41<02:00,  1.58s/it] avg_loss = 1.800444301330682:  47%|████▋     | 66/141 [01:41<01:58,  1.58s/it]avg_loss = 1.7978583627672338:  47%|████▋     | 66/141 [01:43<01:58,  1.58s/it]avg_loss = 1.7978583627672338:  48%|████▊     | 67/141 [01:43<01:57,  1.58s/it]avg_loss = 1.7943718556095571:  48%|████▊     | 67/141 [01:44<01:57,  1.58s/it]avg_loss = 1.7943718556095571:  48%|████▊     | 68/141 [01:44<01:55,  1.58s/it]avg_loss = 1.7914379990619163:  48%|████▊     | 68/141 [01:46<01:55,  1.58s/it]avg_loss = 1.7914379990619163:  49%|████▉     | 69/141 [01:46<01:54,  1.58s/it]avg_loss = 1.792344343662262:  49%|████▉     | 69/141 [01:48<01:54,  1.58s/it] avg_loss = 1.792344343662262:  50%|████▉     | 70/141 [01:48<01:52,  1.58s/it]avg_loss = 1.7961811163056065:  50%|████▉     | 70/141 [01:49<01:52,  1.58s/it]avg_loss = 1.7961811163056065:  50%|█████     | 71/141 [01:49<01:50,  1.59s/it]avg_loss = 1.79858016802205:  50%|█████     | 71/141 [01:51<01:50,  1.59s/it]  avg_loss = 1.79858016802205:  51%|█████     | 72/141 [01:51<01:49,  1.59s/it]avg_loss = 1.7972568583815065:  51%|█████     | 72/141 [01:52<01:49,  1.59s/it]avg_loss = 1.7972568583815065:  52%|█████▏    | 73/141 [01:52<01:47,  1.59s/it]avg_loss = 1.7990511655807495:  52%|█████▏    | 73/141 [01:54<01:47,  1.59s/it]avg_loss = 1.7990511655807495:  52%|█████▏    | 74/141 [01:54<01:46,  1.59s/it]avg_loss = 1.799382036526998:  52%|█████▏    | 74/141 [01:55<01:46,  1.59s/it] avg_loss = 1.799382036526998:  53%|█████▎    | 75/141 [01:55<01:44,  1.59s/it]avg_loss = 1.7983732145083577:  53%|█████▎    | 75/141 [01:57<01:44,  1.59s/it]avg_loss = 1.7983732145083577:  54%|█████▍    | 76/141 [01:57<01:43,  1.59s/it]avg_loss = 1.7996513363602873:  54%|█████▍    | 76/141 [01:59<01:43,  1.59s/it]avg_loss = 1.7996513363602873:  55%|█████▍    | 77/141 [01:59<01:41,  1.59s/it]avg_loss = 1.8021616691198103:  55%|█████▍    | 77/141 [02:00<01:41,  1.59s/it]avg_loss = 1.8021616691198103:  55%|█████▌    | 78/141 [02:00<01:39,  1.59s/it]avg_loss = 1.8064824267278743:  55%|█████▌    | 78/141 [02:02<01:39,  1.59s/it]avg_loss = 1.8064824267278743:  56%|█████▌    | 79/141 [02:02<01:38,  1.59s/it]avg_loss = 1.8038161352276803:  56%|█████▌    | 79/141 [02:03<01:38,  1.59s/it]avg_loss = 1.8038161352276803:  57%|█████▋    | 80/141 [02:03<01:36,  1.59s/it]avg_loss = 1.8028493030571644:  57%|█████▋    | 80/141 [02:05<01:36,  1.59s/it]avg_loss = 1.8028493030571644:  57%|█████▋    | 81/141 [02:05<01:35,  1.59s/it]avg_loss = 1.8022462900091962:  57%|█████▋    | 81/141 [02:07<01:35,  1.59s/it]avg_loss = 1.8022462900091962:  58%|█████▊    | 82/141 [02:07<01:33,  1.59s/it]avg_loss = 1.800537935222488:  58%|█████▊    | 82/141 [02:08<01:33,  1.59s/it] avg_loss = 1.800537935222488:  59%|█████▉    | 83/141 [02:08<01:32,  1.59s/it]avg_loss = 1.7984718467508043:  59%|█████▉    | 83/141 [02:10<01:32,  1.59s/it]avg_loss = 1.7984718467508043:  60%|█████▉    | 84/141 [02:10<01:30,  1.59s/it]avg_loss = 1.7961812987047083:  60%|█████▉    | 84/141 [02:11<01:30,  1.59s/it]avg_loss = 1.7961812987047083:  60%|██████    | 85/141 [02:11<01:29,  1.59s/it]avg_loss = 1.7980023359143458:  60%|██████    | 85/141 [02:13<01:29,  1.59s/it]avg_loss = 1.7980023359143458:  61%|██████    | 86/141 [02:13<01:27,  1.59s/it]avg_loss = 1.8000157783771384:  61%|██████    | 86/141 [02:15<01:27,  1.59s/it]avg_loss = 1.8000157783771384:  62%|██████▏   | 87/141 [02:15<01:26,  1.60s/it]avg_loss = 1.800116553902626:  62%|██████▏   | 87/141 [02:16<01:26,  1.60s/it] avg_loss = 1.800116553902626:  62%|██████▏   | 88/141 [02:16<01:24,  1.60s/it]avg_loss = 1.8089417781722679:  62%|██████▏   | 88/141 [02:18<01:24,  1.60s/it]avg_loss = 1.8089417781722679:  63%|██████▎   | 89/141 [02:18<01:23,  1.60s/it]avg_loss = 1.8165349549717373:  63%|██████▎   | 89/141 [02:19<01:23,  1.60s/it]avg_loss = 1.8165349549717373:  64%|██████▍   | 90/141 [02:19<01:21,  1.60s/it]avg_loss = 1.8197391334470812:  64%|██████▍   | 90/141 [02:21<01:21,  1.60s/it]avg_loss = 1.8197391334470812:  65%|██████▍   | 91/141 [02:21<01:19,  1.60s/it]avg_loss = 1.824747180161269:  65%|██████▍   | 91/141 [02:23<01:19,  1.60s/it] avg_loss = 1.824747180161269:  65%|██████▌   | 92/141 [02:23<01:18,  1.60s/it]avg_loss = 1.8298118947654642:  65%|██████▌   | 92/141 [02:24<01:18,  1.60s/it]avg_loss = 1.8298118947654642:  66%|██████▌   | 93/141 [02:24<01:16,  1.60s/it]avg_loss = 1.830945148112926:  66%|██████▌   | 93/141 [02:26<01:16,  1.60s/it] avg_loss = 1.830945148112926:  67%|██████▋   | 94/141 [02:26<01:15,  1.60s/it]avg_loss = 1.8347841425945883:  67%|██████▋   | 94/141 [02:27<01:15,  1.60s/it]avg_loss = 1.8347841425945883:  67%|██████▋   | 95/141 [02:27<01:13,  1.60s/it]avg_loss = 1.8357246120770772:  67%|██████▋   | 95/141 [02:29<01:13,  1.60s/it]avg_loss = 1.8357246120770772:  68%|██████▊   | 96/141 [02:29<01:11,  1.60s/it]avg_loss = 1.8377153947181308:  68%|██████▊   | 96/141 [02:31<01:11,  1.60s/it]avg_loss = 1.8377153947181308:  69%|██████▉   | 97/141 [02:31<01:10,  1.60s/it]avg_loss = 1.832103431224823:  69%|██████▉   | 97/141 [02:32<01:10,  1.60s/it] avg_loss = 1.832103431224823:  70%|██████▉   | 98/141 [02:32<01:08,  1.60s/it]avg_loss = 1.832713366758944:  70%|██████▉   | 98/141 [02:34<01:08,  1.60s/it]avg_loss = 1.832713366758944:  70%|███████   | 99/141 [02:34<01:07,  1.60s/it]avg_loss = 1.834396630525589:  70%|███████   | 99/141 [02:35<01:07,  1.60s/it]avg_loss = 1.834396630525589:  71%|███████   | 100/141 [02:35<01:05,  1.60s/it]avg_loss = 1.8327755125442353:  71%|███████   | 100/141 [02:37<01:05,  1.60s/it]avg_loss = 1.8327755125442353:  72%|███████▏  | 101/141 [02:37<01:04,  1.60s/it]avg_loss = 1.8327288031578064:  72%|███████▏  | 101/141 [02:39<01:04,  1.60s/it]avg_loss = 1.8327288031578064:  72%|███████▏  | 102/141 [02:39<01:02,  1.60s/it]avg_loss = 1.8303229843528526:  72%|███████▏  | 102/141 [02:40<01:02,  1.60s/it]avg_loss = 1.8303229843528526:  73%|███████▎  | 103/141 [02:40<01:00,  1.60s/it]avg_loss = 1.8324877883379276:  73%|███████▎  | 103/141 [02:42<01:00,  1.60s/it]avg_loss = 1.8324877883379276:  74%|███████▍  | 104/141 [02:42<00:59,  1.60s/it]avg_loss = 1.83014729931241:  74%|███████▍  | 104/141 [02:43<00:59,  1.60s/it]  avg_loss = 1.83014729931241:  74%|███████▍  | 105/141 [02:43<00:57,  1.60s/it]avg_loss = 1.8286231610010255:  74%|███████▍  | 105/141 [02:45<00:57,  1.60s/it]avg_loss = 1.8286231610010255:  75%|███████▌  | 106/141 [02:45<00:56,  1.60s/it]avg_loss = 1.8261393932538612:  75%|███████▌  | 106/141 [02:47<00:56,  1.60s/it]avg_loss = 1.8261393932538612:  76%|███████▌  | 107/141 [02:47<00:54,  1.60s/it]avg_loss = 1.8236326199990731:  76%|███████▌  | 107/141 [02:48<00:54,  1.60s/it]avg_loss = 1.8236326199990731:  77%|███████▋  | 108/141 [02:48<00:52,  1.60s/it]avg_loss = 1.8208133758754905:  77%|███████▋  | 108/141 [02:50<00:52,  1.60s/it]avg_loss = 1.8208133758754905:  77%|███████▋  | 109/141 [02:50<00:51,  1.60s/it]avg_loss = 1.8183291337706826:  77%|███████▋  | 109/141 [02:51<00:51,  1.60s/it]avg_loss = 1.8183291337706826:  78%|███████▊  | 110/141 [02:51<00:49,  1.60s/it]avg_loss = 1.820719230282414:  78%|███████▊  | 110/141 [02:53<00:49,  1.60s/it] avg_loss = 1.820719230282414:  79%|███████▊  | 111/141 [02:53<00:48,  1.60s/it]avg_loss = 1.8205129514847482:  79%|███████▊  | 111/141 [02:55<00:48,  1.60s/it]avg_loss = 1.8205129514847482:  79%|███████▉  | 112/141 [02:55<00:46,  1.60s/it]avg_loss = 1.8217223365749933:  79%|███████▉  | 112/141 [02:56<00:46,  1.60s/it]avg_loss = 1.8217223365749933:  80%|████████  | 113/141 [02:56<00:44,  1.60s/it]avg_loss = 1.8227278119639347:  80%|████████  | 113/141 [02:58<00:44,  1.60s/it]avg_loss = 1.8227278119639347:  81%|████████  | 114/141 [02:58<00:43,  1.60s/it]avg_loss = 1.8221603663071342:  81%|████████  | 114/141 [02:59<00:43,  1.60s/it]avg_loss = 1.8221603663071342:  82%|████████▏ | 115/141 [02:59<00:41,  1.60s/it]avg_loss = 1.8206590465430557:  82%|████████▏ | 115/141 [03:01<00:41,  1.60s/it]avg_loss = 1.8206590465430557:  82%|████████▏ | 116/141 [03:01<00:40,  1.60s/it]avg_loss = 1.8227882191666172:  82%|████████▏ | 116/141 [03:03<00:40,  1.60s/it]avg_loss = 1.8227882191666172:  83%|████████▎ | 117/141 [03:03<00:38,  1.61s/it]avg_loss = 1.8225578706143266:  83%|████████▎ | 117/141 [03:04<00:38,  1.61s/it]avg_loss = 1.8225578706143266:  84%|████████▎ | 118/141 [03:04<00:36,  1.60s/it]avg_loss = 1.821274723325457:  84%|████████▎ | 118/141 [03:06<00:36,  1.60s/it] avg_loss = 1.821274723325457:  84%|████████▍ | 119/141 [03:06<00:35,  1.60s/it]avg_loss = 1.8196174691120783:  84%|████████▍ | 119/141 [03:07<00:35,  1.60s/it]avg_loss = 1.8196174691120783:  85%|████████▌ | 120/141 [03:07<00:33,  1.60s/it]avg_loss = 1.8194465538686957:  85%|████████▌ | 120/141 [03:09<00:33,  1.60s/it]avg_loss = 1.8194465538686957:  86%|████████▌ | 121/141 [03:09<00:32,  1.60s/it]avg_loss = 1.8197958332593325:  86%|████████▌ | 121/141 [03:11<00:32,  1.60s/it]avg_loss = 1.8197958332593325:  87%|████████▋ | 122/141 [03:11<00:30,  1.60s/it]avg_loss = 1.819710719876173:  87%|████████▋ | 122/141 [03:12<00:30,  1.60s/it] avg_loss = 1.819710719876173:  87%|████████▋ | 123/141 [03:12<00:28,  1.60s/it]avg_loss = 1.8200093969222038:  87%|████████▋ | 123/141 [03:14<00:28,  1.60s/it]avg_loss = 1.8200093969222038:  88%|████████▊ | 124/141 [03:14<00:27,  1.60s/it]avg_loss = 1.8188779335021972:  88%|████████▊ | 124/141 [03:15<00:27,  1.60s/it]avg_loss = 1.8188779335021972:  89%|████████▊ | 125/141 [03:15<00:25,  1.61s/it]avg_loss = 1.8193435176970467:  89%|████████▊ | 125/141 [03:17<00:25,  1.61s/it]avg_loss = 1.8193435176970467:  89%|████████▉ | 126/141 [03:17<00:24,  1.61s/it]avg_loss = 1.8191525645143405:  89%|████████▉ | 126/141 [03:19<00:24,  1.61s/it]avg_loss = 1.8191525645143405:  90%|█████████ | 127/141 [03:19<00:22,  1.61s/it]avg_loss = 1.8177848318591714:  90%|█████████ | 127/141 [03:20<00:22,  1.61s/it]avg_loss = 1.8177848318591714:  91%|█████████ | 128/141 [03:20<00:20,  1.61s/it]avg_loss = 1.8180864633515823:  91%|█████████ | 128/141 [03:22<00:20,  1.61s/it]avg_loss = 1.8180864633515823:  91%|█████████▏| 129/141 [03:22<00:19,  1.61s/it]avg_loss = 1.8187723049750695:  91%|█████████▏| 129/141 [03:23<00:19,  1.61s/it]avg_loss = 1.8187723049750695:  92%|█████████▏| 130/141 [03:23<00:17,  1.60s/it]avg_loss = 1.8197526231066872:  92%|█████████▏| 130/141 [03:25<00:17,  1.60s/it]avg_loss = 1.8197526231066872:  93%|█████████▎| 131/141 [03:25<00:16,  1.60s/it]avg_loss = 1.8204506825317035:  93%|█████████▎| 131/141 [03:27<00:16,  1.60s/it]avg_loss = 1.8204506825317035:  94%|█████████▎| 132/141 [03:27<00:14,  1.60s/it]avg_loss = 1.8177095929482825:  94%|█████████▎| 132/141 [03:28<00:14,  1.60s/it]avg_loss = 1.8177095929482825:  94%|█████████▍| 133/141 [03:28<00:12,  1.60s/it]avg_loss = 1.8134465867014073:  94%|█████████▍| 133/141 [03:30<00:12,  1.60s/it]avg_loss = 1.8134465867014073:  95%|█████████▌| 134/141 [03:30<00:11,  1.60s/it]avg_loss = 1.8160456030457108:  95%|█████████▌| 134/141 [03:31<00:11,  1.60s/it]avg_loss = 1.8160456030457108:  96%|█████████▌| 135/141 [03:31<00:09,  1.60s/it]avg_loss = 1.8195581357268726:  96%|█████████▌| 135/141 [03:33<00:09,  1.60s/it]avg_loss = 1.8195581357268726:  96%|█████████▋| 136/141 [03:33<00:08,  1.60s/it]avg_loss = 1.8203971412060034:  96%|█████████▋| 136/141 [03:35<00:08,  1.60s/it]avg_loss = 1.8203971412060034:  97%|█████████▋| 137/141 [03:35<00:06,  1.60s/it]avg_loss = 1.8190309439880261:  97%|█████████▋| 137/141 [03:36<00:06,  1.60s/it]avg_loss = 1.8190309439880261:  98%|█████████▊| 138/141 [03:36<00:04,  1.60s/it]avg_loss = 1.819170509310935:  98%|█████████▊| 138/141 [03:38<00:04,  1.60s/it] avg_loss = 1.819170509310935:  99%|█████████▊| 139/141 [03:38<00:03,  1.60s/it]avg_loss = 1.8196900299617222:  99%|█████████▊| 139/141 [03:40<00:03,  1.60s/it]avg_loss = 1.8196900299617222:  99%|█████████▉| 140/141 [03:40<00:01,  1.61s/it]avg_loss = 1.8209794210203996:  99%|█████████▉| 140/141 [03:41<00:01,  1.61s/it]avg_loss = 1.8209794210203996: 100%|██████████| 141/141 [03:41<00:00,  1.61s/it]avg_loss = 1.8209794210203996: 100%|██████████| 141/141 [03:41<00:00,  1.57s/it]
I0324 06:15:28.516427 4014319 eval_ppl.py:107] wikitext2 perplexity: 6.177906513214111
wikitext2 perplexity: 6.178
