I0324 05:37:47.283555 3990028 config.py:54] PyTorch version 2.6.0 available.
W0324 05:37:47.566702 3990028 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:37:48.448662 3990028 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.06it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.76it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.01it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.15it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.24it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.30it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.90it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.97it/s]
I0324 05:37:49.898905 3990028 quantize_finetune_llama.py:150] loaded model
I0324 05:37:50.192373 3990028 quantize_finetune_llama.py:185] loaded compression model
I0324 05:38:07.755286 3990028 quantize_finetune_llama.py:189] loaded dataset and devset
I0324 05:38:13.355283 3990028 quantize_finetune_llama.py:209] layer 0 gpu 0
I0324 05:38:16.145896 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 2.6452324390411377s
Use train scale and shift
tensor(-1.5053e-07, device='cuda:0') tensor(0.0156, device='cuda:0')
tensor(0.0156, device='cuda:0') tensor(-1.5053e-07, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0324 05:38:30.068977 3990590 config.py:54] PyTorch version 2.6.0 available.
W0324 05:38:30.349676 3990590 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:38:31.230644 3990590 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:38:31.234701 3990028 quantize_finetune_llama.py:209] layer 1 gpu 1
I0324 05:38:31.385534 3990590 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:38:34.936976 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 3.5419869422912598s
I0324 05:38:38.474117 3990737 config.py:54] PyTorch version 2.6.0 available.
W0324 05:38:38.769444 3990737 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:38:39.669333 3990737 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:38:39.674005 3990028 quantize_finetune_llama.py:209] layer 2 gpu 2
I0324 05:38:39.989778 3990737 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:38:42.416305 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 2.600126266479492s
I0324 05:38:46.078067 3990886 config.py:54] PyTorch version 2.6.0 available.
W0324 05:38:46.418778 3990886 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:38:47.410404 3990886 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:38:47.414649 3990028 quantize_finetune_llama.py:209] layer 3 gpu 3
I0324 05:38:47.677353 3990886 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:38:50.369523 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 2.791358470916748s
I0324 05:38:54.293168 3991017 config.py:54] PyTorch version 2.6.0 available.
W0324 05:38:54.640301 3991017 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:38:55.662914 3991017 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:38:55.667371 3990028 quantize_finetune_llama.py:209] layer 4 gpu 0
I0324 05:38:55.862756 3991017 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.004069801419973373 tr(WHW.T) 59.109249114990234
bpp_loss 5.1888587474823
0_q proxy err 9.391830099048093e-05 tr(WHW.T) 288041.78125
bpp_loss 4.224532127380371
0_k proxy err 5.869385495316237e-05 tr(WHW.T) 100152.8671875
bpp_loss 5.477234363555908
0_o proxy err 0.0015558558516204357 tr(WHW.T) 3113.9609375
bpp_loss 3.861151099205017
0_up proxy err 0.009666241705417633 tr(WHW.T) 8859.7275390625
bpp_loss 3.439789363316127
0_gate proxy err 0.005838422104716301 tr(WHW.T) 15700.0
bpp_loss 3.508779389517648
0_down proxy err 0.004229885060340166 tr(WHW.T) 10753.7939453125
bpp_loss 3.8318046842302596
1_v proxy err 0.005002366844564676 tr(WHW.T) 106.54676055908203
bpp_loss 5.173499822616577
1_q proxy err 0.00010487015242688358 tr(WHW.T) 144769.71875
bpp_loss 4.40443754196167
1_k proxy err 5.036631409893744e-05 tr(WHW.T) 75510.046875
bpp_loss 5.723575115203857
1_o proxy err 0.003821547608822584 tr(WHW.T) 1971.8739013671875
bpp_loss 3.847061276435852
1_up proxy err 0.010563836432993412 tr(WHW.T) 8164.14208984375
bpp_loss 3.4498510360717773
1_gate proxy err 0.006577064748853445 tr(WHW.T) 13871.78125
bpp_loss 3.5205433709280833
1_down proxy err 0.0001282975572394207 tr(WHW.T) 13911.810546875
bpp_loss 3.9282472814832414
I0324 05:39:49.883212 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 0.9565396308898926s
I0324 05:39:53.748054 3991653 config.py:54] PyTorch version 2.6.0 available.
W0324 05:39:54.096382 3991653 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:39:55.081231 3991653 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:39:55.085489 3990028 quantize_finetune_llama.py:209] layer 5 gpu 1
I0324 05:39:55.259154 3991653 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.0028058690950274467 tr(WHW.T) 154.1771240234375
bpp_loss 5.165930986404419
2_q proxy err 0.00039601195021532476 tr(WHW.T) 41423.8046875
bpp_loss 4.277915954589844
2_k proxy err 0.00020460638916119933 tr(WHW.T) 22584.275390625
bpp_loss 5.578881502151489
2_o proxy err 0.0037189237773418427 tr(WHW.T) 1957.195556640625
bpp_loss 3.8215643167495728
2_up proxy err 0.011779006570577621 tr(WHW.T) 7534.43212890625
bpp_loss 3.439238820757185
2_gate proxy err 0.006297970190644264 tr(WHW.T) 15028.0859375
bpp_loss 3.539053508213588
2_down proxy err 0.0061739347875118256 tr(WHW.T) 7660.255859375
bpp_loss 3.828300850731986
I0324 05:39:58.097020 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 0.8814857006072998s
I0324 05:40:01.857312 3991783 config.py:54] PyTorch version 2.6.0 available.
W0324 05:40:02.195038 3991783 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:40:03.180060 3991783 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:40:03.184374 3990028 quantize_finetune_llama.py:209] layer 6 gpu 2
I0324 05:40:03.404199 3991783 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.0021355825010687113 tr(WHW.T) 286.8193664550781
bpp_loss 5.167280912399292
3_q proxy err 0.0004988485015928745 tr(WHW.T) 47525.1171875
bpp_loss 4.168006181716919
3_k proxy err 0.00025173244648613036 tr(WHW.T) 26144.298828125
bpp_loss 5.332086563110352
3_o proxy err 0.005132212303578854 tr(WHW.T) 1843.92529296875
bpp_loss 3.824290156364441
3_up proxy err 0.011686258018016815 tr(WHW.T) 7472.86376953125
bpp_loss 3.428175381251744
3_gate proxy err 0.004635422956198454 tr(WHW.T) 20788.29296875
bpp_loss 3.5965963091169084
3_down proxy err 0.006606794893741608 tr(WHW.T) 6935.24755859375
bpp_loss 3.8227939946310863
I0324 05:40:06.567672 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.8628051280975342s
I0324 05:40:10.317416 3991930 config.py:54] PyTorch version 2.6.0 available.
W0324 05:40:10.636522 3991930 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:40:11.609573 3991930 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:40:11.613805 3990028 quantize_finetune_llama.py:209] layer 7 gpu 3
I0324 05:40:11.780899 3991930 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:40:13.015834 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 0.9159295558929443s
I0324 05:40:16.955872 3992052 config.py:54] PyTorch version 2.6.0 available.
W0324 05:40:17.312385 3992052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:40:18.446078 3992052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:40:18.450788 3990028 quantize_finetune_llama.py:209] layer 8 gpu 0
I0324 05:40:18.635825 3992052 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.002514587016776204 tr(WHW.T) 282.38128662109375
bpp_loss 5.166378021240234
4_q proxy err 0.000418464100221172 tr(WHW.T) 50064.37109375
bpp_loss 4.19906210899353
4_k proxy err 0.00019822570902761072 tr(WHW.T) 29272.75390625
bpp_loss 5.404958248138428
4_o proxy err 0.007002522237598896 tr(WHW.T) 1283.4017333984375
bpp_loss 3.8443325757980347
4_up proxy err 0.011537661775946617 tr(WHW.T) 7323.07763671875
bpp_loss 3.416100093296596
4_gate proxy err 0.003350465325638652 tr(WHW.T) 29023.8984375
bpp_loss 3.655259132385254
4_down proxy err 0.0069060539826750755 tr(WHW.T) 6335.5126953125
bpp_loss 3.82088235446385
5_v proxy err 0.00235975394025445 tr(WHW.T) 206.8122100830078
bpp_loss 5.165479898452759
5_q proxy err 0.0005510987830348313 tr(WHW.T) 35941.703125
bpp_loss 4.199745416641235
5_k proxy err 0.00024804414715617895 tr(WHW.T) 22968.27734375
bpp_loss 5.418022155761719
5_o proxy err 0.007508615497499704 tr(WHW.T) 1043.734619140625
bpp_loss 3.837161064147949
5_up proxy err 0.011086412705481052 tr(WHW.T) 7595.3154296875
bpp_loss 3.421245574951172
5_gate proxy err 0.003178287297487259 tr(WHW.T) 30279.96875
bpp_loss 3.6570028577532088
5_down proxy err 0.006988115143030882 tr(WHW.T) 6350.38623046875
bpp_loss 3.819504056658064
I0324 05:41:13.471024 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.1146044731140137s
I0324 05:41:17.281404 3992692 config.py:54] PyTorch version 2.6.0 available.
W0324 05:41:17.631268 3992692 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:41:18.657216 3992692 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:41:18.661535 3990028 quantize_finetune_llama.py:209] layer 9 gpu 1
I0324 05:41:18.830883 3992692 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.002306062262505293 tr(WHW.T) 251.2519073486328
bpp_loss 5.166489839553833
6_q proxy err 0.0006032802630215883 tr(WHW.T) 35587.6171875
bpp_loss 4.198613405227661
6_k proxy err 0.00023693573893979192 tr(WHW.T) 26134.267578125
bpp_loss 5.35850715637207
6_o proxy err 0.009037671610713005 tr(WHW.T) 996.2373657226562
bpp_loss 3.8280811309814453
6_up proxy err 0.010496103204786777 tr(WHW.T) 7862.4482421875
bpp_loss 3.4257921491350447
6_gate proxy err 0.0026623057201504707 tr(WHW.T) 35640.2578125
bpp_loss 3.6669628960745677
6_down proxy err 0.006879979278892279 tr(WHW.T) 6422.8779296875
bpp_loss 3.8201121943337575
I0324 05:41:22.663547 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 0.833888053894043s
I0324 05:41:26.387948 3992836 config.py:54] PyTorch version 2.6.0 available.
W0324 05:41:26.697667 3992836 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.0018559441668912768 tr(WHW.T) 307.0851135253906
bpp_loss 5.164915084838867
7_q proxy err 0.000626943598035723 tr(WHW.T) 35097.21875
bpp_loss 4.132127046585083
7_k proxy err 0.0002433615445625037 tr(WHW.T) 26820.58203125
bpp_loss 5.333976745605469
7_o proxy err 0.009829713962972164 tr(WHW.T) 945.8643798828125
bpp_loss 3.829019069671631
7_up proxy err 0.009546770714223385 tr(WHW.T) 8564.646484375
bpp_loss 3.438347816467285
7_gate proxy err 0.0026614998932927847 tr(WHW.T) 34799.35546875
bpp_loss 3.6510084697178433
7_down proxy err 0.007008611224591732 tr(WHW.T) 6472.18505859375
bpp_loss 3.821073293685913
W0324 05:41:27.623215 3992836 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:41:27.626899 3990028 quantize_finetune_llama.py:209] layer 10 gpu 2
I0324 05:41:27.784546 3992836 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:41:28.996376 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.8063638210296631s
I0324 05:41:32.567671 3992964 config.py:54] PyTorch version 2.6.0 available.
W0324 05:41:32.884574 3992964 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:41:33.890613 3992964 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:41:33.894778 3990028 quantize_finetune_llama.py:209] layer 11 gpu 3
I0324 05:41:34.169332 3992964 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:41:35.315366 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 0.9000508785247803s
I0324 05:41:39.090073 3993099 config.py:54] PyTorch version 2.6.0 available.
W0324 05:41:39.450535 3993099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:41:40.522586 3993099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:41:40.527132 3990028 quantize_finetune_llama.py:209] layer 12 gpu 0
I0324 05:41:40.711345 3993099 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.0024648706894367933 tr(WHW.T) 255.12034606933594
bpp_loss 5.165398120880127
8_q proxy err 0.0007898222538642585 tr(WHW.T) 26552.91015625
bpp_loss 4.147730827331543
8_k proxy err 0.00027941318694502115 tr(WHW.T) 22499.31640625
bpp_loss 5.332612752914429
8_o proxy err 0.013204178772866726 tr(WHW.T) 731.734619140625
bpp_loss 3.8284412622451782
8_up proxy err 0.009630962274968624 tr(WHW.T) 8432.8056640625
bpp_loss 3.436312811715262
8_gate proxy err 0.002481690142303705 tr(WHW.T) 37132.96875
bpp_loss 3.6573453630719865
8_down proxy err 0.0070212907157838345 tr(WHW.T) 6426.78076171875
bpp_loss 3.8204192093440463
9_v proxy err 0.002437298884615302 tr(WHW.T) 347.93878173828125
bpp_loss 5.166302919387817
9_q proxy err 0.0008296884479932487 tr(WHW.T) 25605.146484375
bpp_loss 4.1406402587890625
9_k proxy err 0.0003081890754401684 tr(WHW.T) 20913.2890625
bpp_loss 5.313564300537109
9_o proxy err 0.013240249827504158 tr(WHW.T) 760.7015380859375
bpp_loss 3.8526638746261597
9_up proxy err 0.009190726093947887 tr(WHW.T) 8907.26953125
bpp_loss 3.4416732788085938
9_gate proxy err 0.0023682834580540657 tr(WHW.T) 39307.90625
bpp_loss 3.66961669921875
9_down proxy err 0.007332885637879372 tr(WHW.T) 6210.4736328125
bpp_loss 3.819809607097081
I0324 05:42:37.472590 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 0.9320082664489746s
I0324 05:42:41.233200 3993743 config.py:54] PyTorch version 2.6.0 available.
W0324 05:42:41.560110 3993743 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.0024548848159611225 tr(WHW.T) 249.3217315673828
bpp_loss 5.1648595333099365
10_q proxy err 0.0008518894319422543 tr(WHW.T) 23288.234375
bpp_loss 4.190062046051025
10_k proxy err 0.0003060087619815022 tr(WHW.T) 19713.98828125
bpp_loss 5.387660980224609
10_o proxy err 0.013350521214306355 tr(WHW.T) 667.1098022460938
bpp_loss 3.8404529094696045
10_up proxy err 0.009061455726623535 tr(WHW.T) 9133.763671875
bpp_loss 3.451531546456473
10_gate proxy err 0.0024830326437950134 tr(WHW.T) 37296.734375
bpp_loss 3.6432533264160156
10_down proxy err 0.007249908056110144 tr(WHW.T) 6460.98828125
bpp_loss 3.8196372304643904
W0324 05:42:42.541298 3993743 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:42:42.545477 3990028 quantize_finetune_llama.py:209] layer 13 gpu 1
I0324 05:42:42.730344 3993743 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:42:44.080335 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 0.8826258182525635s
I0324 05:42:47.949518 3993856 config.py:54] PyTorch version 2.6.0 available.
W0324 05:42:48.268620 3993856 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.0018884068122133613 tr(WHW.T) 317.10748291015625
bpp_loss 5.166376352310181
11_q proxy err 0.0009219544008374214 tr(WHW.T) 22146.080078125
bpp_loss 4.106121301651001
11_k proxy err 0.0003491828392725438 tr(WHW.T) 17998.236328125
bpp_loss 5.321707725524902
11_o proxy err 0.016032658517360687 tr(WHW.T) 551.7962036132812
bpp_loss 3.851925849914551
11_up proxy err 0.008899475447833538 tr(WHW.T) 9126.3212890625
bpp_loss 3.4608351843697682
11_gate proxy err 0.0024689827114343643 tr(WHW.T) 36783.98828125
bpp_loss 3.633781841823033
11_down proxy err 0.00720953056588769 tr(WHW.T) 6590.6376953125
bpp_loss 3.8204032012394498
W0324 05:42:49.214497 3993856 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:42:49.218216 3990028 quantize_finetune_llama.py:209] layer 14 gpu 2
I0324 05:42:49.392751 3993856 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:42:50.810183 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 1.0078864097595215s
I0324 05:42:54.864712 3993978 config.py:54] PyTorch version 2.6.0 available.
W0324 05:42:55.181197 3993978 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:42:56.153209 3993978 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:42:56.157164 3990028 quantize_finetune_llama.py:209] layer 15 gpu 3
I0324 05:42:56.361950 3993978 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:42:57.479349 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.8821272850036621s
I0324 05:43:01.347975 3994111 config.py:54] PyTorch version 2.6.0 available.
W0324 05:43:01.693872 3994111 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:43:02.787133 3994111 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:43:02.791342 3990028 quantize_finetune_llama.py:209] layer 16 gpu 0
I0324 05:43:02.965860 3994111 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.0023160974960774183 tr(WHW.T) 360.1876220703125
bpp_loss 5.165605783462524
12_q proxy err 0.0006561680929735303 tr(WHW.T) 34056.6171875
bpp_loss 4.098986387252808
12_k proxy err 0.0002840939268935472 tr(WHW.T) 23029.2578125
bpp_loss 5.253956317901611
12_o proxy err 0.014214511960744858 tr(WHW.T) 763.9736938476562
bpp_loss 3.8332769870758057
12_up proxy err 0.007967539131641388 tr(WHW.T) 9958.251953125
bpp_loss 3.4812427248273576
12_gate proxy err 0.0023886309936642647 tr(WHW.T) 37236.3125
bpp_loss 3.625635419573103
12_down proxy err 0.007173436693847179 tr(WHW.T) 6755.458984375
bpp_loss 3.823561804635184
13_v proxy err 0.0025652532931417227 tr(WHW.T) 277.2203063964844
bpp_loss 5.166296005249023
13_q proxy err 0.000977079151198268 tr(WHW.T) 20850.333984375
bpp_loss 4.138739347457886
13_k proxy err 0.0003617030452005565 tr(WHW.T) 17769.017578125
bpp_loss 5.326740980148315
13_o proxy err 0.014777462929487228 tr(WHW.T) 660.1426391601562
bpp_loss 3.846057653427124
13_up proxy err 0.007974375039339066 tr(WHW.T) 9940.990234375
bpp_loss 3.4837756838117326
13_gate proxy err 0.002313609467819333 tr(WHW.T) 38823.03515625
bpp_loss 3.6263298307146346
13_down proxy err 0.007479550316929817 tr(WHW.T) 6493.29833984375
bpp_loss 3.8227906908307756
I0324 05:44:00.525279 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 0.8230667114257812s
I0324 05:44:04.394475 3994747 config.py:54] PyTorch version 2.6.0 available.
W0324 05:44:04.748084 3994747 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:44:05.801743 3994747 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:44:05.805915 3990028 quantize_finetune_llama.py:209] layer 17 gpu 1
14_v proxy err 0.002513162326067686 tr(WHW.T) 278.4633483886719
bpp_loss 5.165775537490845
14_q proxy err 0.0009163959184661508 tr(WHW.T) 20836.7890625
bpp_loss 4.134114503860474
14_k proxy err 0.0003288215375505388 tr(WHW.T) 18589.970703125
bpp_loss 5.358396053314209
14_o proxy err 0.015112516470253468 tr(WHW.T) 671.372314453125
bpp_loss 3.8353207111358643
14_up proxy err 0.008515925146639347 tr(WHW.T) 9095.5224609375
bpp_loss 3.4849869864327565
14_gate proxy err 0.002187000587582588 tr(WHW.T) 41682.6328125
bpp_loss 3.650027411324637
14_down proxy err 0.007560581900179386 tr(WHW.T) 6324.00830078125
bpp_loss 3.8262080465044295
I0324 05:44:05.978279 3994747 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:44:07.947513 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.8620076179504395s
I0324 05:44:11.778800 3994867 config.py:54] PyTorch version 2.6.0 available.
15_v proxy err 0.0029496143106371164 tr(WHW.T) 280.61700439453125
bpp_loss 5.1664652824401855
15_q proxy err 0.0007902609650045633 tr(WHW.T) 28024.23046875
bpp_loss 4.223370552062988
15_k proxy err 0.00033944216556847095 tr(WHW.T) 18843.171875
bpp_loss 5.28521466255188
15_o proxy err 0.012332950718700886 tr(WHW.T) 811.894287109375
bpp_loss 3.8568257093429565
15_up proxy err 0.008782673627138138 tr(WHW.T) 8926.90625
bpp_loss 3.4761480603899275
15_gate proxy err 0.0020240063313394785 tr(WHW.T) 46109.49609375
bpp_loss 3.6736373901367188
15_down proxy err 0.007519095204770565 tr(WHW.T) 6333.17138671875
bpp_loss 3.8240605422428677
W0324 05:44:12.107986 3994867 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:44:13.007917 3994867 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:44:13.011658 3990028 quantize_finetune_llama.py:209] layer 18 gpu 2
I0324 05:44:13.192763 3994867 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:44:14.188088 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.7377884387969971s
I0324 05:44:17.857183 3994999 config.py:54] PyTorch version 2.6.0 available.
W0324 05:44:18.195101 3994999 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:44:19.146007 3994999 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:44:19.149936 3990028 quantize_finetune_llama.py:209] layer 19 gpu 3
I0324 05:44:19.412768 3994999 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:44:20.438367 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 19 in 0.864691972732544s
I0324 05:44:24.306342 3995122 config.py:54] PyTorch version 2.6.0 available.
W0324 05:44:24.668794 3995122 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:44:25.761915 3995122 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:44:25.766186 3990028 quantize_finetune_llama.py:209] layer 20 gpu 0
I0324 05:44:25.992852 3995122 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.002685582498088479 tr(WHW.T) 271.2865905761719
bpp_loss 5.166524648666382
16_q proxy err 0.0007954089669510722 tr(WHW.T) 24435.3515625
bpp_loss 4.216705560684204
16_k proxy err 0.0003021600132342428 tr(WHW.T) 19477.44140625
bpp_loss 5.37466287612915
16_o proxy err 0.010689359158277512 tr(WHW.T) 953.8026733398438
bpp_loss 3.8404128551483154
16_up proxy err 0.009816897101700306 tr(WHW.T) 8265.3720703125
bpp_loss 3.458094460623605
16_gate proxy err 0.002330578165128827 tr(WHW.T) 41062.52734375
bpp_loss 3.694119453430176
16_down proxy err 0.007497618440538645 tr(WHW.T) 6223.8134765625
bpp_loss 3.8221166474478587
17_v proxy err 0.003135587088763714 tr(WHW.T) 280.3503723144531
bpp_loss 5.166393280029297
17_q proxy err 0.000778135668952018 tr(WHW.T) 27519.18359375
bpp_loss 4.198012828826904
17_k proxy err 0.0003691007732413709 tr(WHW.T) 17400.5703125
bpp_loss 5.306159973144531
17_o proxy err 0.009418859146535397 tr(WHW.T) 1090.2861328125
bpp_loss 3.857935905456543
17_up proxy err 0.009818539954721928 tr(WHW.T) 8387.2646484375
bpp_loss 3.4517368589128767
17_gate proxy err 0.0023364732041954994 tr(WHW.T) 41601.640625
bpp_loss 3.703087942940848
17_down proxy err 0.007616744376718998 tr(WHW.T) 6148.05908203125
bpp_loss 3.8202190739767894
I0324 05:45:27.324286 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 20 in 1.0965709686279297s
18_v proxy err 0.0025209831073880196 tr(WHW.T) 284.6707763671875
bpp_loss 5.1661598682403564
18_q proxy err 0.000953959533944726 tr(WHW.T) 22348.99609375
bpp_loss 4.172691822052002
18_k proxy err 0.0003846102918032557 tr(WHW.T) 17364.087890625
bpp_loss 5.316924095153809
18_o proxy err 0.008452413603663445 tr(WHW.T) 1187.6383056640625
bpp_loss 3.8485682010650635
18_up proxy err 0.010707029141485691 tr(WHW.T) 7918.30078125
bpp_loss 3.440953254699707
18_gate proxy err 0.0028008196968585253 tr(WHW.T) 35127.12890625
bpp_loss 3.7021338599068776
18_down proxy err 0.007565973326563835 tr(WHW.T) 6162.73876953125
bpp_loss 3.819484233856201
I0324 05:45:31.155638 3995822 config.py:54] PyTorch version 2.6.0 available.
W0324 05:45:31.491882 3995822 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:45:32.526036 3995822 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:45:32.530362 3990028 quantize_finetune_llama.py:209] layer 21 gpu 1
I0324 05:45:32.729120 3995822 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:45:33.864733 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 21 in 0.8766875267028809s
I0324 05:45:37.708855 3995953 config.py:54] PyTorch version 2.6.0 available.
19_v proxy err 0.0023724727798253298 tr(WHW.T) 337.7576599121094
bpp_loss 5.166769504547119
19_q proxy err 0.000914520351216197 tr(WHW.T) 23987.353515625
bpp_loss 4.16462779045105
19_k proxy err 0.00041860155761241913 tr(WHW.T) 15524.9208984375
bpp_loss 5.259798049926758
19_o proxy err 0.009125564247369766 tr(WHW.T) 1152.94091796875
bpp_loss 3.844338536262512
19_up proxy err 0.011249926872551441 tr(WHW.T) 7585.220703125
bpp_loss 3.436291149684361
19_gate proxy err 0.0030236514285206795 tr(WHW.T) 32694.146484375
bpp_loss 3.708197457449777
19_down proxy err 0.007576603442430496 tr(WHW.T) 6119.1787109375
bpp_loss 3.819322551999773
W0324 05:45:38.041588 3995953 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:45:39.018747 3995953 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:45:39.022949 3990028 quantize_finetune_llama.py:209] layer 22 gpu 2
I0324 05:45:39.250050 3995953 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:45:40.121119 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 22 in 0.697343111038208s
I0324 05:45:43.759915 3996071 config.py:54] PyTorch version 2.6.0 available.
W0324 05:45:44.109504 3996071 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:45:45.109862 3996071 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:45:45.113917 3990028 quantize_finetune_llama.py:209] layer 23 gpu 3
I0324 05:45:45.273740 3996071 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:45:46.341445 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 23 in 0.7880463600158691s
I0324 05:45:50.202419 3996196 config.py:54] PyTorch version 2.6.0 available.
W0324 05:45:50.564987 3996196 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:45:51.636255 3996196 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:45:51.640601 3990028 quantize_finetune_llama.py:209] layer 24 gpu 0
I0324 05:45:51.878200 3996196 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.0027096413541585207 tr(WHW.T) 326.5545349121094
bpp_loss 5.166216611862183
20_q proxy err 0.0009959181770682335 tr(WHW.T) 20688.212890625
bpp_loss 4.170539140701294
20_k proxy err 0.00040573099977336824 tr(WHW.T) 15368.2177734375
bpp_loss 5.266722917556763
20_o proxy err 0.008780200034379959 tr(WHW.T) 1189.504638671875
bpp_loss 3.8409045934677124
20_up proxy err 0.011384377256035805 tr(WHW.T) 7535.15576171875
bpp_loss 3.4375648498535156
20_gate proxy err 0.0032402784563601017 tr(WHW.T) 30547.197265625
bpp_loss 3.707301276070731
20_down proxy err 0.0074953194707632065 tr(WHW.T) 6236.83935546875
bpp_loss 3.8192366872515
21_v proxy err 0.0026280104648321867 tr(WHW.T) 358.9937438964844
bpp_loss 5.1680543422698975
21_q proxy err 0.0008211341337300837 tr(WHW.T) 25789.74609375
bpp_loss 4.1473000049591064
21_k proxy err 0.0003780365514103323 tr(WHW.T) 16759.484375
bpp_loss 5.270257234573364
21_o proxy err 0.007525097578763962 tr(WHW.T) 1250.279296875
bpp_loss 3.8767651319503784
21_up proxy err 0.011100120842456818 tr(WHW.T) 7707.68359375
bpp_loss 3.440660067967006
21_gate proxy err 0.003151129698380828 tr(WHW.T) 31446.626953125
bpp_loss 3.717285020010812
21_down proxy err 0.007468485273420811 tr(WHW.T) 6287.07373046875
bpp_loss 3.8197643416268483
I0324 05:46:58.648792 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 24 in 0.8225541114807129s
I0324 05:47:02.437873 3996924 config.py:54] PyTorch version 2.6.0 available.
W0324 05:47:02.762743 3996924 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.0030512416269630194 tr(WHW.T) 341.7787170410156
bpp_loss 5.167109727859497
22_q proxy err 0.000968407781329006 tr(WHW.T) 20273.72265625
bpp_loss 4.136253118515015
22_k proxy err 0.0004087568959221244 tr(WHW.T) 14697.265625
bpp_loss 5.274071455001831
22_o proxy err 0.009857241064310074 tr(WHW.T) 1204.8531494140625
bpp_loss 3.83053719997406
22_up proxy err 0.011560539714992046 tr(WHW.T) 7481.95849609375
bpp_loss 3.4407008034842357
22_gate proxy err 0.003362633753567934 tr(WHW.T) 29414.359375
bpp_loss 3.716970579964774
22_down proxy err 0.007325122598558664 tr(WHW.T) 6464.6640625
bpp_loss 3.819213254111154
W0324 05:47:03.779648 3996924 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:47:03.783951 3990028 quantize_finetune_llama.py:209] layer 25 gpu 1
I0324 05:47:03.940766 3996924 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:47:05.259188 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 25 in 0.9726824760437012s
I0324 05:47:09.003800 3997044 config.py:54] PyTorch version 2.6.0 available.
W0324 05:47:09.332096 3997044 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.002947282511740923 tr(WHW.T) 393.136962890625
bpp_loss 5.165040493011475
23_q proxy err 0.0009503774926997721 tr(WHW.T) 22562.6484375
bpp_loss 4.110577344894409
23_k proxy err 0.00042730337008833885 tr(WHW.T) 14830.83203125
bpp_loss 5.217691421508789
23_o proxy err 0.007182927802205086 tr(WHW.T) 1726.8399658203125
bpp_loss 3.830012798309326
23_up proxy err 0.011785881593823433 tr(WHW.T) 7353.39404296875
bpp_loss 3.443230220249721
23_gate proxy err 0.0036219635512679815 tr(WHW.T) 27171.52734375
bpp_loss 3.7195234298706055
23_down proxy err 0.00723654218018055 tr(WHW.T) 6601.61376953125
bpp_loss 3.8190862791878835
W0324 05:47:10.285449 3997044 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:47:10.289131 3990028 quantize_finetune_llama.py:209] layer 26 gpu 2
I0324 05:47:10.458264 3997044 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:47:11.532899 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 26 in 0.6981780529022217s
I0324 05:47:15.262588 3997159 config.py:54] PyTorch version 2.6.0 available.
W0324 05:47:15.612180 3997159 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:47:16.568824 3997159 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:47:16.572597 3990028 quantize_finetune_llama.py:209] layer 27 gpu 3
I0324 05:47:16.830528 3997159 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:47:17.741231 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 27 in 0.7741355895996094s
I0324 05:47:21.825983 3997287 config.py:54] PyTorch version 2.6.0 available.
W0324 05:47:22.204875 3997287 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:47:23.315793 3997287 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:47:23.320075 3990028 quantize_finetune_llama.py:209] layer 28 gpu 0
I0324 05:47:23.501690 3997287 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.0030173116829246283 tr(WHW.T) 461.53338623046875
bpp_loss 5.166544675827026
24_q proxy err 0.0009375091176480055 tr(WHW.T) 22391.330078125
bpp_loss 4.097338676452637
24_k proxy err 0.000419421965489164 tr(WHW.T) 14159.3115234375
bpp_loss 5.184901714324951
24_o proxy err 0.008117318153381348 tr(WHW.T) 1570.1973876953125
bpp_loss 3.849910020828247
24_up proxy err 0.012025897391140461 tr(WHW.T) 7244.748046875
bpp_loss 3.445605550493513
24_gate proxy err 0.003824962070211768 tr(WHW.T) 25756.130859375
bpp_loss 3.7242396218436107
24_down proxy err 0.0072312187403440475 tr(WHW.T) 6675.92578125
bpp_loss 3.8190222467694963
25_v proxy err 0.0025611708406358957 tr(WHW.T) 551.988037109375
bpp_loss 5.166528224945068
25_q proxy err 0.0008374114404432476 tr(WHW.T) 26068.671875
bpp_loss 4.0665247440338135
25_k proxy err 0.00041158395470120013 tr(WHW.T) 14392.7578125
bpp_loss 5.179417848587036
25_o proxy err 0.00647067790850997 tr(WHW.T) 1970.9990234375
bpp_loss 3.8535356521606445
25_up proxy err 0.01189110241830349 tr(WHW.T) 7314.64501953125
bpp_loss 3.45284366607666
25_gate proxy err 0.0037579999770969152 tr(WHW.T) 26184.576171875
bpp_loss 3.7333128792898997
25_down proxy err 0.007494380231946707 tr(WHW.T) 6548.80126953125
bpp_loss 3.819140536444528
I0324 05:48:32.290982 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 28 in 0.9726641178131104s
I0324 05:48:36.402850 3998037 config.py:54] PyTorch version 2.6.0 available.
W0324 05:48:36.820186 3998037 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.003642374649643898 tr(WHW.T) 428.11846923828125
bpp_loss 5.166827201843262
26_q proxy err 0.000954659073613584 tr(WHW.T) 21359.30078125
bpp_loss 4.096538066864014
26_k proxy err 0.000392020185245201 tr(WHW.T) 15400.1064453125
bpp_loss 5.2223429679870605
26_o proxy err 0.005109347403049469 tr(WHW.T) 2368.438720703125
bpp_loss 3.882096529006958
26_up proxy err 0.011488157324492931 tr(WHW.T) 7577.00390625
bpp_loss 3.4594805581229076
26_gate proxy err 0.0034316678065806627 tr(WHW.T) 28776.8671875
bpp_loss 3.741680417742048
26_down proxy err 0.00761962728574872 tr(WHW.T) 6550.5390625
bpp_loss 3.81922561781747
W0324 05:48:37.907274 3998037 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:48:37.911705 3990028 quantize_finetune_llama.py:209] layer 29 gpu 1
I0324 05:48:38.141941 3998037 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:48:39.892107 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 29 in 0.7960245609283447s
I0324 05:48:43.662692 3998172 config.py:54] PyTorch version 2.6.0 available.
W0324 05:48:44.025349 3998172 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:48:45.027551 3998172 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:48:45.031621 3990028 quantize_finetune_llama.py:209] layer 30 gpu 2
I0324 05:48:45.211488 3998172 data_utils.py:336] using 256 training seqs, 128 validation seqs
27_v proxy err 0.002693329704925418 tr(WHW.T) 670.2694702148438
bpp_loss 5.165770053863525
27_q proxy err 0.0010050047421827912 tr(WHW.T) 21263.427734375
bpp_loss 4.057204008102417
27_k proxy err 0.000440633506514132 tr(WHW.T) 13986.7197265625
bpp_loss 5.178997039794922
27_o proxy err 0.006128007546067238 tr(WHW.T) 2138.571533203125
bpp_loss 3.876881718635559
27_up proxy err 0.010495363734662533 tr(WHW.T) 8405.169921875
bpp_loss 3.4673263004847934
27_gate proxy err 0.003057510359212756 tr(WHW.T) 32682.3984375
bpp_loss 3.7499686649867465
27_down proxy err 0.007237755693495274 tr(WHW.T) 6473.53173828125
bpp_loss 3.847268887928554
I0324 05:48:47.382500 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 30 in 0.8437328338623047s
I0324 05:48:51.059943 3998316 config.py:54] PyTorch version 2.6.0 available.
W0324 05:48:51.357021 3998316 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:48:52.239737 3998316 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:48:52.243484 3990028 quantize_finetune_llama.py:209] layer 31 gpu 3
I0324 05:48:52.491578 3998316 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:48:53.604353 3990028 quantize_finetune_llama.py:240] computed original embedding for layer 31 in 0.8801164627075195s
I0324 05:48:57.543303 3998434 config.py:54] PyTorch version 2.6.0 available.
W0324 05:48:57.905697 3998434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:48:59.080404 3998434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:48:59.272716 3998434 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.003264700761064887 tr(WHW.T) 593.4841918945312
bpp_loss 5.166430234909058
28_q proxy err 0.0009316360228694975 tr(WHW.T) 23121.322265625
bpp_loss 4.056246280670166
28_k proxy err 0.00038291551754809916 tr(WHW.T) 14971.62890625
bpp_loss 5.163313388824463
28_o proxy err 0.00515013886615634 tr(WHW.T) 2488.906494140625
bpp_loss 3.9026737213134766
28_up proxy err 0.008611653931438923 tr(WHW.T) 10172.6669921875
bpp_loss 3.486968857901437
28_gate proxy err 0.002762717893347144 tr(WHW.T) 35795.8046875
bpp_loss 3.7451562881469727
28_down proxy err 0.006591548211872578 tr(WHW.T) 7137.84375
bpp_loss 3.8574441501072476
29_v proxy err 0.0025095308665186167 tr(WHW.T) 841.72265625
bpp_loss 5.166437149047852
29_q proxy err 0.00116816652007401 tr(WHW.T) 20611.14453125
bpp_loss 4.000129222869873
29_k proxy err 0.0003836215182673186 tr(WHW.T) 16341.0302734375
bpp_loss 5.1737329959869385
29_o proxy err 0.003675504121929407 tr(WHW.T) 3078.73974609375
bpp_loss 3.959308624267578
29_up proxy err 0.006938606966286898 tr(WHW.T) 12790.9697265625
bpp_loss 3.508434431893485
29_gate proxy err 0.002593440469354391 tr(WHW.T) 38239.99609375
bpp_loss 3.7416433606828963
29_down proxy err 0.005668755620718002 tr(WHW.T) 7395.6328125
bpp_loss 3.9023099967411587
30_v proxy err 0.0035836240276694298 tr(WHW.T) 850.5265502929688
bpp_loss 5.1663079261779785
30_q proxy err 0.0008978883852250874 tr(WHW.T) 24012.384765625
bpp_loss 3.9920371770858765
30_k proxy err 0.00034912858973257244 tr(WHW.T) 14011.546875
bpp_loss 5.162705659866333
30_o proxy err 0.003354855114594102 tr(WHW.T) 4841.5751953125
bpp_loss 3.9125733375549316
30_up proxy err 0.004277826752513647 tr(WHW.T) 21629.68359375
bpp_loss 3.524632045200893
30_gate proxy err 0.0019876256119459867 tr(WHW.T) 51821.0
bpp_loss 3.7800378799438477
30_down proxy err 0.0033966987393796444 tr(WHW.T) 8734.203125
bpp_loss 3.980290787560599
31_v proxy err 0.0013496415922418237 tr(WHW.T) 1798.7896728515625
bpp_loss 5.167659044265747
31_q proxy err 0.0005838603829033673 tr(WHW.T) 46129.50390625
bpp_loss 4.0320281982421875
31_k proxy err 0.0002801886002998799 tr(WHW.T) 20445.06640625
bpp_loss 5.180340766906738
31_o proxy err 0.003634889842942357 tr(WHW.T) 2186.682373046875
bpp_loss 4.065587997436523
31_up proxy err 0.0015129456296563148 tr(WHW.T) 68909.6796875
bpp_loss 3.66140501839774
31_gate proxy err 0.0007958529749885201 tr(WHW.T) 144279.1875
bpp_loss 3.9517184666224887
31_down proxy err 0.001528258202597499 tr(WHW.T) 9879.267578125
bpp_loss 4.079070704323905
I0324 05:50:31.752620 3999385 config.py:54] PyTorch version 2.6.0 available.
W0324 05:50:32.060805 3999385 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 05:50:32.317172 3999385 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:02,  2.84it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:01,  3.59it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  4.35it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  4.63it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:01<00:00,  4.78it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  4.69it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.51it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  5.22it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:01,  4.87it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  4.99it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  4.84it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  5.16it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  5.37it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.77it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s]
I0324 05:50:36.919612 3999385 hfize_llama.py:153] loaded layer 0
I0324 05:50:37.810508 3999385 hfize_llama.py:153] loaded layer 1
I0324 05:50:38.472264 3999385 hfize_llama.py:153] loaded layer 2
I0324 05:50:39.093004 3999385 hfize_llama.py:153] loaded layer 3
I0324 05:50:39.732449 3999385 hfize_llama.py:153] loaded layer 4
I0324 05:50:40.394628 3999385 hfize_llama.py:153] loaded layer 5
I0324 05:50:41.037297 3999385 hfize_llama.py:153] loaded layer 6
I0324 05:50:41.683534 3999385 hfize_llama.py:153] loaded layer 7
I0324 05:50:42.306962 3999385 hfize_llama.py:153] loaded layer 8
I0324 05:50:42.922747 3999385 hfize_llama.py:153] loaded layer 9
I0324 05:50:43.551606 3999385 hfize_llama.py:153] loaded layer 10
I0324 05:50:44.183026 3999385 hfize_llama.py:153] loaded layer 11
I0324 05:50:44.820484 3999385 hfize_llama.py:153] loaded layer 12
I0324 05:50:45.476435 3999385 hfize_llama.py:153] loaded layer 13
I0324 05:50:46.191705 3999385 hfize_llama.py:153] loaded layer 14
I0324 05:50:46.794299 3999385 hfize_llama.py:153] loaded layer 15
I0324 05:50:47.449218 3999385 hfize_llama.py:153] loaded layer 16
I0324 05:50:48.112486 3999385 hfize_llama.py:153] loaded layer 17
I0324 05:50:48.789044 3999385 hfize_llama.py:153] loaded layer 18
I0324 05:50:49.430315 3999385 hfize_llama.py:153] loaded layer 19
I0324 05:50:50.091445 3999385 hfize_llama.py:153] loaded layer 20
I0324 05:50:50.812515 3999385 hfize_llama.py:153] loaded layer 21
I0324 05:50:51.513368 3999385 hfize_llama.py:153] loaded layer 22
I0324 05:50:52.155248 3999385 hfize_llama.py:153] loaded layer 23
I0324 05:50:53.043037 3999385 hfize_llama.py:153] loaded layer 24
I0324 05:50:53.840663 3999385 hfize_llama.py:153] loaded layer 25
I0324 05:50:54.558734 3999385 hfize_llama.py:153] loaded layer 26
I0324 05:50:55.482587 3999385 hfize_llama.py:153] loaded layer 27
I0324 05:50:56.149639 3999385 hfize_llama.py:153] loaded layer 28
I0324 05:50:56.819592 3999385 hfize_llama.py:153] loaded layer 29
I0324 05:50:57.613389 3999385 hfize_llama.py:153] loaded layer 30
I0324 05:50:58.548911 3999385 hfize_llama.py:153] loaded layer 31
I0324 05:50:58.549019 3999385 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:10,  1.83s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:07,  1.42s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:04<00:05,  1.26s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:05<00:03,  1.17s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:06<00:02,  1.10s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:07<00:01,  1.06s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.05it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.11s/it]
I0324 05:52:08.562488 3999385 hfize_llama.py:167] successfully loaded hfized model
W0324 05:52:12.703277 4000577 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 05:52:13.223410 4000577 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:07,  1.25s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:06,  1.28s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:05,  1.29s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:05<00:03,  1.31s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:06<00:02,  1.30s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:07<00:01,  1.23s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:08<00:00,  1.11s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:08<00:00,  1.20s/it]
I0324 05:52:22.116281 4000577 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.6144174337387085:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.6144174337387085:   1%|          | 1/141 [00:01<04:21,  1.87s/it]avg_loss = 1.916230022907257:   1%|          | 1/141 [00:03<04:21,  1.87s/it] avg_loss = 1.916230022907257:   1%|▏         | 2/141 [00:03<03:46,  1.63s/it]avg_loss = 2.044399380683899:   1%|▏         | 2/141 [00:04<03:46,  1.63s/it]avg_loss = 2.044399380683899:   2%|▏         | 3/141 [00:04<03:35,  1.56s/it]avg_loss = 1.9969944953918457:   2%|▏         | 3/141 [00:06<03:35,  1.56s/it]avg_loss = 1.9969944953918457:   3%|▎         | 4/141 [00:06<03:29,  1.53s/it]avg_loss = 1.947144341468811:   3%|▎         | 4/141 [00:07<03:29,  1.53s/it] avg_loss = 1.947144341468811:   4%|▎         | 5/141 [00:07<03:25,  1.51s/it]avg_loss = 1.850837528705597:   4%|▎         | 5/141 [00:09<03:25,  1.51s/it]avg_loss = 1.850837528705597:   4%|▍         | 6/141 [00:09<03:22,  1.50s/it]avg_loss = 1.7868788582938058:   4%|▍         | 6/141 [00:10<03:22,  1.50s/it]avg_loss = 1.7868788582938058:   5%|▍         | 7/141 [00:10<03:21,  1.50s/it]avg_loss = 1.7822078466415405:   5%|▍         | 7/141 [00:12<03:21,  1.50s/it]avg_loss = 1.7822078466415405:   6%|▌         | 8/141 [00:12<03:19,  1.50s/it]avg_loss = 1.8164022233751085:   6%|▌         | 8/141 [00:13<03:19,  1.50s/it]avg_loss = 1.8164022233751085:   6%|▋         | 9/141 [00:13<03:18,  1.50s/it]avg_loss = 1.8200270652770996:   6%|▋         | 9/141 [00:15<03:18,  1.50s/it]avg_loss = 1.8200270652770996:   7%|▋         | 10/141 [00:15<03:16,  1.50s/it]avg_loss = 1.8150934847918423:   7%|▋         | 10/141 [00:16<03:16,  1.50s/it]avg_loss = 1.8150934847918423:   8%|▊         | 11/141 [00:16<03:15,  1.50s/it]avg_loss = 1.838255872329076:   8%|▊         | 11/141 [00:18<03:15,  1.50s/it] avg_loss = 1.838255872329076:   9%|▊         | 12/141 [00:18<03:14,  1.51s/it]avg_loss = 1.8507974239496083:   9%|▊         | 12/141 [00:19<03:14,  1.51s/it]avg_loss = 1.8507974239496083:   9%|▉         | 13/141 [00:19<03:13,  1.51s/it]avg_loss = 1.8683333141463143:   9%|▉         | 13/141 [00:21<03:13,  1.51s/it]avg_loss = 1.8683333141463143:  10%|▉         | 14/141 [00:21<03:12,  1.51s/it]avg_loss = 1.8785953760147094:  10%|▉         | 14/141 [00:22<03:12,  1.51s/it]avg_loss = 1.8785953760147094:  11%|█         | 15/141 [00:22<03:10,  1.51s/it]avg_loss = 1.9026989117264748:  11%|█         | 15/141 [00:24<03:10,  1.51s/it]avg_loss = 1.9026989117264748:  11%|█▏        | 16/141 [00:24<03:09,  1.52s/it]avg_loss = 1.9052609976600199:  11%|█▏        | 16/141 [00:25<03:09,  1.52s/it]avg_loss = 1.9052609976600199:  12%|█▏        | 17/141 [00:25<03:08,  1.52s/it]avg_loss = 1.9083660907215543:  12%|█▏        | 17/141 [00:27<03:08,  1.52s/it]avg_loss = 1.9083660907215543:  13%|█▎        | 18/141 [00:27<03:07,  1.52s/it]avg_loss = 1.8921620657569485:  13%|█▎        | 18/141 [00:28<03:07,  1.52s/it]avg_loss = 1.8921620657569485:  13%|█▎        | 19/141 [00:28<03:06,  1.53s/it]avg_loss = 1.8912936687469482:  13%|█▎        | 19/141 [00:30<03:06,  1.53s/it]avg_loss = 1.8912936687469482:  14%|█▍        | 20/141 [00:30<03:04,  1.53s/it]avg_loss = 1.8958205722627186:  14%|█▍        | 20/141 [00:32<03:04,  1.53s/it]avg_loss = 1.8958205722627186:  15%|█▍        | 21/141 [00:32<03:03,  1.53s/it]avg_loss = 1.898255163973028:  15%|█▍        | 21/141 [00:33<03:03,  1.53s/it] avg_loss = 1.898255163973028:  16%|█▌        | 22/141 [00:33<03:02,  1.53s/it]avg_loss = 1.8995846250782842:  16%|█▌        | 22/141 [00:35<03:02,  1.53s/it]avg_loss = 1.8995846250782842:  16%|█▋        | 23/141 [00:35<03:01,  1.54s/it]avg_loss = 1.9044248660405476:  16%|█▋        | 23/141 [00:36<03:01,  1.54s/it]avg_loss = 1.9044248660405476:  17%|█▋        | 24/141 [00:36<02:59,  1.54s/it]avg_loss = 1.9099245262145996:  17%|█▋        | 24/141 [00:38<02:59,  1.54s/it]avg_loss = 1.9099245262145996:  18%|█▊        | 25/141 [00:38<02:58,  1.54s/it]avg_loss = 1.9210510162206798:  18%|█▊        | 25/141 [00:39<02:58,  1.54s/it]avg_loss = 1.9210510162206798:  18%|█▊        | 26/141 [00:39<02:57,  1.54s/it]avg_loss = 1.9335373419302482:  18%|█▊        | 26/141 [00:41<02:57,  1.54s/it]avg_loss = 1.9335373419302482:  19%|█▉        | 27/141 [00:41<02:56,  1.55s/it]avg_loss = 1.9396010552133833:  19%|█▉        | 27/141 [00:42<02:56,  1.55s/it]avg_loss = 1.9396010552133833:  20%|█▉        | 28/141 [00:42<02:54,  1.55s/it]avg_loss = 1.9364202680258915:  20%|█▉        | 28/141 [00:44<02:54,  1.55s/it]avg_loss = 1.9364202680258915:  21%|██        | 29/141 [00:44<02:53,  1.55s/it]avg_loss = 1.9267341216405234:  21%|██        | 29/141 [00:45<02:53,  1.55s/it]avg_loss = 1.9267341216405234:  21%|██▏       | 30/141 [00:45<02:52,  1.55s/it]avg_loss = 1.9125297646368704:  21%|██▏       | 30/141 [00:47<02:52,  1.55s/it]avg_loss = 1.9125297646368704:  22%|██▏       | 31/141 [00:47<02:51,  1.56s/it]avg_loss = 1.9007320553064346:  22%|██▏       | 31/141 [00:49<02:51,  1.56s/it]avg_loss = 1.9007320553064346:  23%|██▎       | 32/141 [00:49<02:49,  1.56s/it]avg_loss = 1.8990594726620298:  23%|██▎       | 32/141 [00:50<02:49,  1.56s/it]avg_loss = 1.8990594726620298:  23%|██▎       | 33/141 [00:50<02:48,  1.56s/it]avg_loss = 1.897273666718427:  23%|██▎       | 33/141 [00:52<02:48,  1.56s/it] avg_loss = 1.897273666718427:  24%|██▍       | 34/141 [00:52<02:47,  1.56s/it]avg_loss = 1.9000333479472569:  24%|██▍       | 34/141 [00:53<02:47,  1.56s/it]avg_loss = 1.9000333479472569:  25%|██▍       | 35/141 [00:53<02:45,  1.56s/it]avg_loss = 1.883777962790595:  25%|██▍       | 35/141 [00:55<02:45,  1.56s/it] avg_loss = 1.883777962790595:  26%|██▌       | 36/141 [00:55<02:44,  1.56s/it]avg_loss = 1.8684475067499522:  26%|██▌       | 36/141 [00:56<02:44,  1.56s/it]avg_loss = 1.8684475067499522:  26%|██▌       | 37/141 [00:56<02:42,  1.56s/it]avg_loss = 1.8536428275861239:  26%|██▌       | 37/141 [00:58<02:42,  1.56s/it]avg_loss = 1.8536428275861239:  27%|██▋       | 38/141 [00:58<02:41,  1.57s/it]avg_loss = 1.8396899761297765:  27%|██▋       | 38/141 [01:00<02:41,  1.57s/it]avg_loss = 1.8396899761297765:  28%|██▊       | 39/141 [01:00<02:39,  1.57s/it]avg_loss = 1.831244456768036:  28%|██▊       | 39/141 [01:01<02:39,  1.57s/it] avg_loss = 1.831244456768036:  28%|██▊       | 40/141 [01:01<02:38,  1.57s/it]avg_loss = 1.8366575008485375:  28%|██▊       | 40/141 [01:03<02:38,  1.57s/it]avg_loss = 1.8366575008485375:  29%|██▉       | 41/141 [01:03<02:36,  1.57s/it]avg_loss = 1.853670318921407:  29%|██▉       | 41/141 [01:04<02:36,  1.57s/it] avg_loss = 1.853670318921407:  30%|██▉       | 42/141 [01:04<02:35,  1.57s/it]avg_loss = 1.8698184989219488:  30%|██▉       | 42/141 [01:06<02:35,  1.57s/it]avg_loss = 1.8698184989219488:  30%|███       | 43/141 [01:06<02:33,  1.57s/it]avg_loss = 1.8729726021940059:  30%|███       | 43/141 [01:07<02:33,  1.57s/it]avg_loss = 1.8729726021940059:  31%|███       | 44/141 [01:07<02:32,  1.57s/it]avg_loss = 1.8773778809441461:  31%|███       | 44/141 [01:09<02:32,  1.57s/it]avg_loss = 1.8773778809441461:  32%|███▏      | 45/141 [01:09<02:30,  1.57s/it]avg_loss = 1.882734635601873:  32%|███▏      | 45/141 [01:11<02:30,  1.57s/it] avg_loss = 1.882734635601873:  33%|███▎      | 46/141 [01:11<02:29,  1.57s/it]avg_loss = 1.8891314090566431:  33%|███▎      | 46/141 [01:12<02:29,  1.57s/it]avg_loss = 1.8891314090566431:  33%|███▎      | 47/141 [01:12<02:28,  1.58s/it]avg_loss = 1.8922556936740875:  33%|███▎      | 47/141 [01:14<02:28,  1.58s/it]avg_loss = 1.8922556936740875:  34%|███▍      | 48/141 [01:14<02:26,  1.58s/it]avg_loss = 1.8909627393800386:  34%|███▍      | 48/141 [01:15<02:26,  1.58s/it]avg_loss = 1.8909627393800386:  35%|███▍      | 49/141 [01:15<02:25,  1.58s/it]avg_loss = 1.890608332157135:  35%|███▍      | 49/141 [01:17<02:25,  1.58s/it] avg_loss = 1.890608332157135:  35%|███▌      | 50/141 [01:17<02:23,  1.58s/it]avg_loss = 1.884202202161153:  35%|███▌      | 50/141 [01:18<02:23,  1.58s/it]avg_loss = 1.884202202161153:  36%|███▌      | 51/141 [01:18<02:22,  1.58s/it]avg_loss = 1.8803581549571111:  36%|███▌      | 51/141 [01:20<02:22,  1.58s/it]avg_loss = 1.8803581549571111:  37%|███▋      | 52/141 [01:20<02:20,  1.58s/it]avg_loss = 1.8736258430301018:  37%|███▋      | 52/141 [01:22<02:20,  1.58s/it]avg_loss = 1.8736258430301018:  38%|███▊      | 53/141 [01:22<02:19,  1.58s/it]avg_loss = 1.8707041630038508:  38%|███▊      | 53/141 [01:23<02:19,  1.58s/it]avg_loss = 1.8707041630038508:  38%|███▊      | 54/141 [01:23<02:17,  1.58s/it]avg_loss = 1.8630756638266823:  38%|███▊      | 54/141 [01:25<02:17,  1.58s/it]avg_loss = 1.8630756638266823:  39%|███▉      | 55/141 [01:25<02:15,  1.58s/it]avg_loss = 1.8554112166166306:  39%|███▉      | 55/141 [01:26<02:15,  1.58s/it]avg_loss = 1.8554112166166306:  40%|███▉      | 56/141 [01:26<02:14,  1.58s/it]avg_loss = 1.8495449810697322:  40%|███▉      | 56/141 [01:28<02:14,  1.58s/it]avg_loss = 1.8495449810697322:  40%|████      | 57/141 [01:28<02:12,  1.58s/it]avg_loss = 1.8467038643771205:  40%|████      | 57/141 [01:30<02:12,  1.58s/it]avg_loss = 1.8467038643771205:  41%|████      | 58/141 [01:30<02:11,  1.58s/it]avg_loss = 1.8490537162554466:  41%|████      | 58/141 [01:31<02:11,  1.58s/it]avg_loss = 1.8490537162554466:  42%|████▏     | 59/141 [01:31<02:09,  1.58s/it]avg_loss = 1.85471626718839:  42%|████▏     | 59/141 [01:33<02:09,  1.58s/it]  avg_loss = 1.85471626718839:  43%|████▎     | 60/141 [01:33<02:08,  1.58s/it]avg_loss = 1.860657271791677:  43%|████▎     | 60/141 [01:34<02:08,  1.58s/it]avg_loss = 1.860657271791677:  43%|████▎     | 61/141 [01:34<02:06,  1.58s/it]avg_loss = 1.867884434038593:  43%|████▎     | 61/141 [01:36<02:06,  1.58s/it]avg_loss = 1.867884434038593:  44%|████▍     | 62/141 [01:36<02:05,  1.58s/it]avg_loss = 1.8588740485055106:  44%|████▍     | 62/141 [01:37<02:05,  1.58s/it]avg_loss = 1.8588740485055106:  45%|████▍     | 63/141 [01:37<02:03,  1.59s/it]avg_loss = 1.8567043077200651:  45%|████▍     | 63/141 [01:39<02:03,  1.59s/it]avg_loss = 1.8567043077200651:  45%|████▌     | 64/141 [01:39<02:02,  1.59s/it]avg_loss = 1.854118356337914:  45%|████▌     | 64/141 [01:41<02:02,  1.59s/it] avg_loss = 1.854118356337914:  46%|████▌     | 65/141 [01:41<02:00,  1.58s/it]avg_loss = 1.8481276270115015:  46%|████▌     | 65/141 [01:42<02:00,  1.58s/it]avg_loss = 1.8481276270115015:  47%|████▋     | 66/141 [01:42<01:58,  1.59s/it]avg_loss = 1.845358051470856:  47%|████▋     | 66/141 [01:44<01:58,  1.59s/it] avg_loss = 1.845358051470856:  48%|████▊     | 67/141 [01:44<01:57,  1.59s/it]avg_loss = 1.8418133521781248:  48%|████▊     | 67/141 [01:45<01:57,  1.59s/it]avg_loss = 1.8418133521781248:  48%|████▊     | 68/141 [01:45<01:55,  1.59s/it]avg_loss = 1.8391103208928867:  48%|████▊     | 68/141 [01:47<01:55,  1.59s/it]avg_loss = 1.8391103208928867:  49%|████▉     | 69/141 [01:47<01:54,  1.59s/it]avg_loss = 1.8401647414479936:  49%|████▉     | 69/141 [01:49<01:54,  1.59s/it]avg_loss = 1.8401647414479936:  50%|████▉     | 70/141 [01:49<01:52,  1.59s/it]avg_loss = 1.8440068019947535:  50%|████▉     | 70/141 [01:50<01:52,  1.59s/it]avg_loss = 1.8440068019947535:  50%|█████     | 71/141 [01:50<01:51,  1.59s/it]avg_loss = 1.8462796823845968:  50%|█████     | 71/141 [01:52<01:51,  1.59s/it]avg_loss = 1.8462796823845968:  51%|█████     | 72/141 [01:52<01:49,  1.59s/it]avg_loss = 1.84488552563811:  51%|█████     | 72/141 [01:53<01:49,  1.59s/it]  avg_loss = 1.84488552563811:  52%|█████▏    | 73/141 [01:53<01:48,  1.59s/it]avg_loss = 1.8466609442556225:  52%|█████▏    | 73/141 [01:55<01:48,  1.59s/it]avg_loss = 1.8466609442556225:  52%|█████▏    | 74/141 [01:55<01:46,  1.59s/it]avg_loss = 1.846695294380188:  52%|█████▏    | 74/141 [01:57<01:46,  1.59s/it] avg_loss = 1.846695294380188:  53%|█████▎    | 75/141 [01:57<01:45,  1.59s/it]avg_loss = 1.8454316603510004:  53%|█████▎    | 75/141 [01:58<01:45,  1.59s/it]avg_loss = 1.8454316603510004:  54%|█████▍    | 76/141 [01:58<01:43,  1.59s/it]avg_loss = 1.8466229934196967:  54%|█████▍    | 76/141 [02:00<01:43,  1.59s/it]avg_loss = 1.8466229934196967:  55%|█████▍    | 77/141 [02:00<01:41,  1.59s/it]avg_loss = 1.8490363114919417:  55%|█████▍    | 77/141 [02:01<01:41,  1.59s/it]avg_loss = 1.8490363114919417:  55%|█████▌    | 78/141 [02:01<01:40,  1.60s/it]avg_loss = 1.8531174840806406:  55%|█████▌    | 78/141 [02:03<01:40,  1.60s/it]avg_loss = 1.8531174840806406:  56%|█████▌    | 79/141 [02:03<01:38,  1.59s/it]avg_loss = 1.8499786362051964:  56%|█████▌    | 79/141 [02:04<01:38,  1.59s/it]avg_loss = 1.8499786362051964:  57%|█████▋    | 80/141 [02:04<01:37,  1.59s/it]avg_loss = 1.848835825920105:  57%|█████▋    | 80/141 [02:06<01:37,  1.59s/it] avg_loss = 1.848835825920105:  57%|█████▋    | 81/141 [02:06<01:35,  1.59s/it]avg_loss = 1.8480344429248716:  57%|█████▋    | 81/141 [02:08<01:35,  1.59s/it]avg_loss = 1.8480344429248716:  58%|█████▊    | 82/141 [02:08<01:34,  1.60s/it]avg_loss = 1.846238242574485:  58%|█████▊    | 82/141 [02:09<01:34,  1.60s/it] avg_loss = 1.846238242574485:  59%|█████▉    | 83/141 [02:09<01:32,  1.60s/it]avg_loss = 1.8441413101695834:  59%|█████▉    | 83/141 [02:11<01:32,  1.60s/it]avg_loss = 1.8441413101695834:  60%|█████▉    | 84/141 [02:11<01:31,  1.60s/it]avg_loss = 1.8417826666551478:  60%|█████▉    | 84/141 [02:12<01:31,  1.60s/it]avg_loss = 1.8417826666551478:  60%|██████    | 85/141 [02:12<01:29,  1.60s/it]avg_loss = 1.8436013751251752:  60%|██████    | 85/141 [02:14<01:29,  1.60s/it]avg_loss = 1.8436013751251752:  61%|██████    | 86/141 [02:14<01:27,  1.60s/it]avg_loss = 1.8455555726741921:  61%|██████    | 86/141 [02:16<01:27,  1.60s/it]avg_loss = 1.8455555726741921:  62%|██████▏   | 87/141 [02:16<01:26,  1.60s/it]avg_loss = 1.8459686948494478:  62%|██████▏   | 87/141 [02:17<01:26,  1.60s/it]avg_loss = 1.8459686948494478:  62%|██████▏   | 88/141 [02:17<01:24,  1.59s/it]avg_loss = 1.8547051716386602:  62%|██████▏   | 88/141 [02:19<01:24,  1.59s/it]avg_loss = 1.8547051716386602:  63%|██████▎   | 89/141 [02:19<01:22,  1.59s/it]avg_loss = 1.8621352526876662:  63%|██████▎   | 89/141 [02:20<01:22,  1.59s/it]avg_loss = 1.8621352526876662:  64%|██████▍   | 90/141 [02:20<01:21,  1.59s/it]avg_loss = 1.8652323982217809:  64%|██████▍   | 90/141 [02:22<01:21,  1.59s/it]avg_loss = 1.8652323982217809:  65%|██████▍   | 91/141 [02:22<01:19,  1.60s/it]avg_loss = 1.870271367871243:  65%|██████▍   | 91/141 [02:24<01:19,  1.60s/it] avg_loss = 1.870271367871243:  65%|██████▌   | 92/141 [02:24<01:18,  1.60s/it]avg_loss = 1.8752845935924078:  65%|██████▌   | 92/141 [02:25<01:18,  1.60s/it]avg_loss = 1.8752845935924078:  66%|██████▌   | 93/141 [02:25<01:16,  1.60s/it]avg_loss = 1.876236986606679:  66%|██████▌   | 93/141 [02:27<01:16,  1.60s/it] avg_loss = 1.876236986606679:  67%|██████▋   | 94/141 [02:27<01:15,  1.60s/it]avg_loss = 1.8800916797236393:  67%|██████▋   | 94/141 [02:28<01:15,  1.60s/it]avg_loss = 1.8800916797236393:  67%|██████▋   | 95/141 [02:28<01:13,  1.60s/it]avg_loss = 1.881135034064452:  67%|██████▋   | 95/141 [02:30<01:13,  1.60s/it] avg_loss = 1.881135034064452:  68%|██████▊   | 96/141 [02:30<01:11,  1.60s/it]avg_loss = 1.883011822847976:  68%|██████▊   | 96/141 [02:32<01:11,  1.60s/it]avg_loss = 1.883011822847976:  69%|██████▉   | 97/141 [02:32<01:10,  1.60s/it]avg_loss = 1.8789807302611214:  69%|██████▉   | 97/141 [02:33<01:10,  1.60s/it]avg_loss = 1.8789807302611214:  70%|██████▉   | 98/141 [02:33<01:08,  1.60s/it]avg_loss = 1.8796609218674476:  70%|██████▉   | 98/141 [02:35<01:08,  1.60s/it]avg_loss = 1.8796609218674476:  70%|███████   | 99/141 [02:35<01:07,  1.60s/it]avg_loss = 1.8818532013893128:  70%|███████   | 99/141 [02:36<01:07,  1.60s/it]avg_loss = 1.8818532013893128:  71%|███████   | 100/141 [02:36<01:05,  1.60s/it]avg_loss = 1.880610211060779:  71%|███████   | 100/141 [02:38<01:05,  1.60s/it] avg_loss = 1.880610211060779:  72%|███████▏  | 101/141 [02:38<01:03,  1.60s/it]avg_loss = 1.8807972096929364:  72%|███████▏  | 101/141 [02:40<01:03,  1.60s/it]avg_loss = 1.8807972096929364:  72%|███████▏  | 102/141 [02:40<01:02,  1.60s/it]avg_loss = 1.8791161659851814:  72%|███████▏  | 102/141 [02:41<01:02,  1.60s/it]avg_loss = 1.8791161659851814:  73%|███████▎  | 103/141 [02:41<01:00,  1.60s/it]avg_loss = 1.8817304590573678:  73%|███████▎  | 103/141 [02:43<01:00,  1.60s/it]avg_loss = 1.8817304590573678:  74%|███████▍  | 104/141 [02:43<00:59,  1.60s/it]avg_loss = 1.8805124680201213:  74%|███████▍  | 104/141 [02:44<00:59,  1.60s/it]avg_loss = 1.8805124680201213:  74%|███████▍  | 105/141 [02:44<00:57,  1.60s/it]avg_loss = 1.8793917838132606:  74%|███████▍  | 105/141 [02:46<00:57,  1.60s/it]avg_loss = 1.8793917838132606:  75%|███████▌  | 106/141 [02:46<00:55,  1.60s/it]avg_loss = 1.877062105686865:  75%|███████▌  | 106/141 [02:48<00:55,  1.60s/it] avg_loss = 1.877062105686865:  76%|███████▌  | 107/141 [02:48<00:54,  1.60s/it]avg_loss = 1.8749260328434132:  76%|███████▌  | 107/141 [02:49<00:54,  1.60s/it]avg_loss = 1.8749260328434132:  77%|███████▋  | 108/141 [02:49<00:52,  1.60s/it]avg_loss = 1.8724215643121562:  77%|███████▋  | 108/141 [02:51<00:52,  1.60s/it]avg_loss = 1.8724215643121562:  77%|███████▋  | 109/141 [02:51<00:51,  1.60s/it]avg_loss = 1.8699494979598306:  77%|███████▋  | 109/141 [02:52<00:51,  1.60s/it]avg_loss = 1.8699494979598306:  78%|███████▊  | 110/141 [02:52<00:49,  1.60s/it]avg_loss = 1.8722924359209903:  78%|███████▊  | 110/141 [02:54<00:49,  1.60s/it]avg_loss = 1.8722924359209903:  79%|███████▊  | 111/141 [02:54<00:47,  1.60s/it]avg_loss = 1.872098374579634:  79%|███████▊  | 111/141 [02:56<00:47,  1.60s/it] avg_loss = 1.872098374579634:  79%|███████▉  | 112/141 [02:56<00:46,  1.60s/it]avg_loss = 1.8732706076275987:  79%|███████▉  | 112/141 [02:57<00:46,  1.60s/it]avg_loss = 1.8732706076275987:  80%|████████  | 113/141 [02:57<00:44,  1.60s/it]avg_loss = 1.8742571514949464:  80%|████████  | 113/141 [02:59<00:44,  1.60s/it]avg_loss = 1.8742571514949464:  81%|████████  | 114/141 [02:59<00:43,  1.60s/it]avg_loss = 1.8736345436262047:  81%|████████  | 114/141 [03:00<00:43,  1.60s/it]avg_loss = 1.8736345436262047:  82%|████████▏ | 115/141 [03:00<00:41,  1.60s/it]avg_loss = 1.8721103616829575:  82%|████████▏ | 115/141 [03:02<00:41,  1.60s/it]avg_loss = 1.8721103616829575:  82%|████████▏ | 116/141 [03:02<00:39,  1.60s/it]avg_loss = 1.8742192453808255:  82%|████████▏ | 116/141 [03:04<00:39,  1.60s/it]avg_loss = 1.8742192453808255:  83%|████████▎ | 117/141 [03:04<00:38,  1.60s/it]avg_loss = 1.8739267052230189:  83%|████████▎ | 117/141 [03:05<00:38,  1.60s/it]avg_loss = 1.8739267052230189:  84%|████████▎ | 118/141 [03:05<00:36,  1.60s/it]avg_loss = 1.8724968363257015:  84%|████████▎ | 118/141 [03:07<00:36,  1.60s/it]avg_loss = 1.8724968363257015:  84%|████████▍ | 119/141 [03:07<00:35,  1.60s/it]avg_loss = 1.8707383781671525:  84%|████████▍ | 119/141 [03:08<00:35,  1.60s/it]avg_loss = 1.8707383781671525:  85%|████████▌ | 120/141 [03:08<00:33,  1.60s/it]avg_loss = 1.8706187600931845:  85%|████████▌ | 120/141 [03:10<00:33,  1.60s/it]avg_loss = 1.8706187600931845:  86%|████████▌ | 121/141 [03:10<00:31,  1.60s/it]avg_loss = 1.8710460711698063:  86%|████████▌ | 121/141 [03:12<00:31,  1.60s/it]avg_loss = 1.8710460711698063:  87%|████████▋ | 122/141 [03:12<00:30,  1.60s/it]avg_loss = 1.8708734018046682:  87%|████████▋ | 122/141 [03:13<00:30,  1.60s/it]avg_loss = 1.8708734018046682:  87%|████████▋ | 123/141 [03:13<00:28,  1.60s/it]avg_loss = 1.8711076417276937:  87%|████████▋ | 123/141 [03:15<00:28,  1.60s/it]avg_loss = 1.8711076417276937:  88%|████████▊ | 124/141 [03:15<00:27,  1.60s/it]avg_loss = 1.869834496498108:  88%|████████▊ | 124/141 [03:16<00:27,  1.60s/it] avg_loss = 1.869834496498108:  89%|████████▊ | 125/141 [03:16<00:25,  1.60s/it]avg_loss = 1.8703110993854584:  89%|████████▊ | 125/141 [03:18<00:25,  1.60s/it]avg_loss = 1.8703110993854584:  89%|████████▉ | 126/141 [03:18<00:23,  1.60s/it]avg_loss = 1.8699915653138648:  89%|████████▉ | 126/141 [03:20<00:23,  1.60s/it]avg_loss = 1.8699915653138648:  90%|█████████ | 127/141 [03:20<00:22,  1.60s/it]avg_loss = 1.8687436692416668:  90%|█████████ | 127/141 [03:21<00:22,  1.60s/it]avg_loss = 1.8687436692416668:  91%|█████████ | 128/141 [03:21<00:20,  1.60s/it]avg_loss = 1.8689223906790564:  91%|█████████ | 128/141 [03:23<00:20,  1.60s/it]avg_loss = 1.8689223906790564:  91%|█████████▏| 129/141 [03:23<00:19,  1.60s/it]avg_loss = 1.869727840790382:  91%|█████████▏| 129/141 [03:24<00:19,  1.60s/it] avg_loss = 1.869727840790382:  92%|█████████▏| 130/141 [03:24<00:17,  1.60s/it]avg_loss = 1.8706392031589538:  92%|█████████▏| 130/141 [03:26<00:17,  1.60s/it]avg_loss = 1.8706392031589538:  93%|█████████▎| 131/141 [03:26<00:15,  1.60s/it]avg_loss = 1.8712797490033237:  93%|█████████▎| 131/141 [03:28<00:15,  1.60s/it]avg_loss = 1.8712797490033237:  94%|█████████▎| 132/141 [03:28<00:14,  1.59s/it]avg_loss = 1.8684934090850944:  94%|█████████▎| 132/141 [03:29<00:14,  1.59s/it]avg_loss = 1.8684934090850944:  94%|█████████▍| 133/141 [03:29<00:12,  1.59s/it]avg_loss = 1.8640800011691763:  94%|█████████▍| 133/141 [03:31<00:12,  1.59s/it]avg_loss = 1.8640800011691763:  95%|█████████▌| 134/141 [03:31<00:11,  1.60s/it]avg_loss = 1.8666099981025412:  95%|█████████▌| 134/141 [03:32<00:11,  1.60s/it]avg_loss = 1.8666099981025412:  96%|█████████▌| 135/141 [03:32<00:09,  1.60s/it]avg_loss = 1.8700835801222746:  96%|█████████▌| 135/141 [03:34<00:09,  1.60s/it]avg_loss = 1.8700835801222746:  96%|█████████▋| 136/141 [03:34<00:07,  1.60s/it]avg_loss = 1.8711405853285408:  96%|█████████▋| 136/141 [03:36<00:07,  1.60s/it]avg_loss = 1.8711405853285408:  97%|█████████▋| 137/141 [03:36<00:06,  1.60s/it]avg_loss = 1.8698821128278538:  97%|█████████▋| 137/141 [03:37<00:06,  1.60s/it]avg_loss = 1.8698821128278538:  98%|█████████▊| 138/141 [03:37<00:04,  1.60s/it]avg_loss = 1.8700794127347657:  98%|█████████▊| 138/141 [03:39<00:04,  1.60s/it]avg_loss = 1.8700794127347657:  99%|█████████▊| 139/141 [03:39<00:03,  1.60s/it]avg_loss = 1.8707689685480935:  99%|█████████▊| 139/141 [03:40<00:03,  1.60s/it]avg_loss = 1.8707689685480935:  99%|█████████▉| 140/141 [03:40<00:01,  1.59s/it]avg_loss = 1.8719684105392889:  99%|█████████▉| 140/141 [03:42<00:01,  1.59s/it]avg_loss = 1.8719684105392889: 100%|██████████| 141/141 [03:42<00:00,  1.60s/it]avg_loss = 1.8719684105392889: 100%|██████████| 141/141 [03:42<00:00,  1.58s/it]
I0324 05:56:38.170833 4000577 eval_ppl.py:107] wikitext2 perplexity: 6.501080513000488
wikitext2 perplexity: 6.501
