I0324 05:20:11.121113 3976992 config.py:54] PyTorch version 2.6.0 available.
W0324 05:20:11.397315 3976992 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:20:12.281797 3976992 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  6.94it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.67it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.94it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  7.54it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  7.84it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.01it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.24it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.95it/s]
I0324 05:20:13.738327 3976992 quantize_finetune_llama.py:150] loaded model
I0324 05:20:14.044591 3976992 quantize_finetune_llama.py:185] loaded compression model
I0324 05:20:31.727119 3976992 quantize_finetune_llama.py:189] loaded dataset and devset
I0324 05:20:37.376165 3976992 quantize_finetune_llama.py:209] layer 0 gpu 0
I0324 05:20:39.630634 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 0 in 2.107395648956299s
Use train scale and shift
tensor(-1.5053e-07, device='cuda:0') tensor(0.0156, device='cuda:0')
tensor(0.0156, device='cuda:0') tensor(-1.5053e-07, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0324 05:20:54.402543 3977556 config.py:54] PyTorch version 2.6.0 available.
W0324 05:20:54.683454 3977556 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:20:55.574926 3977556 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:20:55.579025 3976992 quantize_finetune_llama.py:209] layer 1 gpu 1
I0324 05:20:55.734991 3977556 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:20:58.502120 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 1 in 2.7527313232421875s
I0324 05:21:01.989160 3977681 config.py:54] PyTorch version 2.6.0 available.
W0324 05:21:02.274543 3977681 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:21:03.193424 3977681 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:21:03.197646 3976992 quantize_finetune_llama.py:209] layer 2 gpu 2
I0324 05:21:03.601990 3977681 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:21:07.308499 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 2 in 3.9660847187042236s
I0324 05:21:10.957915 3977837 config.py:54] PyTorch version 2.6.0 available.
W0324 05:21:11.282664 3977837 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:21:12.269227 3977837 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:21:12.273355 3976992 quantize_finetune_llama.py:209] layer 3 gpu 3
I0324 05:21:12.433125 3977837 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:21:15.602477 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 3 in 3.1637349128723145s
I0324 05:21:19.536704 3977982 config.py:54] PyTorch version 2.6.0 available.
W0324 05:21:19.904191 3977982 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:21:20.922673 3977982 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:21:20.927224 3976992 quantize_finetune_llama.py:209] layer 4 gpu 0
I0324 05:21:21.111315 3977982 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.008375648409128189 tr(WHW.T) 59.109249114990234
bpp_loss 4.638101100921631
0_q proxy err 0.00024252181174233556 tr(WHW.T) 288041.78125
bpp_loss 3.7220171689987183
0_k proxy err 0.0001412181300111115 tr(WHW.T) 100152.8671875
bpp_loss 4.910674571990967
0_o proxy err 0.003174303798004985 tr(WHW.T) 3113.9609375
bpp_loss 3.3650453090667725
0_up proxy err 0.019372688606381416 tr(WHW.T) 8859.7275390625
bpp_loss 2.9376426424298967
0_gate proxy err 0.011733531951904297 tr(WHW.T) 15700.0
bpp_loss 3.008005823407854
0_down proxy err 0.008462811820209026 tr(WHW.T) 10753.7939453125
bpp_loss 3.335878644670759
1_v proxy err 0.010283597745001316 tr(WHW.T) 106.54676055908203
bpp_loss 4.627568483352661
1_q proxy err 0.00025736060342751443 tr(WHW.T) 144769.71875
bpp_loss 3.899035096168518
1_k proxy err 0.00011909548629773781 tr(WHW.T) 75510.046875
bpp_loss 5.143901348114014
1_o proxy err 0.0076592471450567245 tr(WHW.T) 1971.8739013671875
bpp_loss 3.3512330055236816
1_up proxy err 0.021144933998584747 tr(WHW.T) 8164.14208984375
bpp_loss 2.947901180812291
1_gate proxy err 0.013188809156417847 tr(WHW.T) 13871.78125
bpp_loss 3.02000059400286
1_down proxy err 0.0002629229857120663 tr(WHW.T) 13911.810546875
bpp_loss 3.428241729736328
I0324 05:22:13.955505 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 4 in 1.0136120319366455s
I0324 05:22:17.673131 3978588 config.py:54] PyTorch version 2.6.0 available.
W0324 05:22:18.013739 3978588 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:22:19.053165 3978588 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:22:19.057491 3976992 quantize_finetune_llama.py:209] layer 5 gpu 1
I0324 05:22:19.253965 3978588 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.005774304270744324 tr(WHW.T) 154.1771240234375
bpp_loss 4.619812965393066
2_q proxy err 0.0008517453097738326 tr(WHW.T) 41423.8046875
bpp_loss 3.7771830558776855
2_k proxy err 0.000437344191595912 tr(WHW.T) 22584.275390625
bpp_loss 5.006809949874878
2_o proxy err 0.007463518995791674 tr(WHW.T) 1957.195556640625
bpp_loss 3.325431704521179
2_up proxy err 0.02356620505452156 tr(WHW.T) 7534.43212890625
bpp_loss 2.937079974583217
2_gate proxy err 0.012628721073269844 tr(WHW.T) 15028.0859375
bpp_loss 3.0388712201799666
2_down proxy err 0.012296142056584358 tr(WHW.T) 7660.255859375
bpp_loss 3.332366943359375
I0324 05:22:23.080275 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 5 in 0.9841697216033936s
I0324 05:22:26.992602 3978757 config.py:54] PyTorch version 2.6.0 available.
W0324 05:22:27.332726 3978757 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:22:28.334842 3978757 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:22:28.338973 3976992 quantize_finetune_llama.py:209] layer 6 gpu 2
I0324 05:22:28.555312 3978757 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.004402004648000002 tr(WHW.T) 286.8193664550781
bpp_loss 4.620744228363037
3_q proxy err 0.001063438132405281 tr(WHW.T) 47525.1171875
bpp_loss 3.6699057817459106
3_k proxy err 0.0005380450165830553 tr(WHW.T) 26144.298828125
bpp_loss 4.775320053100586
3_o proxy err 0.010251340456306934 tr(WHW.T) 1843.92529296875
bpp_loss 3.3282538652420044
3_up proxy err 0.02339286357164383 tr(WHW.T) 7472.86376953125
bpp_loss 2.9257963725498746
3_gate proxy err 0.009312883019447327 tr(WHW.T) 20788.29296875
bpp_loss 3.097499574933733
3_down proxy err 0.013149077072739601 tr(WHW.T) 6935.24755859375
bpp_loss 3.326808588845389
I0324 05:22:32.129797 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 6 in 0.882387638092041s
I0324 05:22:35.968821 3978901 config.py:54] PyTorch version 2.6.0 available.
W0324 05:22:36.315326 3978901 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:22:37.331884 3978901 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:22:37.336221 3976992 quantize_finetune_llama.py:209] layer 7 gpu 3
I0324 05:22:37.497495 3978901 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:22:38.837408 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 7 in 1.0101501941680908s
I0324 05:22:42.701343 3979033 config.py:54] PyTorch version 2.6.0 available.
W0324 05:22:43.056898 3979033 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:22:44.138080 3979033 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:22:44.142360 3976992 quantize_finetune_llama.py:209] layer 8 gpu 0
I0324 05:22:44.347347 3979033 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.005181243643164635 tr(WHW.T) 282.38128662109375
bpp_loss 4.620173215866089
4_q proxy err 0.0009045855258591473 tr(WHW.T) 50064.37109375
bpp_loss 3.700347065925598
4_k proxy err 0.00042912407661788166 tr(WHW.T) 29272.75390625
bpp_loss 4.843790054321289
4_o proxy err 0.013935482129454613 tr(WHW.T) 1283.4017333984375
bpp_loss 3.348442792892456
4_up proxy err 0.02311110496520996 tr(WHW.T) 7323.07763671875
bpp_loss 2.9134765352521623
4_gate proxy err 0.006758411414921284 tr(WHW.T) 29023.8984375
bpp_loss 3.1571758815220425
4_down proxy err 0.013740947470068932 tr(WHW.T) 6335.5126953125
bpp_loss 3.324879135404314
5_v proxy err 0.004864806775003672 tr(WHW.T) 206.8122100830078
bpp_loss 4.619147539138794
5_q proxy err 0.0011708318488672376 tr(WHW.T) 35941.703125
bpp_loss 3.7009166479110718
5_k proxy err 0.0005309893749654293 tr(WHW.T) 22968.27734375
bpp_loss 4.855690240859985
5_o proxy err 0.014934072270989418 tr(WHW.T) 1043.734619140625
bpp_loss 3.341241717338562
5_up proxy err 0.022207152098417282 tr(WHW.T) 7595.3154296875
bpp_loss 2.9187143870762418
5_gate proxy err 0.0064137522131204605 tr(WHW.T) 30279.96875
bpp_loss 3.1589508056640625
5_down proxy err 0.013904408551752567 tr(WHW.T) 6350.38623046875
bpp_loss 3.323505844388689
I0324 05:23:38.748789 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 8 in 1.172424077987671s
I0324 05:23:42.638592 3979658 config.py:54] PyTorch version 2.6.0 available.
W0324 05:23:42.984936 3979658 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:23:44.001305 3979658 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:23:44.006100 3976992 quantize_finetune_llama.py:209] layer 9 gpu 1
I0324 05:23:44.172418 3979658 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.004753159824758768 tr(WHW.T) 251.2519073486328
bpp_loss 4.620154142379761
6_q proxy err 0.00127795257139951 tr(WHW.T) 35587.6171875
bpp_loss 3.6998616456985474
6_k proxy err 0.0005075403023511171 tr(WHW.T) 26134.267578125
bpp_loss 4.800027132034302
6_o proxy err 0.01794615015387535 tr(WHW.T) 996.2373657226562
bpp_loss 3.332058906555176
6_up proxy err 0.02103465050458908 tr(WHW.T) 7862.4482421875
bpp_loss 2.9233401162283763
6_gate proxy err 0.005394635256379843 tr(WHW.T) 35640.2578125
bpp_loss 3.1690709250313893
6_down proxy err 0.013690502382814884 tr(WHW.T) 6422.8779296875
bpp_loss 3.324098859514509
I0324 05:23:48.395395 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 9 in 1.0161466598510742s
I0324 05:23:52.133585 3979817 config.py:54] PyTorch version 2.6.0 available.
W0324 05:23:52.464725 3979817 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.0038245527539402246 tr(WHW.T) 307.0851135253906
bpp_loss 4.6189587116241455
7_q proxy err 0.0013220898108556867 tr(WHW.T) 35097.21875
bpp_loss 3.634647250175476
7_k proxy err 0.0005184437613934278 tr(WHW.T) 26820.58203125
bpp_loss 4.777218341827393
7_o proxy err 0.01951014995574951 tr(WHW.T) 945.8643798828125
bpp_loss 3.3330694437026978
7_up proxy err 0.019135121256113052 tr(WHW.T) 8564.646484375
bpp_loss 2.9361731665475026
7_gate proxy err 0.005397091619670391 tr(WHW.T) 34799.35546875
bpp_loss 3.15286009652274
7_down proxy err 0.013945914804935455 tr(WHW.T) 6472.18505859375
bpp_loss 3.3250811781202043
W0324 05:23:53.356506 3979817 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:23:53.360453 3976992 quantize_finetune_llama.py:209] layer 10 gpu 2
I0324 05:23:53.549719 3979817 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:23:55.022869 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 10 in 0.9117574691772461s
I0324 05:23:58.645164 3979932 config.py:54] PyTorch version 2.6.0 available.
W0324 05:23:58.987974 3979932 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:24:00.019545 3979932 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:24:00.023636 3976992 quantize_finetune_llama.py:209] layer 11 gpu 3
I0324 05:24:00.210558 3979932 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:24:01.442981 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 11 in 0.9099693298339844s
I0324 05:24:05.415168 3980054 config.py:54] PyTorch version 2.6.0 available.
W0324 05:24:05.796812 3980054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:24:06.872964 3980054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:24:06.877168 3976992 quantize_finetune_llama.py:209] layer 12 gpu 0
I0324 05:24:07.049728 3980054 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.005077603738754988 tr(WHW.T) 255.12034606933594
bpp_loss 4.618765592575073
8_q proxy err 0.001645233598537743 tr(WHW.T) 26552.91015625
bpp_loss 3.6498838663101196
8_k proxy err 0.0005953686777502298 tr(WHW.T) 22499.31640625
bpp_loss 4.775466442108154
8_o proxy err 0.026164986193180084 tr(WHW.T) 731.734619140625
bpp_loss 3.332460045814514
8_up proxy err 0.019307853654026985 tr(WHW.T) 8432.8056640625
bpp_loss 2.934079170227051
8_gate proxy err 0.005036710295826197 tr(WHW.T) 37132.96875
bpp_loss 3.159291539873396
8_down proxy err 0.013968242332339287 tr(WHW.T) 6426.78076171875
bpp_loss 3.3244141169956754
9_v proxy err 0.005024260841310024 tr(WHW.T) 347.93878173828125
bpp_loss 4.619798183441162
9_q proxy err 0.0017216389533132315 tr(WHW.T) 25605.146484375
bpp_loss 3.642973780632019
9_k proxy err 0.0006540772155858576 tr(WHW.T) 20913.2890625
bpp_loss 4.7571470737457275
9_o proxy err 0.02622947283089161 tr(WHW.T) 760.7015380859375
bpp_loss 3.3568499088287354
9_up proxy err 0.018427032977342606 tr(WHW.T) 8907.26953125
bpp_loss 2.9395433153424944
9_gate proxy err 0.004812158644199371 tr(WHW.T) 39307.90625
bpp_loss 3.1717561994280135
9_down proxy err 0.014582966454327106 tr(WHW.T) 6210.4736328125
bpp_loss 3.3238002913338796
I0324 05:25:04.083280 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 12 in 0.9835777282714844s
I0324 05:25:07.922094 3980698 config.py:54] PyTorch version 2.6.0 available.
W0324 05:25:08.261613 3980698 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.005060157738626003 tr(WHW.T) 249.3217315673828
bpp_loss 4.618832349777222
10_q proxy err 0.001764290384016931 tr(WHW.T) 23288.234375
bpp_loss 3.691444516181946
10_k proxy err 0.0006508130463771522 tr(WHW.T) 19713.98828125
bpp_loss 4.826993465423584
10_o proxy err 0.02645045518875122 tr(WHW.T) 667.1098022460938
bpp_loss 3.3445507287979126
10_up proxy err 0.018162932246923447 tr(WHW.T) 9133.763671875
bpp_loss 2.949614933558873
10_gate proxy err 0.005045364145189524 tr(WHW.T) 37296.734375
bpp_loss 3.144961357116699
10_down proxy err 0.014418555423617363 tr(WHW.T) 6460.98828125
bpp_loss 3.323610544204712
W0324 05:25:09.287160 3980698 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:25:09.291407 3976992 quantize_finetune_llama.py:209] layer 13 gpu 1
I0324 05:25:09.515667 3980698 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:25:10.700615 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 13 in 0.9396483898162842s
I0324 05:25:14.452902 3980818 config.py:54] PyTorch version 2.6.0 available.
W0324 05:25:14.793682 3980818 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.0038961167447268963 tr(WHW.T) 317.10748291015625
bpp_loss 4.619065999984741
11_q proxy err 0.0018996295984834433 tr(WHW.T) 22146.080078125
bpp_loss 3.6091690063476562
11_k proxy err 0.000734088709577918 tr(WHW.T) 17998.236328125
bpp_loss 4.765716791152954
11_o proxy err 0.03174113854765892 tr(WHW.T) 551.7962036132812
bpp_loss 3.3560842275619507
11_up proxy err 0.017831875011324883 tr(WHW.T) 9126.3212890625
bpp_loss 2.9591005870274136
11_gate proxy err 0.0050183916464447975 tr(WHW.T) 36783.98828125
bpp_loss 3.1353111267089844
11_down proxy err 0.014341187663376331 tr(WHW.T) 6590.6376953125
bpp_loss 3.3243864263807024
W0324 05:25:15.771786 3980818 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:25:15.775565 3976992 quantize_finetune_llama.py:209] layer 14 gpu 2
I0324 05:25:15.932497 3980818 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:25:17.445154 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 14 in 1.1045122146606445s
I0324 05:25:21.155514 3980933 config.py:54] PyTorch version 2.6.0 available.
W0324 05:25:21.488591 3980933 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:25:22.433878 3980933 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:25:22.437774 3976992 quantize_finetune_llama.py:209] layer 15 gpu 3
I0324 05:25:22.649995 3980933 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:25:23.772597 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 15 in 0.9312276840209961s
I0324 05:25:27.812832 3981083 config.py:54] PyTorch version 2.6.0 available.
W0324 05:25:28.171795 3981083 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:25:29.245092 3981083 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:25:29.249243 3976992 quantize_finetune_llama.py:209] layer 16 gpu 0
I0324 05:25:29.457852 3981083 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.004775430541485548 tr(WHW.T) 360.1876220703125
bpp_loss 4.618201494216919
12_q proxy err 0.0013786269119009376 tr(WHW.T) 34056.6171875
bpp_loss 3.6018344163894653
12_k proxy err 0.000598767539486289 tr(WHW.T) 23029.2578125
bpp_loss 4.701520681381226
12_o proxy err 0.028159042820334435 tr(WHW.T) 763.9736938476562
bpp_loss 3.337295413017273
12_up proxy err 0.01596968248486519 tr(WHW.T) 9958.251953125
bpp_loss 2.979912485395159
12_gate proxy err 0.0048600235022604465 tr(WHW.T) 37236.3125
bpp_loss 3.127056530543736
12_down proxy err 0.014268741011619568 tr(WHW.T) 6755.458984375
bpp_loss 3.327568360737392
13_v proxy err 0.005281808786094189 tr(WHW.T) 277.2203063964844
bpp_loss 4.620601654052734
13_q proxy err 0.0020148514304310083 tr(WHW.T) 20850.333984375
bpp_loss 3.640978455543518
13_k proxy err 0.000761146133299917 tr(WHW.T) 17769.017578125
bpp_loss 4.7694549560546875
13_o proxy err 0.02927129901945591 tr(WHW.T) 660.1426391601562
bpp_loss 3.350181818008423
13_up proxy err 0.015983164310455322 tr(WHW.T) 9940.990234375
bpp_loss 2.9825003487723216
13_gate proxy err 0.004715323448181152 tr(WHW.T) 38823.03515625
bpp_loss 3.127749443054199
13_down proxy err 0.014870953746140003 tr(WHW.T) 6493.29833984375
bpp_loss 3.3268068858555386
I0324 05:26:25.649367 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 16 in 0.9145975112915039s
I0324 05:26:29.455081 3981724 config.py:54] PyTorch version 2.6.0 available.
W0324 05:26:29.798712 3981724 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:26:30.788625 3981724 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:26:30.792853 3976992 quantize_finetune_llama.py:209] layer 17 gpu 1
14_v proxy err 0.005176627077162266 tr(WHW.T) 278.4633483886719
bpp_loss 4.619379043579102
14_q proxy err 0.00189790443982929 tr(WHW.T) 20836.7890625
bpp_loss 3.6366487741470337
14_k proxy err 0.0006941970787011087 tr(WHW.T) 18589.970703125
bpp_loss 4.799537420272827
14_o proxy err 0.029923342168331146 tr(WHW.T) 671.372314453125
bpp_loss 3.339416980743408
14_up proxy err 0.017053984105587006 tr(WHW.T) 9095.5224609375
bpp_loss 2.9837361744471957
14_gate proxy err 0.004458397626876831 tr(WHW.T) 41682.6328125
bpp_loss 3.151848929268973
14_down proxy err 0.015030771493911743 tr(WHW.T) 6324.00830078125
bpp_loss 3.330253941672189
I0324 05:26:30.952881 3981724 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:26:33.082495 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 17 in 0.9221687316894531s
I0324 05:26:36.940830 3981844 config.py:54] PyTorch version 2.6.0 available.
W0324 05:26:37.251987 3981844 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.00607390096411109 tr(WHW.T) 280.61700439453125
bpp_loss 4.620209455490112
15_q proxy err 0.0016458133468404412 tr(WHW.T) 28024.23046875
bpp_loss 3.7240787744522095
15_k proxy err 0.0007196333608590066 tr(WHW.T) 18843.171875
bpp_loss 4.731275320053101
15_o proxy err 0.02444678358733654 tr(WHW.T) 811.894287109375
bpp_loss 3.3610217571258545
15_up proxy err 0.017590198665857315 tr(WHW.T) 8926.90625
bpp_loss 2.9747208186558316
15_gate proxy err 0.00413123844191432 tr(WHW.T) 46109.49609375
bpp_loss 3.1758569989885603
15_down proxy err 0.01494892593473196 tr(WHW.T) 6333.17138671875
bpp_loss 3.3281066758292064
W0324 05:26:38.147972 3981844 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:26:38.151770 3976992 quantize_finetune_llama.py:209] layer 18 gpu 2
I0324 05:26:38.309486 3981844 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:26:39.509621 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 18 in 0.8923509120941162s
I0324 05:26:43.189420 3981973 config.py:54] PyTorch version 2.6.0 available.
W0324 05:26:43.519790 3981973 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:26:44.470624 3981973 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:26:44.474667 3976992 quantize_finetune_llama.py:209] layer 19 gpu 3
I0324 05:26:44.703721 3981973 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:26:45.983009 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 19 in 1.0607669353485107s
I0324 05:26:49.846796 3982099 config.py:54] PyTorch version 2.6.0 available.
W0324 05:26:50.214814 3982099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:26:51.313333 3982099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:26:51.318090 3976992 quantize_finetune_llama.py:209] layer 20 gpu 0
I0324 05:26:51.539407 3982099 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.00553258927538991 tr(WHW.T) 271.2865905761719
bpp_loss 4.620190858840942
16_q proxy err 0.0016584270633757114 tr(WHW.T) 24435.3515625
bpp_loss 3.71760892868042
16_k proxy err 0.0006413327064365149 tr(WHW.T) 19477.44140625
bpp_loss 4.8148510456085205
16_o proxy err 0.021203702315688133 tr(WHW.T) 953.8026733398438
bpp_loss 3.344510316848755
16_up proxy err 0.0196556206792593 tr(WHW.T) 8265.3720703125
bpp_loss 2.956313133239746
16_gate proxy err 0.004733117762953043 tr(WHW.T) 41062.52734375
bpp_loss 3.1966454642159596
16_down proxy err 0.014906233176589012 tr(WHW.T) 6223.8134765625
bpp_loss 3.3261123384748186
17_v proxy err 0.006455464754253626 tr(WHW.T) 280.3503723144531
bpp_loss 4.61996054649353
17_q proxy err 0.0016242198180407286 tr(WHW.T) 27519.18359375
bpp_loss 3.699446201324463
17_k proxy err 0.0007796747959218919 tr(WHW.T) 17400.5703125
bpp_loss 4.7506327629089355
17_o proxy err 0.018694808706641197 tr(WHW.T) 1090.2861328125
bpp_loss 3.362160325050354
17_up proxy err 0.019664963707327843 tr(WHW.T) 8387.2646484375
bpp_loss 2.949822017124721
17_gate proxy err 0.004741528071463108 tr(WHW.T) 41601.640625
bpp_loss 3.205745424543108
17_down proxy err 0.015143209137022495 tr(WHW.T) 6148.05908203125
bpp_loss 3.324197701045445
I0324 05:27:48.363366 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 20 in 1.1127099990844727s
I0324 05:27:52.248711 3982740 config.py:54] PyTorch version 2.6.0 available.
W0324 05:27:52.578349 3982740 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.005195348057895899 tr(WHW.T) 284.6707763671875
bpp_loss 4.619424819946289
18_q proxy err 0.001967001473531127 tr(WHW.T) 22348.99609375
bpp_loss 3.674549698829651
18_k proxy err 0.0008100782288238406 tr(WHW.T) 17364.087890625
bpp_loss 4.760980844497681
18_o proxy err 0.0167874563485384 tr(WHW.T) 1187.6383056640625
bpp_loss 3.352728486061096
18_up proxy err 0.021438024938106537 tr(WHW.T) 7918.30078125
bpp_loss 2.9388273784092496
18_gate proxy err 0.0056570651941001415 tr(WHW.T) 35127.12890625
bpp_loss 3.2047974722726003
18_down proxy err 0.015041637234389782 tr(WHW.T) 6162.73876953125
bpp_loss 3.3234551634107317
W0324 05:27:53.553781 3982740 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:27:53.557960 3976992 quantize_finetune_llama.py:209] layer 21 gpu 1
I0324 05:27:53.730201 3982740 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:27:55.025598 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 21 in 0.9763648509979248s
I0324 05:27:58.889428 3982856 config.py:54] PyTorch version 2.6.0 available.
W0324 05:27:59.208097 3982856 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.004885516129434109 tr(WHW.T) 337.7576599121094
bpp_loss 4.6203508377075195
19_q proxy err 0.0018910248763859272 tr(WHW.T) 23987.353515625
bpp_loss 3.6666518449783325
19_k proxy err 0.0008792617591097951 tr(WHW.T) 15524.9208984375
bpp_loss 4.707274675369263
19_o proxy err 0.018118958920240402 tr(WHW.T) 1152.94091796875
bpp_loss 3.348460078239441
19_up proxy err 0.02252062037587166 tr(WHW.T) 7585.220703125
bpp_loss 2.9340737206595287
19_gate proxy err 0.006097725126892328 tr(WHW.T) 32694.146484375
bpp_loss 3.210947036743164
19_down proxy err 0.015061537735164165 tr(WHW.T) 6119.1787109375
bpp_loss 3.323309523718698
W0324 05:28:00.143653 3982856 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:28:00.147655 3976992 quantize_finetune_llama.py:209] layer 22 gpu 2
I0324 05:28:00.304903 3982856 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:28:01.536434 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 22 in 0.8308291435241699s
I0324 05:28:05.118013 3982981 config.py:54] PyTorch version 2.6.0 available.
W0324 05:28:05.463466 3982981 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:28:06.519511 3982981 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:28:06.523305 3976992 quantize_finetune_llama.py:209] layer 23 gpu 3
I0324 05:28:06.778662 3982981 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:28:07.794256 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 23 in 0.8198964595794678s
I0324 05:28:11.626751 3983113 config.py:54] PyTorch version 2.6.0 available.
W0324 05:28:11.996324 3983113 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:28:13.074098 3983113 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:28:13.078648 3976992 quantize_finetune_llama.py:209] layer 24 gpu 0
I0324 05:28:13.246994 3983113 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.005580466240644455 tr(WHW.T) 326.5545349121094
bpp_loss 4.619814872741699
20_q proxy err 0.0020527588203549385 tr(WHW.T) 20688.212890625
bpp_loss 3.6725767850875854
20_k proxy err 0.0008515082881785929 tr(WHW.T) 15368.2177734375
bpp_loss 4.713498592376709
20_o proxy err 0.01743509992957115 tr(WHW.T) 1189.504638671875
bpp_loss 3.3450793027877808
20_up proxy err 0.022786391898989677 tr(WHW.T) 7535.15576171875
bpp_loss 2.9353610447474887
20_gate proxy err 0.006527035962790251 tr(WHW.T) 30547.197265625
bpp_loss 3.2100343704223633
20_down proxy err 0.014902242459356785 tr(WHW.T) 6236.83935546875
bpp_loss 3.3232292107173373
21_v proxy err 0.00541108101606369 tr(WHW.T) 358.9937438964844
bpp_loss 4.621592044830322
21_q proxy err 0.001709955045953393 tr(WHW.T) 25789.74609375
bpp_loss 3.649608016014099
21_k proxy err 0.0007994295447133482 tr(WHW.T) 16759.484375
bpp_loss 4.717035531997681
21_o proxy err 0.014955690130591393 tr(WHW.T) 1250.279296875
bpp_loss 3.381101608276367
21_up proxy err 0.022218575701117516 tr(WHW.T) 7707.68359375
bpp_loss 2.9385266985212053
21_gate proxy err 0.006348435766994953 tr(WHW.T) 31446.626953125
bpp_loss 3.2201502663748607
21_down proxy err 0.014849444851279259 tr(WHW.T) 6287.07373046875
bpp_loss 3.3237476348876953
I0324 05:29:09.541378 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 24 in 0.9350264072418213s
I0324 05:29:13.436068 3983741 config.py:54] PyTorch version 2.6.0 available.
W0324 05:29:13.777787 3983741 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.0062804692424833775 tr(WHW.T) 341.7787170410156
bpp_loss 4.6207802295684814
22_q proxy err 0.0019971674773842096 tr(WHW.T) 20273.72265625
bpp_loss 3.638762950897217
22_k proxy err 0.0008579107816331089 tr(WHW.T) 14697.265625
bpp_loss 4.720672607421875
22_o proxy err 0.0195614043623209 tr(WHW.T) 1204.8531494140625
bpp_loss 3.3345969915390015
22_up proxy err 0.023132046684622765 tr(WHW.T) 7481.95849609375
bpp_loss 2.9385690689086914
22_gate proxy err 0.006767474114894867 tr(WHW.T) 29414.359375
bpp_loss 3.219818660191127
22_down proxy err 0.014565052464604378 tr(WHW.T) 6464.6640625
bpp_loss 3.3231912340436662
W0324 05:29:14.784129 3983741 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:29:14.788385 3976992 quantize_finetune_llama.py:209] layer 25 gpu 1
I0324 05:29:14.959664 3983741 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:29:16.400119 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 25 in 1.0310142040252686s
I0324 05:29:20.218302 3983874 config.py:54] PyTorch version 2.6.0 available.
W0324 05:29:20.549132 3983874 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.006068454124033451 tr(WHW.T) 393.136962890625
bpp_loss 4.6190879344940186
23_q proxy err 0.0019695896189659834 tr(WHW.T) 22562.6484375
bpp_loss 3.61357045173645
23_k proxy err 0.000895557226613164 tr(WHW.T) 14830.83203125
bpp_loss 4.667862415313721
23_o proxy err 0.01428508386015892 tr(WHW.T) 1726.8399658203125
bpp_loss 3.334051251411438
23_up proxy err 0.023577839136123657 tr(WHW.T) 7353.39404296875
bpp_loss 2.9411528451102122
23_gate proxy err 0.0072750067338347435 tr(WHW.T) 27171.52734375
bpp_loss 3.2224160603114536
23_down proxy err 0.01439265999943018 tr(WHW.T) 6601.61376953125
bpp_loss 3.3230569703238353
W0324 05:29:21.547308 3983874 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:29:21.551073 3976992 quantize_finetune_llama.py:209] layer 26 gpu 2
I0324 05:29:21.788621 3983874 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:29:22.816747 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 26 in 0.8473484516143799s
I0324 05:29:26.613203 3984001 config.py:54] PyTorch version 2.6.0 available.
W0324 05:29:26.933578 3984001 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:29:27.883949 3984001 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:29:27.887934 3976992 quantize_finetune_llama.py:209] layer 27 gpu 3
I0324 05:29:28.119306 3984001 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:29:29.206008 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 27 in 0.8846287727355957s
I0324 05:29:32.982572 3984133 config.py:54] PyTorch version 2.6.0 available.
W0324 05:29:33.337800 3984133 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:29:34.421268 3984133 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:29:34.425305 3976992 quantize_finetune_llama.py:209] layer 28 gpu 0
I0324 05:29:34.632073 3984133 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.006213089916855097 tr(WHW.T) 461.53338623046875
bpp_loss 4.619931697845459
24_q proxy err 0.0019445568323135376 tr(WHW.T) 22391.330078125
bpp_loss 3.6005125045776367
24_k proxy err 0.0008852618047967553 tr(WHW.T) 14159.3115234375
bpp_loss 4.637167692184448
24_o proxy err 0.01612752676010132 tr(WHW.T) 1570.1973876953125
bpp_loss 3.3540621995925903
24_up proxy err 0.024049583822488785 tr(WHW.T) 7244.748046875
bpp_loss 2.9435679571969167
24_gate proxy err 0.0076767331920564175 tr(WHW.T) 25756.130859375
bpp_loss 3.227194377354213
24_down proxy err 0.014380615204572678 tr(WHW.T) 6675.92578125
bpp_loss 3.3230155876704623
25_v proxy err 0.005274072755128145 tr(WHW.T) 551.988037109375
bpp_loss 4.620040416717529
25_q proxy err 0.0017454418120905757 tr(WHW.T) 26068.671875
bpp_loss 3.570153594017029
25_k proxy err 0.0008685252978466451 tr(WHW.T) 14392.7578125
bpp_loss 4.631900310516357
25_o proxy err 0.012880008667707443 tr(WHW.T) 1970.9990234375
bpp_loss 3.357749342918396
25_up proxy err 0.023777935653924942 tr(WHW.T) 7314.64501953125
bpp_loss 2.9509473528180803
25_gate proxy err 0.007544134743511677 tr(WHW.T) 26184.576171875
bpp_loss 3.236382620675223
25_down proxy err 0.014901991933584213 tr(WHW.T) 6548.80126953125
bpp_loss 3.3230739321027483
I0324 05:30:30.258259 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 28 in 0.9274413585662842s
I0324 05:30:34.094923 3984760 config.py:54] PyTorch version 2.6.0 available.
W0324 05:30:34.437208 3984760 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.007496995851397514 tr(WHW.T) 428.11846923828125
bpp_loss 4.619976758956909
26_q proxy err 0.001973389647901058 tr(WHW.T) 21359.30078125
bpp_loss 3.5998411178588867
26_k proxy err 0.0008210274972952902 tr(WHW.T) 15400.1064453125
bpp_loss 4.671953201293945
26_o proxy err 0.010196363553404808 tr(WHW.T) 2368.438720703125
bpp_loss 3.386422038078308
26_up proxy err 0.022973058745265007 tr(WHW.T) 7577.00390625
bpp_loss 2.9577311107090543
26_gate proxy err 0.00689761433750391 tr(WHW.T) 28776.8671875
bpp_loss 3.244870867047991
26_down proxy err 0.015146034769713879 tr(WHW.T) 6550.5390625
bpp_loss 3.3232040064675465
W0324 05:30:35.400398 3984760 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:30:35.404930 3976992 quantize_finetune_llama.py:209] layer 29 gpu 1
I0324 05:30:35.559246 3984760 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:30:37.250079 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 29 in 0.8376600742340088s
I0324 05:30:41.018503 3984883 config.py:54] PyTorch version 2.6.0 available.
W0324 05:30:41.336994 3984883 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.0055446745827794075 tr(WHW.T) 670.2694702148438
bpp_loss 4.619647026062012
27_q proxy err 0.0020808675326406956 tr(WHW.T) 21263.427734375
bpp_loss 3.5609055757522583
27_k proxy err 0.0009266839479096234 tr(WHW.T) 13986.7197265625
bpp_loss 4.631695747375488
27_o proxy err 0.012205485254526138 tr(WHW.T) 2138.571533203125
bpp_loss 3.3811713457107544
27_up proxy err 0.02099531516432762 tr(WHW.T) 8405.169921875
bpp_loss 2.965724400111607
27_gate proxy err 0.0061571612022817135 tr(WHW.T) 32682.3984375
bpp_loss 3.253262383597238
27_down proxy err 0.014394265599548817 tr(WHW.T) 6473.53173828125
bpp_loss 3.3514324937547957
W0324 05:30:42.247771 3984883 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:30:42.252033 3976992 quantize_finetune_llama.py:209] layer 30 gpu 2
I0324 05:30:42.398487 3984883 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:30:43.497119 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 30 in 0.7949838638305664s
I0324 05:30:47.193714 3984998 config.py:54] PyTorch version 2.6.0 available.
W0324 05:30:47.525744 3984998 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:30:48.495032 3984998 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:30:48.498756 3976992 quantize_finetune_llama.py:209] layer 31 gpu 3
I0324 05:30:48.695680 3984998 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0324 05:30:49.789781 3976992 quantize_finetune_llama.py:240] computed original embedding for layer 31 in 0.9042656421661377s
I0324 05:30:53.659628 3985135 config.py:54] PyTorch version 2.6.0 available.
W0324 05:30:54.038349 3985135 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0324 05:30:55.133269 3985135 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0324 05:30:55.358324 3985135 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.00671917200088501 tr(WHW.T) 593.4841918945312
bpp_loss 4.619899272918701
28_q proxy err 0.0019360494334250689 tr(WHW.T) 23121.322265625
bpp_loss 3.5600136518478394
28_k proxy err 0.0008083123248070478 tr(WHW.T) 14971.62890625
bpp_loss 4.6167213916778564
28_o proxy err 0.010272801853716373 tr(WHW.T) 2488.906494140625
bpp_loss 3.407024621963501
28_up proxy err 0.017247769981622696 tr(WHW.T) 10172.6669921875
bpp_loss 2.985745702471052
28_gate proxy err 0.005577694159001112 tr(WHW.T) 35795.8046875
bpp_loss 3.24838079724993
28_down proxy err 0.013115569949150085 tr(WHW.T) 7137.84375
bpp_loss 3.361688034875052
29_v proxy err 0.0051679364405572414 tr(WHW.T) 841.72265625
bpp_loss 4.620040655136108
29_q proxy err 0.0023989903274923563 tr(WHW.T) 20611.14453125
bpp_loss 3.504369616508484
29_k proxy err 0.0008011841564439237 tr(WHW.T) 16341.0302734375
bpp_loss 4.6268310546875
29_o proxy err 0.007363274693489075 tr(WHW.T) 3078.73974609375
bpp_loss 3.4635543823242188
29_up proxy err 0.013912650756537914 tr(WHW.T) 12790.9697265625
bpp_loss 3.0076699938092912
29_gate proxy err 0.005244217347353697 tr(WHW.T) 38239.99609375
bpp_loss 3.244840349469866
29_down proxy err 0.011295127682387829 tr(WHW.T) 7395.6328125
bpp_loss 3.4066968645368303
30_v proxy err 0.007376533932983875 tr(WHW.T) 850.5265502929688
bpp_loss 4.619788646697998
30_q proxy err 0.0018701826920732856 tr(WHW.T) 24012.384765625
bpp_loss 3.4962345361709595
30_k proxy err 0.0007365882047452033 tr(WHW.T) 14011.546875
bpp_loss 4.616179943084717
30_o proxy err 0.006730150431394577 tr(WHW.T) 4841.5751953125
bpp_loss 3.4169580936431885
30_up proxy err 0.00863473117351532 tr(WHW.T) 21629.68359375
bpp_loss 3.024177278791155
30_gate proxy err 0.00404254999011755 tr(WHW.T) 51821.0
bpp_loss 3.283669880458287
30_down proxy err 0.006810644641518593 tr(WHW.T) 8734.203125
bpp_loss 3.484638180051531
31_v proxy err 0.002788723446428776 tr(WHW.T) 1798.7896728515625
bpp_loss 4.621227502822876
31_q proxy err 0.0012492194073274732 tr(WHW.T) 46129.50390625
bpp_loss 3.536065697669983
31_k proxy err 0.0005975998938083649 tr(WHW.T) 20445.06640625
bpp_loss 4.632885217666626
31_o proxy err 0.007286673411726952 tr(WHW.T) 2186.682373046875
bpp_loss 3.5691425800323486
31_up proxy err 0.0031234677881002426 tr(WHW.T) 68909.6796875
bpp_loss 3.163404737200056
31_gate proxy err 0.0016738934209570289 tr(WHW.T) 144279.1875
bpp_loss 3.4561401094709123
31_down proxy err 0.003115868428722024 tr(WHW.T) 9879.267578125
bpp_loss 3.582481724875314
I0324 05:32:12.122547 3985951 config.py:54] PyTorch version 2.6.0 available.
W0324 05:32:12.426627 3985951 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 05:32:12.682744 3985951 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  3.17it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:01,  3.70it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:01,  3.97it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  4.48it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:01<00:00,  4.83it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  5.07it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.93it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  4.56it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:01,  4.80it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  5.48it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  5.59it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  5.60it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  5.70it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:01<00:00,  5.67it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:01<00:00,  5.42it/s]
I0324 05:32:17.390534 3985951 hfize_llama.py:153] loaded layer 0
I0324 05:32:18.362267 3985951 hfize_llama.py:153] loaded layer 1
I0324 05:32:19.050574 3985951 hfize_llama.py:153] loaded layer 2
I0324 05:32:19.684284 3985951 hfize_llama.py:153] loaded layer 3
I0324 05:32:20.338701 3985951 hfize_llama.py:153] loaded layer 4
I0324 05:32:20.981664 3985951 hfize_llama.py:153] loaded layer 5
I0324 05:32:21.593468 3985951 hfize_llama.py:153] loaded layer 6
I0324 05:32:22.214756 3985951 hfize_llama.py:153] loaded layer 7
I0324 05:32:22.880377 3985951 hfize_llama.py:153] loaded layer 8
I0324 05:32:23.524436 3985951 hfize_llama.py:153] loaded layer 9
I0324 05:32:24.179147 3985951 hfize_llama.py:153] loaded layer 10
I0324 05:32:24.827053 3985951 hfize_llama.py:153] loaded layer 11
I0324 05:32:25.461823 3985951 hfize_llama.py:153] loaded layer 12
I0324 05:32:26.134669 3985951 hfize_llama.py:153] loaded layer 13
I0324 05:32:26.739389 3985951 hfize_llama.py:153] loaded layer 14
I0324 05:32:27.344571 3985951 hfize_llama.py:153] loaded layer 15
I0324 05:32:27.963473 3985951 hfize_llama.py:153] loaded layer 16
I0324 05:32:28.573505 3985951 hfize_llama.py:153] loaded layer 17
I0324 05:32:29.228606 3985951 hfize_llama.py:153] loaded layer 18
I0324 05:32:29.844840 3985951 hfize_llama.py:153] loaded layer 19
I0324 05:32:30.417578 3985951 hfize_llama.py:153] loaded layer 20
I0324 05:32:31.033038 3985951 hfize_llama.py:153] loaded layer 21
I0324 05:32:31.639882 3985951 hfize_llama.py:153] loaded layer 22
I0324 05:32:32.243787 3985951 hfize_llama.py:153] loaded layer 23
I0324 05:32:32.830101 3985951 hfize_llama.py:153] loaded layer 24
I0324 05:32:33.395794 3985951 hfize_llama.py:153] loaded layer 25
I0324 05:32:33.951393 3985951 hfize_llama.py:153] loaded layer 26
I0324 05:32:34.568091 3985951 hfize_llama.py:153] loaded layer 27
I0324 05:32:35.174073 3985951 hfize_llama.py:153] loaded layer 28
I0324 05:32:35.749273 3985951 hfize_llama.py:153] loaded layer 29
I0324 05:32:36.339764 3985951 hfize_llama.py:153] loaded layer 30
I0324 05:32:36.917240 3985951 hfize_llama.py:153] loaded layer 31
I0324 05:32:36.917377 3985951 hfize_llama.py:157] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:06,  1.12s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:01<00:04,  1.11it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:02<00:03,  1.12it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.13s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.20s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:01,  1.21s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.01it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.05s/it]
I0324 05:33:18.692589 3985951 hfize_llama.py:167] successfully loaded hfized model
W0324 05:33:22.814019 3986870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0324 05:33:23.295177 3986870 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:08,  1.36s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:06,  1.28s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:05,  1.26s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:06<00:05,  1.68s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:07<00:03,  1.67s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:09<00:01,  1.56s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:09<00:00,  1.29s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:09<00:00,  1.41s/it]
I0324 05:33:33.620466 3986870 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.6876835823059082:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.6876835823059082:   1%|          | 1/141 [00:01<04:18,  1.84s/it]avg_loss = 1.9838056564331055:   1%|          | 1/141 [00:03<04:18,  1.84s/it]avg_loss = 1.9838056564331055:   1%|▏         | 2/141 [00:03<03:44,  1.61s/it]avg_loss = 2.1076579888661704:   1%|▏         | 2/141 [00:04<03:44,  1.61s/it]avg_loss = 2.1076579888661704:   2%|▏         | 3/141 [00:04<03:33,  1.55s/it]avg_loss = 2.05839940905571:   2%|▏         | 3/141 [00:06<03:33,  1.55s/it]  avg_loss = 2.05839940905571:   3%|▎         | 4/141 [00:06<03:28,  1.52s/it]avg_loss = 2.0084033489227293:   3%|▎         | 4/141 [00:07<03:28,  1.52s/it]avg_loss = 2.0084033489227293:   4%|▎         | 5/141 [00:07<03:24,  1.51s/it]avg_loss = 1.9126509030659993:   4%|▎         | 5/141 [00:09<03:24,  1.51s/it]avg_loss = 1.9126509030659993:   4%|▍         | 6/141 [00:09<03:22,  1.50s/it]avg_loss = 1.8490981204169137:   4%|▍         | 6/141 [00:10<03:22,  1.50s/it]avg_loss = 1.8490981204169137:   5%|▍         | 7/141 [00:10<03:20,  1.50s/it]avg_loss = 1.842940241098404:   5%|▍         | 7/141 [00:12<03:20,  1.50s/it] avg_loss = 1.842940241098404:   6%|▌         | 8/141 [00:12<03:19,  1.50s/it]avg_loss = 1.87601727909512:   6%|▌         | 8/141 [00:13<03:19,  1.50s/it] avg_loss = 1.87601727909512:   6%|▋         | 9/141 [00:13<03:17,  1.50s/it]avg_loss = 1.877603030204773:   6%|▋         | 9/141 [00:15<03:17,  1.50s/it]avg_loss = 1.877603030204773:   7%|▋         | 10/141 [00:15<03:16,  1.50s/it]avg_loss = 1.8707433505491777:   7%|▋         | 10/141 [00:16<03:16,  1.50s/it]avg_loss = 1.8707433505491777:   8%|▊         | 11/141 [00:16<03:15,  1.50s/it]avg_loss = 1.8935938775539398:   8%|▊         | 11/141 [00:18<03:15,  1.50s/it]avg_loss = 1.8935938775539398:   9%|▊         | 12/141 [00:18<03:13,  1.50s/it]avg_loss = 1.9060662067853487:   9%|▊         | 12/141 [00:19<03:13,  1.50s/it]avg_loss = 1.9060662067853487:   9%|▉         | 13/141 [00:19<03:12,  1.51s/it]avg_loss = 1.9224227922303336:   9%|▉         | 13/141 [00:21<03:12,  1.51s/it]avg_loss = 1.9224227922303336:  10%|▉         | 14/141 [00:21<03:11,  1.51s/it]avg_loss = 1.9327670335769653:  10%|▉         | 14/141 [00:22<03:11,  1.51s/it]avg_loss = 1.9327670335769653:  11%|█         | 15/141 [00:22<03:10,  1.51s/it]avg_loss = 1.9558920189738274:  11%|█         | 15/141 [00:24<03:10,  1.51s/it]avg_loss = 1.9558920189738274:  11%|█▏        | 16/141 [00:24<03:09,  1.51s/it]avg_loss = 1.9579040653565352:  11%|█▏        | 16/141 [00:25<03:09,  1.51s/it]avg_loss = 1.9579040653565352:  12%|█▏        | 17/141 [00:25<03:07,  1.52s/it]avg_loss = 1.9622354043854608:  12%|█▏        | 17/141 [00:27<03:07,  1.52s/it]avg_loss = 1.9622354043854608:  13%|█▎        | 18/141 [00:27<03:06,  1.52s/it]avg_loss = 1.950699436037164:  13%|█▎        | 18/141 [00:28<03:06,  1.52s/it] avg_loss = 1.950699436037164:  13%|█▎        | 19/141 [00:28<03:05,  1.52s/it]avg_loss = 1.9500354468822478:  13%|█▎        | 19/141 [00:30<03:05,  1.52s/it]avg_loss = 1.9500354468822478:  14%|█▍        | 20/141 [00:30<03:04,  1.53s/it]avg_loss = 1.954168132373265:  14%|█▍        | 20/141 [00:31<03:04,  1.53s/it] avg_loss = 1.954168132373265:  15%|█▍        | 21/141 [00:31<03:03,  1.53s/it]avg_loss = 1.9563195217739453:  15%|█▍        | 21/141 [00:33<03:03,  1.53s/it]avg_loss = 1.9563195217739453:  16%|█▌        | 22/141 [00:33<03:02,  1.53s/it]avg_loss = 1.9574683541836946:  16%|█▌        | 22/141 [00:34<03:02,  1.53s/it]avg_loss = 1.9574683541836946:  16%|█▋        | 23/141 [00:34<03:00,  1.53s/it]avg_loss = 1.9620662530263264:  16%|█▋        | 23/141 [00:36<03:00,  1.53s/it]avg_loss = 1.9620662530263264:  17%|█▋        | 24/141 [00:36<02:59,  1.54s/it]avg_loss = 1.9670223140716552:  17%|█▋        | 24/141 [00:38<02:59,  1.54s/it]avg_loss = 1.9670223140716552:  18%|█▊        | 25/141 [00:38<02:58,  1.54s/it]avg_loss = 1.9777262394244854:  18%|█▊        | 25/141 [00:39<02:58,  1.54s/it]avg_loss = 1.9777262394244854:  18%|█▊        | 26/141 [00:39<02:57,  1.54s/it]avg_loss = 1.989607369458234:  18%|█▊        | 26/141 [00:41<02:57,  1.54s/it] avg_loss = 1.989607369458234:  19%|█▉        | 27/141 [00:41<02:56,  1.55s/it]avg_loss = 1.9949063999312264:  19%|█▉        | 27/141 [00:42<02:56,  1.55s/it]avg_loss = 1.9949063999312264:  20%|█▉        | 28/141 [00:42<02:54,  1.55s/it]avg_loss = 1.9918624738167072:  20%|█▉        | 28/141 [00:44<02:54,  1.55s/it]avg_loss = 1.9918624738167072:  21%|██        | 29/141 [00:44<02:53,  1.55s/it]avg_loss = 1.982414150238037:  21%|██        | 29/141 [00:45<02:53,  1.55s/it] avg_loss = 1.982414150238037:  21%|██▏       | 30/141 [00:45<02:52,  1.55s/it]avg_loss = 1.9689310096925305:  21%|██▏       | 30/141 [00:47<02:52,  1.55s/it]avg_loss = 1.9689310096925305:  22%|██▏       | 31/141 [00:47<02:50,  1.55s/it]avg_loss = 1.9576998837292194:  22%|██▏       | 31/141 [00:48<02:50,  1.55s/it]avg_loss = 1.9576998837292194:  23%|██▎       | 32/141 [00:48<02:49,  1.55s/it]avg_loss = 1.9555697549473157:  23%|██▎       | 32/141 [00:50<02:49,  1.55s/it]avg_loss = 1.9555697549473157:  23%|██▎       | 33/141 [00:50<02:47,  1.55s/it]avg_loss = 1.9534752894850338:  23%|██▎       | 33/141 [00:52<02:47,  1.55s/it]avg_loss = 1.9534752894850338:  24%|██▍       | 34/141 [00:52<02:46,  1.56s/it]avg_loss = 1.9559468507766724:  24%|██▍       | 34/141 [00:53<02:46,  1.56s/it]avg_loss = 1.9559468507766724:  25%|██▍       | 35/141 [00:53<02:45,  1.56s/it]avg_loss = 1.9396464692221747:  25%|██▍       | 35/141 [00:55<02:45,  1.56s/it]avg_loss = 1.9396464692221747:  26%|██▌       | 36/141 [00:55<02:43,  1.56s/it]avg_loss = 1.9243135806676503:  26%|██▌       | 36/141 [00:56<02:43,  1.56s/it]avg_loss = 1.9243135806676503:  26%|██▌       | 37/141 [00:56<02:42,  1.56s/it]avg_loss = 1.9092988340478194:  26%|██▌       | 37/141 [00:58<02:42,  1.56s/it]avg_loss = 1.9092988340478194:  27%|██▋       | 38/141 [00:58<02:40,  1.56s/it]avg_loss = 1.8953186793205066:  27%|██▋       | 38/141 [00:59<02:40,  1.56s/it]avg_loss = 1.8953186793205066:  28%|██▊       | 39/141 [00:59<02:39,  1.56s/it]avg_loss = 1.8866053819656372:  28%|██▊       | 39/141 [01:01<02:39,  1.56s/it]avg_loss = 1.8866053819656372:  28%|██▊       | 40/141 [01:01<02:38,  1.56s/it]avg_loss = 1.8923285240080299:  28%|██▊       | 40/141 [01:03<02:38,  1.56s/it]avg_loss = 1.8923285240080299:  29%|██▉       | 41/141 [01:03<02:36,  1.56s/it]avg_loss = 1.9089347067333402:  29%|██▉       | 41/141 [01:04<02:36,  1.56s/it]avg_loss = 1.9089347067333402:  30%|██▉       | 42/141 [01:04<02:34,  1.57s/it]avg_loss = 1.9247443287871604:  30%|██▉       | 42/141 [01:06<02:34,  1.57s/it]avg_loss = 1.9247443287871604:  30%|███       | 43/141 [01:06<02:33,  1.57s/it]avg_loss = 1.9286325736479326:  30%|███       | 43/141 [01:07<02:33,  1.57s/it]avg_loss = 1.9286325736479326:  31%|███       | 44/141 [01:07<02:31,  1.57s/it]avg_loss = 1.9333506531185574:  31%|███       | 44/141 [01:09<02:31,  1.57s/it]avg_loss = 1.9333506531185574:  32%|███▏      | 45/141 [01:09<02:30,  1.57s/it]avg_loss = 1.9383396687714949:  32%|███▏      | 45/141 [01:10<02:30,  1.57s/it]avg_loss = 1.9383396687714949:  33%|███▎      | 46/141 [01:10<02:29,  1.57s/it]avg_loss = 1.9443451343698706:  33%|███▎      | 46/141 [01:12<02:29,  1.57s/it]avg_loss = 1.9443451343698706:  33%|███▎      | 47/141 [01:12<02:27,  1.57s/it]avg_loss = 1.9471656382083893:  33%|███▎      | 47/141 [01:14<02:27,  1.57s/it]avg_loss = 1.9471656382083893:  34%|███▍      | 48/141 [01:14<02:26,  1.58s/it]avg_loss = 1.9461232910350876:  34%|███▍      | 48/141 [01:15<02:26,  1.58s/it]avg_loss = 1.9461232910350876:  35%|███▍      | 49/141 [01:15<02:25,  1.58s/it]avg_loss = 1.9457436609268188:  35%|███▍      | 49/141 [01:17<02:25,  1.58s/it]avg_loss = 1.9457436609268188:  35%|███▌      | 50/141 [01:17<02:23,  1.58s/it]avg_loss = 1.9396319015353334:  35%|███▌      | 50/141 [01:18<02:23,  1.58s/it]avg_loss = 1.9396319015353334:  36%|███▌      | 51/141 [01:18<02:22,  1.58s/it]avg_loss = 1.9355858610226557:  36%|███▌      | 51/141 [01:20<02:22,  1.58s/it]avg_loss = 1.9355858610226557:  37%|███▋      | 52/141 [01:20<02:20,  1.58s/it]avg_loss = 1.9285828909783993:  37%|███▋      | 52/141 [01:21<02:20,  1.58s/it]avg_loss = 1.9285828909783993:  38%|███▊      | 53/141 [01:21<02:19,  1.58s/it]avg_loss = 1.9254654005721763:  38%|███▊      | 53/141 [01:23<02:19,  1.58s/it]avg_loss = 1.9254654005721763:  38%|███▊      | 54/141 [01:23<02:17,  1.58s/it]avg_loss = 1.9177828160199253:  38%|███▊      | 54/141 [01:25<02:17,  1.58s/it]avg_loss = 1.9177828160199253:  39%|███▉      | 55/141 [01:25<02:16,  1.58s/it]avg_loss = 1.910078661782401:  39%|███▉      | 55/141 [01:26<02:16,  1.58s/it] avg_loss = 1.910078661782401:  40%|███▉      | 56/141 [01:26<02:14,  1.58s/it]avg_loss = 1.9056445171958523:  40%|███▉      | 56/141 [01:28<02:14,  1.58s/it]avg_loss = 1.9056445171958523:  40%|████      | 57/141 [01:28<02:12,  1.58s/it]avg_loss = 1.9026541093300129:  40%|████      | 57/141 [01:29<02:12,  1.58s/it]avg_loss = 1.9026541093300129:  41%|████      | 58/141 [01:29<02:11,  1.58s/it]avg_loss = 1.9050496756020239:  41%|████      | 58/141 [01:31<02:11,  1.58s/it]avg_loss = 1.9050496756020239:  42%|████▏     | 59/141 [01:31<02:09,  1.58s/it]avg_loss = 1.910455346107483:  42%|████▏     | 59/141 [01:33<02:09,  1.58s/it] avg_loss = 1.910455346107483:  43%|████▎     | 60/141 [01:33<02:08,  1.58s/it]avg_loss = 1.9161044769599789:  43%|████▎     | 60/141 [01:34<02:08,  1.58s/it]avg_loss = 1.9161044769599789:  43%|████▎     | 61/141 [01:34<02:06,  1.58s/it]avg_loss = 1.9231942046073176:  43%|████▎     | 61/141 [01:36<02:06,  1.58s/it]avg_loss = 1.9231942046073176:  44%|████▍     | 62/141 [01:36<02:05,  1.58s/it]avg_loss = 1.914553857984997:  44%|████▍     | 62/141 [01:37<02:05,  1.58s/it] avg_loss = 1.914553857984997:  45%|████▍     | 63/141 [01:37<02:03,  1.59s/it]avg_loss = 1.9122883211821318:  45%|████▍     | 63/141 [01:39<02:03,  1.59s/it]avg_loss = 1.9122883211821318:  45%|████▌     | 64/141 [01:39<02:02,  1.59s/it]avg_loss = 1.909664876644428:  45%|████▌     | 64/141 [01:40<02:02,  1.59s/it] avg_loss = 1.909664876644428:  46%|████▌     | 65/141 [01:40<02:00,  1.59s/it]avg_loss = 1.903748757911451:  46%|████▌     | 65/141 [01:42<02:00,  1.59s/it]avg_loss = 1.903748757911451:  47%|████▋     | 66/141 [01:42<01:58,  1.59s/it]avg_loss = 1.9008326672795992:  47%|████▋     | 66/141 [01:44<01:58,  1.59s/it]avg_loss = 1.9008326672795992:  48%|████▊     | 67/141 [01:44<01:57,  1.59s/it]avg_loss = 1.8974166617673986:  48%|████▊     | 67/141 [01:45<01:57,  1.59s/it]avg_loss = 1.8974166617673986:  48%|████▊     | 68/141 [01:45<01:55,  1.59s/it]avg_loss = 1.8948491310727769:  48%|████▊     | 68/141 [01:47<01:55,  1.59s/it]avg_loss = 1.8948491310727769:  49%|████▉     | 69/141 [01:47<01:54,  1.59s/it]avg_loss = 1.895949445452009:  49%|████▉     | 69/141 [01:48<01:54,  1.59s/it] avg_loss = 1.895949445452009:  50%|████▉     | 70/141 [01:48<01:52,  1.59s/it]avg_loss = 1.8997118640953385:  50%|████▉     | 70/141 [01:50<01:52,  1.59s/it]avg_loss = 1.8997118640953385:  50%|█████     | 71/141 [01:50<01:51,  1.59s/it]avg_loss = 1.9019942647880979:  50%|█████     | 71/141 [01:52<01:51,  1.59s/it]avg_loss = 1.9019942647880979:  51%|█████     | 72/141 [01:52<01:49,  1.59s/it]avg_loss = 1.9005526875796384:  51%|█████     | 72/141 [01:53<01:49,  1.59s/it]avg_loss = 1.9005526875796384:  52%|█████▏    | 73/141 [01:53<01:48,  1.59s/it]avg_loss = 1.9022061857017312:  52%|█████▏    | 73/141 [01:55<01:48,  1.59s/it]avg_loss = 1.9022061857017312:  52%|█████▏    | 74/141 [01:55<01:46,  1.59s/it]avg_loss = 1.9020246807734171:  52%|█████▏    | 74/141 [01:56<01:46,  1.59s/it]avg_loss = 1.9020246807734171:  53%|█████▎    | 75/141 [01:56<01:45,  1.59s/it]avg_loss = 1.9005896056953229:  53%|█████▎    | 75/141 [01:58<01:45,  1.59s/it]avg_loss = 1.9005896056953229:  54%|█████▍    | 76/141 [01:58<01:43,  1.59s/it]avg_loss = 1.9017258526442886:  54%|█████▍    | 76/141 [02:00<01:43,  1.59s/it]avg_loss = 1.9017258526442886:  55%|█████▍    | 77/141 [02:00<01:41,  1.59s/it]avg_loss = 1.9041170340317946:  55%|█████▍    | 77/141 [02:01<01:41,  1.59s/it]avg_loss = 1.9041170340317946:  55%|█████▌    | 78/141 [02:01<01:40,  1.59s/it]avg_loss = 1.907923616940462:  55%|█████▌    | 78/141 [02:03<01:40,  1.59s/it] avg_loss = 1.907923616940462:  56%|█████▌    | 79/141 [02:03<01:38,  1.59s/it]avg_loss = 1.904360356926918:  56%|█████▌    | 79/141 [02:04<01:38,  1.59s/it]avg_loss = 1.904360356926918:  57%|█████▋    | 80/141 [02:04<01:37,  1.59s/it]avg_loss = 1.9030266911895186:  57%|█████▋    | 80/141 [02:06<01:37,  1.59s/it]avg_loss = 1.9030266911895186:  57%|█████▋    | 81/141 [02:06<01:35,  1.59s/it]avg_loss = 1.9020633871962385:  57%|█████▋    | 81/141 [02:08<01:35,  1.59s/it]avg_loss = 1.9020633871962385:  58%|█████▊    | 82/141 [02:08<01:33,  1.59s/it]avg_loss = 1.900212270667754:  58%|█████▊    | 82/141 [02:09<01:33,  1.59s/it] avg_loss = 1.900212270667754:  59%|█████▉    | 83/141 [02:09<01:32,  1.59s/it]avg_loss = 1.8980674743652344:  59%|█████▉    | 83/141 [02:11<01:32,  1.59s/it]avg_loss = 1.8980674743652344:  60%|█████▉    | 84/141 [02:11<01:30,  1.59s/it]avg_loss = 1.8957353886436015:  60%|█████▉    | 84/141 [02:12<01:30,  1.59s/it]avg_loss = 1.8957353886436015:  60%|██████    | 85/141 [02:12<01:29,  1.59s/it]avg_loss = 1.897497225639432:  60%|██████    | 85/141 [02:14<01:29,  1.59s/it] avg_loss = 1.897497225639432:  61%|██████    | 86/141 [02:14<01:27,  1.59s/it]avg_loss = 1.899365245610818:  61%|██████    | 86/141 [02:15<01:27,  1.59s/it]avg_loss = 1.899365245610818:  62%|██████▏   | 87/141 [02:15<01:26,  1.60s/it]avg_loss = 1.9001246948133816:  62%|██████▏   | 87/141 [02:17<01:26,  1.60s/it]avg_loss = 1.9001246948133816:  62%|██████▏   | 88/141 [02:17<01:24,  1.60s/it]avg_loss = 1.9087810797637768:  62%|██████▏   | 88/141 [02:19<01:24,  1.60s/it]avg_loss = 1.9087810797637768:  63%|██████▎   | 89/141 [02:19<01:23,  1.60s/it]avg_loss = 1.9160659670829774:  63%|██████▎   | 89/141 [02:20<01:23,  1.60s/it]avg_loss = 1.9160659670829774:  64%|██████▍   | 90/141 [02:20<01:21,  1.60s/it]avg_loss = 1.9191061022517446:  64%|██████▍   | 90/141 [02:22<01:21,  1.60s/it]avg_loss = 1.9191061022517446:  65%|██████▍   | 91/141 [02:22<01:19,  1.60s/it]avg_loss = 1.9241678183493407:  65%|██████▍   | 91/141 [02:23<01:19,  1.60s/it]avg_loss = 1.9241678183493407:  65%|██████▌   | 92/141 [02:23<01:18,  1.60s/it]avg_loss = 1.9291141584355345:  65%|██████▌   | 92/141 [02:25<01:18,  1.60s/it]avg_loss = 1.9291141584355345:  66%|██████▌   | 93/141 [02:25<01:16,  1.60s/it]avg_loss = 1.9298969925718104:  66%|██████▌   | 93/141 [02:27<01:16,  1.60s/it]avg_loss = 1.9298969925718104:  67%|██████▋   | 94/141 [02:27<01:15,  1.60s/it]avg_loss = 1.933702580552352:  67%|██████▋   | 94/141 [02:28<01:15,  1.60s/it] avg_loss = 1.933702580552352:  67%|██████▋   | 95/141 [02:28<01:13,  1.60s/it]avg_loss = 1.934728569040696:  67%|██████▋   | 95/141 [02:30<01:13,  1.60s/it]avg_loss = 1.934728569040696:  68%|██████▊   | 96/141 [02:30<01:11,  1.60s/it]avg_loss = 1.93646076413774:  68%|██████▊   | 96/141 [02:31<01:11,  1.60s/it] avg_loss = 1.93646076413774:  69%|██████▉   | 97/141 [02:31<01:10,  1.60s/it]avg_loss = 1.933465185214062:  69%|██████▉   | 97/141 [02:33<01:10,  1.60s/it]avg_loss = 1.933465185214062:  70%|██████▉   | 98/141 [02:33<01:08,  1.60s/it]avg_loss = 1.9342464521677807:  70%|██████▉   | 98/141 [02:35<01:08,  1.60s/it]avg_loss = 1.9342464521677807:  70%|███████   | 99/141 [02:35<01:07,  1.60s/it]avg_loss = 1.9368056976795196:  70%|███████   | 99/141 [02:36<01:07,  1.60s/it]avg_loss = 1.9368056976795196:  71%|███████   | 100/141 [02:36<01:05,  1.60s/it]avg_loss = 1.9358988362963836:  71%|███████   | 100/141 [02:38<01:05,  1.60s/it]avg_loss = 1.9358988362963836:  72%|███████▏  | 101/141 [02:38<01:03,  1.60s/it]avg_loss = 1.9363008784312827:  72%|███████▏  | 101/141 [02:39<01:03,  1.60s/it]avg_loss = 1.9363008784312827:  72%|███████▏  | 102/141 [02:39<01:02,  1.60s/it]avg_loss = 1.9351564819372973:  72%|███████▏  | 102/141 [02:41<01:02,  1.60s/it]avg_loss = 1.9351564819372973:  73%|███████▎  | 103/141 [02:41<01:00,  1.59s/it]avg_loss = 1.9381868564165556:  73%|███████▎  | 103/141 [02:43<01:00,  1.59s/it]avg_loss = 1.9381868564165556:  74%|███████▍  | 104/141 [02:43<00:59,  1.60s/it]avg_loss = 1.9376762026832217:  74%|███████▍  | 104/141 [02:44<00:59,  1.60s/it]avg_loss = 1.9376762026832217:  74%|███████▍  | 105/141 [02:44<00:57,  1.60s/it]avg_loss = 1.9368648405344981:  74%|███████▍  | 105/141 [02:46<00:57,  1.60s/it]avg_loss = 1.9368648405344981:  75%|███████▌  | 106/141 [02:46<00:55,  1.60s/it]avg_loss = 1.9347068929226598:  75%|███████▌  | 106/141 [02:47<00:55,  1.60s/it]avg_loss = 1.9347068929226598:  76%|███████▌  | 107/141 [02:47<00:54,  1.60s/it]avg_loss = 1.9328250564910747:  76%|███████▌  | 107/141 [02:49<00:54,  1.60s/it]avg_loss = 1.9328250564910747:  77%|███████▋  | 108/141 [02:49<00:52,  1.60s/it]avg_loss = 1.9305121056530454:  77%|███████▋  | 108/141 [02:51<00:52,  1.60s/it]avg_loss = 1.9305121056530454:  77%|███████▋  | 109/141 [02:51<00:51,  1.60s/it]avg_loss = 1.9280558401888066:  77%|███████▋  | 109/141 [02:52<00:51,  1.60s/it]avg_loss = 1.9280558401888066:  78%|███████▊  | 110/141 [02:52<00:49,  1.60s/it]avg_loss = 1.9304108136409037:  78%|███████▊  | 110/141 [02:54<00:49,  1.60s/it]avg_loss = 1.9304108136409037:  79%|███████▊  | 111/141 [02:54<00:47,  1.60s/it]avg_loss = 1.9302013484495026:  79%|███████▊  | 111/141 [02:55<00:47,  1.60s/it]avg_loss = 1.9302013484495026:  79%|███████▉  | 112/141 [02:55<00:46,  1.60s/it]avg_loss = 1.931337486326167:  79%|███████▉  | 112/141 [02:57<00:46,  1.60s/it] avg_loss = 1.931337486326167:  80%|████████  | 113/141 [02:57<00:44,  1.60s/it]avg_loss = 1.9323559779869883:  80%|████████  | 113/141 [02:59<00:44,  1.60s/it]avg_loss = 1.9323559779869883:  81%|████████  | 114/141 [02:59<00:43,  1.60s/it]avg_loss = 1.9316919741423233:  81%|████████  | 114/141 [03:00<00:43,  1.60s/it]avg_loss = 1.9316919741423233:  82%|████████▏ | 115/141 [03:00<00:41,  1.59s/it]avg_loss = 1.9302654348570725:  82%|████████▏ | 115/141 [03:02<00:41,  1.59s/it]avg_loss = 1.9302654348570725:  82%|████████▏ | 116/141 [03:02<00:39,  1.59s/it]avg_loss = 1.9323343272902007:  82%|████████▏ | 116/141 [03:03<00:39,  1.59s/it]avg_loss = 1.9323343272902007:  83%|████████▎ | 117/141 [03:03<00:38,  1.60s/it]avg_loss = 1.9319387219719968:  83%|████████▎ | 117/141 [03:05<00:38,  1.60s/it]avg_loss = 1.9319387219719968:  84%|████████▎ | 118/141 [03:05<00:36,  1.60s/it]avg_loss = 1.9304054785175484:  84%|████████▎ | 118/141 [03:07<00:36,  1.60s/it]avg_loss = 1.9304054785175484:  84%|████████▍ | 119/141 [03:07<00:35,  1.60s/it]avg_loss = 1.9285398165384928:  84%|████████▍ | 119/141 [03:08<00:35,  1.60s/it]avg_loss = 1.9285398165384928:  85%|████████▌ | 120/141 [03:08<00:33,  1.60s/it]avg_loss = 1.9284321463797702:  85%|████████▌ | 120/141 [03:10<00:33,  1.60s/it]avg_loss = 1.9284321463797702:  86%|████████▌ | 121/141 [03:10<00:31,  1.60s/it]avg_loss = 1.9289709857252777:  86%|████████▌ | 121/141 [03:11<00:31,  1.60s/it]avg_loss = 1.9289709857252777:  87%|████████▋ | 122/141 [03:11<00:30,  1.60s/it]avg_loss = 1.9287064908965816:  87%|████████▋ | 122/141 [03:13<00:30,  1.60s/it]avg_loss = 1.9287064908965816:  87%|████████▋ | 123/141 [03:13<00:28,  1.60s/it]avg_loss = 1.9288729294653861:  87%|████████▋ | 123/141 [03:15<00:28,  1.60s/it]avg_loss = 1.9288729294653861:  88%|████████▊ | 124/141 [03:15<00:27,  1.60s/it]avg_loss = 1.9275135488510131:  88%|████████▊ | 124/141 [03:16<00:27,  1.60s/it]avg_loss = 1.9275135488510131:  89%|████████▊ | 125/141 [03:16<00:25,  1.60s/it]avg_loss = 1.9278940236757671:  89%|████████▊ | 125/141 [03:18<00:25,  1.60s/it]avg_loss = 1.9278940236757671:  89%|████████▉ | 126/141 [03:18<00:23,  1.60s/it]avg_loss = 1.9275353311553716:  89%|████████▉ | 126/141 [03:19<00:23,  1.60s/it]avg_loss = 1.9275353311553716:  90%|█████████ | 127/141 [03:19<00:22,  1.60s/it]avg_loss = 1.9263508459553123:  90%|█████████ | 127/141 [03:21<00:22,  1.60s/it]avg_loss = 1.9263508459553123:  91%|█████████ | 128/141 [03:21<00:20,  1.60s/it]avg_loss = 1.9264158888380656:  91%|█████████ | 128/141 [03:23<00:20,  1.60s/it]avg_loss = 1.9264158888380656:  91%|█████████▏| 129/141 [03:23<00:19,  1.60s/it]avg_loss = 1.9273817245776836:  91%|█████████▏| 129/141 [03:24<00:19,  1.60s/it]avg_loss = 1.9273817245776836:  92%|█████████▏| 130/141 [03:24<00:17,  1.60s/it]avg_loss = 1.9282346172187164:  92%|█████████▏| 130/141 [03:26<00:17,  1.60s/it]avg_loss = 1.9282346172187164:  93%|█████████▎| 131/141 [03:26<00:15,  1.60s/it]avg_loss = 1.9288454471212444:  93%|█████████▎| 131/141 [03:27<00:15,  1.60s/it]avg_loss = 1.9288454471212444:  94%|█████████▎| 132/141 [03:27<00:14,  1.60s/it]avg_loss = 1.9259644128326188:  94%|█████████▎| 132/141 [03:29<00:14,  1.60s/it]avg_loss = 1.9259644128326188:  94%|█████████▍| 133/141 [03:29<00:12,  1.60s/it]avg_loss = 1.9214149864751902:  94%|█████████▍| 133/141 [03:31<00:12,  1.60s/it]avg_loss = 1.9214149864751902:  95%|█████████▌| 134/141 [03:31<00:11,  1.60s/it]avg_loss = 1.9238168707600347:  95%|█████████▌| 134/141 [03:32<00:11,  1.60s/it]avg_loss = 1.9238168707600347:  96%|█████████▌| 135/141 [03:32<00:09,  1.60s/it]avg_loss = 1.927266833536765:  96%|█████████▌| 135/141 [03:34<00:09,  1.60s/it] avg_loss = 1.927266833536765:  96%|█████████▋| 136/141 [03:34<00:07,  1.60s/it]avg_loss = 1.9285092153688417:  96%|█████████▋| 136/141 [03:35<00:07,  1.60s/it]avg_loss = 1.9285092153688417:  97%|█████████▋| 137/141 [03:35<00:06,  1.60s/it]avg_loss = 1.9272957323254019:  97%|█████████▋| 137/141 [03:37<00:06,  1.60s/it]avg_loss = 1.9272957323254019:  98%|█████████▊| 138/141 [03:37<00:04,  1.60s/it]avg_loss = 1.9276070114519956:  98%|█████████▊| 138/141 [03:39<00:04,  1.60s/it]avg_loss = 1.9276070114519956:  99%|█████████▊| 139/141 [03:39<00:03,  1.60s/it]avg_loss = 1.9283865247453962:  99%|█████████▊| 139/141 [03:40<00:03,  1.60s/it]avg_loss = 1.9283865247453962:  99%|█████████▉| 140/141 [03:40<00:01,  1.60s/it]avg_loss = 1.929521435541464:  99%|█████████▉| 140/141 [03:42<00:01,  1.60s/it] avg_loss = 1.929521435541464: 100%|██████████| 141/141 [03:42<00:00,  1.60s/it]avg_loss = 1.929521435541464: 100%|██████████| 141/141 [03:42<00:00,  1.58s/it]
I0324 05:37:39.509286 3986870 eval_ppl.py:107] wikitext2 perplexity: 6.886213779449463
wikitext2 perplexity: 6.886
