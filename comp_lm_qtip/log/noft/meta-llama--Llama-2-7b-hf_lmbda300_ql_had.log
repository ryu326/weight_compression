I0316 08:13:15.116523 3482656 config.py:54] PyTorch version 2.6.0 available.
W0316 08:13:15.400310 3482656 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:13:16.338609 3482656 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.33it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.85it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.09it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.24it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.33it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.85it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.95it/s]
I0316 08:13:17.296499 3482656 quantize_finetune_llama.py:143] loaded model
I0316 08:13:17.587936 3482656 quantize_finetune_llama.py:171] loaded compression model
I0316 08:13:32.337921 3482656 quantize_finetune_llama.py:175] loaded dataset and devset
I0316 08:13:38.242396 3482656 quantize_finetune_llama.py:195] layer 0 gpu 0
I0316 08:13:40.216256 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 0 in 1.827843427658081s
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0316 08:13:53.368358 3483391 config.py:54] PyTorch version 2.6.0 available.
W0316 08:13:53.651647 3483391 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:13:54.527216 3483391 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:13:54.531184 3482656 quantize_finetune_llama.py:195] layer 1 gpu 1
I0316 08:13:54.698230 3483391 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:13:56.911019 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 1 in 2.214931011199951s
I0316 08:14:00.474081 3483533 config.py:54] PyTorch version 2.6.0 available.
W0316 08:14:00.795571 3483533 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:14:01.781390 3483533 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:14:01.785651 3482656 quantize_finetune_llama.py:195] layer 2 gpu 2
I0316 08:14:01.938118 3483533 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:14:05.861482 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 2 in 3.918858051300049s
I0316 08:14:09.607107 3483725 config.py:54] PyTorch version 2.6.0 available.
W0316 08:14:09.922329 3483725 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:14:10.815319 3483725 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:14:10.819185 3482656 quantize_finetune_llama.py:195] layer 3 gpu 3
I0316 08:14:11.106456 3483725 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:14:14.547502 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 3 in 3.5617783069610596s
I0316 08:14:18.452777 3483891 config.py:54] PyTorch version 2.6.0 available.
W0316 08:14:18.763759 3483891 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:14:19.705645 3483891 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:14:19.709918 3482656 quantize_finetune_llama.py:195] layer 4 gpu 0
I0316 08:14:20.021005 3483891 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.01586824655532837 tr(WHW.T) 4.225186347961426
0_q proxy err 5.502595013240352e-05 tr(WHW.T) 2710.363037109375
0_k proxy err 6.994725845288485e-05 tr(WHW.T) 1698.7349853515625
0_o proxy err 0.0010004412615671754 tr(WHW.T) 0.9668058156967163
0_up proxy err 0.0018820865079760551 tr(WHW.T) 43.27138900756836
0_gate proxy err 0.0012928490759804845 tr(WHW.T) 63.47430419921875
0_down proxy err 0.0013041564961895347 tr(WHW.T) 0.656814694404602
1_v proxy err 0.023686936125159264 tr(WHW.T) 16.465883255004883
1_q proxy err 0.00010819749877555296 tr(WHW.T) 4778.43994140625
1_k proxy err 0.00010343829490011558 tr(WHW.T) 4995.39208984375
1_o proxy err 0.004051785916090012 tr(WHW.T) 1.1115814447402954
1_up proxy err 0.002015399746596813 tr(WHW.T) 109.66383361816406
1_gate proxy err 0.001014990033581853 tr(WHW.T) 221.3038787841797
1_down proxy err 0.0011507539311423898 tr(WHW.T) 2041.4736328125
I0316 08:14:52.694640 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 4 in 1.2082791328430176s
I0316 08:14:56.498359 3484521 config.py:54] PyTorch version 2.6.0 available.
W0316 08:14:56.807419 3484521 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:14:57.730652 3484521 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:14:57.734278 3482656 quantize_finetune_llama.py:195] layer 5 gpu 1
I0316 08:14:57.920104 3484521 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.005643566604703665 tr(WHW.T) 136.67332458496094
2_q proxy err 0.00012604474613908678 tr(WHW.T) 7752.85205078125
2_k proxy err 0.00010313721577404067 tr(WHW.T) 10205.837890625
2_o proxy err 0.003245116211473942 tr(WHW.T) 1.4603197574615479
2_up proxy err 0.002358667552471161 tr(WHW.T) 193.43603515625
2_gate proxy err 0.001505219261161983 tr(WHW.T) 306.6622619628906
2_down proxy err 0.0027196435257792473 tr(WHW.T) 3.010739803314209
3_v proxy err 0.005379723384976387 tr(WHW.T) 284.77557373046875
3_q proxy err 0.0002449055900797248 tr(WHW.T) 7217.63720703125
3_k proxy err 0.0001816858712118119 tr(WHW.T) 10074.73828125
3_o proxy err 0.003244543680921197 tr(WHW.T) 3.3527450561523438
3_up proxy err 0.0026839340571314096 tr(WHW.T) 284.7950744628906
3_gate proxy err 0.0016171496827155352 tr(WHW.T) 478.13714599609375
3_down proxy err 0.0027793776243925095 tr(WHW.T) 6.133229732513428
I0316 08:15:08.906124 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 5 in 0.930466890335083s
I0316 08:15:12.539027 3484797 config.py:54] PyTorch version 2.6.0 available.
W0316 08:15:12.867722 3484797 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:15:13.812110 3484797 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:15:13.815729 3482656 quantize_finetune_llama.py:195] layer 6 gpu 2
I0316 08:15:13.976104 3484797 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:15:15.078929 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 6 in 0.8445053100585938s
I0316 08:15:18.869450 3484950 config.py:54] PyTorch version 2.6.0 available.
W0316 08:15:19.206804 3484950 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:15:20.214454 3484950 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:15:20.218734 3482656 quantize_finetune_llama.py:195] layer 7 gpu 3
I0316 08:15:20.483190 3484950 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:15:21.707263 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 7 in 1.0026390552520752s
I0316 08:15:25.480465 3485104 config.py:54] PyTorch version 2.6.0 available.
W0316 08:15:25.800425 3485104 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:15:26.791196 3485104 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:15:26.795519 3482656 quantize_finetune_llama.py:195] layer 8 gpu 0
I0316 08:15:27.055428 3485104 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.00521506741642952 tr(WHW.T) 274.6131286621094
4_q proxy err 0.0002386632695561275 tr(WHW.T) 6914.9892578125
4_k proxy err 0.0001653644285397604 tr(WHW.T) 10415.33203125
4_o proxy err 0.003222384722903371 tr(WHW.T) 5.139806270599365
4_up proxy err 0.0026442334055900574 tr(WHW.T) 397.6960144042969
4_gate proxy err 0.0013041759375482798 tr(WHW.T) 821.1856689453125
4_down proxy err 0.0027837343513965607 tr(WHW.T) 11.562739372253418
5_v proxy err 0.005114010069519281 tr(WHW.T) 298.47540283203125
5_q proxy err 0.0002636931894812733 tr(WHW.T) 6770.97509765625
5_k proxy err 0.0001755755365593359 tr(WHW.T) 10841.955078125
5_o proxy err 0.0045435321517288685 tr(WHW.T) 7.947142601013184
5_up proxy err 0.002593550831079483 tr(WHW.T) 506.6408386230469
5_gate proxy err 0.0012118532322347164 tr(WHW.T) 1104.867919921875
5_down proxy err 0.0029362342320382595 tr(WHW.T) 15.6494779586792
I0316 08:16:04.272622 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 8 in 0.93343186378479s
I0316 08:16:07.907792 3485793 config.py:54] PyTorch version 2.6.0 available.
W0316 08:16:08.262194 3485793 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:16:09.251977 3485793 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:16:09.256701 3482656 quantize_finetune_llama.py:195] layer 9 gpu 1
I0316 08:16:09.497217 3485793 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.00506135867908597 tr(WHW.T) 489.9357604980469
7_q proxy err 0.00036227365490049124 tr(WHW.T) 7672.17919921875
7_k proxy err 0.0002749547129496932 tr(WHW.T) 10198.3701171875
7_o proxy err 0.004809735808521509 tr(WHW.T) 15.11335563659668
7_up proxy err 0.0025614656042307615 tr(WHW.T) 735.8538818359375
7_gate proxy err 0.0010275265667587519 tr(WHW.T) 1876.0390625
7_down proxy err 0.003070938866585493 tr(WHW.T) 30.58672523498535
6_v proxy err 0.0051573277451097965 tr(WHW.T) 443.5464782714844
6_q proxy err 0.0003402459842618555 tr(WHW.T) 7576.53857421875
6_k proxy err 0.00024997396394610405 tr(WHW.T) 10409.4033203125
6_o proxy err 0.004217670764774084 tr(WHW.T) 11.564380645751953
6_up proxy err 0.0026006686966866255 tr(WHW.T) 617.2608642578125
6_gate proxy err 0.001055083703249693 tr(WHW.T) 1554.7271728515625
6_down proxy err 0.0030332275200635195 tr(WHW.T) 22.988168716430664
I0316 08:16:17.502379 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 9 in 0.91697096824646s
I0316 08:16:21.193946 3486037 config.py:54] PyTorch version 2.6.0 available.
W0316 08:16:21.502259 3486037 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:16:22.450667 3486037 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:16:22.455018 3482656 quantize_finetune_llama.py:195] layer 10 gpu 2
I0316 08:16:22.642868 3486037 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:16:23.874650 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 10 in 0.9566352367401123s
I0316 08:16:27.588599 3486174 config.py:54] PyTorch version 2.6.0 available.
W0316 08:16:27.911475 3486174 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:16:28.896529 3486174 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:16:28.900780 3482656 quantize_finetune_llama.py:195] layer 11 gpu 3
I0316 08:16:29.061808 3486174 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:16:30.736730 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 11 in 1.2859423160552979s
I0316 08:16:34.616029 3486343 config.py:54] PyTorch version 2.6.0 available.
W0316 08:16:34.945158 3486343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:16:35.840182 3486343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:16:35.844216 3482656 quantize_finetune_llama.py:195] layer 12 gpu 0
I0316 08:16:36.124694 3486343 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.004762237425893545 tr(WHW.T) 530.9967041015625
8_q proxy err 0.0003861169097945094 tr(WHW.T) 7228.1201171875
8_k proxy err 0.0002681523037608713 tr(WHW.T) 10639.1015625
8_o proxy err 0.005440843757241964 tr(WHW.T) 20.092191696166992
8_up proxy err 0.002355931792408228 tr(WHW.T) 866.312744140625
8_gate proxy err 0.0010548452846705914 tr(WHW.T) 1970.857177734375
8_down proxy err 0.0030556833371520042 tr(WHW.T) 37.177734375
9_v proxy err 0.004468660335987806 tr(WHW.T) 565.0663452148438
9_q proxy err 0.00040272544720210135 tr(WHW.T) 6970.3359375
9_k proxy err 0.00026378134498372674 tr(WHW.T) 10987.3515625
9_o proxy err 0.005410726182162762 tr(WHW.T) 25.610172271728516
9_up proxy err 0.002271894598379731 tr(WHW.T) 970.8984375
9_gate proxy err 0.001050748978741467 tr(WHW.T) 2132.69384765625
9_down proxy err 0.003057525958865881 tr(WHW.T) 42.99482727050781
I0316 08:17:12.939778 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 12 in 0.9615387916564941s
I0316 08:17:16.508922 3487004 config.py:54] PyTorch version 2.6.0 available.
W0316 08:17:16.821227 3487004 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:17:17.824211 3487004 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:17:17.828245 3482656 quantize_finetune_llama.py:195] layer 13 gpu 1
I0316 08:17:18.060075 3487004 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.004505960736423731 tr(WHW.T) 578.807373046875
10_q proxy err 0.0004180098185315728 tr(WHW.T) 6915.87109375
10_k proxy err 0.0002725224767345935 tr(WHW.T) 10996.2431640625
10_o proxy err 0.005558427423238754 tr(WHW.T) 35.184165954589844
10_up proxy err 0.0021404847502708435 tr(WHW.T) 1080.198486328125
10_gate proxy err 0.0010402556508779526 tr(WHW.T) 2260.88330078125
10_down proxy err 0.002908190945163369 tr(WHW.T) 52.33584976196289
11_v proxy err 0.004281883127987385 tr(WHW.T) 723.1956176757812
11_q proxy err 0.00047703972086310387 tr(WHW.T) 7027.10986328125
11_k proxy err 0.0003248533757869154 tr(WHW.T) 10511.23046875
11_o proxy err 0.005564077757298946 tr(WHW.T) 36.654052734375
11_up proxy err 0.00218089297413826 tr(WHW.T) 1139.6044921875
11_gate proxy err 0.0010522339725866914 tr(WHW.T) 2392.716552734375
11_down proxy err 0.0029832401778548956 tr(WHW.T) 56.13530731201172
I0316 08:17:26.577223 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 13 in 1.0246195793151855s
I0316 08:17:30.239637 3487260 config.py:54] PyTorch version 2.6.0 available.
W0316 08:17:30.539444 3487260 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:17:31.776790 3487260 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:17:31.780663 3482656 quantize_finetune_llama.py:195] layer 14 gpu 2
I0316 08:17:32.396397 3487260 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:17:33.210327 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 14 in 0.9905848503112793s
I0316 08:17:37.010061 3487396 config.py:54] PyTorch version 2.6.0 available.
W0316 08:17:37.354558 3487396 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:17:38.522123 3487396 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:17:38.526394 3482656 quantize_finetune_llama.py:195] layer 15 gpu 3
I0316 08:17:38.724707 3487396 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:17:40.012998 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 15 in 0.9984290599822998s
I0316 08:17:43.936825 3487572 config.py:54] PyTorch version 2.6.0 available.
W0316 08:17:44.260909 3487572 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:17:45.211016 3487572 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:17:45.214911 3482656 quantize_finetune_llama.py:195] layer 16 gpu 0
I0316 08:17:45.488879 3487572 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.004405370447784662 tr(WHW.T) 703.318603515625
12_q proxy err 0.00047747581265866756 tr(WHW.T) 7045.6435546875
12_k proxy err 0.00031683812267147005 tr(WHW.T) 10893.65625
12_o proxy err 0.005664698779582977 tr(WHW.T) 39.29071044921875
12_up proxy err 0.0021535938140004873 tr(WHW.T) 1228.298583984375
12_gate proxy err 0.0011260178871452808 tr(WHW.T) 2381.994873046875
12_down proxy err 0.002975214272737503 tr(WHW.T) 64.17745208740234
13_v proxy err 0.004308805800974369 tr(WHW.T) 714.5677490234375
13_q proxy err 0.0004798308073077351 tr(WHW.T) 6956.03564453125
13_k proxy err 0.00032892191666178405 tr(WHW.T) 10426.6318359375
13_o proxy err 0.005031832493841648 tr(WHW.T) 45.8377571105957
13_up proxy err 0.0020745485089719296 tr(WHW.T) 1367.6221923828125
13_gate proxy err 0.001101332250982523 tr(WHW.T) 2601.504638671875
13_down proxy err 0.002981088822707534 tr(WHW.T) 79.3589096069336
I0316 08:18:23.109539 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 16 in 0.9394710063934326s
I0316 08:18:26.829135 3488238 config.py:54] PyTorch version 2.6.0 available.
W0316 08:18:27.156308 3488238 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:18:28.224071 3488238 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:18:28.228469 3482656 quantize_finetune_llama.py:195] layer 17 gpu 1
I0316 08:18:28.555301 3488238 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.004613042343407869 tr(WHW.T) 706.1612548828125
14_q proxy err 0.0004974252078682184 tr(WHW.T) 7077.06103515625
14_k proxy err 0.00031944591319188476 tr(WHW.T) 11295.16796875
14_o proxy err 0.005558884236961603 tr(WHW.T) 50.921180725097656
14_up proxy err 0.0020982827991247177 tr(WHW.T) 1464.7159423828125
14_gate proxy err 0.0011574168456718326 tr(WHW.T) 2682.584716796875
14_down proxy err 0.0030404578428715467 tr(WHW.T) 90.28684997558594
I0316 08:18:34.207103 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 17 in 1.137479305267334s
15_v proxy err 0.004167546983808279 tr(WHW.T) 762.7275390625
15_q proxy err 0.00047496039769612253 tr(WHW.T) 7252.0009765625
15_k proxy err 0.0003188054542988539 tr(WHW.T) 11072.3974609375
15_o proxy err 0.004709668457508087 tr(WHW.T) 59.61664962768555
15_up proxy err 0.0020433447789400816 tr(WHW.T) 1641.0228271484375
15_gate proxy err 0.001165380934253335 tr(WHW.T) 2905.140380859375
15_down proxy err 0.003039529314264655 tr(WHW.T) 114.09001922607422
I0316 08:18:38.209084 3488440 config.py:54] PyTorch version 2.6.0 available.
W0316 08:18:38.548737 3488440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:18:39.489532 3488440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:18:39.493620 3482656 quantize_finetune_llama.py:195] layer 18 gpu 2
I0316 08:18:39.761157 3488440 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:18:40.858967 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 18 in 0.9166147708892822s
I0316 08:18:44.679361 3488607 config.py:54] PyTorch version 2.6.0 available.
W0316 08:18:44.978956 3488607 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:18:45.907793 3488607 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:18:45.911927 3482656 quantize_finetune_llama.py:195] layer 19 gpu 3
I0316 08:18:46.233316 3488607 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:18:47.435941 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 19 in 0.9782459735870361s
I0316 08:18:51.399382 3488755 config.py:54] PyTorch version 2.6.0 available.
W0316 08:18:51.757233 3488755 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:18:53.015513 3488755 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:18:53.020296 3482656 quantize_finetune_llama.py:195] layer 20 gpu 0
I0316 08:18:53.378507 3488755 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.004237145651131868 tr(WHW.T) 780.7407836914062
16_q proxy err 0.0004904216038994491 tr(WHW.T) 7193.3974609375
16_k proxy err 0.0003131881239823997 tr(WHW.T) 11630.361328125
16_o proxy err 0.003684427822008729 tr(WHW.T) 88.22785186767578
16_up proxy err 0.0020001118537038565 tr(WHW.T) 1890.9385986328125
16_gate proxy err 0.0011341385543346405 tr(WHW.T) 3369.859130859375
16_down proxy err 0.003072751220315695 tr(WHW.T) 152.0294952392578
17_v proxy err 0.0039781928062438965 tr(WHW.T) 845.7654418945312
17_q proxy err 0.0005004903068765998 tr(WHW.T) 7163.2734375
17_k proxy err 0.00034386871266178787 tr(WHW.T) 10697.431640625
17_o proxy err 0.004016372840851545 tr(WHW.T) 58.14826965332031
17_up proxy err 0.0021824834402650595 tr(WHW.T) 1921.07861328125
17_gate proxy err 0.0011892856564372778 tr(WHW.T) 3571.31640625
17_down proxy err 0.0030546439811587334 tr(WHW.T) 165.43495178222656
I0316 08:19:31.651938 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 20 in 1.035494089126587s
I0316 08:19:35.350246 3489436 config.py:54] PyTorch version 2.6.0 available.
W0316 08:19:35.681612 3489436 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.0036427194718271494 tr(WHW.T) 1003.7705078125
18_q proxy err 0.0005179803702048957 tr(WHW.T) 7510.48046875
18_k proxy err 0.00037640437949448824 tr(WHW.T) 10462.6650390625
18_o proxy err 0.0035125422291457653 tr(WHW.T) 69.96558380126953
18_up proxy err 0.0023228665813803673 tr(WHW.T) 2023.183837890625
18_gate proxy err 0.00125582714099437 tr(WHW.T) 3783.076416015625
18_down proxy err 0.003070906735956669 tr(WHW.T) 198.52699279785156
W0316 08:19:36.670107 3489436 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:19:36.674288 3482656 quantize_finetune_llama.py:195] layer 21 gpu 1
I0316 08:19:36.978256 3489436 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:19:38.185700 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 21 in 1.0297801494598389s
I0316 08:19:41.927253 3489570 config.py:54] PyTorch version 2.6.0 available.
W0316 08:19:42.256127 3489570 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.0035681079607456923 tr(WHW.T) 1019.1412353515625
19_q proxy err 0.0005509890615940094 tr(WHW.T) 6944.4130859375
19_k proxy err 0.00036906820605508983 tr(WHW.T) 10548.4892578125
19_o proxy err 0.003463150467723608 tr(WHW.T) 62.291683197021484
19_up proxy err 0.002338852733373642 tr(WHW.T) 2149.330322265625
19_gate proxy err 0.0013788276119157672 tr(WHW.T) 3687.5126953125
19_down proxy err 0.0029870285652577877 tr(WHW.T) 222.93177795410156
W0316 08:19:43.254198 3489570 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:19:43.258181 3482656 quantize_finetune_llama.py:195] layer 22 gpu 2
I0316 08:19:43.803950 3489570 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:19:45.117741 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 22 in 0.9592568874359131s
I0316 08:19:48.839564 3489745 config.py:54] PyTorch version 2.6.0 available.
W0316 08:19:49.139993 3489745 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:19:50.167165 3489745 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:19:50.171545 3482656 quantize_finetune_llama.py:195] layer 23 gpu 3
I0316 08:19:50.521429 3489745 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:19:51.848511 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 23 in 1.198929786682129s
I0316 08:19:55.616340 3489895 config.py:54] PyTorch version 2.6.0 available.
W0316 08:19:55.953198 3489895 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:19:57.023917 3489895 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:19:57.027999 3482656 quantize_finetune_llama.py:195] layer 24 gpu 0
I0316 08:19:57.286906 3489895 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.003669475670903921 tr(WHW.T) 990.5983276367188
20_q proxy err 0.0005371691659092903 tr(WHW.T) 7150.947265625
20_k proxy err 0.0003763468994293362 tr(WHW.T) 10386.2470703125
20_o proxy err 0.002553897211328149 tr(WHW.T) 100.31707000732422
20_up proxy err 0.0022905117366462946 tr(WHW.T) 2340.89453125
20_gate proxy err 0.0013494485756382346 tr(WHW.T) 4024.62744140625
20_down proxy err 0.0029680863954126835 tr(WHW.T) 274.8815002441406
21_v proxy err 0.0035168344620615244 tr(WHW.T) 1144.5655517578125
21_q proxy err 0.0005979184643365443 tr(WHW.T) 7064.314453125
21_k proxy err 0.0004261888097971678 tr(WHW.T) 9976.4658203125
21_o proxy err 0.002729486906901002 tr(WHW.T) 75.50972747802734
21_up proxy err 0.0024097810965031385 tr(WHW.T) 2361.650390625
21_gate proxy err 0.0014398562489077449 tr(WHW.T) 4004.37646484375
21_down proxy err 0.0029714673291891813 tr(WHW.T) 276.5857849121094
I0316 08:20:34.038399 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 24 in 0.9344396591186523s
I0316 08:20:37.772107 3490499 config.py:54] PyTorch version 2.6.0 available.
W0316 08:20:38.097672 3490499 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:20:39.112544 3490499 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:20:39.116692 3482656 quantize_finetune_llama.py:195] layer 25 gpu 1
22_v proxy err 0.003349723992869258 tr(WHW.T) 1243.2529296875
22_q proxy err 0.0005620511947199702 tr(WHW.T) 7746.84765625
22_k proxy err 0.00041811016853898764 tr(WHW.T) 10603.2041015625
22_o proxy err 0.002295308979228139 tr(WHW.T) 114.30065155029297
22_up proxy err 0.0024252571165561676 tr(WHW.T) 2474.510498046875
22_gate proxy err 0.0014629013603553176 tr(WHW.T) 4156.64013671875
22_down proxy err 0.0029584383592009544 tr(WHW.T) 311.8800048828125
I0316 08:20:39.273569 3490499 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:20:41.352752 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 25 in 0.9453577995300293s
I0316 08:20:45.098325 3490668 config.py:54] PyTorch version 2.6.0 available.
W0316 08:20:45.416978 3490668 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.0030443507712334394 tr(WHW.T) 1486.037353515625
23_q proxy err 0.0006412928341887891 tr(WHW.T) 7346.60986328125
23_k proxy err 0.0004762665485031903 tr(WHW.T) 9982.2392578125
23_o proxy err 0.00276320893317461 tr(WHW.T) 85.13458251953125
23_up proxy err 0.0025128310080617666 tr(WHW.T) 2533.51025390625
23_gate proxy err 0.0015729957958683372 tr(WHW.T) 4097.51953125
23_down proxy err 0.0029726114589720964 tr(WHW.T) 321.33892822265625
W0316 08:20:46.372764 3490668 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:20:46.376963 3482656 quantize_finetune_llama.py:195] layer 26 gpu 2
I0316 08:20:46.669564 3490668 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:20:47.690332 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 26 in 0.8733623027801514s
I0316 08:20:51.417258 3490811 config.py:54] PyTorch version 2.6.0 available.
W0316 08:20:51.704411 3490811 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:20:52.660358 3490811 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:20:52.664423 3482656 quantize_finetune_llama.py:195] layer 27 gpu 3
I0316 08:20:52.899517 3490811 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:20:54.118043 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 27 in 0.9710268974304199s
I0316 08:20:57.993379 3490956 config.py:54] PyTorch version 2.6.0 available.
W0316 08:20:58.326188 3490956 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:20:59.328406 3490956 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:20:59.332661 3482656 quantize_finetune_llama.py:195] layer 28 gpu 0
I0316 08:20:59.546825 3490956 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.003225721186026931 tr(WHW.T) 1394.900634765625
24_q proxy err 0.0006661268998868763 tr(WHW.T) 7020.447265625
24_k proxy err 0.0004571571189444512 tr(WHW.T) 10323.43359375
24_o proxy err 0.002172360196709633 tr(WHW.T) 133.98797607421875
24_up proxy err 0.0025467989034950733 tr(WHW.T) 2621.76513671875
24_gate proxy err 0.0015855437377467752 tr(WHW.T) 4262.74853515625
24_down proxy err 0.0029810117557644844 tr(WHW.T) 340.22412109375
25_v proxy err 0.0029199859127402306 tr(WHW.T) 1707.664794921875
25_q proxy err 0.0007176105864346027 tr(WHW.T) 7162.16357421875
25_k proxy err 0.0005407616845332086 tr(WHW.T) 9611.58984375
25_o proxy err 0.0025988323614001274 tr(WHW.T) 83.535888671875
25_up proxy err 0.0025300029665231705 tr(WHW.T) 2805.728515625
25_gate proxy err 0.0015414324589073658 tr(WHW.T) 4666.4404296875
25_down proxy err 0.0029562583658844233 tr(WHW.T) 373.460693359375
I0316 08:21:36.424106 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 28 in 0.89919114112854s
I0316 08:21:40.201148 3491575 config.py:54] PyTorch version 2.6.0 available.
W0316 08:21:40.582185 3491575 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.0029172266367822886 tr(WHW.T) 1668.8843994140625
26_q proxy err 0.000673253380227834 tr(WHW.T) 7469.98291015625
26_k proxy err 0.0004833763523492962 tr(WHW.T) 10487.8740234375
26_o proxy err 0.0017766165547072887 tr(WHW.T) 202.88172912597656
26_up proxy err 0.0023752045817673206 tr(WHW.T) 3154.75146484375
26_gate proxy err 0.0014319050824269652 tr(WHW.T) 5302.16455078125
26_down proxy err 0.003034894820302725 tr(WHW.T) 401.19390869140625
W0316 08:21:41.552174 3491575 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:21:41.556298 3482656 quantize_finetune_llama.py:195] layer 29 gpu 1
I0316 08:21:41.741065 3491575 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:21:43.349909 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 29 in 1.080456256866455s
I0316 08:21:47.147792 3491744 config.py:54] PyTorch version 2.6.0 available.
27_v proxy err 0.002661485457792878 tr(WHW.T) 1799.3350830078125
27_q proxy err 0.0006464372272603214 tr(WHW.T) 7691.708984375
27_k proxy err 0.0004714222450274974 tr(WHW.T) 10618.70703125
27_o proxy err 0.0024216906167566776 tr(WHW.T) 126.13690185546875
27_up proxy err 0.002162996446713805 tr(WHW.T) 3691.557861328125
27_gate proxy err 0.001349624595604837 tr(WHW.T) 5990.82568359375
27_down proxy err 0.0030738948844373226 tr(WHW.T) 466.9318542480469
W0316 08:21:47.454564 3491744 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:21:48.382174 3491744 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:21:48.386234 3482656 quantize_finetune_llama.py:195] layer 30 gpu 2
I0316 08:21:48.574216 3491744 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:21:49.725755 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 30 in 0.8957433700561523s
I0316 08:21:53.506711 3491888 config.py:54] PyTorch version 2.6.0 available.
W0316 08:21:53.795516 3491888 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:21:54.758771 3491888 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:21:54.763083 3482656 quantize_finetune_llama.py:195] layer 31 gpu 3
I0316 08:21:54.951006 3491888 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0316 08:21:56.223951 3482656 quantize_finetune_llama.py:226] computed original embedding for layer 31 in 0.959620475769043s
I0316 08:21:59.972021 3492044 config.py:54] PyTorch version 2.6.0 available.
W0316 08:22:00.294311 3492044 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0316 08:22:01.374561 3492044 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0316 08:22:01.630298 3492044 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.002474775305017829 tr(WHW.T) 2018.944091796875
28_q proxy err 0.0006716590723954141 tr(WHW.T) 7651.126953125
28_k proxy err 0.0004905846435576677 tr(WHW.T) 10544.8251953125
28_o proxy err 0.0019942244980484247 tr(WHW.T) 194.8240966796875
28_up proxy err 0.0018110034288838506 tr(WHW.T) 4661.2666015625
28_gate proxy err 0.001300870324485004 tr(WHW.T) 6547.48193359375
28_down proxy err 0.0030810683965682983 tr(WHW.T) 603.8403930664062
29_v proxy err 0.002613321179524064 tr(WHW.T) 1801.7730712890625
29_q proxy err 0.0006685227854177356 tr(WHW.T) 7227.0009765625
29_k proxy err 0.0004637569945771247 tr(WHW.T) 10558.609375
29_o proxy err 0.0016759693389758468 tr(WHW.T) 207.9054412841797
29_up proxy err 0.0014441257808357477 tr(WHW.T) 6070.0498046875
29_gate proxy err 0.0011983030708506703 tr(WHW.T) 7369.6142578125
29_down proxy err 0.0031001607421785593 tr(WHW.T) 782.2448120117188
30_v proxy err 0.002147439168766141 tr(WHW.T) 2261.489501953125
30_q proxy err 0.0006358259706757963 tr(WHW.T) 7815.9453125
30_k proxy err 0.00047579986858181655 tr(WHW.T) 10521.625
30_o proxy err 0.0017503240378573537 tr(WHW.T) 251.96908569335938
30_up proxy err 0.0008903706911951303 tr(WHW.T) 10016.376953125
30_gate proxy err 0.0008158680284395814 tr(WHW.T) 11001.119140625
30_down proxy err 0.0017961199628189206 tr(WHW.T) 3582.617919921875
31_v proxy err 0.0025867295917123556 tr(WHW.T) 1268.2034912109375
31_q proxy err 0.0004982937825843692 tr(WHW.T) 6858.09130859375
31_k proxy err 0.0003423171874601394 tr(WHW.T) 10233.677734375
31_o proxy err 0.0013482737122103572 tr(WHW.T) 457.7950744628906
31_up proxy err 0.000508519820868969 tr(WHW.T) 14563.890625
31_gate proxy err 0.0005035748472437263 tr(WHW.T) 14836.2939453125
31_down proxy err 0.0012623267248272896 tr(WHW.T) 17873.55859375
