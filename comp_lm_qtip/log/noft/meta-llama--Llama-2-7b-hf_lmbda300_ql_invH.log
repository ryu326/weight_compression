I0317 11:40:54.885395 3811485 config.py:54] PyTorch version 2.6.0 available.
W0317 11:40:55.175616 3811485 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:40:56.095082 3811485 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.29it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.86it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.10it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.25it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.32it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.96it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.01it/s]
I0317 11:40:57.047033 3811485 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:13,  2.27it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:13,  2.27it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.21it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:12,  2.23it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:12,  2.22it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:11,  2.21it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:11,  2.23it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:10,  2.21it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:10,  2.20it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:10,  2.20it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:09,  2.24it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:08,  2.27it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:08,  2.29it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:06<00:07,  2.35it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:07,  2.39it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:07<00:06,  2.40it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:06,  2.40it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.42it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:05,  2.44it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:08<00:04,  2.46it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:09<00:04,  2.49it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:09<00:03,  2.51it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.53it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:10<00:03,  2.54it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:10<00:02,  2.56it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.59it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:11<00:01,  2.60it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.61it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:12<00:01,  2.63it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:12<00:00,  2.66it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.69it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.71it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.43it/s]
I0317 11:41:17.194014 3811485 quantize_finetune_llama.py:173] loaded compression model
I0317 11:41:31.203101 3811485 quantize_finetune_llama.py:177] loaded dataset and devset
I0317 11:41:37.997993 3811485 quantize_finetune_llama.py:197] layer 0 gpu 0
I0317 11:41:41.278986 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 0 in 3.1389949321746826s
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0317 11:41:56.843182 3812381 config.py:54] PyTorch version 2.6.0 available.
W0317 11:41:57.123232 3812381 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:41:57.996412 3812381 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:41:58.000452 3811485 quantize_finetune_llama.py:197] layer 1 gpu 1
I0317 11:41:58.014166 3812381 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:42:00.630940 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 1 in 2.475005626678467s
I0317 11:42:04.104065 3812524 config.py:54] PyTorch version 2.6.0 available.
W0317 11:42:04.420691 3812524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:42:05.394409 3812524 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:42:05.398634 3811485 quantize_finetune_llama.py:197] layer 2 gpu 2
I0317 11:42:05.412396 3812524 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:42:08.422694 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 2 in 2.870129108428955s
I0317 11:42:12.265428 3812674 config.py:54] PyTorch version 2.6.0 available.
W0317 11:42:12.620676 3812674 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:42:13.617568 3812674 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:42:13.621722 3811485 quantize_finetune_llama.py:197] layer 3 gpu 3
I0317 11:42:13.635385 3812674 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:42:17.482504 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 3 in 3.697234869003296s
I0317 11:42:21.534468 3812831 config.py:54] PyTorch version 2.6.0 available.
W0317 11:42:21.891640 3812831 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:42:23.024540 3812831 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:42:23.029234 3811485 quantize_finetune_llama.py:197] layer 4 gpu 0
I0317 11:42:23.046784 3812831 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.013090803287923336 tr(WHW.T) 4.225186347961426
0_q proxy err 0.00016697282262612134 tr(WHW.T) 2710.363037109375
0_k proxy err 0.00017963582649827003 tr(WHW.T) 1698.7349853515625
0_o proxy err 0.0015348928282037377 tr(WHW.T) 0.9668058156967163
0_up proxy err 0.003528116038069129 tr(WHW.T) 43.27138900756836
0_gate proxy err 0.0024479394778609276 tr(WHW.T) 63.47430419921875
0_down proxy err 0.0020737838931381702 tr(WHW.T) 0.656814694404602
1_v proxy err 0.03247404471039772 tr(WHW.T) 16.465883255004883
1_q proxy err 0.00021009209740441293 tr(WHW.T) 4778.43994140625
1_k proxy err 0.000256748084211722 tr(WHW.T) 4995.39208984375
1_o proxy err 0.007981196977198124 tr(WHW.T) 1.1115814447402954
1_up proxy err 0.004756213165819645 tr(WHW.T) 109.66383361816406
1_gate proxy err 0.0024176687002182007 tr(WHW.T) 221.3038787841797
1_down proxy err 0.0005915711517445743 tr(WHW.T) 2041.4736328125
I0317 11:42:43.187804 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 4 in 0.9045109748840332s
I0317 11:42:47.106394 3813174 config.py:54] PyTorch version 2.6.0 available.
W0317 11:42:47.422782 3813174 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:42:48.375085 3813174 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:42:48.379289 3811485 quantize_finetune_llama.py:197] layer 5 gpu 1
I0317 11:42:48.393381 3813174 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.006571985315531492 tr(WHW.T) 136.67332458496094
2_q proxy err 0.00021772005129605532 tr(WHW.T) 7752.85205078125
2_k proxy err 0.000194273772649467 tr(WHW.T) 10205.837890625
2_o proxy err 0.006702609360218048 tr(WHW.T) 1.4603197574615479
2_up proxy err 0.005547444336116314 tr(WHW.T) 193.43603515625
2_gate proxy err 0.003539648838341236 tr(WHW.T) 306.6622619628906
2_down proxy err 0.005676816217601299 tr(WHW.T) 3.010739803314209
I0317 11:42:51.761374 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 5 in 1.0524191856384277s
I0317 11:42:55.620689 3813322 config.py:54] PyTorch version 2.6.0 available.
W0317 11:42:55.964476 3813322 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:42:56.929273 3813322 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:42:56.933090 3811485 quantize_finetune_llama.py:197] layer 6 gpu 2
I0317 11:42:56.946165 3813322 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.008928702212870121 tr(WHW.T) 284.77557373046875
3_q proxy err 0.0004529219586402178 tr(WHW.T) 7217.63720703125
3_k proxy err 0.00034193176543340087 tr(WHW.T) 10074.73828125
3_o proxy err 0.005845979787409306 tr(WHW.T) 3.3527450561523438
3_up proxy err 0.006317692343145609 tr(WHW.T) 284.7950744628906
3_gate proxy err 0.0038126958534121513 tr(WHW.T) 478.13714599609375
3_down proxy err 0.005799103993922472 tr(WHW.T) 6.133229732513428
I0317 11:43:08.182072 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 6 in 0.9330332279205322s
I0317 11:43:12.008401 3813568 config.py:54] PyTorch version 2.6.0 available.
W0317 11:43:12.360659 3813568 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:43:13.379268 3813568 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:43:13.383670 3811485 quantize_finetune_llama.py:197] layer 7 gpu 3
I0317 11:43:13.398729 3813568 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:43:14.961146 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 7 in 1.061833381652832s
I0317 11:43:18.811772 3813706 config.py:54] PyTorch version 2.6.0 available.
W0317 11:43:19.163915 3813706 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:43:20.289469 3813706 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:43:20.294045 3811485 quantize_finetune_llama.py:197] layer 8 gpu 0
I0317 11:43:20.309581 3813706 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.008073446340858936 tr(WHW.T) 274.6131286621094
4_q proxy err 0.0004251239006407559 tr(WHW.T) 6914.9892578125
4_k proxy err 0.00030856876401230693 tr(WHW.T) 10415.33203125
4_o proxy err 0.0066830781288445 tr(WHW.T) 5.139806270599365
4_up proxy err 0.006150041241198778 tr(WHW.T) 397.6960144042969
4_gate proxy err 0.0030367590952664614 tr(WHW.T) 821.1856689453125
4_down proxy err 0.005899393931031227 tr(WHW.T) 11.562739372253418
5_v proxy err 0.007604378275573254 tr(WHW.T) 298.47540283203125
5_q proxy err 0.0004380950704216957 tr(WHW.T) 6770.97509765625
5_k proxy err 0.0003087995573878288 tr(WHW.T) 10841.955078125
5_o proxy err 0.0074707381427288055 tr(WHW.T) 7.947142601013184
5_up proxy err 0.006067516747862101 tr(WHW.T) 506.6408386230469
5_gate proxy err 0.002837755950167775 tr(WHW.T) 1104.867919921875
5_down proxy err 0.006312776822596788 tr(WHW.T) 15.6494779586792
I0317 11:43:34.664166 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 8 in 1.0737204551696777s
I0317 11:43:38.551534 3813981 config.py:54] PyTorch version 2.6.0 available.
W0317 11:43:38.914496 3813981 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:43:39.990800 3813981 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:43:39.995080 3811485 quantize_finetune_llama.py:197] layer 9 gpu 1
I0317 11:43:40.010979 3813981 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.008532136678695679 tr(WHW.T) 443.5464782714844
6_q proxy err 0.0006027140188962221 tr(WHW.T) 7576.53857421875
6_k proxy err 0.00045533955562859774 tr(WHW.T) 10409.4033203125
6_o proxy err 0.00841397326439619 tr(WHW.T) 11.564380645751953
6_up proxy err 0.005918355192989111 tr(WHW.T) 617.2608642578125
6_gate proxy err 0.0024085943587124348 tr(WHW.T) 1554.7271728515625
6_down proxy err 0.00646215071901679 tr(WHW.T) 22.988168716430664
I0317 11:43:51.260097 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 9 in 1.083613395690918s
I0317 11:43:55.016581 3814217 config.py:54] PyTorch version 2.6.0 available.
W0317 11:43:55.338289 3814217 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:43:56.294594 3814217 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:43:56.298781 3811485 quantize_finetune_llama.py:197] layer 10 gpu 2
I0317 11:43:56.313328 3814217 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.00837197620421648 tr(WHW.T) 489.9357604980469
7_q proxy err 0.0006340068648569286 tr(WHW.T) 7672.17919921875
7_k proxy err 0.0004955731565132737 tr(WHW.T) 10198.3701171875
7_o proxy err 0.009591123089194298 tr(WHW.T) 15.11335563659668
7_up proxy err 0.0057201990857720375 tr(WHW.T) 735.8538818359375
7_gate proxy err 0.0023017101921141148 tr(WHW.T) 1876.0390625
7_down proxy err 0.0065122200176119804 tr(WHW.T) 30.58672523498535
I0317 11:44:05.509171 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 10 in 1.0609662532806396s
I0317 11:44:09.170189 3814431 config.py:54] PyTorch version 2.6.0 available.
W0317 11:44:09.520259 3814431 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:44:10.558347 3814431 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:44:10.562748 3811485 quantize_finetune_llama.py:197] layer 11 gpu 3
I0317 11:44:10.577908 3814431 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:44:12.389352 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 11 in 1.3203556537628174s
8_v proxy err 0.007223610766232014 tr(WHW.T) 530.9967041015625
8_q proxy err 0.000649363559205085 tr(WHW.T) 7228.1201171875
8_k proxy err 0.0004795191343873739 tr(WHW.T) 10639.1015625
8_o proxy err 0.010821869596838951 tr(WHW.T) 20.092191696166992
8_up proxy err 0.005130806006491184 tr(WHW.T) 866.312744140625
8_gate proxy err 0.0023119901306927204 tr(WHW.T) 1970.857177734375
8_down proxy err 0.00650505255907774 tr(WHW.T) 37.177734375
I0317 11:44:16.337830 3814569 config.py:54] PyTorch version 2.6.0 available.
W0317 11:44:16.663053 3814569 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:44:17.664478 3814569 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:44:17.668868 3811485 quantize_finetune_llama.py:197] layer 12 gpu 0
I0317 11:44:17.683657 3814569 data_utils.py:336] using 256 training seqs, 128 validation seqs
9_v proxy err 0.007128314580768347 tr(WHW.T) 565.0663452148438
9_q proxy err 0.0006990117253735662 tr(WHW.T) 6970.3359375
9_k proxy err 0.0004896257305517793 tr(WHW.T) 10987.3515625
9_o proxy err 0.011055169627070427 tr(WHW.T) 25.610172271728516
9_up proxy err 0.00492081418633461 tr(WHW.T) 970.8984375
9_gate proxy err 0.002294916193932295 tr(WHW.T) 2132.69384765625
9_down proxy err 0.006561627611517906 tr(WHW.T) 42.99482727050781
I0317 11:44:33.872814 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 12 in 1.0229036808013916s
I0317 11:44:37.731110 3814866 config.py:54] PyTorch version 2.6.0 available.
W0317 11:44:38.071516 3814866 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:44:39.078560 3814866 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:44:39.082771 3811485 quantize_finetune_llama.py:197] layer 13 gpu 1
I0317 11:44:39.096767 3814866 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.007179244887083769 tr(WHW.T) 578.807373046875
10_q proxy err 0.0007186175207607448 tr(WHW.T) 6915.87109375
10_k proxy err 0.000501014175824821 tr(WHW.T) 10996.2431640625
10_o proxy err 0.011465649120509624 tr(WHW.T) 35.184165954589844
10_up proxy err 0.0046315682120621204 tr(WHW.T) 1080.198486328125
10_gate proxy err 0.0022632505279034376 tr(WHW.T) 2260.88330078125
10_down proxy err 0.006205626297742128 tr(WHW.T) 52.33584976196289
I0317 11:44:48.438592 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 13 in 1.0906250476837158s
I0317 11:44:52.142871 3815077 config.py:54] PyTorch version 2.6.0 available.
W0317 11:44:52.465195 3815077 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:44:53.437824 3815077 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:44:53.442210 3811485 quantize_finetune_llama.py:197] layer 14 gpu 2
I0317 11:44:53.456851 3815077 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.00708662997931242 tr(WHW.T) 723.1956176757812
11_q proxy err 0.000829743396025151 tr(WHW.T) 7027.10986328125
11_k proxy err 0.0005946479504927993 tr(WHW.T) 10511.23046875
11_o proxy err 0.011345511302351952 tr(WHW.T) 36.654052734375
11_up proxy err 0.004737402778118849 tr(WHW.T) 1139.6044921875
11_gate proxy err 0.0023016559425741434 tr(WHW.T) 2392.716552734375
11_down proxy err 0.006429729983210564 tr(WHW.T) 56.13530731201172
I0317 11:45:02.960406 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 14 in 1.0873057842254639s
I0317 11:45:06.694152 3815291 config.py:54] PyTorch version 2.6.0 available.
W0317 11:45:07.031831 3815291 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:45:07.974275 3815291 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:45:07.978574 3811485 quantize_finetune_llama.py:197] layer 15 gpu 3
I0317 11:45:07.992210 3815291 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:45:09.528351 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 15 in 1.0431654453277588s
I0317 11:45:13.482975 3815439 config.py:54] PyTorch version 2.6.0 available.
W0317 11:45:13.819524 3815439 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

12_v proxy err 0.007287116721272469 tr(WHW.T) 703.318603515625
12_q proxy err 0.000837425934150815 tr(WHW.T) 7045.6435546875
12_k proxy err 0.000577640428673476 tr(WHW.T) 10893.65625
12_o proxy err 0.012012149207293987 tr(WHW.T) 39.29071044921875
12_up proxy err 0.004703058395534754 tr(WHW.T) 1228.298583984375
12_gate proxy err 0.0024686644319444895 tr(WHW.T) 2381.994873046875
12_down proxy err 0.006377936340868473 tr(WHW.T) 64.17745208740234
W0317 11:45:14.793273 3815439 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:45:14.797609 3811485 quantize_finetune_llama.py:197] layer 16 gpu 0
I0317 11:45:14.812357 3815439 data_utils.py:336] using 256 training seqs, 128 validation seqs
13_v proxy err 0.0074525261297822 tr(WHW.T) 714.5677490234375
13_q proxy err 0.000873653800226748 tr(WHW.T) 6956.03564453125
13_k proxy err 0.0006206398247741163 tr(WHW.T) 10426.6318359375
13_o proxy err 0.01045069471001625 tr(WHW.T) 45.8377571105957
13_up proxy err 0.004519303794950247 tr(WHW.T) 1367.6221923828125
13_gate proxy err 0.0024179972242563963 tr(WHW.T) 2601.504638671875
13_down proxy err 0.006271442864090204 tr(WHW.T) 79.3589096069336
I0317 11:45:31.024173 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 16 in 1.0391414165496826s
I0317 11:45:35.009169 3815734 config.py:54] PyTorch version 2.6.0 available.
W0317 11:45:35.358232 3815734 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:45:36.388662 3815734 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:45:36.392853 3811485 quantize_finetune_llama.py:197] layer 17 gpu 1
I0317 11:45:36.406967 3815734 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.007901554927229881 tr(WHW.T) 706.1612548828125
14_q proxy err 0.0008919399697333574 tr(WHW.T) 7077.06103515625
14_k proxy err 0.0006025185575708747 tr(WHW.T) 11295.16796875
14_o proxy err 0.011959909461438656 tr(WHW.T) 50.921180725097656
14_up proxy err 0.004611579235643148 tr(WHW.T) 1464.7159423828125
14_gate proxy err 0.0025575822219252586 tr(WHW.T) 2682.584716796875
14_down proxy err 0.006384767591953278 tr(WHW.T) 90.28684997558594
I0317 11:45:46.039955 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 17 in 1.300966739654541s
I0317 11:45:49.656677 3815955 config.py:54] PyTorch version 2.6.0 available.
W0317 11:45:50.018244 3815955 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:45:51.072008 3815955 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:45:51.076301 3811485 quantize_finetune_llama.py:197] layer 18 gpu 2
I0317 11:45:51.091063 3815955 data_utils.py:336] using 256 training seqs, 128 validation seqs
15_v proxy err 0.0070571149699389935 tr(WHW.T) 762.7275390625
15_q proxy err 0.0008453633636236191 tr(WHW.T) 7252.0009765625
15_k proxy err 0.0005889584426768124 tr(WHW.T) 11072.3974609375
15_o proxy err 0.009756261482834816 tr(WHW.T) 59.61664962768555
15_up proxy err 0.004473898094147444 tr(WHW.T) 1641.0228271484375
15_gate proxy err 0.0025624220725148916 tr(WHW.T) 2905.140380859375
15_down proxy err 0.006307033356279135 tr(WHW.T) 114.09001922607422
I0317 11:45:58.056154 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 18 in 1.0244252681732178s
I0317 11:46:01.968945 3816137 config.py:54] PyTorch version 2.6.0 available.
W0317 11:46:02.288601 3816137 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:46:03.202670 3816137 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:46:03.206879 3811485 quantize_finetune_llama.py:197] layer 19 gpu 3
I0317 11:46:03.221327 3816137 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:46:04.707728 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 19 in 0.9792656898498535s
I0317 11:46:08.740967 3816270 config.py:54] PyTorch version 2.6.0 available.
W0317 11:46:09.072940 3816270 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:46:10.057918 3816270 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:46:10.062045 3811485 quantize_finetune_llama.py:197] layer 20 gpu 0
I0317 11:46:10.076141 3816270 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.007355256471782923 tr(WHW.T) 780.7407836914062
16_q proxy err 0.0008972950163297355 tr(WHW.T) 7193.3974609375
16_k proxy err 0.000598333717789501 tr(WHW.T) 11630.361328125
16_o proxy err 0.008069036528468132 tr(WHW.T) 88.22785186767578
16_up proxy err 0.004479079972952604 tr(WHW.T) 1890.9385986328125
16_gate proxy err 0.002541709691286087 tr(WHW.T) 3369.859130859375
16_down proxy err 0.006378769408911467 tr(WHW.T) 152.0294952392578
17_v proxy err 0.007285657338798046 tr(WHW.T) 845.7654418945312
17_q proxy err 0.0009516970603726804 tr(WHW.T) 7163.2734375
17_k proxy err 0.0006701421807520092 tr(WHW.T) 10697.431640625
17_o proxy err 0.008598722517490387 tr(WHW.T) 58.14826965332031
17_up proxy err 0.004948669578880072 tr(WHW.T) 1921.07861328125
17_gate proxy err 0.0026919604279100895 tr(WHW.T) 3571.31640625
17_down proxy err 0.006442765239626169 tr(WHW.T) 165.43495178222656
I0317 11:46:28.926383 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 20 in 1.0678484439849854s
I0317 11:46:32.702028 3816586 config.py:54] PyTorch version 2.6.0 available.
W0317 11:46:33.061041 3816586 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:46:34.129229 3816586 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:46:34.133478 3811485 quantize_finetune_llama.py:197] layer 21 gpu 1
I0317 11:46:34.147782 3816586 data_utils.py:336] using 256 training seqs, 128 validation seqs
18_v proxy err 0.006877326872199774 tr(WHW.T) 1003.7705078125
18_q proxy err 0.0010011284612119198 tr(WHW.T) 7510.48046875
18_k proxy err 0.0007468407275155187 tr(WHW.T) 10462.6650390625
18_o proxy err 0.007329398766160011 tr(WHW.T) 69.96558380126953
18_up proxy err 0.005307055078446865 tr(WHW.T) 2023.183837890625
18_gate proxy err 0.002874041208997369 tr(WHW.T) 3783.076416015625
18_down proxy err 0.0063223643228411674 tr(WHW.T) 198.52699279785156
I0317 11:46:40.947064 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 21 in 1.0351107120513916s
I0317 11:46:44.881079 3816768 config.py:54] PyTorch version 2.6.0 available.
W0317 11:46:45.192581 3816768 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.006777692586183548 tr(WHW.T) 1019.1412353515625
19_q proxy err 0.0010777927236631513 tr(WHW.T) 6944.4130859375
19_k proxy err 0.0007466108072549105 tr(WHW.T) 10548.4892578125
19_o proxy err 0.007370674517005682 tr(WHW.T) 62.291683197021484
19_up proxy err 0.005357780959457159 tr(WHW.T) 2149.330322265625
19_gate proxy err 0.003156461752951145 tr(WHW.T) 3687.5126953125
19_down proxy err 0.006160364486277103 tr(WHW.T) 222.93177795410156
W0317 11:46:46.121098 3816768 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:46:46.124896 3811485 quantize_finetune_llama.py:197] layer 22 gpu 2
I0317 11:46:46.137710 3816768 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:46:47.582264 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 22 in 0.9919552803039551s
I0317 11:46:51.454506 3816894 config.py:54] PyTorch version 2.6.0 available.
W0317 11:46:51.779881 3816894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:46:52.749268 3816894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:46:52.753456 3811485 quantize_finetune_llama.py:197] layer 23 gpu 3
I0317 11:46:52.768611 3816894 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:46:54.424428 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 23 in 1.211862325668335s
I0317 11:46:58.485914 3817025 config.py:54] PyTorch version 2.6.0 available.
W0317 11:46:58.858594 3817025 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:46:59.914582 3817025 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:46:59.919207 3811485 quantize_finetune_llama.py:197] layer 24 gpu 0
I0317 11:46:59.934823 3817025 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.007093712221831083 tr(WHW.T) 990.5983276367188
20_q proxy err 0.001070297439582646 tr(WHW.T) 7150.947265625
20_k proxy err 0.000770215003285557 tr(WHW.T) 10386.2470703125
20_o proxy err 0.005374355707317591 tr(WHW.T) 100.31707000732422
20_up proxy err 0.005275154486298561 tr(WHW.T) 2340.89453125
20_gate proxy err 0.0031041735783219337 tr(WHW.T) 4024.62744140625
20_down proxy err 0.0060213059186935425 tr(WHW.T) 274.8815002441406
21_v proxy err 0.006954360753297806 tr(WHW.T) 1144.5655517578125
21_q proxy err 0.0012074023252353072 tr(WHW.T) 7064.314453125
21_k proxy err 0.0008942910353653133 tr(WHW.T) 9976.4658203125
21_o proxy err 0.0059111653827130795 tr(WHW.T) 75.50972747802734
21_up proxy err 0.005576062947511673 tr(WHW.T) 2361.650390625
21_gate proxy err 0.0033258297480642796 tr(WHW.T) 4004.37646484375
21_down proxy err 0.006166570819914341 tr(WHW.T) 276.5857849121094
I0317 11:47:23.818702 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 24 in 1.0794446468353271s
I0317 11:47:27.573194 3817410 config.py:54] PyTorch version 2.6.0 available.
W0317 11:47:27.894218 3817410 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.006552322767674923 tr(WHW.T) 1243.2529296875
22_q proxy err 0.001136339851655066 tr(WHW.T) 7746.84765625
22_k proxy err 0.000861183856613934 tr(WHW.T) 10603.2041015625
22_o proxy err 0.004809447564184666 tr(WHW.T) 114.30065155029297
22_up proxy err 0.0056152245961129665 tr(WHW.T) 2474.510498046875
22_gate proxy err 0.003384833224117756 tr(WHW.T) 4156.64013671875
22_down proxy err 0.006159518379718065 tr(WHW.T) 311.8800048828125
W0317 11:47:28.775759 3817410 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:47:28.779491 3811485 quantize_finetune_llama.py:197] layer 25 gpu 1
I0317 11:47:28.792421 3817410 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:47:30.172337 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 25 in 0.9257054328918457s
I0317 11:47:33.993859 3817526 config.py:54] PyTorch version 2.6.0 available.
W0317 11:47:34.326160 3817526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:47:35.288148 3817526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:47:35.292226 3811485 quantize_finetune_llama.py:197] layer 26 gpu 2
I0317 11:47:35.309213 3817526 data_utils.py:336] using 256 training seqs, 128 validation seqs
23_v proxy err 0.006188833620399237 tr(WHW.T) 1486.037353515625
23_q proxy err 0.0013200136600062251 tr(WHW.T) 7346.60986328125
23_k proxy err 0.00099754030816257 tr(WHW.T) 9982.2392578125
23_o proxy err 0.005737879779189825 tr(WHW.T) 85.13458251953125
23_up proxy err 0.005827711895108223 tr(WHW.T) 2533.51025390625
23_gate proxy err 0.0036498005501925945 tr(WHW.T) 4097.51953125
23_down proxy err 0.006163440179079771 tr(WHW.T) 321.33892822265625
I0317 11:47:37.373741 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 26 in 0.9600269794464111s
I0317 11:47:41.107453 3817666 config.py:54] PyTorch version 2.6.0 available.
W0317 11:47:41.413123 3817666 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:47:42.422095 3817666 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:47:42.426478 3811485 quantize_finetune_llama.py:197] layer 27 gpu 3
I0317 11:47:42.442749 3817666 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:47:43.921949 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 27 in 1.0048813819885254s
I0317 11:47:47.874117 3817787 config.py:54] PyTorch version 2.6.0 available.
W0317 11:47:48.197054 3817787 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:47:49.214705 3817787 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:47:49.219343 3811485 quantize_finetune_llama.py:197] layer 28 gpu 0
I0317 11:47:49.252436 3817787 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.006379902828484774 tr(WHW.T) 1394.900634765625
24_q proxy err 0.0013458033790811896 tr(WHW.T) 7020.447265625
24_k proxy err 0.0009541186736896634 tr(WHW.T) 10323.43359375
24_o proxy err 0.004498037975281477 tr(WHW.T) 133.98797607421875
24_up proxy err 0.005911649204790592 tr(WHW.T) 2621.76513671875
24_gate proxy err 0.0036752137821167707 tr(WHW.T) 4262.74853515625
24_down proxy err 0.006129651330411434 tr(WHW.T) 340.22412109375
25_v proxy err 0.006071460898965597 tr(WHW.T) 1707.664794921875
25_q proxy err 0.0015233067097142339 tr(WHW.T) 7162.16357421875
25_k proxy err 0.0011556578101590276 tr(WHW.T) 9611.58984375
25_o proxy err 0.005603644996881485 tr(WHW.T) 83.535888671875
25_up proxy err 0.005865118000656366 tr(WHW.T) 2805.728515625
25_gate proxy err 0.003570488654077053 tr(WHW.T) 4666.4404296875
25_down proxy err 0.005890937056392431 tr(WHW.T) 373.460693359375
I0317 11:48:12.951070 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 28 in 1.0274055004119873s
I0317 11:48:16.840762 3818157 config.py:54] PyTorch version 2.6.0 available.
W0317 11:48:17.185698 3818157 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.005919875111430883 tr(WHW.T) 1668.8843994140625
26_q proxy err 0.0013928284170106053 tr(WHW.T) 7469.98291015625
26_k proxy err 0.0010202795965597034 tr(WHW.T) 10487.8740234375
26_o proxy err 0.0037523244973272085 tr(WHW.T) 202.88172912597656
26_up proxy err 0.005487214308232069 tr(WHW.T) 3154.75146484375
26_gate proxy err 0.003307096427306533 tr(WHW.T) 5302.16455078125
26_down proxy err 0.006094112992286682 tr(WHW.T) 401.19390869140625
W0317 11:48:18.108633 3818157 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:48:18.112313 3811485 quantize_finetune_llama.py:197] layer 29 gpu 1
I0317 11:48:18.126081 3818157 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:48:20.067109 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 29 in 1.1903929710388184s
I0317 11:48:23.917452 3818280 config.py:54] PyTorch version 2.6.0 available.
W0317 11:48:24.242530 3818280 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.0057668122462928295 tr(WHW.T) 1799.3350830078125
27_q proxy err 0.0014110264601185918 tr(WHW.T) 7691.708984375
27_k proxy err 0.0010364576010033488 tr(WHW.T) 10618.70703125
27_o proxy err 0.0047811479307711124 tr(WHW.T) 126.13690185546875
27_up proxy err 0.004991760011762381 tr(WHW.T) 3691.557861328125
27_gate proxy err 0.0031110509298741817 tr(WHW.T) 5990.82568359375
27_down proxy err 0.006061000749468803 tr(WHW.T) 466.9318542480469
W0317 11:48:25.191415 3818280 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:48:25.195455 3811485 quantize_finetune_llama.py:197] layer 30 gpu 2
I0317 11:48:25.208817 3818280 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:48:26.997684 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 30 in 0.9303851127624512s
I0317 11:48:30.863609 3818416 config.py:54] PyTorch version 2.6.0 available.
W0317 11:48:31.200361 3818416 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:48:32.221825 3818416 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:48:32.226261 3811485 quantize_finetune_llama.py:197] layer 31 gpu 3
I0317 11:48:32.241594 3818416 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:48:33.730873 3811485 quantize_finetune_llama.py:228] computed original embedding for layer 31 in 0.9941754341125488s
I0317 11:48:37.664311 3818544 config.py:54] PyTorch version 2.6.0 available.
W0317 11:48:37.990384 3818544 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:48:39.118762 3818544 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:48:39.139525 3818544 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.005322723183780909 tr(WHW.T) 2018.944091796875
28_q proxy err 0.0014554482186213136 tr(WHW.T) 7651.126953125
28_k proxy err 0.0010737220291048288 tr(WHW.T) 10544.8251953125
28_o proxy err 0.003968582022935152 tr(WHW.T) 194.8240966796875
28_up proxy err 0.004166401457041502 tr(WHW.T) 4661.2666015625
28_gate proxy err 0.002987458137795329 tr(WHW.T) 6547.48193359375
28_down proxy err 0.0058196247555315495 tr(WHW.T) 603.8403930664062
29_v proxy err 0.0055801840499043465 tr(WHW.T) 1801.7730712890625
29_q proxy err 0.0014528853353112936 tr(WHW.T) 7227.0009765625
29_k proxy err 0.0010176580399274826 tr(WHW.T) 10558.609375
29_o proxy err 0.003552541136741638 tr(WHW.T) 207.9054412841797
29_up proxy err 0.0033203763887286186 tr(WHW.T) 6070.0498046875
29_gate proxy err 0.0027432760689407587 tr(WHW.T) 7369.6142578125
29_down proxy err 0.0056292954832315445 tr(WHW.T) 782.2448120117188
30_v proxy err 0.00479809520766139 tr(WHW.T) 2261.489501953125
30_q proxy err 0.0014482151018455625 tr(WHW.T) 7815.9453125
30_k proxy err 0.0010929348645731807 tr(WHW.T) 10521.625
30_o proxy err 0.0034343749284744263 tr(WHW.T) 251.96908569335938
30_up proxy err 0.00206592190079391 tr(WHW.T) 10016.376953125
30_gate proxy err 0.0018865696620196104 tr(WHW.T) 11001.119140625
30_down proxy err 0.0024337347131222486 tr(WHW.T) 3582.617919921875
31_v proxy err 0.005772049073129892 tr(WHW.T) 1268.2034912109375
31_q proxy err 0.0011400802759453654 tr(WHW.T) 6858.09130859375
31_k proxy err 0.0007825937354937196 tr(WHW.T) 10233.677734375
31_o proxy err 0.0026164106093347073 tr(WHW.T) 457.7950744628906
31_up proxy err 0.001188350492157042 tr(WHW.T) 14563.890625
31_gate proxy err 0.001175492536276579 tr(WHW.T) 14836.2939453125
31_down proxy err 0.0012700840597972274 tr(WHW.T) 17873.55859375
