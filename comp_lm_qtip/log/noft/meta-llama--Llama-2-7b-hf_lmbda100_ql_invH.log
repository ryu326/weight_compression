I0317 11:20:43.845674 3794058 config.py:54] PyTorch version 2.6.0 available.
W0317 11:20:44.127713 3794058 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:20:45.056483 3794058 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.34it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.92it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.17it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.29it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.29it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.11it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.10it/s]
I0317 11:20:45.996315 3794058 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:13,  2.28it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:12,  2.45it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:11,  2.55it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:10,  2.59it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:01<00:10,  2.64it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:09,  2.65it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:09,  2.66it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:08,  2.67it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:08,  2.66it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:03<00:08,  2.65it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:07,  2.64it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:04<00:07,  2.64it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:04<00:07,  2.64it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:06,  2.63it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:05<00:06,  2.63it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.49it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:08,  1.81it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:09,  1.52it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:09,  1.36it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:09<00:09,  1.29it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:10<00:08,  1.31it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:07,  1.30it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:11<00:06,  1.40it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:12<00:05,  1.55it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:12<00:04,  1.65it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:13<00:03,  1.52it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:14<00:03,  1.43it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:15<00:02,  1.38it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:16<00:02,  1.35it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:16<00:01,  1.32it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:17<00:00,  1.31it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:18<00:00,  1.44it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:18<00:00,  1.77it/s]
I0317 11:21:11.685607 3794058 quantize_finetune_llama.py:173] loaded compression model
I0317 11:21:26.089717 3794058 quantize_finetune_llama.py:177] loaded dataset and devset
I0317 11:21:34.986610 3794058 quantize_finetune_llama.py:197] layer 0 gpu 0
I0317 11:21:38.132485 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 0 in 2.9931228160858154s
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0317 11:21:52.291720 3795013 config.py:54] PyTorch version 2.6.0 available.
W0317 11:21:52.572540 3795013 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:21:53.440947 3795013 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:21:53.444952 3794058 quantize_finetune_llama.py:197] layer 1 gpu 1
I0317 11:21:53.457678 3795013 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:21:56.173092 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 1 in 2.560901165008545s
I0317 11:21:59.605906 3795151 config.py:54] PyTorch version 2.6.0 available.
W0317 11:21:59.929017 3795151 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:22:00.877046 3795151 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:22:00.880987 3794058 quantize_finetune_llama.py:197] layer 2 gpu 2
I0317 11:22:00.893877 3795151 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:22:03.886435 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 2 in 2.8483567237854004s
I0317 11:22:07.733544 3795306 config.py:54] PyTorch version 2.6.0 available.
W0317 11:22:08.080762 3795306 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:22:09.142876 3795306 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:22:09.146993 3794058 quantize_finetune_llama.py:197] layer 3 gpu 3
I0317 11:22:09.162353 3795306 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:22:12.969485 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 3 in 3.6426448822021484s
I0317 11:22:16.989594 3795463 config.py:54] PyTorch version 2.6.0 available.
W0317 11:22:17.338588 3795463 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:22:18.463371 3795463 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:22:18.467671 3794058 quantize_finetune_llama.py:197] layer 4 gpu 0
I0317 11:22:18.484251 3795463 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.03551289439201355 tr(WHW.T) 4.225186347961426
0_q proxy err 9.582675556885079e-05 tr(WHW.T) 2710.363037109375
0_k proxy err 0.00013170136662665755 tr(WHW.T) 1698.7349853515625
0_o proxy err 0.003975079394876957 tr(WHW.T) 0.9668058156967163
0_up proxy err 0.010182581841945648 tr(WHW.T) 43.27138900756836
0_gate proxy err 0.007023063022643328 tr(WHW.T) 63.47430419921875
0_down proxy err 0.005886770319193602 tr(WHW.T) 0.656814694404602
1_v proxy err 0.08861367404460907 tr(WHW.T) 16.465883255004883
1_q proxy err 0.00039764444227330387 tr(WHW.T) 4778.43994140625
1_k proxy err 0.00038334212149493396 tr(WHW.T) 4995.39208984375
1_o proxy err 0.021594595164060593 tr(WHW.T) 1.1115814447402954
1_up proxy err 0.013892891816794872 tr(WHW.T) 109.66383361816406
1_gate proxy err 0.00715656578540802 tr(WHW.T) 221.3038787841797
1_down proxy err 0.0007374377455562353 tr(WHW.T) 2041.4736328125
I0317 11:22:38.857437 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 4 in 0.9033803939819336s
I0317 11:22:42.744558 3795806 config.py:54] PyTorch version 2.6.0 available.
W0317 11:22:43.075978 3795806 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:22:44.059357 3795806 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:22:44.063630 3794058 quantize_finetune_llama.py:197] layer 5 gpu 1
I0317 11:22:44.079731 3795806 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.01830691285431385 tr(WHW.T) 136.67332458496094
2_q proxy err 0.00039842803380452096 tr(WHW.T) 7752.85205078125
2_k proxy err 0.00030834259814582765 tr(WHW.T) 10205.837890625
2_o proxy err 0.018958142027258873 tr(WHW.T) 1.4603197574615479
2_up proxy err 0.016279060393571854 tr(WHW.T) 193.43603515625
2_gate proxy err 0.01057305559515953 tr(WHW.T) 306.6622619628906
2_down proxy err 0.016543274745345116 tr(WHW.T) 3.010739803314209
I0317 11:22:47.351923 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 5 in 1.0149962902069092s
I0317 11:22:51.219159 3795954 config.py:54] PyTorch version 2.6.0 available.
W0317 11:22:51.547528 3795954 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:22:52.509388 3795954 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:22:52.513474 3794058 quantize_finetune_llama.py:197] layer 6 gpu 2
I0317 11:22:52.528020 3795954 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.024714620783925056 tr(WHW.T) 284.77557373046875
3_q proxy err 0.0011612853268161416 tr(WHW.T) 7217.63720703125
3_k proxy err 0.0008417075150646269 tr(WHW.T) 10074.73828125
3_o proxy err 0.0162992961704731 tr(WHW.T) 3.3527450561523438
3_up proxy err 0.01851465553045273 tr(WHW.T) 284.7950744628906
3_gate proxy err 0.011389203369617462 tr(WHW.T) 478.13714599609375
3_down proxy err 0.01689789816737175 tr(WHW.T) 6.133229732513428
I0317 11:23:03.865670 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 6 in 0.9331588745117188s
I0317 11:23:07.718363 3796204 config.py:54] PyTorch version 2.6.0 available.
W0317 11:23:08.067034 3796204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:23:09.093651 3796204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:23:09.097998 3794058 quantize_finetune_llama.py:197] layer 7 gpu 3
I0317 11:23:09.112674 3796204 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:23:10.653185 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 7 in 1.0479788780212402s
I0317 11:23:14.470518 3796326 config.py:54] PyTorch version 2.6.0 available.
W0317 11:23:14.826226 3796326 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:23:15.898053 3796326 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:23:15.902462 3794058 quantize_finetune_llama.py:197] layer 8 gpu 0
I0317 11:23:15.928380 3796326 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.022412432357668877 tr(WHW.T) 274.6131286621094
4_q proxy err 0.0010589765151962638 tr(WHW.T) 6914.9892578125
4_k proxy err 0.000713883142452687 tr(WHW.T) 10415.33203125
4_o proxy err 0.018807243555784225 tr(WHW.T) 5.139806270599365
4_up proxy err 0.017951203510165215 tr(WHW.T) 397.6960144042969
4_gate proxy err 0.009092623367905617 tr(WHW.T) 821.1856689453125
4_down proxy err 0.017147179692983627 tr(WHW.T) 11.562739372253418
5_v proxy err 0.021374709904193878 tr(WHW.T) 298.47540283203125
5_q proxy err 0.001109840115532279 tr(WHW.T) 6770.97509765625
5_k proxy err 0.0007102666422724724 tr(WHW.T) 10841.955078125
5_o proxy err 0.020956087857484818 tr(WHW.T) 7.947142601013184
5_up proxy err 0.017735257744789124 tr(WHW.T) 506.6408386230469
5_gate proxy err 0.008535271510481834 tr(WHW.T) 1104.867919921875
5_down proxy err 0.018390294164419174 tr(WHW.T) 15.6494779586792
I0317 11:23:30.176923 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 8 in 1.063927173614502s
I0317 11:23:34.064426 3796603 config.py:54] PyTorch version 2.6.0 available.
W0317 11:23:34.424761 3796603 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:23:35.455589 3796603 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:23:35.459763 3794058 quantize_finetune_llama.py:197] layer 9 gpu 1
I0317 11:23:35.473633 3796603 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.023792605847120285 tr(WHW.T) 443.5464782714844
6_q proxy err 0.001607532612979412 tr(WHW.T) 7576.53857421875
6_k proxy err 0.0011925848666578531 tr(WHW.T) 10409.4033203125
6_o proxy err 0.023484336212277412 tr(WHW.T) 11.564380645751953
6_up proxy err 0.01727938838303089 tr(WHW.T) 617.2608642578125
6_gate proxy err 0.007231337483972311 tr(WHW.T) 1554.7271728515625
6_down proxy err 0.018773242831230164 tr(WHW.T) 22.988168716430664
I0317 11:23:47.155440 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 9 in 1.0345251560211182s
I0317 11:23:50.904942 3796849 config.py:54] PyTorch version 2.6.0 available.
W0317 11:23:51.241927 3796849 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:23:52.237210 3796849 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:23:52.241493 3794058 quantize_finetune_llama.py:197] layer 10 gpu 2
I0317 11:23:52.258840 3796849 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.023420831188559532 tr(WHW.T) 489.9357604980469
7_q proxy err 0.0017336764140054584 tr(WHW.T) 7672.17919921875
7_k proxy err 0.0013144389959052205 tr(WHW.T) 10198.3701171875
7_o proxy err 0.02673310600221157 tr(WHW.T) 15.11335563659668
7_up proxy err 0.016696464270353317 tr(WHW.T) 735.8538818359375
7_gate proxy err 0.006880896631628275 tr(WHW.T) 1876.0390625
7_down proxy err 0.01893678307533264 tr(WHW.T) 30.58672523498535
I0317 11:24:00.920965 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 10 in 1.0328648090362549s
I0317 11:24:04.596585 3797073 config.py:54] PyTorch version 2.6.0 available.
W0317 11:24:04.937065 3797073 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:24:05.990690 3797073 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:24:05.994908 3794058 quantize_finetune_llama.py:197] layer 11 gpu 3
I0317 11:24:06.011157 3797073 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:24:07.850872 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 11 in 1.3493163585662842s
8_v proxy err 0.020281944423913956 tr(WHW.T) 530.9967041015625
8_q proxy err 0.0017111962661147118 tr(WHW.T) 7228.1201171875
8_k proxy err 0.0011784713715314865 tr(WHW.T) 10639.1015625
8_o proxy err 0.030302319675683975 tr(WHW.T) 20.092191696166992
8_up proxy err 0.015009469352662563 tr(WHW.T) 866.312744140625
8_gate proxy err 0.006827839184552431 tr(WHW.T) 1970.857177734375
8_down proxy err 0.018935345113277435 tr(WHW.T) 37.177734375
I0317 11:24:11.817631 3797201 config.py:54] PyTorch version 2.6.0 available.
W0317 11:24:12.132221 3797201 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:24:13.102445 3797201 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:24:13.106679 3794058 quantize_finetune_llama.py:197] layer 12 gpu 0
I0317 11:24:13.122963 3797201 data_utils.py:336] using 256 training seqs, 128 validation seqs
9_v proxy err 0.020103054121136665 tr(WHW.T) 565.0663452148438
9_q proxy err 0.0018762571271508932 tr(WHW.T) 6970.3359375
9_k proxy err 0.0012078480795025826 tr(WHW.T) 10987.3515625
9_o proxy err 0.030945373699069023 tr(WHW.T) 25.610172271728516
9_up proxy err 0.014401066116988659 tr(WHW.T) 970.8984375
9_gate proxy err 0.006752807181328535 tr(WHW.T) 2132.69384765625
9_down proxy err 0.01915239356458187 tr(WHW.T) 42.99482727050781
I0317 11:24:30.447404 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 12 in 1.113917589187622s
I0317 11:24:34.303705 3797498 config.py:54] PyTorch version 2.6.0 available.
W0317 11:24:34.627219 3797498 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:24:35.629852 3797498 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:24:35.634111 3794058 quantize_finetune_llama.py:197] layer 13 gpu 1
I0317 11:24:35.648344 3797498 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.02018655650317669 tr(WHW.T) 578.807373046875
10_q proxy err 0.0019394176779314876 tr(WHW.T) 6915.87109375
10_k proxy err 0.0012365927686914802 tr(WHW.T) 10996.2431640625
10_o proxy err 0.032402921468019485 tr(WHW.T) 35.184165954589844
10_up proxy err 0.013578486628830433 tr(WHW.T) 1080.198486328125
10_gate proxy err 0.006657106336206198 tr(WHW.T) 2260.88330078125
10_down proxy err 0.01813906617462635 tr(WHW.T) 52.33584976196289
I0317 11:24:43.729779 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 13 in 1.1222786903381348s
I0317 11:24:47.372729 3797709 config.py:54] PyTorch version 2.6.0 available.
W0317 11:24:47.649868 3797709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:24:48.617134 3797709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:24:48.621235 3794058 quantize_finetune_llama.py:197] layer 14 gpu 2
I0317 11:24:48.634966 3797709 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.020082706585526466 tr(WHW.T) 723.1956176757812
11_q proxy err 0.002301985863596201 tr(WHW.T) 7027.10986328125
11_k proxy err 0.001555349095724523 tr(WHW.T) 10511.23046875
11_o proxy err 0.0319761224091053 tr(WHW.T) 36.654052734375
11_up proxy err 0.01392354629933834 tr(WHW.T) 1139.6044921875
11_gate proxy err 0.006785485427826643 tr(WHW.T) 2392.716552734375
11_down proxy err 0.018811775371432304 tr(WHW.T) 56.13530731201172
I0317 11:24:58.678688 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 14 in 1.1377816200256348s
I0317 11:25:02.504377 3797938 config.py:54] PyTorch version 2.6.0 available.
W0317 11:25:02.858876 3797938 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:25:03.887216 3797938 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:25:03.891543 3794058 quantize_finetune_llama.py:197] layer 15 gpu 3
I0317 11:25:03.907675 3797938 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:25:05.444474 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 15 in 1.0847148895263672s
I0317 11:25:09.458972 3798064 config.py:54] PyTorch version 2.6.0 available.
W0317 11:25:09.816755 3798064 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:25:10.832829 3798064 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:25:10.837260 3794058 quantize_finetune_llama.py:197] layer 16 gpu 0
I0317 11:25:10.851475 3798064 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.02064632996916771 tr(WHW.T) 703.318603515625
12_q proxy err 0.0023308584932237864 tr(WHW.T) 7045.6435546875
12_k proxy err 0.0015300580998882651 tr(WHW.T) 10893.65625
12_o proxy err 0.03386179730296135 tr(WHW.T) 39.29071044921875
12_up proxy err 0.01383192278444767 tr(WHW.T) 1228.298583984375
12_gate proxy err 0.0072597782127559185 tr(WHW.T) 2381.994873046875
12_down proxy err 0.018692290410399437 tr(WHW.T) 64.17745208740234
13_v proxy err 0.021212361752986908 tr(WHW.T) 714.5677490234375
13_q proxy err 0.0024427599273622036 tr(WHW.T) 6956.03564453125
13_k proxy err 0.0016512761358171701 tr(WHW.T) 10426.6318359375
13_o proxy err 0.029657673090696335 tr(WHW.T) 45.8377571105957
13_up proxy err 0.013320177793502808 tr(WHW.T) 1367.6221923828125
13_gate proxy err 0.007109300699084997 tr(WHW.T) 2601.504638671875
13_down proxy err 0.018384765833616257 tr(WHW.T) 79.3589096069336
I0317 11:25:26.006227 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 16 in 0.9972712993621826s
I0317 11:25:29.893782 3798358 config.py:54] PyTorch version 2.6.0 available.
W0317 11:25:30.228364 3798358 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:25:31.284324 3798358 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:25:31.288862 3794058 quantize_finetune_llama.py:197] layer 17 gpu 1
I0317 11:25:31.303906 3798358 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.022418560460209846 tr(WHW.T) 706.1612548828125
14_q proxy err 0.0025240739341825247 tr(WHW.T) 7077.06103515625
14_k proxy err 0.0015988422092050314 tr(WHW.T) 11295.16796875
14_o proxy err 0.033886756747961044 tr(WHW.T) 50.921180725097656
14_up proxy err 0.013579025864601135 tr(WHW.T) 1464.7159423828125
14_gate proxy err 0.007524179294705391 tr(WHW.T) 2682.584716796875
14_down proxy err 0.01869453489780426 tr(WHW.T) 90.28684997558594
I0317 11:25:42.053075 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 17 in 1.306464672088623s
I0317 11:25:45.806459 3798594 config.py:54] PyTorch version 2.6.0 available.
W0317 11:25:46.164285 3798594 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:25:47.188755 3798594 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:25:47.193066 3794058 quantize_finetune_llama.py:197] layer 18 gpu 2
I0317 11:25:47.209494 3798594 data_utils.py:336] using 256 training seqs, 128 validation seqs
15_v proxy err 0.020157016813755035 tr(WHW.T) 762.7275390625
15_q proxy err 0.0023645665496587753 tr(WHW.T) 7252.0009765625
15_k proxy err 0.0015755553031340241 tr(WHW.T) 11072.3974609375
15_o proxy err 0.02777932770550251 tr(WHW.T) 59.61664962768555
15_up proxy err 0.01319076493382454 tr(WHW.T) 1641.0228271484375
15_gate proxy err 0.007557321805506945 tr(WHW.T) 2905.140380859375
15_down proxy err 0.018473351374268532 tr(WHW.T) 114.09001922607422
I0317 11:25:54.377735 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 18 in 1.0868470668792725s
I0317 11:25:58.239087 3798776 config.py:54] PyTorch version 2.6.0 available.
W0317 11:25:58.553039 3798776 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:25:59.488303 3798776 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:25:59.492403 3794058 quantize_finetune_llama.py:197] layer 19 gpu 3
I0317 11:25:59.506025 3798776 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:26:00.965609 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 19 in 1.0005149841308594s
I0317 11:26:04.909527 3798918 config.py:54] PyTorch version 2.6.0 available.
W0317 11:26:05.238819 3798918 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:26:06.200161 3798918 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:26:06.204498 3794058 quantize_finetune_llama.py:197] layer 20 gpu 0
I0317 11:26:06.220627 3798918 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.021151620894670486 tr(WHW.T) 780.7407836914062
16_q proxy err 0.0025291573256254196 tr(WHW.T) 7193.3974609375
16_k proxy err 0.0015881246654316783 tr(WHW.T) 11630.361328125
16_o proxy err 0.02320612594485283 tr(WHW.T) 88.22785186767578
16_up proxy err 0.013241054490208626 tr(WHW.T) 1890.9385986328125
16_gate proxy err 0.007560534868389368 tr(WHW.T) 3369.859130859375
16_down proxy err 0.01866297237575054 tr(WHW.T) 152.0294952392578
17_v proxy err 0.020947713404893875 tr(WHW.T) 845.7654418945312
17_q proxy err 0.002732290420681238 tr(WHW.T) 7163.2734375
17_k proxy err 0.001849807915277779 tr(WHW.T) 10697.431640625
17_o proxy err 0.024644114077091217 tr(WHW.T) 58.14826965332031
17_up proxy err 0.014634205028414726 tr(WHW.T) 1921.07861328125
17_gate proxy err 0.008031681180000305 tr(WHW.T) 3571.31640625
17_down proxy err 0.01889408752322197 tr(WHW.T) 165.43495178222656
I0317 11:26:24.846672 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 20 in 1.015202283859253s
I0317 11:26:28.618050 3799237 config.py:54] PyTorch version 2.6.0 available.
W0317 11:26:28.977843 3799237 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:26:30.077656 3799237 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:26:30.081928 3794058 quantize_finetune_llama.py:197] layer 21 gpu 1
I0317 11:26:30.096597 3799237 data_utils.py:336] using 256 training seqs, 128 validation seqs
18_v proxy err 0.01993011310696602 tr(WHW.T) 1003.7705078125
18_q proxy err 0.002912340220063925 tr(WHW.T) 7510.48046875
18_k proxy err 0.002106565050780773 tr(WHW.T) 10462.6650390625
18_o proxy err 0.02113202214241028 tr(WHW.T) 69.96558380126953
18_up proxy err 0.015693796798586845 tr(WHW.T) 2023.183837890625
18_gate proxy err 0.008601672947406769 tr(WHW.T) 3783.076416015625
18_down proxy err 0.018483253195881844 tr(WHW.T) 198.52699279785156
I0317 11:26:36.908604 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 21 in 0.9949183464050293s
I0317 11:26:40.792739 3799416 config.py:54] PyTorch version 2.6.0 available.
W0317 11:26:41.113337 3799416 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.019658444449305534 tr(WHW.T) 1019.1412353515625
19_q proxy err 0.003119274042546749 tr(WHW.T) 6944.4130859375
19_k proxy err 0.0020763271022588015 tr(WHW.T) 10548.4892578125
19_o proxy err 0.021289851516485214 tr(WHW.T) 62.291683197021484
19_up proxy err 0.015836987644433975 tr(WHW.T) 2149.330322265625
19_gate proxy err 0.009450845420360565 tr(WHW.T) 3687.5126953125
19_down proxy err 0.01802493818104267 tr(WHW.T) 222.93177795410156
W0317 11:26:42.009176 3799416 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:26:42.012918 3794058 quantize_finetune_llama.py:197] layer 22 gpu 2
I0317 11:26:42.025884 3799416 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:26:43.501139 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 22 in 1.0260944366455078s
I0317 11:26:47.450706 3799548 config.py:54] PyTorch version 2.6.0 available.
W0317 11:26:47.798341 3799548 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:26:48.819988 3799548 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:26:48.824273 3794058 quantize_finetune_llama.py:197] layer 23 gpu 3
I0317 11:26:48.840908 3799548 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:26:50.447146 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 23 in 1.1527607440948486s
I0317 11:26:54.401723 3799673 config.py:54] PyTorch version 2.6.0 available.
W0317 11:26:54.761669 3799673 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:26:55.875721 3799673 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:26:55.883379 3794058 quantize_finetune_llama.py:197] layer 24 gpu 0
I0317 11:26:55.904564 3799673 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.02065296657383442 tr(WHW.T) 990.5983276367188
20_q proxy err 0.003080773865804076 tr(WHW.T) 7150.947265625
20_k proxy err 0.0021451625507324934 tr(WHW.T) 10386.2470703125
20_o proxy err 0.015593447722494602 tr(WHW.T) 100.31707000732422
20_up proxy err 0.015603750944137573 tr(WHW.T) 2340.89453125
20_gate proxy err 0.009317398071289062 tr(WHW.T) 4024.62744140625
20_down proxy err 0.017595285549759865 tr(WHW.T) 274.8815002441406
21_v proxy err 0.020313475281000137 tr(WHW.T) 1144.5655517578125
21_q proxy err 0.0034888023510575294 tr(WHW.T) 7064.314453125
21_k proxy err 0.0024913453962653875 tr(WHW.T) 9976.4658203125
21_o proxy err 0.017223689705133438 tr(WHW.T) 75.50972747802734
21_up proxy err 0.016479987651109695 tr(WHW.T) 2361.650390625
21_gate proxy err 0.009989311918616295 tr(WHW.T) 4004.37646484375
21_down proxy err 0.01803094893693924 tr(WHW.T) 276.5857849121094
I0317 11:27:19.221908 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 24 in 1.0065009593963623s
I0317 11:27:23.129749 3800058 config.py:54] PyTorch version 2.6.0 available.
W0317 11:27:23.447559 3800058 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.019200680777430534 tr(WHW.T) 1243.2529296875
22_q proxy err 0.0032933889888226986 tr(WHW.T) 7746.84765625
22_k proxy err 0.0024250017013400793 tr(WHW.T) 10603.2041015625
22_o proxy err 0.013912810944020748 tr(WHW.T) 114.30065155029297
22_up proxy err 0.01660044491291046 tr(WHW.T) 2474.510498046875
22_gate proxy err 0.010175462812185287 tr(WHW.T) 4156.64013671875
22_down proxy err 0.018038736656308174 tr(WHW.T) 311.8800048828125
W0317 11:27:24.333105 3800058 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:27:24.336795 3794058 quantize_finetune_llama.py:197] layer 25 gpu 1
I0317 11:27:24.349511 3800058 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:27:25.766918 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 25 in 0.9522404670715332s
I0317 11:27:29.531733 3800174 config.py:54] PyTorch version 2.6.0 available.
W0317 11:27:29.858562 3800174 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:27:30.826762 3800174 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:27:30.830887 3794058 quantize_finetune_llama.py:197] layer 26 gpu 2
I0317 11:27:30.846517 3800174 data_utils.py:336] using 256 training seqs, 128 validation seqs
23_v proxy err 0.01823795586824417 tr(WHW.T) 1486.037353515625
23_q proxy err 0.003882376477122307 tr(WHW.T) 7346.60986328125
23_k proxy err 0.0028771357610821724 tr(WHW.T) 9982.2392578125
23_o proxy err 0.01685319095849991 tr(WHW.T) 85.13458251953125
23_up proxy err 0.01722632348537445 tr(WHW.T) 2533.51025390625
23_gate proxy err 0.0109774861484766 tr(WHW.T) 4097.51953125
23_down proxy err 0.01804918795824051 tr(WHW.T) 321.33892822265625
I0317 11:27:33.085466 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 26 in 0.96565842628479s
I0317 11:27:36.739576 3800314 config.py:54] PyTorch version 2.6.0 available.
W0317 11:27:37.074664 3800314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:27:38.149648 3800314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:27:38.154046 3794058 quantize_finetune_llama.py:197] layer 27 gpu 3
I0317 11:27:38.170768 3800314 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:27:39.580343 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 27 in 0.933696985244751s
I0317 11:27:43.434351 3800435 config.py:54] PyTorch version 2.6.0 available.
W0317 11:27:43.758980 3800435 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:27:44.815527 3800435 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:27:44.819933 3794058 quantize_finetune_llama.py:197] layer 28 gpu 0
I0317 11:27:44.844512 3800435 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.01876893825829029 tr(WHW.T) 1394.900634765625
24_q proxy err 0.003896962385624647 tr(WHW.T) 7020.447265625
24_k proxy err 0.002662643091753125 tr(WHW.T) 10323.43359375
24_o proxy err 0.013104995712637901 tr(WHW.T) 133.98797607421875
24_up proxy err 0.01748814806342125 tr(WHW.T) 2621.76513671875
24_gate proxy err 0.01103940885514021 tr(WHW.T) 4262.74853515625
24_down proxy err 0.01795646734535694 tr(WHW.T) 340.22412109375
25_v proxy err 0.01798541657626629 tr(WHW.T) 1707.664794921875
25_q proxy err 0.004479868803173304 tr(WHW.T) 7162.16357421875
25_k proxy err 0.0033422193955630064 tr(WHW.T) 9611.58984375
25_o proxy err 0.016520963981747627 tr(WHW.T) 83.535888671875
25_up proxy err 0.017357749864459038 tr(WHW.T) 2805.728515625
25_gate proxy err 0.010716486722230911 tr(WHW.T) 4666.4404296875
25_down proxy err 0.01722596399486065 tr(WHW.T) 373.460693359375
I0317 11:28:07.981291 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 28 in 0.9566402435302734s
I0317 11:28:11.782518 3800798 config.py:54] PyTorch version 2.6.0 available.
W0317 11:28:12.144897 3800798 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:28:13.130992 3800798 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:28:13.134670 3794058 quantize_finetune_llama.py:197] layer 29 gpu 1
I0317 11:28:13.147412 3800798 data_utils.py:336] using 256 training seqs, 128 validation seqs
26_v proxy err 0.017575932666659355 tr(WHW.T) 1668.8843994140625
26_q proxy err 0.004065931309014559 tr(WHW.T) 7469.98291015625
26_k proxy err 0.00292084994725883 tr(WHW.T) 10487.8740234375
26_o proxy err 0.010920371860265732 tr(WHW.T) 202.88172912597656
26_up proxy err 0.01626080647110939 tr(WHW.T) 3154.75146484375
26_gate proxy err 0.009933611378073692 tr(WHW.T) 5302.16455078125
26_down proxy err 0.01787704974412918 tr(WHW.T) 401.19390869140625
I0317 11:28:15.543576 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 29 in 1.1680505275726318s
I0317 11:28:19.666476 3800931 config.py:54] PyTorch version 2.6.0 available.
W0317 11:28:19.984894 3800931 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.017152201384305954 tr(WHW.T) 1799.3350830078125
27_q proxy err 0.004237728659063578 tr(WHW.T) 7691.708984375
27_k proxy err 0.0031019970774650574 tr(WHW.T) 10618.70703125
27_o proxy err 0.01406812947243452 tr(WHW.T) 126.13690185546875
27_up proxy err 0.014811302535235882 tr(WHW.T) 3691.557861328125
27_gate proxy err 0.009341455064713955 tr(WHW.T) 5990.82568359375
27_down proxy err 0.017734451219439507 tr(WHW.T) 466.9318542480469
W0317 11:28:21.016211 3800931 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:28:21.020530 3794058 quantize_finetune_llama.py:197] layer 30 gpu 2
I0317 11:28:21.035021 3800931 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:28:22.337106 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 30 in 0.9265792369842529s
I0317 11:28:26.099581 3801057 config.py:54] PyTorch version 2.6.0 available.
W0317 11:28:26.440382 3801057 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:28:27.427658 3801057 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:28:27.431961 3794058 quantize_finetune_llama.py:197] layer 31 gpu 3
I0317 11:28:27.447555 3801057 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:28:28.886291 3794058 quantize_finetune_llama.py:228] computed original embedding for layer 31 in 0.9552228450775146s
I0317 11:28:32.696101 3801185 config.py:54] PyTorch version 2.6.0 available.
W0317 11:28:33.038843 3801185 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:28:34.105600 3801185 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:28:34.132490 3801185 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.015922939404845238 tr(WHW.T) 2018.944091796875
28_q proxy err 0.004371083341538906 tr(WHW.T) 7651.126953125
28_k proxy err 0.003201928688213229 tr(WHW.T) 10544.8251953125
28_o proxy err 0.011671037413179874 tr(WHW.T) 194.8240966796875
28_up proxy err 0.012394644320011139 tr(WHW.T) 4661.2666015625
28_gate proxy err 0.008969963528215885 tr(WHW.T) 6547.48193359375
28_down proxy err 0.01698547787964344 tr(WHW.T) 603.8403930664062
29_v proxy err 0.016711782664060593 tr(WHW.T) 1801.7730712890625
29_q proxy err 0.004313949961215258 tr(WHW.T) 7227.0009765625
29_k proxy err 0.0029850907158106565 tr(WHW.T) 10558.609375
29_o proxy err 0.010528890416026115 tr(WHW.T) 207.9054412841797
29_up proxy err 0.009921879507601261 tr(WHW.T) 6070.0498046875
29_gate proxy err 0.008240939117968082 tr(WHW.T) 7369.6142578125
29_down proxy err 0.01634702831506729 tr(WHW.T) 782.2448120117188
30_v proxy err 0.014433792792260647 tr(WHW.T) 2261.489501953125
30_q proxy err 0.004354188218712807 tr(WHW.T) 7815.9453125
30_k proxy err 0.0032835891470313072 tr(WHW.T) 10521.625
30_o proxy err 0.010140791535377502 tr(WHW.T) 251.96908569335938
30_up proxy err 0.0062037864699959755 tr(WHW.T) 10016.376953125
30_gate proxy err 0.0056668855249881744 tr(WHW.T) 11001.119140625
30_down proxy err 0.006352217402309179 tr(WHW.T) 3582.617919921875
31_v proxy err 0.017077939584851265 tr(WHW.T) 1268.2034912109375
31_q proxy err 0.0034752110950648785 tr(WHW.T) 6858.09130859375
31_k proxy err 0.0023841485381126404 tr(WHW.T) 10233.677734375
31_o proxy err 0.007443507667630911 tr(WHW.T) 457.7950744628906
31_up proxy err 0.0036324786487966776 tr(WHW.T) 14563.890625
31_gate proxy err 0.0035890531726181507 tr(WHW.T) 14836.2939453125
31_down proxy err 0.0032855705358088017 tr(WHW.T) 17873.55859375
