I0318 09:07:47.112957 483407 config.py:54] PyTorch version 2.6.0 available.
W0318 09:07:47.401633 483407 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:07:48.293625 483407 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.24it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.92it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.17it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.35it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.44it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.37it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.25it/s]
I0318 09:07:49.227632 483407 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:13,  2.26it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:12,  2.31it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:12,  2.40it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:11,  2.44it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:11,  2.43it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:10,  2.45it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:10,  2.44it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:09,  2.45it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:09,  2.45it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:08,  2.50it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.52it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:04<00:07,  2.53it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.53it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.55it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:06,  2.55it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.55it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:06<00:05,  2.57it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.58it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:07<00:05,  2.58it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:07<00:04,  2.57it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.57it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:08<00:03,  2.58it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.59it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:09<00:03,  2.59it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:09<00:02,  2.60it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.61it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:10<00:01,  2.61it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.62it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:11<00:01,  2.63it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:11<00:00,  2.62it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.62it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.61it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.54it/s]
I0318 09:08:06.828903 483407 quantize_finetune_llama.py:179] loaded compression model
I0318 09:08:20.582317 483407 quantize_finetune_llama.py:183] loaded dataset and devset
I0318 09:08:26.255385 483407 quantize_finetune_llama.py:203] layer 0 gpu 0
I0318 09:08:28.869476 483407 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 2.455528497695923s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0318 09:08:43.977339 484238 config.py:54] PyTorch version 2.6.0 available.
W0318 09:08:44.258720 484238 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:08:45.133213 484238 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:08:45.137147 483407 quantize_finetune_llama.py:203] layer 1 gpu 1
I0318 09:08:45.150513 484238 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:08:49.724618 483407 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 4.418270587921143s
I0318 09:08:53.257061 484398 config.py:54] PyTorch version 2.6.0 available.
W0318 09:08:53.551399 484398 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:08:54.443095 484398 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:08:54.446929 483407 quantize_finetune_llama.py:203] layer 2 gpu 2
I0318 09:08:54.461605 484398 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:08:57.982933 483407 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 3.353381633758545s
I0318 09:09:01.671022 484545 config.py:54] PyTorch version 2.6.0 available.
W0318 09:09:02.002033 484545 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:09:02.948941 484545 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:09:02.953022 483407 quantize_finetune_llama.py:203] layer 3 gpu 3
I0318 09:09:02.969267 484545 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:09:05.975213 483407 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 2.8576865196228027s
I0318 09:09:09.844840 484685 config.py:54] PyTorch version 2.6.0 available.
W0318 09:09:10.182866 484685 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:09:11.280866 484685 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:09:11.285244 483407 quantize_finetune_llama.py:203] layer 4 gpu 0
I0318 09:09:11.300015 484685 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.03690407797694206 tr(WHW.T) 4.225186347961426
bpp_loss 3.4427109956741333
0_q proxy err 0.00014568428741768003 tr(WHW.T) 2710.363037109375
bpp_loss 3.587999939918518
0_k proxy err 0.000183776966878213 tr(WHW.T) 1698.7349853515625
bpp_loss 3.683703899383545
0_o proxy err 0.002342281863093376 tr(WHW.T) 0.9668058156967163
bpp_loss 3.2662813663482666
0_up proxy err 0.004436045419424772 tr(WHW.T) 43.27138900756836
bpp_loss 3.7472069318904433
0_gate proxy err 0.003079617628827691 tr(WHW.T) 63.47430419921875
bpp_loss 3.7655503029047055
0_down proxy err 0.0030718462076038122 tr(WHW.T) 0.656814694404602
bpp_loss 3.7936989983846976
1_v proxy err 0.05441528186202049 tr(WHW.T) 16.465883255004883
bpp_loss 3.3910272121429443
1_q proxy err 0.00025619962252676487 tr(WHW.T) 4778.43994140625
bpp_loss 4.489997863769531
1_k proxy err 0.00024948507780209184 tr(WHW.T) 4995.39208984375
bpp_loss 4.486672401428223
1_o proxy err 0.009950879029929638 tr(WHW.T) 1.1115814447402954
bpp_loss 3.308582305908203
1_up proxy err 0.0047308774664998055 tr(WHW.T) 109.66383361816406
bpp_loss 3.8161975949309594
1_gate proxy err 0.0023894058540463448 tr(WHW.T) 221.3038787841797
bpp_loss 3.8897639429846476
1_down proxy err 0.002697211457416415 tr(WHW.T) 2041.4736328125
bpp_loss 3.833650500275368
I0318 09:09:52.228272 483407 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.8539562225341797s
I0318 09:09:56.080385 485282 config.py:54] PyTorch version 2.6.0 available.
W0318 09:09:56.428540 485282 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:09:57.427178 485282 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:09:57.431439 483407 quantize_finetune_llama.py:203] layer 5 gpu 1
I0318 09:09:57.447973 485282 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.01324519794434309 tr(WHW.T) 136.67332458496094
bpp_loss 3.632700562477112
2_q proxy err 0.0002926624729298055 tr(WHW.T) 7752.85205078125
bpp_loss 4.503306150436401
2_k proxy err 0.00023655110271647573 tr(WHW.T) 10205.837890625
bpp_loss 4.607240676879883
2_o proxy err 0.007645514793694019 tr(WHW.T) 1.4603197574615479
bpp_loss 3.6065714359283447
2_up proxy err 0.005526430904865265 tr(WHW.T) 193.43603515625
bpp_loss 3.837212318597838
2_gate proxy err 0.0035271167289465666 tr(WHW.T) 306.6622619628906
bpp_loss 3.9255497067473657
2_down proxy err 0.006376281846314669 tr(WHW.T) 3.010739803314209
bpp_loss 3.845270334288131
I0318 09:10:00.594708 483407 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 0.8821258544921875s
I0318 09:10:04.214174 485423 config.py:54] PyTorch version 2.6.0 available.
W0318 09:10:04.575269 485423 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:10:05.580653 485423 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:10:05.584874 483407 quantize_finetune_llama.py:203] layer 6 gpu 2
I0318 09:10:05.599911 485423 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.012683166190981865 tr(WHW.T) 284.77557373046875
bpp_loss 3.5876224040985107
3_q proxy err 0.0005733387661166489 tr(WHW.T) 7217.63720703125
bpp_loss 4.395845651626587
3_k proxy err 0.0004238333203829825 tr(WHW.T) 10074.73828125
bpp_loss 4.472773790359497
3_o proxy err 0.007620599120855331 tr(WHW.T) 3.3527450561523438
bpp_loss 3.570375442504883
3_up proxy err 0.006285419221967459 tr(WHW.T) 284.7950744628906
bpp_loss 3.8457224646279977
3_gate proxy err 0.0037849245127290487 tr(WHW.T) 478.13714599609375
bpp_loss 3.9446982450263444
3_down proxy err 0.006507116369903088 tr(WHW.T) 6.133229732513428
bpp_loss 3.8489813915518827
I0318 09:10:16.104756 483407 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 0.7667067050933838s
I0318 09:10:19.963756 485659 config.py:54] PyTorch version 2.6.0 available.
W0318 09:10:20.309851 485659 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:10:21.307808 485659 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:10:21.312072 483407 quantize_finetune_llama.py:203] layer 7 gpu 3
I0318 09:10:21.326746 485659 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:10:22.672215 483407 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 0.866335391998291s
I0318 09:10:26.581164 485792 config.py:54] PyTorch version 2.6.0 available.
W0318 09:10:26.919646 485792 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:10:27.952790 485792 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:10:27.957187 483407 quantize_finetune_llama.py:203] layer 8 gpu 0
I0318 09:10:27.972087 485792 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.01221604272723198 tr(WHW.T) 274.6131286621094
bpp_loss 3.6337655782699585
4_q proxy err 0.0005505210137926042 tr(WHW.T) 6914.9892578125
bpp_loss 4.477027177810669
4_k proxy err 0.00038434183807112277 tr(WHW.T) 10415.33203125
bpp_loss 4.518935680389404
4_o proxy err 0.007574423681944609 tr(WHW.T) 5.139806270599365
bpp_loss 3.615052103996277
4_up proxy err 0.006201334297657013 tr(WHW.T) 397.6960144042969
bpp_loss 3.8372217222701672
4_gate proxy err 0.0030534800607711077 tr(WHW.T) 821.1856689453125
bpp_loss 3.9724729671034704
4_down proxy err 0.006514155305922031 tr(WHW.T) 11.562739372253418
bpp_loss 3.834918887116188
5_v proxy err 0.012059910222887993 tr(WHW.T) 298.47540283203125
bpp_loss 3.6571353673934937
5_q proxy err 0.0005985284224152565 tr(WHW.T) 6770.97509765625
bpp_loss 4.486812353134155
5_k proxy err 0.0003921574098058045 tr(WHW.T) 10841.955078125
bpp_loss 4.568493127822876
5_o proxy err 0.010698859579861164 tr(WHW.T) 7.947142601013184
bpp_loss 3.6372528076171875
5_up proxy err 0.006083664949983358 tr(WHW.T) 506.6408386230469
bpp_loss 3.8371912046920422
5_gate proxy err 0.002843684982508421 tr(WHW.T) 1104.867919921875
bpp_loss 3.9808007173759994
5_down proxy err 0.006879297085106373 tr(WHW.T) 15.6494779586792
bpp_loss 3.835870942404104
I0318 09:11:02.367356 483407 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 0.8741533756256104s
I0318 09:11:05.828684 486294 config.py:54] PyTorch version 2.6.0 available.
W0318 09:11:06.106448 486294 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:11:07.087163 486294 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:11:07.091293 483407 quantize_finetune_llama.py:203] layer 9 gpu 1
I0318 09:11:07.105999 486294 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.012191502377390862 tr(WHW.T) 443.5464782714844
bpp_loss 3.5912500619888306
6_q proxy err 0.0007780436426401138 tr(WHW.T) 7576.53857421875
bpp_loss 4.375946521759033
6_k proxy err 0.000586138223297894 tr(WHW.T) 10409.4033203125
bpp_loss 4.4132513999938965
6_o proxy err 0.00990480836480856 tr(WHW.T) 11.564380645751953
bpp_loss 3.579845905303955
6_up proxy err 0.006092510651797056 tr(WHW.T) 617.2608642578125
bpp_loss 3.833033184672511
6_gate proxy err 0.0024751045275479555 tr(WHW.T) 1554.7271728515625
bpp_loss 4.004537538040516
6_down proxy err 0.007097793743014336 tr(WHW.T) 22.988168716430664
bpp_loss 3.8291660796764284
I0318 09:11:18.168464 483407 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 0.8488633632659912s
I0318 09:11:21.741909 486545 config.py:54] PyTorch version 2.6.0 available.
W0318 09:11:22.064244 486545 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:11:23.099420 486545 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:11:23.103560 483407 quantize_finetune_llama.py:203] layer 10 gpu 2
I0318 09:11:23.117490 486545 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.011923342943191528 tr(WHW.T) 489.9357604980469
bpp_loss 3.6017850637435913
7_q proxy err 0.00084388890536502 tr(WHW.T) 7672.17919921875
bpp_loss 4.372337341308594
7_k proxy err 0.0006431321380659938 tr(WHW.T) 10198.3701171875
bpp_loss 4.381519317626953
7_o proxy err 0.011421139352023602 tr(WHW.T) 15.11335563659668
bpp_loss 3.5861510038375854
7_up proxy err 0.00599950086325407 tr(WHW.T) 735.8538818359375
bpp_loss 3.837202737497729
7_gate proxy err 0.0024075279943645 tr(WHW.T) 1876.0390625
bpp_loss 4.003781695698583
7_down proxy err 0.007191372569650412 tr(WHW.T) 30.58672523498535
bpp_loss 3.831002634625102
I0318 09:11:32.812308 483407 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 0.9830045700073242s
I0318 09:11:36.564671 486754 config.py:54] PyTorch version 2.6.0 available.
W0318 09:11:36.856419 486754 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:11:37.770533 486754 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:11:37.774662 483407 quantize_finetune_llama.py:203] layer 11 gpu 3
I0318 09:11:37.788930 486754 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:11:39.480207 483407 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.191169023513794s
I0318 09:11:43.323249 486882 config.py:54] PyTorch version 2.6.0 available.
W0318 09:11:43.661608 486882 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:11:44.873219 486882 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:11:44.877561 483407 quantize_finetune_llama.py:203] layer 12 gpu 0
I0318 09:11:44.894146 486882 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.011121009476482868 tr(WHW.T) 530.9967041015625
bpp_loss 3.6250014305114746
8_q proxy err 0.0008964890148490667 tr(WHW.T) 7228.1201171875
bpp_loss 4.390486240386963
8_k proxy err 0.0006237183115445077 tr(WHW.T) 10639.1015625
bpp_loss 4.401832103729248
8_o proxy err 0.012738564051687717 tr(WHW.T) 20.092191696166992
bpp_loss 3.611035466194153
8_up proxy err 0.005508947651833296 tr(WHW.T) 866.312744140625
bpp_loss 3.852082008539244
8_gate proxy err 0.0024784873239696026 tr(WHW.T) 1970.857177734375
bpp_loss 3.981199397597202
8_down proxy err 0.007155173923820257 tr(WHW.T) 37.177734375
bpp_loss 3.8435077445451604
9_v proxy err 0.01052482146769762 tr(WHW.T) 565.0663452148438
bpp_loss 3.642733335494995
9_q proxy err 0.0009260013466700912 tr(WHW.T) 6970.3359375
bpp_loss 4.39327073097229
9_k proxy err 0.0006116636213846505 tr(WHW.T) 10987.3515625
bpp_loss 4.440711736679077
9_o proxy err 0.012644208036363125 tr(WHW.T) 25.610172271728516
bpp_loss 3.630387783050537
9_up proxy err 0.005319900345057249 tr(WHW.T) 970.8984375
bpp_loss 3.8603691278501997
9_gate proxy err 0.002470008796080947 tr(WHW.T) 2132.69384765625
bpp_loss 3.9680000127748003
9_down proxy err 0.007162430323660374 tr(WHW.T) 42.99482727050781
bpp_loss 3.851812939311183
I0318 09:12:19.665767 483407 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 0.9173195362091064s
I0318 09:12:23.273601 487406 config.py:54] PyTorch version 2.6.0 available.
W0318 09:12:23.626634 487406 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:12:24.642505 487406 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:12:24.646795 483407 quantize_finetune_llama.py:203] layer 13 gpu 1
I0318 09:12:24.661054 487406 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.010664686560630798 tr(WHW.T) 578.807373046875
bpp_loss 3.633843421936035
10_q proxy err 0.0009704583208076656 tr(WHW.T) 6915.87109375
bpp_loss 4.390726327896118
10_k proxy err 0.0006307724397629499 tr(WHW.T) 10996.2431640625
bpp_loss 4.448467016220093
10_o proxy err 0.013045069761574268 tr(WHW.T) 35.184165954589844
bpp_loss 3.626599431037903
10_up proxy err 0.005004973150789738 tr(WHW.T) 1080.198486328125
bpp_loss 3.873322597769804
10_gate proxy err 0.002441058401018381 tr(WHW.T) 2260.88330078125
bpp_loss 3.963643096214117
10_down proxy err 0.006815846543759108 tr(WHW.T) 52.33584976196289
bpp_loss 3.862278982650402
I0318 09:12:34.530403 483407 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 0.9287118911743164s
I0318 09:12:38.199012 487627 config.py:54] PyTorch version 2.6.0 available.
W0318 09:12:38.512982 487627 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:12:39.475981 487627 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:12:39.480039 483407 quantize_finetune_llama.py:203] layer 14 gpu 2
I0318 09:12:39.493861 487627 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.010105423629283905 tr(WHW.T) 723.1956176757812
bpp_loss 3.6725029945373535
11_q proxy err 0.0011183720780536532 tr(WHW.T) 7027.10986328125
bpp_loss 4.297831296920776
11_k proxy err 0.000771383463870734 tr(WHW.T) 10511.23046875
bpp_loss 4.293222188949585
11_o proxy err 0.013060159981250763 tr(WHW.T) 36.654052734375
bpp_loss 3.663166642189026
11_up proxy err 0.0051043396815657616 tr(WHW.T) 1139.6044921875
bpp_loss 3.8838660661564317
11_gate proxy err 0.0024728456046432257 tr(WHW.T) 2392.716552734375
bpp_loss 3.9586735215297963
11_down proxy err 0.006976420991122723 tr(WHW.T) 56.13530731201172
bpp_loss 3.870200800341229
I0318 09:12:47.179732 483407 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 0.981114387512207s
I0318 09:12:50.994948 487824 config.py:54] PyTorch version 2.6.0 available.
W0318 09:12:51.346996 487824 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:12:52.351732 487824 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:12:52.356135 483407 quantize_finetune_llama.py:203] layer 15 gpu 3
I0318 09:12:52.371835 487824 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:12:53.740194 483407 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 0.9174408912658691s
I0318 09:12:57.596517 487952 config.py:54] PyTorch version 2.6.0 available.
W0318 09:12:57.926343 487952 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:12:58.914963 487952 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:12:58.919230 483407 quantize_finetune_llama.py:203] layer 16 gpu 0
I0318 09:12:58.933696 487952 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.010296788066625595 tr(WHW.T) 703.318603515625
bpp_loss 3.6604809761047363
12_q proxy err 0.0011080879485234618 tr(WHW.T) 7045.6435546875
bpp_loss 4.333855867385864
12_k proxy err 0.0007333504036068916 tr(WHW.T) 10893.65625
bpp_loss 4.390719652175903
12_o proxy err 0.013365956023335457 tr(WHW.T) 39.29071044921875
bpp_loss 3.6525261402130127
12_up proxy err 0.0050412435084581375 tr(WHW.T) 1228.298583984375
bpp_loss 3.8953389012536337
12_gate proxy err 0.0026458902284502983 tr(WHW.T) 2381.994873046875
bpp_loss 3.950117776560229
12_down proxy err 0.006956071592867374 tr(WHW.T) 64.17745208740234
bpp_loss 3.8805842954058978
13_v proxy err 0.01016188133507967 tr(WHW.T) 714.5677490234375
bpp_loss 3.69483482837677
13_q proxy err 0.0011239842278882861 tr(WHW.T) 6956.03564453125
bpp_loss 4.3172607421875
13_k proxy err 0.000769594160374254 tr(WHW.T) 10426.6318359375
bpp_loss 4.349809646606445
13_o proxy err 0.011797689832746983 tr(WHW.T) 45.8377571105957
bpp_loss 3.685351848602295
13_up proxy err 0.004858878441154957 tr(WHW.T) 1367.6221923828125
bpp_loss 3.908224061478016
13_gate proxy err 0.002592646749690175 tr(WHW.T) 2601.504638671875
bpp_loss 3.945368389750636
13_down proxy err 0.006967185530811548 tr(WHW.T) 79.3589096069336
bpp_loss 3.890515127847361
I0318 09:13:36.532675 483407 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 0.9919312000274658s
I0318 09:13:40.406930 488446 config.py:54] PyTorch version 2.6.0 available.
W0318 09:13:40.758352 488446 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:13:41.764325 488446 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:13:41.768495 483407 quantize_finetune_llama.py:203] layer 17 gpu 1
I0318 09:13:41.782577 488446 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.01078729797154665 tr(WHW.T) 706.1612548828125
bpp_loss 3.676859974861145
14_q proxy err 0.001157999038696289 tr(WHW.T) 7077.06103515625
bpp_loss 4.3119847774505615
14_k proxy err 0.0007448996766470373 tr(WHW.T) 11295.16796875
bpp_loss 4.347310543060303
14_o proxy err 0.013113154098391533 tr(WHW.T) 50.921180725097656
bpp_loss 3.6661700010299683
14_up proxy err 0.0049057528376579285 tr(WHW.T) 1464.7159423828125
bpp_loss 3.9096012559047963
14_gate proxy err 0.0027169613167643547 tr(WHW.T) 2682.584716796875
bpp_loss 3.9427648145099017
14_down proxy err 0.00712392246350646 tr(WHW.T) 90.28684997558594
bpp_loss 3.8918604961661405
I0318 09:13:49.842004 483407 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.2259912490844727s
I0318 09:13:53.690699 488640 config.py:54] PyTorch version 2.6.0 available.
W0318 09:13:54.042172 488640 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.009794732555747032 tr(WHW.T) 762.7275390625
bpp_loss 3.71544349193573
15_q proxy err 0.0011077838717028499 tr(WHW.T) 7252.0009765625
bpp_loss 4.290268898010254
15_k proxy err 0.0007496512844227254 tr(WHW.T) 11072.3974609375
bpp_loss 4.351689338684082
15_o proxy err 0.011030753143131733 tr(WHW.T) 59.61664962768555
bpp_loss 3.702210545539856
15_up proxy err 0.004783932119607925 tr(WHW.T) 1641.0228271484375
bpp_loss 3.91675674083621
15_gate proxy err 0.0027341449167579412 tr(WHW.T) 2905.140380859375
bpp_loss 3.949886055879815
15_down proxy err 0.007116734515875578 tr(WHW.T) 114.09001922607422
bpp_loss 3.896395151005235
W0318 09:13:55.000823 488640 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:13:55.005082 483407 quantize_finetune_llama.py:203] layer 18 gpu 2
I0318 09:13:55.019834 488640 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:13:56.720593 483407 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.9635357856750488s
I0318 09:14:00.448644 488778 config.py:54] PyTorch version 2.6.0 available.
W0318 09:14:00.728058 488778 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:14:01.748013 488778 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:14:01.752470 483407 quantize_finetune_llama.py:203] layer 19 gpu 3
I0318 09:14:01.766263 488778 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:14:03.264445 483407 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 0.999427080154419s
I0318 09:14:07.241614 488901 config.py:54] PyTorch version 2.6.0 available.
W0318 09:14:07.596949 488901 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:14:08.608744 488901 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:14:08.613334 483407 quantize_finetune_llama.py:203] layer 20 gpu 0
I0318 09:14:08.628174 488901 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.009876091964542866 tr(WHW.T) 780.7407836914062
bpp_loss 3.7587939500808716
16_q proxy err 0.0011421958915889263 tr(WHW.T) 7193.3974609375
bpp_loss 4.277714967727661
16_k proxy err 0.0007366351783275604 tr(WHW.T) 11630.361328125
bpp_loss 4.325077772140503
16_o proxy err 0.008590751327574253 tr(WHW.T) 88.22785186767578
bpp_loss 3.7478824853897095
16_up proxy err 0.00467923516407609 tr(WHW.T) 1890.9385986328125
bpp_loss 3.9157056586686956
16_gate proxy err 0.0026613781228661537 tr(WHW.T) 3369.859130859375
bpp_loss 3.959221595941588
16_down proxy err 0.007200269028544426 tr(WHW.T) 152.0294952392578
bpp_loss 3.8955410136732946
17_v proxy err 0.00929546169936657 tr(WHW.T) 845.7654418945312
bpp_loss 3.755193829536438
17_q proxy err 0.001170802628621459 tr(WHW.T) 7163.2734375
bpp_loss 4.263967752456665
17_k proxy err 0.0008067713351920247 tr(WHW.T) 10697.431640625
bpp_loss 4.303135395050049
17_o proxy err 0.009530315175652504 tr(WHW.T) 58.14826965332031
bpp_loss 3.7486706972122192
17_up proxy err 0.0051111746579408646 tr(WHW.T) 1921.07861328125
bpp_loss 3.910884236180505
17_gate proxy err 0.002785263815894723 tr(WHW.T) 3571.31640625
bpp_loss 3.971811516340389
17_down proxy err 0.007145419716835022 tr(WHW.T) 165.43495178222656
bpp_loss 3.894071800764217
I0318 09:14:52.933842 483407 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.0044522285461426s
I0318 09:14:56.590854 489443 config.py:54] PyTorch version 2.6.0 available.
W0318 09:14:56.911409 489443 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.008510625921189785 tr(WHW.T) 1003.7705078125
bpp_loss 3.8060868978500366
18_q proxy err 0.0012006075121462345 tr(WHW.T) 7510.48046875
bpp_loss 4.225487947463989
18_k proxy err 0.0008843807154335082 tr(WHW.T) 10462.6650390625
bpp_loss 4.262694835662842
18_o proxy err 0.008224138990044594 tr(WHW.T) 69.96558380126953
bpp_loss 3.7903101444244385
18_up proxy err 0.005438567139208317 tr(WHW.T) 2023.183837890625
bpp_loss 3.90702606910883
18_gate proxy err 0.0029470818117260933 tr(WHW.T) 3783.076416015625
bpp_loss 3.9841824908589207
18_down proxy err 0.007165107410401106 tr(WHW.T) 198.52699279785156
bpp_loss 3.8927952300670534
W0318 09:14:57.916586 489443 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:14:57.920816 483407 quantize_finetune_llama.py:203] layer 21 gpu 1
I0318 09:14:57.935395 489443 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:15:00.050495 483407 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 0.9414091110229492s
I0318 09:15:03.770597 489566 config.py:54] PyTorch version 2.6.0 available.
W0318 09:15:04.095906 489566 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.008323993533849716 tr(WHW.T) 1019.1412353515625
bpp_loss 3.8161481618881226
19_q proxy err 0.0013009648537263274 tr(WHW.T) 6944.4130859375
bpp_loss 4.204442024230957
19_k proxy err 0.000872996577527374 tr(WHW.T) 10548.4892578125
bpp_loss 4.237081289291382
19_o proxy err 0.008120564743876457 tr(WHW.T) 62.291683197021484
bpp_loss 3.8043973445892334
19_up proxy err 0.005465593654662371 tr(WHW.T) 2149.330322265625
bpp_loss 3.9070161331531614
19_gate proxy err 0.003225693479180336 tr(WHW.T) 3687.5126953125
bpp_loss 3.9889801380246186
19_down proxy err 0.006984091829508543 tr(WHW.T) 222.93177795410156
bpp_loss 3.8957619112591413
W0318 09:15:05.039757 489566 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:15:05.043670 483407 quantize_finetune_llama.py:203] layer 22 gpu 2
I0318 09:15:05.057160 489566 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:15:07.142451 483407 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 0.9871482849121094s
I0318 09:15:10.865398 489702 config.py:54] PyTorch version 2.6.0 available.
W0318 09:15:11.186981 489702 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:15:12.170201 489702 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:15:12.174195 483407 quantize_finetune_llama.py:203] layer 23 gpu 3
I0318 09:15:12.188770 489702 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:15:13.765203 483407 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.076953649520874s
I0318 09:15:17.550369 489829 config.py:54] PyTorch version 2.6.0 available.
W0318 09:15:17.876364 489829 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:15:18.879018 489829 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:15:18.883337 483407 quantize_finetune_llama.py:203] layer 24 gpu 0
I0318 09:15:18.898164 489829 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.008610359393060207 tr(WHW.T) 990.5983276367188
bpp_loss 3.834152340888977
20_q proxy err 0.0012576039880514145 tr(WHW.T) 7150.947265625
bpp_loss 4.215260982513428
20_k proxy err 0.0008876875508576632 tr(WHW.T) 10386.2470703125
bpp_loss 4.246474027633667
20_o proxy err 0.0059762392193078995 tr(WHW.T) 100.31707000732422
bpp_loss 3.8268394470214844
20_up proxy err 0.005367591977119446 tr(WHW.T) 2340.89453125
bpp_loss 3.906147979026617
20_gate proxy err 0.0031571562867611647 tr(WHW.T) 4024.62744140625
bpp_loss 3.996518334677053
20_down proxy err 0.006932737305760384 tr(WHW.T) 274.8815002441406
bpp_loss 3.895540237426758
21_v proxy err 0.008206095546483994 tr(WHW.T) 1144.5655517578125
bpp_loss 3.870900273323059
21_q proxy err 0.0014044222189113498 tr(WHW.T) 7064.314453125
bpp_loss 4.17806077003479
21_k proxy err 0.0010082618100568652 tr(WHW.T) 9976.4658203125
bpp_loss 4.19622015953064
21_o proxy err 0.006376972422003746 tr(WHW.T) 75.50972747802734
bpp_loss 3.8533345460891724
21_up proxy err 0.005635463632643223 tr(WHW.T) 2361.650390625
bpp_loss 3.903958875079488
21_gate proxy err 0.003367785830050707 tr(WHW.T) 4004.37646484375
bpp_loss 4.005913667900618
21_down proxy err 0.006943192332983017 tr(WHW.T) 276.5857849121094
bpp_loss 3.895427947820619
I0318 09:16:08.224807 483407 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 0.9086136817932129s
I0318 09:16:11.905094 490413 config.py:54] PyTorch version 2.6.0 available.
W0318 09:16:12.258406 490413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.00783361867070198 tr(WHW.T) 1243.2529296875
bpp_loss 3.8753273487091064
22_q proxy err 0.0013246998423710465 tr(WHW.T) 7746.84765625
bpp_loss 4.212446212768555
22_k proxy err 0.0009842482395470142 tr(WHW.T) 10603.2041015625
bpp_loss 4.234070301055908
22_o proxy err 0.005365336313843727 tr(WHW.T) 114.30065155029297
bpp_loss 3.856786370277405
22_up proxy err 0.005676126107573509 tr(WHW.T) 2474.510498046875
bpp_loss 3.9032873109329578
22_gate proxy err 0.003422574372962117 tr(WHW.T) 4156.64013671875
bpp_loss 4.014189076978107
22_down proxy err 0.00692119961604476 tr(WHW.T) 311.8800048828125
bpp_loss 3.895929070406182
W0318 09:16:13.305890 490413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:16:13.310283 483407 quantize_finetune_llama.py:203] layer 25 gpu 1
I0318 09:16:13.324409 490413 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:16:15.283880 483407 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 0.8067927360534668s
I0318 09:16:19.116761 490549 config.py:54] PyTorch version 2.6.0 available.
W0318 09:16:19.447201 490549 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.0070970370434224606 tr(WHW.T) 1486.037353515625
bpp_loss 3.9342931509017944
23_q proxy err 0.0015116630820557475 tr(WHW.T) 7346.60986328125
bpp_loss 4.200689792633057
23_k proxy err 0.0011294394498690963 tr(WHW.T) 9982.2392578125
bpp_loss 4.213851690292358
23_o proxy err 0.00644382368773222 tr(WHW.T) 85.13458251953125
bpp_loss 3.918338418006897
23_up proxy err 0.005879999604076147 tr(WHW.T) 2533.51025390625
bpp_loss 3.909567722054415
23_gate proxy err 0.003674902021884918 tr(WHW.T) 4097.51953125
bpp_loss 4.013490721236828
23_down proxy err 0.006949503906071186 tr(WHW.T) 321.33892822265625
bpp_loss 3.903447062470192
W0318 09:16:20.402041 490549 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:16:20.406188 483407 quantize_finetune_llama.py:203] layer 26 gpu 2
I0318 09:16:20.420855 490549 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:16:22.382207 483407 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 0.8852746486663818s
I0318 09:16:26.110948 490692 config.py:54] PyTorch version 2.6.0 available.
W0318 09:16:26.442356 490692 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:16:27.420075 490692 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:16:27.424241 483407 quantize_finetune_llama.py:203] layer 27 gpu 3
I0318 09:16:27.438064 490692 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:16:28.825946 483407 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 0.9380114078521729s
I0318 09:16:32.679301 490808 config.py:54] PyTorch version 2.6.0 available.
W0318 09:16:33.022171 490808 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:16:34.070955 490808 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:16:34.074970 483407 quantize_finetune_llama.py:203] layer 28 gpu 0
I0318 09:16:34.088271 490808 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.007503872271627188 tr(WHW.T) 1394.900634765625
bpp_loss 3.922311305999756
24_q proxy err 0.0015617799945175648 tr(WHW.T) 7020.447265625
bpp_loss 4.154672622680664
24_k proxy err 0.001078593428246677 tr(WHW.T) 10323.43359375
bpp_loss 4.163584232330322
24_o proxy err 0.005081729032099247 tr(WHW.T) 133.98797607421875
bpp_loss 3.9001623392105103
24_up proxy err 0.005955582484602928 tr(WHW.T) 2621.76513671875
bpp_loss 3.913552395133085
24_gate proxy err 0.0037037550937384367 tr(WHW.T) 4262.74853515625
bpp_loss 4.017183348189953
24_down proxy err 0.006968262605369091 tr(WHW.T) 340.22412109375
bpp_loss 3.9081480336743732
25_v proxy err 0.006820667069405317 tr(WHW.T) 1707.664794921875
bpp_loss 3.9716447591781616
25_q proxy err 0.0016869131941348314 tr(WHW.T) 7162.16357421875
bpp_loss 4.168295383453369
25_k proxy err 0.0012738939840346575 tr(WHW.T) 9611.58984375
bpp_loss 4.174124717712402
25_o proxy err 0.006100812461227179 tr(WHW.T) 83.535888671875
bpp_loss 3.952674150466919
25_up proxy err 0.005913254804909229 tr(WHW.T) 2805.728515625
bpp_loss 3.9192242289698402
25_gate proxy err 0.003600725205615163 tr(WHW.T) 4666.4404296875
bpp_loss 4.019889831542969
25_down proxy err 0.006908443756401539 tr(WHW.T) 373.460693359375
bpp_loss 3.914473666701206
I0318 09:17:28.640993 483407 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 1.130035400390625s
I0318 09:17:32.469652 491447 config.py:54] PyTorch version 2.6.0 available.
W0318 09:17:32.847211 491447 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:17:33.891537 491447 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:17:33.895845 483407 quantize_finetune_llama.py:203] layer 29 gpu 1
I0318 09:17:33.924489 491447 data_utils.py:336] using 256 training seqs, 128 validation seqs
26_v proxy err 0.006807500496506691 tr(WHW.T) 1668.8843994140625
bpp_loss 3.993813157081604
26_q proxy err 0.0015825117006897926 tr(WHW.T) 7469.98291015625
bpp_loss 4.142717361450195
26_k proxy err 0.0011473194463178515 tr(WHW.T) 10487.8740234375
bpp_loss 4.1556572914123535
26_o proxy err 0.004136836621910334 tr(WHW.T) 202.88172912597656
bpp_loss 3.9849880933761597
26_up proxy err 0.005562033038586378 tr(WHW.T) 3154.75146484375
bpp_loss 3.923896079839662
26_gate proxy err 0.0033464813604950905 tr(WHW.T) 5302.16455078125
bpp_loss 4.02431825149891
26_down proxy err 0.007085657212883234 tr(WHW.T) 401.19390869140625
bpp_loss 3.9186044071995934
I0318 09:17:36.574153 483407 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 1.1718969345092773s
I0318 09:17:40.347902 491580 config.py:54] PyTorch version 2.6.0 available.
W0318 09:17:40.675254 491580 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.00619491608813405 tr(WHW.T) 1799.3350830078125
bpp_loss 3.996423125267029
27_q proxy err 0.001510944333858788 tr(WHW.T) 7691.708984375
bpp_loss 4.202310562133789
27_k proxy err 0.001108745695091784 tr(WHW.T) 10618.70703125
bpp_loss 4.219351053237915
27_o proxy err 0.005633707158267498 tr(WHW.T) 126.13690185546875
bpp_loss 3.993829607963562
27_up proxy err 0.005062049254775047 tr(WHW.T) 3691.557861328125
bpp_loss 3.9305851071379907
27_gate proxy err 0.0031581379007548094 tr(WHW.T) 5990.82568359375
bpp_loss 4.0259282311727835
27_down proxy err 0.007185470778495073 tr(WHW.T) 466.9318542480469
bpp_loss 3.925385120303132
W0318 09:17:41.603136 491580 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:17:41.607102 483407 quantize_finetune_llama.py:203] layer 30 gpu 2
I0318 09:17:41.619992 491580 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:17:43.326045 483407 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 0.9772050380706787s
I0318 09:17:47.049751 491718 config.py:54] PyTorch version 2.6.0 available.
W0318 09:17:47.345164 491718 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:17:48.363221 491718 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:17:48.367434 483407 quantize_finetune_llama.py:203] layer 31 gpu 3
I0318 09:17:48.383366 491718 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 09:17:49.847986 483407 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 0.9916255474090576s
I0318 09:17:53.942782 491836 config.py:54] PyTorch version 2.6.0 available.
W0318 09:17:54.328630 491836 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 09:17:55.318088 491836 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 09:17:55.344011 491836 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.005750278010964394 tr(WHW.T) 2018.944091796875
bpp_loss 4.041128635406494
28_q proxy err 0.001578190946020186 tr(WHW.T) 7651.126953125
bpp_loss 4.155665636062622
28_k proxy err 0.0011602564482018352 tr(WHW.T) 10544.8251953125
bpp_loss 4.175345420837402
28_o proxy err 0.0046327970921993256 tr(WHW.T) 194.8240966796875
bpp_loss 4.034976005554199
28_up proxy err 0.0042327712289988995 tr(WHW.T) 4661.2666015625
bpp_loss 3.943721505098565
28_gate proxy err 0.003044692799448967 tr(WHW.T) 6547.48193359375
bpp_loss 4.019653852595839
28_down proxy err 0.0071632713079452515 tr(WHW.T) 603.8403930664062
bpp_loss 3.9334484810052914
29_v proxy err 0.006066817790269852 tr(WHW.T) 1801.7730712890625
bpp_loss 4.046847820281982
29_q proxy err 0.00156968564260751 tr(WHW.T) 7227.0009765625
bpp_loss 4.114250898361206
29_k proxy err 0.0010893892031162977 tr(WHW.T) 10558.609375
bpp_loss 4.128253936767578
29_o proxy err 0.003901892341673374 tr(WHW.T) 207.9054412841797
bpp_loss 4.052446126937866
29_up proxy err 0.00338274659588933 tr(WHW.T) 6070.0498046875
bpp_loss 3.956294215002725
29_gate proxy err 0.002801717957481742 tr(WHW.T) 7369.6142578125
bpp_loss 4.02350740654524
29_down proxy err 0.007239728234708309 tr(WHW.T) 782.2448120117188
bpp_loss 3.9380365859630495
30_v proxy err 0.0049988883547484875 tr(WHW.T) 2261.489501953125
bpp_loss 4.081427097320557
30_q proxy err 0.001491693314164877 tr(WHW.T) 7815.9453125
bpp_loss 4.1245715618133545
30_k proxy err 0.0011223392793908715 tr(WHW.T) 10521.625
bpp_loss 4.146458387374878
30_o proxy err 0.004058790393173695 tr(WHW.T) 251.96908569335938
bpp_loss 4.089240074157715
30_up proxy err 0.002091166330501437 tr(WHW.T) 10016.376953125
bpp_loss 3.979745909225109
30_gate proxy err 0.0019181298557668924 tr(WHW.T) 11001.119140625
bpp_loss 4.056941187658976
30_down proxy err 0.00417794706299901 tr(WHW.T) 3582.617919921875
bpp_loss 3.9302037926607354
31_v proxy err 0.006042918656021357 tr(WHW.T) 1268.2034912109375
bpp_loss 3.9489749670028687
31_q proxy err 0.0011772533180192113 tr(WHW.T) 6858.09130859375
bpp_loss 4.14424204826355
31_k proxy err 0.0008107144385576248 tr(WHW.T) 10233.677734375
bpp_loss 4.202879428863525
31_o proxy err 0.003152611665427685 tr(WHW.T) 457.7950744628906
bpp_loss 3.962754487991333
31_up proxy err 0.0012102269101887941 tr(WHW.T) 14563.890625
bpp_loss 4.0348665104355925
31_gate proxy err 0.001193134463392198 tr(WHW.T) 14836.2939453125
bpp_loss 4.122404409009357
31_down proxy err 0.002966499188914895 tr(WHW.T) 17873.55859375
bpp_loss 3.9286345991977427
