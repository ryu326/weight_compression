I0318 07:53:43.942700 428354 config.py:54] PyTorch version 2.6.0 available.
W0318 07:53:44.234701 428354 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:53:45.465340 428354 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.55it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.98it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.07it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  7.75it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  7.96it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.17it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.02it/s]
I0318 07:53:46.415418 428354 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:13,  2.22it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:13,  2.20it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.22it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:12,  2.29it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:11,  2.36it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:10,  2.38it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:02<00:10,  2.40it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:09,  2.44it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:09,  2.42it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:09,  2.42it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.40it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:08,  2.40it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.44it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.46it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:06,  2.47it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.49it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:06,  2.49it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.50it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:07<00:05,  2.49it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:08<00:04,  2.51it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.50it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:09<00:03,  2.51it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.55it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:09<00:03,  2.58it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:10<00:02,  2.61it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.64it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:10<00:01,  2.63it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.63it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:11<00:01,  2.64it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:12<00:00,  2.61it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.62it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.35it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.47it/s]
I0318 07:54:07.047144 428354 quantize_finetune_llama.py:179] loaded compression model
I0318 07:54:21.194357 428354 quantize_finetune_llama.py:183] loaded dataset and devset
I0318 07:54:28.895707 428354 quantize_finetune_llama.py:203] layer 0 gpu 0
I0318 07:54:33.159278 428354 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 4.119673013687134s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0318 07:54:47.426892 429262 config.py:54] PyTorch version 2.6.0 available.
W0318 07:54:47.710739 429262 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:54:48.604147 429262 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:54:48.608128 428354 quantize_finetune_llama.py:203] layer 1 gpu 1
I0318 07:54:48.621422 429262 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:54:51.992906 428354 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 3.224832773208618s
I0318 07:54:55.487776 429409 config.py:54] PyTorch version 2.6.0 available.
W0318 07:54:55.798517 429409 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:54:56.735357 429409 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:54:56.739046 428354 quantize_finetune_llama.py:203] layer 2 gpu 2
I0318 07:54:56.751856 429409 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:55:00.278441 428354 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 3.377998113632202s
I0318 07:55:04.017397 429557 config.py:54] PyTorch version 2.6.0 available.
W0318 07:55:04.340024 429557 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:55:05.352490 429557 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:55:05.356291 428354 quantize_finetune_llama.py:203] layer 3 gpu 3
I0318 07:55:05.369327 429557 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:55:09.186515 428354 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 3.6742899417877197s
I0318 07:55:13.173675 429704 config.py:54] PyTorch version 2.6.0 available.
W0318 07:55:13.533497 429704 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:55:14.617759 429704 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:55:14.622051 428354 quantize_finetune_llama.py:203] layer 4 gpu 0
I0318 07:55:14.638721 429704 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.01498564425855875 tr(WHW.T) 4.225186347961426
bpp_loss 4.075124025344849
0_q proxy err 3.405335155548528e-05 tr(WHW.T) 2710.363037109375
bpp_loss 4.208058595657349
0_k proxy err 4.7650024498580024e-05 tr(WHW.T) 1698.7349853515625
bpp_loss 4.310398817062378
0_o proxy err 0.0009727154392749071 tr(WHW.T) 0.9668058156967163
bpp_loss 3.9094890356063843
0_up proxy err 0.0016941267531365156 tr(WHW.T) 43.27138900756836
bpp_loss 4.380841277366461
0_gate proxy err 0.0011591889197006822 tr(WHW.T) 63.47430419921875
bpp_loss 4.399933748467024
0_down proxy err 0.0011423511896282434 tr(WHW.T) 0.656814694404602
bpp_loss 4.428726928178654
1_v proxy err 0.02220773883163929 tr(WHW.T) 16.465883255004883
bpp_loss 4.025908946990967
1_q proxy err 8.587981574237347e-05 tr(WHW.T) 4778.43994140625
bpp_loss 5.214362382888794
1_k proxy err 8.216239075409248e-05 tr(WHW.T) 4995.39208984375
bpp_loss 5.209925889968872
1_o proxy err 0.0037674352061003447 tr(WHW.T) 1.1115814447402954
bpp_loss 3.948735237121582
1_up proxy err 0.001750759780406952 tr(WHW.T) 109.66383361816406
bpp_loss 4.453271910201671
1_gate proxy err 0.0008728377288207412 tr(WHW.T) 221.3038787841797
bpp_loss 4.531095105548237
1_down proxy err 0.0010056967148557305 tr(WHW.T) 2041.4736328125
bpp_loss 4.4712333457414495
I0318 07:56:06.683233 428354 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.9501500129699707s
I0318 07:56:10.624089 430434 config.py:54] PyTorch version 2.6.0 available.
W0318 07:56:10.975579 430434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:56:11.959800 430434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:56:11.964050 428354 quantize_finetune_llama.py:203] layer 5 gpu 1
I0318 07:56:11.980212 430434 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.005353923887014389 tr(WHW.T) 136.67332458496094
bpp_loss 4.262934923171997
2_q proxy err 0.00010481584467925131 tr(WHW.T) 7752.85205078125
bpp_loss 5.230432510375977
2_k proxy err 8.03757066023536e-05 tr(WHW.T) 10205.837890625
bpp_loss 5.355761766433716
2_o proxy err 0.0028445753268897533 tr(WHW.T) 1.4603197574615479
bpp_loss 4.236030340194702
2_up proxy err 0.0020348792895674706 tr(WHW.T) 193.43603515625
bpp_loss 4.475459254065226
2_gate proxy err 0.0012884406605735421 tr(WHW.T) 306.6622619628906
bpp_loss 4.569603143736374
2_down proxy err 0.0023457950446754694 tr(WHW.T) 3.010739803314209
bpp_loss 4.483419107836347
I0318 07:56:18.654295 428354 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 1.0420703887939453s
I0318 07:56:22.496763 430613 config.py:54] PyTorch version 2.6.0 available.
W0318 07:56:22.820241 430613 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:56:23.885007 430613 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:56:23.889038 428354 quantize_finetune_llama.py:203] layer 6 gpu 2
I0318 07:56:23.956333 430613 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.005092592444270849 tr(WHW.T) 284.77557373046875
bpp_loss 4.217453479766846
3_q proxy err 0.00020877414499409497 tr(WHW.T) 7217.63720703125
bpp_loss 5.102827072143555
3_k proxy err 0.0001513115712441504 tr(WHW.T) 10074.73828125
bpp_loss 5.193282127380371
3_o proxy err 0.00285393581725657 tr(WHW.T) 3.3527450561523438
bpp_loss 4.199840068817139
3_up proxy err 0.0023190209176391363 tr(WHW.T) 284.7950744628906
bpp_loss 4.4846242860306145
3_gate proxy err 0.0013860466424375772 tr(WHW.T) 478.13714599609375
bpp_loss 4.590630287347838
3_down proxy err 0.0023947409354150295 tr(WHW.T) 6.133229732513428
bpp_loss 4.487308945766715
I0318 07:56:34.519351 428354 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 1.1189634799957275s
I0318 07:56:38.732557 430860 config.py:54] PyTorch version 2.6.0 available.
W0318 07:56:39.241056 430860 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:56:40.543040 430860 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:56:40.547374 428354 quantize_finetune_llama.py:203] layer 7 gpu 3
I0318 07:56:40.592246 430860 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:56:42.506078 428354 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 1.176522970199585s
I0318 07:56:46.639929 431007 config.py:54] PyTorch version 2.6.0 available.
W0318 07:56:46.999442 431007 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:56:48.137036 431007 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:56:48.149847 428354 quantize_finetune_llama.py:203] layer 8 gpu 0
I0318 07:56:48.216326 431007 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.004812611732631922 tr(WHW.T) 274.6131286621094
bpp_loss 4.26409912109375
4_q proxy err 0.0001989317825064063 tr(WHW.T) 6914.9892578125
bpp_loss 5.198984861373901
4_k proxy err 0.00013464091171044856 tr(WHW.T) 10415.33203125
bpp_loss 5.249082803726196
4_o proxy err 0.002820500871166587 tr(WHW.T) 5.139806270599365
bpp_loss 4.24463963508606
4_up proxy err 0.002293630735948682 tr(WHW.T) 397.6960144042969
bpp_loss 4.475601728572402
4_gate proxy err 0.0011162259615957737 tr(WHW.T) 821.1856689453125
bpp_loss 4.621106524800146
4_down proxy err 0.002406533109024167 tr(WHW.T) 11.562739372253418
bpp_loss 4.472435418949571
5_v proxy err 0.004766078200191259 tr(WHW.T) 298.47540283203125
bpp_loss 4.287842512130737
5_q proxy err 0.0002160386648029089 tr(WHW.T) 6770.97509765625
bpp_loss 5.211565971374512
5_k proxy err 0.00013876587036065757 tr(WHW.T) 10841.955078125
bpp_loss 5.309751510620117
5_o proxy err 0.003985953517258167 tr(WHW.T) 7.947142601013184
bpp_loss 4.267528772354126
5_up proxy err 0.002249920042231679 tr(WHW.T) 506.6408386230469
bpp_loss 4.475535725438317
5_gate proxy err 0.001037864712998271 tr(WHW.T) 1104.867919921875
bpp_loss 4.629841649255087
5_down proxy err 0.002534843748435378 tr(WHW.T) 15.6494779586792
bpp_loss 4.473547292310138
I0318 07:57:41.907488 428354 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 1.168067216873169s
I0318 07:57:45.974017 431739 config.py:54] PyTorch version 2.6.0 available.
W0318 07:57:46.352349 431739 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:57:47.645692 431739 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:57:47.649905 428354 quantize_finetune_llama.py:203] layer 9 gpu 1
I0318 07:57:47.732415 431739 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.004721345845609903 tr(WHW.T) 443.5464782714844
bpp_loss 4.22113823890686
6_q proxy err 0.00028329974156804383 tr(WHW.T) 7576.53857421875
bpp_loss 5.07901930809021
6_k proxy err 0.00020943049457855523 tr(WHW.T) 10409.4033203125
bpp_loss 5.122780084609985
6_o proxy err 0.003716428764164448 tr(WHW.T) 11.564380645751953
bpp_loss 4.209631681442261
6_up proxy err 0.0022562069352716208 tr(WHW.T) 617.2608642578125
bpp_loss 4.4711151123046875
6_gate proxy err 0.0009022426675073802 tr(WHW.T) 1554.7271728515625
bpp_loss 4.655884676201399
6_down proxy err 0.0026187747716903687 tr(WHW.T) 22.988168716430664
bpp_loss 4.46638666197311
I0318 07:57:56.333048 428354 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 0.9246664047241211s
I0318 07:58:00.140968 431957 config.py:54] PyTorch version 2.6.0 available.
W0318 07:58:00.487188 431957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:58:01.587119 431957 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:58:01.591319 428354 quantize_finetune_llama.py:203] layer 10 gpu 2
I0318 07:58:01.656428 431957 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.004598513711243868 tr(WHW.T) 489.9357604980469
bpp_loss 4.231822490692139
7_q proxy err 0.0003034931723959744 tr(WHW.T) 7672.17919921875
bpp_loss 5.075210809707642
7_k proxy err 0.00022884337522555143 tr(WHW.T) 10198.3701171875
bpp_loss 5.085561752319336
7_o proxy err 0.0042614927515387535 tr(WHW.T) 15.11335563659668
bpp_loss 4.216017246246338
7_up proxy err 0.002222498646005988 tr(WHW.T) 735.8538818359375
bpp_loss 4.475598889727925
7_gate proxy err 0.0008787881233729422 tr(WHW.T) 1876.0390625
bpp_loss 4.65497713310774
7_down proxy err 0.0026534481439739466 tr(WHW.T) 30.58672523498535
bpp_loss 4.4684304969255315
I0318 07:58:12.968419 428354 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 1.1359193325042725s
I0318 07:58:16.679629 432191 config.py:54] PyTorch version 2.6.0 available.
W0318 07:58:16.993278 432191 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:58:18.092716 432191 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:58:18.096857 428354 quantize_finetune_llama.py:203] layer 11 gpu 3
I0318 07:58:18.160315 432191 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:58:20.557005 428354 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.5629184246063232s
I0318 07:58:24.477011 432324 config.py:54] PyTorch version 2.6.0 available.
W0318 07:58:24.812000 432324 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:58:25.823251 432324 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:58:25.827467 428354 quantize_finetune_llama.py:203] layer 12 gpu 0
I0318 07:58:25.840825 432324 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.004326084163039923 tr(WHW.T) 530.9967041015625
bpp_loss 4.255333423614502
8_q proxy err 0.0003277221112512052 tr(WHW.T) 7228.1201171875
bpp_loss 5.096529006958008
8_k proxy err 0.00022478513710666448 tr(WHW.T) 10639.1015625
bpp_loss 5.109403371810913
8_o proxy err 0.004789120052009821 tr(WHW.T) 20.092191696166992
bpp_loss 4.2410407066345215
8_up proxy err 0.00204178667627275 tr(WHW.T) 866.312744140625
bpp_loss 4.491404866063317
8_gate proxy err 0.0009051953675225377 tr(WHW.T) 1970.857177734375
bpp_loss 4.630373045455578
8_down proxy err 0.002638385631144047 tr(WHW.T) 37.177734375
bpp_loss 4.481703758239746
9_v proxy err 0.004056133795529604 tr(WHW.T) 565.0663452148438
bpp_loss 4.273101091384888
9_q proxy err 0.0003393316292203963 tr(WHW.T) 6970.3359375
bpp_loss 5.099540948867798
9_k proxy err 0.00021825752628501505 tr(WHW.T) 10987.3515625
bpp_loss 5.155372142791748
9_o proxy err 0.0047445702366530895 tr(WHW.T) 25.610172271728516
bpp_loss 4.260631799697876
9_up proxy err 0.0019671646878123283 tr(WHW.T) 970.8984375
bpp_loss 4.500202622524528
9_gate proxy err 0.0009021807927638292 tr(WHW.T) 2132.69384765625
bpp_loss 4.615679718727289
9_down proxy err 0.0026417993940413 tr(WHW.T) 42.99482727050781
bpp_loss 4.490537887395814
I0318 07:59:19.223160 428354 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 1.0431158542633057s
I0318 07:59:23.082236 432959 config.py:54] PyTorch version 2.6.0 available.
W0318 07:59:23.412415 432959 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:59:24.423985 432959 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:59:24.428300 428354 quantize_finetune_llama.py:203] layer 13 gpu 1
I0318 07:59:24.442334 432959 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.004106744192540646 tr(WHW.T) 578.807373046875
bpp_loss 4.264000177383423
10_q proxy err 0.0003520924656186253 tr(WHW.T) 6915.87109375
bpp_loss 5.096578121185303
10_k proxy err 0.00022439745953306556 tr(WHW.T) 10996.2431640625
bpp_loss 5.164610385894775
10_o proxy err 0.004890759009867907 tr(WHW.T) 35.184165954589844
bpp_loss 4.256864070892334
10_up proxy err 0.001852898276410997 tr(WHW.T) 1080.198486328125
bpp_loss 4.5140196334484015
10_gate proxy err 0.0008923709974624217 tr(WHW.T) 2260.88330078125
bpp_loss 4.611059499341388
10_down proxy err 0.002512911334633827 tr(WHW.T) 52.33584976196289
bpp_loss 4.501626968383789
I0318 07:59:33.523325 428354 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 1.1457977294921875s
I0318 07:59:37.453331 433183 config.py:54] PyTorch version 2.6.0 available.
W0318 07:59:37.773324 433183 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:59:38.793428 433183 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:59:38.798043 428354 quantize_finetune_llama.py:203] layer 14 gpu 2
I0318 07:59:38.813510 433183 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.003840893507003784 tr(WHW.T) 723.1956176757812
bpp_loss 4.303431510925293
11_q proxy err 0.0004049983690492809 tr(WHW.T) 7027.10986328125
bpp_loss 4.987582445144653
11_k proxy err 0.0002729359839577228 tr(WHW.T) 10511.23046875
bpp_loss 4.981774806976318
11_o proxy err 0.004900906700640917 tr(WHW.T) 36.654052734375
bpp_loss 4.294237852096558
11_up proxy err 0.00188431644346565 tr(WHW.T) 1139.6044921875
bpp_loss 4.525376430777616
11_gate proxy err 0.0009037151467055082 tr(WHW.T) 2392.716552734375
bpp_loss 4.605614773062772
11_down proxy err 0.002571121323853731 tr(WHW.T) 56.13530731201172
bpp_loss 4.510224098382994
I0318 07:59:41.514813 428354 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 1.1358518600463867s
I0318 07:59:45.300567 433323 config.py:54] PyTorch version 2.6.0 available.
W0318 07:59:45.627741 433323 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:59:46.882236 433323 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:59:46.886459 428354 quantize_finetune_llama.py:203] layer 15 gpu 3
I0318 07:59:46.919271 433323 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:59:48.476510 428354 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 1.1017565727233887s
I0318 07:59:52.856550 433456 config.py:54] PyTorch version 2.6.0 available.
W0318 07:59:53.201498 433456 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:59:54.373923 433456 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:59:54.378339 428354 quantize_finetune_llama.py:203] layer 16 gpu 0
I0318 07:59:54.428315 433456 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.003937952686101198 tr(WHW.T) 703.318603515625
bpp_loss 4.2912819385528564
12_q proxy err 0.0004054935707245022 tr(WHW.T) 7045.6435546875
bpp_loss 5.0302088260650635
12_k proxy err 0.0002629801456350833 tr(WHW.T) 10893.65625
bpp_loss 5.096212387084961
12_o proxy err 0.00499744713306427 tr(WHW.T) 39.29071044921875
bpp_loss 4.283175945281982
12_up proxy err 0.0018637672765180469 tr(WHW.T) 1228.298583984375
bpp_loss 4.537679805312046
12_gate proxy err 0.0009653294691815972 tr(WHW.T) 2381.994873046875
bpp_loss 4.5962983952012175
12_down proxy err 0.002564939670264721 tr(WHW.T) 64.17745208740234
bpp_loss 4.521360907443734
13_v proxy err 0.0038825415540486574 tr(WHW.T) 714.5677490234375
bpp_loss 4.326605558395386
13_q proxy err 0.0004081064253114164 tr(WHW.T) 6956.03564453125
bpp_loss 5.010042428970337
13_k proxy err 0.0002738002222031355 tr(WHW.T) 10426.6318359375
bpp_loss 5.048086166381836
13_o proxy err 0.004405395593494177 tr(WHW.T) 45.8377571105957
bpp_loss 4.316697835922241
13_up proxy err 0.0017908946610987186 tr(WHW.T) 1367.6221923828125
bpp_loss 4.551686663960302
13_gate proxy err 0.0009467827621847391 tr(WHW.T) 2601.504638671875
bpp_loss 4.5909643838571945
13_down proxy err 0.0025690102484077215 tr(WHW.T) 79.3589096069336
bpp_loss 4.532073908073958
I0318 08:00:52.868051 428354 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 1.0960485935211182s
I0318 08:00:57.339262 434138 config.py:54] PyTorch version 2.6.0 available.
W0318 08:00:57.664236 434138 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:00:58.671035 434138 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:00:58.675330 428354 quantize_finetune_llama.py:203] layer 17 gpu 1
I0318 08:00:58.689215 434138 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.004120070952922106 tr(WHW.T) 706.1612548828125
bpp_loss 4.308103084564209
14_q proxy err 0.00041821945342235267 tr(WHW.T) 7077.06103515625
bpp_loss 5.004739761352539
14_k proxy err 0.00026394176529720426 tr(WHW.T) 11295.16796875
bpp_loss 5.045158386230469
14_o proxy err 0.004881897009909153 tr(WHW.T) 50.921180725097656
bpp_loss 4.297109127044678
14_up proxy err 0.0018080990994349122 tr(WHW.T) 1464.7159423828125
bpp_loss 4.553189477255178
14_gate proxy err 0.0009915389819070697 tr(WHW.T) 2682.584716796875
bpp_loss 4.587930191394895
14_down proxy err 0.0026261741295456886 tr(WHW.T) 90.28684997558594
bpp_loss 4.533453009849371
I0318 08:01:05.071431 428354 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.4590349197387695s
15_v proxy err 0.003736550686880946 tr(WHW.T) 762.7275390625
bpp_loss 4.347845554351807
15_q proxy err 0.00040365851600654423 tr(WHW.T) 7252.0009765625
bpp_loss 4.979362726211548
15_k proxy err 0.0002665011852513999 tr(WHW.T) 11072.3974609375
bpp_loss 5.050633668899536
15_o proxy err 0.004120680503547192 tr(WHW.T) 59.61664962768555
bpp_loss 4.33415412902832
15_up proxy err 0.001761160558089614 tr(WHW.T) 1641.0228271484375
bpp_loss 4.560756772063499
15_gate proxy err 0.0010000390466302633 tr(WHW.T) 2905.140380859375
bpp_loss 4.595725658328035
15_down proxy err 0.002623805310577154 tr(WHW.T) 114.09001922607422
bpp_loss 4.53833069912223
I0318 08:01:08.999542 434320 config.py:54] PyTorch version 2.6.0 available.
W0318 08:01:09.329373 434320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:01:10.283370 434320 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:01:10.287811 428354 quantize_finetune_llama.py:203] layer 18 gpu 2
I0318 08:01:10.302115 434320 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:01:11.754145 428354 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 1.0375206470489502s
I0318 08:01:15.642804 434446 config.py:54] PyTorch version 2.6.0 available.
W0318 08:01:15.940158 434446 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:01:16.898684 434446 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:01:16.902621 428354 quantize_finetune_llama.py:203] layer 19 gpu 3
I0318 08:01:16.915327 434446 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:01:18.615463 428354 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 1.2159357070922852s
I0318 08:01:22.400895 434574 config.py:54] PyTorch version 2.6.0 available.
W0318 08:01:22.765043 434574 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:01:23.816146 434574 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:01:23.820796 428354 quantize_finetune_llama.py:203] layer 20 gpu 0
I0318 08:01:23.856382 434574 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.003749610623344779 tr(WHW.T) 780.7407836914062
bpp_loss 4.392892360687256
16_q proxy err 0.000416565133491531 tr(WHW.T) 7193.3974609375
bpp_loss 4.9644246101379395
16_k proxy err 0.0002599052677396685 tr(WHW.T) 11630.361328125
bpp_loss 5.019082069396973
16_o proxy err 0.0031965116504579782 tr(WHW.T) 88.22785186767578
bpp_loss 4.3815107345581055
16_up proxy err 0.001722525106742978 tr(WHW.T) 1890.9385986328125
bpp_loss 4.5596405739008
16_gate proxy err 0.0009717462817206979 tr(WHW.T) 3369.859130859375
bpp_loss 4.60580053994822
16_down proxy err 0.0026609485503286123 tr(WHW.T) 152.0294952392578
bpp_loss 4.537366090818893
17_v proxy err 0.0035298503935337067 tr(WHW.T) 845.7654418945312
bpp_loss 4.38904070854187
17_q proxy err 0.00042415421921759844 tr(WHW.T) 7163.2734375
bpp_loss 4.948200702667236
17_k proxy err 0.0002869117888621986 tr(WHW.T) 10697.431640625
bpp_loss 4.992924690246582
17_o proxy err 0.0035058853682130575 tr(WHW.T) 58.14826965332031
bpp_loss 4.382422685623169
17_up proxy err 0.0018778870580717921 tr(WHW.T) 1921.07861328125
bpp_loss 4.554383211357649
17_gate proxy err 0.0010147669818252325 tr(WHW.T) 3571.31640625
bpp_loss 4.619710523028706
17_down proxy err 0.0026355241425335407 tr(WHW.T) 165.43495178222656
bpp_loss 4.53594092435615
I0318 08:02:18.832493 428354 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.0845961570739746s
I0318 08:02:22.641929 435243 config.py:54] PyTorch version 2.6.0 available.
W0318 08:02:22.978452 435243 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:02:23.966775 435243 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:02:23.971725 428354 quantize_finetune_llama.py:203] layer 21 gpu 1
I0318 08:02:24.008273 435243 data_utils.py:336] using 256 training seqs, 128 validation seqs
18_v proxy err 0.003210976952686906 tr(WHW.T) 1003.7705078125
bpp_loss 4.442725658416748
18_q proxy err 0.0004381431790534407 tr(WHW.T) 7510.48046875
bpp_loss 4.903548002243042
18_k proxy err 0.0003168930415995419 tr(WHW.T) 10462.6650390625
bpp_loss 4.946500778198242
18_o proxy err 0.0030541946180164814 tr(WHW.T) 69.96558380126953
bpp_loss 4.425966501235962
18_up proxy err 0.0020006324630230665 tr(WHW.T) 2023.183837890625
bpp_loss 4.550329518872638
18_gate proxy err 0.0010743077145889401 tr(WHW.T) 3783.076416015625
bpp_loss 4.633133821709212
18_down proxy err 0.00264587695710361 tr(WHW.T) 198.52699279785156
bpp_loss 4.534568343051644
I0318 08:02:27.268386 428354 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 1.0948786735534668s
I0318 08:02:31.316139 435395 config.py:54] PyTorch version 2.6.0 available.
W0318 08:02:31.651595 435395 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.0031278596725314856 tr(WHW.T) 1019.1412353515625
bpp_loss 4.4533531665802
19_q proxy err 0.00046863709576427937 tr(WHW.T) 6944.4130859375
bpp_loss 4.879790306091309
19_k proxy err 0.00031060256878845394 tr(WHW.T) 10548.4892578125
bpp_loss 4.916638374328613
19_o proxy err 0.0030005788430571556 tr(WHW.T) 62.291683197021484
bpp_loss 4.440823793411255
19_up proxy err 0.002011832781136036 tr(WHW.T) 2149.330322265625
bpp_loss 4.550265112588572
19_gate proxy err 0.0011775234015658498 tr(WHW.T) 3687.5126953125
bpp_loss 4.63863692172738
19_down proxy err 0.0025752137880772352 tr(WHW.T) 222.93177795410156
bpp_loss 4.537580578826194
W0318 08:02:32.658957 435395 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:02:32.663041 428354 quantize_finetune_llama.py:203] layer 22 gpu 2
I0318 08:02:32.700733 435395 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:02:34.700799 428354 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 1.1410772800445557s
I0318 08:02:38.658630 435534 config.py:54] PyTorch version 2.6.0 available.
W0318 08:02:39.006579 435534 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:02:40.013820 435534 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:02:40.017415 428354 quantize_finetune_llama.py:203] layer 23 gpu 3
I0318 08:02:40.029686 435534 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:02:41.939692 428354 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.4919159412384033s
I0318 08:02:45.918478 435679 config.py:54] PyTorch version 2.6.0 available.
W0318 08:02:46.261749 435679 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:02:47.366636 435679 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:02:47.370802 428354 quantize_finetune_llama.py:203] layer 24 gpu 0
I0318 08:02:47.394398 435679 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.0032339130993932486 tr(WHW.T) 990.5983276367188
bpp_loss 4.472436428070068
20_q proxy err 0.00045776268234476447 tr(WHW.T) 7150.947265625
bpp_loss 4.8922083377838135
20_k proxy err 0.00031626701820641756 tr(WHW.T) 10386.2470703125
bpp_loss 4.927417993545532
20_o proxy err 0.002209932543337345 tr(WHW.T) 100.31707000732422
bpp_loss 4.464611768722534
20_up proxy err 0.001969350967556238 tr(WHW.T) 2340.89453125
bpp_loss 4.549362537472747
20_gate proxy err 0.0011502193519845605 tr(WHW.T) 4024.62744140625
bpp_loss 4.646933976994005
20_down proxy err 0.002559503773227334 tr(WHW.T) 274.8815002441406
bpp_loss 4.537408473879792
21_v proxy err 0.0030776590574532747 tr(WHW.T) 1144.5655517578125
bpp_loss 4.511781692504883
21_q proxy err 0.000509763543959707 tr(WHW.T) 7064.314453125
bpp_loss 4.849493026733398
21_k proxy err 0.0003628796839620918 tr(WHW.T) 9976.4658203125
bpp_loss 4.869870662689209
21_o proxy err 0.0023518060334026814 tr(WHW.T) 75.50972747802734
bpp_loss 4.492606163024902
21_up proxy err 0.0020737091545015574 tr(WHW.T) 2361.650390625
bpp_loss 4.547053847202035
21_gate proxy err 0.0012281350791454315 tr(WHW.T) 4004.37646484375
bpp_loss 4.657434685285701
21_down proxy err 0.0025615801569074392 tr(WHW.T) 276.5857849121094
bpp_loss 4.5373608123424445
I0318 08:03:45.643966 428354 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 1.1831347942352295s
22_v proxy err 0.002947852248325944 tr(WHW.T) 1243.2529296875
bpp_loss 4.516479969024658
22_q proxy err 0.00048148928908631206 tr(WHW.T) 7746.84765625
bpp_loss 4.889183282852173
22_k proxy err 0.0003533658746164292 tr(WHW.T) 10603.2041015625
bpp_loss 4.9134111404418945
22_o proxy err 0.0019803601317107677 tr(WHW.T) 114.30065155029297
bpp_loss 4.495774507522583
22_up proxy err 0.0020870110020041466 tr(WHW.T) 2474.510498046875
bpp_loss 4.546380863633266
22_gate proxy err 0.0012480425648391247 tr(WHW.T) 4156.64013671875
bpp_loss 4.666484389194222
22_down proxy err 0.0025487791281193495 tr(WHW.T) 311.8800048828125
bpp_loss 4.537867035976676
I0318 08:03:49.719136 436349 config.py:54] PyTorch version 2.6.0 available.
W0318 08:03:50.050681 436349 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:03:51.124756 436349 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:03:51.128957 428354 quantize_finetune_llama.py:203] layer 25 gpu 1
I0318 08:03:51.196155 436349 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:03:52.914072 428354 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 1.1236076354980469s
I0318 08:03:56.687334 436472 config.py:54] PyTorch version 2.6.0 available.
W0318 08:03:57.001624 436472 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:03:58.019392 436472 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:03:58.024251 428354 quantize_finetune_llama.py:203] layer 26 gpu 2
I0318 08:03:58.040446 436472 data_utils.py:336] using 256 training seqs, 128 validation seqs
23_v proxy err 0.0026603166479617357 tr(WHW.T) 1486.037353515625
bpp_loss 4.579996585845947
23_q proxy err 0.0005470680189318955 tr(WHW.T) 7346.60986328125
bpp_loss 4.875755071640015
23_k proxy err 0.000405182276153937 tr(WHW.T) 9982.2392578125
bpp_loss 4.8905723094940186
23_o proxy err 0.0023729524109512568 tr(WHW.T) 85.13458251953125
bpp_loss 4.562469005584717
23_up proxy err 0.0021615447476506233 tr(WHW.T) 2533.51025390625
bpp_loss 4.553195864655251
23_gate proxy err 0.0013410883257165551 tr(WHW.T) 4097.51953125
bpp_loss 4.666087660678597
23_down proxy err 0.002556936116889119 tr(WHW.T) 321.33892822265625
bpp_loss 4.54603341568348
I0318 08:04:01.349759 428354 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 1.1079633235931396s
I0318 08:04:05.184322 436623 config.py:54] PyTorch version 2.6.0 available.
W0318 08:04:05.519443 436623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:04:06.475139 436623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:04:06.479119 428354 quantize_finetune_llama.py:203] layer 27 gpu 3
I0318 08:04:06.544214 436623 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:04:08.132756 428354 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 1.1699833869934082s
I0318 08:04:12.210431 436746 config.py:54] PyTorch version 2.6.0 available.
W0318 08:04:12.530046 436746 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:04:13.548656 436746 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:04:13.552793 428354 quantize_finetune_llama.py:203] layer 28 gpu 0
I0318 08:04:13.566139 436746 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.0028135247994214296 tr(WHW.T) 1394.900634765625
bpp_loss 4.5671162605285645
24_q proxy err 0.0005683436174876988 tr(WHW.T) 7020.447265625
bpp_loss 4.823391675949097
24_k proxy err 0.00038907976704649627 tr(WHW.T) 10323.43359375
bpp_loss 4.832930326461792
24_o proxy err 0.0018784926505759358 tr(WHW.T) 133.98797607421875
bpp_loss 4.542804479598999
24_up proxy err 0.002189922146499157 tr(WHW.T) 2621.76513671875
bpp_loss 4.557437985442405
24_gate proxy err 0.0013516632607206702 tr(WHW.T) 4262.74853515625
bpp_loss 4.669914068177689
24_down proxy err 0.0025680081453174353 tr(WHW.T) 340.22412109375
bpp_loss 4.551000750342081
25_v proxy err 0.002536398358643055 tr(WHW.T) 1707.664794921875
bpp_loss 4.6209397315979
25_q proxy err 0.0006109944661147892 tr(WHW.T) 7162.16357421875
bpp_loss 4.838898181915283
25_k proxy err 0.00045918585965409875 tr(WHW.T) 9611.58984375
bpp_loss 4.844952821731567
25_o proxy err 0.0022294267546385527 tr(WHW.T) 83.535888671875
bpp_loss 4.599927663803101
25_up proxy err 0.0021748715080320835 tr(WHW.T) 2805.728515625
bpp_loss 4.563547533611919
25_gate proxy err 0.0013138133799657226 tr(WHW.T) 4666.4404296875
bpp_loss 4.672962454862373
25_down proxy err 0.0025500874035060406 tr(WHW.T) 373.460693359375
bpp_loss 4.557940971019656
I0318 08:05:07.975540 428354 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 1.1949713230133057s
I0318 08:05:11.698764 437378 config.py:54] PyTorch version 2.6.0 available.
W0318 08:05:12.057107 437378 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:05:13.083917 437378 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:05:13.088071 428354 quantize_finetune_llama.py:203] layer 29 gpu 1
I0318 08:05:13.140141 437378 data_utils.py:336] using 256 training seqs, 128 validation seqs
26_v proxy err 0.0025397399440407753 tr(WHW.T) 1668.8843994140625
bpp_loss 4.645248889923096
26_q proxy err 0.0005739160114899278 tr(WHW.T) 7469.98291015625
bpp_loss 4.81002140045166
26_k proxy err 0.00041296728886663914 tr(WHW.T) 10487.8740234375
bpp_loss 4.824103593826294
26_o proxy err 0.0015316454228013754 tr(WHW.T) 202.88172912597656
bpp_loss 4.635042667388916
26_up proxy err 0.002043450251221657 tr(WHW.T) 3154.75146484375
bpp_loss 4.568563062091206
26_gate proxy err 0.0012201840290799737 tr(WHW.T) 5302.16455078125
bpp_loss 4.677921383879905
26_down proxy err 0.0026181095745414495 tr(WHW.T) 401.19390869140625
bpp_loss 4.562256014624308
I0318 08:05:15.797007 428354 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 1.2798199653625488s
I0318 08:05:19.950599 437526 config.py:54] PyTorch version 2.6.0 available.
W0318 08:05:20.360939 437526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:05:21.390405 437526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:05:21.394667 428354 quantize_finetune_llama.py:203] layer 30 gpu 2
I0318 08:05:21.408838 437526 data_utils.py:336] using 256 training seqs, 128 validation seqs
27_v proxy err 0.0023078781086951494 tr(WHW.T) 1799.3350830078125
bpp_loss 4.64793586730957
27_q proxy err 0.000546167662832886 tr(WHW.T) 7691.708984375
bpp_loss 4.87756609916687
27_k proxy err 0.0003964735078625381 tr(WHW.T) 10618.70703125
bpp_loss 4.8959245681762695
27_o proxy err 0.002076362492516637 tr(WHW.T) 126.13690185546875
bpp_loss 4.64516806602478
27_up proxy err 0.0018617705209180713 tr(WHW.T) 3691.557861328125
bpp_loss 4.575759355411973
27_gate proxy err 0.0011522446293383837 tr(WHW.T) 5990.82568359375
bpp_loss 4.679584769315498
27_down proxy err 0.0026779116597026587 tr(WHW.T) 466.9318542480469
bpp_loss 4.569768085036167
I0318 08:05:24.192571 428354 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 1.1207308769226074s
I0318 08:05:27.938873 437659 config.py:54] PyTorch version 2.6.0 available.
W0318 08:05:28.256896 437659 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:05:29.345337 437659 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:05:29.349397 428354 quantize_finetune_llama.py:203] layer 31 gpu 3
I0318 08:05:29.400695 437659 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:05:31.172083 428354 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.1971876621246338s
I0318 08:05:35.122858 437800 config.py:54] PyTorch version 2.6.0 available.
W0318 08:05:35.457309 437800 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:05:36.482334 437800 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:05:36.501603 437800 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.002131512388586998 tr(WHW.T) 2018.944091796875
bpp_loss 4.69750714302063
28_q proxy err 0.0005699634202755988 tr(WHW.T) 7651.126953125
bpp_loss 4.824402093887329
28_k proxy err 0.0004164744168519974 tr(WHW.T) 10544.8251953125
bpp_loss 4.846078634262085
28_o proxy err 0.0016989547293633223 tr(WHW.T) 194.8240966796875
bpp_loss 4.69042706489563
28_up proxy err 0.0015557941514998674 tr(WHW.T) 4661.2666015625
bpp_loss 4.589802941610647
28_gate proxy err 0.001111622084863484 tr(WHW.T) 6547.48193359375
bpp_loss 4.672760009765625
28_down proxy err 0.002692931331694126 tr(WHW.T) 603.8403930664062
bpp_loss 4.578474488369254
29_v proxy err 0.0022539859637618065 tr(WHW.T) 1801.7730712890625
bpp_loss 4.7038733959198
29_q proxy err 0.0005693041603080928 tr(WHW.T) 7227.0009765625
bpp_loss 4.777508735656738
29_k proxy err 0.0003918593574780971 tr(WHW.T) 10558.609375
bpp_loss 4.792866945266724
29_o proxy err 0.001428041374310851 tr(WHW.T) 207.9054412841797
bpp_loss 4.709422588348389
29_up proxy err 0.0012415930395945907 tr(WHW.T) 6070.0498046875
bpp_loss 4.603227127430051
29_gate proxy err 0.0010239791590720415 tr(WHW.T) 7369.6142578125
bpp_loss 4.676915190940679
29_down proxy err 0.002736608264967799 tr(WHW.T) 782.2448120117188
bpp_loss 4.583497380101403
30_v proxy err 0.0018429497722536325 tr(WHW.T) 2261.489501953125
bpp_loss 4.7423577308654785
30_q proxy err 0.0005402023671194911 tr(WHW.T) 7815.9453125
bpp_loss 4.788920640945435
30_k proxy err 0.000403921352699399 tr(WHW.T) 10521.625
bpp_loss 4.812914133071899
30_o proxy err 0.0014885299606248736 tr(WHW.T) 251.96908569335938
bpp_loss 4.7509050369262695
30_up proxy err 0.0007619713433086872 tr(WHW.T) 10016.376953125
bpp_loss 4.628088840218478
30_gate proxy err 0.0006954465643502772 tr(WHW.T) 11001.119140625
bpp_loss 4.713559705157612
30_down proxy err 0.0015862579457461834 tr(WHW.T) 3582.617919921875
bpp_loss 4.574897300365359
31_v proxy err 0.0022362275049090385 tr(WHW.T) 1268.2034912109375
bpp_loss 4.596063137054443
31_q proxy err 0.0004224254807922989 tr(WHW.T) 6858.09130859375
bpp_loss 4.809946060180664
31_k proxy err 0.0002858207153622061 tr(WHW.T) 10233.677734375
bpp_loss 4.876018285751343
31_o proxy err 0.0011582867009565234 tr(WHW.T) 457.7950744628906
bpp_loss 4.610891580581665
31_up proxy err 0.0004330662195570767 tr(WHW.T) 14563.890625
bpp_loss 4.68757860050645
31_gate proxy err 0.000425954582169652 tr(WHW.T) 14836.2939453125
bpp_loss 4.786093068677325
31_down proxy err 0.0011039422824978828 tr(WHW.T) 17873.55859375
bpp_loss 4.573088135830192
