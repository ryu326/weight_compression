I0318 07:28:28.278333 407588 config.py:54] PyTorch version 2.6.0 available.
W0318 07:28:28.562124 407588 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:28:29.457580 407588 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.38it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.91it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.17it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.29it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.39it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.10it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.11it/s]
I0318 07:28:30.410896 407588 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:13,  2.27it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:13,  2.21it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.19it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:12,  2.31it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:11,  2.32it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:10,  2.37it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:10,  2.39it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:10,  2.37it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:09,  2.38it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:09,  2.39it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.38it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:08,  2.38it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:08,  2.36it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.38it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:07,  2.41it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.41it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:06,  2.42it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.43it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:05,  2.40it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:08<00:04,  2.41it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.41it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:09<00:04,  2.42it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.42it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:10<00:03,  2.41it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:10<00:02,  2.41it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.40it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:11<00:02,  2.40it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.40it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:12<00:01,  2.40it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:12<00:00,  2.39it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:13<00:00,  2.41it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.43it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.39it/s]
I0318 07:28:50.815915 407588 quantize_finetune_llama.py:179] loaded compression model
I0318 07:29:04.594639 407588 quantize_finetune_llama.py:183] loaded dataset and devset
I0318 07:29:13.101675 407588 quantize_finetune_llama.py:203] layer 0 gpu 0
I0318 07:29:16.234908 407588 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 2.986342191696167s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0318 07:29:32.457567 408526 config.py:54] PyTorch version 2.6.0 available.
W0318 07:29:32.739278 408526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:29:33.630723 408526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:29:33.634752 407588 quantize_finetune_llama.py:203] layer 1 gpu 1
I0318 07:29:33.648451 408526 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:29:36.674643 407588 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 2.8696813583374023s
I0318 07:29:40.217104 408660 config.py:54] PyTorch version 2.6.0 available.
W0318 07:29:40.544551 408660 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:29:41.532480 408660 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:29:41.536474 407588 quantize_finetune_llama.py:203] layer 2 gpu 2
I0318 07:29:41.551062 408660 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:29:45.007041 407588 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 3.3156790733337402s
I0318 07:29:48.786967 408815 config.py:54] PyTorch version 2.6.0 available.
W0318 07:29:49.134631 408815 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:29:50.093549 408815 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:29:50.097923 407588 quantize_finetune_llama.py:203] layer 3 gpu 3
I0318 07:29:50.115763 408815 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:29:53.987422 407588 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 3.722945213317871s
I0318 07:29:57.882363 408964 config.py:54] PyTorch version 2.6.0 available.
W0318 07:29:58.244722 408964 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:29:59.357740 408964 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:29:59.361976 407588 quantize_finetune_llama.py:203] layer 4 gpu 0
I0318 07:29:59.376189 408964 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.040011756122112274 tr(WHW.T) 4.225186347961426
bpp_loss 3.3256616592407227
0_q proxy err 0.00014942152483854443 tr(WHW.T) 2710.363037109375
bpp_loss 3.452382445335388
0_k proxy err 0.00018903026648331434 tr(WHW.T) 1698.7349853515625
bpp_loss 3.5480213165283203
0_o proxy err 0.0026202178560197353 tr(WHW.T) 0.9668058156967163
bpp_loss 3.1581400632858276
0_up proxy err 0.004889068193733692 tr(WHW.T) 43.27138900756836
bpp_loss 3.6138876981513444
0_gate proxy err 0.0033724834211170673 tr(WHW.T) 63.47430419921875
bpp_loss 3.631214053131813
0_down proxy err 0.0033426687587052584 tr(WHW.T) 0.656814694404602
bpp_loss 3.6571741769480153
1_v proxy err 0.058460354804992676 tr(WHW.T) 16.465883255004883
bpp_loss 3.276970624923706
1_q proxy err 0.00030556731508113444 tr(WHW.T) 4778.43994140625
bpp_loss 4.318268060684204
1_k proxy err 0.0002908133319579065 tr(WHW.T) 4995.39208984375
bpp_loss 4.314687967300415
1_o proxy err 0.009694184176623821 tr(WHW.T) 1.1115814447402954
bpp_loss 3.19886314868927
1_up proxy err 0.005119319539517164 tr(WHW.T) 109.66383361816406
bpp_loss 3.67925173737282
1_gate proxy err 0.002610774477943778 tr(WHW.T) 221.3038787841797
bpp_loss 3.748303258141806
1_down proxy err 0.002972043352201581 tr(WHW.T) 2041.4736328125
bpp_loss 3.695289589637934
I0318 07:30:39.650530 407588 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.9764754772186279s
I0318 07:30:43.660014 409557 config.py:54] PyTorch version 2.6.0 available.
W0318 07:30:44.015651 409557 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:30:45.102668 409557 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:30:45.106741 407588 quantize_finetune_llama.py:203] layer 5 gpu 1
I0318 07:30:45.121327 409557 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.014960093423724174 tr(WHW.T) 136.67332458496094
bpp_loss 3.505346179008484
2_q proxy err 0.00036649141111411154 tr(WHW.T) 7752.85205078125
bpp_loss 4.33187198638916
2_k proxy err 0.00028292014030739665 tr(WHW.T) 10205.837890625
bpp_loss 4.432035207748413
2_o proxy err 0.007934252731502056 tr(WHW.T) 1.4603197574615479
bpp_loss 3.4801305532455444
2_up proxy err 0.005968300625681877 tr(WHW.T) 193.43603515625
bpp_loss 3.6990569358648258
2_gate proxy err 0.0038607153110206127 tr(WHW.T) 306.6622619628906
bpp_loss 3.782149913699128
2_down proxy err 0.006883172318339348 tr(WHW.T) 3.010739803314209
bpp_loss 3.7061302717341933
I0318 07:30:49.055956 407588 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 1.0659825801849365s
I0318 07:30:52.719301 409712 config.py:54] PyTorch version 2.6.0 available.
W0318 07:30:53.051987 409712 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:30:54.034546 409712 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:30:54.038651 407588 quantize_finetune_llama.py:203] layer 6 gpu 2
I0318 07:30:54.052400 409712 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.014101454988121986 tr(WHW.T) 284.77557373046875
bpp_loss 3.4626351594924927
3_q proxy err 0.0007014812435954809 tr(WHW.T) 7217.63720703125
bpp_loss 4.22927713394165
3_k proxy err 0.0005169581272639334 tr(WHW.T) 10074.73828125
bpp_loss 4.302271842956543
3_o proxy err 0.007904570549726486 tr(WHW.T) 3.3527450561523438
bpp_loss 3.44596791267395
3_up proxy err 0.006806695833802223 tr(WHW.T) 284.7950744628906
bpp_loss 3.707228194835574
3_gate proxy err 0.004165525548160076 tr(WHW.T) 478.13714599609375
bpp_loss 3.8005436742028524
3_down proxy err 0.007031306624412537 tr(WHW.T) 6.133229732513428
bpp_loss 3.709583326827648
I0318 07:31:04.578985 407588 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 1.094573974609375s
I0318 07:31:08.424937 409943 config.py:54] PyTorch version 2.6.0 available.
W0318 07:31:08.773023 409943 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:31:09.791531 409943 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:31:09.795768 407588 quantize_finetune_llama.py:203] layer 7 gpu 3
I0318 07:31:09.812721 409943 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:31:11.400154 407588 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 1.0966434478759766s
I0318 07:31:15.298207 410064 config.py:54] PyTorch version 2.6.0 available.
W0318 07:31:15.629383 410064 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:31:16.687606 410064 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:31:16.691961 407588 quantize_finetune_llama.py:203] layer 8 gpu 0
I0318 07:31:16.707395 410064 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.013460608199238777 tr(WHW.T) 274.6131286621094
bpp_loss 3.5064079761505127
4_q proxy err 0.0006756953662261367 tr(WHW.T) 6914.9892578125
bpp_loss 4.306851387023926
4_k proxy err 0.0004644645086955279 tr(WHW.T) 10415.33203125
bpp_loss 4.346973419189453
4_o proxy err 0.007884417660534382 tr(WHW.T) 5.139806270599365
bpp_loss 3.4881811141967773
4_up proxy err 0.006721201352775097 tr(WHW.T) 397.6960144042969
bpp_loss 3.6991806030273438
4_gate proxy err 0.0033811049070209265 tr(WHW.T) 821.1856689453125
bpp_loss 3.8270146569540335
4_down proxy err 0.007044678088277578 tr(WHW.T) 11.562739372253418
bpp_loss 3.696374871010004
5_v proxy err 0.01340580452233553 tr(WHW.T) 298.47540283203125
bpp_loss 3.5285125970840454
5_q proxy err 0.0007319757714867592 tr(WHW.T) 6770.97509765625
bpp_loss 4.3171703815460205
5_k proxy err 0.0004809811944141984 tr(WHW.T) 10841.955078125
bpp_loss 4.3957438468933105
5_o proxy err 0.011162101291120052 tr(WHW.T) 7.947142601013184
bpp_loss 3.509605288505554
5_up proxy err 0.006594844628125429 tr(WHW.T) 506.6408386230469
bpp_loss 3.699130036110102
5_gate proxy err 0.003148743649944663 tr(WHW.T) 1104.867919921875
bpp_loss 3.8346122919126997
5_down proxy err 0.007419830188155174 tr(WHW.T) 15.6494779586792
bpp_loss 3.6973652950553006
I0318 07:31:51.845494 407588 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 1.058011531829834s
I0318 07:31:55.435926 410592 config.py:54] PyTorch version 2.6.0 available.
W0318 07:31:55.756738 410592 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:31:56.804522 410592 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:31:56.808542 407588 quantize_finetune_llama.py:203] layer 9 gpu 1
I0318 07:31:56.825075 410592 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.013091936707496643 tr(WHW.T) 443.5464782714844
bpp_loss 3.4660861492156982
6_q proxy err 0.0009385651792399585 tr(WHW.T) 7576.53857421875
bpp_loss 4.209874391555786
6_k proxy err 0.0007052491419017315 tr(WHW.T) 10409.4033203125
bpp_loss 4.245347738265991
6_o proxy err 0.010296718217432499 tr(WHW.T) 11.564380645751953
bpp_loss 3.4552050828933716
6_up proxy err 0.006608247756958008 tr(WHW.T) 617.2608642578125
bpp_loss 3.6951682512150255
6_gate proxy err 0.00275585544295609 tr(WHW.T) 1554.7271728515625
bpp_loss 3.857109779535338
6_down proxy err 0.007653936743736267 tr(WHW.T) 22.988168716430664
bpp_loss 3.6909704430158747
I0318 07:32:07.712531 407588 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 1.0574727058410645s
I0318 07:32:11.538416 410823 config.py:54] PyTorch version 2.6.0 available.
W0318 07:32:11.863887 410823 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:32:12.910211 410823 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:32:12.914467 407588 quantize_finetune_llama.py:203] layer 10 gpu 2
I0318 07:32:12.929098 410823 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.012771591544151306 tr(WHW.T) 489.9357604980469
bpp_loss 3.4761635065078735
7_q proxy err 0.0010038061300292611 tr(WHW.T) 7672.17919921875
bpp_loss 4.20682168006897
7_k proxy err 0.0007678869878873229 tr(WHW.T) 10198.3701171875
bpp_loss 4.215227842330933
7_o proxy err 0.011781690642237663 tr(WHW.T) 15.11335563659668
bpp_loss 3.4612648487091064
7_up proxy err 0.006515090819448233 tr(WHW.T) 735.8538818359375
bpp_loss 3.6991649893827216
7_gate proxy err 0.002684418810531497 tr(WHW.T) 1876.0390625
bpp_loss 3.856303015420603
7_down proxy err 0.007758069783449173 tr(WHW.T) 30.58672523498535
bpp_loss 3.69278182539829
I0318 07:32:21.408625 407588 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 1.118065357208252s
I0318 07:32:25.282816 411049 config.py:54] PyTorch version 2.6.0 available.
W0318 07:32:25.628162 411049 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:32:26.555866 411049 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:32:26.559528 407588 quantize_finetune_llama.py:203] layer 11 gpu 3
I0318 07:32:26.573138 411049 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:32:28.368295 407588 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.3639893531799316s
I0318 07:32:32.140627 411175 config.py:54] PyTorch version 2.6.0 available.
W0318 07:32:32.499925 411175 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:32:33.583933 411175 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:32:33.588088 407588 quantize_finetune_llama.py:203] layer 12 gpu 0
I0318 07:32:33.602053 411175 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.012093774974346161 tr(WHW.T) 530.9967041015625
bpp_loss 3.498223662376404
8_q proxy err 0.0010863880161195993 tr(WHW.T) 7228.1201171875
bpp_loss 4.22411036491394
8_k proxy err 0.0007544321124441922 tr(WHW.T) 10639.1015625
bpp_loss 4.234543323516846
8_o proxy err 0.01334113534539938 tr(WHW.T) 20.092191696166992
bpp_loss 3.484807848930359
8_up proxy err 0.0060057020746171474 tr(WHW.T) 866.312744140625
bpp_loss 3.713214785553688
8_gate proxy err 0.002752520376816392 tr(WHW.T) 1970.857177734375
bpp_loss 3.8350601196289062
8_down proxy err 0.007731966208666563 tr(WHW.T) 37.177734375
bpp_loss 3.7046154155287634
9_v proxy err 0.01137623842805624 tr(WHW.T) 565.0663452148438
bpp_loss 3.5147788524627686
9_q proxy err 0.0011246183421462774 tr(WHW.T) 6970.3359375
bpp_loss 4.226754426956177
9_k proxy err 0.0007306370534934103 tr(WHW.T) 10987.3515625
bpp_loss 4.271822452545166
9_o proxy err 0.013273695483803749 tr(WHW.T) 25.610172271728516
bpp_loss 3.5031704902648926
9_up proxy err 0.0057992576621472836 tr(WHW.T) 970.8984375
bpp_loss 3.721028527548147
9_gate proxy err 0.0027365521527826786 tr(WHW.T) 2132.69384765625
bpp_loss 3.8223585971566134
9_down proxy err 0.007753764744848013 tr(WHW.T) 42.99482727050781
bpp_loss 3.712471917618153
I0318 07:33:10.174568 407588 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 0.981687068939209s
I0318 07:33:13.875812 411707 config.py:54] PyTorch version 2.6.0 available.
W0318 07:33:14.230413 411707 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:33:15.233851 411707 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:33:15.238146 407588 quantize_finetune_llama.py:203] layer 13 gpu 1
I0318 07:33:15.252483 411707 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.011499270796775818 tr(WHW.T) 578.807373046875
bpp_loss 3.5063087940216064
10_q proxy err 0.0011686927173286676 tr(WHW.T) 6915.87109375
bpp_loss 4.2242724895477295
10_k proxy err 0.0007581095560453832 tr(WHW.T) 10996.2431640625
bpp_loss 4.2791993618011475
10_o proxy err 0.013667411170899868 tr(WHW.T) 35.184165954589844
bpp_loss 3.499669075012207
10_up proxy err 0.005478972569108009 tr(WHW.T) 1080.198486328125
bpp_loss 3.7332839965820312
10_gate proxy err 0.0027056189719587564 tr(WHW.T) 2260.88330078125
bpp_loss 3.8183355996775075
10_down proxy err 0.007396112196147442 tr(WHW.T) 52.33584976196289
bpp_loss 3.7223211998163266
I0318 07:33:24.293922 407588 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 1.036740779876709s
I0318 07:33:28.180109 411931 config.py:54] PyTorch version 2.6.0 available.
W0318 07:33:28.516938 411931 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:33:29.495168 411931 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:33:29.499927 407588 quantize_finetune_llama.py:203] layer 14 gpu 2
I0318 07:33:29.517205 411931 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.010848193429410458 tr(WHW.T) 723.1956176757812
bpp_loss 3.542961597442627
11_q proxy err 0.0013245311565697193 tr(WHW.T) 7027.10986328125
bpp_loss 4.135108709335327
11_k proxy err 0.0008988093468360603 tr(WHW.T) 10511.23046875
bpp_loss 4.130403280258179
11_o proxy err 0.01379534974694252 tr(WHW.T) 36.654052734375
bpp_loss 3.534420609474182
11_up proxy err 0.0055823675356805325 tr(WHW.T) 1139.6044921875
bpp_loss 3.743302811023801
11_gate proxy err 0.0027357996441423893 tr(WHW.T) 2392.716552734375
bpp_loss 3.8135867451512535
11_down proxy err 0.007578791584819555 tr(WHW.T) 56.13530731201172
bpp_loss 3.729888139769088
I0318 07:33:36.520031 407588 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 1.0865991115570068s
I0318 07:33:40.269251 412119 config.py:54] PyTorch version 2.6.0 available.
W0318 07:33:40.599062 412119 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:33:41.654894 412119 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:33:41.659078 407588 quantize_finetune_llama.py:203] layer 15 gpu 3
I0318 07:33:41.672917 412119 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:33:43.181385 407588 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 1.0217235088348389s
I0318 07:33:46.986954 412246 config.py:54] PyTorch version 2.6.0 available.
W0318 07:33:47.334304 412246 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:33:48.327795 412246 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:33:48.331998 407588 quantize_finetune_llama.py:203] layer 16 gpu 0
I0318 07:33:48.345835 412246 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.011094829998910427 tr(WHW.T) 703.318603515625
bpp_loss 3.531693696975708
12_q proxy err 0.001328698475845158 tr(WHW.T) 7045.6435546875
bpp_loss 4.1702680587768555
12_k proxy err 0.000876360631082207 tr(WHW.T) 10893.65625
bpp_loss 4.22398567199707
12_o proxy err 0.01403450034558773 tr(WHW.T) 39.29071044921875
bpp_loss 3.524163007736206
12_up proxy err 0.005535479635000229 tr(WHW.T) 1228.298583984375
bpp_loss 3.7541679559751997
12_gate proxy err 0.002914242912083864 tr(WHW.T) 2381.994873046875
bpp_loss 3.8054790053256724
12_down proxy err 0.00757624814286828 tr(WHW.T) 64.17745208740234
bpp_loss 3.7397407487381336
13_v proxy err 0.011012163944542408 tr(WHW.T) 714.5677490234375
bpp_loss 3.5643322467803955
13_q proxy err 0.001331403967924416 tr(WHW.T) 6956.03564453125
bpp_loss 4.153772592544556
13_k proxy err 0.0009078822913579643 tr(WHW.T) 10426.6318359375
bpp_loss 4.184857130050659
13_o proxy err 0.012464430183172226 tr(WHW.T) 45.8377571105957
bpp_loss 3.555185079574585
13_up proxy err 0.005333310924470425 tr(WHW.T) 1367.6221923828125
bpp_loss 3.7664825084597564
13_gate proxy err 0.002857400570064783 tr(WHW.T) 2601.504638671875
bpp_loss 3.8008263166560683
13_down proxy err 0.007603104691952467 tr(WHW.T) 79.3589096069336
bpp_loss 3.7492269471634265
I0318 07:34:27.249805 407588 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 1.106579065322876s
I0318 07:34:31.066594 412770 config.py:54] PyTorch version 2.6.0 available.
W0318 07:34:31.392161 412770 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:34:32.423925 412770 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:34:32.428186 407588 quantize_finetune_llama.py:203] layer 17 gpu 1
I0318 07:34:32.442299 412770 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.011645696125924587 tr(WHW.T) 706.1612548828125
bpp_loss 3.5472673177719116
14_q proxy err 0.0013642823323607445 tr(WHW.T) 7077.06103515625
bpp_loss 4.149325609207153
14_k proxy err 0.0008749603293836117 tr(WHW.T) 11295.16796875
bpp_loss 4.1824469566345215
14_o proxy err 0.01373144332319498 tr(WHW.T) 50.921180725097656
bpp_loss 3.5371204614639282
14_up proxy err 0.0053847115486860275 tr(WHW.T) 1464.7159423828125
bpp_loss 3.767791038335756
14_gate proxy err 0.0029902132228016853 tr(WHW.T) 2682.584716796875
bpp_loss 3.7981815781704213
14_down proxy err 0.007772323675453663 tr(WHW.T) 90.28684997558594
bpp_loss 3.7504270464874976
I0318 07:34:39.732237 407588 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.3456544876098633s
I0318 07:34:43.496541 412960 config.py:54] PyTorch version 2.6.0 available.
W0318 07:34:43.838115 412960 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.010650007985532284 tr(WHW.T) 762.7275390625
bpp_loss 3.5838325023651123
15_q proxy err 0.0013151905732229352 tr(WHW.T) 7252.0009765625
bpp_loss 4.12861704826355
15_k proxy err 0.0008826968842186034 tr(WHW.T) 11072.3974609375
bpp_loss 4.186950445175171
15_o proxy err 0.011710588820278645 tr(WHW.T) 59.61664962768555
bpp_loss 3.5712682008743286
15_up proxy err 0.005254120100289583 tr(WHW.T) 1641.0228271484375
bpp_loss 3.774424353311228
15_gate proxy err 0.003018700983375311 tr(WHW.T) 2905.140380859375
bpp_loss 3.804939624875091
15_down proxy err 0.007772272452712059 tr(WHW.T) 114.09001922607422
bpp_loss 3.7547359022983287
W0318 07:34:44.835860 412960 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:34:44.840102 407588 quantize_finetune_llama.py:203] layer 18 gpu 2
I0318 07:34:44.854069 412960 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:34:46.347763 407588 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.9875133037567139s
I0318 07:34:50.108809 413090 config.py:54] PyTorch version 2.6.0 available.
W0318 07:34:50.395187 413090 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:34:51.343255 413090 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:34:51.347874 407588 quantize_finetune_llama.py:203] layer 19 gpu 3
I0318 07:34:51.365737 413090 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:34:53.003259 407588 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 1.12088942527771s
I0318 07:34:56.993123 413221 config.py:54] PyTorch version 2.6.0 available.
W0318 07:34:57.341492 413221 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:34:58.364521 413221 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:34:58.368872 407588 quantize_finetune_llama.py:203] layer 20 gpu 0
I0318 07:34:58.382571 413221 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.010783828794956207 tr(WHW.T) 780.7407836914062
bpp_loss 3.6248279809951782
16_q proxy err 0.0013517256593331695 tr(WHW.T) 7193.3974609375
bpp_loss 4.116287469863892
16_k proxy err 0.0008586155017837882 tr(WHW.T) 11630.361328125
bpp_loss 4.161128520965576
16_o proxy err 0.009183558635413647 tr(WHW.T) 88.22785186767578
bpp_loss 3.614545702934265
16_up proxy err 0.005140248220413923 tr(WHW.T) 1890.9385986328125
bpp_loss 3.7734405162722564
16_gate proxy err 0.002940649865195155 tr(WHW.T) 3369.859130859375
bpp_loss 3.8137308165084485
16_down proxy err 0.007882962003350258 tr(WHW.T) 152.0294952392578
bpp_loss 3.753877284914948
17_v proxy err 0.010143996216356754 tr(WHW.T) 845.7654418945312
bpp_loss 3.621377468109131
17_q proxy err 0.0013743401505053043 tr(WHW.T) 7163.2734375
bpp_loss 4.103015661239624
17_k proxy err 0.0009397898684255779 tr(WHW.T) 10697.431640625
bpp_loss 4.139855146408081
17_o proxy err 0.010037336498498917 tr(WHW.T) 58.14826965332031
bpp_loss 3.615356683731079
17_up proxy err 0.0055933548137545586 tr(WHW.T) 1921.07861328125
bpp_loss 3.7688330716865006
17_gate proxy err 0.0030746532138437033 tr(WHW.T) 3571.31640625
bpp_loss 3.825792356979015
17_down proxy err 0.007803428452461958 tr(WHW.T) 165.43495178222656
bpp_loss 3.7526287034500476
I0318 07:35:42.561529 407588 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.0812721252441406s
I0318 07:35:46.420747 413786 config.py:54] PyTorch version 2.6.0 available.
W0318 07:35:46.772710 413786 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.009334606118500233 tr(WHW.T) 1003.7705078125
bpp_loss 3.669760823249817
18_q proxy err 0.0014071929035708308 tr(WHW.T) 7510.48046875
bpp_loss 4.066167831420898
18_k proxy err 0.0010270901257172227 tr(WHW.T) 10462.6650390625
bpp_loss 4.1016833782196045
18_o proxy err 0.008851684629917145 tr(WHW.T) 69.96558380126953
bpp_loss 3.654704213142395
18_up proxy err 0.0059500266797840595 tr(WHW.T) 2023.183837890625
bpp_loss 3.7652948069017986
18_gate proxy err 0.0032605209853500128 tr(WHW.T) 3783.076416015625
bpp_loss 3.8374672823174056
18_down proxy err 0.007834909483790398 tr(WHW.T) 198.52699279785156
bpp_loss 3.7514113492743912
W0318 07:35:47.747570 413786 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:35:47.751598 407588 quantize_finetune_llama.py:203] layer 21 gpu 1
I0318 07:35:47.765702 413786 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:35:49.987650 407588 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 1.082669734954834s
I0318 07:35:53.809854 413919 config.py:54] PyTorch version 2.6.0 available.
W0318 07:35:54.149803 413919 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.009113011881709099 tr(WHW.T) 1019.1412353515625
bpp_loss 3.6793211698532104
19_q proxy err 0.0014999755658209324 tr(WHW.T) 6944.4130859375
bpp_loss 4.046271800994873
19_k proxy err 0.0010069614509120584 tr(WHW.T) 10548.4892578125
bpp_loss 4.076947212219238
19_o proxy err 0.008717966265976429 tr(WHW.T) 62.291683197021484
bpp_loss 3.668082118034363
19_up proxy err 0.005983916576951742 tr(WHW.T) 2149.330322265625
bpp_loss 3.7652101738508357
19_gate proxy err 0.0035750276874750853 tr(WHW.T) 3687.5126953125
bpp_loss 3.8422104591547055
19_down proxy err 0.00763104110956192 tr(WHW.T) 222.93177795410156
bpp_loss 3.7540778670200083
W0318 07:35:55.116199 413919 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:35:55.120429 407588 quantize_finetune_llama.py:203] layer 22 gpu 2
I0318 07:35:55.134507 413919 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:35:56.571224 407588 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 0.9849169254302979s
I0318 07:36:00.273510 414047 config.py:54] PyTorch version 2.6.0 available.
W0318 07:36:00.566287 414047 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:36:01.468078 414047 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:36:01.472212 407588 quantize_finetune_llama.py:203] layer 23 gpu 3
I0318 07:36:01.485967 414047 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:36:03.306304 407588 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.3250563144683838s
I0318 07:36:07.179085 414175 config.py:54] PyTorch version 2.6.0 available.
W0318 07:36:07.544787 414175 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:36:08.547398 414175 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:36:08.551639 407588 quantize_finetune_llama.py:203] layer 24 gpu 0
I0318 07:36:08.568609 414175 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.00945296511054039 tr(WHW.T) 990.5983276367188
bpp_loss 3.696347951889038
20_q proxy err 0.0014647574862465262 tr(WHW.T) 7150.947265625
bpp_loss 4.056716680526733
20_k proxy err 0.0010253367945551872 tr(WHW.T) 10386.2470703125
bpp_loss 4.08587384223938
20_o proxy err 0.006465406622737646 tr(WHW.T) 100.31707000732422
bpp_loss 3.6893619298934937
20_up proxy err 0.005858279298990965 tr(WHW.T) 2340.89453125
bpp_loss 3.7644309110419694
20_gate proxy err 0.0034970480483025312 tr(WHW.T) 4024.62744140625
bpp_loss 3.84938244486964
20_down proxy err 0.007584539242088795 tr(WHW.T) 274.8815002441406
bpp_loss 3.7539204885793285
21_v proxy err 0.009063086472451687 tr(WHW.T) 1144.5655517578125
bpp_loss 3.731325387954712
21_q proxy err 0.0016213062917813659 tr(WHW.T) 7064.314453125
bpp_loss 4.021005630493164
21_k proxy err 0.0011635073460638523 tr(WHW.T) 9976.4658203125
bpp_loss 4.038107872009277
21_o proxy err 0.006916129030287266 tr(WHW.T) 75.50972747802734
bpp_loss 3.714258313179016
21_up proxy err 0.006162772886455059 tr(WHW.T) 2361.650390625
bpp_loss 3.7624071697856105
21_gate proxy err 0.0037395053077489138 tr(WHW.T) 4004.37646484375
bpp_loss 3.8584309067837026
21_down proxy err 0.007589532993733883 tr(WHW.T) 276.5857849121094
bpp_loss 3.7538828960684842
I0318 07:36:52.801882 407588 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 1.0742387771606445s
I0318 07:36:56.478757 414720 config.py:54] PyTorch version 2.6.0 available.
W0318 07:36:56.829350 414720 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.008691417053341866 tr(WHW.T) 1243.2529296875
bpp_loss 3.7354432344436646
22_q proxy err 0.0015417466638609767 tr(WHW.T) 7746.84765625
bpp_loss 4.054149150848389
22_k proxy err 0.00114123011007905 tr(WHW.T) 10603.2041015625
bpp_loss 4.074338436126709
22_o proxy err 0.005833842791616917 tr(WHW.T) 114.30065155029297
bpp_loss 3.71712327003479
22_up proxy err 0.006201349664479494 tr(WHW.T) 2474.510498046875
bpp_loss 3.761816690134448
22_gate proxy err 0.0038052573800086975 tr(WHW.T) 4156.64013671875
bpp_loss 3.866197098133176
22_down proxy err 0.007551452610641718 tr(WHW.T) 311.8800048828125
bpp_loss 3.7543138016101927
W0318 07:36:57.802766 414720 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:36:57.806993 407588 quantize_finetune_llama.py:203] layer 25 gpu 1
I0318 07:36:57.820698 414720 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:36:59.889511 407588 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 1.037506103515625s
I0318 07:37:03.705778 414846 config.py:54] PyTorch version 2.6.0 available.
W0318 07:37:04.054448 414846 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.007944251410663128 tr(WHW.T) 1486.037353515625
bpp_loss 3.7912638187408447
23_q proxy err 0.0017429236322641373 tr(WHW.T) 7346.60986328125
bpp_loss 4.043066024780273
23_k proxy err 0.0013051206478849053 tr(WHW.T) 9982.2392578125
bpp_loss 4.055379152297974
23_o proxy err 0.007069818675518036 tr(WHW.T) 85.13458251953125
bpp_loss 3.7758980989456177
23_up proxy err 0.006429573055356741 tr(WHW.T) 2533.51025390625
bpp_loss 3.767797070880269
23_gate proxy err 0.004086234141141176 tr(WHW.T) 4097.51953125
bpp_loss 3.8659032777298328
23_down proxy err 0.007586883846670389 tr(WHW.T) 321.33892822265625
bpp_loss 3.7614898681640625
W0318 07:37:05.089063 414846 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:37:05.093288 407588 quantize_finetune_llama.py:203] layer 26 gpu 2
I0318 07:37:05.107259 414846 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:37:06.772417 407588 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 0.9887583255767822s
I0318 07:37:10.534050 414979 config.py:54] PyTorch version 2.6.0 available.
W0318 07:37:10.846251 414979 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:37:11.843516 414979 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:37:11.847770 407588 quantize_finetune_llama.py:203] layer 27 gpu 3
I0318 07:37:11.863982 414979 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:37:13.418253 407588 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 1.0598526000976562s
I0318 07:37:17.291131 415107 config.py:54] PyTorch version 2.6.0 available.
W0318 07:37:17.618479 415107 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:37:18.642067 415107 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:37:18.646584 407588 quantize_finetune_llama.py:203] layer 28 gpu 0
I0318 07:37:18.663152 415107 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.008382806554436684 tr(WHW.T) 1394.900634765625
bpp_loss 3.7800101041793823
24_q proxy err 0.001795276184566319 tr(WHW.T) 7020.447265625
bpp_loss 3.9991540908813477
24_k proxy err 0.0012405976885929704 tr(WHW.T) 10323.43359375
bpp_loss 4.0072245597839355
24_o proxy err 0.005588225554674864 tr(WHW.T) 133.98797607421875
bpp_loss 3.7586323022842407
24_up proxy err 0.006518190260976553 tr(WHW.T) 2621.76513671875
bpp_loss 3.771555168684139
24_gate proxy err 0.004120361525565386 tr(WHW.T) 4262.74853515625
bpp_loss 3.869190304778343
24_down proxy err 0.007627916522324085 tr(WHW.T) 340.22412109375
bpp_loss 3.765876991804256
25_v proxy err 0.00763463880866766 tr(WHW.T) 1707.664794921875
bpp_loss 3.826869487762451
25_q proxy err 0.0019311057403683662 tr(WHW.T) 7162.16357421875
bpp_loss 4.0122246742248535
25_k proxy err 0.001461209380067885 tr(WHW.T) 9611.58984375
bpp_loss 4.017290830612183
25_o proxy err 0.006681235507130623 tr(WHW.T) 83.535888671875
bpp_loss 3.808623790740967
25_up proxy err 0.006482470780611038 tr(WHW.T) 2805.728515625
bpp_loss 3.7768948577171146
25_gate proxy err 0.004008228424936533 tr(WHW.T) 4666.4404296875
bpp_loss 3.871827236441679
25_down proxy err 0.007583718281239271 tr(WHW.T) 373.460693359375
bpp_loss 3.771963496540868
I0318 07:38:03.006255 407588 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 1.0422585010528564s
I0318 07:38:06.719423 415657 config.py:54] PyTorch version 2.6.0 available.
W0318 07:38:07.057516 415657 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.007682288996875286 tr(WHW.T) 1668.8843994140625
bpp_loss 3.84795880317688
26_q proxy err 0.0018106179777532816 tr(WHW.T) 7469.98291015625
bpp_loss 3.9878934621810913
26_k proxy err 0.0013135948684066534 tr(WHW.T) 10487.8740234375
bpp_loss 3.9998059272766113
26_o proxy err 0.004641722422093153 tr(WHW.T) 202.88172912597656
bpp_loss 3.8390653133392334
26_up proxy err 0.006097073201090097 tr(WHW.T) 3154.75146484375
bpp_loss 3.781275194744731
26_gate proxy err 0.003727248404175043 tr(WHW.T) 5302.16455078125
bpp_loss 3.876027129417242
26_down proxy err 0.007793260272592306 tr(WHW.T) 401.19390869140625
bpp_loss 3.775747210480446
W0318 07:38:08.049648 415657 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:38:08.053891 407588 quantize_finetune_llama.py:203] layer 29 gpu 1
I0318 07:38:08.068385 415657 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:38:10.138020 407588 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 1.2646210193634033s
I0318 07:38:13.904521 415784 config.py:54] PyTorch version 2.6.0 available.
W0318 07:38:14.243415 415784 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.0069844285026192665 tr(WHW.T) 1799.3350830078125
bpp_loss 3.8502695560455322
27_q proxy err 0.0017407550476491451 tr(WHW.T) 7691.708984375
bpp_loss 4.04463005065918
27_k proxy err 0.0012720070080831647 tr(WHW.T) 10618.70703125
bpp_loss 4.059876441955566
27_o proxy err 0.006287310738116503 tr(WHW.T) 126.13690185546875
bpp_loss 3.8478587865829468
27_up proxy err 0.005566410720348358 tr(WHW.T) 3691.557861328125
bpp_loss 3.7875554284384085
27_gate proxy err 0.0035232114605605602 tr(WHW.T) 5990.82568359375
bpp_loss 3.877457907033521
27_down proxy err 0.007981169037520885 tr(WHW.T) 466.9318542480469
bpp_loss 3.7823052960772845
W0318 07:38:15.184553 415784 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:38:15.188664 407588 quantize_finetune_llama.py:203] layer 30 gpu 2
I0318 07:38:15.202471 415784 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:38:16.727169 407588 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 1.0550944805145264s
I0318 07:38:20.447657 415910 config.py:54] PyTorch version 2.6.0 available.
W0318 07:38:20.749629 415910 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:38:21.694086 415910 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:38:21.698359 407588 quantize_finetune_llama.py:203] layer 31 gpu 3
I0318 07:38:21.711861 415910 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 07:38:23.236299 407588 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.0393526554107666s
I0318 07:38:27.059178 416053 config.py:54] PyTorch version 2.6.0 available.
W0318 07:38:27.398033 416053 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 07:38:28.421239 416053 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 07:38:28.440174 416053 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.006509365048259497 tr(WHW.T) 2018.944091796875
bpp_loss 3.8928626775741577
28_q proxy err 0.00179967749863863 tr(WHW.T) 7651.126953125
bpp_loss 4.000083088874817
28_k proxy err 0.0013267925241962075 tr(WHW.T) 10544.8251953125
bpp_loss 4.018265724182129
28_o proxy err 0.0051943464204669 tr(WHW.T) 194.8240966796875
bpp_loss 3.8867850303649902
28_up proxy err 0.004669406451284885 tr(WHW.T) 4661.2666015625
bpp_loss 3.799817817155705
28_gate proxy err 0.0033956109546124935 tr(WHW.T) 6547.48193359375
bpp_loss 3.8716322433116823
28_down proxy err 0.008042419329285622 tr(WHW.T) 603.8403930664062
bpp_loss 3.789940590082213
29_v proxy err 0.00689115421846509 tr(WHW.T) 1801.7730712890625
bpp_loss 3.898319125175476
29_q proxy err 0.0017891392344608903 tr(WHW.T) 7227.0009765625
bpp_loss 3.9604908227920532
29_k proxy err 0.0012417706893756986 tr(WHW.T) 10558.609375
bpp_loss 3.9735125303268433
29_o proxy err 0.004384336527436972 tr(WHW.T) 207.9054412841797
bpp_loss 3.9030133485794067
29_up proxy err 0.003743237815797329 tr(WHW.T) 6070.0498046875
bpp_loss 3.811513856399891
29_gate proxy err 0.0031352806836366653 tr(WHW.T) 7369.6142578125
bpp_loss 3.8751862991687864
29_down proxy err 0.008166891522705555 tr(WHW.T) 782.2448120117188
bpp_loss 3.7943489385205647
30_v proxy err 0.005677285138517618 tr(WHW.T) 2261.489501953125
bpp_loss 3.9310860633850098
30_q proxy err 0.0017016226192936301 tr(WHW.T) 7815.9453125
bpp_loss 3.9702736139297485
30_k proxy err 0.0012823377037420869 tr(WHW.T) 10521.625
bpp_loss 3.9904301166534424
30_o proxy err 0.004600740969181061 tr(WHW.T) 251.96908569335938
bpp_loss 3.9383541345596313
30_up proxy err 0.002323034917935729 tr(WHW.T) 10016.376953125
bpp_loss 3.8330857032953305
30_gate proxy err 0.0021534902043640614 tr(WHW.T) 11001.119140625
bpp_loss 3.906639808832213
30_down proxy err 0.004744333680719137 tr(WHW.T) 3582.617919921875
bpp_loss 3.7868154437042945
31_v proxy err 0.0067026661708951 tr(WHW.T) 1268.2034912109375
bpp_loss 3.805243730545044
31_q proxy err 0.001335874549113214 tr(WHW.T) 6858.09130859375
bpp_loss 3.987922787666321
31_k proxy err 0.0009241351508535445 tr(WHW.T) 10233.677734375
bpp_loss 4.043160915374756
31_o proxy err 0.0035015041939914227 tr(WHW.T) 457.7950744628906
bpp_loss 3.8181596994400024
31_up proxy err 0.001346006290987134 tr(WHW.T) 14563.890625
bpp_loss 3.884322942689408
31_gate proxy err 0.0013449203688651323 tr(WHW.T) 14836.2939453125
bpp_loss 3.968122970226199
31_down proxy err 0.0033199144527316093 tr(WHW.T) 17873.55859375
bpp_loss 3.7852285739987397
