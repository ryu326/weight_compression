I0318 08:42:32.881325 462594 config.py:54] PyTorch version 2.6.0 available.
W0318 08:42:33.165512 462594 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:42:34.056360 462594 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.66it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.38it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  7.84it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.08it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.21it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  5.63it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  6.59it/s]
I0318 08:42:35.173792 462594 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:13,  2.17it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.15it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:12,  2.18it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:12,  2.17it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:11,  2.18it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:11,  2.16it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:11,  2.15it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:10,  2.11it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:10,  2.10it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:05<00:09,  2.11it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:09,  2.11it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:06<00:08,  2.18it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:06<00:08,  2.22it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:07,  2.26it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:07<00:07,  2.28it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:06,  2.30it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:08<00:06,  2.30it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:05,  2.32it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:09<00:05,  2.33it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:09<00:04,  2.33it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:09<00:04,  2.33it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:10<00:03,  2.33it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:10<00:03,  2.35it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:11<00:02,  2.35it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:11<00:02,  2.35it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:12<00:02,  2.36it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:12<00:01,  2.35it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:12<00:01,  2.37it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:13<00:00,  2.42it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:13<00:00,  2.45it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:14<00:00,  2.48it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:14<00:00,  2.28it/s]
I0318 08:42:55.819470 462594 quantize_finetune_llama.py:179] loaded compression model
I0318 08:43:10.058974 462594 quantize_finetune_llama.py:183] loaded dataset and devset
I0318 08:43:20.048467 462594 quantize_finetune_llama.py:203] layer 0 gpu 0
I0318 08:43:23.489726 462594 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 3.2959752082824707s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0318 08:43:40.598922 463567 config.py:54] PyTorch version 2.6.0 available.
W0318 08:43:40.879924 463567 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:43:41.774735 463567 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:43:41.778735 462594 quantize_finetune_llama.py:203] layer 1 gpu 1
I0318 08:43:41.792260 463567 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:43:45.251027 462594 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 3.310614585876465s
I0318 08:43:48.799165 463701 config.py:54] PyTorch version 2.6.0 available.
W0318 08:43:49.125717 463701 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:43:50.144791 463701 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:43:50.148909 462594 quantize_finetune_llama.py:203] layer 2 gpu 2
I0318 08:43:50.163885 463701 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:43:53.794397 462594 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 3.4904532432556152s
I0318 08:43:57.572404 463854 config.py:54] PyTorch version 2.6.0 available.
W0318 08:43:57.915315 463854 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:43:58.932651 463854 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:43:58.936783 462594 quantize_finetune_llama.py:203] layer 3 gpu 3
I0318 08:43:58.951423 463854 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:44:02.458857 462594 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 3.3594112396240234s
I0318 08:44:06.380050 464026 config.py:54] PyTorch version 2.6.0 available.
W0318 08:44:06.747013 464026 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:44:07.865000 464026 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:44:07.869288 462594 quantize_finetune_llama.py:203] layer 4 gpu 0
I0318 08:44:07.883955 464026 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.09972928464412689 tr(WHW.T) 4.225186347961426
bpp_loss 2.673425555229187
0_q proxy err 0.00067612633574754 tr(WHW.T) 2710.363037109375
bpp_loss 2.817549705505371
0_k proxy err 0.000765320670325309 tr(WHW.T) 1698.7349853515625
bpp_loss 2.9099684953689575
0_o proxy err 0.006801944691687822 tr(WHW.T) 0.9668058156967163
bpp_loss 2.491374135017395
0_up proxy err 0.013031411916017532 tr(WHW.T) 43.27138900756836
bpp_loss 2.9706834305164427
0_gate proxy err 0.009046058170497417 tr(WHW.T) 63.47430419921875
bpp_loss 2.9880662075308866
0_down proxy err 0.00910108257085085 tr(WHW.T) 0.656814694404602
bpp_loss 3.0148753898088323
1_v proxy err 0.14907893538475037 tr(WHW.T) 16.465883255004883
bpp_loss 2.621009945869446
1_q proxy err 0.0007796779973432422 tr(WHW.T) 4778.43994140625
bpp_loss 3.644659996032715
1_k proxy err 0.000769555103033781 tr(WHW.T) 4995.39208984375
bpp_loss 3.6415536403656006
1_o proxy err 0.025850534439086914 tr(WHW.T) 1.1115814447402954
bpp_loss 2.5359376668930054
1_up proxy err 0.01389875914901495 tr(WHW.T) 109.66383361816406
bpp_loss 3.035853008891261
1_gate proxy err 0.007154122926294804 tr(WHW.T) 221.3038787841797
bpp_loss 3.1047288761582483
1_down proxy err 0.008108156733214855 tr(WHW.T) 2041.4736328125
bpp_loss 3.052356298579726
I0318 08:44:49.688315 462594 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.964240312576294s
I0318 08:44:53.679401 464608 config.py:54] PyTorch version 2.6.0 available.
W0318 08:44:54.034256 464608 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:44:55.149083 464608 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:44:55.153823 462594 quantize_finetune_llama.py:203] layer 5 gpu 1
I0318 08:44:55.168971 464608 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.036900654435157776 tr(WHW.T) 136.67332458496094
bpp_loss 2.860966205596924
2_q proxy err 0.0009090779931284487 tr(WHW.T) 7752.85205078125
bpp_loss 3.6566768884658813
2_k proxy err 0.0007153266342356801 tr(WHW.T) 10205.837890625
bpp_loss 3.7476495504379272
2_o proxy err 0.021742161363363266 tr(WHW.T) 1.4603197574615479
bpp_loss 2.835548162460327
2_up proxy err 0.01623927243053913 tr(WHW.T) 193.43603515625
bpp_loss 3.055651997410974
2_gate proxy err 0.010534204542636871 tr(WHW.T) 306.6622619628906
bpp_loss 3.137807092001272
2_down proxy err 0.01871269755065441 tr(WHW.T) 3.010739803314209
bpp_loss 3.063243777252907
I0318 08:44:58.349157 462594 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 1.0791873931884766s
I0318 08:45:01.987892 464759 config.py:54] PyTorch version 2.6.0 available.
W0318 08:45:02.326566 464759 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:45:03.355654 464759 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:45:03.360129 462594 quantize_finetune_llama.py:203] layer 6 gpu 2
I0318 08:45:03.375932 464759 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.03586715832352638 tr(WHW.T) 284.77557373046875
bpp_loss 2.817149043083191
3_q proxy err 0.0017899980302900076 tr(WHW.T) 7217.63720703125
bpp_loss 3.5617599487304688
3_k proxy err 0.0013372331159189343 tr(WHW.T) 10074.73828125
bpp_loss 3.629682421684265
3_o proxy err 0.02157309465110302 tr(WHW.T) 3.3527450561523438
bpp_loss 2.800239682197571
3_up proxy err 0.01845509186387062 tr(WHW.T) 284.7950744628906
bpp_loss 3.063528016556141
3_gate proxy err 0.011311936192214489 tr(WHW.T) 478.13714599609375
bpp_loss 3.155561935069949
3_down proxy err 0.01910579763352871 tr(WHW.T) 6.133229732513428
bpp_loss 3.066647219103436
I0318 08:45:14.240529 462594 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 1.0287501811981201s
I0318 08:45:18.089883 465002 config.py:54] PyTorch version 2.6.0 available.
W0318 08:45:18.434972 465002 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:45:19.427205 465002 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:45:19.431383 462594 quantize_finetune_llama.py:203] layer 7 gpu 3
I0318 08:45:19.445381 465002 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:45:21.020228 462594 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 1.091888427734375s
I0318 08:45:24.987160 465135 config.py:54] PyTorch version 2.6.0 available.
W0318 08:45:25.334640 465135 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:45:26.338325 465135 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:45:26.342796 462594 quantize_finetune_llama.py:203] layer 8 gpu 0
I0318 08:45:26.358234 465135 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.03481988236308098 tr(WHW.T) 274.6131286621094
bpp_loss 2.861976146697998
4_q proxy err 0.0017178396228700876 tr(WHW.T) 6914.9892578125
bpp_loss 3.6333353519439697
4_k proxy err 0.0011925804428756237 tr(WHW.T) 10415.33203125
bpp_loss 3.670268177986145
4_o proxy err 0.021543199196457863 tr(WHW.T) 5.139806270599365
bpp_loss 2.8438243865966797
4_up proxy err 0.018186261877417564 tr(WHW.T) 397.6960144042969
bpp_loss 3.055507926053779
4_gate proxy err 0.009162086993455887 tr(WHW.T) 821.1856689453125
bpp_loss 3.181195103844931
4_down proxy err 0.019082847982645035 tr(WHW.T) 11.562739372253418
bpp_loss 3.0534748254820356
5_v proxy err 0.03421640396118164 tr(WHW.T) 298.47540283203125
bpp_loss 2.8846280574798584
5_q proxy err 0.0018629394471645355 tr(WHW.T) 6770.97509765625
bpp_loss 3.6420098543167114
5_k proxy err 0.001241407124325633 tr(WHW.T) 10841.955078125
bpp_loss 3.7136635780334473
5_o proxy err 0.030302448198199272 tr(WHW.T) 7.947142601013184
bpp_loss 2.8653643131256104
5_up proxy err 0.017849629744887352 tr(WHW.T) 506.6408386230469
bpp_loss 3.0556097695993825
5_gate proxy err 0.00854442548006773 tr(WHW.T) 1104.867919921875
bpp_loss 3.188923857932867
5_down proxy err 0.020138610154390335 tr(WHW.T) 15.6494779586792
bpp_loss 3.0544756068739782
I0318 08:46:02.310944 462594 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 1.076866865158081s
I0318 08:46:05.891360 465705 config.py:54] PyTorch version 2.6.0 available.
W0318 08:46:06.238694 465705 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:46:07.191370 465705 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:46:07.195856 462594 quantize_finetune_llama.py:203] layer 9 gpu 1
I0318 08:46:07.209591 465705 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.03443362936377525 tr(WHW.T) 443.5464782714844
bpp_loss 2.820629119873047
6_q proxy err 0.0024582052137702703 tr(WHW.T) 7576.53857421875
bpp_loss 3.544117569923401
6_k proxy err 0.0018416122766211629 tr(WHW.T) 10409.4033203125
bpp_loss 3.577282428741455
6_o proxy err 0.02792850323021412 tr(WHW.T) 11.564380645751953
bpp_loss 2.809521198272705
6_up proxy err 0.017870036885142326 tr(WHW.T) 617.2608642578125
bpp_loss 3.0516756634379543
6_gate proxy err 0.007463586051017046 tr(WHW.T) 1554.7271728515625
bpp_loss 3.210718554119731
6_down proxy err 0.020777173340320587 tr(WHW.T) 22.988168716430664
bpp_loss 3.04807607517686
I0318 08:46:18.825330 462594 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 1.0705571174621582s
I0318 08:46:22.588324 465937 config.py:54] PyTorch version 2.6.0 available.
W0318 08:46:22.919493 465937 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:46:23.961311 465937 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:46:23.965660 462594 quantize_finetune_llama.py:203] layer 10 gpu 2
I0318 08:46:23.980715 465937 data_utils.py:336] using 256 training seqs, 128 validation seqs
7_v proxy err 0.03361498937010765 tr(WHW.T) 489.9357604980469
bpp_loss 2.8308706283569336
7_q proxy err 0.002621728926897049 tr(WHW.T) 7672.17919921875
bpp_loss 3.541151285171509
7_k proxy err 0.0020141336135566235 tr(WHW.T) 10198.3701171875
bpp_loss 3.549338459968567
7_o proxy err 0.03181520104408264 tr(WHW.T) 15.11335563659668
bpp_loss 2.815612316131592
7_up proxy err 0.017603799700737 tr(WHW.T) 735.8538818359375
bpp_loss 3.0555418147597204
7_gate proxy err 0.007263096980750561 tr(WHW.T) 1876.0390625
bpp_loss 3.209931484488554
7_down proxy err 0.02104862593114376 tr(WHW.T) 30.58672523498535
bpp_loss 3.0498908286870914
I0318 08:46:32.944229 462594 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 1.1335763931274414s
I0318 08:46:36.729979 466151 config.py:54] PyTorch version 2.6.0 available.
W0318 08:46:37.057986 466151 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:46:38.041870 466151 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:46:38.045657 462594 quantize_finetune_llama.py:203] layer 11 gpu 3
I0318 08:46:38.059555 466151 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:46:39.842834 462594 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.3554375171661377s
I0318 08:46:43.849108 466274 config.py:54] PyTorch version 2.6.0 available.
W0318 08:46:44.227009 466274 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:46:45.260941 466274 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:46:45.265172 462594 quantize_finetune_llama.py:203] layer 12 gpu 0
I0318 08:46:45.281345 466274 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.031524304300546646 tr(WHW.T) 530.9967041015625
bpp_loss 2.8534493446350098
8_q proxy err 0.002814698964357376 tr(WHW.T) 7228.1201171875
bpp_loss 3.5573394298553467
8_k proxy err 0.001961196307092905 tr(WHW.T) 10639.1015625
bpp_loss 3.567426085472107
8_o proxy err 0.03606043756008148 tr(WHW.T) 20.092191696166992
bpp_loss 2.839929938316345
8_up proxy err 0.01622096449136734 tr(WHW.T) 866.312744140625
bpp_loss 3.0695463668468386
8_gate proxy err 0.007460591848939657 tr(WHW.T) 1970.857177734375
bpp_loss 3.189188935035883
8_down proxy err 0.02097688987851143 tr(WHW.T) 37.177734375
bpp_loss 3.0615378535071085
9_v proxy err 0.03002293035387993 tr(WHW.T) 565.0663452148438
bpp_loss 2.87066113948822
9_q proxy err 0.002919446676969528 tr(WHW.T) 6970.3359375
bpp_loss 3.5596197843551636
9_k proxy err 0.0019086955580860376 tr(WHW.T) 10987.3515625
bpp_loss 3.60178005695343
9_o proxy err 0.035907596349716187 tr(WHW.T) 25.610172271728516
bpp_loss 2.858609437942505
9_up proxy err 0.01565389707684517 tr(WHW.T) 970.8984375
bpp_loss 3.0772875408793605
9_gate proxy err 0.007425315212458372 tr(WHW.T) 2132.69384765625
bpp_loss 3.17709811898165
9_down proxy err 0.021002713590860367 tr(WHW.T) 42.99482727050781
bpp_loss 3.0693114302879154
I0318 08:47:22.166813 462594 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 1.027066707611084s
I0318 08:47:25.977986 466830 config.py:54] PyTorch version 2.6.0 available.
W0318 08:47:26.320994 466830 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:47:27.359075 466830 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:47:27.363425 462594 quantize_finetune_llama.py:203] layer 13 gpu 1
I0318 08:47:27.378131 466830 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v proxy err 0.030314302071928978 tr(WHW.T) 578.807373046875
bpp_loss 2.8620928525924683
10_q proxy err 0.003057862166315317 tr(WHW.T) 6915.87109375
bpp_loss 3.557539701461792
10_k proxy err 0.001983871916308999 tr(WHW.T) 10996.2431640625
bpp_loss 3.6085039377212524
10_o proxy err 0.037024226039648056 tr(WHW.T) 35.184165954589844
bpp_loss 2.85499906539917
10_up proxy err 0.014784575439989567 tr(WHW.T) 1080.198486328125
bpp_loss 3.089357243027798
10_gate proxy err 0.007333776913583279 tr(WHW.T) 2260.88330078125
bpp_loss 3.1731405923532887
10_down proxy err 0.020026233047246933 tr(WHW.T) 52.33584976196289
bpp_loss 3.079102582709734
I0318 08:47:36.285351 462594 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 1.07078218460083s
I0318 08:47:40.103600 467088 config.py:54] PyTorch version 2.6.0 available.
W0318 08:47:40.460107 467088 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:47:41.458382 467088 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:47:41.462500 462594 quantize_finetune_llama.py:203] layer 14 gpu 2
I0318 08:47:41.476608 467088 data_utils.py:336] using 256 training seqs, 128 validation seqs
11_v proxy err 0.028809938579797745 tr(WHW.T) 723.1956176757812
bpp_loss 2.899327039718628
11_q proxy err 0.0034719358664005995 tr(WHW.T) 7027.10986328125
bpp_loss 3.475072741508484
11_k proxy err 0.0024234349839389324 tr(WHW.T) 10511.23046875
bpp_loss 3.470799207687378
11_o proxy err 0.037134457379579544 tr(WHW.T) 36.654052734375
bpp_loss 2.890338897705078
11_up proxy err 0.01507067121565342 tr(WHW.T) 1139.6044921875
bpp_loss 3.099172547806141
11_gate proxy err 0.007422289811074734 tr(WHW.T) 2392.716552734375
bpp_loss 3.168548583984375
11_down proxy err 0.020512878894805908 tr(WHW.T) 56.13530731201172
bpp_loss 3.0864485807197037
I0318 08:47:48.562867 462594 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 1.219592809677124s
I0318 08:47:52.311784 467277 config.py:54] PyTorch version 2.6.0 available.
W0318 08:47:52.645421 467277 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:47:53.661974 467277 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:47:53.666234 462594 quantize_finetune_llama.py:203] layer 15 gpu 3
I0318 08:47:53.682642 467277 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:47:55.303094 462594 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 1.1158013343811035s
I0318 08:47:59.154616 467416 config.py:54] PyTorch version 2.6.0 available.
W0318 08:47:59.456184 467416 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:48:00.423884 467416 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:48:00.428274 462594 quantize_finetune_llama.py:203] layer 16 gpu 0
I0318 08:48:00.443257 467416 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.02942913956940174 tr(WHW.T) 703.318603515625
bpp_loss 2.887778401374817
12_q proxy err 0.0034604377578943968 tr(WHW.T) 7045.6435546875
bpp_loss 3.5071792602539062
12_k proxy err 0.0023132634814828634 tr(WHW.T) 10893.65625
bpp_loss 3.557543635368347
12_o proxy err 0.03793466463685036 tr(WHW.T) 39.29071044921875
bpp_loss 2.8800911903381348
12_up proxy err 0.014910213649272919 tr(WHW.T) 1228.298583984375
bpp_loss 3.1098434093386627
12_gate proxy err 0.007923980243504047 tr(WHW.T) 2381.994873046875
bpp_loss 3.160658370616824
12_down proxy err 0.02048603817820549 tr(WHW.T) 64.17745208740234
bpp_loss 3.0961690059928006
13_v proxy err 0.02917887084186077 tr(WHW.T) 714.5677490234375
bpp_loss 2.9208215475082397
13_q proxy err 0.0034859084989875555 tr(WHW.T) 6956.03564453125
bpp_loss 3.492494225502014
13_k proxy err 0.002410991583019495 tr(WHW.T) 10426.6318359375
bpp_loss 3.521259307861328
13_o proxy err 0.033738456666469574 tr(WHW.T) 45.8377571105957
bpp_loss 2.911745309829712
13_up proxy err 0.01440251711755991 tr(WHW.T) 1367.6221923828125
bpp_loss 3.121792283169059
13_gate proxy err 0.007765524089336395 tr(WHW.T) 2601.504638671875
bpp_loss 3.156221079271893
13_down proxy err 0.020551420748233795 tr(WHW.T) 79.3589096069336
bpp_loss 3.1053569483202557
I0318 08:48:39.640508 462594 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 1.0470223426818848s
I0318 08:48:43.516054 467949 config.py:54] PyTorch version 2.6.0 available.
W0318 08:48:43.846380 467949 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:48:44.872591 467949 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:48:44.876987 462594 quantize_finetune_llama.py:203] layer 17 gpu 1
I0318 08:48:44.892081 467949 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.03087695874273777 tr(WHW.T) 706.1612548828125
bpp_loss 2.9035204648971558
14_q proxy err 0.003604851895943284 tr(WHW.T) 7077.06103515625
bpp_loss 3.4877344369888306
14_k proxy err 0.0023410876747220755 tr(WHW.T) 11295.16796875
bpp_loss 3.5190248489379883
14_o proxy err 0.037078700959682465 tr(WHW.T) 50.921180725097656
bpp_loss 2.8932560682296753
14_up proxy err 0.014561993069946766 tr(WHW.T) 1464.7159423828125
bpp_loss 3.1230289547942407
14_gate proxy err 0.008127840235829353 tr(WHW.T) 2682.584716796875
bpp_loss 3.153920195823492
14_down proxy err 0.02097792737185955 tr(WHW.T) 90.28684997558594
bpp_loss 3.1066341400146484
I0318 08:48:52.819752 462594 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.3517231941223145s
I0318 08:48:56.581494 468148 config.py:54] PyTorch version 2.6.0 available.
W0318 08:48:56.897948 468148 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.028132446110248566 tr(WHW.T) 762.7275390625
bpp_loss 2.940454125404358
15_q proxy err 0.003452434903010726 tr(WHW.T) 7252.0009765625
bpp_loss 3.4683510065078735
15_k proxy err 0.00232995068654418 tr(WHW.T) 11072.3974609375
bpp_loss 3.522807240486145
15_o proxy err 0.03176270052790642 tr(WHW.T) 59.61664962768555
bpp_loss 2.927815318107605
15_up proxy err 0.014198807068169117 tr(WHW.T) 1641.0228271484375
bpp_loss 3.1296564146529797
15_gate proxy err 0.00820100586861372 tr(WHW.T) 2905.140380859375
bpp_loss 3.160437295603198
15_down proxy err 0.02099180407822132 tr(WHW.T) 114.09001922607422
bpp_loss 3.1108309501825375
W0318 08:48:57.826206 468148 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:48:57.830351 462594 quantize_finetune_llama.py:203] layer 18 gpu 2
I0318 08:48:57.844120 468148 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:48:59.255055 462594 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.9594831466674805s
I0318 08:49:02.982474 468286 config.py:54] PyTorch version 2.6.0 available.
W0318 08:49:03.270906 468286 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:49:04.276736 468286 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:49:04.280791 462594 quantize_finetune_llama.py:203] layer 19 gpu 3
I0318 08:49:04.296857 468286 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:49:05.890839 462594 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 1.0905396938323975s
I0318 08:49:09.837052 468417 config.py:54] PyTorch version 2.6.0 available.
W0318 08:49:10.189281 468417 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:49:11.284029 468417 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:49:11.288573 462594 quantize_finetune_llama.py:203] layer 20 gpu 0
I0318 08:49:11.306493 468417 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.028576087206602097 tr(WHW.T) 780.7407836914062
bpp_loss 2.981656551361084
16_q proxy err 0.0035559535026550293 tr(WHW.T) 7193.3974609375
bpp_loss 3.457277297973633
16_k proxy err 0.0023023737594485283 tr(WHW.T) 11630.361328125
bpp_loss 3.499382495880127
16_o proxy err 0.024918796494603157 tr(WHW.T) 88.22785186767578
bpp_loss 2.971401572227478
16_up proxy err 0.013892276212573051 tr(WHW.T) 1890.9385986328125
bpp_loss 3.1287561460982922
16_gate proxy err 0.007992848753929138 tr(WHW.T) 3369.859130859375
bpp_loss 3.169105884640716
16_down proxy err 0.02122877724468708 tr(WHW.T) 152.0294952392578
bpp_loss 3.1100058444710665
17_v proxy err 0.026898283511400223 tr(WHW.T) 845.7654418945312
bpp_loss 2.9783374071121216
17_q proxy err 0.0036351000890135765 tr(WHW.T) 7163.2734375
bpp_loss 3.4450477361679077
17_k proxy err 0.002515672240406275 tr(WHW.T) 10697.431640625
bpp_loss 3.480043053627014
17_o proxy err 0.027193348854780197 tr(WHW.T) 58.14826965332031
bpp_loss 2.971964716911316
17_up proxy err 0.015140197239816189 tr(WHW.T) 1921.07861328125
bpp_loss 3.1241581051848657
17_gate proxy err 0.008363405242562294 tr(WHW.T) 3571.31640625
bpp_loss 3.1806661916333576
17_down proxy err 0.021061044186353683 tr(WHW.T) 165.43495178222656
bpp_loss 3.1087170534355697
I0318 08:49:56.330754 462594 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.0657668113708496s
I0318 08:50:00.061749 468951 config.py:54] PyTorch version 2.6.0 available.
W0318 08:50:00.401480 468951 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.02481924556195736 tr(WHW.T) 1003.7705078125
bpp_loss 3.0263665914535522
18_q proxy err 0.003739131148904562 tr(WHW.T) 7510.48046875
bpp_loss 3.4106849431991577
18_k proxy err 0.002748932922258973 tr(WHW.T) 10462.6650390625
bpp_loss 3.4438410997390747
18_o proxy err 0.023959718644618988 tr(WHW.T) 69.96558380126953
bpp_loss 3.011445641517639
18_up proxy err 0.016109047457575798 tr(WHW.T) 2023.183837890625
bpp_loss 3.1206136304278704
18_gate proxy err 0.008855790831148624 tr(WHW.T) 3783.076416015625
bpp_loss 3.192076749579851
18_down proxy err 0.02113799937069416 tr(WHW.T) 198.52699279785156
bpp_loss 3.107482111731241
W0318 08:50:01.358820 468951 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:50:01.362819 462594 quantize_finetune_llama.py:203] layer 21 gpu 1
I0318 08:50:01.376369 468951 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:50:03.516159 462594 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 1.069692850112915s
I0318 08:50:07.326091 469088 config.py:54] PyTorch version 2.6.0 available.
19_v proxy err 0.02424062229692936 tr(WHW.T) 1019.1412353515625
bpp_loss 3.0356392860412598
19_q proxy err 0.003987783566117287 tr(WHW.T) 6944.4130859375
bpp_loss 3.391663074493408
19_k proxy err 0.0027141112368553877 tr(WHW.T) 10548.4892578125
bpp_loss 3.421121120452881
19_o proxy err 0.023613765835762024 tr(WHW.T) 62.291683197021484
bpp_loss 3.024672269821167
19_up proxy err 0.016188912093639374 tr(WHW.T) 2149.330322265625
bpp_loss 3.120651067689408
19_gate proxy err 0.009689067490398884 tr(WHW.T) 3687.5126953125
bpp_loss 3.196412729662518
19_down proxy err 0.02059655450284481 tr(WHW.T) 222.93177795410156
bpp_loss 3.1102925012278004
W0318 08:50:07.611625 469088 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:50:08.592455 469088 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:50:08.596595 462594 quantize_finetune_llama.py:203] layer 22 gpu 2
I0318 08:50:08.612963 469088 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:50:10.143923 462594 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 1.0770375728607178s
I0318 08:50:13.908641 469224 config.py:54] PyTorch version 2.6.0 available.
W0318 08:50:14.222184 469224 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:50:15.184492 469224 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:50:15.188891 462594 quantize_finetune_llama.py:203] layer 23 gpu 3
I0318 08:50:15.203743 469224 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:50:16.979263 462594 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.3302381038665771s
I0318 08:50:20.805860 469352 config.py:54] PyTorch version 2.6.0 available.
W0318 08:50:21.178170 469352 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:50:22.193781 469352 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:50:22.197800 462594 quantize_finetune_llama.py:203] layer 24 gpu 0
I0318 08:50:22.213705 469352 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.02511708065867424 tr(WHW.T) 990.5983276367188
bpp_loss 3.052699565887451
20_q proxy err 0.0038730038795620203 tr(WHW.T) 7150.947265625
bpp_loss 3.4014270305633545
20_k proxy err 0.0027512472588568926 tr(WHW.T) 10386.2470703125
bpp_loss 3.4295541048049927
20_o proxy err 0.017542218789458275 tr(WHW.T) 100.31707000732422
bpp_loss 3.0458076000213623
20_up proxy err 0.015870366245508194 tr(WHW.T) 2340.89453125
bpp_loss 3.1198570783748183
20_gate proxy err 0.00949013326317072 tr(WHW.T) 4024.62744140625
bpp_loss 3.2033476718636447
20_down proxy err 0.020457953214645386 tr(WHW.T) 274.8815002441406
bpp_loss 3.110088814136594
21_v proxy err 0.024099888280034065 tr(WHW.T) 1144.5655517578125
bpp_loss 3.087109327316284
21_q proxy err 0.004313970450311899 tr(WHW.T) 7064.314453125
bpp_loss 3.368164896965027
21_k proxy err 0.003112377831712365 tr(WHW.T) 9976.4658203125
bpp_loss 3.3844305276870728
21_o proxy err 0.01875454932451248 tr(WHW.T) 75.50972747802734
bpp_loss 3.070815324783325
21_up proxy err 0.016676336526870728 tr(WHW.T) 2361.650390625
bpp_loss 3.117821449457213
21_gate proxy err 0.010128236375749111 tr(WHW.T) 4004.37646484375
bpp_loss 3.211951499761537
21_down proxy err 0.02047318033874035 tr(WHW.T) 276.5857849121094
bpp_loss 3.109928286352823
I0318 08:51:07.493785 462594 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 1.0609073638916016s
I0318 08:51:11.319597 469901 config.py:54] PyTorch version 2.6.0 available.
W0318 08:51:11.667106 469901 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.02300504595041275 tr(WHW.T) 1243.2529296875
bpp_loss 3.091124415397644
22_q proxy err 0.004098466131836176 tr(WHW.T) 7746.84765625
bpp_loss 3.3989895582199097
22_k proxy err 0.0030374315101653337 tr(WHW.T) 10603.2041015625
bpp_loss 3.4183855056762695
22_o proxy err 0.015822213143110275 tr(WHW.T) 114.30065155029297
bpp_loss 3.0739063024520874
22_up proxy err 0.01679130643606186 tr(WHW.T) 2474.510498046875
bpp_loss 3.117181112599927
22_gate proxy err 0.010301493108272552 tr(WHW.T) 4156.64013671875
bpp_loss 3.2195010517918785
22_down proxy err 0.02040739171206951 tr(WHW.T) 311.8800048828125
bpp_loss 3.110419894373694
W0318 08:51:12.646191 469901 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:51:12.650467 462594 quantize_finetune_llama.py:203] layer 25 gpu 1
I0318 08:51:12.664589 469901 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:51:14.311071 462594 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 1.035402536392212s
I0318 08:51:18.136255 470021 config.py:54] PyTorch version 2.6.0 available.
W0318 08:51:18.442173 470021 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.021067960187792778 tr(WHW.T) 1486.037353515625
bpp_loss 3.1458072662353516
23_q proxy err 0.004637671634554863 tr(WHW.T) 7346.60986328125
bpp_loss 3.3882287740707397
23_k proxy err 0.0034659828525036573 tr(WHW.T) 9982.2392578125
bpp_loss 3.4003474712371826
23_o proxy err 0.019096989184617996 tr(WHW.T) 85.13458251953125
bpp_loss 3.1310408115386963
23_up proxy err 0.0173993818461895 tr(WHW.T) 2533.51025390625
bpp_loss 3.12298583984375
23_gate proxy err 0.011049614287912846 tr(WHW.T) 4097.51953125
bpp_loss 3.2187948892282887
23_down proxy err 0.020508240908384323 tr(WHW.T) 321.33892822265625
bpp_loss 3.117367677910383
W0318 08:51:19.395858 470021 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:51:19.399888 462594 quantize_finetune_llama.py:203] layer 26 gpu 2
I0318 08:51:19.413223 470021 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:51:20.920404 462594 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 1.0553019046783447s
I0318 08:51:24.569579 470153 config.py:54] PyTorch version 2.6.0 available.
W0318 08:51:24.893939 470153 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:51:25.863503 470153 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:51:25.867727 462594 quantize_finetune_llama.py:203] layer 27 gpu 3
I0318 08:51:25.884085 470153 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:51:27.408189 462594 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 1.0799298286437988s
I0318 08:51:31.236118 470278 config.py:54] PyTorch version 2.6.0 available.
W0318 08:51:31.569322 470278 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:51:32.657606 470278 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:51:32.661961 462594 quantize_finetune_llama.py:203] layer 28 gpu 0
I0318 08:51:32.676178 470278 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.02225390262901783 tr(WHW.T) 1394.900634765625
bpp_loss 3.134770393371582
24_q proxy err 0.004792576190084219 tr(WHW.T) 7020.447265625
bpp_loss 3.3469158411026
24_k proxy err 0.0033181977923959494 tr(WHW.T) 10323.43359375
bpp_loss 3.3551061153411865
24_o proxy err 0.015092295594513416 tr(WHW.T) 133.98797607421875
bpp_loss 3.1142759323120117
24_up proxy err 0.01763084903359413 tr(WHW.T) 2621.76513671875
bpp_loss 3.1267059681027436
24_gate proxy err 0.011141590774059296 tr(WHW.T) 4262.74853515625
bpp_loss 3.2221244989439497
24_down proxy err 0.02058207057416439 tr(WHW.T) 340.22412109375
bpp_loss 3.1217760928841525
25_v proxy err 0.020299067720770836 tr(WHW.T) 1707.664794921875
bpp_loss 3.1803653240203857
25_q proxy err 0.0051522632129490376 tr(WHW.T) 7162.16357421875
bpp_loss 3.3591405153274536
25_k proxy err 0.0039046797901391983 tr(WHW.T) 9611.58984375
bpp_loss 3.3645811080932617
25_o proxy err 0.018039105460047722 tr(WHW.T) 83.535888671875
bpp_loss 3.1627774238586426
25_up proxy err 0.01750948466360569 tr(WHW.T) 2805.728515625
bpp_loss 3.131880294444949
25_gate proxy err 0.010820591822266579 tr(WHW.T) 4666.4404296875
bpp_loss 3.2246728941451672
25_down proxy err 0.020408034324645996 tr(WHW.T) 373.460693359375
bpp_loss 3.127642187961312
I0318 08:52:18.140585 462594 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 1.0321681499481201s
I0318 08:52:22.003532 470845 config.py:54] PyTorch version 2.6.0 available.
W0318 08:52:22.336110 470845 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.02029833011329174 tr(WHW.T) 1668.8843994140625
bpp_loss 3.2007559537887573
26_q proxy err 0.00482282554730773 tr(WHW.T) 7469.98291015625
bpp_loss 3.3361400365829468
26_k proxy err 0.003533731447532773 tr(WHW.T) 10487.8740234375
bpp_loss 3.34784197807312
26_o proxy err 0.012444301508367062 tr(WHW.T) 202.88172912597656
bpp_loss 3.1925787925720215
26_up proxy err 0.01647019013762474 tr(WHW.T) 3154.75146484375
bpp_loss 3.136209709699764
26_gate proxy err 0.010078418999910355 tr(WHW.T) 5302.16455078125
bpp_loss 3.2287808795307957
26_down proxy err 0.02091558463871479 tr(WHW.T) 401.19390869140625
bpp_loss 3.1314567965130475
W0318 08:52:23.334663 470845 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:52:23.338920 462594 quantize_finetune_llama.py:203] layer 29 gpu 1
I0318 08:52:23.353612 470845 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:52:25.066129 462594 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 1.2639801502227783s
I0318 08:52:28.895694 470968 config.py:54] PyTorch version 2.6.0 available.
27_v proxy err 0.01854095607995987 tr(WHW.T) 1799.3350830078125
bpp_loss 3.2029415369033813
27_q proxy err 0.0046430910006165504 tr(WHW.T) 7691.708984375
bpp_loss 3.390006899833679
27_k proxy err 0.003413309110328555 tr(WHW.T) 10618.70703125
bpp_loss 3.405303716659546
27_o proxy err 0.016896255314350128 tr(WHW.T) 126.13690185546875
bpp_loss 3.200806736946106
27_up proxy err 0.015030593611299992 tr(WHW.T) 3691.557861328125
bpp_loss 3.142480362293332
27_gate proxy err 0.00951156672090292 tr(WHW.T) 5990.82568359375
bpp_loss 3.2302824508312136
27_down proxy err 0.021264415234327316 tr(WHW.T) 466.9318542480469
bpp_loss 3.1377076215522233
W0318 08:52:29.180493 470968 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:52:30.159450 470968 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:52:30.163729 462594 quantize_finetune_llama.py:203] layer 30 gpu 2
I0318 08:52:30.177032 470968 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:52:31.689594 462594 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 1.0645625591278076s
I0318 08:52:35.464308 471095 config.py:54] PyTorch version 2.6.0 available.
W0318 08:52:35.791717 471095 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:52:36.772409 471095 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:52:36.776687 462594 quantize_finetune_llama.py:203] layer 31 gpu 3
I0318 08:52:36.793442 471095 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 08:52:38.358738 462594 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.1111595630645752s
I0318 08:52:42.288550 471228 config.py:54] PyTorch version 2.6.0 available.
W0318 08:52:42.617172 471228 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 08:52:43.693475 471228 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 08:52:43.712482 471228 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.017259009182453156 tr(WHW.T) 2018.944091796875
bpp_loss 3.243801712989807
28_q proxy err 0.004822137765586376 tr(WHW.T) 7651.126953125
bpp_loss 3.348049759864807
28_k proxy err 0.003549594432115555 tr(WHW.T) 10544.8251953125
bpp_loss 3.365726947784424
28_o proxy err 0.013981710188090801 tr(WHW.T) 194.8240966796875
bpp_loss 3.2383992671966553
28_up proxy err 0.012598949484527111 tr(WHW.T) 4661.2666015625
bpp_loss 3.154552548430687
28_gate proxy err 0.009167465381324291 tr(WHW.T) 6547.48193359375
bpp_loss 3.2244720458984375
28_down proxy err 0.021237900480628014 tr(WHW.T) 603.8403930664062
bpp_loss 3.1451159632483194
29_v proxy err 0.01825738325715065 tr(WHW.T) 1801.7730712890625
bpp_loss 3.249072313308716
29_q proxy err 0.004780921619385481 tr(WHW.T) 7227.0009765625
bpp_loss 3.3104230165481567
29_k proxy err 0.003354893298819661 tr(WHW.T) 10558.609375
bpp_loss 3.323217034339905
29_o proxy err 0.01176480669528246 tr(WHW.T) 207.9054412841797
bpp_loss 3.254406213760376
29_up proxy err 0.010110246017575264 tr(WHW.T) 6070.0498046875
bpp_loss 3.166308735692224
29_gate proxy err 0.008452512323856354 tr(WHW.T) 7369.6142578125
bpp_loss 3.227923548498819
29_down proxy err 0.02147398144006729 tr(WHW.T) 782.2448120117188
bpp_loss 3.149427990580714
30_v proxy err 0.015075340867042542 tr(WHW.T) 2261.489501953125
bpp_loss 3.2805988788604736
30_q proxy err 0.004558718763291836 tr(WHW.T) 7815.9453125
bpp_loss 3.319879651069641
30_k proxy err 0.0034716224763542414 tr(WHW.T) 10521.625
bpp_loss 3.3398218154907227
30_o proxy err 0.012333317659795284 tr(WHW.T) 251.96908569335938
bpp_loss 3.287628650665283
30_up proxy err 0.006294706370681524 tr(WHW.T) 10016.376953125
bpp_loss 3.1878814697265625
30_gate proxy err 0.005817866418510675 tr(WHW.T) 11001.119140625
bpp_loss 3.2585200819858287
30_down proxy err 0.012435298413038254 tr(WHW.T) 3582.617919921875
bpp_loss 3.1422104281048444
31_v proxy err 0.01795382983982563 tr(WHW.T) 1268.2034912109375
bpp_loss 3.159315586090088
31_q proxy err 0.0036269433330744505 tr(WHW.T) 6858.09130859375
bpp_loss 3.3378111124038696
31_k proxy err 0.00251264707185328 tr(WHW.T) 10233.677734375
bpp_loss 3.3907893896102905
31_o proxy err 0.009488202631473541 tr(WHW.T) 457.7950744628906
bpp_loss 3.172072172164917
31_up proxy err 0.003693500068038702 tr(WHW.T) 14563.890625
bpp_loss 3.2386696394099745
31_gate proxy err 0.00366202206350863 tr(WHW.T) 14836.2939453125
bpp_loss 3.31816775299782
31_down proxy err 0.008805415593087673 tr(WHW.T) 17873.55859375
bpp_loss 3.1407659663710485
