I0318 06:11:35.215670 359624 config.py:54] PyTorch version 2.6.0 available.
W0318 06:11:35.496921 359624 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:11:36.392577 359624 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  6.73it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.48it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  7.74it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  7.89it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  7.99it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.16it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.91it/s]
I0318 06:11:37.364529 359624 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:14,  2.14it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:14,  2.14it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.14it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:12,  2.16it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:12,  2.16it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:12,  2.16it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:11,  2.22it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:10,  2.27it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:09,  2.33it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:09,  2.35it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.36it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:08,  2.38it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.38it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:06<00:07,  2.39it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:07,  2.39it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.39it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:06,  2.40it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.40it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:08<00:05,  2.40it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:08<00:04,  2.40it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:09<00:04,  2.41it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:09<00:04,  2.41it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.46it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:10<00:03,  2.49it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:10<00:02,  2.53it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.56it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:11<00:01,  2.54it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.51it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:12<00:01,  2.56it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:12<00:00,  2.59it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.52it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.41it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:13<00:00,  2.39it/s]
I0318 06:11:58.356756 359624 quantize_finetune_llama.py:179] loaded compression model
I0318 06:12:12.838613 359624 quantize_finetune_llama.py:183] loaded dataset and devset
I0318 06:12:22.070989 359624 quantize_finetune_llama.py:203] layer 0 gpu 0
I0318 06:12:24.731278 359624 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 2.5040454864501953s
tensor(0.0192) tensor(-3.6338e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0318 06:12:42.893534 360484 config.py:54] PyTorch version 2.6.0 available.
W0318 06:12:43.188391 360484 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:12:44.085009 360484 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:12:44.088832 359624 quantize_finetune_llama.py:203] layer 1 gpu 1
I0318 06:12:44.101689 360484 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:12:47.315218 359624 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 3.0607426166534424s
I0318 06:12:50.822833 360623 config.py:54] PyTorch version 2.6.0 available.
W0318 06:12:51.106069 360623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:12:52.068883 360623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:12:52.072995 359624 quantize_finetune_llama.py:203] layer 2 gpu 2
I0318 06:12:52.087061 360623 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:12:55.705859 359624 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 3.463379383087158s
I0318 06:12:59.433525 360773 config.py:54] PyTorch version 2.6.0 available.
W0318 06:12:59.788821 360773 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:13:00.799788 360773 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:13:00.804013 359624 quantize_finetune_llama.py:203] layer 3 gpu 3
I0318 06:13:00.818207 360773 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:13:04.293392 359624 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 3.3107638359069824s
I0318 06:13:08.104970 360925 config.py:54] PyTorch version 2.6.0 available.
W0318 06:13:08.478933 360925 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:13:09.608932 360925 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:13:09.613397 359624 quantize_finetune_llama.py:203] layer 4 gpu 0
I0318 06:13:09.628334 360925 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.016251705586910248 tr(WHW.T) 4.225186347961426
bpp_loss 2.632268190383911
0_q proxy err 7.879843178670853e-05 tr(WHW.T) 2710.363037109375
bpp_loss 2.714510917663574
0_k proxy err 9.443247108720243e-05 tr(WHW.T) 1698.7349853515625
bpp_loss 2.8346508741378784
0_o proxy err 0.001817027572542429 tr(WHW.T) 0.9668058156967163
bpp_loss 2.502196192741394
0_up proxy err 0.009239883162081242 tr(WHW.T) 43.27138900756836
bpp_loss 2.9595603942871094
0_gate proxy err 0.006343553774058819 tr(WHW.T) 63.47430419921875
bpp_loss 2.9766635451205943
0_down proxy err 0.005306665785610676 tr(WHW.T) 0.656814694404602
bpp_loss 3.003743193870367
1_v proxy err 0.03461700677871704 tr(WHW.T) 16.465883255004883
bpp_loss 2.586412191390991
1_q proxy err 0.00019017825252376497 tr(WHW.T) 4778.43994140625
bpp_loss 3.3846887350082397
1_k proxy err 0.00018592312699183822 tr(WHW.T) 4995.39208984375
bpp_loss 3.3983668088912964
1_o proxy err 0.014431022107601166 tr(WHW.T) 1.1115814447402954
bpp_loss 2.544527769088745
1_up proxy err 0.012887503951787949 tr(WHW.T) 109.66383361816406
bpp_loss 3.020684530568677
1_gate proxy err 0.006549268029630184 tr(WHW.T) 221.3038787841797
bpp_loss 3.088241754576217
1_down proxy err 0.0007420615875162184 tr(WHW.T) 2041.4736328125
bpp_loss 3.0429073156312456
I0318 06:13:38.093272 359624 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.9644136428833008s
I0318 06:13:42.040045 361351 config.py:54] PyTorch version 2.6.0 available.
W0318 06:13:42.374121 361351 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:13:43.361780 361351 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:13:43.366222 359624 quantize_finetune_llama.py:203] layer 5 gpu 1
I0318 06:13:43.380545 361351 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.01652946136891842 tr(WHW.T) 136.67332458496094
bpp_loss 2.8371808528900146
2_q proxy err 0.00035894158645533025 tr(WHW.T) 7752.85205078125
bpp_loss 3.538191318511963
2_k proxy err 0.0002800363872665912 tr(WHW.T) 10205.837890625
bpp_loss 3.5940909385681152
2_o proxy err 0.0181411262601614 tr(WHW.T) 1.4603197574615479
bpp_loss 2.8250545263290405
2_up proxy err 0.015828397125005722 tr(WHW.T) 193.43603515625
bpp_loss 3.0455492596293605
2_gate proxy err 0.01022788044065237 tr(WHW.T) 306.6622619628906
bpp_loss 3.1313515596611556
2_down proxy err 0.01648038439452648 tr(WHW.T) 3.010739803314209
bpp_loss 3.057498488315316
I0318 06:13:46.862805 359624 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 1.0551657676696777s
I0318 06:13:50.668571 361504 config.py:54] PyTorch version 2.6.0 available.
W0318 06:13:51.014031 361504 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:13:52.024549 361504 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:13:52.028821 359624 quantize_finetune_llama.py:203] layer 6 gpu 2
I0318 06:13:52.045216 361504 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.021856877952814102 tr(WHW.T) 284.77557373046875
bpp_loss 2.7944416999816895
3_q proxy err 0.0010178021620959044 tr(WHW.T) 7217.63720703125
bpp_loss 3.4762017726898193
3_k proxy err 0.0007394928834401071 tr(WHW.T) 10074.73828125
bpp_loss 3.530535340309143
3_o proxy err 0.015301339328289032 tr(WHW.T) 3.3527450561523438
bpp_loss 2.7825194597244263
3_up proxy err 0.017758894711732864 tr(WHW.T) 284.7950744628906
bpp_loss 3.052783877350563
3_gate proxy err 0.010824998840689659 tr(WHW.T) 478.13714599609375
bpp_loss 3.1485024385674056
3_down proxy err 0.01677726022899151 tr(WHW.T) 6.133229732513428
bpp_loss 3.057055872540141
I0318 06:13:55.360622 359624 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 1.1080679893493652s
I0318 06:13:59.144398 361642 config.py:54] PyTorch version 2.6.0 available.
W0318 06:13:59.497328 361642 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:14:00.528301 361642 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:14:00.533157 359624 quantize_finetune_llama.py:203] layer 7 gpu 3
I0318 06:14:00.548186 361642 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:14:02.108916 359624 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 1.0835511684417725s
I0318 06:14:05.935297 361775 config.py:54] PyTorch version 2.6.0 available.
W0318 06:14:06.292500 361775 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:14:07.306887 361775 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:14:07.311448 359624 quantize_finetune_llama.py:203] layer 8 gpu 0
I0318 06:14:07.326162 361775 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.02019207924604416 tr(WHW.T) 274.6131286621094
bpp_loss 2.840608835220337
4_q proxy err 0.0009456604602746665 tr(WHW.T) 6914.9892578125
bpp_loss 3.5606517791748047
4_k proxy err 0.000637160730548203 tr(WHW.T) 10415.33203125
bpp_loss 3.5891143083572388
4_o proxy err 0.018172800540924072 tr(WHW.T) 5.139806270599365
bpp_loss 2.838346838951111
4_up proxy err 0.016955778002738953 tr(WHW.T) 397.6960144042969
bpp_loss 3.0435439708621
4_gate proxy err 0.00846803467720747 tr(WHW.T) 821.1856689453125
bpp_loss 3.1715774536132812
4_down proxy err 0.016774456948041916 tr(WHW.T) 11.562739372253418
bpp_loss 3.0429679293965184
5_v proxy err 0.020822059363126755 tr(WHW.T) 298.47540283203125
bpp_loss 2.860532283782959
5_q proxy err 0.0010795426787808537 tr(WHW.T) 6770.97509765625
bpp_loss 3.5807570219039917
5_k proxy err 0.0006912989774718881 tr(WHW.T) 10841.955078125
bpp_loss 3.6375317573547363
5_o proxy err 0.020331986248493195 tr(WHW.T) 7.947142601013184
bpp_loss 2.846646308898926
5_up proxy err 0.016749447211623192 tr(WHW.T) 506.6408386230469
bpp_loss 3.044552115506904
5_gate proxy err 0.007937140762805939 tr(WHW.T) 1104.867919921875
bpp_loss 3.1787985868232194
5_down proxy err 0.018293436616659164 tr(WHW.T) 15.6494779586792
bpp_loss 3.0445061838904093
I0318 06:14:38.165747 359624 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 1.1207048892974854s
I0318 06:14:42.009737 362242 config.py:54] PyTorch version 2.6.0 available.
W0318 06:14:42.325948 362242 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:14:43.333911 362242 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:14:43.338412 359624 quantize_finetune_llama.py:203] layer 9 gpu 1
I0318 06:14:43.354434 362242 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.022434176877141 tr(WHW.T) 443.5464782714844
bpp_loss 2.797192096710205
6_q proxy err 0.0015233400044962764 tr(WHW.T) 7576.53857421875
bpp_loss 3.460818886756897
6_k proxy err 0.0011232815450057387 tr(WHW.T) 10409.4033203125
bpp_loss 3.487837553024292
6_o proxy err 0.022703152149915695 tr(WHW.T) 11.564380645751953
bpp_loss 2.801544666290283
6_up proxy err 0.016685161739587784 tr(WHW.T) 617.2608642578125
bpp_loss 3.0406157027843386
6_gate proxy err 0.006887433584779501 tr(WHW.T) 1554.7271728515625
bpp_loss 3.1997002889943675
6_down proxy err 0.018674809485673904 tr(WHW.T) 22.988168716430664
bpp_loss 3.039534879285236
I0318 06:14:46.953973 359624 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 1.1137995719909668s
I0318 06:14:50.761246 362386 config.py:54] PyTorch version 2.6.0 available.
7_v proxy err 0.022254599258303642 tr(WHW.T) 489.9357604980469
bpp_loss 2.8058502674102783
7_q proxy err 0.0016465637600049376 tr(WHW.T) 7672.17919921875
bpp_loss 3.4539135694503784
7_k proxy err 0.001249882741831243 tr(WHW.T) 10198.3701171875
bpp_loss 3.4647607803344727
7_o proxy err 0.025502962991595268 tr(WHW.T) 15.11335563659668
bpp_loss 2.8074305057525635
7_up proxy err 0.016141293570399284 tr(WHW.T) 735.8538818359375
bpp_loss 3.044094351835029
7_gate proxy err 0.006580826360732317 tr(WHW.T) 1876.0390625
bpp_loss 3.1978779282680776
7_down proxy err 0.01887189783155918 tr(WHW.T) 30.58672523498535
bpp_loss 3.0414014860641125
W0318 06:14:51.084525 362386 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:14:52.037457 362386 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:14:52.041456 359624 quantize_finetune_llama.py:203] layer 10 gpu 2
I0318 06:14:52.054854 362386 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:14:53.437352 359624 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 0.9414982795715332s
I0318 06:14:57.273702 362514 config.py:54] PyTorch version 2.6.0 available.
W0318 06:14:57.628150 362514 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:14:58.645665 362514 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:14:58.650102 359624 quantize_finetune_llama.py:203] layer 11 gpu 3
I0318 06:14:58.667343 362514 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:15:00.575409 359624 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.4478516578674316s
I0318 06:15:04.563400 362644 config.py:54] PyTorch version 2.6.0 available.
W0318 06:15:04.921370 362644 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:15:05.871416 362644 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:15:05.875401 359624 quantize_finetune_llama.py:203] layer 12 gpu 0
I0318 06:15:05.888590 362644 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.02019726298749447 tr(WHW.T) 530.9967041015625
bpp_loss 2.83062744140625
8_q proxy err 0.0017041059909388423 tr(WHW.T) 7228.1201171875
bpp_loss 3.4710850715637207
8_k proxy err 0.001174276345409453 tr(WHW.T) 10639.1015625
bpp_loss 3.488435387611389
8_o proxy err 0.028914770111441612 tr(WHW.T) 20.092191696166992
bpp_loss 2.83301043510437
8_up proxy err 0.01472695916891098 tr(WHW.T) 866.312744140625
bpp_loss 3.058095000510992
8_gate proxy err 0.006663593463599682 tr(WHW.T) 1970.857177734375
bpp_loss 3.1773537924123363
8_down proxy err 0.018858741968870163 tr(WHW.T) 37.177734375
bpp_loss 3.0521383950876637
9_v proxy err 0.020051410421729088 tr(WHW.T) 565.0663452148438
bpp_loss 2.847335934638977
9_q proxy err 0.0018723795656114817 tr(WHW.T) 6970.3359375
bpp_loss 3.496528387069702
9_k proxy err 0.0012002222938463092 tr(WHW.T) 10987.3515625
bpp_loss 3.532591462135315
9_o proxy err 0.029947932809591293 tr(WHW.T) 25.610172271728516
bpp_loss 2.8501778841018677
9_up proxy err 0.0141640305519104 tr(WHW.T) 970.8984375
bpp_loss 3.0653436350267986
9_gate proxy err 0.006614151876419783 tr(WHW.T) 2132.69384765625
bpp_loss 3.163916831792787
9_down proxy err 0.01909160427749157 tr(WHW.T) 42.99482727050781
bpp_loss 3.059511140335438
I0318 06:15:38.496073 359624 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 1.1122634410858154s
I0318 06:15:42.293586 363130 config.py:54] PyTorch version 2.6.0 available.
10_v proxy err 0.020078303292393684 tr(WHW.T) 578.807373046875
bpp_loss 2.8408151865005493
10_q proxy err 0.0019281618297100067 tr(WHW.T) 6915.87109375
bpp_loss 3.4860914945602417
10_k proxy err 0.0012285427656024694 tr(WHW.T) 10996.2431640625
bpp_loss 3.526460886001587
10_o proxy err 0.03131498023867607 tr(WHW.T) 35.184165954589844
bpp_loss 2.8486210107803345
10_up proxy err 0.013357631862163544 tr(WHW.T) 1080.198486328125
bpp_loss 3.0776276699332303
10_gate proxy err 0.0065235598012804985 tr(WHW.T) 2260.88330078125
bpp_loss 3.1565292713254
10_down proxy err 0.01808406040072441 tr(WHW.T) 52.33584976196289
bpp_loss 3.067873111990995
W0318 06:15:42.618102 363130 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:15:43.602175 363130 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:15:43.606387 359624 quantize_finetune_llama.py:203] layer 13 gpu 1
I0318 06:15:43.620435 363130 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:15:45.062554 359624 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 1.0084095001220703s
I0318 06:15:48.932903 363250 config.py:54] PyTorch version 2.6.0 available.
W0318 06:15:49.271975 363250 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.01993338204920292 tr(WHW.T) 723.1956176757812
bpp_loss 2.8736276626586914
11_q proxy err 0.002288523595780134 tr(WHW.T) 7027.10986328125
bpp_loss 3.3807003498077393
11_k proxy err 0.0015448201447725296 tr(WHW.T) 10511.23046875
bpp_loss 3.386110305786133
11_o proxy err 0.031101621687412262 tr(WHW.T) 36.654052734375
bpp_loss 2.879907488822937
11_up proxy err 0.013730445876717567 tr(WHW.T) 1139.6044921875
bpp_loss 3.0876784213753634
11_gate proxy err 0.006664453539997339 tr(WHW.T) 2392.716552734375
bpp_loss 3.154289955316588
11_down proxy err 0.018753880634903908 tr(WHW.T) 56.13530731201172
bpp_loss 3.076307496359182
W0318 06:15:50.241178 363250 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:15:50.245158 359624 quantize_finetune_llama.py:203] layer 14 gpu 2
I0318 06:15:50.258206 363250 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:15:51.700824 359624 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 1.0161912441253662s
I0318 06:15:55.468790 363380 config.py:54] PyTorch version 2.6.0 available.
W0318 06:15:55.788205 363380 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:15:56.758142 363380 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:15:56.762110 359624 quantize_finetune_llama.py:203] layer 15 gpu 3
I0318 06:15:56.778167 363380 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:15:58.335148 359624 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 1.1286048889160156s
I0318 06:16:02.394273 363507 config.py:54] PyTorch version 2.6.0 available.
W0318 06:16:02.751667 363507 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:16:03.883159 363507 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:16:03.887567 359624 quantize_finetune_llama.py:203] layer 16 gpu 0
I0318 06:16:03.909113 363507 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.020560195669531822 tr(WHW.T) 703.318603515625
bpp_loss 2.8637324571609497
12_q proxy err 0.0023188693448901176 tr(WHW.T) 7045.6435546875
bpp_loss 3.43919837474823
12_k proxy err 0.0015209518605843186 tr(WHW.T) 10893.65625
bpp_loss 3.4835439920425415
12_o proxy err 0.032475296407938004 tr(WHW.T) 39.29071044921875
bpp_loss 2.8721638917922974
12_up proxy err 0.013668353669345379 tr(WHW.T) 1228.298583984375
bpp_loss 3.098998136298601
12_gate proxy err 0.007151656784117222 tr(WHW.T) 2381.994873046875
bpp_loss 3.14805390114008
12_down proxy err 0.018634933978319168 tr(WHW.T) 64.17745208740234
bpp_loss 3.086076115452966
13_v proxy err 0.021154705435037613 tr(WHW.T) 714.5677490234375
bpp_loss 2.8968347311019897
13_q proxy err 0.0024354984052479267 tr(WHW.T) 6956.03564453125
bpp_loss 3.4292136430740356
13_k proxy err 0.0016439055325463414 tr(WHW.T) 10426.6318359375
bpp_loss 3.4556411504745483
13_o proxy err 0.028886036947369576 tr(WHW.T) 45.8377571105957
bpp_loss 2.9003353118896484
13_up proxy err 0.013144911266863346 tr(WHW.T) 1367.6221923828125
bpp_loss 3.11061291361964
13_gate proxy err 0.006995490752160549 tr(WHW.T) 2601.504638671875
bpp_loss 3.1434618927711666
13_down proxy err 0.018325749784708023 tr(WHW.T) 79.3589096069336
bpp_loss 3.0943160389744957
I0318 06:16:36.637515 359624 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 1.1148879528045654s
I0318 06:16:40.393095 363973 config.py:54] PyTorch version 2.6.0 available.
W0318 06:16:40.731731 363973 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.022406913340091705 tr(WHW.T) 706.1612548828125
bpp_loss 2.8804057836532593
14_q proxy err 0.002516302512958646 tr(WHW.T) 7077.06103515625
bpp_loss 3.4211902618408203
14_k proxy err 0.0015937481075525284 tr(WHW.T) 11295.16796875
bpp_loss 3.451981544494629
14_o proxy err 0.03286723047494888 tr(WHW.T) 50.921180725097656
bpp_loss 2.8868926763534546
14_up proxy err 0.013440401293337345 tr(WHW.T) 1464.7159423828125
bpp_loss 3.1126302674759265
14_gate proxy err 0.007417838554829359 tr(WHW.T) 2682.584716796875
bpp_loss 3.1411040550054508
14_down proxy err 0.018623335286974907 tr(WHW.T) 90.28684997558594
bpp_loss 3.09657930773358
W0318 06:16:41.753433 363973 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:16:41.757615 359624 quantize_finetune_llama.py:203] layer 17 gpu 1
I0318 06:16:41.771556 363973 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:16:43.598906 359624 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.3566994667053223s
I0318 06:16:47.481604 364099 config.py:54] PyTorch version 2.6.0 available.
15_v proxy err 0.020110653713345528 tr(WHW.T) 762.7275390625
bpp_loss 2.917027711868286
15_q proxy err 0.0023570205084979534 tr(WHW.T) 7252.0009765625
bpp_loss 3.413183093070984
15_k proxy err 0.00157158134970814 tr(WHW.T) 11072.3974609375
bpp_loss 3.4626739025115967
15_o proxy err 0.02725483477115631 tr(WHW.T) 59.61664962768555
bpp_loss 2.913199782371521
15_up proxy err 0.013055800460278988 tr(WHW.T) 1641.0228271484375
bpp_loss 3.1189474061478015
15_gate proxy err 0.007452595513314009 tr(WHW.T) 2905.140380859375
bpp_loss 3.1466124778570133
15_down proxy err 0.018404146656394005 tr(WHW.T) 114.09001922607422
bpp_loss 3.0986683424129042
W0318 06:16:47.810809 364099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:16:48.718808 364099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:16:48.722600 359624 quantize_finetune_llama.py:203] layer 18 gpu 2
I0318 06:16:48.735898 364099 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:16:50.202765 359624 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 1.031188726425171s
I0318 06:16:53.977339 364245 config.py:54] PyTorch version 2.6.0 available.
W0318 06:16:54.307324 364245 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:16:55.277549 364245 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:16:55.281802 359624 quantize_finetune_llama.py:203] layer 19 gpu 3
I0318 06:16:55.296459 364245 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:16:56.906037 359624 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 1.1387248039245605s
I0318 06:17:00.925087 364372 config.py:54] PyTorch version 2.6.0 available.
W0318 06:17:01.287949 364372 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:17:02.266360 364372 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:17:02.270456 359624 quantize_finetune_llama.py:203] layer 20 gpu 0
I0318 06:17:02.286258 364372 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.021120158955454826 tr(WHW.T) 780.7407836914062
bpp_loss 2.957545757293701
16_q proxy err 0.0025246196892112494 tr(WHW.T) 7193.3974609375
bpp_loss 3.394911050796509
16_k proxy err 0.001583638833835721 tr(WHW.T) 11630.361328125
bpp_loss 3.435973882675171
16_o proxy err 0.022338539361953735 tr(WHW.T) 88.22785186767578
bpp_loss 2.961942672729492
16_up proxy err 0.013055314309895039 tr(WHW.T) 1890.9385986328125
bpp_loss 3.1186566020167152
16_gate proxy err 0.007434333208948374 tr(WHW.T) 3369.859130859375
bpp_loss 3.1556295350540515
16_down proxy err 0.01857321709394455 tr(WHW.T) 152.0294952392578
bpp_loss 3.0994615776594294
17_v proxy err 0.02089426852762699 tr(WHW.T) 845.7654418945312
bpp_loss 2.9566574096679688
17_q proxy err 0.002725052647292614 tr(WHW.T) 7163.2734375
bpp_loss 3.395115852355957
17_k proxy err 0.0018438566476106644 tr(WHW.T) 10697.431640625
bpp_loss 3.427603840827942
17_o proxy err 0.02422703430056572 tr(WHW.T) 58.14826965332031
bpp_loss 2.959600806236267
17_up proxy err 0.014508512802422047 tr(WHW.T) 1921.07861328125
bpp_loss 3.115730640500091
17_gate proxy err 0.007935062982141972 tr(WHW.T) 3571.31640625
bpp_loss 3.1695553092069404
17_down proxy err 0.018841944634914398 tr(WHW.T) 165.43495178222656
bpp_loss 3.1002960648647573
I0318 06:17:35.044379 359624 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.0921087265014648s
I0318 06:17:38.805870 364835 config.py:54] PyTorch version 2.6.0 available.
W0318 06:17:39.133917 364835 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.019894305616617203 tr(WHW.T) 1003.7705078125
bpp_loss 3.0041873455047607
18_q proxy err 0.002907288260757923 tr(WHW.T) 7510.48046875
bpp_loss 3.3694483041763306
18_k proxy err 0.0021011033095419407 tr(WHW.T) 10462.6650390625
bpp_loss 3.3986222743988037
18_o proxy err 0.020718984305858612 tr(WHW.T) 69.96558380126953
bpp_loss 2.9988536834716797
18_up proxy err 0.015506109222769737 tr(WHW.T) 2023.183837890625
bpp_loss 3.11235702869504
18_gate proxy err 0.00846266932785511 tr(WHW.T) 3783.076416015625
bpp_loss 3.180566299793332
18_down proxy err 0.018410664051771164 tr(WHW.T) 198.52699279785156
bpp_loss 3.099279581114303
W0318 06:17:40.096762 364835 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:17:40.100964 359624 quantize_finetune_llama.py:203] layer 21 gpu 1
I0318 06:17:40.117080 364835 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:17:41.589983 359624 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 1.0190603733062744s
I0318 06:17:45.439041 364956 config.py:54] PyTorch version 2.6.0 available.
W0318 06:17:45.767045 364956 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.019592277705669403 tr(WHW.T) 1019.1412353515625
bpp_loss 3.0140600204467773
19_q proxy err 0.0031070238910615444 tr(WHW.T) 6944.4130859375
bpp_loss 3.3479433059692383
19_k proxy err 0.0020671242382377386 tr(WHW.T) 10548.4892578125
bpp_loss 3.375374674797058
19_o proxy err 0.021015865728259087 tr(WHW.T) 62.291683197021484
bpp_loss 3.008224844932556
19_up proxy err 0.015640100464224815 tr(WHW.T) 2149.330322265625
bpp_loss 3.112439887468205
19_gate proxy err 0.009302833117544651 tr(WHW.T) 3687.5126953125
bpp_loss 3.185758901196857
19_down proxy err 0.017971334978938103 tr(WHW.T) 222.93177795410156
bpp_loss 3.1030160770859827
W0318 06:17:46.715206 364956 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:17:46.718882 359624 quantize_finetune_llama.py:203] layer 22 gpu 2
I0318 06:17:46.731803 364956 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:17:48.322956 359624 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 1.0170893669128418s
I0318 06:17:52.062409 365074 config.py:54] PyTorch version 2.6.0 available.
W0318 06:17:52.382607 365074 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:17:53.320031 365074 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:17:53.324108 359624 quantize_finetune_llama.py:203] layer 23 gpu 3
I0318 06:17:53.338899 365074 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:17:55.134682 359624 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.3999850749969482s
I0318 06:17:59.133516 365215 config.py:54] PyTorch version 2.6.0 available.
W0318 06:17:59.487273 365215 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:18:00.570531 365215 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:18:00.574593 359624 quantize_finetune_llama.py:203] layer 24 gpu 0
I0318 06:18:00.587904 365215 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.02056335285305977 tr(WHW.T) 990.5983276367188
bpp_loss 3.0314862728118896
20_q proxy err 0.0030669094994664192 tr(WHW.T) 7150.947265625
bpp_loss 3.3547662496566772
20_k proxy err 0.0021329550072550774 tr(WHW.T) 10386.2470703125
bpp_loss 3.38097608089447
20_o proxy err 0.015169601887464523 tr(WHW.T) 100.31707000732422
bpp_loss 3.032391905784607
20_up proxy err 0.015418576076626778 tr(WHW.T) 2340.89453125
bpp_loss 3.1132163114325944
20_gate proxy err 0.009168123826384544 tr(WHW.T) 4024.62744140625
bpp_loss 3.19472823032113
20_down proxy err 0.017536833882331848 tr(WHW.T) 274.8815002441406
bpp_loss 3.104132097820903
21_v proxy err 0.020192913711071014 tr(WHW.T) 1144.5655517578125
bpp_loss 3.066287875175476
21_q proxy err 0.0034635099582374096 tr(WHW.T) 7064.314453125
bpp_loss 3.3221603631973267
21_k proxy err 0.0024713962338864803 tr(WHW.T) 9976.4658203125
bpp_loss 3.3373547792434692
21_o proxy err 0.017015019431710243 tr(WHW.T) 75.50972747802734
bpp_loss 3.0619075298309326
21_up proxy err 0.016275182366371155 tr(WHW.T) 2361.650390625
bpp_loss 3.111519214718841
21_gate proxy err 0.009825250133872032 tr(WHW.T) 4004.37646484375
bpp_loss 3.2036975594454034
21_down proxy err 0.017951205372810364 tr(WHW.T) 276.5857849121094
bpp_loss 3.104887829270474
I0318 06:18:33.133816 359624 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 1.152468204498291s
I0318 06:18:36.926790 365677 config.py:54] PyTorch version 2.6.0 available.
W0318 06:18:37.269964 365677 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.019072534516453743 tr(WHW.T) 1243.2529296875
bpp_loss 3.0701485872268677
22_q proxy err 0.003270109184086323 tr(WHW.T) 7746.84765625
bpp_loss 3.3583961725234985
22_k proxy err 0.002405379666015506 tr(WHW.T) 10603.2041015625
bpp_loss 3.376505970954895
22_o proxy err 0.013825926929712296 tr(WHW.T) 114.30065155029297
bpp_loss 3.056985855102539
22_up proxy err 0.01641557365655899 tr(WHW.T) 2474.510498046875
bpp_loss 3.111505020496457
22_gate proxy err 0.010024762712419033 tr(WHW.T) 4156.64013671875
bpp_loss 3.2120034861010174
22_down proxy err 0.017996896058321 tr(WHW.T) 311.8800048828125
bpp_loss 3.1056798668794854
W0318 06:18:38.211537 365677 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:18:38.215600 359624 quantize_finetune_llama.py:203] layer 25 gpu 1
I0318 06:18:38.229245 365677 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:18:39.800249 359624 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 1.0233745574951172s
I0318 06:18:43.574184 365793 config.py:54] PyTorch version 2.6.0 available.
W0318 06:18:43.907443 365793 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.01810583472251892 tr(WHW.T) 1486.037353515625
bpp_loss 3.1250609159469604
23_q proxy err 0.0038502300158143044 tr(WHW.T) 7346.60986328125
bpp_loss 3.354325771331787
23_k proxy err 0.0028505115769803524 tr(WHW.T) 9982.2392578125
bpp_loss 3.3653252124786377
23_o proxy err 0.016781868413090706 tr(WHW.T) 85.13458251953125
bpp_loss 3.110555410385132
23_up proxy err 0.017006870359182358 tr(WHW.T) 2533.51025390625
bpp_loss 3.1174445928529253
23_gate proxy err 0.01077946275472641 tr(WHW.T) 4097.51953125
bpp_loss 3.2127430050872094
23_down proxy err 0.018016761168837547 tr(WHW.T) 321.33892822265625
bpp_loss 3.112642199494118
W0318 06:18:44.867668 365793 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:18:44.871759 359624 quantize_finetune_llama.py:203] layer 26 gpu 2
I0318 06:18:44.885668 365793 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:18:46.419571 359624 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 1.0305283069610596s
I0318 06:18:50.171642 365920 config.py:54] PyTorch version 2.6.0 available.
W0318 06:18:50.506676 365920 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:18:51.462682 365920 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:18:51.466652 359624 quantize_finetune_llama.py:203] layer 27 gpu 3
I0318 06:18:51.480024 365920 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:18:53.002044 359624 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 1.1046748161315918s
I0318 06:18:57.012390 366050 config.py:54] PyTorch version 2.6.0 available.
W0318 06:18:57.369483 366050 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:18:58.413752 366050 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:18:58.418129 359624 quantize_finetune_llama.py:203] layer 28 gpu 0
I0318 06:18:58.434257 366050 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.01860136352479458 tr(WHW.T) 1394.900634765625
bpp_loss 3.1146976947784424
24_q proxy err 0.0038570177275687456 tr(WHW.T) 7020.447265625
bpp_loss 3.2989765405654907
24_k proxy err 0.0026334405411034822 tr(WHW.T) 10323.43359375
bpp_loss 3.3061838150024414
24_o proxy err 0.012983031570911407 tr(WHW.T) 133.98797607421875
bpp_loss 3.101920485496521
24_up proxy err 0.017300685867667198 tr(WHW.T) 2621.76513671875
bpp_loss 3.1213708921920422
24_gate proxy err 0.010884733870625496 tr(WHW.T) 4262.74853515625
bpp_loss 3.215779326682867
24_down proxy err 0.017922986298799515 tr(WHW.T) 340.22412109375
bpp_loss 3.1174816752589027
25_v proxy err 0.017785726115107536 tr(WHW.T) 1707.664794921875
bpp_loss 3.16134774684906
25_q proxy err 0.004405812826007605 tr(WHW.T) 7162.16357421875
bpp_loss 3.323216676712036
25_k proxy err 0.003289843676611781 tr(WHW.T) 9611.58984375
bpp_loss 3.3287559747695923
25_o proxy err 0.016360292211174965 tr(WHW.T) 83.535888671875
bpp_loss 3.1555768251419067
25_up proxy err 0.017125610262155533 tr(WHW.T) 2805.728515625
bpp_loss 3.125878090082213
25_gate proxy err 0.010530942119657993 tr(WHW.T) 4666.4404296875
bpp_loss 3.216909364212391
25_down proxy err 0.017185764387249947 tr(WHW.T) 373.460693359375
bpp_loss 3.1215493401815726
I0318 06:19:31.351185 359624 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 1.1201941967010498s
I0318 06:19:35.114694 366513 config.py:54] PyTorch version 2.6.0 available.
W0318 06:19:35.443371 366513 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.01741318590939045 tr(WHW.T) 1668.8843994140625
bpp_loss 3.176102638244629
26_q proxy err 0.004017513245344162 tr(WHW.T) 7469.98291015625
bpp_loss 3.2980822324752808
26_k proxy err 0.0028865498024970293 tr(WHW.T) 10487.8740234375
bpp_loss 3.309144616127014
26_o proxy err 0.010353036224842072 tr(WHW.T) 202.88172912597656
bpp_loss 3.1687734127044678
26_up proxy err 0.016080014407634735 tr(WHW.T) 3154.75146484375
bpp_loss 3.13051960080169
26_gate proxy err 0.009790183044970036 tr(WHW.T) 5302.16455078125
bpp_loss 3.2186258005541424
26_down proxy err 0.017810607329010963 tr(WHW.T) 401.19390869140625
bpp_loss 3.1229243611180504
W0318 06:19:36.447290 366513 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:19:36.451411 359624 quantize_finetune_llama.py:203] layer 29 gpu 1
I0318 06:19:36.465441 366513 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:19:38.294449 359624 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 1.36842942237854s
27_v proxy err 0.016812635585665703 tr(WHW.T) 1799.3350830078125
bpp_loss 3.183823585510254
27_q proxy err 0.004118532408028841 tr(WHW.T) 7691.708984375
bpp_loss 3.365321397781372
27_k proxy err 0.0030117477290332317 tr(WHW.T) 10618.70703125
bpp_loss 3.3811631202697754
27_o proxy err 0.01386635098606348 tr(WHW.T) 126.13690185546875
bpp_loss 3.1843137741088867
27_up proxy err 0.014624473638832569 tr(WHW.T) 3691.557861328125
bpp_loss 3.136127560637718
27_gate proxy err 0.009198065847158432 tr(WHW.T) 5990.82568359375
bpp_loss 3.217121212981468
27_down proxy err 0.017541762441396713 tr(WHW.T) 466.9318542480469
bpp_loss 3.126308884731559
I0318 06:19:42.110951 366638 config.py:54] PyTorch version 2.6.0 available.
W0318 06:19:42.432504 366638 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:19:43.357385 366638 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:19:43.361202 359624 quantize_finetune_llama.py:203] layer 30 gpu 2
I0318 06:19:43.376995 366638 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:19:44.859558 359624 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 1.0532264709472656s
I0318 06:19:48.652383 366768 config.py:54] PyTorch version 2.6.0 available.
W0318 06:19:48.978204 366768 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:19:49.917138 366768 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:19:49.920974 359624 quantize_finetune_llama.py:203] layer 31 gpu 3
I0318 06:19:49.940563 366768 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 06:19:51.570308 359624 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.1419265270233154s
I0318 06:19:55.510469 366892 config.py:54] PyTorch version 2.6.0 available.
W0318 06:19:55.860446 366892 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 06:19:56.988959 366892 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 06:19:57.007427 366892 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.01565280370414257 tr(WHW.T) 2018.944091796875
bpp_loss 3.2207820415496826
28_q proxy err 0.00427171029150486 tr(WHW.T) 7651.126953125
bpp_loss 3.318040370941162
28_k proxy err 0.0031297586392611265 tr(WHW.T) 10544.8251953125
bpp_loss 3.3359707593917847
28_o proxy err 0.011315685696899891 tr(WHW.T) 194.8240966796875
bpp_loss 3.2248228788375854
28_up proxy err 0.012201367877423763 tr(WHW.T) 4661.2666015625
bpp_loss 3.147813309070676
28_gate proxy err 0.008809520862996578 tr(WHW.T) 6547.48193359375
bpp_loss 3.2096145984738373
28_down proxy err 0.016660725697875023 tr(WHW.T) 603.8403930664062
bpp_loss 3.1305307122163994
29_v proxy err 0.01640060544013977 tr(WHW.T) 1801.7730712890625
bpp_loss 3.2257978916168213
29_q proxy err 0.004193521570414305 tr(WHW.T) 7227.0009765625
bpp_loss 3.273648500442505
29_k proxy err 0.0029056265484541655 tr(WHW.T) 10558.609375
bpp_loss 3.288589596748352
29_o proxy err 0.01030381303280592 tr(WHW.T) 207.9054412841797
bpp_loss 3.2432368993759155
29_up proxy err 0.009746440686285496 tr(WHW.T) 6070.0498046875
bpp_loss 3.157622226448946
29_gate proxy err 0.008088339120149612 tr(WHW.T) 7369.6142578125
bpp_loss 3.209522336028343
29_down proxy err 0.01618676632642746 tr(WHW.T) 782.2448120117188
bpp_loss 3.130128172940986
30_v proxy err 0.01410397607833147 tr(WHW.T) 2261.489501953125
bpp_loss 3.2613062858581543
30_q proxy err 0.004204200115054846 tr(WHW.T) 7815.9453125
bpp_loss 3.2934054136276245
30_k proxy err 0.0031585164833813906 tr(WHW.T) 10521.625
bpp_loss 3.3163135051727295
30_o proxy err 0.009817240759730339 tr(WHW.T) 251.96908569335938
bpp_loss 3.271800994873047
30_up proxy err 0.00601899903267622 tr(WHW.T) 10016.376953125
bpp_loss 3.167696753213572
30_gate proxy err 0.005509219132363796 tr(WHW.T) 11001.119140625
bpp_loss 3.226593549861464
30_down proxy err 0.005784297361969948 tr(WHW.T) 3582.617919921875
bpp_loss 3.1129724147707916
31_v proxy err 0.01681615225970745 tr(WHW.T) 1268.2034912109375
bpp_loss 3.136281967163086
31_q proxy err 0.0033774746116250753 tr(WHW.T) 6858.09130859375
bpp_loss 3.312312364578247
31_k proxy err 0.002314809476956725 tr(WHW.T) 10233.677734375
bpp_loss 3.3562045097351074
31_o proxy err 0.006879541091620922 tr(WHW.T) 457.7950744628906
bpp_loss 3.1327229738235474
31_up proxy err 0.0035384756047278643 tr(WHW.T) 14563.890625
bpp_loss 3.2258332718250364
31_gate proxy err 0.0034908608067780733 tr(WHW.T) 14836.2939453125
bpp_loss 3.2966409727584485
31_down proxy err 0.0031478246673941612 tr(WHW.T) 17873.55859375
bpp_loss 3.102340299029683
