I0317 11:11:08.946537 3785958 config.py:54] PyTorch version 2.6.0 available.
W0317 11:11:09.229467 3785958 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:11:10.221056 3785958 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.32it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.08it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  7.59it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  7.85it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.00it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.19it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  7.90it/s]
I0317 11:11:11.185513 3785958 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:14,  2.12it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:00<00:14,  2.11it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:13,  2.11it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:01<00:13,  2.13it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:02<00:12,  2.22it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:02<00:11,  2.26it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:03<00:10,  2.29it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:03<00:10,  2.33it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:03<00:09,  2.34it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:04<00:09,  2.37it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:04<00:08,  2.41it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:05<00:08,  2.44it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:05<00:07,  2.47it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:05<00:07,  2.51it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:06<00:06,  2.53it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:06<00:06,  2.54it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:07<00:05,  2.55it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:07<00:05,  2.56it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:07<00:05,  2.57it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:08<00:04,  2.56it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:08<00:04,  2.58it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:09<00:03,  2.59it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:09<00:03,  2.58it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:09<00:03,  2.59it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:10<00:02,  2.60it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:10<00:02,  2.61it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:10<00:01,  2.61it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:11<00:01,  2.61it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:11<00:01,  2.63it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:12<00:00,  2.63it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:12<00:00,  2.63it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.64it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:12<00:00,  2.48it/s]
I0317 11:11:30.286283 3785958 quantize_finetune_llama.py:173] loaded compression model
I0317 11:11:43.935054 3785958 quantize_finetune_llama.py:177] loaded dataset and devset
I0317 11:11:49.026241 3785958 quantize_finetune_llama.py:197] layer 0 gpu 0
I0317 11:11:52.176290 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 0 in 3.007219076156616s
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0317 11:12:07.610410 3786727 config.py:54] PyTorch version 2.6.0 available.
W0317 11:12:07.893094 3786727 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:12:08.790469 3786727 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:12:08.794476 3785958 quantize_finetune_llama.py:197] layer 1 gpu 1
I0317 11:12:08.807938 3786727 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:12:12.124936 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 1 in 3.167318820953369s
I0317 11:12:15.583622 3786862 config.py:54] PyTorch version 2.6.0 available.
W0317 11:12:15.892412 3786862 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:12:16.833453 3786862 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:12:16.837220 3785958 quantize_finetune_llama.py:197] layer 2 gpu 2
I0317 11:12:16.850433 3786862 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:12:20.034407 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 2 in 3.0454421043395996s
I0317 11:12:23.892180 3787012 config.py:54] PyTorch version 2.6.0 available.
W0317 11:12:24.241472 3787012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:12:25.241089 3787012 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:12:25.245697 3785958 quantize_finetune_llama.py:197] layer 3 gpu 3
I0317 11:12:25.259871 3787012 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:12:28.147430 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 3 in 2.7378575801849365s
I0317 11:12:32.092343 3787147 config.py:54] PyTorch version 2.6.0 available.
W0317 11:12:32.459153 3787147 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:12:33.596171 3787147 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:12:33.600567 3785958 quantize_finetune_llama.py:197] layer 4 gpu 0
I0317 11:12:33.620863 3787147 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.07140082865953445 tr(WHW.T) 4.225186347961426
0_q proxy err 0.0002237318258266896 tr(WHW.T) 2710.363037109375
0_k proxy err 0.00028759147971868515 tr(WHW.T) 1698.7349853515625
0_o proxy err 0.00798577256500721 tr(WHW.T) 0.9668058156967163
0_up proxy err 0.020888956263661385 tr(WHW.T) 43.27138900756836
0_gate proxy err 0.014489647932350636 tr(WHW.T) 63.47430419921875
0_down proxy err 0.01201186515390873 tr(WHW.T) 0.656814694404602
1_v proxy err 0.17778213322162628 tr(WHW.T) 16.465883255004883
1_q proxy err 0.0008765949751250446 tr(WHW.T) 4778.43994140625
1_k proxy err 0.000861802720464766 tr(WHW.T) 4995.39208984375
1_o proxy err 0.04338613897562027 tr(WHW.T) 1.1115814447402954
1_up proxy err 0.028262397274374962 tr(WHW.T) 109.66383361816406
1_gate proxy err 0.01489949505776167 tr(WHW.T) 221.3038787841797
1_down proxy err 0.0015886549372226 tr(WHW.T) 2041.4736328125
I0317 11:12:53.711588 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 4 in 0.7526764869689941s
I0317 11:12:57.489348 3787497 config.py:54] PyTorch version 2.6.0 available.
W0317 11:12:57.834007 3787497 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:12:58.927944 3787497 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:12:58.932339 3785958 quantize_finetune_llama.py:197] layer 5 gpu 1
I0317 11:12:58.948641 3787497 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.037148892879486084 tr(WHW.T) 136.67332458496094
2_q proxy err 0.0008237435249611735 tr(WHW.T) 7752.85205078125
2_k proxy err 0.00064113549888134 tr(WHW.T) 10205.837890625
2_o proxy err 0.03819772228598595 tr(WHW.T) 1.4603197574615479
2_up proxy err 0.03287786990404129 tr(WHW.T) 193.43603515625
2_gate proxy err 0.021638285368680954 tr(WHW.T) 306.6622619628906
2_down proxy err 0.0332145094871521 tr(WHW.T) 3.010739803314209
I0317 11:13:02.591900 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 5 in 0.928246021270752s
I0317 11:13:06.424025 3787640 config.py:54] PyTorch version 2.6.0 available.
W0317 11:13:06.756573 3787640 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:13:07.755789 3787640 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:13:07.760122 3785958 quantize_finetune_llama.py:197] layer 6 gpu 2
I0317 11:13:07.774667 3787640 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.049864787608385086 tr(WHW.T) 284.77557373046875
3_q proxy err 0.0023812672588974237 tr(WHW.T) 7217.63720703125
3_k proxy err 0.001741996849887073 tr(WHW.T) 10074.73828125
3_o proxy err 0.032732509076595306 tr(WHW.T) 3.3527450561523438
3_up proxy err 0.03726780414581299 tr(WHW.T) 284.7950744628906
3_gate proxy err 0.023237889632582664 tr(WHW.T) 478.13714599609375
3_down proxy err 0.033910296857357025 tr(WHW.T) 6.133229732513428
I0317 11:13:10.464896 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 6 in 0.9227337837219238s
I0317 11:13:14.237540 3787788 config.py:54] PyTorch version 2.6.0 available.
W0317 11:13:14.585092 3787788 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:13:15.630926 3787788 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:13:15.635206 3785958 quantize_finetune_llama.py:197] layer 7 gpu 3
I0317 11:13:15.649267 3787788 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:13:17.120600 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 7 in 1.021885871887207s
I0317 11:13:20.992859 3787904 config.py:54] PyTorch version 2.6.0 available.
W0317 11:13:21.348882 3787904 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:13:22.455706 3787904 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:13:22.459959 3785958 quantize_finetune_llama.py:197] layer 8 gpu 0
I0317 11:13:22.476435 3787904 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.0451500378549099 tr(WHW.T) 274.6131286621094
4_q proxy err 0.0021650309208780527 tr(WHW.T) 6914.9892578125
4_k proxy err 0.0014597747940570116 tr(WHW.T) 10415.33203125
4_o proxy err 0.037786178290843964 tr(WHW.T) 5.139806270599365
4_up proxy err 0.036164455115795135 tr(WHW.T) 397.6960144042969
4_gate proxy err 0.018593115732073784 tr(WHW.T) 821.1856689453125
4_down proxy err 0.03439514338970184 tr(WHW.T) 11.562739372253418
5_v proxy err 0.04300959035754204 tr(WHW.T) 298.47540283203125
5_q proxy err 0.0022603231482207775 tr(WHW.T) 6770.97509765625
5_k proxy err 0.0014578861882910132 tr(WHW.T) 10841.955078125
5_o proxy err 0.042016834020614624 tr(WHW.T) 7.947142601013184
5_up proxy err 0.035718731582164764 tr(WHW.T) 506.6408386230469
5_gate proxy err 0.01753329485654831 tr(WHW.T) 1104.867919921875
5_down proxy err 0.03683879226446152 tr(WHW.T) 15.6494779586792
I0317 11:13:45.209216 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 8 in 0.9962780475616455s
I0317 11:13:49.141810 3788264 config.py:54] PyTorch version 2.6.0 available.
W0317 11:13:49.472004 3788264 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:13:50.427055 3788264 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:13:50.430813 3785958 quantize_finetune_llama.py:197] layer 9 gpu 1
I0317 11:13:50.444471 3788264 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.04800713062286377 tr(WHW.T) 443.5464782714844
6_q proxy err 0.0033020894043147564 tr(WHW.T) 7576.53857421875
6_k proxy err 0.002454650355502963 tr(WHW.T) 10409.4033203125
6_o proxy err 0.047100525349378586 tr(WHW.T) 11.564380645751953
6_up proxy err 0.03477878496050835 tr(WHW.T) 617.2608642578125
6_gate proxy err 0.0148051418364048 tr(WHW.T) 1554.7271728515625
6_down proxy err 0.0376276969909668 tr(WHW.T) 22.988168716430664
I0317 11:13:52.589690 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 9 in 0.9938480854034424s
I0317 11:13:56.370740 3788395 config.py:54] PyTorch version 2.6.0 available.
W0317 11:13:56.686320 3788395 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.04728557541966438 tr(WHW.T) 489.9357604980469
7_q proxy err 0.003554463619366288 tr(WHW.T) 7672.17919921875
7_k proxy err 0.0027141557075083256 tr(WHW.T) 10198.3701171875
7_o proxy err 0.053503308445215225 tr(WHW.T) 15.11335563659668
7_up proxy err 0.03359132260084152 tr(WHW.T) 735.8538818359375
7_gate proxy err 0.014057541266083717 tr(WHW.T) 1876.0390625
7_down proxy err 0.03795722872018814 tr(WHW.T) 30.58672523498535
W0317 11:13:57.661690 3788395 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:13:57.665906 3785958 quantize_finetune_llama.py:197] layer 10 gpu 2
I0317 11:13:57.679887 3788395 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:13:59.466213 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 10 in 0.912895679473877s
I0317 11:14:03.103775 3788538 config.py:54] PyTorch version 2.6.0 available.
W0317 11:14:03.442640 3788538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:14:04.467761 3788538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:14:04.472156 3785958 quantize_finetune_llama.py:197] layer 11 gpu 3
I0317 11:14:04.486849 3788538 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:14:06.126336 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 11 in 1.1608264446258545s
I0317 11:14:09.888347 3788666 config.py:54] PyTorch version 2.6.0 available.
W0317 11:14:10.242743 3788666 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:14:11.326832 3788666 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:14:11.331179 3785958 quantize_finetune_llama.py:197] layer 12 gpu 0
I0317 11:14:11.368399 3788666 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.040941983461380005 tr(WHW.T) 530.9967041015625
8_q proxy err 0.003492126939818263 tr(WHW.T) 7228.1201171875
8_k proxy err 0.002411098685115576 tr(WHW.T) 10639.1015625
8_o proxy err 0.06061266362667084 tr(WHW.T) 20.092191696166992
8_up proxy err 0.030229346826672554 tr(WHW.T) 866.312744140625
8_gate proxy err 0.013888450339436531 tr(WHW.T) 1970.857177734375
8_down proxy err 0.037943728268146515 tr(WHW.T) 37.177734375
9_v proxy err 0.04056883975863457 tr(WHW.T) 565.0663452148438
9_q proxy err 0.003825702238827944 tr(WHW.T) 6970.3359375
9_k proxy err 0.002469197381287813 tr(WHW.T) 10987.3515625
9_o proxy err 0.061834365129470825 tr(WHW.T) 25.610172271728516
9_up proxy err 0.02902495488524437 tr(WHW.T) 970.8984375
9_gate proxy err 0.01374127808958292 tr(WHW.T) 2132.69384765625
9_down proxy err 0.03836674615740776 tr(WHW.T) 42.99482727050781
I0317 11:14:34.704596 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 12 in 0.9791839122772217s
I0317 11:14:38.618811 3789014 config.py:54] PyTorch version 2.6.0 available.
W0317 11:14:38.943801 3789014 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:14:39.866703 3789014 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:14:39.870349 3785958 quantize_finetune_llama.py:197] layer 13 gpu 1
10_v proxy err 0.040687207132577896 tr(WHW.T) 578.807373046875
10_q proxy err 0.003951791673898697 tr(WHW.T) 6915.87109375
10_k proxy err 0.0025264283176511526 tr(WHW.T) 10996.2431640625
10_o proxy err 0.06469254195690155 tr(WHW.T) 35.184165954589844
10_up proxy err 0.027386832982301712 tr(WHW.T) 1080.198486328125
10_gate proxy err 0.013547942042350769 tr(WHW.T) 2260.88330078125
10_down proxy err 0.03634343668818474 tr(WHW.T) 52.33584976196289
I0317 11:14:39.883810 3789014 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:14:42.053527 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 13 in 0.986675500869751s
I0317 11:14:45.871340 3789147 config.py:54] PyTorch version 2.6.0 available.
W0317 11:14:46.182028 3789147 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.04044536501169205 tr(WHW.T) 723.1956176757812
11_q proxy err 0.00468417489901185 tr(WHW.T) 7027.10986328125
11_k proxy err 0.0031796882394701242 tr(WHW.T) 10511.23046875
11_o proxy err 0.06384629756212234 tr(WHW.T) 36.654052734375
11_up proxy err 0.028044093400239944 tr(WHW.T) 1139.6044921875
11_gate proxy err 0.013794315978884697 tr(WHW.T) 2392.716552734375
11_down proxy err 0.037675607949495316 tr(WHW.T) 56.13530731201172
W0317 11:14:47.154905 3789147 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:14:47.158932 3785958 quantize_finetune_llama.py:197] layer 14 gpu 2
I0317 11:14:47.172530 3789147 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:14:48.491200 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 14 in 0.8929398059844971s
I0317 11:14:52.163423 3789273 config.py:54] PyTorch version 2.6.0 available.
W0317 11:14:52.500371 3789273 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:14:53.456272 3789273 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:14:53.460369 3785958 quantize_finetune_llama.py:197] layer 15 gpu 3
I0317 11:14:53.477579 3789273 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:14:54.924052 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 15 in 0.9673526287078857s
I0317 11:14:58.660054 3789409 config.py:54] PyTorch version 2.6.0 available.
W0317 11:14:58.964750 3789409 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:14:59.930852 3789409 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:14:59.935283 3785958 quantize_finetune_llama.py:197] layer 16 gpu 0
I0317 11:14:59.970878 3789409 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.04159899801015854 tr(WHW.T) 703.318603515625
12_q proxy err 0.0047332546673715115 tr(WHW.T) 7045.6435546875
12_k proxy err 0.00311856297776103 tr(WHW.T) 10893.65625
12_o proxy err 0.06752569228410721 tr(WHW.T) 39.29071044921875
12_up proxy err 0.027861302718520164 tr(WHW.T) 1228.298583984375
12_gate proxy err 0.014737829566001892 tr(WHW.T) 2381.994873046875
12_down proxy err 0.03742823749780655 tr(WHW.T) 64.17745208740234
13_v proxy err 0.0426333025097847 tr(WHW.T) 714.5677490234375
13_q proxy err 0.004969113040715456 tr(WHW.T) 6956.03564453125
13_k proxy err 0.0033662125933915377 tr(WHW.T) 10426.6318359375
13_o proxy err 0.05914647504687309 tr(WHW.T) 45.8377571105957
13_up proxy err 0.026836946606636047 tr(WHW.T) 1367.6221923828125
13_gate proxy err 0.014452560804784298 tr(WHW.T) 2601.504638671875
13_down proxy err 0.03679346665740013 tr(WHW.T) 79.3589096069336
I0317 11:15:24.221492 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 16 in 0.9778447151184082s
I0317 11:15:27.975836 3789781 config.py:54] PyTorch version 2.6.0 available.
W0317 11:15:28.275436 3789781 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.04501748085021973 tr(WHW.T) 706.1612548828125
14_q proxy err 0.005133474711328745 tr(WHW.T) 7077.06103515625
14_k proxy err 0.003269664477556944 tr(WHW.T) 11295.16796875
14_o proxy err 0.06760601699352264 tr(WHW.T) 50.921180725097656
14_up proxy err 0.027365192770957947 tr(WHW.T) 1464.7159423828125
14_gate proxy err 0.01527397520840168 tr(WHW.T) 2682.584716796875
14_down proxy err 0.03745042160153389 tr(WHW.T) 90.28684997558594
W0317 11:15:29.211296 3789781 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:15:29.215363 3785958 quantize_finetune_llama.py:197] layer 17 gpu 1
I0317 11:15:29.229560 3789781 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:15:30.829939 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 17 in 1.1549687385559082s
I0317 11:15:34.556709 3789902 config.py:54] PyTorch version 2.6.0 available.
15_v proxy err 0.04053526744246483 tr(WHW.T) 762.7275390625
15_q proxy err 0.004806038923561573 tr(WHW.T) 7252.0009765625
15_k proxy err 0.003222630824893713 tr(WHW.T) 11072.3974609375
15_o proxy err 0.05547326058149338 tr(WHW.T) 59.61664962768555
15_up proxy err 0.02658369019627571 tr(WHW.T) 1641.0228271484375
15_gate proxy err 0.01534583605825901 tr(WHW.T) 2905.140380859375
15_down proxy err 0.03698155656456947 tr(WHW.T) 114.09001922607422
W0317 11:15:34.851145 3789902 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:15:35.790687 3789902 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:15:35.795026 3785958 quantize_finetune_llama.py:197] layer 18 gpu 2
I0317 11:15:35.809356 3789902 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:15:37.198307 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 18 in 0.9570817947387695s
I0317 11:15:40.850110 3790018 config.py:54] PyTorch version 2.6.0 available.
W0317 11:15:41.176151 3790018 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:15:42.157009 3790018 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:15:42.161354 3785958 quantize_finetune_llama.py:197] layer 19 gpu 3
I0317 11:15:42.176349 3790018 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:15:43.615296 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 19 in 0.9605748653411865s
I0317 11:15:47.457580 3790151 config.py:54] PyTorch version 2.6.0 available.
W0317 11:15:47.800542 3790151 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:15:48.842530 3790151 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:15:48.847009 3785958 quantize_finetune_llama.py:197] layer 20 gpu 0
I0317 11:15:48.876416 3790151 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.04240398481488228 tr(WHW.T) 780.7407836914062
16_q proxy err 0.005144125781953335 tr(WHW.T) 7193.3974609375
16_k proxy err 0.0032483527902513742 tr(WHW.T) 11630.361328125
16_o proxy err 0.046513691544532776 tr(WHW.T) 88.22785186767578
16_up proxy err 0.026708155870437622 tr(WHW.T) 1890.9385986328125
16_gate proxy err 0.01541620958596468 tr(WHW.T) 3369.859130859375
16_down proxy err 0.03736898675560951 tr(WHW.T) 152.0294952392578
17_v proxy err 0.04201071709394455 tr(WHW.T) 845.7654418945312
17_q proxy err 0.005562514532357454 tr(WHW.T) 7163.2734375
17_k proxy err 0.003786359680816531 tr(WHW.T) 10697.431640625
17_o proxy err 0.049218494445085526 tr(WHW.T) 58.14826965332031
17_up proxy err 0.029469260945916176 tr(WHW.T) 1921.07861328125
17_gate proxy err 0.01635400392115116 tr(WHW.T) 3571.31640625
17_down proxy err 0.037811923772096634 tr(WHW.T) 165.43495178222656
I0317 11:16:13.843930 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 20 in 0.974719762802124s
18_v proxy err 0.0399368554353714 tr(WHW.T) 1003.7705078125
18_q proxy err 0.005928917322307825 tr(WHW.T) 7510.48046875
18_k proxy err 0.004309154115617275 tr(WHW.T) 10462.6650390625
18_o proxy err 0.042317405343055725 tr(WHW.T) 69.96558380126953
18_up proxy err 0.03157690912485123 tr(WHW.T) 2023.183837890625
18_gate proxy err 0.01750035211443901 tr(WHW.T) 3783.076416015625
18_down proxy err 0.0369938462972641 tr(WHW.T) 198.52699279785156
I0317 11:16:17.616043 3790536 config.py:54] PyTorch version 2.6.0 available.
W0317 11:16:17.893090 3790536 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:16:18.862172 3790536 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:16:18.866625 3785958 quantize_finetune_llama.py:197] layer 21 gpu 1
I0317 11:16:18.880922 3790536 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:16:20.245872 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 21 in 0.9376552104949951s
I0317 11:16:23.950200 3790652 config.py:54] PyTorch version 2.6.0 available.
19_v proxy err 0.03943997621536255 tr(WHW.T) 1019.1412353515625
19_q proxy err 0.006338908802717924 tr(WHW.T) 6944.4130859375
19_k proxy err 0.004233678337186575 tr(WHW.T) 10548.4892578125
19_o proxy err 0.042628537863492966 tr(WHW.T) 62.291683197021484
19_up proxy err 0.03186079487204552 tr(WHW.T) 2149.330322265625
19_gate proxy err 0.01919483207166195 tr(WHW.T) 3687.5126953125
19_down proxy err 0.036079730838537216 tr(WHW.T) 222.93177795410156
W0317 11:16:24.254591 3790652 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:16:25.157616 3790652 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:16:25.161871 3785958 quantize_finetune_llama.py:197] layer 22 gpu 2
I0317 11:16:25.175688 3790652 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:16:26.527181 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 22 in 0.9202096462249756s
I0317 11:16:30.300654 3790768 config.py:54] PyTorch version 2.6.0 available.
W0317 11:16:30.628994 3790768 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:16:31.670732 3790768 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:16:31.675079 3785958 quantize_finetune_llama.py:197] layer 23 gpu 3
I0317 11:16:31.691075 3790768 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:16:33.337307 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 23 in 1.1890156269073486s
I0317 11:16:37.126830 3790906 config.py:54] PyTorch version 2.6.0 available.
W0317 11:16:37.445899 3790906 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:16:38.404281 3790906 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:16:38.408518 3785958 quantize_finetune_llama.py:197] layer 24 gpu 0
I0317 11:16:38.443343 3790906 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.04137343540787697 tr(WHW.T) 990.5983276367188
20_q proxy err 0.0062692840583622456 tr(WHW.T) 7150.947265625
20_k proxy err 0.0043768929317593575 tr(WHW.T) 10386.2470703125
20_o proxy err 0.031324755400419235 tr(WHW.T) 100.31707000732422
20_up proxy err 0.031420495361089706 tr(WHW.T) 2340.89453125
20_gate proxy err 0.01897062547504902 tr(WHW.T) 4024.62744140625
20_down proxy err 0.03525399789214134 tr(WHW.T) 274.8815002441406
21_v proxy err 0.04063070937991142 tr(WHW.T) 1144.5655517578125
21_q proxy err 0.0070730820298194885 tr(WHW.T) 7064.314453125
21_k proxy err 0.005071751307696104 tr(WHW.T) 9976.4658203125
21_o proxy err 0.03450285270810127 tr(WHW.T) 75.50972747802734
21_up proxy err 0.03314803168177605 tr(WHW.T) 2361.650390625
21_gate proxy err 0.020303988829255104 tr(WHW.T) 4004.37646484375
21_down proxy err 0.03608418628573418 tr(WHW.T) 276.5857849121094
I0317 11:17:03.719671 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 24 in 0.9456541538238525s
I0317 11:17:07.513289 3791285 config.py:54] PyTorch version 2.6.0 available.
22_v proxy err 0.03850533068180084 tr(WHW.T) 1243.2529296875
22_q proxy err 0.006687359418720007 tr(WHW.T) 7746.84765625
22_k proxy err 0.004934989847242832 tr(WHW.T) 10603.2041015625
22_o proxy err 0.027967317029833794 tr(WHW.T) 114.30065155029297
22_up proxy err 0.03337736800312996 tr(WHW.T) 2474.510498046875
22_gate proxy err 0.02068609930574894 tr(WHW.T) 4156.64013671875
22_down proxy err 0.03611309826374054 tr(WHW.T) 311.8800048828125
W0317 11:17:07.806384 3791285 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:17:08.685968 3791285 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:17:08.689634 3785958 quantize_finetune_llama.py:197] layer 25 gpu 1
I0317 11:17:08.702247 3791285 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:17:10.099416 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 25 in 0.9315552711486816s
I0317 11:17:13.919734 3791408 config.py:54] PyTorch version 2.6.0 available.
W0317 11:17:14.247097 3791408 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.036557573825120926 tr(WHW.T) 1486.037353515625
23_q proxy err 0.007856955751776695 tr(WHW.T) 7346.60986328125
23_k proxy err 0.005840723402798176 tr(WHW.T) 9982.2392578125
23_o proxy err 0.033753346651792526 tr(WHW.T) 85.13458251953125
23_up proxy err 0.034613870084285736 tr(WHW.T) 2533.51025390625
23_gate proxy err 0.02227313444018364 tr(WHW.T) 4097.51953125
23_down proxy err 0.036112260073423386 tr(WHW.T) 321.33892822265625
W0317 11:17:15.166140 3791408 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:17:15.170200 3785958 quantize_finetune_llama.py:197] layer 26 gpu 2
I0317 11:17:15.186589 3791408 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:17:17.088352 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 26 in 0.8988659381866455s
I0317 11:17:20.803568 3791534 config.py:54] PyTorch version 2.6.0 available.
W0317 11:17:21.136866 3791534 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:17:22.154243 3791534 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:17:22.158539 3785958 quantize_finetune_llama.py:197] layer 27 gpu 3
I0317 11:17:22.172153 3791534 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:17:23.694919 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 27 in 1.0711240768432617s
I0317 11:17:27.596256 3791665 config.py:54] PyTorch version 2.6.0 available.
W0317 11:17:27.954282 3791665 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:17:28.992600 3791665 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:17:28.997204 3785958 quantize_finetune_llama.py:197] layer 28 gpu 0
I0317 11:17:29.048503 3791665 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.03761190176010132 tr(WHW.T) 1394.900634765625
24_q proxy err 0.007883853279054165 tr(WHW.T) 7020.447265625
24_k proxy err 0.005411228165030479 tr(WHW.T) 10323.43359375
24_o proxy err 0.026252543553709984 tr(WHW.T) 133.98797607421875
24_up proxy err 0.035122644156217575 tr(WHW.T) 2621.76513671875
24_gate proxy err 0.022388312965631485 tr(WHW.T) 4262.74853515625
24_down proxy err 0.03592555597424507 tr(WHW.T) 340.22412109375
25_v proxy err 0.03601127117872238 tr(WHW.T) 1707.664794921875
25_q proxy err 0.009072949178516865 tr(WHW.T) 7162.16357421875
25_k proxy err 0.006789733190089464 tr(WHW.T) 9611.58984375
25_o proxy err 0.033094506710767746 tr(WHW.T) 83.535888671875
25_up proxy err 0.03484697267413139 tr(WHW.T) 2805.728515625
25_gate proxy err 0.02171044424176216 tr(WHW.T) 4666.4404296875
25_down proxy err 0.03446727618575096 tr(WHW.T) 373.460693359375
I0317 11:17:54.990196 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 28 in 1.1587343215942383s
I0317 11:17:58.829764 3792054 config.py:54] PyTorch version 2.6.0 available.
W0317 11:17:59.191857 3792054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.035214997828006744 tr(WHW.T) 1668.8843994140625
26_q proxy err 0.008253912441432476 tr(WHW.T) 7469.98291015625
26_k proxy err 0.005943011958152056 tr(WHW.T) 10487.8740234375
26_o proxy err 0.021937845274806023 tr(WHW.T) 202.88172912597656
26_up proxy err 0.0326865054666996 tr(WHW.T) 3154.75146484375
26_gate proxy err 0.020139452069997787 tr(WHW.T) 5302.16455078125
26_down proxy err 0.03571031242609024 tr(WHW.T) 401.19390869140625
W0317 11:18:00.124835 3792054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:18:00.128570 3785958 quantize_finetune_llama.py:197] layer 29 gpu 1
I0317 11:18:00.141637 3792054 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:18:02.045351 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 29 in 1.1236546039581299s
I0317 11:18:05.811544 3792178 config.py:54] PyTorch version 2.6.0 available.
W0317 11:18:06.173346 3792178 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.03435777500271797 tr(WHW.T) 1799.3350830078125
27_q proxy err 0.008651992306113243 tr(WHW.T) 7691.708984375
27_k proxy err 0.006356794387102127 tr(WHW.T) 10618.70703125
27_o proxy err 0.028189579024910927 tr(WHW.T) 126.13690185546875
27_up proxy err 0.029849901795387268 tr(WHW.T) 3691.557861328125
27_gate proxy err 0.018963363021612167 tr(WHW.T) 5990.82568359375
27_down proxy err 0.03550609573721886 tr(WHW.T) 466.9318542480469
W0317 11:18:07.196242 3792178 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:18:07.200622 3785958 quantize_finetune_llama.py:197] layer 30 gpu 2
I0317 11:18:07.219141 3792178 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:18:08.845297 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 30 in 0.9002938270568848s
I0317 11:18:12.633431 3792314 config.py:54] PyTorch version 2.6.0 available.
W0317 11:18:13.009129 3792314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:18:14.042352 3792314 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:18:14.046742 3785958 quantize_finetune_llama.py:197] layer 31 gpu 3
I0317 11:18:14.064014 3792314 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 11:18:15.644563 3785958 quantize_finetune_llama.py:228] computed original embedding for layer 31 in 1.1332685947418213s
I0317 11:18:19.632076 3792442 config.py:54] PyTorch version 2.6.0 available.
W0317 11:18:20.012064 3792442 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 11:18:21.088943 3792442 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 11:18:21.128452 3792442 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.03190026059746742 tr(WHW.T) 2018.944091796875
28_q proxy err 0.008935223333537579 tr(WHW.T) 7651.126953125
28_k proxy err 0.006592241115868092 tr(WHW.T) 10544.8251953125
28_o proxy err 0.023430917412042618 tr(WHW.T) 194.8240966796875
28_up proxy err 0.025066742673516273 tr(WHW.T) 4661.2666015625
28_gate proxy err 0.01819694973528385 tr(WHW.T) 6547.48193359375
28_down proxy err 0.03393859788775444 tr(WHW.T) 603.8403930664062
29_v proxy err 0.03350602835416794 tr(WHW.T) 1801.7730712890625
29_q proxy err 0.008844426833093166 tr(WHW.T) 7227.0009765625
29_k proxy err 0.006185607984662056 tr(WHW.T) 10558.609375
29_o proxy err 0.021125322207808495 tr(WHW.T) 207.9054412841797
29_up proxy err 0.02019878849387169 tr(WHW.T) 6070.0498046875
29_gate proxy err 0.01672954112291336 tr(WHW.T) 7369.6142578125
29_down proxy err 0.03265810012817383 tr(WHW.T) 782.2448120117188
30_v proxy err 0.029003003612160683 tr(WHW.T) 2261.489501953125
30_q proxy err 0.009011740796267986 tr(WHW.T) 7815.9453125
30_k proxy err 0.006865296978503466 tr(WHW.T) 10521.625
30_o proxy err 0.020362868905067444 tr(WHW.T) 251.96908569335938
30_up proxy err 0.012812462635338306 tr(WHW.T) 10016.376953125
30_gate proxy err 0.011609742417931557 tr(WHW.T) 11001.119140625
30_down proxy err 0.01280438993126154 tr(WHW.T) 3582.617919921875
31_v proxy err 0.034308772534132004 tr(WHW.T) 1268.2034912109375
31_q proxy err 0.007325617130845785 tr(WHW.T) 6858.09130859375
31_k proxy err 0.005098945461213589 tr(WHW.T) 10233.677734375
31_o proxy err 0.015194288454949856 tr(WHW.T) 457.7950744628906
31_up proxy err 0.007705389056354761 tr(WHW.T) 14563.890625
31_gate proxy err 0.007542580831795931 tr(WHW.T) 14836.2939453125
31_down proxy err 0.006769298110157251 tr(WHW.T) 17873.55859375
