I0318 16:40:25.059317 780144 config.py:54] PyTorch version 2.6.0 available.
W0318 16:40:25.340232 780144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:40:26.220889 780144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.27it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.95it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.15it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.22it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.30it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.33it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.95it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.05it/s]
I0318 16:40:27.661079 780144 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:22,  1.35it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:20,  1.43it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:01<00:18,  1.56it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:02<00:16,  1.70it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:03<00:15,  1.78it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:03<00:14,  1.82it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:04<00:13,  1.85it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:04<00:12,  1.94it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:04<00:11,  2.01it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:10,  2.06it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:05<00:10,  2.08it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:09,  2.11it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:06<00:08,  2.14it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:08,  2.19it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:07<00:07,  2.24it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:07,  2.27it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:08<00:06,  2.31it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:08<00:06,  2.33it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:09<00:05,  2.35it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:09<00:05,  2.36it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:10<00:04,  2.36it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:10<00:04,  2.37it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:11<00:03,  2.38it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:11<00:03,  2.40it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:11<00:02,  2.38it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:12<00:02,  2.39it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:12<00:02,  2.40it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:13<00:01,  2.40it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:13<00:01,  2.42it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:13<00:00,  2.40it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:14<00:00,  2.40it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:14<00:00,  2.42it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:14<00:00,  2.17it/s]
I0318 16:40:47.677623 780144 quantize_finetune_llama.py:179] loaded compression model
I0318 16:41:07.398209 780144 quantize_finetune_llama.py:183] loaded dataset and devset
I0318 16:41:13.004803 780144 quantize_finetune_llama.py:203] layer 0 gpu 0
I0318 16:41:14.817040 780144 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 1.6696224212646484s
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0318 16:41:29.082676 780958 config.py:54] PyTorch version 2.6.0 available.
W0318 16:41:29.365939 780958 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:41:30.247668 780958 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:41:30.251718 780144 quantize_finetune_llama.py:203] layer 1 gpu 1
I0318 16:41:30.270155 780958 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:41:32.500537 780144 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 2.0792946815490723s
I0318 16:41:35.828255 781083 config.py:54] PyTorch version 2.6.0 available.
W0318 16:41:36.144126 781083 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:41:37.099541 781083 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:41:37.104091 780144 quantize_finetune_llama.py:203] layer 2 gpu 2
I0318 16:41:37.123485 781083 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:41:39.735710 780144 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 2.4679503440856934s
I0318 16:41:43.105781 781211 config.py:54] PyTorch version 2.6.0 available.
W0318 16:41:43.463582 781211 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:41:44.565353 781211 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:41:44.569650 780144 quantize_finetune_llama.py:203] layer 3 gpu 3
I0318 16:41:44.591210 781211 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:41:48.584807 780144 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 3.8433258533477783s
I0318 16:41:52.170558 781368 config.py:54] PyTorch version 2.6.0 available.
W0318 16:41:52.468951 781368 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:41:53.376916 781368 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:41:53.380980 780144 quantize_finetune_llama.py:203] layer 4 gpu 0
I0318 16:41:53.400007 781368 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.01798352785408497 tr(WHW.T) 1.3175290822982788
bpp_loss 4.053955554962158
0_q proxy err 0.010884804651141167 tr(WHW.T) 6234.0732421875
bpp_loss 4.490072429180145
0_k proxy err 0.013882447965443134 tr(WHW.T) 2167.80859375
bpp_loss 4.770461142063141
0_o proxy err 0.0022603177931159735 tr(WHW.T) 0.23014844954013824
bpp_loss 4.138330399990082
0_up proxy err 0.002479343907907605 tr(WHW.T) 101.63945007324219
bpp_loss 4.407893453325544
0_gate proxy err 0.0016529933782294393 tr(WHW.T) 179.7012481689453
bpp_loss 4.492858818599156
0_down proxy err 0.002293987665325403 tr(WHW.T) 0.4814107418060303
bpp_loss 4.402773192950657
1_v proxy err 0.010276207700371742 tr(WHW.T) 5.699800491333008
bpp_loss 4.1730677485466
1_q proxy err 0.000550864904653281 tr(WHW.T) 7568.30322265625
bpp_loss 4.901364028453827
1_k proxy err 0.0007546359556727111 tr(WHW.T) 3947.4990234375
bpp_loss 5.323955297470093
1_o proxy err 0.0031047086231410503 tr(WHW.T) 0.31429046392440796
bpp_loss 4.220205783843994
1_up proxy err 0.0028252070769667625 tr(WHW.T) 159.80691528320312
bpp_loss 4.418476615633283
1_gate proxy err 0.0022386659402400255 tr(WHW.T) 270.8945617675781
bpp_loss 4.504388298307147
1_down proxy err 0.046319540590047836 tr(WHW.T) 67.10472869873047
bpp_loss 4.417621169771467
I0318 16:43:14.100058 780144 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.8739399909973145s
I0318 16:43:17.931768 782218 config.py:54] PyTorch version 2.6.0 available.
W0318 16:43:18.285473 782218 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:43:19.286920 782218 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:43:19.291114 780144 quantize_finetune_llama.py:203] layer 5 gpu 1
I0318 16:43:19.310235 782218 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.007498722057789564 tr(WHW.T) 26.839576721191406
bpp_loss 4.076817154884338
2_q proxy err 0.000540470180567354 tr(WHW.T) 7137.59423828125
bpp_loss 4.869195818901062
2_k proxy err 0.0009576799930073321 tr(WHW.T) 3891.808349609375
bpp_loss 5.309987723827362
2_o proxy err 0.0030428331810981035 tr(WHW.T) 0.5573468804359436
bpp_loss 4.168116062879562
2_up proxy err 0.0029095897916704416 tr(WHW.T) 225.9742889404297
bpp_loss 4.416194915771484
2_gate proxy err 0.0017243016045540571 tr(WHW.T) 449.3431091308594
bpp_loss 4.5348687171936035
2_down proxy err 0.002925284206867218 tr(WHW.T) 1.2005821466445923
bpp_loss 4.4194813796452115
I0318 16:43:21.630361 780144 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 0.9172060489654541s
I0318 16:43:25.463397 782361 config.py:54] PyTorch version 2.6.0 available.
W0318 16:43:25.811092 782361 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:43:26.813025 782361 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:43:26.817354 780144 quantize_finetune_llama.py:203] layer 6 gpu 2
I0318 16:43:26.837691 782361 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.00447819521650672 tr(WHW.T) 40.46714782714844
bpp_loss 4.172973453998566
3_q proxy err 0.00036112687666900456 tr(WHW.T) 6654.2763671875
bpp_loss 4.904195606708527
3_k proxy err 0.0005295704468153417 tr(WHW.T) 3660.859619140625
bpp_loss 5.383397042751312
3_o proxy err 0.0032295561395585537 tr(WHW.T) 0.9357947707176208
bpp_loss 4.266971826553345
3_up proxy err 0.002897839294746518 tr(WHW.T) 316.0293273925781
bpp_loss 4.40005806514195
3_gate proxy err 0.0013131032465025783 tr(WHW.T) 875.7510375976562
bpp_loss 4.5949031966073175
3_down proxy err 0.0031460896134376526 tr(WHW.T) 2.1166555881500244
bpp_loss 4.398540939603533
I0318 16:43:29.546937 780144 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 0.824958086013794s
I0318 16:43:32.924668 782509 config.py:54] PyTorch version 2.6.0 available.
W0318 16:43:33.274675 782509 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:43:34.314791 782509 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:43:34.319147 780144 quantize_finetune_llama.py:203] layer 7 gpu 3
I0318 16:43:34.339929 782509 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:43:35.510960 780144 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 0.7286951541900635s
I0318 16:43:38.934877 782622 config.py:54] PyTorch version 2.6.0 available.
W0318 16:43:39.214184 782622 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:43:40.180949 782622 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:43:40.185134 780144 quantize_finetune_llama.py:203] layer 8 gpu 0
I0318 16:43:40.205243 782622 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.00457499036565423 tr(WHW.T) 38.379119873046875
bpp_loss 4.220169723033905
4_q proxy err 0.0004502505762502551 tr(WHW.T) 6741.380859375
bpp_loss 4.870075941085815
4_k proxy err 0.0006686223787255585 tr(WHW.T) 3941.660888671875
bpp_loss 5.382969558238983
4_o proxy err 0.0047561232931911945 tr(WHW.T) 1.3690094947814941
bpp_loss 4.279340922832489
4_up proxy err 0.002943693194538355 tr(WHW.T) 400.241455078125
bpp_loss 4.377567427498954
4_gate proxy err 0.0009924741461873055 tr(WHW.T) 1579.121337890625
bpp_loss 4.653354372297015
4_down proxy err 0.0034211145248264074 tr(WHW.T) 3.4171695709228516
bpp_loss 4.37576026575906
5_v proxy err 0.0057628885842859745 tr(WHW.T) 37.700050354003906
bpp_loss 4.109660565853119
5_q proxy err 0.0004923215601593256 tr(WHW.T) 6497.876953125
bpp_loss 4.852817058563232
5_k proxy err 0.0016871809493750334 tr(WHW.T) 4151.98193359375
bpp_loss 5.349647879600525
5_o proxy err 0.005462212488055229 tr(WHW.T) 1.811954379081726
bpp_loss 4.223688840866089
5_up proxy err 0.0028602073434740305 tr(WHW.T) 497.45538330078125
bpp_loss 4.3824759551457
5_gate proxy err 0.0009537258883938193 tr(WHW.T) 1974.3070068359375
bpp_loss 4.654336180005755
5_down proxy err 0.0034097060561180115 tr(WHW.T) 4.908621311187744
bpp_loss 4.379800132342747
I0318 16:45:04.628921 780144 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 1.1849935054779053s
I0318 16:45:08.536335 783504 config.py:54] PyTorch version 2.6.0 available.
W0318 16:45:08.883548 783504 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:45:09.952331 783504 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:45:09.956712 780144 quantize_finetune_llama.py:203] layer 9 gpu 1
I0318 16:45:09.976151 783504 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.004882585722953081 tr(WHW.T) 42.837894439697266
bpp_loss 4.157842695713043
6_q proxy err 0.00043923244811594486 tr(WHW.T) 6019.40673828125
bpp_loss 4.885991215705872
6_k proxy err 0.0005559463170357049 tr(WHW.T) 4418.95361328125
bpp_loss 5.407297194004059
6_o proxy err 0.005700257606804371 tr(WHW.T) 2.5981621742248535
bpp_loss 4.257288455963135
6_up proxy err 0.0027386266738176346 tr(WHW.T) 571.950927734375
bpp_loss 4.382547889436994
6_gate proxy err 0.0008347828988917172 tr(WHW.T) 2580.455078125
bpp_loss 4.658628123147147
6_down proxy err 0.00344385439530015 tr(WHW.T) 6.227621078491211
bpp_loss 4.378821986062186
I0318 16:45:12.346517 780144 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 1.0937936305999756s
7_v proxy err 0.004045287612825632 tr(WHW.T) 53.14668655395508
bpp_loss 4.153532803058624
7_q proxy err 0.0003931068640667945 tr(WHW.T) 6036.439453125
bpp_loss 4.8408554792404175
7_k proxy err 0.0004704286402557045 tr(WHW.T) 4611.79638671875
bpp_loss 5.426952064037323
7_o proxy err 0.005987456999719143 tr(WHW.T) 3.787719964981079
bpp_loss 4.268509030342102
7_up proxy err 0.0025481460615992546 tr(WHW.T) 651.590087890625
bpp_loss 4.394608395440238
7_gate proxy err 0.0008359589846804738 tr(WHW.T) 2636.09716796875
bpp_loss 4.638774599347796
7_down proxy err 0.0034337472170591354 tr(WHW.T) 6.803934574127197
bpp_loss 4.389602593013218
I0318 16:45:15.886662 783637 config.py:54] PyTorch version 2.6.0 available.
W0318 16:45:16.198289 783637 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:45:17.155932 783637 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:45:17.160053 780144 quantize_finetune_llama.py:203] layer 10 gpu 2
I0318 16:45:17.179181 783637 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:45:18.506385 780144 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 0.8829233646392822s
I0318 16:45:21.935845 783775 config.py:54] PyTorch version 2.6.0 available.
W0318 16:45:22.214993 783775 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:45:23.152732 783775 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:45:23.156878 780144 quantize_finetune_llama.py:203] layer 11 gpu 3
I0318 16:45:23.200458 783775 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:45:24.694984 780144 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.0105180740356445s
I0318 16:45:28.102006 783896 config.py:54] PyTorch version 2.6.0 available.
W0318 16:45:28.379055 783896 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:45:29.358184 783896 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:45:29.362360 780144 quantize_finetune_llama.py:203] layer 12 gpu 0
I0318 16:45:29.381954 783896 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.004895052872598171 tr(WHW.T) 53.42280197143555
bpp_loss 4.175229787826538
8_q proxy err 0.0007064685923978686 tr(WHW.T) 5514.4345703125
bpp_loss 4.808832943439484
8_k proxy err 0.0007824643980711699 tr(WHW.T) 4670.25390625
bpp_loss 5.328714370727539
8_o proxy err 0.007733671460300684 tr(WHW.T) 3.732954978942871
bpp_loss 4.278164327144623
8_up proxy err 0.002562891226261854 tr(WHW.T) 668.69921875
bpp_loss 4.390355382646833
8_gate proxy err 0.0008032317855395377 tr(WHW.T) 2931.24951171875
bpp_loss 4.642908913748605
8_down proxy err 0.0035326748620718718 tr(WHW.T) 7.259360313415527
bpp_loss 4.386588164738247
9_v proxy err 0.003784789703786373 tr(WHW.T) 72.69827270507812
bpp_loss 4.2642422914505005
9_q proxy err 0.0005314566078595817 tr(WHW.T) 5306.75244140625
bpp_loss 4.822016596794128
9_k proxy err 0.0006743155536241829 tr(WHW.T) 4332.2958984375
bpp_loss 5.355402290821075
9_o proxy err 0.007527372799813747 tr(WHW.T) 4.439431190490723
bpp_loss 4.32777202129364
9_up proxy err 0.0024498114362359047 tr(WHW.T) 723.7196655273438
bpp_loss 4.398396219526019
9_gate proxy err 0.0007795661222189665 tr(WHW.T) 3179.91943359375
bpp_loss 4.6542220796857565
9_down proxy err 0.0036164161283522844 tr(WHW.T) 8.003087043762207
bpp_loss 4.389592136655535
I0318 16:46:55.007708 780144 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 1.0872550010681152s
I0318 16:46:58.813933 784413 config.py:54] PyTorch version 2.6.0 available.
W0318 16:46:59.143608 784413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.004933050833642483 tr(WHW.T) 60.08286666870117
bpp_loss 4.166158318519592
10_q proxy err 0.0006640466745011508 tr(WHW.T) 5567.93798828125
bpp_loss 4.8188799023628235
10_k proxy err 0.0009386626770719886 tr(WHW.T) 4710.4462890625
bpp_loss 5.350030541419983
10_o proxy err 0.008512473665177822 tr(WHW.T) 4.188048362731934
bpp_loss 4.269530773162842
10_up proxy err 0.0024242543149739504 tr(WHW.T) 749.0687255859375
bpp_loss 4.412887675421579
10_gate proxy err 0.0007962743984535336 tr(WHW.T) 3045.35498046875
bpp_loss 4.628570556640625
10_down proxy err 0.0035053547471761703 tr(WHW.T) 8.42132568359375
bpp_loss 4.402570400919233
W0318 16:47:00.119718 784413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:47:00.123964 780144 quantize_finetune_llama.py:203] layer 13 gpu 1
I0318 16:47:00.143673 784413 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:47:01.534355 780144 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 0.9283304214477539s
11_v proxy err 0.003978497814387083 tr(WHW.T) 74.2698974609375
bpp_loss 4.169294118881226
11_q proxy err 0.0005422334070317447 tr(WHW.T) 5157.30615234375
bpp_loss 4.790632128715515
11_k proxy err 0.0006814105436205864 tr(WHW.T) 4189.68798828125
bpp_loss 5.3658183217048645
11_o proxy err 0.010093459859490395 tr(WHW.T) 4.454066753387451
bpp_loss 4.288021564483643
11_up proxy err 0.002412821864709258 tr(WHW.T) 789.370361328125
bpp_loss 4.418202979224069
11_gate proxy err 0.0008237102883867919 tr(WHW.T) 3167.24609375
bpp_loss 4.613613333020892
11_down proxy err 0.0034030000679194927 tr(WHW.T) 9.071778297424316
bpp_loss 4.408009018216815
I0318 16:47:05.045341 784463 config.py:54] PyTorch version 2.6.0 available.
W0318 16:47:05.327206 784463 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:47:06.279461 784463 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:47:06.283623 780144 quantize_finetune_llama.py:203] layer 14 gpu 2
I0318 16:47:06.302678 784463 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:47:07.912810 780144 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 1.1588740348815918s
I0318 16:47:11.311446 784513 config.py:54] PyTorch version 2.6.0 available.
W0318 16:47:11.591057 784513 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:47:12.552904 784513 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:47:12.557092 780144 quantize_finetune_llama.py:203] layer 15 gpu 3
I0318 16:47:12.579895 784513 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:47:13.969995 780144 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 0.9674675464630127s
I0318 16:47:17.452337 784563 config.py:54] PyTorch version 2.6.0 available.
W0318 16:47:17.731510 784563 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:47:18.650409 784563 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:47:18.654494 780144 quantize_finetune_llama.py:203] layer 16 gpu 0
I0318 16:47:18.673272 784563 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.003710847580805421 tr(WHW.T) 68.45218658447266
bpp_loss 4.28036093711853
12_q proxy err 0.0004147391300648451 tr(WHW.T) 6419.8271484375
bpp_loss 4.849907457828522
12_k proxy err 0.0004837483284063637 tr(WHW.T) 4340.4931640625
bpp_loss 5.406131088733673
12_o proxy err 0.007764449808746576 tr(WHW.T) 5.624481201171875
bpp_loss 4.335419178009033
12_up proxy err 0.0022676363587379456 tr(WHW.T) 855.3871459960938
bpp_loss 4.435157264981951
12_gate proxy err 0.0008255971479229629 tr(WHW.T) 3184.862548828125
bpp_loss 4.5981935773577005
12_down proxy err 0.003795474302023649 tr(WHW.T) 10.028186798095703
bpp_loss 4.4210203886032104
13_v proxy err 0.0046239811927080154 tr(WHW.T) 71.04966735839844
bpp_loss 4.226339876651764
13_q proxy err 0.0005673215491697192 tr(WHW.T) 5299.77734375
bpp_loss 4.811560928821564
13_k proxy err 0.0010683056898415089 tr(WHW.T) 4513.97802734375
bpp_loss 5.365205883979797
13_o proxy err 0.009284008294343948 tr(WHW.T) 6.745936870574951
bpp_loss 4.31304270029068
13_up proxy err 0.0022621809039264917 tr(WHW.T) 916.3327026367188
bpp_loss 4.438013144901821
13_gate proxy err 0.0008233448024839163 tr(WHW.T) 3562.817138671875
bpp_loss 4.598573275974819
13_down proxy err 0.004212405998259783 tr(WHW.T) 11.704400062561035
bpp_loss 4.422529799597604
I0318 16:48:44.259196 780144 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 1.0529265403747559s
I0318 16:48:48.087811 784613 config.py:54] PyTorch version 2.6.0 available.
W0318 16:48:48.417999 784613 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.004614741075783968 tr(WHW.T) 74.802978515625
bpp_loss 4.214847922325134
14_q proxy err 0.0006444011814892292 tr(WHW.T) 5552.11865234375
bpp_loss 4.796975374221802
14_k proxy err 0.0011462535476312041 tr(WHW.T) 4950.54931640625
bpp_loss 5.31967967748642
14_o proxy err 0.008337872102856636 tr(WHW.T) 6.853440761566162
bpp_loss 4.309018135070801
14_up proxy err 0.0024582387413829565 tr(WHW.T) 932.0479736328125
bpp_loss 4.4345622062683105
14_gate proxy err 0.0008046847651712596 tr(WHW.T) 4249.7998046875
bpp_loss 4.6227827072143555
14_down proxy err 0.004034852609038353 tr(WHW.T) 13.352071762084961
bpp_loss 4.420479910714286
W0318 16:48:49.390441 784613 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:48:49.394558 780144 quantize_finetune_llama.py:203] layer 17 gpu 1
I0318 16:48:49.413429 784613 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:48:51.114138 780144 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 0.9594278335571289s
15_v proxy err 0.004710078705102205 tr(WHW.T) 67.86465454101562
bpp_loss 4.268517196178436
15_q proxy err 0.0006805883604101837 tr(WHW.T) 6709.19140625
bpp_loss 4.855301082134247
15_k proxy err 0.0008302113274112344 tr(WHW.T) 4509.14404296875
bpp_loss 5.389687776565552
15_o proxy err 0.007338994182646275 tr(WHW.T) 6.766374111175537
bpp_loss 4.331235945224762
15_up proxy err 0.002459883224219084 tr(WHW.T) 988.90234375
bpp_loss 4.427633455821446
15_gate proxy err 0.0007632908527739346 tr(WHW.T) 5081.40576171875
bpp_loss 4.650860513959612
15_down proxy err 0.003470429452136159 tr(WHW.T) 16.894807815551758
bpp_loss 4.4161699669701715
I0318 16:48:54.655438 784663 config.py:54] PyTorch version 2.6.0 available.
W0318 16:48:54.932151 784663 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:48:55.853275 784663 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:48:55.857284 780144 quantize_finetune_llama.py:203] layer 18 gpu 2
I0318 16:48:55.876232 784663 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:48:57.294684 780144 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.9744985103607178s
I0318 16:49:00.663984 784713 config.py:54] PyTorch version 2.6.0 available.
W0318 16:49:00.940925 784713 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:49:01.891351 784713 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:49:01.895509 780144 quantize_finetune_llama.py:203] layer 19 gpu 3
I0318 16:49:01.915189 784713 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:49:03.333594 780144 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 0.9837870597839355s
I0318 16:49:06.867751 784763 config.py:54] PyTorch version 2.6.0 available.
W0318 16:49:07.146891 784763 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:49:08.077056 784763 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:49:08.081285 780144 quantize_finetune_llama.py:203] layer 20 gpu 0
I0318 16:49:08.101054 784763 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.0048736948519945145 tr(WHW.T) 68.60269165039062
bpp_loss 4.227128803730011
16_q proxy err 0.000669466273393482 tr(WHW.T) 6124.5419921875
bpp_loss 4.865412414073944
16_k proxy err 0.0010510790161788464 tr(WHW.T) 4878.88427734375
bpp_loss 5.366548180580139
16_o proxy err 0.006416737101972103 tr(WHW.T) 7.369767189025879
bpp_loss 4.31727933883667
16_up proxy err 0.0026329990942031145 tr(WHW.T) 981.8323974609375
bpp_loss 4.415358679635184
16_gate proxy err 0.0007857560412958264 tr(WHW.T) 4852.61962890625
bpp_loss 4.680742808750698
16_down proxy err 0.004093583207577467 tr(WHW.T) 17.929277420043945
bpp_loss 4.404969794409616
17_v proxy err 0.00473975483328104 tr(WHW.T) 69.1786880493164
bpp_loss 4.299586892127991
17_q proxy err 0.0005366287659853697 tr(WHW.T) 6716.68115234375
bpp_loss 4.874567747116089
17_k proxy err 0.0014625140465795994 tr(WHW.T) 4246.078125
bpp_loss 5.389399230480194
17_o proxy err 0.005456131882965565 tr(WHW.T) 6.400019645690918
bpp_loss 4.339634418487549
17_up proxy err 0.002610566560178995 tr(WHW.T) 1061.9390869140625
bpp_loss 4.411532981055124
17_gate proxy err 0.0007910188869573176 tr(WHW.T) 5241.2060546875
bpp_loss 4.6913411276681085
17_down proxy err 0.003596031107008457 tr(WHW.T) 21.307649612426758
bpp_loss 4.403308459690639
I0318 16:50:33.779677 780144 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.2664120197296143s
I0318 16:50:37.759755 784813 config.py:54] PyTorch version 2.6.0 available.
W0318 16:50:38.081283 784813 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.004686884116381407 tr(WHW.T) 73.61924743652344
bpp_loss 4.2213128209114075
18_q proxy err 0.0006008286727592349 tr(WHW.T) 5733.501953125
bpp_loss 4.8863115310668945
18_k proxy err 0.0010206237202510238 tr(WHW.T) 4452.47412109375
bpp_loss 5.433764219284058
18_o proxy err 0.0051257917657494545 tr(WHW.T) 4.730301380157471
bpp_loss 4.325201869010925
18_up proxy err 0.002736326539888978 tr(WHW.T) 1055.73193359375
bpp_loss 4.407496043613979
18_gate proxy err 0.0008938872488215566 tr(WHW.T) 4660.94091796875
bpp_loss 4.696324552808489
18_down proxy err 0.0038770530372858047 tr(WHW.T) 21.094728469848633
bpp_loss 4.401879242488316
W0318 16:50:39.025976 784813 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:50:39.030026 780144 quantize_finetune_llama.py:203] layer 21 gpu 1
I0318 16:50:39.048684 784813 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:50:40.496196 780144 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 0.9900856018066406s
19_v proxy err 0.0041014584712684155 tr(WHW.T) 87.24554443359375
bpp_loss 4.26198548078537
19_q proxy err 0.000623897765763104 tr(WHW.T) 6149.10400390625
bpp_loss 4.8835572600364685
19_k proxy err 0.0010594552149996161 tr(WHW.T) 3978.64404296875
bpp_loss 5.390554368495941
19_o proxy err 0.005150502547621727 tr(WHW.T) 3.9390149116516113
bpp_loss 4.338438510894775
19_up proxy err 0.002847073832526803 tr(WHW.T) 1067.85498046875
bpp_loss 4.404004676001413
19_gate proxy err 0.0009619986522011459 tr(WHW.T) 4580.61328125
bpp_loss 4.703534194401333
19_down proxy err 0.00396796315908432 tr(WHW.T) 21.985567092895508
bpp_loss 4.400080902235849
I0318 16:50:44.006613 784863 config.py:54] PyTorch version 2.6.0 available.
W0318 16:50:44.285340 784863 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:50:45.201554 784863 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:50:45.206042 780144 quantize_finetune_llama.py:203] layer 22 gpu 2
I0318 16:50:45.225852 784863 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:50:46.655782 780144 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 0.9851336479187012s
I0318 16:50:50.085791 784913 config.py:54] PyTorch version 2.6.0 available.
W0318 16:50:50.363668 784913 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:50:51.305772 784913 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:50:51.309977 780144 quantize_finetune_llama.py:203] layer 23 gpu 3
I0318 16:50:51.330123 784913 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:50:52.792340 780144 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.0211281776428223s
I0318 16:50:56.313205 784963 config.py:54] PyTorch version 2.6.0 available.
W0318 16:50:56.589460 784963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:50:57.542708 784963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:50:57.546819 780144 quantize_finetune_llama.py:203] layer 24 gpu 0
I0318 16:50:57.566043 784963 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.004241175018250942 tr(WHW.T) 90.61302185058594
bpp_loss 4.297737896442413
20_q proxy err 0.0006433342932723463 tr(WHW.T) 5690.95703125
bpp_loss 4.865533769130707
20_k proxy err 0.001146770198829472 tr(WHW.T) 4224.9970703125
bpp_loss 5.354017019271851
20_o proxy err 0.004880857653915882 tr(WHW.T) 4.07815408706665
bpp_loss 4.328458309173584
20_up proxy err 0.0028718197718262672 tr(WHW.T) 1127.5106201171875
bpp_loss 4.407201290130615
20_gate proxy err 0.0010265009477734566 tr(WHW.T) 4549.56396484375
bpp_loss 4.704229422977993
20_down proxy err 0.003474945668131113 tr(WHW.T) 23.935516357421875
bpp_loss 4.403889400618417
21_v proxy err 0.0039812372997403145 tr(WHW.T) 95.41011047363281
bpp_loss 4.323945164680481
21_q proxy err 0.0005561180296353996 tr(WHW.T) 6793.60595703125
bpp_loss 4.871209263801575
21_k proxy err 0.0009965883800759912 tr(WHW.T) 4413.91943359375
bpp_loss 5.397701323032379
21_o proxy err 0.004854669328778982 tr(WHW.T) 7.5875244140625
bpp_loss 4.34662926197052
21_up proxy err 0.0028375962283462286 tr(WHW.T) 1237.0894775390625
bpp_loss 4.409546920231411
21_gate proxy err 0.001037423382513225 tr(WHW.T) 5024.13427734375
bpp_loss 4.712514332362583
21_down proxy err 0.0042655328288674355 tr(WHW.T) 29.1324520111084
bpp_loss 4.40614560672215
I0318 16:52:23.231981 780144 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 1.0437004566192627s
I0318 16:52:27.015198 785013 config.py:54] PyTorch version 2.6.0 available.
W0318 16:52:27.338559 785013 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.004140167497098446 tr(WHW.T) 101.29380798339844
bpp_loss 4.368720710277557
22_q proxy err 0.0006649636779911816 tr(WHW.T) 5947.34326171875
bpp_loss 4.851698577404022
22_k proxy err 0.0012230363208800554 tr(WHW.T) 4309.5947265625
bpp_loss 5.359325289726257
22_o proxy err 0.0049653928726911545 tr(WHW.T) 5.007936954498291
bpp_loss 4.3663113713264465
22_up proxy err 0.0028926085215061903 tr(WHW.T) 1249.8564453125
bpp_loss 4.412875277655465
22_gate proxy err 0.001047919038683176 tr(WHW.T) 4890.96826171875
bpp_loss 4.715286391122
22_down proxy err 0.0034596154000610113 tr(WHW.T) 30.777225494384766
bpp_loss 4.4095083475112915
W0318 16:52:28.283607 785013 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:52:28.287706 780144 quantize_finetune_llama.py:203] layer 25 gpu 1
I0318 16:52:28.306754 785013 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:52:29.879568 780144 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 1.1259856224060059s
23_v proxy err 0.0037079211324453354 tr(WHW.T) 112.7859115600586
bpp_loss 4.4152403473854065
23_q proxy err 0.0006318153464235365 tr(WHW.T) 6408.4541015625
bpp_loss 4.85771906375885
23_k proxy err 0.0011588211636990309 tr(WHW.T) 4211.31982421875
bpp_loss 5.3646069169044495
23_o proxy err 0.003600871888920665 tr(WHW.T) 6.165833473205566
bpp_loss 4.3855374455451965
23_up proxy err 0.002963410457596183 tr(WHW.T) 1298.444580078125
bpp_loss 4.416245426450457
23_gate proxy err 0.001107932417653501 tr(WHW.T) 4776.34521484375
bpp_loss 4.717634541647775
23_down proxy err 0.0037217475473880768 tr(WHW.T) 32.75361633300781
bpp_loss 4.413348197937012
I0318 16:52:33.412812 785063 config.py:54] PyTorch version 2.6.0 available.
W0318 16:52:33.689640 785063 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:52:34.586920 785063 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:52:34.591252 780144 quantize_finetune_llama.py:203] layer 26 gpu 2
I0318 16:52:34.611510 785063 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:52:36.047374 780144 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 0.9645209312438965s
I0318 16:52:39.406909 785113 config.py:54] PyTorch version 2.6.0 available.
W0318 16:52:39.685851 785113 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:52:40.614392 785113 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:52:40.618754 780144 quantize_finetune_llama.py:203] layer 27 gpu 3
I0318 16:52:40.639368 785113 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:52:42.123835 780144 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 1.062821388244629s
I0318 16:52:45.622995 785163 config.py:54] PyTorch version 2.6.0 available.
W0318 16:52:45.902451 785163 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:52:46.856150 785163 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:52:46.860390 780144 quantize_finetune_llama.py:203] layer 28 gpu 0
I0318 16:52:46.879862 785163 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.0033789644949138165 tr(WHW.T) 136.39785766601562
bpp_loss 4.4898600578308105
24_q proxy err 0.0006699674995616078 tr(WHW.T) 6549.06396484375
bpp_loss 4.830283582210541
24_k proxy err 0.0014659265289083123 tr(WHW.T) 4140.12353515625
bpp_loss 5.246117055416107
24_o proxy err 0.004020155873149633 tr(WHW.T) 6.529373645782471
bpp_loss 4.42343944311142
24_up proxy err 0.0030214046128094196 tr(WHW.T) 1342.69384765625
bpp_loss 4.419881786618914
24_gate proxy err 0.001151801086962223 tr(WHW.T) 4752.36767578125
bpp_loss 4.722865445273263
24_down proxy err 0.0037111779674887657 tr(WHW.T) 34.95817947387695
bpp_loss 4.41764725957598
25_v proxy err 0.0028979945927858353 tr(WHW.T) 164.04367065429688
bpp_loss 4.501785159111023
25_q proxy err 0.0006520348833873868 tr(WHW.T) 7679.1796875
bpp_loss 4.815314531326294
25_k proxy err 0.0012037191772833467 tr(WHW.T) 4239.72509765625
bpp_loss 5.247155427932739
25_o proxy err 0.003515176009386778 tr(WHW.T) 8.825087547302246
bpp_loss 4.426536202430725
25_up proxy err 0.0029925848357379436 tr(WHW.T) 1428.771728515625
bpp_loss 4.427760771342686
25_gate proxy err 0.001150617958046496 tr(WHW.T) 5091.62109375
bpp_loss 4.730368546077183
25_down proxy err 0.005807970184832811 tr(WHW.T) 37.920631408691406
bpp_loss 4.4252402782440186
I0318 16:54:12.385056 780144 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 0.9645326137542725s
I0318 16:54:16.265073 785213 config.py:54] PyTorch version 2.6.0 available.
W0318 16:54:16.596351 785213 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.003654630621895194 tr(WHW.T) 123.81900024414062
bpp_loss 4.550946474075317
26_q proxy err 0.0007165588904172182 tr(WHW.T) 6098.626953125
bpp_loss 4.816394329071045
26_k proxy err 0.0013622607802972198 tr(WHW.T) 4395.34912109375
bpp_loss 5.274346232414246
26_o proxy err 0.003473518416285515 tr(WHW.T) 16.217060089111328
bpp_loss 4.441947102546692
26_up proxy err 0.0029205342289060354 tr(WHW.T) 1584.1817626953125
bpp_loss 4.4353726250784735
26_gate proxy err 0.0010710450587794185 tr(WHW.T) 5988.38671875
bpp_loss 4.735639367784772
26_down proxy err 0.0038969104643911123 tr(WHW.T) 43.263404846191406
bpp_loss 4.433059760502407
W0318 16:54:17.623528 785213 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:54:17.627654 780144 quantize_finetune_llama.py:203] layer 29 gpu 1
I0318 16:54:17.646683 785213 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:54:19.044115 780144 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 0.9486851692199707s
27_v proxy err 0.0028275924269109964 tr(WHW.T) 203.18115234375
bpp_loss 4.60920912027359
27_q proxy err 0.0006931616808287799 tr(WHW.T) 6387.7978515625
bpp_loss 4.79822713136673
27_k proxy err 0.0018611429259181023 tr(WHW.T) 4200.8603515625
bpp_loss 5.249281346797943
27_o proxy err 0.004218318499624729 tr(WHW.T) 16.170616149902344
bpp_loss 4.462446331977844
27_up proxy err 0.0026501817628741264 tr(WHW.T) 1872.3875732421875
bpp_loss 4.447030408041818
27_gate proxy err 0.0009597241878509521 tr(WHW.T) 7248.0146484375
bpp_loss 4.745135852268764
27_down proxy err 0.0036773979663848877 tr(WHW.T) 61.20230484008789
bpp_loss 4.442454746791294
I0318 16:54:22.628616 785263 config.py:54] PyTorch version 2.6.0 available.
W0318 16:54:22.908445 785263 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:54:23.839573 785263 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:54:23.843726 780144 quantize_finetune_llama.py:203] layer 30 gpu 2
I0318 16:54:23.864961 785263 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:54:25.260248 780144 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 0.9561548233032227s
I0318 16:54:28.739591 785313 config.py:54] PyTorch version 2.6.0 available.
W0318 16:54:29.016298 785313 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:54:29.927631 785313 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:54:29.931661 780144 quantize_finetune_llama.py:203] layer 31 gpu 3
I0318 16:54:29.950331 785313 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:54:31.458350 780144 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.0726003646850586s
I0318 16:54:34.969953 785363 config.py:54] PyTorch version 2.6.0 available.
W0318 16:54:35.249751 785363 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:54:36.180413 785363 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:54:36.203065 785363 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.0028953347355127335 tr(WHW.T) 175.40757751464844
bpp_loss 4.660569787025452
28_q proxy err 0.0006290930323302746 tr(WHW.T) 6755.15673828125
bpp_loss 4.8073055148124695
28_k proxy err 0.0009324917336925864 tr(WHW.T) 4372.6787109375
bpp_loss 5.266004860401154
28_o proxy err 0.004433372989296913 tr(WHW.T) 24.542436599731445
bpp_loss 4.48431533575058
28_up proxy err 0.002275799633935094 tr(WHW.T) 2478.37158203125
bpp_loss 4.466218437467303
28_gate proxy err 0.0009113620035350323 tr(WHW.T) 8688.7451171875
bpp_loss 4.736021927424839
28_down proxy err 0.0032339300960302353 tr(WHW.T) 82.2515869140625
bpp_loss 4.457634704453604
29_v proxy err 0.00239288667216897 tr(WHW.T) 249.68582153320312
bpp_loss 4.706060171127319
29_q proxy err 0.0007101170485839248 tr(WHW.T) 6063.7841796875
bpp_loss 4.79323536157608
29_k proxy err 0.0009866933105513453 tr(WHW.T) 4804.99560546875
bpp_loss 5.303642392158508
29_o proxy err 0.002830714685842395 tr(WHW.T) 36.6841926574707
bpp_loss 4.524126708507538
29_up proxy err 0.0018449029885232449 tr(WHW.T) 3248.7060546875
bpp_loss 4.492229121071952
29_gate proxy err 0.0008642793982289732 tr(WHW.T) 9685.2646484375
bpp_loss 4.729817935398647
29_down proxy err 0.003383748000487685 tr(WHW.T) 132.4029083251953
bpp_loss 4.472494159426008
30_v proxy err 0.002759117865934968 tr(WHW.T) 252.81202697753906
bpp_loss 4.901167988777161
30_q proxy err 0.0006751581095159054 tr(WHW.T) 7045.02978515625
bpp_loss 4.718865811824799
30_k proxy err 0.0017689871601760387 tr(WHW.T) 4109.9091796875
bpp_loss 5.091478705406189
30_o proxy err 0.0023700392339378595 tr(WHW.T) 84.08126831054688
bpp_loss 4.588520169258118
30_up proxy err 0.0011627021012827754 tr(WHW.T) 5513.9267578125
bpp_loss 4.515482357570103
30_gate proxy err 0.000683941354509443 tr(WHW.T) 13194.7158203125
bpp_loss 4.7681949479239325
30_down proxy err 0.0025048796087503433 tr(WHW.T) 368.5621032714844
bpp_loss 4.4742631912231445
31_v proxy err 0.0014037411892786622 tr(WHW.T) 365.68487548828125
bpp_loss 4.756542086601257
31_q proxy err 0.00046235814807005227 tr(WHW.T) 9335.7197265625
bpp_loss 4.825814127922058
31_k proxy err 0.0011818344937637448 tr(WHW.T) 4138.115234375
bpp_loss 5.258242666721344
31_o proxy err 0.003558156546205282 tr(WHW.T) 182.20681762695312
bpp_loss 4.566525816917419
31_up proxy err 0.0005063305143266916 tr(WHW.T) 12277.7177734375
bpp_loss 4.660246508462088
31_gate proxy err 0.00037432232056744397 tr(WHW.T) 25696.34765625
bpp_loss 4.91392149244036
31_down proxy err 0.002557115163654089 tr(WHW.T) 2762.8974609375
bpp_loss 4.49437141418457
