I0318 16:18:22.787924 764383 config.py:54] PyTorch version 2.6.0 available.
W0318 16:18:23.072503 764383 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:18:23.975018 764383 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.42it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.93it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.07it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.19it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.26it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  7.82it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.05it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.02it/s]
I0318 16:18:25.426458 764383 quantize_finetune_llama.py:144] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:22,  1.36it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:21,  1.40it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:02<00:18,  1.53it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:02<00:16,  1.68it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:03<00:15,  1.74it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:03<00:14,  1.79it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:04<00:13,  1.83it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:04<00:12,  1.85it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:05<00:12,  1.86it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:11,  1.89it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:06<00:10,  1.95it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:09,  2.01it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:07<00:09,  2.05it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:08,  2.08it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:07<00:08,  2.12it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:07,  2.14it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:08<00:06,  2.16it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:09<00:06,  2.18it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:09<00:05,  2.20it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:10<00:05,  2.25it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:10<00:04,  2.28it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:04,  2.30it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:11<00:03,  2.33it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:11<00:03,  2.35it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:12<00:02,  2.36it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:12<00:02,  2.37it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:13<00:02,  2.38it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:13<00:01,  2.38it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:13<00:01,  2.38it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:14<00:00,  2.37it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:14<00:00,  2.38it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:15<00:00,  2.39it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:15<00:00,  2.10it/s]
I0318 16:18:45.975456 764383 quantize_finetune_llama.py:179] loaded compression model
I0318 16:19:06.058142 764383 quantize_finetune_llama.py:183] loaded dataset and devset
I0318 16:19:11.582318 764383 quantize_finetune_llama.py:203] layer 0 gpu 0
I0318 16:19:13.377843 764383 quantize_finetune_llama.py:234] computed original embedding for layer 0 in 1.652367353439331s
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0318 16:19:26.782621 765204 config.py:54] PyTorch version 2.6.0 available.
W0318 16:19:27.063992 765204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:19:27.945210 765204 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:19:27.949248 764383 quantize_finetune_llama.py:203] layer 1 gpu 1
I0318 16:19:27.967452 765204 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:19:31.007033 764383 quantize_finetune_llama.py:234] computed original embedding for layer 1 in 2.8903403282165527s
I0318 16:19:34.432086 765345 config.py:54] PyTorch version 2.6.0 available.
W0318 16:19:34.753752 765345 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:19:35.680161 765345 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:19:35.684547 764383 quantize_finetune_llama.py:203] layer 2 gpu 2
I0318 16:19:35.703714 765345 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:19:38.765186 764383 quantize_finetune_llama.py:234] computed original embedding for layer 2 in 2.9259371757507324s
I0318 16:19:42.277734 765485 config.py:54] PyTorch version 2.6.0 available.
W0318 16:19:42.601025 765485 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:19:43.537124 765485 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:19:43.541156 764383 quantize_finetune_llama.py:203] layer 3 gpu 3
I0318 16:19:43.560214 765485 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:19:46.740809 764383 quantize_finetune_llama.py:234] computed original embedding for layer 3 in 3.0443034172058105s
I0318 16:19:50.436823 765620 config.py:54] PyTorch version 2.6.0 available.
W0318 16:19:50.757313 765620 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:19:51.679388 765620 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:19:51.683167 764383 quantize_finetune_llama.py:203] layer 4 gpu 0
I0318 16:19:51.700997 765620 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.03834562748670578 tr(WHW.T) 1.3175290822982788
bpp_loss 3.2894507348537445
0_q proxy err 0.009137642569839954 tr(WHW.T) 6234.0732421875
bpp_loss 3.7741693556308746
0_k proxy err 0.01079845055937767 tr(WHW.T) 2167.80859375
bpp_loss 4.091675043106079
0_o proxy err 0.005489255767315626 tr(WHW.T) 0.23014844954013824
bpp_loss 3.3753481209278107
0_up proxy err 0.007023145444691181 tr(WHW.T) 101.63945007324219
bpp_loss 3.630078213555472
0_gate proxy err 0.004460712894797325 tr(WHW.T) 179.7012481689453
bpp_loss 3.7141201496124268
0_down proxy err 0.0061375913210213184 tr(WHW.T) 0.4814107418060303
bpp_loss 3.6259141138621738
1_v proxy err 0.023449590429663658 tr(WHW.T) 5.699800491333008
bpp_loss 3.4041830003261566
1_q proxy err 0.000553689431399107 tr(WHW.T) 7568.30322265625
bpp_loss 4.144485890865326
1_k proxy err 0.0005930498009547591 tr(WHW.T) 3947.4990234375
bpp_loss 4.602891445159912
1_o proxy err 0.008260766044259071 tr(WHW.T) 0.31429046392440796
bpp_loss 3.451375037431717
1_up proxy err 0.008020983077585697 tr(WHW.T) 159.80691528320312
bpp_loss 3.641913277762277
1_gate proxy err 0.0057399943470954895 tr(WHW.T) 270.8945617675781
bpp_loss 3.7271624973842075
1_down proxy err 0.036127883940935135 tr(WHW.T) 67.10472869873047
bpp_loss 3.639840747628893
I0318 16:21:12.652087 764383 quantize_finetune_llama.py:234] computed original embedding for layer 4 in 0.9061951637268066s
I0318 16:21:16.541960 766523 config.py:54] PyTorch version 2.6.0 available.
W0318 16:21:16.885697 766523 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:21:17.889976 766523 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:21:17.894231 764383 quantize_finetune_llama.py:203] layer 5 gpu 1
I0318 16:21:17.914251 766523 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.01853666640818119 tr(WHW.T) 26.839576721191406
bpp_loss 3.3164864778518677
2_q proxy err 0.0009511646348983049 tr(WHW.T) 7137.59423828125
bpp_loss 4.104512572288513
2_k proxy err 0.0011757491156458855 tr(WHW.T) 3891.808349609375
bpp_loss 4.617929935455322
2_o proxy err 0.008043055422604084 tr(WHW.T) 0.5573468804359436
bpp_loss 3.4023294150829315
2_up proxy err 0.008226493373513222 tr(WHW.T) 225.9742889404297
bpp_loss 3.638545036315918
2_gate proxy err 0.004613950382918119 tr(WHW.T) 449.3431091308594
bpp_loss 3.7546273980821883
2_down proxy err 0.008140243589878082 tr(WHW.T) 1.2005821466445923
bpp_loss 3.6416828462055753
I0318 16:21:21.206068 764383 quantize_finetune_llama.py:234] computed original embedding for layer 5 in 0.8757708072662354s
I0318 16:21:24.979914 766673 config.py:54] PyTorch version 2.6.0 available.
W0318 16:21:25.321259 766673 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:21:26.283921 766673 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:21:26.288017 764383 quantize_finetune_llama.py:203] layer 6 gpu 2
I0318 16:21:26.307237 766673 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.011922948062419891 tr(WHW.T) 40.46714782714844
bpp_loss 3.4046907126903534
3_q proxy err 0.0006955460412427783 tr(WHW.T) 6654.2763671875
bpp_loss 4.131786525249481
3_k proxy err 0.0006453008390963078 tr(WHW.T) 3660.859619140625
bpp_loss 4.678062319755554
3_o proxy err 0.00894822459667921 tr(WHW.T) 0.9357947707176208
bpp_loss 3.494240641593933
3_up proxy err 0.008199930191040039 tr(WHW.T) 316.0293273925781
bpp_loss 3.6226569584437778
3_gate proxy err 0.0035160817205905914 tr(WHW.T) 875.7510375976562
bpp_loss 3.81330292565482
3_down proxy err 0.008819940499961376 tr(WHW.T) 2.1166555881500244
bpp_loss 3.6211874229567393
I0318 16:21:28.635569 764383 quantize_finetune_llama.py:234] computed original embedding for layer 6 in 0.8564400672912598s
I0318 16:21:32.116368 766808 config.py:54] PyTorch version 2.6.0 available.
W0318 16:21:32.447363 766808 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:21:33.450152 766808 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:21:33.454390 764383 quantize_finetune_llama.py:203] layer 7 gpu 3
I0318 16:21:33.473915 766808 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:21:34.863437 764383 quantize_finetune_llama.py:234] computed original embedding for layer 7 in 0.8320512771606445s
I0318 16:21:38.305709 766924 config.py:54] PyTorch version 2.6.0 available.
W0318 16:21:38.586571 766924 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:21:39.544611 766924 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:21:39.549258 764383 quantize_finetune_llama.py:203] layer 8 gpu 0
I0318 16:21:39.571715 766924 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.012128937989473343 tr(WHW.T) 38.379119873046875
bpp_loss 3.4491383731365204
4_q proxy err 0.0008583892486058176 tr(WHW.T) 6741.380859375
bpp_loss 4.105459570884705
4_k proxy err 0.0008196580456569791 tr(WHW.T) 3941.660888671875
bpp_loss 4.663359761238098
4_o proxy err 0.012686175294220448 tr(WHW.T) 1.3690094947814941
bpp_loss 3.5070944130420685
4_up proxy err 0.008267807774245739 tr(WHW.T) 400.241455078125
bpp_loss 3.600800037384033
4_gate proxy err 0.002629435621201992 tr(WHW.T) 1579.121337890625
bpp_loss 3.8695131710597446
4_down proxy err 0.009551428258419037 tr(WHW.T) 3.4171695709228516
bpp_loss 3.599116802215576
5_v proxy err 0.014739856123924255 tr(WHW.T) 37.700050354003906
bpp_loss 3.3465758860111237
5_q proxy err 0.0009344447171315551 tr(WHW.T) 6497.876953125
bpp_loss 4.088938236236572
5_k proxy err 0.0018028931226581335 tr(WHW.T) 4151.98193359375
bpp_loss 4.63835608959198
5_o proxy err 0.014774187467992306 tr(WHW.T) 1.811954379081726
bpp_loss 3.4540519416332245
5_up proxy err 0.007996875792741776 tr(WHW.T) 497.45538330078125
bpp_loss 3.6058201449257985
5_gate proxy err 0.002509969286620617 tr(WHW.T) 1974.3070068359375
bpp_loss 3.869922297341483
5_down proxy err 0.009595963172614574 tr(WHW.T) 4.908621311187744
bpp_loss 3.603040933609009
I0318 16:23:05.249508 764383 quantize_finetune_llama.py:234] computed original embedding for layer 8 in 1.197892665863037s
I0318 16:23:09.242272 767848 config.py:54] PyTorch version 2.6.0 available.
W0318 16:23:09.602169 767848 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

6_v proxy err 0.01263844408094883 tr(WHW.T) 42.837894439697266
bpp_loss 3.390562951564789
6_q proxy err 0.0008574617095291615 tr(WHW.T) 6019.40673828125
bpp_loss 4.122926771640778
6_k proxy err 0.0006997319287620485 tr(WHW.T) 4418.95361328125
bpp_loss 4.683378100395203
6_o proxy err 0.01576223038136959 tr(WHW.T) 2.5981621742248535
bpp_loss 3.4849964678287506
6_up proxy err 0.007686825469136238 tr(WHW.T) 571.950927734375
bpp_loss 3.6057116985321045
6_gate proxy err 0.002163415076211095 tr(WHW.T) 2580.455078125
bpp_loss 3.8748228890555247
6_down proxy err 0.00950944796204567 tr(WHW.T) 6.227621078491211
bpp_loss 3.6022246224539622
W0318 16:23:10.622565 767848 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:23:10.626940 764383 quantize_finetune_llama.py:203] layer 9 gpu 1
I0318 16:23:10.648192 767848 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:23:12.671396 764383 quantize_finetune_llama.py:234] computed original embedding for layer 9 in 1.1211435794830322s
7_v proxy err 0.010624969378113747 tr(WHW.T) 53.14668655395508
bpp_loss 3.386570692062378
7_q proxy err 0.0008365273824892938 tr(WHW.T) 6036.439453125
bpp_loss 4.073245823383331
7_k proxy err 0.0006053432589396834 tr(WHW.T) 4611.79638671875
bpp_loss 4.7014418840408325
7_o proxy err 0.016759680584073067 tr(WHW.T) 3.787719964981079
bpp_loss 3.496045172214508
7_up proxy err 0.007151816505938768 tr(WHW.T) 651.590087890625
bpp_loss 3.6173817089625766
7_gate proxy err 0.0021847726311534643 tr(WHW.T) 2636.09716796875
bpp_loss 3.854859863008772
7_down proxy err 0.009550296701490879 tr(WHW.T) 6.803934574127197
bpp_loss 3.61322706086295
I0318 16:23:16.224464 767989 config.py:54] PyTorch version 2.6.0 available.
W0318 16:23:16.502739 767989 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:23:17.474539 767989 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:23:17.479162 764383 quantize_finetune_llama.py:203] layer 10 gpu 2
I0318 16:23:17.499013 767989 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:23:18.932606 764383 quantize_finetune_llama.py:234] computed original embedding for layer 10 in 0.9766950607299805s
I0318 16:23:22.341747 768116 config.py:54] PyTorch version 2.6.0 available.
W0318 16:23:22.622592 768116 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:23:23.560333 768116 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:23:23.564422 764383 quantize_finetune_llama.py:203] layer 11 gpu 3
I0318 16:23:23.583479 768116 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:23:25.151392 764383 quantize_finetune_llama.py:234] computed original embedding for layer 11 in 1.1048288345336914s
I0318 16:23:28.651030 768240 config.py:54] PyTorch version 2.6.0 available.
W0318 16:23:28.929104 768240 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:23:29.850043 768240 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:23:29.854156 764383 quantize_finetune_llama.py:203] layer 12 gpu 0
I0318 16:23:29.873346 768240 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.012756804004311562 tr(WHW.T) 53.42280197143555
bpp_loss 3.40753373503685
8_q proxy err 0.0013430722756311297 tr(WHW.T) 5514.4345703125
bpp_loss 4.055180013179779
8_k proxy err 0.0008823683019727468 tr(WHW.T) 4670.25390625
bpp_loss 4.631489872932434
8_o proxy err 0.02157970704138279 tr(WHW.T) 3.732954978942871
bpp_loss 3.506626784801483
8_up proxy err 0.007198328617960215 tr(WHW.T) 668.69921875
bpp_loss 3.6134446689060757
8_gate proxy err 0.0020690991077572107 tr(WHW.T) 2931.24951171875
bpp_loss 3.859144619532994
8_down proxy err 0.009683781303465366 tr(WHW.T) 7.259360313415527
bpp_loss 3.6103504044669017
9_v proxy err 0.009823235683143139 tr(WHW.T) 72.69827270507812
bpp_loss 3.4958246052265167
9_q proxy err 0.0011347284307703376 tr(WHW.T) 5306.75244140625
bpp_loss 4.064357340335846
9_k proxy err 0.0009492710814811289 tr(WHW.T) 4332.2958984375
bpp_loss 4.647585809230804
9_o proxy err 0.021033069118857384 tr(WHW.T) 4.439431190490723
bpp_loss 3.5534246265888214
9_up proxy err 0.006882918067276478 tr(WHW.T) 723.7196655273438
bpp_loss 3.6211677619389127
9_gate proxy err 0.001992341596633196 tr(WHW.T) 3179.91943359375
bpp_loss 3.870825801576887
9_down proxy err 0.009962637908756733 tr(WHW.T) 8.003087043762207
bpp_loss 3.613183464322771
I0318 16:24:56.708762 764383 quantize_finetune_llama.py:234] computed original embedding for layer 12 in 1.0659863948822021s
I0318 16:25:00.608763 769141 config.py:54] PyTorch version 2.6.0 available.
10_v proxy err 0.012666483409702778 tr(WHW.T) 60.08286666870117
bpp_loss 3.398593634366989
10_q proxy err 0.001372343162074685 tr(WHW.T) 5567.93798828125
bpp_loss 4.066021382808685
10_k proxy err 0.0011813384480774403 tr(WHW.T) 4710.4462890625
bpp_loss 4.647792994976044
10_o proxy err 0.0233557540923357 tr(WHW.T) 4.188048362731934
bpp_loss 3.4981028735637665
10_up proxy err 0.006763945799320936 tr(WHW.T) 749.0687255859375
bpp_loss 3.6351416451590404
10_gate proxy err 0.002048408379778266 tr(WHW.T) 3045.35498046875
bpp_loss 3.8457902499607632
10_down proxy err 0.009719141758978367 tr(WHW.T) 8.42132568359375
bpp_loss 3.6257021001407077
W0318 16:25:00.948641 769141 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:25:01.920241 769141 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:25:01.924398 764383 quantize_finetune_llama.py:203] layer 13 gpu 1
I0318 16:25:01.944217 769141 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:25:03.458292 764383 quantize_finetune_llama.py:234] computed original embedding for layer 13 in 1.0381627082824707s
11_v proxy err 0.010388807393610477 tr(WHW.T) 74.2698974609375
bpp_loss 3.4009996354579926
11_q proxy err 0.0012113414704799652 tr(WHW.T) 5157.30615234375
bpp_loss 4.026964426040649
11_k proxy err 0.0009276376804336905 tr(WHW.T) 4189.68798828125
bpp_loss 4.653506398200989
11_o proxy err 0.028475530445575714 tr(WHW.T) 4.454066753387451
bpp_loss 3.5148375928401947
11_up proxy err 0.0067549459636211395 tr(WHW.T) 789.370361328125
bpp_loss 3.640474251338414
11_gate proxy err 0.00207083229906857 tr(WHW.T) 3167.24609375
bpp_loss 3.831775256565639
11_down proxy err 0.009493403136730194 tr(WHW.T) 9.071778297424316
bpp_loss 3.63145580462047
I0318 16:25:07.036249 769266 config.py:54] PyTorch version 2.6.0 available.
W0318 16:25:07.317767 769266 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:25:08.293857 769266 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:25:08.298050 764383 quantize_finetune_llama.py:203] layer 14 gpu 2
I0318 16:25:08.318408 769266 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:25:09.937122 764383 quantize_finetune_llama.py:234] computed original embedding for layer 14 in 1.1623320579528809s
I0318 16:25:13.422751 769400 config.py:54] PyTorch version 2.6.0 available.
W0318 16:25:13.702404 769400 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:25:14.690546 769400 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:25:14.694858 764383 quantize_finetune_llama.py:203] layer 15 gpu 3
I0318 16:25:14.714951 769400 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:25:16.244449 764383 quantize_finetune_llama.py:234] computed original embedding for layer 15 in 1.0568122863769531s
I0318 16:25:19.771808 769526 config.py:54] PyTorch version 2.6.0 available.
W0318 16:25:20.052718 769526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:25:20.991171 769526 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:25:20.995410 764383 quantize_finetune_llama.py:203] layer 16 gpu 0
I0318 16:25:21.015354 769526 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.009928761050105095 tr(WHW.T) 68.45218658447266
bpp_loss 3.506978839635849
12_q proxy err 0.0008413538453169167 tr(WHW.T) 6419.8271484375
bpp_loss 4.0727492570877075
12_k proxy err 0.0006286043208092451 tr(WHW.T) 4340.4931640625
bpp_loss 4.66375458240509
12_o proxy err 0.021471234038472176 tr(WHW.T) 5.624481201171875
bpp_loss 3.560495138168335
12_up proxy err 0.006307260133326054 tr(WHW.T) 855.3871459960938
bpp_loss 3.657148633684431
12_gate proxy err 0.002068490721285343 tr(WHW.T) 3184.862548828125
bpp_loss 3.817825964518956
12_down proxy err 0.009611722081899643 tr(WHW.T) 10.028186798095703
bpp_loss 3.6439734867640903
13_v proxy err 0.012286885641515255 tr(WHW.T) 71.04966735839844
bpp_loss 3.454360008239746
13_q proxy err 0.0012717494973912835 tr(WHW.T) 5299.77734375
bpp_loss 4.049018204212189
13_k proxy err 0.0014923680573701859 tr(WHW.T) 4513.97802734375
bpp_loss 4.656772196292877
13_o proxy err 0.025107281282544136 tr(WHW.T) 6.745936870574951
bpp_loss 3.539282888174057
13_up proxy err 0.0063092391937971115 tr(WHW.T) 916.3327026367188
bpp_loss 3.659808874130249
13_gate proxy err 0.002037810394540429 tr(WHW.T) 3562.817138671875
bpp_loss 3.8193363462175642
13_down proxy err 0.010296429507434368 tr(WHW.T) 11.704400062561035
bpp_loss 3.6449320146015713
I0318 16:26:47.669816 764383 quantize_finetune_llama.py:234] computed original embedding for layer 16 in 1.1030259132385254s
I0318 16:26:51.631459 770434 config.py:54] PyTorch version 2.6.0 available.
W0318 16:26:51.977861 770434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.01225364115089178 tr(WHW.T) 74.802978515625
bpp_loss 3.443853944540024
14_q proxy err 0.0013958141207695007 tr(WHW.T) 5552.11865234375
bpp_loss 4.031349241733551
14_k proxy err 0.0015199561603367329 tr(WHW.T) 4950.54931640625
bpp_loss 4.622139096260071
14_o proxy err 0.02367309294641018 tr(WHW.T) 6.853440761566162
bpp_loss 3.535059005022049
14_up proxy err 0.0068557062186300755 tr(WHW.T) 932.0479736328125
bpp_loss 3.6563541889190674
14_gate proxy err 0.0019559417851269245 tr(WHW.T) 4249.7998046875
bpp_loss 3.843534231185913
14_down proxy err 0.010339882224798203 tr(WHW.T) 13.352071762084961
bpp_loss 3.6429011140550887
W0318 16:26:52.971943 770434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:26:52.976189 764383 quantize_finetune_llama.py:203] layer 17 gpu 1
I0318 16:26:52.996013 770434 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:26:54.797865 764383 quantize_finetune_llama.py:234] computed original embedding for layer 17 in 1.065295934677124s
15_v proxy err 0.012503460049629211 tr(WHW.T) 67.86465454101562
bpp_loss 3.496989667415619
15_q proxy err 0.001285072648897767 tr(WHW.T) 6709.19140625
bpp_loss 4.114444732666016
15_k proxy err 0.0011255566496402025 tr(WHW.T) 4509.14404296875
bpp_loss 4.658754348754883
15_o proxy err 0.020345332100987434 tr(WHW.T) 6.766374111175537
bpp_loss 3.5569591522216797
15_up proxy err 0.006945781875401735 tr(WHW.T) 988.90234375
bpp_loss 3.649475233895438
15_gate proxy err 0.0017922715051099658 tr(WHW.T) 5081.40576171875
bpp_loss 3.870211260659354
15_down proxy err 0.009716752916574478 tr(WHW.T) 16.894807815551758
bpp_loss 3.638707765511104
I0318 16:26:58.333733 770562 config.py:54] PyTorch version 2.6.0 available.
W0318 16:26:58.610186 770562 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:26:59.652555 770562 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:26:59.656733 764383 quantize_finetune_llama.py:203] layer 18 gpu 2
I0318 16:26:59.678274 770562 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:27:01.123126 764383 quantize_finetune_llama.py:234] computed original embedding for layer 18 in 0.9824371337890625s
I0318 16:27:04.624345 770678 config.py:54] PyTorch version 2.6.0 available.
W0318 16:27:04.906155 770678 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:27:05.915002 770678 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:27:05.919230 764383 quantize_finetune_llama.py:203] layer 19 gpu 3
I0318 16:27:05.939594 770678 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:27:07.529894 764383 quantize_finetune_llama.py:234] computed original embedding for layer 19 in 1.1211555004119873s
I0318 16:27:11.007628 770811 config.py:54] PyTorch version 2.6.0 available.
W0318 16:27:11.284690 770811 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:27:12.210897 770811 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:27:12.215306 764383 quantize_finetune_llama.py:203] layer 20 gpu 0
I0318 16:27:12.234810 770811 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.013026946224272251 tr(WHW.T) 68.60269165039062
bpp_loss 3.456074208021164
16_q proxy err 0.001362640061415732 tr(WHW.T) 6124.5419921875
bpp_loss 4.105222642421722
16_k proxy err 0.0014093097997829318 tr(WHW.T) 4878.88427734375
bpp_loss 4.651030480861664
16_o proxy err 0.01747806742787361 tr(WHW.T) 7.369767189025879
bpp_loss 3.5436576902866364
16_up proxy err 0.007418528664857149 tr(WHW.T) 981.8323974609375
bpp_loss 3.637622901371547
16_gate proxy err 0.0019818514119833708 tr(WHW.T) 4852.61962890625
bpp_loss 3.897186585835048
16_down proxy err 0.01041262038052082 tr(WHW.T) 17.929277420043945
bpp_loss 3.6276546035494124
17_v proxy err 0.012747776694595814 tr(WHW.T) 69.1786880493164
bpp_loss 3.525702118873596
17_q proxy err 0.0010935500031337142 tr(WHW.T) 6716.68115234375
bpp_loss 4.114257514476776
17_k proxy err 0.0018829156178981066 tr(WHW.T) 4246.078125
bpp_loss 4.666437745094299
17_o proxy err 0.015310104005038738 tr(WHW.T) 6.400019645690918
bpp_loss 3.5653652250766754
17_up proxy err 0.007343575358390808 tr(WHW.T) 1061.9390869140625
bpp_loss 3.6340108598981584
17_gate proxy err 0.001950734993442893 tr(WHW.T) 5241.2060546875
bpp_loss 3.9079696110316684
17_down proxy err 0.010000978596508503 tr(WHW.T) 21.307649612426758
bpp_loss 3.626142042023795
I0318 16:28:38.527903 764383 quantize_finetune_llama.py:234] computed original embedding for layer 20 in 1.3440124988555908s
I0318 16:28:42.418709 771729 config.py:54] PyTorch version 2.6.0 available.
W0318 16:28:42.744895 771729 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.012625623494386673 tr(WHW.T) 73.61924743652344
bpp_loss 3.4500978589057922
18_q proxy err 0.0012893503298982978 tr(WHW.T) 5733.501953125
bpp_loss 4.116248726844788
18_k proxy err 0.001373095205053687 tr(WHW.T) 4452.47412109375
bpp_loss 4.709830462932587
18_o proxy err 0.013906032778322697 tr(WHW.T) 4.730301380157471
bpp_loss 3.5504687428474426
18_up proxy err 0.007751906290650368 tr(WHW.T) 1055.73193359375
bpp_loss 3.6298796789986745
18_gate proxy err 0.0022798292338848114 tr(WHW.T) 4660.94091796875
bpp_loss 3.9118734768458774
18_down proxy err 0.010248850099742413 tr(WHW.T) 21.094728469848633
bpp_loss 3.624450445175171
W0318 16:28:43.744641 771729 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:28:43.749234 764383 quantize_finetune_llama.py:203] layer 21 gpu 1
I0318 16:28:43.768672 771729 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:28:45.456470 764383 quantize_finetune_llama.py:234] computed original embedding for layer 21 in 1.0947237014770508s
19_v proxy err 0.011190984398126602 tr(WHW.T) 87.24554443359375
bpp_loss 3.4891801178455353
19_q proxy err 0.0012590039987117052 tr(WHW.T) 6149.10400390625
bpp_loss 4.11544132232666
19_k proxy err 0.0013736619148403406 tr(WHW.T) 3978.64404296875
bpp_loss 4.658069133758545
19_o proxy err 0.014329958707094193 tr(WHW.T) 3.9390149116516113
bpp_loss 3.5632892847061157
19_up proxy err 0.00807723868638277 tr(WHW.T) 1067.85498046875
bpp_loss 3.6265144688742503
19_gate proxy err 0.002472300548106432 tr(WHW.T) 4580.61328125
bpp_loss 3.919419595173427
19_down proxy err 0.010300674475729465 tr(WHW.T) 21.985567092895508
bpp_loss 3.622715950012207
I0318 16:28:49.058925 771852 config.py:54] PyTorch version 2.6.0 available.
W0318 16:28:49.340326 771852 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:28:50.272894 771852 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:28:50.277183 764383 quantize_finetune_llama.py:203] layer 22 gpu 2
I0318 16:28:50.296062 771852 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:28:51.882663 764383 quantize_finetune_llama.py:234] computed original embedding for layer 22 in 1.1385390758514404s
I0318 16:28:55.367133 771968 config.py:54] PyTorch version 2.6.0 available.
W0318 16:28:55.645400 771968 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:28:56.552770 771968 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:28:56.556917 764383 quantize_finetune_llama.py:203] layer 23 gpu 3
I0318 16:28:56.575934 771968 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:28:58.238232 764383 quantize_finetune_llama.py:234] computed original embedding for layer 23 in 1.200523853302002s
I0318 16:29:01.799790 772098 config.py:54] PyTorch version 2.6.0 available.
W0318 16:29:02.081643 772098 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:29:03.037291 772098 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:29:03.041391 764383 quantize_finetune_llama.py:203] layer 24 gpu 0
I0318 16:29:03.060241 772098 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.011525684036314487 tr(WHW.T) 90.61302185058594
bpp_loss 3.5248145759105682
20_q proxy err 0.00139291409868747 tr(WHW.T) 5690.95703125
bpp_loss 4.096730828285217
20_k proxy err 0.001555846305564046 tr(WHW.T) 4224.9970703125
bpp_loss 4.623353600502014
20_o proxy err 0.01369286235421896 tr(WHW.T) 4.07815408706665
bpp_loss 3.554205596446991
20_up proxy err 0.008139001205563545 tr(WHW.T) 1127.5106201171875
bpp_loss 3.6295454502105713
20_gate proxy err 0.0025969548150897026 tr(WHW.T) 4549.56396484375
bpp_loss 3.9200774942125594
20_down proxy err 0.009794616140425205 tr(WHW.T) 23.935516357421875
bpp_loss 3.626162043639592
21_v proxy err 0.010843249969184399 tr(WHW.T) 95.41011047363281
bpp_loss 3.5497659146785736
21_q proxy err 0.001133703626692295 tr(WHW.T) 6793.60595703125
bpp_loss 4.096708834171295
21_k proxy err 0.0013202315894886851 tr(WHW.T) 4413.91943359375
bpp_loss 4.6561684012413025
21_o proxy err 0.013174543157219887 tr(WHW.T) 7.5875244140625
bpp_loss 3.571793168783188
21_up proxy err 0.008029569871723652 tr(WHW.T) 1237.0894775390625
bpp_loss 3.6320038182394847
21_gate proxy err 0.0026013916358351707 tr(WHW.T) 5024.13427734375
bpp_loss 3.9286628110068187
21_down proxy err 0.010288624092936516 tr(WHW.T) 29.1324520111084
bpp_loss 3.6284632682800293
I0318 16:30:29.247443 764383 quantize_finetune_llama.py:234] computed original embedding for layer 24 in 1.1686885356903076s
22_v proxy err 0.011011791415512562 tr(WHW.T) 101.29380798339844
bpp_loss 3.5928820073604584
22_q proxy err 0.0013886071974411607 tr(WHW.T) 5947.34326171875
bpp_loss 4.072830379009247
22_k proxy err 0.0016326014883816242 tr(WHW.T) 4309.5947265625
bpp_loss 4.618344485759735
22_o proxy err 0.013955599628388882 tr(WHW.T) 5.007936954498291
bpp_loss 3.5909160375595093
22_up proxy err 0.008222963660955429 tr(WHW.T) 1249.8564453125
bpp_loss 3.6349800654820035
22_gate proxy err 0.002714228816330433 tr(WHW.T) 4890.96826171875
bpp_loss 3.9302568095070973
22_down proxy err 0.009540689177811146 tr(WHW.T) 30.777225494384766
bpp_loss 3.631706246307918
I0318 16:30:33.170093 773037 config.py:54] PyTorch version 2.6.0 available.
W0318 16:30:33.502849 773037 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:30:34.472226 773037 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:30:34.476359 764383 quantize_finetune_llama.py:203] layer 25 gpu 1
I0318 16:30:34.496292 773037 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:30:36.220750 764383 quantize_finetune_llama.py:234] computed original embedding for layer 25 in 1.2597942352294922s
23_v proxy err 0.009957551024854183 tr(WHW.T) 112.7859115600586
bpp_loss 3.6381631195545197
23_q proxy err 0.0013093568850308657 tr(WHW.T) 6408.4541015625
bpp_loss 4.078345835208893
23_k proxy err 0.0015273456228896976 tr(WHW.T) 4211.31982421875
bpp_loss 4.619720101356506
23_o proxy err 0.010018519125878811 tr(WHW.T) 6.165833473205566
bpp_loss 3.6087503731250763
23_up proxy err 0.00839241873472929 tr(WHW.T) 1298.444580078125
bpp_loss 3.6383415971483504
23_gate proxy err 0.0029169877525418997 tr(WHW.T) 4776.34521484375
bpp_loss 3.9323205607278005
23_down proxy err 0.009649200364947319 tr(WHW.T) 32.75361633300781
bpp_loss 3.6354784028870717
I0318 16:30:39.718453 773160 config.py:54] PyTorch version 2.6.0 available.
W0318 16:30:39.996346 773160 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:30:40.930519 773160 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:30:40.934668 764383 quantize_finetune_llama.py:203] layer 26 gpu 2
I0318 16:30:40.953979 773160 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:30:42.505967 764383 quantize_finetune_llama.py:234] computed original embedding for layer 26 in 1.0981214046478271s
I0318 16:30:45.911978 773276 config.py:54] PyTorch version 2.6.0 available.
W0318 16:30:46.191279 773276 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:30:47.195214 773276 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:30:47.199339 764383 quantize_finetune_llama.py:203] layer 27 gpu 3
I0318 16:30:47.218635 773276 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:30:48.746112 764383 quantize_finetune_llama.py:234] computed original embedding for layer 27 in 1.0715923309326172s
I0318 16:30:52.272979 773402 config.py:54] PyTorch version 2.6.0 available.
W0318 16:30:52.553266 773402 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:30:53.500602 773402 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:30:53.504835 764383 quantize_finetune_llama.py:203] layer 28 gpu 0
I0318 16:30:53.523797 773402 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.009060757234692574 tr(WHW.T) 136.39785766601562
bpp_loss 3.713655650615692
24_q proxy err 0.0013471684651449323 tr(WHW.T) 6549.06396484375
bpp_loss 4.053290843963623
24_k proxy err 0.001847489969804883 tr(WHW.T) 4140.12353515625
bpp_loss 4.511433124542236
24_o proxy err 0.011034823022782803 tr(WHW.T) 6.529373645782471
bpp_loss 3.6455896496772766
24_up proxy err 0.0085518229752779 tr(WHW.T) 1342.69384765625
bpp_loss 3.6420535700661794
24_gate proxy err 0.0030780660454183817 tr(WHW.T) 4752.36767578125
bpp_loss 3.937471730368478
24_down proxy err 0.009520195424556732 tr(WHW.T) 34.95817947387695
bpp_loss 3.6397403478622437
25_v proxy err 0.007777909282594919 tr(WHW.T) 164.04367065429688
bpp_loss 3.723699629306793
25_q proxy err 0.0012325211428105831 tr(WHW.T) 7679.1796875
bpp_loss 4.037429749965668
25_k proxy err 0.001527867978438735 tr(WHW.T) 4239.72509765625
bpp_loss 4.507493853569031
25_o proxy err 0.009184595197439194 tr(WHW.T) 8.825087547302246
bpp_loss 3.6492583453655243
25_up proxy err 0.008482865057885647 tr(WHW.T) 1428.771728515625
bpp_loss 3.649662937436785
25_gate proxy err 0.0030385206919163465 tr(WHW.T) 5091.62109375
bpp_loss 3.9450487409319197
25_down proxy err 0.011532428674399853 tr(WHW.T) 37.920631408691406
bpp_loss 3.6471726979528154
I0318 16:32:19.023158 764383 quantize_finetune_llama.py:234] computed original embedding for layer 28 in 1.0244286060333252s
I0318 16:32:22.996325 774328 config.py:54] PyTorch version 2.6.0 available.
W0318 16:32:23.348495 774328 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.00975723285228014 tr(WHW.T) 123.81900024414062
bpp_loss 3.772586911916733
26_q proxy err 0.0014366783434525132 tr(WHW.T) 6098.626953125
bpp_loss 4.041476309299469
26_k proxy err 0.0017129183979704976 tr(WHW.T) 4395.34912109375
bpp_loss 4.543956518173218
26_o proxy err 0.007805457804352045 tr(WHW.T) 16.217060089111328
bpp_loss 3.664834827184677
26_up proxy err 0.00824205856770277 tr(WHW.T) 1584.1817626953125
bpp_loss 3.6569489410945346
26_gate proxy err 0.0027929956559091806 tr(WHW.T) 5988.38671875
bpp_loss 3.9509641783578053
26_down proxy err 0.009923318400979042 tr(WHW.T) 43.263404846191406
bpp_loss 3.6545303549085344
W0318 16:32:24.370376 774328 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:32:24.374660 764383 quantize_finetune_llama.py:203] layer 29 gpu 1
I0318 16:32:24.394720 774328 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:32:26.276787 764383 quantize_finetune_llama.py:234] computed original embedding for layer 29 in 1.0964539051055908s
27_v proxy err 0.007252661511301994 tr(WHW.T) 203.18115234375
bpp_loss 3.8320053219795227
27_q proxy err 0.001411198521964252 tr(WHW.T) 6387.7978515625
bpp_loss 4.022152483463287
27_k proxy err 0.0022258367389440536 tr(WHW.T) 4200.8603515625
bpp_loss 4.517905056476593
27_o proxy err 0.009280889295041561 tr(WHW.T) 16.170616149902344
bpp_loss 3.687698870897293
27_up proxy err 0.007521495688706636 tr(WHW.T) 1872.3875732421875
bpp_loss 3.6683882645198276
27_gate proxy err 0.0025109942071139812 tr(WHW.T) 7248.0146484375
bpp_loss 3.9594573974609375
27_down proxy err 0.010211088694632053 tr(WHW.T) 61.20230484008789
bpp_loss 3.6639794451849803
I0318 16:32:29.845341 774488 config.py:54] PyTorch version 2.6.0 available.
W0318 16:32:30.125096 774488 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:32:31.108121 774488 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:32:31.112455 764383 quantize_finetune_llama.py:203] layer 30 gpu 2
I0318 16:32:31.135065 774488 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:32:32.608478 764383 quantize_finetune_llama.py:234] computed original embedding for layer 30 in 1.013078212738037s
I0318 16:32:36.013076 774632 config.py:54] PyTorch version 2.6.0 available.
W0318 16:32:36.293135 774632 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:32:37.234944 774632 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:32:37.239172 764383 quantize_finetune_llama.py:203] layer 31 gpu 3
I0318 16:32:37.261101 774632 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0318 16:32:38.962620 764383 quantize_finetune_llama.py:234] computed original embedding for layer 31 in 1.254730463027954s
I0318 16:32:42.396236 774751 config.py:54] PyTorch version 2.6.0 available.
W0318 16:32:42.675953 774751 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0318 16:32:43.623865 774751 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0318 16:32:43.648279 774751 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.007684639655053616 tr(WHW.T) 175.40757751464844
bpp_loss 3.8806208074092865
28_q proxy err 0.0012745887506753206 tr(WHW.T) 6755.15673828125
bpp_loss 4.02909380197525
28_k proxy err 0.0013066161191090941 tr(WHW.T) 4372.6787109375
bpp_loss 4.504014790058136
28_o proxy err 0.008672460913658142 tr(WHW.T) 24.542436599731445
bpp_loss 3.707682281732559
28_up proxy err 0.006493563763797283 tr(WHW.T) 2478.37158203125
bpp_loss 3.6870637961796353
28_gate proxy err 0.0023008740972727537 tr(WHW.T) 8688.7451171875
bpp_loss 3.950951201575143
28_down proxy err 0.008744416758418083 tr(WHW.T) 82.2515869140625
bpp_loss 3.6785335881369456
29_v proxy err 0.006210075691342354 tr(WHW.T) 249.68582153320312
bpp_loss 3.925686240196228
29_q proxy err 0.0014714428689330816 tr(WHW.T) 6063.7841796875
bpp_loss 4.0171579122543335
29_k proxy err 0.0013364985352382064 tr(WHW.T) 4804.99560546875
bpp_loss 4.556501686573029
29_o proxy err 0.00623787147924304 tr(WHW.T) 36.6841926574707
bpp_loss 3.744806796312332
29_up proxy err 0.005187812726944685 tr(WHW.T) 3248.7060546875
bpp_loss 3.712345463888986
29_gate proxy err 0.0021538431756198406 tr(WHW.T) 9685.2646484375
bpp_loss 3.945842981338501
29_down proxy err 0.008865639567375183 tr(WHW.T) 132.4029083251953
bpp_loss 3.6932137182780673
30_v proxy err 0.006734829396009445 tr(WHW.T) 252.81202697753906
bpp_loss 4.122003495693207
30_q proxy err 0.0013359205331653357 tr(WHW.T) 7045.02978515625
bpp_loss 3.9465867280960083
30_k proxy err 0.0024945514742285013 tr(WHW.T) 4109.9091796875
bpp_loss 4.334956705570221
30_o proxy err 0.004272348713129759 tr(WHW.T) 84.08126831054688
bpp_loss 3.8085997700691223
30_up proxy err 0.003206350142136216 tr(WHW.T) 5513.9267578125
bpp_loss 3.7351727145058766
30_gate proxy err 0.0016602015821263194 tr(WHW.T) 13194.7158203125
bpp_loss 3.9828619275774275
30_down proxy err 0.006847445387393236 tr(WHW.T) 368.5621032714844
bpp_loss 3.695174591881888
31_v proxy err 0.003441056003794074 tr(WHW.T) 365.68487548828125
bpp_loss 3.9819755852222443
31_q proxy err 0.0007886298117227852 tr(WHW.T) 9335.7197265625
bpp_loss 4.054635643959045
31_k proxy err 0.0014395881444215775 tr(WHW.T) 4138.115234375
bpp_loss 4.495052874088287
31_o proxy err 0.008601002395153046 tr(WHW.T) 182.20681762695312
bpp_loss 3.787412941455841
31_up proxy err 0.001232297858223319 tr(WHW.T) 12277.7177734375
bpp_loss 3.8787856783185686
31_gate proxy err 0.0007528365240432322 tr(WHW.T) 25696.34765625
bpp_loss 4.132111617497036
31_down proxy err 0.006226429715752602 tr(WHW.T) 2762.8974609375
bpp_loss 3.7150284818240573
