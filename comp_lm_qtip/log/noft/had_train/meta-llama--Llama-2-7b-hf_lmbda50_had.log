I0317 13:34:01.395203 3888507 config.py:54] PyTorch version 2.6.0 available.
W0317 13:34:01.675941 3888507 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:34:02.547161 3888507 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  7.14it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:00,  7.89it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.16it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.30it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:00<00:00,  8.39it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.53it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.30it/s]
I0317 13:34:03.475918 3888507 quantize_finetune_llama.py:144] loaded model
I0317 13:34:03.661707 3888507 quantize_finetune_llama.py:177] loaded compression model
I0317 13:34:17.944587 3888507 quantize_finetune_llama.py:181] loaded dataset and devset
I0317 13:34:23.380965 3888507 quantize_finetune_llama.py:201] layer 0 gpu 0
I0317 13:34:27.769103 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 0 in 4.230327844619751s
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0317 13:34:42.592331 3889089 config.py:54] PyTorch version 2.6.0 available.
W0317 13:34:42.874237 3889089 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:34:43.754692 3889089 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:34:43.758721 3888507 quantize_finetune_llama.py:201] layer 1 gpu 1
I0317 13:34:43.909273 3889089 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:34:46.612581 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 1 in 2.6823034286499023s
I0317 13:34:50.125131 3889232 config.py:54] PyTorch version 2.6.0 available.
W0317 13:34:50.430958 3889232 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:34:51.350785 3889232 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:34:51.354890 3888507 quantize_finetune_llama.py:201] layer 2 gpu 2
I0317 13:34:51.607695 3889232 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:34:55.937464 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 2 in 4.442385673522949s
I0317 13:34:59.699135 3889420 config.py:54] PyTorch version 2.6.0 available.
W0317 13:34:59.978266 3889420 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:35:00.994060 3889420 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:35:00.998257 3888507 quantize_finetune_llama.py:201] layer 3 gpu 3
I0317 13:35:01.226741 3889420 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:35:04.848072 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 3 in 3.6779255867004395s
I0317 13:35:08.838207 3889577 config.py:54] PyTorch version 2.6.0 available.
W0317 13:35:09.200706 3889577 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:35:10.186347 3889577 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:35:10.190539 3888507 quantize_finetune_llama.py:201] layer 4 gpu 0
I0317 13:35:10.454995 3889577 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.036826279014348984 tr(WHW.T) 4.225186347961426
0_q proxy err 0.0002510290942154825 tr(WHW.T) 2710.363037109375
0_k proxy err 0.00027467685868032277 tr(WHW.T) 1698.7349853515625
0_o proxy err 0.0025688789319247007 tr(WHW.T) 0.9668058156967163
0_up proxy err 0.004812107887119055 tr(WHW.T) 43.27138900756836
0_gate proxy err 0.0033520732540637255 tr(WHW.T) 63.47430419921875
0_down proxy err 0.00332976458594203 tr(WHW.T) 0.656814694404602
1_v proxy err 0.053357888013124466 tr(WHW.T) 16.465883255004883
1_q proxy err 0.0003310675092507154 tr(WHW.T) 4778.43994140625
1_k proxy err 0.00031650043092668056 tr(WHW.T) 4995.39208984375
1_o proxy err 0.008896877989172935 tr(WHW.T) 1.1115814447402954
1_up proxy err 0.005071799736469984 tr(WHW.T) 109.66383361816406
1_gate proxy err 0.002638530218973756 tr(WHW.T) 221.3038787841797
1_down proxy err 0.002987079555168748 tr(WHW.T) 2041.4736328125
I0317 13:35:41.296679 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 4 in 0.9060301780700684s
I0317 13:35:45.220843 3890007 config.py:54] PyTorch version 2.6.0 available.
W0317 13:35:45.578577 3890007 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:35:46.618922 3890007 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:35:46.623054 3888507 quantize_finetune_llama.py:201] layer 5 gpu 1
I0317 13:35:46.794985 3890007 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.014287703670561314 tr(WHW.T) 136.67332458496094
2_q proxy err 0.00039681888301856816 tr(WHW.T) 7752.85205078125
2_k proxy err 0.00030802510445937514 tr(WHW.T) 10205.837890625
2_o proxy err 0.007601626683026552 tr(WHW.T) 1.4603197574615479
2_up proxy err 0.005916666239500046 tr(WHW.T) 193.43603515625
2_gate proxy err 0.003882391843944788 tr(WHW.T) 306.6622619628906
2_down proxy err 0.006819052156060934 tr(WHW.T) 3.010739803314209
I0317 13:35:52.173485 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 5 in 0.9861600399017334s
I0317 13:35:55.937149 3890179 config.py:54] PyTorch version 2.6.0 available.
W0317 13:35:56.278206 3890179 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:35:57.285493 3890179 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:35:57.289837 3888507 quantize_finetune_llama.py:201] layer 6 gpu 2
I0317 13:35:57.487326 3890179 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.013386000879108906 tr(WHW.T) 284.77557373046875
3_q proxy err 0.0007422486087307334 tr(WHW.T) 7217.63720703125
3_k proxy err 0.0005510820192284882 tr(WHW.T) 10074.73828125
3_o proxy err 0.0075455582700669765 tr(WHW.T) 3.3527450561523438
3_up proxy err 0.0067444718442857265 tr(WHW.T) 284.7950744628906
3_gate proxy err 0.004192863125354052 tr(WHW.T) 478.13714599609375
3_down proxy err 0.006968362722545862 tr(WHW.T) 6.133229732513428
I0317 13:36:00.939910 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 6 in 1.031177043914795s
I0317 13:36:04.650174 3890336 config.py:54] PyTorch version 2.6.0 available.
W0317 13:36:04.980789 3890336 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:36:05.988482 3890336 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:36:05.992775 3888507 quantize_finetune_llama.py:201] layer 7 gpu 3
I0317 13:36:06.151372 3890336 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:36:07.497651 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 7 in 0.9962916374206543s
I0317 13:36:11.440861 3890461 config.py:54] PyTorch version 2.6.0 available.
W0317 13:36:11.770945 3890461 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:36:12.860827 3890461 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:36:12.865052 3888507 quantize_finetune_llama.py:201] layer 8 gpu 0
I0317 13:36:13.109343 3890461 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.012868072837591171 tr(WHW.T) 274.6131286621094
4_q proxy err 0.0007166017894633114 tr(WHW.T) 6914.9892578125
4_k proxy err 0.0004969867877662182 tr(WHW.T) 10415.33203125
4_o proxy err 0.0075621153227984905 tr(WHW.T) 5.139806270599365
4_up proxy err 0.006654424127191305 tr(WHW.T) 397.6960144042969
4_gate proxy err 0.003420588793233037 tr(WHW.T) 821.1856689453125
4_down proxy err 0.006968516390770674 tr(WHW.T) 11.562739372253418
5_v proxy err 0.012864915654063225 tr(WHW.T) 298.47540283203125
5_q proxy err 0.0007708794437348843 tr(WHW.T) 6770.97509765625
5_k proxy err 0.0005147855263203382 tr(WHW.T) 10841.955078125
5_o proxy err 0.010695712640881538 tr(WHW.T) 7.947142601013184
5_up proxy err 0.006530598271638155 tr(WHW.T) 506.6408386230469
5_gate proxy err 0.003190819174051285 tr(WHW.T) 1104.867919921875
5_down proxy err 0.007336814422160387 tr(WHW.T) 15.6494779586792
I0317 13:36:47.455396 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 8 in 0.9788057804107666s
I0317 13:36:51.337575 3890921 config.py:54] PyTorch version 2.6.0 available.
W0317 13:36:51.688149 3890921 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:36:52.714935 3890921 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:36:52.719100 3888507 quantize_finetune_llama.py:201] layer 9 gpu 1
I0317 13:36:52.882532 3890921 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.012445270083844662 tr(WHW.T) 443.5464782714844
6_q proxy err 0.0009846807224676013 tr(WHW.T) 7576.53857421875
6_k proxy err 0.0007453698199242353 tr(WHW.T) 10409.4033203125
6_o proxy err 0.00979404803365469 tr(WHW.T) 11.564380645751953
6_up proxy err 0.0065412563271820545 tr(WHW.T) 617.2608642578125
6_gate proxy err 0.00280295149423182 tr(WHW.T) 1554.7271728515625
6_down proxy err 0.0075603690929710865 tr(WHW.T) 22.988168716430664
I0317 13:36:57.545623 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 9 in 0.941918134689331s
I0317 13:37:01.398955 3891086 config.py:54] PyTorch version 2.6.0 available.
W0317 13:37:01.689116 3891086 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.012155626900494099 tr(WHW.T) 489.9357604980469
7_q proxy err 0.001053825137205422 tr(WHW.T) 7672.17919921875
7_k proxy err 0.0008093544747680426 tr(WHW.T) 10198.3701171875
7_o proxy err 0.011181565001606941 tr(WHW.T) 15.11335563659668
7_up proxy err 0.006451959256082773 tr(WHW.T) 735.8538818359375
7_gate proxy err 0.002731196815147996 tr(WHW.T) 1876.0390625
7_down proxy err 0.007663724943995476 tr(WHW.T) 30.58672523498535
W0317 13:37:02.672648 3891086 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:37:02.676903 3888507 quantize_finetune_llama.py:201] layer 10 gpu 2
I0317 13:37:02.948610 3891086 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:37:04.058229 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 10 in 0.9228358268737793s
I0317 13:37:07.848213 3891208 config.py:54] PyTorch version 2.6.0 available.
W0317 13:37:08.166597 3891208 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:37:09.123965 3891208 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:37:09.128176 3888507 quantize_finetune_llama.py:201] layer 11 gpu 3
I0317 13:37:09.328412 3891208 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:37:10.851488 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 11 in 1.247375726699829s
I0317 13:37:14.793325 3891329 config.py:54] PyTorch version 2.6.0 available.
W0317 13:37:15.153406 3891329 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:37:16.232443 3891329 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:37:16.237514 3888507 quantize_finetune_llama.py:201] layer 12 gpu 0
I0317 13:37:16.432577 3891329 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.011559875681996346 tr(WHW.T) 530.9967041015625
8_q proxy err 0.0011365583632141352 tr(WHW.T) 7228.1201171875
8_k proxy err 0.0007973565370775759 tr(WHW.T) 10639.1015625
8_o proxy err 0.012717372737824917 tr(WHW.T) 20.092191696166992
8_up proxy err 0.005963590927422047 tr(WHW.T) 866.312744140625
8_gate proxy err 0.002793908817693591 tr(WHW.T) 1970.857177734375
8_down proxy err 0.007649140432476997 tr(WHW.T) 37.177734375
9_v proxy err 0.0109064020216465 tr(WHW.T) 565.0663452148438
9_q proxy err 0.0011803499655798078 tr(WHW.T) 6970.3359375
9_k proxy err 0.0007748555508442223 tr(WHW.T) 10987.3515625
9_o proxy err 0.012691762298345566 tr(WHW.T) 25.610172271728516
9_up proxy err 0.005767041817307472 tr(WHW.T) 970.8984375
9_gate proxy err 0.0027761422097682953 tr(WHW.T) 2132.69384765625
9_down proxy err 0.007678184192627668 tr(WHW.T) 42.99482727050781
I0317 13:37:53.219718 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 12 in 0.9478604793548584s
I0317 13:37:56.949086 3891825 config.py:54] PyTorch version 2.6.0 available.
W0317 13:37:57.283913 3891825 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.011011720634996891 tr(WHW.T) 578.807373046875
10_q proxy err 0.0012185066007077694 tr(WHW.T) 6915.87109375
10_k proxy err 0.0007984335534274578 tr(WHW.T) 10996.2431640625
10_o proxy err 0.01305669080466032 tr(WHW.T) 35.184165954589844
10_up proxy err 0.005459762178361416 tr(WHW.T) 1080.198486328125
10_gate proxy err 0.002742883749306202 tr(WHW.T) 2260.88330078125
10_down proxy err 0.007336527109146118 tr(WHW.T) 52.33584976196289
W0317 13:37:58.324181 3891825 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:37:58.328355 3888507 quantize_finetune_llama.py:201] layer 13 gpu 1
I0317 13:37:58.509400 3891825 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:38:00.085772 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 13 in 0.9286370277404785s
I0317 13:38:03.840703 3891951 config.py:54] PyTorch version 2.6.0 available.
W0317 13:38:04.177625 3891951 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.01045200601220131 tr(WHW.T) 723.1956176757812
11_q proxy err 0.001379278372041881 tr(WHW.T) 7027.10986328125
11_k proxy err 0.0009448148775845766 tr(WHW.T) 10511.23046875
11_o proxy err 0.013247434049844742 tr(WHW.T) 36.654052734375
11_up proxy err 0.005567552987486124 tr(WHW.T) 1139.6044921875
11_gate proxy err 0.0027743764221668243 tr(WHW.T) 2392.716552734375
11_down proxy err 0.0075228516943752766 tr(WHW.T) 56.13530731201172
W0317 13:38:05.178137 3891951 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:38:05.182304 3888507 quantize_finetune_llama.py:201] layer 14 gpu 2
I0317 13:38:05.370498 3891951 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:38:06.749648 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 14 in 0.829765796661377s
I0317 13:38:10.477887 3892083 config.py:54] PyTorch version 2.6.0 available.
W0317 13:38:10.810076 3892083 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:38:11.803047 3892083 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:38:11.807423 3888507 quantize_finetune_llama.py:201] layer 15 gpu 3
I0317 13:38:11.968255 3892083 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:38:13.279034 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 15 in 0.95855712890625s
I0317 13:38:17.185446 3892216 config.py:54] PyTorch version 2.6.0 available.
W0317 13:38:17.549959 3892216 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:38:18.550226 3892216 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:38:18.554435 3888507 quantize_finetune_llama.py:201] layer 16 gpu 0
I0317 13:38:18.791081 3892216 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.010670546442270279 tr(WHW.T) 703.318603515625
12_q proxy err 0.0013855058932676911 tr(WHW.T) 7045.6435546875
12_k proxy err 0.0009218518971465528 tr(WHW.T) 10893.65625
12_o proxy err 0.013455599546432495 tr(WHW.T) 39.29071044921875
12_up proxy err 0.005527305882424116 tr(WHW.T) 1228.298583984375
12_gate proxy err 0.002950586611405015 tr(WHW.T) 2381.994873046875
12_down proxy err 0.0075299376621842384 tr(WHW.T) 64.17745208740234
13_v proxy err 0.010649527423083782 tr(WHW.T) 714.5677490234375
13_q proxy err 0.001392486970871687 tr(WHW.T) 6956.03564453125
13_k proxy err 0.0009532104013487697 tr(WHW.T) 10426.6318359375
13_o proxy err 0.012022670358419418 tr(WHW.T) 45.8377571105957
13_up proxy err 0.005334950517863035 tr(WHW.T) 1367.6221923828125
13_gate proxy err 0.0028918322641402483 tr(WHW.T) 2601.504638671875
13_down proxy err 0.007564968895167112 tr(WHW.T) 79.3589096069336
I0317 13:38:55.893097 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 16 in 0.9759492874145508s
I0317 13:38:59.708229 3892694 config.py:54] PyTorch version 2.6.0 available.
W0317 13:39:00.039156 3892694 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

14_v proxy err 0.011226152069866657 tr(WHW.T) 706.1612548828125
14_q proxy err 0.0014211215311661363 tr(WHW.T) 7077.06103515625
14_k proxy err 0.0009197804611176252 tr(WHW.T) 11295.16796875
14_o proxy err 0.013187654316425323 tr(WHW.T) 50.921180725097656
14_up proxy err 0.005387043114751577 tr(WHW.T) 1464.7159423828125
14_gate proxy err 0.0030228416435420513 tr(WHW.T) 2682.584716796875
14_down proxy err 0.0077327764593064785 tr(WHW.T) 90.28684997558594
W0317 13:39:01.000648 3892694 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:39:01.004772 3888507 quantize_finetune_llama.py:201] layer 17 gpu 1
I0317 13:39:01.156163 3892694 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:39:03.075631 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 17 in 1.1643047332763672s
I0317 13:39:06.939403 3892820 config.py:54] PyTorch version 2.6.0 available.
W0317 13:39:07.246223 3892820 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.010325867682695389 tr(WHW.T) 762.7275390625
15_q proxy err 0.001370732905343175 tr(WHW.T) 7252.0009765625
15_k proxy err 0.0009290797170251608 tr(WHW.T) 11072.3974609375
15_o proxy err 0.0113314688205719 tr(WHW.T) 59.61664962768555
15_up proxy err 0.005261655896902084 tr(WHW.T) 1641.0228271484375
15_gate proxy err 0.003053554566577077 tr(WHW.T) 2905.140380859375
15_down proxy err 0.007736192084848881 tr(WHW.T) 114.09001922607422
W0317 13:39:08.195132 3892820 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:39:08.199328 3888507 quantize_finetune_llama.py:201] layer 18 gpu 2
I0317 13:39:08.354048 3892820 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:39:09.546806 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 18 in 0.8934950828552246s
I0317 13:39:13.260915 3892951 config.py:54] PyTorch version 2.6.0 available.
W0317 13:39:13.591857 3892951 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:39:14.583438 3892951 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:39:14.587603 3888507 quantize_finetune_llama.py:201] layer 19 gpu 3
I0317 13:39:14.747519 3892951 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:39:16.083360 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 19 in 0.9867289066314697s
I0317 13:39:19.949929 3893093 config.py:54] PyTorch version 2.6.0 available.
W0317 13:39:20.287660 3893093 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:39:21.314282 3893093 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:39:21.319276 3888507 quantize_finetune_llama.py:201] layer 20 gpu 0
I0317 13:39:21.514683 3893093 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.010525153018534184 tr(WHW.T) 780.7407836914062
16_q proxy err 0.0014097680104896426 tr(WHW.T) 7193.3974609375
16_k proxy err 0.0009036678238771856 tr(WHW.T) 11630.361328125
16_o proxy err 0.008962171152234077 tr(WHW.T) 88.22785186767578
16_up proxy err 0.005147443152964115 tr(WHW.T) 1890.9385986328125
16_gate proxy err 0.00297885132022202 tr(WHW.T) 3369.859130859375
16_down proxy err 0.007846360094845295 tr(WHW.T) 152.0294952392578
17_v proxy err 0.009900523349642754 tr(WHW.T) 845.7654418945312
17_q proxy err 0.0014296498848125339 tr(WHW.T) 7163.2734375
17_k proxy err 0.0009876659605652094 tr(WHW.T) 10697.431640625
17_o proxy err 0.009777550585567951 tr(WHW.T) 58.14826965332031
17_up proxy err 0.005593222565948963 tr(WHW.T) 1921.07861328125
17_gate proxy err 0.003115655155852437 tr(WHW.T) 3571.31640625
17_down proxy err 0.007765214424580336 tr(WHW.T) 165.43495178222656
I0317 13:39:58.785842 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 20 in 0.9440863132476807s
I0317 13:40:02.542580 3893573 config.py:54] PyTorch version 2.6.0 available.
W0317 13:40:02.857537 3893573 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.009181218221783638 tr(WHW.T) 1003.7705078125
18_q proxy err 0.0014612027443945408 tr(WHW.T) 7510.48046875
18_k proxy err 0.0010737738339230418 tr(WHW.T) 10462.6650390625
18_o proxy err 0.008690166287124157 tr(WHW.T) 69.96558380126953
18_up proxy err 0.005945178214460611 tr(WHW.T) 2023.183837890625
18_gate proxy err 0.003303153207525611 tr(WHW.T) 3783.076416015625
18_down proxy err 0.00779547356069088 tr(WHW.T) 198.52699279785156
W0317 13:40:03.824192 3893573 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:40:03.828155 3888507 quantize_finetune_llama.py:201] layer 21 gpu 1
I0317 13:40:04.000746 3893573 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:40:05.249857 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 21 in 0.9216020107269287s
I0317 13:40:09.110797 3893696 config.py:54] PyTorch version 2.6.0 available.
W0317 13:40:09.463570 3893696 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.008975103497505188 tr(WHW.T) 1019.1412353515625
19_q proxy err 0.0015541785396635532 tr(WHW.T) 6944.4130859375
19_k proxy err 0.0010551470331847668 tr(WHW.T) 10548.4892578125
19_o proxy err 0.008576760068535805 tr(WHW.T) 62.291683197021484
19_up proxy err 0.005977338179945946 tr(WHW.T) 2149.330322265625
19_gate proxy err 0.003618314629420638 tr(WHW.T) 3687.5126953125
19_down proxy err 0.007597452960908413 tr(WHW.T) 222.93177795410156
W0317 13:40:10.445448 3893696 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:40:10.449704 3888507 quantize_finetune_llama.py:201] layer 22 gpu 2
I0317 13:40:10.630022 3893696 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:40:12.428747 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 22 in 0.8958568572998047s
I0317 13:40:16.246557 3893834 config.py:54] PyTorch version 2.6.0 available.
W0317 13:40:16.586013 3893834 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:40:17.654864 3893834 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:40:17.659425 3888507 quantize_finetune_llama.py:201] layer 23 gpu 3
I0317 13:40:17.848308 3893834 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:40:19.266863 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 23 in 1.1355457305908203s
I0317 13:40:23.200942 3893975 config.py:54] PyTorch version 2.6.0 available.
W0317 13:40:23.562806 3893975 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:40:24.605710 3893975 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:40:24.610167 3888507 quantize_finetune_llama.py:201] layer 24 gpu 0
I0317 13:40:24.831362 3893975 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.009332147426903248 tr(WHW.T) 990.5983276367188
20_q proxy err 0.0015217551263049245 tr(WHW.T) 7150.947265625
20_k proxy err 0.0010724483290687203 tr(WHW.T) 10386.2470703125
20_o proxy err 0.006395402364432812 tr(WHW.T) 100.31707000732422
20_up proxy err 0.005852511618286371 tr(WHW.T) 2340.89453125
20_gate proxy err 0.00354342395439744 tr(WHW.T) 4024.62744140625
20_down proxy err 0.007552291266620159 tr(WHW.T) 274.8815002441406
21_v proxy err 0.008983397856354713 tr(WHW.T) 1144.5655517578125
21_q proxy err 0.001679969485849142 tr(WHW.T) 7064.314453125
21_k proxy err 0.0012136505683884025 tr(WHW.T) 9976.4658203125
21_o proxy err 0.00686073862016201 tr(WHW.T) 75.50972747802734
21_up proxy err 0.0061528487130999565 tr(WHW.T) 2361.650390625
21_gate proxy err 0.003788194851949811 tr(WHW.T) 4004.37646484375
21_down proxy err 0.00755580049008131 tr(WHW.T) 276.5857849121094
I0317 13:41:01.568723 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 24 in 1.0700945854187012s
I0317 13:41:05.338021 3894441 config.py:54] PyTorch version 2.6.0 available.
W0317 13:41:05.681914 3894441 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:41:06.740105 3894441 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:41:06.744402 3888507 quantize_finetune_llama.py:201] layer 25 gpu 1
22_v proxy err 0.008623001165688038 tr(WHW.T) 1243.2529296875
22_q proxy err 0.001601860742084682 tr(WHW.T) 7746.84765625
22_k proxy err 0.0011909205932170153 tr(WHW.T) 10603.2041015625
22_o proxy err 0.00580037385225296 tr(WHW.T) 114.30065155029297
22_up proxy err 0.006190252956002951 tr(WHW.T) 2474.510498046875
22_gate proxy err 0.0038568899035453796 tr(WHW.T) 4156.64013671875
22_down proxy err 0.007518981117755175 tr(WHW.T) 311.8800048828125
I0317 13:41:06.901260 3894441 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:41:09.089769 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 25 in 1.0256826877593994s
I0317 13:41:12.961518 3894571 config.py:54] PyTorch version 2.6.0 available.
23_v proxy err 0.007944046519696712 tr(WHW.T) 1486.037353515625
23_q proxy err 0.0018062528688460588 tr(WHW.T) 7346.60986328125
23_k proxy err 0.0013571458403021097 tr(WHW.T) 9982.2392578125
23_o proxy err 0.0070619890466332436 tr(WHW.T) 85.13458251953125
23_up proxy err 0.00641963304951787 tr(WHW.T) 2533.51025390625
23_gate proxy err 0.004137346055358648 tr(WHW.T) 4097.51953125
23_down proxy err 0.0075590829364955425 tr(WHW.T) 321.33892822265625
W0317 13:41:13.294169 3894571 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:41:14.260252 3894571 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:41:14.263963 3888507 quantize_finetune_llama.py:201] layer 26 gpu 2
I0317 13:41:14.414299 3894571 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:41:15.601883 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 26 in 0.8813822269439697s
I0317 13:41:19.400068 3894709 config.py:54] PyTorch version 2.6.0 available.
W0317 13:41:19.728125 3894709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:41:20.763950 3894709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:41:20.768295 3888507 quantize_finetune_llama.py:201] layer 27 gpu 3
I0317 13:41:20.937860 3894709 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:41:22.229323 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 27 in 0.9614086151123047s
I0317 13:41:26.139944 3894844 config.py:54] PyTorch version 2.6.0 available.
W0317 13:41:26.491032 3894844 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:41:27.602473 3894844 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:41:27.607258 3888507 quantize_finetune_llama.py:201] layer 28 gpu 0
I0317 13:41:27.799735 3894844 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.008362612687051296 tr(WHW.T) 1394.900634765625
24_q proxy err 0.001853182795457542 tr(WHW.T) 7020.447265625
24_k proxy err 0.0012905707117170095 tr(WHW.T) 10323.43359375
24_o proxy err 0.005585506558418274 tr(WHW.T) 133.98797607421875
24_up proxy err 0.006509869825094938 tr(WHW.T) 2621.76513671875
24_gate proxy err 0.004173208959400654 tr(WHW.T) 4262.74853515625
24_down proxy err 0.007605116814374924 tr(WHW.T) 340.22412109375
25_v proxy err 0.007664530072361231 tr(WHW.T) 1707.664794921875
25_q proxy err 0.001989910379052162 tr(WHW.T) 7162.16357421875
25_k proxy err 0.0015132715925574303 tr(WHW.T) 9611.58984375
25_o proxy err 0.00669671967625618 tr(WHW.T) 83.535888671875
25_up proxy err 0.006479955278337002 tr(WHW.T) 2805.728515625
25_gate proxy err 0.004062528256326914 tr(WHW.T) 4666.4404296875
25_down proxy err 0.007566938176751137 tr(WHW.T) 373.460693359375
I0317 13:42:04.772411 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 28 in 1.0088257789611816s
I0317 13:42:08.541895 3895316 config.py:54] PyTorch version 2.6.0 available.
W0317 13:42:08.883697 3895316 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.0077296108938753605 tr(WHW.T) 1668.8843994140625
26_q proxy err 0.0018675477476790547 tr(WHW.T) 7469.98291015625
26_k proxy err 0.0013644184218719602 tr(WHW.T) 10487.8740234375
26_o proxy err 0.004687563981860876 tr(WHW.T) 202.88172912597656
26_up proxy err 0.006100425496697426 tr(WHW.T) 3154.75146484375
26_gate proxy err 0.003782308427616954 tr(WHW.T) 5302.16455078125
26_down proxy err 0.007777933031320572 tr(WHW.T) 401.19390869140625
W0317 13:42:09.855732 3895316 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:42:09.859776 3888507 quantize_finetune_llama.py:201] layer 29 gpu 1
I0317 13:42:10.050875 3895316 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:42:11.729072 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 29 in 1.1288557052612305s
I0317 13:42:15.544851 3895446 config.py:54] PyTorch version 2.6.0 available.
W0317 13:42:15.880200 3895446 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.007031252607703209 tr(WHW.T) 1799.3350830078125
27_q proxy err 0.001804929575882852 tr(WHW.T) 7691.708984375
27_k proxy err 0.0013248635223135352 tr(WHW.T) 10618.70703125
27_o proxy err 0.006333501543849707 tr(WHW.T) 126.13690185546875
27_up proxy err 0.005577861797064543 tr(WHW.T) 3691.557861328125
27_gate proxy err 0.0035779362078756094 tr(WHW.T) 5990.82568359375
27_down proxy err 0.007968639023602009 tr(WHW.T) 466.9318542480469
W0317 13:42:16.822897 3895446 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:42:16.826961 3888507 quantize_finetune_llama.py:201] layer 30 gpu 2
I0317 13:42:16.995633 3895446 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:42:18.434601 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 30 in 0.8439528942108154s
I0317 13:42:22.219920 3895592 config.py:54] PyTorch version 2.6.0 available.
W0317 13:42:22.570188 3895592 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:42:23.570648 3895592 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:42:23.574973 3888507 quantize_finetune_llama.py:201] layer 31 gpu 3
I0317 13:42:23.727913 3895592 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 13:42:25.050633 3888507 quantize_finetune_llama.py:232] computed original embedding for layer 31 in 0.9551475048065186s
I0317 13:42:28.859930 3895710 config.py:54] PyTorch version 2.6.0 available.
W0317 13:42:29.198693 3895710 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 13:42:30.216440 3895710 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 13:42:30.472518 3895710 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.006584106013178825 tr(WHW.T) 2018.944091796875
28_q proxy err 0.0018593849381431937 tr(WHW.T) 7651.126953125
28_k proxy err 0.0013787500793114305 tr(WHW.T) 10544.8251953125
28_o proxy err 0.005259383469820023 tr(WHW.T) 194.8240966796875
28_up proxy err 0.004692431073635817 tr(WHW.T) 4661.2666015625
28_gate proxy err 0.0034490274265408516 tr(WHW.T) 6547.48193359375
28_down proxy err 0.008039696142077446 tr(WHW.T) 603.8403930664062
29_v proxy err 0.00697007542476058 tr(WHW.T) 1801.7730712890625
29_q proxy err 0.0018446998437866569 tr(WHW.T) 7227.0009765625
29_k proxy err 0.0012898142449557781 tr(WHW.T) 10558.609375
29_o proxy err 0.004453609697520733 tr(WHW.T) 207.9054412841797
29_up proxy err 0.0037763987202197313 tr(WHW.T) 6070.0498046875
29_gate proxy err 0.003188877599313855 tr(WHW.T) 7369.6142578125
29_down proxy err 0.008160428144037724 tr(WHW.T) 782.2448120117188
30_v proxy err 0.005766939837485552 tr(WHW.T) 2261.489501953125
30_q proxy err 0.001754432450979948 tr(WHW.T) 7815.9453125
30_k proxy err 0.0013314893003553152 tr(WHW.T) 10521.625
30_o proxy err 0.004684212617576122 tr(WHW.T) 251.96908569335938
30_up proxy err 0.002363526029512286 tr(WHW.T) 10016.376953125
30_gate proxy err 0.0022030933760106564 tr(WHW.T) 11001.119140625
30_down proxy err 0.004764528013765812 tr(WHW.T) 3582.617919921875
31_v proxy err 0.0067184483632445335 tr(WHW.T) 1268.2034912109375
31_q proxy err 0.0013890541158616543 tr(WHW.T) 6858.09130859375
31_k proxy err 0.0009696942870505154 tr(WHW.T) 10233.677734375
31_o proxy err 0.003540970617905259 tr(WHW.T) 457.7950744628906
31_up proxy err 0.0013916912721469998 tr(WHW.T) 14563.890625
31_gate proxy err 0.0013955553295090795 tr(WHW.T) 14836.2939453125
31_down proxy err 0.003348671132698655 tr(WHW.T) 17873.55859375
