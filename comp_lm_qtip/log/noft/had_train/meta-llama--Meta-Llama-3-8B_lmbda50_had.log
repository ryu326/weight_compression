I0317 14:35:56.061232 3938235 config.py:54] PyTorch version 2.6.0 available.
W0317 14:35:56.342008 3938235 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:35:57.227777 3938235 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.28it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.96it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.13it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.22it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.27it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.30it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.92it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.03it/s]
I0317 14:35:58.667351 3938235 quantize_finetune_llama.py:144] loaded model
I0317 14:35:58.946428 3938235 quantize_finetune_llama.py:178] loaded compression model
I0317 14:36:16.365099 3938235 quantize_finetune_llama.py:182] loaded dataset and devset
I0317 14:36:22.033572 3938235 quantize_finetune_llama.py:202] layer 0 gpu 0
I0317 14:36:23.947317 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 0 in 1.7661187648773193s
tensor(0.0125, device='cuda:0') tensor(5.7775e-08, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0317 14:36:36.898625 3938870 config.py:54] PyTorch version 2.6.0 available.
W0317 14:36:37.179896 3938870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:36:38.067770 3938870 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:36:38.071763 3938235 quantize_finetune_llama.py:202] layer 1 gpu 1
I0317 14:36:38.212336 3938870 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:36:40.152092 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 1 in 1.9110262393951416s
I0317 14:36:43.663118 3939054 config.py:54] PyTorch version 2.6.0 available.
W0317 14:36:43.948777 3939054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:36:44.871705 3939054 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:36:44.875668 3938235 quantize_finetune_llama.py:202] layer 2 gpu 2
I0317 14:36:45.152051 3939054 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:36:47.096842 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 2 in 2.0847573280334473s
I0317 14:36:50.768110 3939200 config.py:54] PyTorch version 2.6.0 available.
W0317 14:36:51.117543 3939200 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:36:52.089141 3939200 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:36:52.093144 3938235 quantize_finetune_llama.py:202] layer 3 gpu 3
I0317 14:36:52.269377 3939200 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:36:56.667797 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 3 in 4.4179017543792725s
I0317 14:37:00.615193 3939363 config.py:54] PyTorch version 2.6.0 available.
W0317 14:37:00.970614 3939363 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:37:02.089851 3939363 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:37:02.094418 3938235 quantize_finetune_llama.py:202] layer 4 gpu 0
I0317 14:37:02.252268 3939363 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.1386098861694336 tr(WHW.T) 1.3175290822982788
bpp_loss 2.7742018699645996
0_q proxy err 0.0002656123833730817 tr(WHW.T) 6234.0732421875
bpp_loss 3.8588322401046753
0_k proxy err 0.0001868021790869534 tr(WHW.T) 2167.80859375
bpp_loss 4.746157646179199
0_o proxy err 0.011284836567938328 tr(WHW.T) 0.23014844954013824
bpp_loss 2.8429445028305054
0_up proxy err 0.014495578594505787 tr(WHW.T) 101.63945007324219
bpp_loss 3.1147232055664062
0_gate proxy err 0.00850419420748949 tr(WHW.T) 179.7012481689453
bpp_loss 3.220501491001674
0_down proxy err 0.01202414557337761 tr(WHW.T) 0.4814107418060303
bpp_loss 3.1122327532087053
1_v proxy err 0.07874543219804764 tr(WHW.T) 5.699800491333008
bpp_loss 2.869367837905884
1_q proxy err 0.00042930649942718446 tr(WHW.T) 7568.30322265625
bpp_loss 3.940972089767456
1_k proxy err 0.00023145390150602907 tr(WHW.T) 3947.4990234375
bpp_loss 4.811168432235718
1_o proxy err 0.017857711762189865 tr(WHW.T) 0.31429046392440796
bpp_loss 2.926482915878296
1_up proxy err 0.015746334567666054 tr(WHW.T) 159.80691528320312
bpp_loss 3.1299562454223633
1_gate proxy err 0.009610178880393505 tr(WHW.T) 270.8945617675781
bpp_loss 3.2346770422799245
1_down proxy err 0.009118573740124702 tr(WHW.T) 67.10472869873047
bpp_loss 3.126441274370466
I0317 14:37:43.594370 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 4 in 0.9055171012878418s
I0317 14:37:47.353379 3939906 config.py:54] PyTorch version 2.6.0 available.
W0317 14:37:47.672580 3939906 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:37:48.688867 3939906 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:37:48.692998 3938235 quantize_finetune_llama.py:202] layer 5 gpu 1
I0317 14:37:48.848346 3939906 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.05436529219150543 tr(WHW.T) 26.839576721191406
bpp_loss 2.7747554779052734
2_q proxy err 0.0011756779858842492 tr(WHW.T) 7137.59423828125
bpp_loss 3.843184471130371
2_k proxy err 0.0006379132391884923 tr(WHW.T) 3891.808349609375
bpp_loss 4.8722639083862305
2_o proxy err 0.017798585817217827 tr(WHW.T) 0.5573468804359436
bpp_loss 2.8701926469802856
2_up proxy err 0.01701301895081997 tr(WHW.T) 225.9742889404297
bpp_loss 3.125019073486328
2_gate proxy err 0.00895660649985075 tr(WHW.T) 449.3431091308594
bpp_loss 3.2683699471609935
2_down proxy err 0.016786182299256325 tr(WHW.T) 1.2005821466445923
bpp_loss 3.128309999193464
I0317 14:37:51.077406 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 5 in 0.9333887100219727s
I0317 14:37:54.932125 3940036 config.py:54] PyTorch version 2.6.0 available.
W0317 14:37:55.267686 3940036 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:37:56.240565 3940036 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:37:56.244704 3938235 quantize_finetune_llama.py:202] layer 6 gpu 2
I0317 14:37:56.466870 3940036 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.030352823436260223 tr(WHW.T) 40.46714782714844
bpp_loss 2.868023157119751
3_q proxy err 0.0010471229907125235 tr(WHW.T) 6654.2763671875
bpp_loss 3.85178279876709
3_k proxy err 0.0005591970984824002 tr(WHW.T) 3660.859619140625
bpp_loss 4.870026111602783
3_o proxy err 0.01922224834561348 tr(WHW.T) 0.9357947707176208
bpp_loss 2.964675784111023
3_up proxy err 0.01708279177546501 tr(WHW.T) 316.0293273925781
bpp_loss 3.105944905962263
3_gate proxy err 0.006645294837653637 tr(WHW.T) 875.7510375976562
bpp_loss 3.344419206891741
3_down proxy err 0.018365057185292244 tr(WHW.T) 2.1166555881500244
bpp_loss 3.104037012372698
I0317 14:38:00.370487 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 6 in 0.9518759250640869s
I0317 14:38:04.090812 3940196 config.py:54] PyTorch version 2.6.0 available.
W0317 14:38:04.434360 3940196 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:38:05.461329 3940196 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:38:05.465596 3938235 quantize_finetune_llama.py:202] layer 7 gpu 3
I0317 14:38:05.672405 3940196 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:38:06.896740 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 7 in 0.9301297664642334s
I0317 14:38:10.882465 3940321 config.py:54] PyTorch version 2.6.0 available.
W0317 14:38:11.324953 3940321 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:38:12.442073 3940321 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:38:12.446602 3938235 quantize_finetune_llama.py:202] layer 8 gpu 0
I0317 14:38:12.654464 3940321 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.030413417145609856 tr(WHW.T) 38.379119873046875
bpp_loss 2.918811798095703
4_q proxy err 0.0009993569692596793 tr(WHW.T) 6741.380859375
bpp_loss 3.827162265777588
4_k proxy err 0.0005023143603466451 tr(WHW.T) 3941.660888671875
bpp_loss 4.819032192230225
4_o proxy err 0.027485404163599014 tr(WHW.T) 1.3690094947814941
bpp_loss 2.9828426837921143
4_up proxy err 0.017345257103443146 tr(WHW.T) 400.241455078125
bpp_loss 3.080660138811384
4_gate proxy err 0.004898637533187866 tr(WHW.T) 1579.121337890625
bpp_loss 3.4185232434953963
4_down proxy err 0.01995779573917389 tr(WHW.T) 3.4171695709228516
bpp_loss 3.07905844279698
5_v proxy err 0.04074892774224281 tr(WHW.T) 37.700050354003906
bpp_loss 2.804002523422241
5_q proxy err 0.0013368785148486495 tr(WHW.T) 6497.876953125
bpp_loss 3.8162124156951904
5_k proxy err 0.0006243288516998291 tr(WHW.T) 4151.98193359375
bpp_loss 4.830522775650024
5_o proxy err 0.03337785229086876 tr(WHW.T) 1.811954379081726
bpp_loss 2.923314094543457
5_up proxy err 0.016742229461669922 tr(WHW.T) 497.45538330078125
bpp_loss 3.0862925393240794
5_gate proxy err 0.004698324017226696 tr(WHW.T) 1974.3070068359375
bpp_loss 3.4179127556937083
5_down proxy err 0.01994224824011326 tr(WHW.T) 4.908621311187744
bpp_loss 3.083325590406145
I0317 14:38:54.968496 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 8 in 1.374359130859375s
I0317 14:38:58.742095 3940948 config.py:54] PyTorch version 2.6.0 available.
W0317 14:38:59.087095 3940948 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:39:00.131136 3940948 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:39:00.135854 3938235 quantize_finetune_llama.py:202] layer 9 gpu 1
I0317 14:39:00.300210 3940948 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.03425805643200874 tr(WHW.T) 42.837894439697266
bpp_loss 2.8515994548797607
6_q proxy err 0.0013618172379210591 tr(WHW.T) 6019.40673828125
bpp_loss 3.854358673095703
6_k proxy err 0.0005493867211043835 tr(WHW.T) 4418.95361328125
bpp_loss 4.827740907669067
6_o proxy err 0.0350022129714489 tr(WHW.T) 2.5981621742248535
bpp_loss 2.955060839653015
6_up proxy err 0.016210949048399925 tr(WHW.T) 571.950927734375
bpp_loss 3.0860046659197127
6_gate proxy err 0.00403076596558094 tr(WHW.T) 2580.455078125
bpp_loss 3.4256200790405273
6_down proxy err 0.019691789522767067 tr(WHW.T) 6.227621078491211
bpp_loss 3.0828232765197754
I0317 14:39:04.182957 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 9 in 1.1147840023040771s
I0317 14:39:07.929787 3941106 config.py:54] PyTorch version 2.6.0 available.
W0317 14:39:08.246004 3941106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

7_v proxy err 0.02753414772450924 tr(WHW.T) 53.14668655395508
bpp_loss 2.846553921699524
7_q proxy err 0.0013523640809580684 tr(WHW.T) 6036.439453125
bpp_loss 3.775355100631714
7_k proxy err 0.0005498145474120975 tr(WHW.T) 4611.79638671875
bpp_loss 4.854792594909668
7_o proxy err 0.03685362637042999 tr(WHW.T) 3.787719964981079
bpp_loss 2.9682687520980835
7_up proxy err 0.014929492957890034 tr(WHW.T) 651.590087890625
bpp_loss 3.0996642793927873
7_gate proxy err 0.0041098808869719505 tr(WHW.T) 2636.09716796875
bpp_loss 3.3993400846208846
7_down proxy err 0.019595367833971977 tr(WHW.T) 6.803934574127197
bpp_loss 3.0968150751931325
W0317 14:39:09.146259 3941106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:39:09.149935 3938235 quantize_finetune_llama.py:202] layer 10 gpu 2
I0317 14:39:09.373064 3941106 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:39:10.716925 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 10 in 0.8648712635040283s
I0317 14:39:14.248625 3941228 config.py:54] PyTorch version 2.6.0 available.
W0317 14:39:14.572696 3941228 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:39:15.544551 3941228 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:39:15.548604 3938235 quantize_finetune_llama.py:202] layer 11 gpu 3
I0317 14:39:15.701990 3941228 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:39:16.982222 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 11 in 0.9577429294586182s
I0317 14:39:20.892024 3941346 config.py:54] PyTorch version 2.6.0 available.
W0317 14:39:21.253826 3941346 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:39:22.339557 3941346 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:39:22.343687 3938235 quantize_finetune_llama.py:202] layer 12 gpu 0
I0317 14:39:22.513565 3941346 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.03336407244205475 tr(WHW.T) 53.42280197143555
bpp_loss 2.876846671104431
8_q proxy err 0.0017441838281229138 tr(WHW.T) 5514.4345703125
bpp_loss 3.781462788581848
8_k proxy err 0.0006374720833264291 tr(WHW.T) 4670.25390625
bpp_loss 4.829620122909546
8_o proxy err 0.047507546842098236 tr(WHW.T) 3.732954978942871
bpp_loss 2.983566999435425
8_up proxy err 0.015154842287302017 tr(WHW.T) 668.69921875
bpp_loss 3.0952378681727817
8_gate proxy err 0.003864638740196824 tr(WHW.T) 2931.24951171875
bpp_loss 3.4059886932373047
8_down proxy err 0.019724644720554352 tr(WHW.T) 7.259360313415527
bpp_loss 3.093604734965733
9_v proxy err 0.025401325896382332 tr(WHW.T) 72.69827270507812
bpp_loss 2.9861644506454468
9_q proxy err 0.0018103248439729214 tr(WHW.T) 5306.75244140625
bpp_loss 3.7819414138793945
9_k proxy err 0.0006820200360380113 tr(WHW.T) 4332.2958984375
bpp_loss 4.826103448867798
9_o proxy err 0.0461370013654232 tr(WHW.T) 4.439431190490723
bpp_loss 3.0423117876052856
9_up proxy err 0.014408024027943611 tr(WHW.T) 723.7196655273438
bpp_loss 3.104131289890834
9_gate proxy err 0.003677906235679984 tr(WHW.T) 3179.91943359375
bpp_loss 3.423353467668806
9_down proxy err 0.02042928896844387 tr(WHW.T) 8.003087043762207
bpp_loss 3.0967166083199635
I0317 14:40:07.964831 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 12 in 1.0551326274871826s
I0317 14:40:11.787453 3941953 config.py:54] PyTorch version 2.6.0 available.
W0317 14:40:12.126618 3941953 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.03468331694602966 tr(WHW.T) 60.08286666870117
bpp_loss 2.868399739265442
10_q proxy err 0.001982255605980754 tr(WHW.T) 5567.93798828125
bpp_loss 3.8163477182388306
10_k proxy err 0.000722202705219388 tr(WHW.T) 4710.4462890625
bpp_loss 4.856057643890381
10_o proxy err 0.051791273057460785 tr(WHW.T) 4.188048362731934
bpp_loss 2.9742332696914673
10_up proxy err 0.014090008102357388 tr(WHW.T) 749.0687255859375
bpp_loss 3.119977133614676
10_gate proxy err 0.003836641553789377 tr(WHW.T) 3045.35498046875
bpp_loss 3.389021737234933
10_down proxy err 0.01969861052930355 tr(WHW.T) 8.42132568359375
bpp_loss 3.110987969807216
W0317 14:40:13.143394 3941953 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:40:13.147595 3938235 quantize_finetune_llama.py:202] layer 13 gpu 1
I0317 14:40:13.298205 3941953 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:40:15.372311 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 13 in 1.4987027645111084s
I0317 14:40:19.191012 3942099 config.py:54] PyTorch version 2.6.0 available.
11_v proxy err 0.02710983343422413 tr(WHW.T) 74.2698974609375
bpp_loss 2.861513137817383
11_q proxy err 0.00204488355666399 tr(WHW.T) 5157.30615234375
bpp_loss 3.719138503074646
11_k proxy err 0.0007822044426575303 tr(WHW.T) 4189.68798828125
bpp_loss 4.8170006275177
11_o proxy err 0.06307462602853775 tr(WHW.T) 4.454066753387451
bpp_loss 2.9917935132980347
11_up proxy err 0.014120092615485191 tr(WHW.T) 789.370361328125
bpp_loss 3.1268136160714284
11_gate proxy err 0.003880638163536787 tr(WHW.T) 3167.24609375
bpp_loss 3.371894972664969
11_down proxy err 0.01935730315744877 tr(WHW.T) 9.071778297424316
bpp_loss 3.1188303402491977
W0317 14:40:19.488747 3942099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:40:20.380086 3942099 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:40:20.383760 3938235 quantize_finetune_llama.py:202] layer 14 gpu 2
I0317 14:40:20.569802 3942099 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:40:22.561240 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 14 in 1.7285189628601074s
I0317 14:40:26.209951 3942267 config.py:54] PyTorch version 2.6.0 available.
W0317 14:40:26.503577 3942267 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:40:27.519410 3942267 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:40:27.523592 3938235 quantize_finetune_llama.py:202] layer 15 gpu 3
I0317 14:40:27.774805 3942267 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:40:29.167867 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 15 in 1.1268556118011475s
I0317 14:40:32.976969 3942397 config.py:54] PyTorch version 2.6.0 available.
W0317 14:40:33.332134 3942397 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:40:34.457563 3942397 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:40:34.462132 3938235 quantize_finetune_llama.py:202] layer 16 gpu 0
I0317 14:40:34.634582 3942397 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.024477144703269005 tr(WHW.T) 68.45218658447266
bpp_loss 2.9797768592834473
12_q proxy err 0.0013825831701979041 tr(WHW.T) 6419.8271484375
bpp_loss 3.742402672767639
12_k proxy err 0.0006212375592440367 tr(WHW.T) 4340.4931640625
bpp_loss 4.745967864990234
12_o proxy err 0.04592985659837723 tr(WHW.T) 5.624481201171875
bpp_loss 3.0393935441970825
12_up proxy err 0.01299675740301609 tr(WHW.T) 855.3871459960938
bpp_loss 3.1471309661865234
12_gate proxy err 0.003823227249085903 tr(WHW.T) 3184.862548828125
bpp_loss 3.356271198817662
12_down proxy err 0.018926797434687614 tr(WHW.T) 10.028186798095703
bpp_loss 3.1344077927725658
13_v proxy err 0.031078534200787544 tr(WHW.T) 71.04966735839844
bpp_loss 2.9197452068328857
13_q proxy err 0.002164676319807768 tr(WHW.T) 5299.77734375
bpp_loss 3.7616533041000366
13_k proxy err 0.0007867589592933655 tr(WHW.T) 4513.97802734375
bpp_loss 4.852068185806274
13_o proxy err 0.05280201509594917 tr(WHW.T) 6.745936870574951
bpp_loss 3.01828932762146
13_up proxy err 0.013042663224041462 tr(WHW.T) 916.3327026367188
bpp_loss 3.15014716557094
13_gate proxy err 0.003684630850329995 tr(WHW.T) 3562.817138671875
bpp_loss 3.3592075620378767
13_down proxy err 0.01966746896505356 tr(WHW.T) 11.704400062561035
bpp_loss 3.134046588625227
I0317 14:41:18.023446 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 16 in 1.0565826892852783s
I0317 14:41:21.740430 3942945 config.py:54] PyTorch version 2.6.0 available.
W0317 14:41:22.094521 3942945 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:41:23.137671 3942945 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:41:23.142572 3938235 quantize_finetune_llama.py:202] layer 17 gpu 1
I0317 14:41:23.321585 3942945 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.03152729198336601 tr(WHW.T) 74.802978515625
bpp_loss 2.9124629497528076
14_q proxy err 0.0021643477957695723 tr(WHW.T) 5552.11865234375
bpp_loss 3.7233173847198486
14_k proxy err 0.0007570254965685308 tr(WHW.T) 4950.54931640625
bpp_loss 4.823306322097778
14_o proxy err 0.05188904330134392 tr(WHW.T) 6.853440761566162
bpp_loss 3.0143030881881714
14_up proxy err 0.0142201604321599 tr(WHW.T) 932.0479736328125
bpp_loss 3.1460674830845425
14_gate proxy err 0.003457278711721301 tr(WHW.T) 4249.7998046875
bpp_loss 3.3926375252859935
14_down proxy err 0.020198868587613106 tr(WHW.T) 13.352071762084961
bpp_loss 3.131723778588431
I0317 14:41:26.383948 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 17 in 1.031083106994629s
I0317 14:41:30.202796 3943095 config.py:54] PyTorch version 2.6.0 available.
W0317 14:41:30.541733 3943095 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

15_v proxy err 0.0311112143099308 tr(WHW.T) 67.86465454101562
bpp_loss 2.9767775535583496
15_q proxy err 0.0016952600562945008 tr(WHW.T) 6709.19140625
bpp_loss 3.909797787666321
15_k proxy err 0.000758862413931638 tr(WHW.T) 4509.14404296875
bpp_loss 4.781402111053467
15_o proxy err 0.04333282634615898 tr(WHW.T) 6.766374111175537
bpp_loss 3.0461095571517944
15_up proxy err 0.014453641138970852 tr(WHW.T) 988.90234375
bpp_loss 3.137611525399344
15_gate proxy err 0.003166383830830455 tr(WHW.T) 5081.40576171875
bpp_loss 3.427704402378627
15_down proxy err 0.020119570195674896 tr(WHW.T) 16.894807815551758
bpp_loss 3.1263725076402937
W0317 14:41:31.465549 3943095 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:41:31.469265 3938235 quantize_finetune_llama.py:202] layer 18 gpu 2
I0317 14:41:31.673335 3943095 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:41:33.189137 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 18 in 1.032386302947998s
I0317 14:41:36.866961 3943221 config.py:54] PyTorch version 2.6.0 available.
W0317 14:41:37.196303 3943221 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:41:38.129513 3943221 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:41:38.133587 3938235 quantize_finetune_llama.py:202] layer 19 gpu 3
I0317 14:41:38.303888 3943221 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:41:39.782351 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 19 in 1.1713716983795166s
I0317 14:41:43.559245 3943343 config.py:54] PyTorch version 2.6.0 available.
W0317 14:41:43.907025 3943343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:41:44.842623 3943343 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:41:44.846790 3938235 quantize_finetune_llama.py:202] layer 20 gpu 0
I0317 14:41:45.023873 3943343 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.03212482109665871 tr(WHW.T) 68.60269165039062
bpp_loss 2.9272055625915527
16_q proxy err 0.0019083927618339658 tr(WHW.T) 6124.5419921875
bpp_loss 3.8416268825531006
16_k proxy err 0.0007247295579873025 tr(WHW.T) 4878.88427734375
bpp_loss 4.802293539047241
16_o proxy err 0.0369843915104866 tr(WHW.T) 7.369767189025879
bpp_loss 3.0246583223342896
16_up proxy err 0.015550336800515652 tr(WHW.T) 981.8323974609375
bpp_loss 3.1231983729771207
16_gate proxy err 0.003545851446688175 tr(WHW.T) 4852.61962890625
bpp_loss 3.461000851222447
16_down proxy err 0.020431488752365112 tr(WHW.T) 17.929277420043945
bpp_loss 3.112723180225917
17_v proxy err 0.031538669019937515 tr(WHW.T) 69.1786880493164
bpp_loss 3.0018460750579834
17_q proxy err 0.0017128362087532878 tr(WHW.T) 6716.68115234375
bpp_loss 3.859222888946533
17_k proxy err 0.0008003926486708224 tr(WHW.T) 4246.078125
bpp_loss 4.82011866569519
17_o proxy err 0.032706476747989655 tr(WHW.T) 6.400019645690918
bpp_loss 3.0567880868911743
17_up proxy err 0.015314202755689621 tr(WHW.T) 1061.9390869140625
bpp_loss 3.119048936026437
17_gate proxy err 0.0035138071980327368 tr(WHW.T) 5241.2060546875
bpp_loss 3.47595637185233
17_down proxy err 0.02070525474846363 tr(WHW.T) 21.307649612426758
bpp_loss 3.111067567552839
I0317 14:42:29.678795 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 20 in 1.31349515914917s
I0317 14:42:33.420954 3943904 config.py:54] PyTorch version 2.6.0 available.
W0317 14:42:33.768745 3943904 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.03059106133878231 tr(WHW.T) 73.61924743652344
bpp_loss 2.9207561016082764
18_q proxy err 0.002057746984064579 tr(WHW.T) 5733.501953125
bpp_loss 3.8272953033447266
18_k proxy err 0.0008130634087137878 tr(WHW.T) 4452.47412109375
bpp_loss 4.893190145492554
18_o proxy err 0.02980050817131996 tr(WHW.T) 4.730301380157471
bpp_loss 3.032428503036499
18_up proxy err 0.016162676736712456 tr(WHW.T) 1055.73193359375
bpp_loss 3.1136471884591237
18_gate proxy err 0.004124862607568502 tr(WHW.T) 4660.94091796875
bpp_loss 3.4791747501918246
18_down proxy err 0.02061786875128746 tr(WHW.T) 21.094728469848633
bpp_loss 3.1077830450875417
W0317 14:42:34.775648 3943904 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:42:34.779960 3938235 quantize_finetune_llama.py:202] layer 21 gpu 1
I0317 14:42:34.964296 3943904 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:42:36.720508 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 21 in 0.9384939670562744s
I0317 14:42:40.613156 3944150 config.py:54] PyTorch version 2.6.0 available.
W0317 14:42:40.936871 3944150 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.025934850797057152 tr(WHW.T) 87.24554443359375
bpp_loss 2.964092254638672
19_q proxy err 0.0019219963578507304 tr(WHW.T) 6149.10400390625
bpp_loss 3.8305925130844116
19_k proxy err 0.0008975958335213363 tr(WHW.T) 3978.64404296875
bpp_loss 4.775564193725586
19_o proxy err 0.030812904238700867 tr(WHW.T) 3.9390149116516113
bpp_loss 3.0436935424804688
19_up proxy err 0.016839846968650818 tr(WHW.T) 1067.85498046875
bpp_loss 3.1096604210989818
19_gate proxy err 0.004429739899933338 tr(WHW.T) 4580.61328125
bpp_loss 3.4882287979125977
19_down proxy err 0.02073371410369873 tr(WHW.T) 21.985567092895508
bpp_loss 3.1055755274636403
W0317 14:42:41.839843 3944150 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:42:41.843931 3938235 quantize_finetune_llama.py:202] layer 22 gpu 2
I0317 14:42:41.994055 3944150 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:42:43.156261 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 22 in 0.7972979545593262s
I0317 14:42:46.864938 3944285 config.py:54] PyTorch version 2.6.0 available.
W0317 14:42:47.179451 3944285 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:42:48.109618 3944285 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:42:48.113921 3938235 quantize_finetune_llama.py:202] layer 23 gpu 3
I0317 14:42:48.294173 3944285 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:42:49.618904 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 23 in 0.9940931797027588s
I0317 14:42:53.502217 3944427 config.py:54] PyTorch version 2.6.0 available.
W0317 14:42:53.865815 3944427 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:42:54.975926 3944427 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:42:54.980177 3938235 quantize_finetune_llama.py:202] layer 24 gpu 0
I0317 14:42:55.163370 3944427 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.02706499956548214 tr(WHW.T) 90.61302185058594
bpp_loss 3.003406286239624
20_q proxy err 0.0022092086728662252 tr(WHW.T) 5690.95703125
bpp_loss 3.8092684745788574
20_k proxy err 0.0008887908770702779 tr(WHW.T) 4224.9970703125
bpp_loss 4.736172199249268
20_o proxy err 0.029831107705831528 tr(WHW.T) 4.07815408706665
bpp_loss 3.034341812133789
20_up proxy err 0.01694464311003685 tr(WHW.T) 1127.5106201171875
bpp_loss 3.1129729407174245
20_gate proxy err 0.004720792174339294 tr(WHW.T) 4549.56396484375
bpp_loss 3.4880662645612444
20_down proxy err 0.02036263234913349 tr(WHW.T) 23.935516357421875
bpp_loss 3.1092831747872487
21_v proxy err 0.024717846885323524 tr(WHW.T) 95.41011047363281
bpp_loss 3.0313923358917236
21_q proxy err 0.0018013761145994067 tr(WHW.T) 6793.60595703125
bpp_loss 3.787479281425476
21_k proxy err 0.0008270341204479337 tr(WHW.T) 4413.91943359375
bpp_loss 4.756040334701538
21_o proxy err 0.02862139418721199 tr(WHW.T) 7.5875244140625
bpp_loss 3.056206703186035
21_up proxy err 0.016594616696238518 tr(WHW.T) 1237.0894775390625
bpp_loss 3.1160121645246233
21_gate proxy err 0.00460770633071661 tr(WHW.T) 5024.13427734375
bpp_loss 3.50032411302839
21_down proxy err 0.02022230438888073 tr(WHW.T) 29.1324520111084
bpp_loss 3.112116609300886
I0317 14:43:40.149697 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 24 in 0.9932489395141602s
I0317 14:43:44.031560 3945033 config.py:54] PyTorch version 2.6.0 available.
W0317 14:43:44.374042 3945033 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v proxy err 0.026169385761022568 tr(WHW.T) 101.29380798339844
bpp_loss 3.079184412956238
22_q proxy err 0.0022088750265538692 tr(WHW.T) 5947.34326171875
bpp_loss 3.740138530731201
22_k proxy err 0.0009302423568442464 tr(WHW.T) 4309.5947265625
bpp_loss 4.697230815887451
22_o proxy err 0.029623107984662056 tr(WHW.T) 5.007936954498291
bpp_loss 3.07279634475708
22_up proxy err 0.01710018329322338 tr(WHW.T) 1249.8564453125
bpp_loss 3.119227409362793
22_gate proxy err 0.004905782174319029 tr(WHW.T) 4890.96826171875
bpp_loss 3.500218527657645
22_down proxy err 0.01969374530017376 tr(WHW.T) 30.777225494384766
bpp_loss 3.115551403590611
W0317 14:43:45.372137 3945033 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:43:45.376360 3938235 quantize_finetune_llama.py:202] layer 25 gpu 1
I0317 14:43:45.581434 3945033 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:43:47.339253 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 25 in 1.4002699851989746s
I0317 14:43:51.195953 3945176 config.py:54] PyTorch version 2.6.0 available.
W0317 14:43:51.496282 3945176 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

23_v proxy err 0.023158177733421326 tr(WHW.T) 112.7859115600586
bpp_loss 3.130786180496216
23_q proxy err 0.0020293360576033592 tr(WHW.T) 6408.4541015625
bpp_loss 3.7479686737060547
23_k proxy err 0.0009135480504482985 tr(WHW.T) 4211.31982421875
bpp_loss 4.687871694564819
23_o proxy err 0.02095482498407364 tr(WHW.T) 6.165833473205566
bpp_loss 3.0910369157791138
23_up proxy err 0.0174026507884264 tr(WHW.T) 1298.444580078125
bpp_loss 3.1232517787388394
23_gate proxy err 0.005290971137583256 tr(WHW.T) 4776.34521484375
bpp_loss 3.5025242396763394
23_down proxy err 0.01930094324052334 tr(WHW.T) 32.75361633300781
bpp_loss 3.119807686124529
W0317 14:43:52.429084 3945176 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:43:52.433233 3938235 quantize_finetune_llama.py:202] layer 26 gpu 2
I0317 14:43:52.629339 3945176 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:43:53.998688 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 26 in 1.1129405498504639s
I0317 14:43:57.760059 3945309 config.py:54] PyTorch version 2.6.0 available.
W0317 14:43:58.071196 3945309 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:43:59.134920 3945309 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:43:59.139167 3938235 quantize_finetune_llama.py:202] layer 27 gpu 3
I0317 14:43:59.304725 3945309 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:44:00.800429 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 27 in 1.217872142791748s
I0317 14:44:04.594784 3945440 config.py:54] PyTorch version 2.6.0 available.
W0317 14:44:04.936298 3945440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:44:05.975102 3945440 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:44:05.980072 3938235 quantize_finetune_llama.py:202] layer 28 gpu 0
I0317 14:44:06.161035 3945440 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.020276635885238647 tr(WHW.T) 136.39785766601562
bpp_loss 3.233681797981262
24_q proxy err 0.0020250410307198763 tr(WHW.T) 6549.06396484375
bpp_loss 3.71830952167511
24_k proxy err 0.0009568261448293924 tr(WHW.T) 4140.12353515625
bpp_loss 4.551769018173218
24_o proxy err 0.02322818711400032 tr(WHW.T) 6.529373645782471
bpp_loss 3.1364978551864624
24_up proxy err 0.017679208889603615 tr(WHW.T) 1342.69384765625
bpp_loss 3.127758707318987
24_gate proxy err 0.005583775229752064 tr(WHW.T) 4752.36767578125
bpp_loss 3.5089683532714844
24_down proxy err 0.019098995253443718 tr(WHW.T) 34.95817947387695
bpp_loss 3.1247897488730296
25_v proxy err 0.016973180696368217 tr(WHW.T) 164.04367065429688
bpp_loss 3.2411755323410034
25_q proxy err 0.0017621598672121763 tr(WHW.T) 7679.1796875
bpp_loss 3.690479040145874
25_k proxy err 0.0009379350813105702 tr(WHW.T) 4239.72509765625
bpp_loss 4.538304567337036
25_o proxy err 0.018540289252996445 tr(WHW.T) 8.825087547302246
bpp_loss 3.1416205167770386
25_up proxy err 0.017536882311105728 tr(WHW.T) 1428.771728515625
bpp_loss 3.136691093444824
25_gate proxy err 0.0055122035555541515 tr(WHW.T) 5091.62109375
bpp_loss 3.519711358206613
25_down proxy err 0.01951799914240837 tr(WHW.T) 37.920631408691406
bpp_loss 3.133596249989101
I0317 14:44:50.296037 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 28 in 1.203801155090332s
I0317 14:44:54.111001 3946021 config.py:54] PyTorch version 2.6.0 available.
W0317 14:44:54.453649 3946021 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.02176426164805889 tr(WHW.T) 123.81900024414062
bpp_loss 3.3021494150161743
26_q proxy err 0.002111544832587242 tr(WHW.T) 6098.626953125
bpp_loss 3.7029197216033936
26_k proxy err 0.0008833977044560015 tr(WHW.T) 4395.34912109375
bpp_loss 4.624699831008911
26_o proxy err 0.015650371089577675 tr(WHW.T) 16.217060089111328
bpp_loss 3.163187623023987
26_up proxy err 0.016981713473796844 tr(WHW.T) 1584.1817626953125
bpp_loss 3.1452366965157643
26_gate proxy err 0.005042521748691797 tr(WHW.T) 5988.38671875
bpp_loss 3.53048528943743
26_down proxy err 0.019567381590604782 tr(WHW.T) 43.263404846191406
bpp_loss 3.1423489366258894
W0317 14:44:55.451431 3946021 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:44:55.455466 3938235 quantize_finetune_llama.py:202] layer 29 gpu 1
I0317 14:44:55.628128 3946021 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:44:57.587802 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 29 in 1.2453677654266357s
I0317 14:45:01.404887 3946144 config.py:54] PyTorch version 2.6.0 available.
W0317 14:45:01.743245 3946144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

27_v proxy err 0.014641833491623402 tr(WHW.T) 203.18115234375
bpp_loss 3.3978893756866455
27_q proxy err 0.0021179132163524628 tr(WHW.T) 6387.7978515625
bpp_loss 3.674344539642334
27_k proxy err 0.0009773188503459096 tr(WHW.T) 4200.8603515625
bpp_loss 4.593660593032837
27_o proxy err 0.017370551824569702 tr(WHW.T) 16.170616149902344
bpp_loss 3.1922320127487183
27_up proxy err 0.015400613658130169 tr(WHW.T) 1872.3875732421875
bpp_loss 3.158820424761091
27_gate proxy err 0.004474285989999771 tr(WHW.T) 7248.0146484375
bpp_loss 3.543260029384068
27_down proxy err 0.019863201305270195 tr(WHW.T) 61.20230484008789
bpp_loss 3.1542459215436662
W0317 14:45:02.677311 3946144 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:45:02.681087 3938235 quantize_finetune_llama.py:202] layer 30 gpu 2
I0317 14:45:02.840519 3946144 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:45:04.662366 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 30 in 1.2387444972991943s
I0317 14:45:08.357708 3946284 config.py:54] PyTorch version 2.6.0 available.
W0317 14:45:08.659492 3946284 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:45:09.600473 3946284 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:45:09.604569 3938235 quantize_finetune_llama.py:202] layer 31 gpu 3
I0317 14:45:09.795500 3946284 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:45:11.404791 3938235 quantize_finetune_llama.py:233] computed original embedding for layer 31 in 1.3398613929748535s
I0317 14:45:15.190324 3946413 config.py:54] PyTorch version 2.6.0 available.
W0317 14:45:15.530583 3946413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:45:16.510895 3946413 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:45:16.726637 3946413 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.016492459923028946 tr(WHW.T) 175.40757751464844
bpp_loss 3.450660228729248
28_q proxy err 0.0019518843619152904 tr(WHW.T) 6755.15673828125
bpp_loss 3.6750755310058594
28_k proxy err 0.0008910585311241448 tr(WHW.T) 4372.6787109375
bpp_loss 4.465998411178589
28_o proxy err 0.015079083852469921 tr(WHW.T) 24.542436599731445
bpp_loss 3.2222007513046265
28_up proxy err 0.012850887142121792 tr(WHW.T) 2478.37158203125
bpp_loss 3.1813599722726003
28_gate proxy err 0.004092777147889137 tr(WHW.T) 8688.7451171875
bpp_loss 3.5339843205043246
28_down proxy err 0.018088223412632942 tr(WHW.T) 82.2515869140625
bpp_loss 3.172600405556815
29_v proxy err 0.011874331161379814 tr(WHW.T) 249.68582153320312
bpp_loss 3.5135271549224854
29_q proxy err 0.0021764636039733887 tr(WHW.T) 6063.7841796875
bpp_loss 3.6649842262268066
29_k proxy err 0.0008297049789689481 tr(WHW.T) 4804.99560546875
bpp_loss 4.586584091186523
29_o proxy err 0.012394895777106285 tr(WHW.T) 36.6841926574707
bpp_loss 3.2621692419052124
29_up proxy err 0.010332727804780006 tr(WHW.T) 3248.7060546875
bpp_loss 3.212289265223912
29_gate proxy err 0.003843315877020359 tr(WHW.T) 9685.2646484375
bpp_loss 3.529742649623326
29_down proxy err 0.017478015273809433 tr(WHW.T) 132.4029083251953
bpp_loss 3.19259660584586
30_v proxy err 0.012583049945533276 tr(WHW.T) 252.81202697753906
bpp_loss 3.821864366531372
30_q proxy err 0.0018632878782227635 tr(WHW.T) 7045.02978515625
bpp_loss 3.5856218338012695
30_k proxy err 0.0009466151823289692 tr(WHW.T) 4109.9091796875
bpp_loss 4.25593113899231
30_o proxy err 0.008118505589663982 tr(WHW.T) 84.08126831054688
bpp_loss 3.348155975341797
30_up proxy err 0.006275628227740526 tr(WHW.T) 5513.9267578125
bpp_loss 3.241438729422433
30_gate proxy err 0.00291457655839622 tr(WHW.T) 13194.7158203125
bpp_loss 3.58444459097726
30_down proxy err 0.014929116703569889 tr(WHW.T) 368.5621032714844
bpp_loss 3.2006369658878873
31_v proxy err 0.0058048442006111145 tr(WHW.T) 365.68487548828125
bpp_loss 3.6182903051376343
31_q proxy err 0.0010678995167836547 tr(WHW.T) 9335.7197265625
bpp_loss 3.7448625564575195
31_k proxy err 0.0006786640733480453 tr(WHW.T) 4138.115234375
bpp_loss 4.465567588806152
31_o proxy err 0.01764487661421299 tr(WHW.T) 182.20681762695312
bpp_loss 3.331218957901001
31_up proxy err 0.002197536174207926 tr(WHW.T) 12277.7177734375
bpp_loss 3.435886791774205
31_gate proxy err 0.001181132858619094 tr(WHW.T) 25696.34765625
bpp_loss 3.81026976449149
31_down proxy err 0.013354729861021042 tr(WHW.T) 2762.8974609375
bpp_loss 3.237193618501936
