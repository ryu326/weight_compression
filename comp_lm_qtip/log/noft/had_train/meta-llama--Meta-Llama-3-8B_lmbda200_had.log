I0317 14:58:46.319600 3956246 config.py:54] PyTorch version 2.6.0 available.
W0317 14:58:46.599940 3956246 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:58:47.509454 3956246 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.05it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.75it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.99it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.13it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.23it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.27it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.96it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.99it/s]
I0317 14:58:48.955030 3956246 quantize_finetune_llama.py:144] loaded model
I0317 14:58:49.229103 3956246 quantize_finetune_llama.py:178] loaded compression model
I0317 14:59:07.039522 3956246 quantize_finetune_llama.py:182] loaded dataset and devset
I0317 14:59:15.610154 3956246 quantize_finetune_llama.py:202] layer 0 gpu 0
I0317 14:59:17.472135 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 0 in 1.7154819965362549s
tensor(0.0125, device='cuda:0') tensor(5.7775e-08, device='cuda:0')
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0317 14:59:31.335391 3956512 config.py:54] PyTorch version 2.6.0 available.
W0317 14:59:31.616171 3956512 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:59:32.496871 3956512 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:59:32.501054 3956246 quantize_finetune_llama.py:202] layer 1 gpu 1
I0317 14:59:32.661365 3956512 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:59:35.855318 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 1 in 3.192303419113159s
I0317 14:59:39.435719 3956591 config.py:54] PyTorch version 2.6.0 available.
W0317 14:59:39.738499 3956591 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:59:40.654025 3956591 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:59:40.658280 3956246 quantize_finetune_llama.py:202] layer 2 gpu 2
I0317 14:59:40.828812 3956591 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:59:43.593299 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 2 in 2.7818117141723633s
I0317 14:59:47.353622 3956687 config.py:54] PyTorch version 2.6.0 available.
W0317 14:59:47.686249 3956687 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:59:48.697607 3956687 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:59:48.701851 3956246 quantize_finetune_llama.py:202] layer 3 gpu 3
I0317 14:59:48.959169 3956687 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 14:59:52.945445 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 3 in 4.0759077072143555s
I0317 14:59:56.888188 3956778 config.py:54] PyTorch version 2.6.0 available.
W0317 14:59:57.245819 3956778 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 14:59:58.216246 3956778 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 14:59:58.220587 3956246 quantize_finetune_llama.py:202] layer 4 gpu 0
I0317 14:59:58.431588 3956778 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.03858114778995514 tr(WHW.T) 1.3175290822982788
bpp_loss 3.7377480268478394
0_q proxy err 4.7478701162617654e-05 tr(WHW.T) 6234.0732421875
bpp_loss 4.970494508743286
0_k proxy err 3.815345189650543e-05 tr(WHW.T) 2167.80859375
bpp_loss 6.127246141433716
0_o proxy err 0.0030298137571662664 tr(WHW.T) 0.23014844954013824
bpp_loss 3.8074636459350586
0_up proxy err 0.003752043703570962 tr(WHW.T) 101.63945007324219
bpp_loss 4.09260368347168
0_gate proxy err 0.0021426368039101362 tr(WHW.T) 179.7012481689453
bpp_loss 4.208471298217773
0_down proxy err 0.0031024443451315165 tr(WHW.T) 0.4814107418060303
bpp_loss 4.089940071105957
1_v proxy err 0.021489648148417473 tr(WHW.T) 5.699800491333008
bpp_loss 3.8344333171844482
1_q proxy err 8.202098251786083e-05 tr(WHW.T) 7568.30322265625
bpp_loss 5.070262670516968
1_k proxy err 4.536155756795779e-05 tr(WHW.T) 3947.4990234375
bpp_loss 6.212863206863403
1_o proxy err 0.004773374181240797 tr(WHW.T) 0.31429046392440796
bpp_loss 3.893332600593567
1_up proxy err 0.004070430062711239 tr(WHW.T) 159.80691528320312
bpp_loss 4.1090996606009345
1_gate proxy err 0.002421906217932701 tr(WHW.T) 270.8945617675781
bpp_loss 4.224131856645856
1_down proxy err 0.0023424369283020496 tr(WHW.T) 67.10472869873047
bpp_loss 4.105281489236014
I0317 15:00:40.442470 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 4 in 1.0114121437072754s
I0317 15:00:44.287514 3956979 config.py:54] PyTorch version 2.6.0 available.
W0317 15:00:44.672804 3956979 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:00:45.654187 3956979 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:00:45.658590 3956246 quantize_finetune_llama.py:202] layer 5 gpu 1
I0317 15:00:45.862988 3956979 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.015084796585142612 tr(WHW.T) 26.839576721191406
bpp_loss 3.7383625507354736
2_q proxy err 0.0002521999995224178 tr(WHW.T) 7137.59423828125
bpp_loss 4.946336030960083
2_k proxy err 0.00012474466348066926 tr(WHW.T) 3891.808349609375
bpp_loss 6.2950310707092285
2_o proxy err 0.004802486393600702 tr(WHW.T) 0.5573468804359436
bpp_loss 3.83533251285553
2_up proxy err 0.004406000953167677 tr(WHW.T) 225.9742889404297
bpp_loss 4.103743825639997
2_gate proxy err 0.002240882022306323 tr(WHW.T) 449.3431091308594
bpp_loss 4.261797223772321
2_down proxy err 0.0043426137417554855 tr(WHW.T) 1.2005821466445923
bpp_loss 4.107306548527309
I0317 15:00:49.091308 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 5 in 0.9922397136688232s
I0317 15:00:52.982111 3957066 config.py:54] PyTorch version 2.6.0 available.
W0317 15:00:53.328044 3957066 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:00:54.313299 3957066 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:00:54.317537 3956246 quantize_finetune_llama.py:202] layer 6 gpu 2
I0317 15:00:54.534667 3957066 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.008246799930930138 tr(WHW.T) 40.46714782714844
bpp_loss 3.833066701889038
3_q proxy err 0.00022210675524547696 tr(WHW.T) 6654.2763671875
bpp_loss 4.957139253616333
3_k proxy err 0.000108601656393148 tr(WHW.T) 3660.859619140625
bpp_loss 6.292115926742554
3_o proxy err 0.005114209838211536 tr(WHW.T) 0.9357947707176208
bpp_loss 3.9330790042877197
3_up proxy err 0.004438350908458233 tr(WHW.T) 316.0293273925781
bpp_loss 4.083106313432966
3_gate proxy err 0.0016312804073095322 tr(WHW.T) 875.7510375976562
bpp_loss 4.347828320094517
3_down proxy err 0.004775152076035738 tr(WHW.T) 2.1166555881500244
bpp_loss 4.081043107169015
I0317 15:00:58.401705 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 6 in 0.8881604671478271s
I0317 15:01:02.118770 3957153 config.py:54] PyTorch version 2.6.0 available.
W0317 15:01:02.454859 3957153 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:01:03.450006 3957153 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:01:03.454298 3956246 quantize_finetune_llama.py:202] layer 7 gpu 3
I0317 15:01:03.640661 3957153 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:01:04.973782 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 7 in 1.028428077697754s
I0317 15:01:08.859009 3957244 config.py:54] PyTorch version 2.6.0 available.
W0317 15:01:09.217381 3957244 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:01:10.316424 3957244 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:01:10.320607 3956246 quantize_finetune_llama.py:202] layer 8 gpu 0
I0317 15:01:10.503496 3957244 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.008185705170035362 tr(WHW.T) 38.379119873046875
bpp_loss 3.8853410482406616
4_q proxy err 0.0002118477423209697 tr(WHW.T) 6741.380859375
bpp_loss 4.926302909851074
4_k proxy err 9.840118582360446e-05 tr(WHW.T) 3941.660888671875
bpp_loss 6.223934888839722
4_o proxy err 0.007318906020373106 tr(WHW.T) 1.3690094947814941
bpp_loss 3.9520996809005737
4_up proxy err 0.004525415133684874 tr(WHW.T) 400.241455078125
bpp_loss 4.055920464651925
4_gate proxy err 0.0011784840608015656 tr(WHW.T) 1579.121337890625
bpp_loss 4.433006014142718
4_down proxy err 0.005217631813138723 tr(WHW.T) 3.4171695709228516
bpp_loss 4.0541830744062155
5_v proxy err 0.01121529657393694 tr(WHW.T) 37.700050354003906
bpp_loss 3.7678563594818115
5_q proxy err 0.00028774840757250786 tr(WHW.T) 6497.876953125
bpp_loss 4.9125964641571045
5_k proxy err 0.00012191551650175825 tr(WHW.T) 4151.98193359375
bpp_loss 6.239713668823242
5_o proxy err 0.008991092443466187 tr(WHW.T) 1.811954379081726
bpp_loss 3.890007495880127
5_up proxy err 0.004362706560641527 tr(WHW.T) 497.45538330078125
bpp_loss 4.061951092311314
5_gate proxy err 0.0011290495749562979 tr(WHW.T) 1974.3070068359375
bpp_loss 4.432315145220075
5_down proxy err 0.005211749579757452 tr(WHW.T) 4.908621311187744
bpp_loss 4.058754852839878
I0317 15:01:54.120951 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 8 in 1.3688867092132568s
I0317 15:01:57.921677 3957425 config.py:54] PyTorch version 2.6.0 available.
W0317 15:01:58.272125 3957425 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:01:59.368202 3957425 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:01:59.372476 3956246 quantize_finetune_llama.py:202] layer 9 gpu 1
I0317 15:01:59.533756 3957425 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.009335650131106377 tr(WHW.T) 42.837894439697266
bpp_loss 3.8162388801574707
6_q proxy err 0.00029291000100784004 tr(WHW.T) 6019.40673828125
bpp_loss 4.96070408821106
6_k proxy err 0.00010796738934004679 tr(WHW.T) 4418.95361328125
bpp_loss 6.23567533493042
6_o proxy err 0.009384929202497005 tr(WHW.T) 2.5981621742248535
bpp_loss 3.923074245452881
6_up proxy err 0.004221691284328699 tr(WHW.T) 571.950927734375
bpp_loss 4.061675071716309
6_gate proxy err 0.000962849473580718 tr(WHW.T) 2580.455078125
bpp_loss 4.441243580409458
6_down proxy err 0.005143577232956886 tr(WHW.T) 6.227621078491211
bpp_loss 4.058210577283587
I0317 15:02:03.581459 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 9 in 0.9711349010467529s
I0317 15:02:07.362238 3957520 config.py:54] PyTorch version 2.6.0 available.
7_v proxy err 0.007505573332309723 tr(WHW.T) 53.14668655395508
bpp_loss 3.8110921382904053
7_q proxy err 0.00029313299455679953 tr(WHW.T) 6036.439453125
bpp_loss 4.8618004322052
7_k proxy err 0.00010746859334176406 tr(WHW.T) 4611.79638671875
bpp_loss 6.271522760391235
7_o proxy err 0.00986435730010271 tr(WHW.T) 3.787719964981079
bpp_loss 3.936829447746277
7_up proxy err 0.0038761545438319445 tr(WHW.T) 651.590087890625
bpp_loss 4.0763154711042136
7_gate proxy err 0.0009864509338513017 tr(WHW.T) 2636.09716796875
bpp_loss 4.410823004586356
7_down proxy err 0.005105969961732626 tr(WHW.T) 6.803934574127197
bpp_loss 4.073267732347761
W0317 15:02:07.662717 3957520 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:02:08.596608 3957520 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:02:08.600765 3956246 quantize_finetune_llama.py:202] layer 10 gpu 2
I0317 15:02:08.795009 3957520 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:02:09.969610 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 10 in 0.8808026313781738s
I0317 15:02:13.569272 3957596 config.py:54] PyTorch version 2.6.0 available.
W0317 15:02:13.946362 3957596 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:02:14.941595 3957596 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:02:14.945840 3956246 quantize_finetune_llama.py:202] layer 11 gpu 3
I0317 15:02:15.098419 3957596 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:02:16.550873 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 11 in 1.12843656539917s
I0317 15:02:20.366740 3957672 config.py:54] PyTorch version 2.6.0 available.
W0317 15:02:20.707196 3957672 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:02:21.676142 3957672 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:02:21.680296 3956246 quantize_finetune_llama.py:202] layer 12 gpu 0
I0317 15:02:21.858132 3957672 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v proxy err 0.009061557240784168 tr(WHW.T) 53.42280197143555
bpp_loss 3.842153787612915
8_q proxy err 0.00038255148683674634 tr(WHW.T) 5514.4345703125
bpp_loss 4.8694446086883545
8_k proxy err 0.00012500878074206412 tr(WHW.T) 4670.25390625
bpp_loss 6.238039016723633
8_o proxy err 0.012698915787041187 tr(WHW.T) 3.732954978942871
bpp_loss 3.9529035091400146
8_up proxy err 0.003936666529625654 tr(WHW.T) 668.69921875
bpp_loss 4.071594102042062
8_gate proxy err 0.0009250835864804685 tr(WHW.T) 2931.24951171875
bpp_loss 4.418515069144113
8_down proxy err 0.00514307850971818 tr(WHW.T) 7.259360313415527
bpp_loss 4.069789954594204
9_v proxy err 0.006757257040590048 tr(WHW.T) 72.69827270507812
bpp_loss 3.9556528329849243
9_q proxy err 0.0003972687991335988 tr(WHW.T) 5306.75244140625
bpp_loss 4.869928598403931
9_k proxy err 0.00013182141992729157 tr(WHW.T) 4332.2958984375
bpp_loss 6.23333215713501
9_o proxy err 0.01221020519733429 tr(WHW.T) 4.439431190490723
bpp_loss 4.014944314956665
9_up proxy err 0.0037350079510360956 tr(WHW.T) 723.7196655273438
bpp_loss 4.081165177481515
9_gate proxy err 0.0008759740157984197 tr(WHW.T) 3179.91943359375
bpp_loss 4.4386749267578125
9_down proxy err 0.005325617268681526 tr(WHW.T) 8.003087043762207
bpp_loss 4.0731587409973145
I0317 15:03:08.028316 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 12 in 1.0502917766571045s
I0317 15:03:11.965668 3957884 config.py:54] PyTorch version 2.6.0 available.
W0317 15:03:12.297005 3957884 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

10_v proxy err 0.009423462674021721 tr(WHW.T) 60.08286666870117
bpp_loss 3.8334927558898926
10_q proxy err 0.0004362950276117772 tr(WHW.T) 5567.93798828125
bpp_loss 4.912957668304443
10_k proxy err 0.00014004274271428585 tr(WHW.T) 4710.4462890625
bpp_loss 6.272726058959961
10_o proxy err 0.013875503093004227 tr(WHW.T) 4.188048362731934
bpp_loss 3.9431008100509644
10_up proxy err 0.003642628202214837 tr(WHW.T) 749.0687255859375
bpp_loss 4.0982757295881
10_gate proxy err 0.000919811544008553 tr(WHW.T) 3045.35498046875
bpp_loss 4.398905345371792
10_down proxy err 0.005120588466525078 tr(WHW.T) 8.42132568359375
bpp_loss 4.088550908224923
W0317 15:03:13.297182 3957884 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:03:13.301499 3956246 quantize_finetune_llama.py:202] layer 13 gpu 1
I0317 15:03:13.505746 3957884 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:03:14.784304 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 13 in 1.0018038749694824s
I0317 15:03:18.594465 3957963 config.py:54] PyTorch version 2.6.0 available.
W0317 15:03:18.939858 3957963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

11_v proxy err 0.007361770141869783 tr(WHW.T) 74.2698974609375
bpp_loss 3.8264238834381104
11_q proxy err 0.0004567322030197829 tr(WHW.T) 5157.30615234375
bpp_loss 4.792482376098633
11_k proxy err 0.00015300590894185007 tr(WHW.T) 4189.68798828125
bpp_loss 6.221464395523071
11_o proxy err 0.016861535608768463 tr(WHW.T) 4.454066753387451
bpp_loss 3.9615267515182495
11_up proxy err 0.0036463758442550898 tr(WHW.T) 789.370361328125
bpp_loss 4.105704307556152
11_gate proxy err 0.0009324161801487207 tr(WHW.T) 3167.24609375
bpp_loss 4.379278591700962
11_down proxy err 0.005024672485888004 tr(WHW.T) 9.071778297424316
bpp_loss 4.097057410648891
W0317 15:03:19.856610 3957963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:03:19.860801 3956246 quantize_finetune_llama.py:202] layer 14 gpu 2
I0317 15:03:20.057211 3957963 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:03:21.904300 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 14 in 1.3385417461395264s
I0317 15:03:25.544507 3958039 config.py:54] PyTorch version 2.6.0 available.
W0317 15:03:25.838346 3958039 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:03:26.815872 3958039 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:03:26.819939 3956246 quantize_finetune_llama.py:202] layer 15 gpu 3
I0317 15:03:26.971541 3958039 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:03:28.299222 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 15 in 0.988767147064209s
I0317 15:03:32.153734 3958125 config.py:54] PyTorch version 2.6.0 available.
W0317 15:03:32.505044 3958125 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:03:33.505514 3958125 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:03:33.509958 3956246 quantize_finetune_llama.py:202] layer 16 gpu 0
I0317 15:03:33.685577 3958125 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v proxy err 0.00652519753202796 tr(WHW.T) 68.45218658447266
bpp_loss 3.9488848447799683
12_q proxy err 0.0003016144910361618 tr(WHW.T) 6419.8271484375
bpp_loss 4.821336507797241
12_k proxy err 0.00012221952783875167 tr(WHW.T) 4340.4931640625
bpp_loss 6.126118898391724
12_o proxy err 0.012167762033641338 tr(WHW.T) 5.624481201171875
bpp_loss 4.011853456497192
12_up proxy err 0.0033394088968634605 tr(WHW.T) 855.3871459960938
bpp_loss 4.127776827130999
12_gate proxy err 0.0009218640043400228 tr(WHW.T) 3184.862548828125
bpp_loss 4.361315454755511
12_down proxy err 0.004898379556834698 tr(WHW.T) 10.028186798095703
bpp_loss 4.1139388765607565
13_v proxy err 0.008372698910534382 tr(WHW.T) 71.04966735839844
bpp_loss 3.8863229751586914
13_q proxy err 0.0004822984628845006 tr(WHW.T) 5299.77734375
bpp_loss 4.844916582107544
13_k proxy err 0.00015306744899135083 tr(WHW.T) 4513.97802734375
bpp_loss 6.268542528152466
13_o proxy err 0.01404002495110035 tr(WHW.T) 6.745936870574951
bpp_loss 3.989489436149597
13_up proxy err 0.0033508092164993286 tr(WHW.T) 916.3327026367188
bpp_loss 4.131085668291364
13_gate proxy err 0.0008857458014972508 tr(WHW.T) 3562.817138671875
bpp_loss 4.3647260665893555
13_down proxy err 0.005093040410429239 tr(WHW.T) 11.704400062561035
bpp_loss 4.11354010445731
I0317 15:04:18.855371 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 16 in 0.9787886142730713s
I0317 15:04:22.839796 3958332 config.py:54] PyTorch version 2.6.0 available.
W0317 15:04:23.191288 3958332 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:04:24.193569 3958332 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:04:24.197688 3956246 quantize_finetune_llama.py:202] layer 17 gpu 1
I0317 15:04:24.362236 3958332 data_utils.py:336] using 256 training seqs, 128 validation seqs
14_v proxy err 0.008500865660607815 tr(WHW.T) 74.802978515625
bpp_loss 3.87885057926178
14_q proxy err 0.00048425092245452106 tr(WHW.T) 5552.11865234375
bpp_loss 4.797720909118652
14_k proxy err 0.0001478028716519475 tr(WHW.T) 4950.54931640625
bpp_loss 6.230796575546265
14_o proxy err 0.013802694156765938 tr(WHW.T) 6.853440761566162
bpp_loss 3.985270142555237
14_up proxy err 0.0036607373040169477 tr(WHW.T) 932.0479736328125
bpp_loss 4.126628603254046
14_gate proxy err 0.0008255225839093328 tr(WHW.T) 4249.7998046875
bpp_loss 4.40306282043457
14_down proxy err 0.005234051030129194 tr(WHW.T) 13.352071762084961
bpp_loss 4.111025197165353
I0317 15:04:26.983337 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 17 in 0.9594278335571289s
I0317 15:04:30.735350 3958406 config.py:54] PyTorch version 2.6.0 available.
15_v proxy err 0.00830745231360197 tr(WHW.T) 67.86465454101562
bpp_loss 3.9457935094833374
15_q proxy err 0.00036543735768646 tr(WHW.T) 6709.19140625
bpp_loss 5.030603885650635
15_k proxy err 0.00014792215370107442 tr(WHW.T) 4509.14404296875
bpp_loss 6.174377918243408
15_o proxy err 0.011458763852715492 tr(WHW.T) 6.766374111175537
bpp_loss 4.018972635269165
15_up proxy err 0.0037265827413648367 tr(WHW.T) 988.90234375
bpp_loss 4.117412567138672
15_gate proxy err 0.0007489102426916361 tr(WHW.T) 5081.40576171875
bpp_loss 4.443661417279925
15_down proxy err 0.005217754282057285 tr(WHW.T) 16.894807815551758
bpp_loss 4.105200971875872
W0317 15:04:31.019845 3958406 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:04:31.969990 3958406 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:04:31.973621 3956246 quantize_finetune_llama.py:202] layer 18 gpu 2
I0317 15:04:32.151527 3958406 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:04:33.438040 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 18 in 1.0010647773742676s
I0317 15:04:37.219029 3958497 config.py:54] PyTorch version 2.6.0 available.
W0317 15:04:37.540423 3958497 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:04:38.505256 3958497 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:04:38.509374 3956246 quantize_finetune_llama.py:202] layer 19 gpu 3
I0317 15:04:38.679598 3958497 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:04:39.913699 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 19 in 0.9384958744049072s
I0317 15:04:43.873066 3958576 config.py:54] PyTorch version 2.6.0 available.
W0317 15:04:44.234963 3958576 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:04:45.341274 3958576 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:04:45.345554 3956246 quantize_finetune_llama.py:202] layer 20 gpu 0
I0317 15:04:45.515578 3958576 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v proxy err 0.008642228320240974 tr(WHW.T) 68.60269165039062
bpp_loss 3.894053101539612
16_q proxy err 0.0004157740040682256 tr(WHW.T) 6124.5419921875
bpp_loss 4.944321870803833
16_k proxy err 0.00014131124771665782 tr(WHW.T) 4878.88427734375
bpp_loss 6.20171594619751
16_o proxy err 0.009803501889109612 tr(WHW.T) 7.369767189025879
bpp_loss 3.9962230920791626
16_up proxy err 0.004022729117423296 tr(WHW.T) 981.8323974609375
bpp_loss 4.101795196533203
16_gate proxy err 0.0008389586582779884 tr(WHW.T) 4852.61962890625
bpp_loss 4.482452801295689
16_down proxy err 0.005312654189765453 tr(WHW.T) 17.929277420043945
bpp_loss 4.090426240648542
17_v proxy err 0.008385566994547844 tr(WHW.T) 69.1786880493164
bpp_loss 3.972053647041321
17_q proxy err 0.00037330357008613646 tr(WHW.T) 6716.68115234375
bpp_loss 4.9667439460754395
17_k proxy err 0.00015677502960897982 tr(WHW.T) 4246.078125
bpp_loss 6.225625991821289
17_o proxy err 0.008619846776127815 tr(WHW.T) 6.400019645690918
bpp_loss 4.030399322509766
17_up proxy err 0.003964018542319536 tr(WHW.T) 1061.9390869140625
bpp_loss 4.097282273428781
17_gate proxy err 0.0008291247067973018 tr(WHW.T) 5241.2060546875
bpp_loss 4.5000946862357
17_down proxy err 0.005388342775404453 tr(WHW.T) 21.307649612426758
bpp_loss 4.088638510022845
I0317 15:05:31.471864 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 20 in 1.4145009517669678s
I0317 15:05:35.274186 3958775 config.py:54] PyTorch version 2.6.0 available.
W0317 15:05:35.588949 3958775 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v proxy err 0.00824296660721302 tr(WHW.T) 73.61924743652344
bpp_loss 3.8874588012695312
18_q proxy err 0.00045396140194498 tr(WHW.T) 5733.501953125
bpp_loss 4.926679849624634
18_k proxy err 0.0001578483497723937 tr(WHW.T) 4452.47412109375
bpp_loss 6.3235602378845215
18_o proxy err 0.007884913124144077 tr(WHW.T) 4.730301380157471
bpp_loss 4.004457235336304
18_up proxy err 0.004191042855381966 tr(WHW.T) 1055.73193359375
bpp_loss 4.0914218085152765
18_gate proxy err 0.0009789492469280958 tr(WHW.T) 4660.94091796875
bpp_loss 4.503749438694546
18_down proxy err 0.005367001052945852 tr(WHW.T) 21.094728469848633
bpp_loss 4.085087163107736
W0317 15:05:36.526792 3958775 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:05:36.530854 3956246 quantize_finetune_llama.py:202] layer 21 gpu 1
I0317 15:05:36.721369 3958775 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:05:37.963160 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 21 in 0.9881229400634766s
I0317 15:05:41.738066 3958849 config.py:54] PyTorch version 2.6.0 available.
W0317 15:05:42.087019 3958849 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

19_v proxy err 0.006927929352968931 tr(WHW.T) 87.24554443359375
bpp_loss 3.93244469165802
19_q proxy err 0.0004211699415463954 tr(WHW.T) 6149.10400390625
bpp_loss 4.93066668510437
19_k proxy err 0.00017546954040881246 tr(WHW.T) 3978.64404296875
bpp_loss 6.166489124298096
19_o proxy err 0.008134089410305023 tr(WHW.T) 3.9390149116516113
bpp_loss 4.016445875167847
19_up proxy err 0.004371926188468933 tr(WHW.T) 1067.85498046875
bpp_loss 4.087107930864606
19_gate proxy err 0.0010507478145882487 tr(WHW.T) 4580.61328125
bpp_loss 4.514387675694057
19_down proxy err 0.005398317705839872 tr(WHW.T) 21.985567092895508
bpp_loss 4.0827091080801825
W0317 15:05:43.022026 3958849 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:05:43.025722 3956246 quantize_finetune_llama.py:202] layer 22 gpu 2
I0317 15:05:43.172839 3958849 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:05:44.608407 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 22 in 0.8061950206756592s
I0317 15:05:48.323206 3958934 config.py:54] PyTorch version 2.6.0 available.
W0317 15:05:48.624938 3958934 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:05:49.504891 3958934 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:05:49.508626 3956246 quantize_finetune_llama.py:202] layer 23 gpu 3
I0317 15:05:49.774230 3958934 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:05:51.079407 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 23 in 1.1028108596801758s
I0317 15:05:55.017896 3959019 config.py:54] PyTorch version 2.6.0 available.
W0317 15:05:55.356553 3959019 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:05:56.438431 3959019 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:05:56.442965 3956246 quantize_finetune_llama.py:202] layer 24 gpu 0
I0317 15:05:56.619789 3959019 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v proxy err 0.007183118257671595 tr(WHW.T) 90.61302185058594
bpp_loss 3.973775863647461
20_q proxy err 0.0004872897989116609 tr(WHW.T) 5690.95703125
bpp_loss 4.903919458389282
20_k proxy err 0.00017511869373265654 tr(WHW.T) 4224.9970703125
bpp_loss 6.114137887954712
20_o proxy err 0.007883783429861069 tr(WHW.T) 4.07815408706665
bpp_loss 4.006426095962524
20_up proxy err 0.0043960739858448505 tr(WHW.T) 1127.5106201171875
bpp_loss 4.090710094996861
20_gate proxy err 0.001122019370086491 tr(WHW.T) 4549.56396484375
bpp_loss 4.514216150556292
20_down proxy err 0.005297437775880098 tr(WHW.T) 23.935516357421875
bpp_loss 4.086685385022845
21_v proxy err 0.0065191639587283134 tr(WHW.T) 95.41011047363281
bpp_loss 4.003326416015625
21_q proxy err 0.00039558770367875695 tr(WHW.T) 6793.60595703125
bpp_loss 4.876670837402344
21_k proxy err 0.00016116727783810347 tr(WHW.T) 4413.91943359375
bpp_loss 6.139804124832153
21_o proxy err 0.007536415942013264 tr(WHW.T) 7.5875244140625
bpp_loss 4.029766082763672
21_up proxy err 0.004301917273551226 tr(WHW.T) 1237.0894775390625
bpp_loss 4.093988963535854
21_gate proxy err 0.0010928054107353091 tr(WHW.T) 5024.13427734375
bpp_loss 4.5286422457013815
21_down proxy err 0.005256156902760267 tr(WHW.T) 29.1324520111084
bpp_loss 4.089770930153983
I0317 15:06:40.949406 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 24 in 0.9345626831054688s
I0317 15:06:44.779956 3959215 config.py:54] PyTorch version 2.6.0 available.
W0317 15:06:45.124467 3959215 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:06:46.125818 3959215 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:06:46.130149 3956246 quantize_finetune_llama.py:202] layer 25 gpu 1
I0317 15:06:46.318052 3959215 data_utils.py:336] using 256 training seqs, 128 validation seqs
22_v proxy err 0.006855718791484833 tr(WHW.T) 101.29380798339844
bpp_loss 4.054157972335815
22_q proxy err 0.0004943676176480949 tr(WHW.T) 5947.34326171875
bpp_loss 4.818181276321411
22_k proxy err 0.0001833348214859143 tr(WHW.T) 4309.5947265625
bpp_loss 6.061696529388428
22_o proxy err 0.007778933737426996 tr(WHW.T) 5.007936954498291
bpp_loss 4.0474584102630615
22_up proxy err 0.004432781133800745 tr(WHW.T) 1249.8564453125
bpp_loss 4.097467150006976
22_gate proxy err 0.0011649116640910506 tr(WHW.T) 4890.96826171875
bpp_loss 4.52851254599435
22_down proxy err 0.005116343963891268 tr(WHW.T) 30.777225494384766
bpp_loss 4.093476567949567
I0317 15:06:49.602894 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 25 in 1.3826627731323242s
23_v proxy err 0.006008187308907509 tr(WHW.T) 112.7859115600586
bpp_loss 4.109999895095825
23_q proxy err 0.0004489236162044108 tr(WHW.T) 6408.4541015625
bpp_loss 4.828115940093994
23_k proxy err 0.00017854727047961205 tr(WHW.T) 4211.31982421875
bpp_loss 6.049127578735352
23_o proxy err 0.005469118244946003 tr(WHW.T) 6.165833473205566
bpp_loss 4.06702995300293
23_up proxy err 0.004509925842285156 tr(WHW.T) 1298.444580078125
bpp_loss 4.1018340247018
23_gate proxy err 0.0012598471948876977 tr(WHW.T) 4776.34521484375
bpp_loss 4.53129277910505
23_down proxy err 0.0050094411708414555 tr(WHW.T) 32.75361633300781
bpp_loss 4.098079204559326
I0317 15:06:53.338674 3959305 config.py:54] PyTorch version 2.6.0 available.
W0317 15:06:53.658683 3959305 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:06:54.552483 3959305 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:06:54.556187 3956246 quantize_finetune_llama.py:202] layer 26 gpu 2
I0317 15:06:54.800570 3959305 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:06:55.920563 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 26 in 0.9231390953063965s
I0317 15:06:59.548242 3959386 config.py:54] PyTorch version 2.6.0 available.
W0317 15:06:59.906035 3959386 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:07:00.893674 3959386 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:07:00.897736 3956246 quantize_finetune_llama.py:202] layer 27 gpu 3
I0317 15:07:01.061632 3959386 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:07:02.302096 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 27 in 0.910362720489502s
I0317 15:07:06.100121 3959462 config.py:54] PyTorch version 2.6.0 available.
W0317 15:07:06.453626 3959462 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:07:07.429521 3959462 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:07:07.433717 3956246 quantize_finetune_llama.py:202] layer 28 gpu 0
I0317 15:07:07.625252 3959462 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v proxy err 0.005158537067472935 tr(WHW.T) 136.39785766601562
bpp_loss 4.222982406616211
24_q proxy err 0.00045172980753704906 tr(WHW.T) 6549.06396484375
bpp_loss 4.791528940200806
24_k proxy err 0.00018965046911034733 tr(WHW.T) 4140.12353515625
bpp_loss 5.86743426322937
24_o proxy err 0.006020165514200926 tr(WHW.T) 6.529373645782471
bpp_loss 4.116239309310913
24_up proxy err 0.004578602034598589 tr(WHW.T) 1342.69384765625
bpp_loss 4.106711523873465
24_gate proxy err 0.0013279858976602554 tr(WHW.T) 4752.36767578125
bpp_loss 4.5388657706124445
24_down proxy err 0.004953031428158283 tr(WHW.T) 34.95817947387695
bpp_loss 4.1034745488848
25_v proxy err 0.0043067834340035915 tr(WHW.T) 164.04367065429688
bpp_loss 4.231448173522949
25_q proxy err 0.00039047945756465197 tr(WHW.T) 7679.1796875
bpp_loss 4.7571892738342285
25_k proxy err 0.00018722342792898417 tr(WHW.T) 4239.72509765625
bpp_loss 5.849496603012085
25_o proxy err 0.004789263475686312 tr(WHW.T) 8.825087547302246
bpp_loss 4.121800661087036
25_up proxy err 0.004533369559794664 tr(WHW.T) 1428.771728515625
bpp_loss 4.116408348083496
25_gate proxy err 0.001308492268435657 tr(WHW.T) 5091.62109375
bpp_loss 4.551617894853864
25_down proxy err 0.005054498091340065 tr(WHW.T) 37.920631408691406
bpp_loss 4.113042218344552
I0317 15:07:52.908927 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 28 in 1.0397255420684814s
I0317 15:07:56.736447 3959646 config.py:54] PyTorch version 2.6.0 available.
W0317 15:07:57.086656 3959646 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v proxy err 0.005470553878694773 tr(WHW.T) 123.81900024414062
bpp_loss 4.299728870391846
26_q proxy err 0.0004734508984256536 tr(WHW.T) 6098.626953125
bpp_loss 4.772334814071655
26_k proxy err 0.0001747195201460272 tr(WHW.T) 4395.34912109375
bpp_loss 5.965471982955933
26_o proxy err 0.004022798500955105 tr(WHW.T) 16.217060089111328
bpp_loss 4.145293712615967
26_up proxy err 0.004382173530757427 tr(WHW.T) 1584.1817626953125
bpp_loss 4.125708443777902
26_gate proxy err 0.001192955649457872 tr(WHW.T) 5988.38671875
bpp_loss 4.564342090061733
26_down proxy err 0.005059710703790188 tr(WHW.T) 43.263404846191406
bpp_loss 4.122579915182931
W0317 15:07:58.078818 3959646 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:07:58.082996 3956246 quantize_finetune_llama.py:202] layer 29 gpu 1
I0317 15:07:58.316603 3959646 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:08:00.001439 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 29 in 0.8908915519714355s
I0317 15:08:03.774800 3959720 config.py:54] PyTorch version 2.6.0 available.
27_v proxy err 0.003607200924307108 tr(WHW.T) 203.18115234375
bpp_loss 4.409056901931763
27_q proxy err 0.00047663526493124664 tr(WHW.T) 6387.7978515625
bpp_loss 4.737553834915161
27_k proxy err 0.00019358455028850585 tr(WHW.T) 4200.8603515625
bpp_loss 5.923234462738037
27_o proxy err 0.00444597564637661 tr(WHW.T) 16.170616149902344
bpp_loss 4.177263259887695
27_up proxy err 0.003960928414016962 tr(WHW.T) 1872.3875732421875
bpp_loss 4.140514782496861
27_gate proxy err 0.0010528013808652759 tr(WHW.T) 7248.0146484375
bpp_loss 4.579551151820591
27_down proxy err 0.005129821598529816 tr(WHW.T) 61.20230484008789
bpp_loss 4.135505948747907
W0317 15:08:04.090289 3959720 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:08:04.986887 3959720 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:08:04.990593 3956246 quantize_finetune_llama.py:202] layer 30 gpu 2
I0317 15:08:05.135156 3959720 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:08:06.254230 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 30 in 0.8096981048583984s
I0317 15:08:09.942974 3959796 config.py:54] PyTorch version 2.6.0 available.
W0317 15:08:10.254258 3959796 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:08:11.174902 3959796 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:08:11.178543 3956246 quantize_finetune_llama.py:202] layer 31 gpu 3
I0317 15:08:11.333221 3959796 data_utils.py:336] using 256 training seqs, 128 validation seqs
I0317 15:08:12.936887 3956246 quantize_finetune_llama.py:233] computed original embedding for layer 31 in 1.2694811820983887s
I0317 15:08:16.911352 3959887 config.py:54] PyTorch version 2.6.0 available.
W0317 15:08:17.251292 3959887 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0317 15:08:18.207556 3959887 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0317 15:08:18.368365 3959887 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v proxy err 0.004021700471639633 tr(WHW.T) 175.40757751464844
bpp_loss 4.4704203605651855
28_q proxy err 0.00043804553570225835 tr(WHW.T) 6755.15673828125
bpp_loss 4.73846960067749
28_k proxy err 0.00017957693489734083 tr(WHW.T) 4372.6787109375
bpp_loss 5.753447532653809
28_o proxy err 0.0038358636666089296 tr(WHW.T) 24.542436599731445
bpp_loss 4.210406064987183
28_up proxy err 0.003282176796346903 tr(WHW.T) 2478.37158203125
bpp_loss 4.165239197867257
28_gate proxy err 0.0009615541785024107 tr(WHW.T) 8688.7451171875
bpp_loss 4.568597521100726
28_down proxy err 0.004650557413697243 tr(WHW.T) 82.2515869140625
bpp_loss 4.155605520520892
29_v proxy err 0.0028546014800667763 tr(WHW.T) 249.68582153320312
bpp_loss 4.544291973114014
29_q proxy err 0.0004903706721961498 tr(WHW.T) 6063.7841796875
bpp_loss 4.726113796234131
29_k proxy err 0.0001636780652916059 tr(WHW.T) 4804.99560546875
bpp_loss 5.913679838180542
29_o proxy err 0.0031176612246781588 tr(WHW.T) 36.6841926574707
bpp_loss 4.254873991012573
29_up proxy err 0.002618095837533474 tr(WHW.T) 3248.7060546875
bpp_loss 4.199328013828823
29_gate proxy err 0.0009021679870784283 tr(WHW.T) 9685.2646484375
bpp_loss 4.563524791172573
29_down proxy err 0.004481288138777018 tr(WHW.T) 132.4029083251953
bpp_loss 4.177581310272217
30_v proxy err 0.0028588087297976017 tr(WHW.T) 252.81202697753906
bpp_loss 4.919504880905151
30_q proxy err 0.0004209692415315658 tr(WHW.T) 7045.02978515625
bpp_loss 4.630137920379639
30_k proxy err 0.0001928435667650774 tr(WHW.T) 4109.9091796875
bpp_loss 5.477827310562134
30_o proxy err 0.0019977528136223555 tr(WHW.T) 84.08126831054688
bpp_loss 4.352045297622681
30_up proxy err 0.0015638150507584214 tr(WHW.T) 5513.9267578125
bpp_loss 4.231707164219448
30_gate proxy err 0.0006725259008817375 tr(WHW.T) 13194.7158203125
bpp_loss 4.628660202026367
30_down proxy err 0.003813487011939287 tr(WHW.T) 368.5621032714844
bpp_loss 4.186456475939069
31_v proxy err 0.001356238266453147 tr(WHW.T) 365.68487548828125
bpp_loss 4.6696319580078125
31_q proxy err 0.00022909945982974023 tr(WHW.T) 9335.7197265625
bpp_loss 4.824214220046997
31_k proxy err 0.00013377313734963536 tr(WHW.T) 4138.115234375
bpp_loss 5.753093481063843
31_o proxy err 0.004394627176225185 tr(WHW.T) 182.20681762695312
bpp_loss 4.332824468612671
31_up proxy err 0.0005092031788080931 tr(WHW.T) 12277.7177734375
bpp_loss 4.453265462602888
31_gate proxy err 0.00025340449064970016 tr(WHW.T) 25696.34765625
bpp_loss 4.905268805367606
31_down proxy err 0.003386653261259198 tr(WHW.T) 2762.8974609375
bpp_loss 4.2269729886736185
