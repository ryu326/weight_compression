I0409 18:09:37.719484 1582087 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:09:37.719584 1582087 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:09:37.719622 1582087 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:09:38.043938 1582087 config.py:54] PyTorch version 2.6.0 available.
W0409 18:09:38.257498 1582087 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:09:38.885493 1582087 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.08it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.76it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.99it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.14it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.21it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  7.68it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.84it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.86it/s]
I0409 18:09:40.358440 1582087 quantize_finetune_llama.py:163] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std:   3%|▎         | 1/32 [00:00<00:20,  1.51it/s]calculating model weight mean & std:   6%|▋         | 2/32 [00:01<00:20,  1.45it/s]calculating model weight mean & std:   9%|▉         | 3/32 [00:02<00:19,  1.47it/s]calculating model weight mean & std:  12%|█▎        | 4/32 [00:02<00:17,  1.61it/s]calculating model weight mean & std:  16%|█▌        | 5/32 [00:03<00:15,  1.70it/s]calculating model weight mean & std:  19%|█▉        | 6/32 [00:03<00:14,  1.78it/s]calculating model weight mean & std:  22%|██▏       | 7/32 [00:04<00:13,  1.87it/s]calculating model weight mean & std:  25%|██▌       | 8/32 [00:04<00:12,  1.94it/s]calculating model weight mean & std:  28%|██▊       | 9/32 [00:05<00:12,  1.78it/s]calculating model weight mean & std:  31%|███▏      | 10/32 [00:05<00:12,  1.76it/s]calculating model weight mean & std:  34%|███▍      | 11/32 [00:06<00:11,  1.77it/s]calculating model weight mean & std:  38%|███▊      | 12/32 [00:06<00:10,  1.86it/s]calculating model weight mean & std:  41%|████      | 13/32 [00:07<00:09,  1.93it/s]calculating model weight mean & std:  44%|████▍     | 14/32 [00:07<00:09,  1.98it/s]calculating model weight mean & std:  47%|████▋     | 15/32 [00:08<00:08,  2.02it/s]calculating model weight mean & std:  50%|█████     | 16/32 [00:08<00:07,  2.07it/s]calculating model weight mean & std:  53%|█████▎    | 17/32 [00:09<00:07,  2.08it/s]calculating model weight mean & std:  56%|█████▋    | 18/32 [00:09<00:06,  2.11it/s]calculating model weight mean & std:  59%|█████▉    | 19/32 [00:10<00:06,  2.02it/s]calculating model weight mean & std:  62%|██████▎   | 20/32 [00:10<00:05,  2.01it/s]calculating model weight mean & std:  66%|██████▌   | 21/32 [00:11<00:05,  2.06it/s]calculating model weight mean & std:  69%|██████▉   | 22/32 [00:11<00:05,  1.93it/s]calculating model weight mean & std:  72%|███████▏  | 23/32 [00:12<00:05,  1.76it/s]calculating model weight mean & std:  75%|███████▌  | 24/32 [00:13<00:05,  1.53it/s]calculating model weight mean & std:  78%|███████▊  | 25/32 [00:14<00:05,  1.34it/s]calculating model weight mean & std:  81%|████████▏ | 26/32 [00:14<00:04,  1.34it/s]calculating model weight mean & std:  84%|████████▍ | 27/32 [00:15<00:03,  1.30it/s]calculating model weight mean & std:  88%|████████▊ | 28/32 [00:16<00:02,  1.42it/s]calculating model weight mean & std:  91%|█████████ | 29/32 [00:16<00:01,  1.54it/s]calculating model weight mean & std:  94%|█████████▍| 30/32 [00:17<00:01,  1.64it/s]calculating model weight mean & std:  97%|█████████▋| 31/32 [00:18<00:00,  1.64it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:18<00:00,  1.52it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:18<00:00,  1.70it/s]
I0409 18:10:07.836759 1582087 quantize_finetune_llama.py:201] loaded compression model
I0409 18:10:29.234201 1582087 quantize_finetune_llama.py:205] loaded dataset and devset
I0409 18:10:32.062700 1582087 quantize_finetune_llama.py:225] layer 0 gpu 0
I0409 18:10:35.072503 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 0 in 2.7317278385162354s
tensor(-4.7143e-06) tensor(0.0125)
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0409 18:10:45.412183 1583205 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:10:45.412277 1583205 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:10:45.412320 1583205 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:10:45.749183 1583205 config.py:54] PyTorch version 2.6.0 available.
W0409 18:10:45.961582 1583205 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:10:46.581952 1583205 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0409 18:10:46.586113 1582087 quantize_finetune_llama.py:225] layer 1 gpu 0
I0409 18:10:46.600136 1583205 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v proxy err 0.012663488276302814 err 0.7710399031639099 tr(WHW.T) 60.88684844970703
bpp_loss 4.403017997741699
0_q proxy err 0.00015234753664117306 err 43.89051055908203 tr(WHW.T) 288094.65625
bpp_loss 3.383499503135681
0_k proxy err 0.00014897323853801936 err 14.924247741699219 tr(WHW.T) 100180.734375
bpp_loss 3.9246712923049927
0_o proxy err 0.0012142793275415897 err 3.7924585342407227 tr(WHW.T) 3123.217529296875
bpp_loss 5.050185441970825
0_up proxy err 0.018107548356056213 err 161.5999298095703 tr(WHW.T) 8924.451171875
bpp_loss 2.9570471899850026
0_gate proxy err 0.01046028546988964 err 165.04934692382812 tr(WHW.T) 15778.666015625
bpp_loss 3.066056524004255
0_down proxy err 0.012809163890779018 err 138.57215881347656 tr(WHW.T) 10818.205078125
bpp_loss 2.9505288941519603
I0409 18:11:23.246521 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 1 in 0.7546262741088867s
I0409 18:11:26.797077 1583987 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:11:26.797179 1583987 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:11:26.797222 1583987 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:11:27.158642 1583987 config.py:54] PyTorch version 2.6.0 available.
W0409 18:11:27.357608 1583987 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:11:27.934011 1583987 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0409 18:11:27.938160 1582087 quantize_finetune_llama.py:225] layer 2 gpu 0
I0409 18:11:27.952197 1583987 data_utils.py:336] using 256 training seqs, 128 validation seqs
1_v proxy err 0.007458393462002277 err 0.8134941458702087 tr(WHW.T) 109.07096099853516
bpp_loss 5.229259729385376
1_q proxy err 0.00020187514019198716 err 29.236865997314453 tr(WHW.T) 144826.484375
bpp_loss 3.6344006061553955
1_k proxy err 0.00012200995115563273 err 9.21651554107666 tr(WHW.T) 75539.046875
bpp_loss 4.297932863235474
1_o proxy err 0.0018466722685843706 err 3.6634879112243652 tr(WHW.T) 1983.8321533203125
bpp_loss 5.514571905136108
1_up proxy err 0.019899675622582436 err 163.7906494140625 tr(WHW.T) 8230.8203125
bpp_loss 2.9713310514177596
1_gate proxy err 0.011976547539234161 err 167.10116577148438 tr(WHW.T) 13952.365234375
bpp_loss 3.077267646789551
1_down proxy err 0.0011802114313468337 err 16.497032165527344 tr(WHW.T) 13978.03125
bpp_loss 2.966089589255197
I0409 18:12:04.936989 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 2 in 0.8257806301116943s
I0409 18:12:08.940059 1584986 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:12:08.940154 1584986 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:12:08.940191 1584986 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:12:09.288280 1584986 config.py:54] PyTorch version 2.6.0 available.
W0409 18:12:09.490420 1584986 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:12:10.041571 1584986 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0409 18:12:10.046125 1582087 quantize_finetune_llama.py:225] layer 3 gpu 0
I0409 18:12:10.061640 1584986 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v proxy err 0.005239218007773161 err 0.8171058297157288 tr(WHW.T) 155.95950317382812
bpp_loss 4.688347578048706
2_q proxy err 0.0008536555105820298 err 35.405494689941406 tr(WHW.T) 41475.15625
bpp_loss 3.5871422290802
2_k proxy err 0.00044646082096733153 err 10.096503257751465 tr(WHW.T) 22614.533203125
bpp_loss 4.409902572631836
2_o proxy err 0.0018475939286872745 err 3.6348133087158203 tr(WHW.T) 1967.3226318359375
bpp_loss 5.221058368682861
2_up proxy err 0.022001607343554497 err 167.22265625 tr(WHW.T) 7600.474609375
bpp_loss 2.9635911669049944
2_gate proxy err 0.011364876292645931 err 171.76097106933594 tr(WHW.T) 15113.31640625
bpp_loss 3.1101083755493164
2_down proxy err 0.019382983446121216 err 149.76698303222656 tr(WHW.T) 7726.72509765625
bpp_loss 2.968707697732108
I0409 18:12:48.679895 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 3 in 0.863795280456543s
I0409 18:12:52.435299 1586135 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:12:52.435397 1586135 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:12:52.435435 1586135 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:12:52.778526 1586135 config.py:54] PyTorch version 2.6.0 available.
W0409 18:12:52.970607 1586135 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:12:53.543422 1586135 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0409 18:12:53.547416 1582087 quantize_finetune_llama.py:225] layer 4 gpu 0
I0409 18:12:53.561188 1586135 data_utils.py:336] using 256 training seqs, 128 validation seqs
3_v proxy err 0.0029445441905409098 err 0.8519542813301086 tr(WHW.T) 289.3331604003906
bpp_loss 5.253667593002319
3_q proxy err 0.0009073480614461005 err 43.1688346862793 tr(WHW.T) 47576.9296875
bpp_loss 3.6291699409484863
3_k proxy err 0.00046918526641093194 err 12.280696868896484 tr(WHW.T) 26174.515625
bpp_loss 4.487837553024292
3_o proxy err 0.0019884181674569845 err 3.6928062438964844 tr(WHW.T) 1857.15771484375
bpp_loss 5.768556833267212
3_up proxy err 0.021916840225458145 err 165.1754913330078 tr(WHW.T) 7536.46484375
bpp_loss 2.9459144047328403
3_gate proxy err 0.008264146745204926 err 172.59130859375 tr(WHW.T) 20884.34765625
bpp_loss 3.183278901236398
3_down proxy err 0.022256692871451378 err 155.7659149169922 tr(WHW.T) 6998.6103515625
bpp_loss 2.945636068071638
I0409 18:13:32.288338 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 4 in 0.9196228981018066s
I0409 18:13:36.112714 1587085 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:13:36.112811 1587085 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:13:36.112852 1587085 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:13:36.435147 1587085 config.py:54] PyTorch version 2.6.0 available.
W0409 18:13:36.622046 1587085 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:13:37.183382 1587085 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0409 18:13:37.187210 1582087 quantize_finetune_llama.py:225] layer 5 gpu 0
I0409 18:13:37.208544 1587085 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v proxy err 0.002983028767630458 err 0.8510793447494507 tr(WHW.T) 285.30712890625
bpp_loss 5.467396020889282
4_q proxy err 0.0007817838340997696 err 39.178985595703125 tr(WHW.T) 50114.859375
bpp_loss 3.5934548377990723
4_k proxy err 0.0003896928974427283 err 11.418771743774414 tr(WHW.T) 29301.974609375
bpp_loss 4.470001220703125
4_o proxy err 0.0027378282975405455 err 3.551642894744873 tr(WHW.T) 1297.2481689453125
bpp_loss 5.817751169204712
4_up proxy err 0.021811403334140778 err 161.0442352294922 tr(WHW.T) 7383.48779296875
bpp_loss 2.918637548174177
4_gate proxy err 0.005875608418136835 err 171.16220092773438 tr(WHW.T) 29130.974609375
bpp_loss 3.2534362248011996
4_down proxy err 0.025052718818187714 err 160.23023986816406 tr(WHW.T) 6395.72265625
bpp_loss 2.9210281712668285
I0409 18:14:13.475756 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 5 in 0.760930061340332s
I0409 18:14:17.210463 1587801 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:14:17.210552 1587801 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:14:17.210591 1587801 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:14:17.527236 1587801 config.py:54] PyTorch version 2.6.0 available.
W0409 18:14:17.712732 1587801 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:14:18.254693 1587801 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0409 18:14:18.258347 1582087 quantize_finetune_llama.py:225] layer 6 gpu 0
I0409 18:14:18.270906 1587801 data_utils.py:336] using 256 training seqs, 128 validation seqs
5_v proxy err 0.003983297385275364 err 0.8317916989326477 tr(WHW.T) 208.81988525390625
bpp_loss 4.90373420715332
5_q proxy err 0.001085177413187921 err 39.05730056762695 tr(WHW.T) 35991.625
bpp_loss 3.568925380706787
5_k proxy err 0.0004810666723642498 err 11.06345272064209 tr(WHW.T) 22997.75390625
bpp_loss 4.444030284881592
5_o proxy err 0.003349847625941038 err 3.5360541343688965 tr(WHW.T) 1055.5865478515625
bpp_loss 5.521865367889404
5_up proxy err 0.020883526653051376 err 159.89332580566406 tr(WHW.T) 7656.43310546875
bpp_loss 2.924120766775949
5_gate proxy err 0.005594679154455662 err 170.00521850585938 tr(WHW.T) 30386.947265625
bpp_loss 3.2563039234706332
5_down proxy err 0.024620218202471733 err 157.84339904785156 tr(WHW.T) 6411.12939453125
bpp_loss 2.926338025501796
I0409 18:14:55.091556 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 6 in 0.9671342372894287s
I0409 18:14:59.294537 1588675 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0409 18:14:59.294667 1588675 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0409 18:14:59.294708 1588675 utils.py:162] NumExpr defaulting to 16 threads.
I0409 18:14:59.621693 1588675 config.py:54] PyTorch version 2.6.0 available.
W0409 18:14:59.810983 1588675 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0409 18:15:00.359504 1588675 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0409 18:15:00.364506 1582087 quantize_finetune_llama.py:225] layer 7 gpu 0
I0409 18:15:00.386966 1588675 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v proxy err 0.0033286483958363533 err 0.844257652759552 tr(WHW.T) 253.63377380371094
bpp_loss 5.1716203689575195
6_q proxy err 0.0011201255256310105 err 39.92081069946289 tr(WHW.T) 35639.5859375
bpp_loss 3.6149553060531616
6_k proxy err 0.00043441506568342447 err 11.365885734558105 tr(WHW.T) 26163.654296875
bpp_loss 4.5149827003479
6_o proxy err 0.0034915839787572622 err 3.523526191711426 tr(WHW.T) 1009.1483764648438
bpp_loss 5.707575082778931
6_up proxy err 0.019796008244156837 err 156.8543701171875 tr(WHW.T) 7923.53564453125
bpp_loss 2.923250879560198
6_gate proxy err 0.004691264126449823 err 167.7051544189453 tr(WHW.T) 35748.39453125
bpp_loss 3.26095826285226
6_down proxy err 0.02444501593708992 err 158.49072265625 tr(WHW.T) 6483.5595703125
bpp_loss 2.926492316382272
I0409 18:15:39.110629 1582087 quantize_finetune_llama.py:256] computed original embedding for layer 7 in 0.8501968383789062s
