I0408 09:39:55.390081 535569 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:39:55.390184 535569 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:39:55.390222 535569 utils.py:162] NumExpr defaulting to 16 threads.
I0408 09:39:55.710559 535569 config.py:54] PyTorch version 2.6.0 available.
W0408 09:39:55.899431 535569 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 09:39:56.524006 535569 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.22it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.61it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.82it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  7.94it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.08it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  8.13it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.27it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  8.05it/s]
I0408 09:39:57.966668 535569 quantize_finetune_llama.py:158] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:00<00:00, 16838.25it/s]
I0408 09:40:01.316994 535569 quantize_finetune_llama.py:196] loaded compression model
I0408 09:40:18.928756 535569 quantize_finetune_llama.py:200] loaded dataset and devset
I0408 09:40:24.513595 535569 quantize_finetune_llama.py:220] layer 0 gpu 0
I0408 09:40:28.503607 535569 quantize_finetune_llama.py:251] computed original embedding for layer 0 in 3.8319666385650635s
tensor(-4.7143e-06) tensor(0.0125)
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0408 09:40:42.778206 536196 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:40:42.778305 536196 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:40:42.778342 536196 utils.py:162] NumExpr defaulting to 16 threads.
I0408 09:40:43.100270 536196 config.py:54] PyTorch version 2.6.0 available.
W0408 09:40:43.286999 536196 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 09:40:43.828787 536196 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:40:43.832744 535569 quantize_finetune_llama.py:220] layer 1 gpu 1
I0408 09:40:43.846143 536196 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.87it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.58it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.94it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.14it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.27it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.49it/s]I0408 09:40:47.696256 535569 quantize_finetune_llama.py:251] computed original embedding for layer 1 in 3.693326473236084s
v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:25,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:23,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.43it/s]I0408 09:40:51.126811 536346 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:40:51.126910 536346 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:40:51.126949 536346 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.45it/s]I0408 09:40:51.454435 536346 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.45it/s]W0408 09:40:51.641831 536346 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.44it/s]W0408 09:40:52.211255 536346 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:40:52.214911 535569 quantize_finetune_llama.py:220] layer 2 gpu 2
I0408 09:40:52.228420 536346 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.44it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:51,  1.93it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.65it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.01it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.44it/s]I0408 09:40:55.909314 535569 quantize_finetune_llama.py:251] computed original embedding for layer 2 in 3.5461008548736572s
v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.41it/s]I0408 09:40:59.360409 536513 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:40:59.360509 536513 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:40:59.360549 536513 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.55it/s]I0408 09:40:59.682442 536513 config.py:54] PyTorch version 2.6.0 available.
W0408 09:40:59.870340 536513 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]W0408 09:41:00.432557 536513 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:41:00.436226 535569 quantize_finetune_llama.py:220] layer 3 gpu 3
I0408 09:41:00.449685 536513 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.43it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.90it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:12,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.63it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.00it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.33it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.45it/s]I0408 09:41:03.247101 535569 quantize_finetune_llama.py:251] computed original embedding for layer 3 in 2.6514909267425537s
v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.94it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.08it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.18it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.25it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.41it/s]I0408 09:41:06.737538 536661 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:41:06.737637 536661 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:41:06.737675 536661 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.43it/s]I0408 09:41:07.074671 536661 config.py:54] PyTorch version 2.6.0 available.
W0408 09:41:07.273779 536661 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.44it/s]W0408 09:41:07.847259 536661 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:41:07.850994 535569 quantize_finetune_llama.py:220] layer 4 gpu 0
I0408 09:41:07.864489 536661 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.43it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.87it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.61it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.99it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.20it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.60it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.59it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.98it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.59it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.24it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:23,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.41it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.39it/s]
v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]tensor(-3.7533e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0105, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0104, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9993, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0103, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9898, device='cuda:0', grad_fn=<MinBackward1>)
0_v proxy err 0.046038106083869934 err 2.803115129470825 tr(WHW.T) 60.88684844970703
bpp_loss 3.2417001724243164
0_q proxy err 0.00010959242354147136 err 31.5729923248291 tr(WHW.T) 288094.65625
bpp_loss 4.030368447303772
0_k proxy err 9.983196650864556e-05 err 10.001239776611328 tr(WHW.T) 100180.734375
bpp_loss 4.642569065093994
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.97it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.59it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.61it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.55it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.49it/s]
v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:14,  3.60it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:08,  3.12s/it]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.60it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:13,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.46it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.46it/s]tensor(1.8789e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0085, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0084, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0084, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9915, device='cuda:1', grad_fn=<MinBackward1>)
1_v proxy err 0.03343712538480759 err 3.647019386291504 tr(WHW.T) 109.07096099853516
bpp_loss 3.3575327396392822
1_q proxy err 0.00018466476467438042 err 26.744348526000977 tr(WHW.T) 144826.484375
bpp_loss 4.268676280975342
1_k proxy err 0.00010360204760218039 err 7.825999736785889 tr(WHW.T) 75539.046875
bpp_loss 4.983175754547119
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.01it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.53it/s]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:03,  3.13s/it]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.15it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.33it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.45it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.09s/it]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.52it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.46it/s]
v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.57it/s]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.55it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:23<00:04,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.51it/s]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:25<00:02,  3.52it/s]tensor(-4.1979e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0070, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0069, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0070, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9934, device='cuda:2', grad_fn=<MinBackward1>)
2_v proxy err 0.019330864772200584 err 3.014832019805908 tr(WHW.T) 155.95950317382812
bpp_loss 3.299957036972046
2_q proxy err 0.000551645818632096 err 22.879596710205078 tr(WHW.T) 41475.15625
bpp_loss 4.24832010269165
2_k proxy err 0.0002991344372276217 err 6.7647857666015625 tr(WHW.T) 22614.533203125
bpp_loss 5.134323596954346
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.54it/s]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.57it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.57it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]
o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:51,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]tensor(1.0913e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0059, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0067, device='cuda:3', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0066, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9944, device='cuda:3', grad_fn=<MinBackward1>)
3_v proxy err 0.012077699415385723 err 3.494478940963745 tr(WHW.T) 289.3331604003906
bpp_loss 3.3997106552124023
3_q proxy err 0.0004838559834752232 err 23.020381927490234 tr(WHW.T) 47576.9296875
bpp_loss 4.282341003417969
3_k proxy err 0.0002550834615249187 err 6.676685810089111 tr(WHW.T) 26174.515625
bpp_loss 5.20915412902832
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.08s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:32,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:04,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:57,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<03:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:39,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:32,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:15,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:14,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:14,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:57,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:44,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:49,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:23,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:20,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:16,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:04,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:11,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:04,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:53,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<02:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:54,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:27<01:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:22,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:23,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:31,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:49<01:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:09,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:08<01:07,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:11<01:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<01:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:27<00:47,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:30<00:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:33<00:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:30,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:52<00:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:55<00:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.09s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:11<00:03,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.10s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.15s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
tensor(-1.3589e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0220, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0216, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9987, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0123, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9780, device='cuda:0', grad_fn=<MinBackward1>)
0_o proxy err 0.004530939273536205 err 14.151108741760254 tr(WHW.T) 3123.217529296875
bpp_loss 3.248993158340454
0_up proxy err 0.007260303944349289 err 64.79422760009766 tr(WHW.T) 8924.451171875
bpp_loss 3.6066859449659074
0_gate proxy err 0.0042414856143295765 err 66.92498779296875 tr(WHW.T) 15778.666015625
bpp_loss 3.7081523963383267
0_down proxy err 0.00590786337852478 err 63.912479400634766 tr(WHW.T) 10818.205078125
bpp_loss 3.5998972484043668
tensor(-2.3733e-08, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0139, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0149, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9996, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0101, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9850, device='cuda:1', grad_fn=<MinBackward1>)
1_o proxy err 0.007767938543111086 err 15.410285949707031 tr(WHW.T) 1983.8321533203125
bpp_loss 3.3572202920913696
1_up proxy err 0.007898249663412571 err 65.00907135009766 tr(WHW.T) 8230.8203125
bpp_loss 3.6220274652753557
1_gate proxy err 0.004808362573385239 err 67.08802795410156 tr(WHW.T) 13952.365234375
bpp_loss 3.7258975165230885
1_down proxy err 0.003645973978564143 err 50.963539123535156 tr(WHW.T) 13978.03125
bpp_loss 3.617948532104492
I0408 09:47:10.653787 535569 quantize_finetune_llama.py:251] computed original embedding for layer 4 in 0.8075101375579834s
I0408 09:47:14.616583 540738 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:47:14.616695 540738 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:47:14.616741 540738 utils.py:162] NumExpr defaulting to 16 threads.
I0408 09:47:15.009054 540738 config.py:54] PyTorch version 2.6.0 available.
W0408 09:47:15.223284 540738 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 09:47:15.839242 540738 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:47:15.843305 535569 quantize_finetune_llama.py:220] layer 5 gpu 1
I0408 09:47:15.857799 540738 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.75it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.46it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.82it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.03it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.15it/s]tensor(1.4699e-06, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0139, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0135, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9996, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0132, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9861, device='cuda:2', grad_fn=<MinBackward1>)
2_o proxy err 0.007464014459401369 err 14.684124946594238 tr(WHW.T) 1967.3226318359375
bpp_loss 3.2822290658950806
2_up proxy err 0.008531047962605953 err 64.84001159667969 tr(WHW.T) 7600.474609375
bpp_loss 3.6178698199135915
2_gate proxy err 0.004477299749851227 err 67.6668472290039 tr(WHW.T) 15113.31640625
bpp_loss 3.7600429398672923
2_down proxy err 0.008391709066927433 err 64.8404312133789 tr(WHW.T) 7726.72509765625
bpp_loss 3.6206304005214145
v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.23it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:27,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.41it/s]I0408 09:47:20.280825 535569 quantize_finetune_llama.py:251] computed original embedding for layer 5 in 0.8074331283569336s
v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:25,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:24,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:24,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:23,  3.43it/s]tensor(-6.1753e-07, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0108, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0099, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0108, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9904, device='cuda:3', grad_fn=<MinBackward1>)
3_o proxy err 0.008897559717297554 err 16.524171829223633 tr(WHW.T) 1857.15771484375
bpp_loss 3.4175115823745728
3_up proxy err 0.008567577227950096 err 64.56924438476562 tr(WHW.T) 7536.46484375
bpp_loss 3.598167794091361
3_gate proxy err 0.0033106436021625996 err 69.14063262939453 tr(WHW.T) 20884.34765625
bpp_loss 3.831740583692278
3_down proxy err 0.00920895766466856 err 64.44990539550781 tr(WHW.T) 6998.6103515625
bpp_loss 3.595522335597447
v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:07<00:22,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.41it/s]I0408 09:47:23.995914 540925 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:47:23.996015 540925 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:47:23.996054 540925 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.43it/s]I0408 09:47:24.317524 540925 config.py:54] PyTorch version 2.6.0 available.
W0408 09:47:24.503685 540925 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.43it/s]W0408 09:47:25.070665 540925 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:47:25.074616 535569 quantize_finetune_llama.py:220] layer 6 gpu 2
I0408 09:47:25.094911 540925 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:20,  3.40it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.89it/s]I0408 09:47:26.204234 535569 quantize_finetune_llama.py:251] computed original embedding for layer 6 in 0.730257511138916s
v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.60it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.97it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:19,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.17it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:18,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.39it/s]I0408 09:47:29.659989 541064 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:47:29.660087 541064 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:47:29.660126 541064 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.40it/s]I0408 09:47:29.986058 541064 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.42it/s]W0408 09:47:30.174062 541064 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:14<00:15,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.45it/s]W0408 09:47:30.747944 541064 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:47:30.751688 535569 quantize_finetune_llama.py:220] layer 7 gpu 3
I0408 09:47:30.765091 541064 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.56it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:01,  1.62it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.45it/s]I0408 09:47:31.895120 535569 quantize_finetune_llama.py:251] computed original embedding for layer 7 in 0.7318916320800781s
v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.38it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.79it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.04it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.20it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:12,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:19<00:10,  3.42it/s]I0408 09:47:35.422398 541190 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:47:35.422502 541190 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:47:35.422543 541190 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.42it/s]I0408 09:47:35.744122 541190 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.54it/s]W0408 09:47:35.935685 541190 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:11,  2.93it/s]W0408 09:47:36.487152 541190 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:47:36.490965 535569 quantize_finetune_llama.py:220] layer 8 gpu 0
I0408 09:47:36.506471 541190 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.06it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.53it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.89it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.61it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.97it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.18it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:25<00:04,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.97it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.53it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.41it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.36it/s]
v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.94it/s]tensor(2.9475e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0072, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0072, device='cuda:0', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0072, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9931, device='cuda:0', grad_fn=<MinBackward1>)
4_v proxy err 0.013147421181201935 err 3.7510530948638916 tr(WHW.T) 285.30712890625
bpp_loss 3.4345762729644775
4_q proxy err 0.000455692206742242 err 22.836950302124023 tr(WHW.T) 50114.859375
bpp_loss 4.246515989303589
4_k proxy err 0.00023073672491591424 err 6.761041641235352 tr(WHW.T) 29301.974609375
bpp_loss 5.1801557540893555
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.09it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.29it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.50it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:09,  3.13s/it]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.52it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.53it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.46it/s]
v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.96it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.10it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.20it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.49it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:08,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.27it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.48it/s]tensor(3.2169e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0075, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0076, device='cuda:1', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0076, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9926, device='cuda:1', grad_fn=<MinBackward1>)
5_v proxy err 0.015451117418706417 err 3.2265005111694336 tr(WHW.T) 208.81988525390625
bpp_loss 3.3306400775909424
5_q proxy err 0.0006219731876626611 err 22.385826110839844 tr(WHW.T) 35991.625
bpp_loss 4.229933261871338
5_k proxy err 0.00028542184736579657 err 6.564061641693115 tr(WHW.T) 22997.75390625
bpp_loss 5.1647467613220215
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.45it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.45it/s]
o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.48it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.09s/it]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.49it/s]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:02,  3.15s/it]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.51it/s]tensor(1.2075e-06, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0067, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0069, device='cuda:2', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0069, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9933, device='cuda:2', grad_fn=<MinBackward1>)
6_v proxy err 0.013552206568419933 err 3.4372973442077637 tr(WHW.T) 253.63377380371094
bpp_loss 3.3848469257354736
6_q proxy err 0.0006306796567514539 err 22.477161407470703 tr(WHW.T) 35639.5859375
bpp_loss 4.279874086380005
6_k proxy err 0.0002598010760266334 err 6.797345161437988 tr(WHW.T) 26163.654296875
bpp_loss 5.227919101715088
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.51it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.46it/s]
o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.14s/it]tensor(9.2682e-07, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0071, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0075, device='cuda:3', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0073, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9926, device='cuda:3', grad_fn=<MinBackward1>)
7_v proxy err 0.0110259298235178 err 3.4117214679718018 tr(WHW.T) 309.4270935058594
bpp_loss 3.3797707557678223
7_q proxy err 0.0006259562214836478 err 21.999202728271484 tr(WHW.T) 35144.953125
bpp_loss 4.204926490783691
7_k proxy err 0.0002490907208994031 err 6.68820858001709 tr(WHW.T) 26850.4921875
bpp_loss 5.259917259216309
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.08s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:26,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:23,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:15,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:57,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:49,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:39,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:17,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:21,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:32,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:13,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:57,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:44,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:47,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:39,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:22,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:04,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:57,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:11,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:24<01:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:27<01:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:43,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:31,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:46<01:27,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:49<01:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:14,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:15,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:57,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:12,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:08<01:06,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:11<01:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:07,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<00:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:56,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<01:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:33<00:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:25,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:55<00:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.20s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.10s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.13s/it]
o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:11<00:03,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.14s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
tensor(3.6639e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0106, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0112, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0097, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9888, device='cuda:0', grad_fn=<MinBackward1>)
4_o proxy err 0.012615535408258438 err 16.365480422973633 tr(WHW.T) 1297.2481689453125
bpp_loss 3.4291460514068604
4_up proxy err 0.008679541759192944 err 64.08528900146484 tr(WHW.T) 7383.48779296875
bpp_loss 3.571086508887155
4_gate proxy err 0.002426103688776493 err 70.67476654052734 tr(WHW.T) 29130.974609375
bpp_loss 3.9015627588544572
4_down proxy err 0.010018824599683285 err 64.07762145996094 tr(WHW.T) 6395.72265625
bpp_loss 3.5689394814627513
tensor(2.2605e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0138, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0138, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0129, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9861, device='cuda:1', grad_fn=<MinBackward1>)
5_o proxy err 0.015049843117594719 err 15.886411666870117 tr(WHW.T) 1055.5865478515625
bpp_loss 3.341976284980774
5_up proxy err 0.008384881541132927 err 64.19828796386719 tr(WHW.T) 7656.43310546875
bpp_loss 3.5776535783495222
5_gate proxy err 0.002333512296900153 err 70.90831756591797 tr(WHW.T) 30386.947265625
bpp_loss 3.904359442847116
5_down proxy err 0.009993154555559158 err 64.0674057006836 tr(WHW.T) 6411.12939453125
bpp_loss 3.5734197071620395
I0408 09:53:44.080263 535569 quantize_finetune_llama.py:251] computed original embedding for layer 8 in 1.0476710796356201s
I0408 09:53:48.078772 545293 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:53:48.078871 545293 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:53:48.078912 545293 utils.py:162] NumExpr defaulting to 16 threads.
I0408 09:53:48.429581 545293 config.py:54] PyTorch version 2.6.0 available.
W0408 09:53:48.643390 545293 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

tensor(9.9508e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0161, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0125, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0161, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9875, device='cuda:2', grad_fn=<MinBackward1>)
6_o proxy err 0.016585374251008034 err 16.737104415893555 tr(WHW.T) 1009.1483764648438
bpp_loss 3.3891743421554565
6_up proxy err 0.00811244547367096 err 64.27925109863281 tr(WHW.T) 7923.53564453125
bpp_loss 3.5775199958256314
6_gate proxy err 0.00198932527564466 err 71.11518096923828 tr(WHW.T) 35748.39453125
bpp_loss 3.9081943375723704
6_down proxy err 0.009887350723147392 err 64.105224609375 tr(WHW.T) 6483.5595703125
bpp_loss 3.572333335876465
W0408 09:53:49.266185 545293 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:53:49.270239 535569 quantize_finetune_llama.py:220] layer 9 gpu 1
I0408 09:53:49.284806 545293 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.75it/s]I0408 09:53:50.669614 535569 quantize_finetune_llama.py:251] computed original embedding for layer 9 in 0.7766942977905273s
v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.47it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.83it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.04it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.17it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.24it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.35it/s]tensor(1.2044e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0116, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0128, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0124, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9879, device='cuda:3', grad_fn=<MinBackward1>)
7_o proxy err 0.01743011735379696 err 16.71923828125 tr(WHW.T) 959.2155151367188
bpp_loss 3.390963315963745
7_up proxy err 0.007480317261070013 err 64.53606414794922 tr(WHW.T) 8627.4501953125
bpp_loss 3.590876885822841
7_gate proxy err 0.0020240333396941423 err 70.64591979980469 tr(WHW.T) 34903.53515625
bpp_loss 3.8793918745858327
7_down proxy err 0.009830950759351254 err 64.24160766601562 tr(WHW.T) 6534.6279296875
bpp_loss 3.5851635251726424
v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.49it/s]I0408 09:53:54.251049 545434 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:53:54.251147 545434 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:53:54.251184 545434 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.48it/s]I0408 09:53:54.569666 545434 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.50it/s]W0408 09:53:54.757236 545434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.50it/s]W0408 09:53:55.311830 545434 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:53:55.315573 535569 quantize_finetune_llama.py:220] layer 10 gpu 2
I0408 09:53:55.328625 545434 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.47it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.77it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.45it/s]I0408 09:53:56.501742 535569 quantize_finetune_llama.py:251] computed original embedding for layer 10 in 0.7664101123809814s
v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.48it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.85it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.08it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.51it/s]I0408 09:54:00.047112 545565 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:54:00.047206 545565 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:54:00.047247 545565 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.51it/s]I0408 09:54:00.374681 545565 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.46it/s]W0408 09:54:00.563273 545565 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.46it/s]W0408 09:54:01.131294 545565 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:54:01.134947 535569 quantize_finetune_llama.py:220] layer 11 gpu 3
I0408 09:54:01.148240 545565 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.50it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:51,  1.94it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.49it/s]I0408 09:54:02.413250 535569 quantize_finetune_llama.py:251] computed original embedding for layer 11 in 0.8572447299957275s
v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.62it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.93it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.14it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.23it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.51it/s]I0408 09:54:05.902399 545693 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 09:54:05.902492 545693 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 09:54:05.902533 545693 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.53it/s]I0408 09:54:06.222430 545693 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.46it/s]W0408 09:54:06.412213 545693 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.44it/s]W0408 09:54:06.962043 545693 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 09:54:06.965935 535569 quantize_finetune_llama.py:220] layer 12 gpu 0
I0408 09:54:06.982837 545693 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.48it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.85it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.59it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.93it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.14it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.28it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.89it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.04it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.15it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.23it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.28it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.93it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.06it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.25it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.29it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]
v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.94it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.08it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.25it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.33it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.48it/s]tensor(5.3591e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0072, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0072, device='cuda:0', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0072, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9929, device='cuda:0', grad_fn=<MinBackward1>)
8_v proxy err 0.01363039668649435 err 3.512624502182007 tr(WHW.T) 257.7052307128906
bpp_loss 3.3975021839141846
8_q proxy err 0.0008174876566044986 err 21.745969772338867 tr(WHW.T) 26600.9765625
bpp_loss 4.193664312362671
8_k proxy err 0.0002874924975913018 err 6.476845741271973 tr(WHW.T) 22528.748046875
bpp_loss 5.1715288162231445
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.45it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.43it/s]
v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.98it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.45it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:09,  3.13s/it]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.29it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.44it/s]tensor(-5.1337e-07, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0077, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0077, device='cuda:1', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0077, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9928, device='cuda:1', grad_fn=<MinBackward1>)
9_v proxy err 0.010980573482811451 err 3.8588898181915283 tr(WHW.T) 351.4288024902344
bpp_loss 3.4846842288970947
9_q proxy err 0.000850945245474577 err 21.829496383666992 tr(WHW.T) 25653.232421875
bpp_loss 4.201360464096069
9_k proxy err 0.00031036132713779807 err 6.499785423278809 tr(WHW.T) 20942.638671875
bpp_loss 5.189379692077637
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.44it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.48it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.45it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.43it/s]
v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.46it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.10s/it]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.49it/s]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.49it/s]tensor(1.5787e-06, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0080, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0081, device='cuda:2', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0080, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9919, device='cuda:2', grad_fn=<MinBackward1>)
10_v proxy err 0.013654195703566074 err 3.438657522201538 tr(WHW.T) 251.83889770507812
bpp_loss 3.3835721015930176
10_q proxy err 0.0009356678347103298 err 21.836761474609375 tr(WHW.T) 23338.15625
bpp_loss 4.212794780731201
10_k proxy err 0.00032940658275038004 err 6.50378942489624 tr(WHW.T) 19743.95703125
bpp_loss 5.199295997619629
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.52it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.48it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.44it/s]
o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:02,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]tensor(1.0270e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0070, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0072, device='cuda:3', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0072, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9931, device='cuda:3', grad_fn=<MinBackward1>)
11_v proxy err 0.010880626738071442 err 3.477112293243408 tr(WHW.T) 319.5691223144531
bpp_loss 3.393099308013916
11_q proxy err 0.0009664437966421247 err 21.446256637573242 tr(WHW.T) 22190.8984375
bpp_loss 4.146041631698608
11_k proxy err 0.00036573238321579993 err 6.593212604522705 tr(WHW.T) 18027.423828125
bpp_loss 5.195851802825928
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:02,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:57,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:39,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:39,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:32,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:32,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:15,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:14,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<03:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:49,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:48,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:34,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:31,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:26,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:28,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:23,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:20,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:15,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:16,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:11,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:04,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:22<01:54,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:47,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:50,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:34,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:34,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:03<01:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:18,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:15,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:12,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:08<01:07,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<00:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:09,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:56,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:11<01:03,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:07,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<01:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:57,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<01:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:41<00:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:30<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:33<00:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:27,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:24,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:52<00:22,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:55<00:18,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:22,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.14s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.13s/it]
o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.22s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.15s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.13s/it]
tensor(-1.6024e-07, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0143, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0149, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0150, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9858, device='cuda:0', grad_fn=<MinBackward1>)
8_o proxy err 0.022727182134985924 err 16.945526123046875 tr(WHW.T) 745.6061401367188
bpp_loss 3.399254083633423
8_up proxy err 0.0075810132548213005 err 64.401123046875 tr(WHW.T) 8495.0546875
bpp_loss 3.586514336722238
8_gate proxy err 0.001897207461297512 err 70.64849090576172 tr(WHW.T) 37238.1484375
bpp_loss 3.8833649839673723
8_down proxy err 0.009889689274132252 err 64.1723861694336 tr(WHW.T) 6488.8173828125
bpp_loss 3.58147280556815
tensor(-1.3654e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0143, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0144, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0144, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9862, device='cuda:1', grad_fn=<MinBackward1>)
9_o proxy err 0.022503497079014778 err 17.476255416870117 tr(WHW.T) 776.6017456054688
bpp_loss 3.455770254135132
9_up proxy err 0.007190039847046137 err 64.49929809570312 tr(WHW.T) 8970.6455078125
bpp_loss 3.595087630408151
9_gate proxy err 0.0018006039317697287 err 70.97209930419922 tr(WHW.T) 39415.71875
bpp_loss 3.896738052368164
9_down proxy err 0.010235566645860672 err 64.20672607421875 tr(WHW.T) 6272.90380859375
bpp_loss 3.5844293321881975
I0408 10:00:14.585282 535569 quantize_finetune_llama.py:251] computed original embedding for layer 12 in 0.9848132133483887s
I0408 10:00:18.457272 549799 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:00:18.457390 549799 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:00:18.457435 549799 utils.py:162] NumExpr defaulting to 16 threads.
I0408 10:00:18.839384 549799 config.py:54] PyTorch version 2.6.0 available.
tensor(-3.7861e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0147, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0136, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0147, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9870, device='cuda:2', grad_fn=<MinBackward1>)
10_o proxy err 0.02450055442750454 err 16.676647186279297 tr(WHW.T) 680.6640625
bpp_loss 3.3942676782608032
10_up proxy err 0.007056971546262503 err 64.9181900024414 tr(WHW.T) 9199.1572265625
bpp_loss 3.6122402804238454
10_gate proxy err 0.001883380115032196 err 70.4372329711914 tr(WHW.T) 37399.37109375
bpp_loss 3.8660552161080495
10_down proxy err 0.00988424476236105 err 64.49700164794922 tr(WHW.T) 6525.2333984375
bpp_loss 3.5992355346679688
W0408 10:00:19.059176 549799 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 10:00:19.687308 549799 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:00:19.691436 535569 quantize_finetune_llama.py:220] layer 13 gpu 1
I0408 10:00:19.706738 549799 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:59,  1.66it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.39it/s]I0408 10:00:21.146986 535569 quantize_finetune_llama.py:251] computed original embedding for layer 13 in 0.9603767395019531s
v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:35,  2.77it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:32,  2.99it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.28it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.33it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:27,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.42it/s]tensor(1.5485e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0157, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0165, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0166, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9844, device='cuda:3', grad_fn=<MinBackward1>)
11_o proxy err 0.030070548877120018 err 17.01835823059082 tr(WHW.T) 565.9476928710938
bpp_loss 3.403050661087036
11_up proxy err 0.007063227705657482 err 64.92939758300781 tr(WHW.T) 9192.595703125
bpp_loss 3.6186180795942033
11_gate proxy err 0.0019016986479982734 err 70.1424331665039 tr(WHW.T) 36884.09375
bpp_loss 3.8462506362370084
11_down proxy err 0.009721248410642147 err 64.70356750488281 tr(WHW.T) 6655.890625
bpp_loss 3.6065514428274974
v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.47it/s]I0408 10:00:24.918471 549963 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:00:24.918559 549963 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:00:24.918598 549963 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.47it/s]I0408 10:00:25.240510 549963 config.py:54] PyTorch version 2.6.0 available.
W0408 10:00:25.428836 549963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.47it/s]W0408 10:00:26.008424 549963 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:00:26.012068 535569 quantize_finetune_llama.py:220] layer 14 gpu 2
I0408 10:00:26.024981 549963 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.44it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:58,  1.68it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:40,  2.44it/s]I0408 10:00:27.457870 535569 quantize_finetune_llama.py:251] computed original embedding for layer 14 in 1.0333969593048096s
v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.84it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.05it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:20,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.45it/s]I0408 10:00:31.010926 550098 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:00:31.011021 550098 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:00:31.011059 550098 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.58it/s]I0408 10:00:31.331610 550098 config.py:54] PyTorch version 2.6.0 available.
W0408 10:00:31.520650 550098 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.45it/s]W0408 10:00:32.057188 550098 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:00:32.060848 535569 quantize_finetune_llama.py:220] layer 15 gpu 3
I0408 10:00:32.073809 550098 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.43it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.90it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.62it/s]I0408 10:00:33.385977 535569 quantize_finetune_llama.py:251] computed original embedding for layer 15 in 0.894402265548706s
v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.95it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.15it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:25,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.44it/s]I0408 10:00:36.925884 550229 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:00:36.925982 550229 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:00:36.926024 550229 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.55it/s]I0408 10:00:37.250052 550229 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.43it/s]W0408 10:00:37.439545 550229 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.44it/s]W0408 10:00:37.995652 550229 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:00:37.999535 535569 quantize_finetune_llama.py:220] layer 16 gpu 0
I0408 10:00:38.016398 550229 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.53it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.87it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.59it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.94it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.15it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.28it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.91it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.05it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.29it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.33it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.99it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:21,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.23it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.51it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]
v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.92it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.08it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.19it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.52it/s]tensor(2.9700e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0072, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0073, device='cuda:0', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0073, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9932, device='cuda:0', grad_fn=<MinBackward1>)
12_v proxy err 0.011035914532840252 err 4.012916564941406 tr(WHW.T) 363.6233825683594
bpp_loss 3.49420166015625
12_q proxy err 0.0006475064437836409 err 22.081668853759766 tr(WHW.T) 34102.625
bpp_loss 4.197685718536377
12_k proxy err 0.00028295646188780665 err 6.524138927459717 tr(WHW.T) 23057.041015625
bpp_loss 5.181294918060303
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.53it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.48it/s]
v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.49it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:10,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.96it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.09it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.20it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.27it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.40it/s]tensor(4.7829e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0073, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0073, device='cuda:1', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0073, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9934, device='cuda:1', grad_fn=<MinBackward1>)
13_v proxy err 0.01320226676762104 err 3.698662042617798 tr(WHW.T) 280.153564453125
bpp_loss 3.43632173538208
13_q proxy err 0.0010272531071677804 err 21.466894149780273 tr(WHW.T) 20897.375
bpp_loss 4.180989980697632
13_k proxy err 0.00036255206214264035 err 6.453033447265625 tr(WHW.T) 17798.916015625
bpp_loss 5.20693826675415
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.47it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.45it/s]
v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.52it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.09s/it]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.50it/s]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:03,  3.13s/it]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.48it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.12s/it]tensor(3.7125e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0068, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0067, device='cuda:2', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0068, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9936, device='cuda:2', grad_fn=<MinBackward1>)
14_v proxy err 0.012964257970452309 err 3.6473422050476074 tr(WHW.T) 281.3382873535156
bpp_loss 3.4340415000915527
14_q proxy err 0.0010343026369810104 err 21.59813690185547 tr(WHW.T) 20881.8359375
bpp_loss 4.153017520904541
14_k proxy err 0.0003490325470920652 err 6.498741149902344 tr(WHW.T) 18619.298828125
bpp_loss 5.1590681076049805
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.49it/s]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.45it/s]
o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]tensor(1.6572e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0073, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0073, device='cuda:3', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0073, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9929, device='cuda:3', grad_fn=<MinBackward1>)
15_v proxy err 0.013567110523581505 err 3.8534274101257324 tr(WHW.T) 284.0271301269531
bpp_loss 3.4844489097595215
15_q proxy err 0.0007833624258637428 err 21.996273040771484 tr(WHW.T) 28079.306640625
bpp_loss 4.286397933959961
15_k proxy err 0.0003503337502479553 err 6.611382007598877 tr(WHW.T) 18871.66796875
bpp_loss 5.18640661239624
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.08s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:51,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:44,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:26,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:59,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:57,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:43,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:32,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:36,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:17,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:18,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:14,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<02:59,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:11,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:00,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:24,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:31,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:28,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:25,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:22,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:11,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:04,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:09,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<02:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:57,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:24<01:50,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:01,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:54,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:44,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:51,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:27<01:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:23,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:20,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:14,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:04,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:57,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<01:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:08,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<00:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:56,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:30,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.20s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
tensor(1.6140e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0128, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0128, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0128, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9886, device='cuda:0', grad_fn=<MinBackward1>)
12_o proxy err 0.022710032761096954 err 17.70863151550293 tr(WHW.T) 779.7713012695312
bpp_loss 3.4617128372192383
12_up proxy err 0.006503316108137369 err 65.20976257324219 tr(WHW.T) 10027.1552734375
bpp_loss 3.638040781021118
12_gate proxy err 0.0018707729177549481 err 69.8436279296875 tr(WHW.T) 37334.1015625
bpp_loss 3.8258458205631802
12_down proxy err 0.009490089491009712 err 64.7481460571289 tr(WHW.T) 6822.7119140625
bpp_loss 3.6227006912231445
tensor(1.2839e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0146, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0144, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0146, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9859, device='cuda:1', grad_fn=<MinBackward1>)
13_o proxy err 0.02584206312894821 err 17.44873809814453 tr(WHW.T) 675.2068481445312
bpp_loss 3.440885901451111
13_up proxy err 0.006525702774524689 err 65.32416534423828 tr(WHW.T) 10010.2880859375
bpp_loss 3.6415088857923235
13_gate proxy err 0.0018009464256465435 err 70.09510803222656 tr(WHW.T) 38921.26171875
bpp_loss 3.830236094338553
13_down proxy err 0.0099127646535635 err 65.03275299072266 tr(WHW.T) 6560.505859375
bpp_loss 3.6233628136771068
I0408 10:06:45.775099 535569 quantize_finetune_llama.py:251] computed original embedding for layer 16 in 0.9870598316192627s
I0408 10:06:49.777273 554323 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:06:49.777379 554323 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:06:49.777421 554323 utils.py:162] NumExpr defaulting to 16 threads.
tensor(-2.6164e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0159, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0165, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0165, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9842, device='cuda:2', grad_fn=<MinBackward1>)
14_o proxy err 0.025534512475132942 err 17.524276733398438 tr(WHW.T) 686.2976684570312
bpp_loss 3.4270191192626953
14_up proxy err 0.007114281412214041 err 65.19731903076172 tr(WHW.T) 9164.287109375
bpp_loss 3.637215648378645
14_gate proxy err 0.0016857108566910028 err 70.43881225585938 tr(WHW.T) 41785.8203125
bpp_loss 3.8602141993386403
14_down proxy err 0.010157419368624687 err 64.91521453857422 tr(WHW.T) 6390.916015625
bpp_loss 3.621612548828125
I0408 10:06:50.152839 554323 config.py:54] PyTorch version 2.6.0 available.
W0408 10:06:50.377812 554323 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 10:06:51.009074 554323 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:06:51.013201 535569 quantize_finetune_llama.py:220] layer 17 gpu 1
I0408 10:06:51.028280 554323 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.78it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.50it/s]I0408 10:06:52.399386 535569 quantize_finetune_llama.py:251] computed original embedding for layer 17 in 0.9277124404907227s
v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.80it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.02it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.16it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.26it/s]tensor(2.2351e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0151, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0154, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0154, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9863, device='cuda:3', grad_fn=<MinBackward1>)
15_o proxy err 0.021401409059762955 err 17.71882438659668 tr(WHW.T) 827.9279174804688
bpp_loss 3.46882426738739
15_up proxy err 0.007236468140035868 err 65.08891296386719 tr(WHW.T) 8994.5693359375
bpp_loss 3.629257849284581
15_gate proxy err 0.0015446410980075598 err 71.39017486572266 tr(WHW.T) 46217.96875
bpp_loss 3.8968233040400913
15_down proxy err 0.010122193023562431 err 64.77582550048828 tr(WHW.T) 6399.38671875
bpp_loss 3.616391454424177
v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.33it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.47it/s]I0408 10:06:55.962905 554479 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:06:55.962999 554479 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:06:55.963037 554479 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.47it/s]I0408 10:06:56.284909 554479 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.48it/s]W0408 10:06:56.470504 554479 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.48it/s]W0408 10:06:57.042994 554479 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:06:57.046676 535569 quantize_finetune_llama.py:220] layer 18 gpu 2
I0408 10:06:57.064405 554479 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.46it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.77it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.43it/s]I0408 10:06:58.299912 535569 quantize_finetune_llama.py:251] computed original embedding for layer 18 in 0.8290481567382812s
v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.51it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.88it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.10it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.23it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.54it/s]I0408 10:07:01.757991 554603 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:07:01.758085 554603 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:07:01.758128 554603 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.55it/s]I0408 10:07:02.080364 554603 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.45it/s]W0408 10:07:02.270463 554603 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:18,  3.44it/s]W0408 10:07:02.848911 554603 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:07:02.852572 535569 quantize_finetune_llama.py:220] layer 19 gpu 3
I0408 10:07:02.867165 554603 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.49it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:59,  1.65it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.54it/s]I0408 10:07:04.140500 535569 quantize_finetune_llama.py:251] computed original embedding for layer 19 in 0.8909957408905029s
v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.39it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.78it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.03it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.19it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:24,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.51it/s]I0408 10:07:07.668683 554737 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:07:07.668775 554737 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:07:07.668812 554737 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.51it/s]I0408 10:07:07.994034 554737 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.42it/s]W0408 10:07:08.184913 554737 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.42it/s]W0408 10:07:08.756379 554737 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:07:08.760263 535569 quantize_finetune_llama.py:220] layer 20 gpu 0
I0408 10:07:08.773895 554737 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.50it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.86it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.60it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.97it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.19it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.90it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.04it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.20it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.95it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.29it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.40it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]
v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.88it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.04it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.28it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.45it/s]tensor(2.0002e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0070, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0071, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0072, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9936, device='cuda:0', grad_fn=<MinBackward1>)
16_v proxy err 0.013582681305706501 err 3.725480556488037 tr(WHW.T) 274.28167724609375
bpp_loss 3.44626784324646
16_q proxy err 0.0008955862140282989 err 21.929901123046875 tr(WHW.T) 24486.64453125
bpp_loss 4.261316299438477
16_k proxy err 0.0003364720905665308 err 6.563344955444336 tr(WHW.T) 19506.357421875
bpp_loss 5.185060977935791
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.99it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.48it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:10,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.29it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.47it/s]tensor(-1.1139e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0068, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0067, device='cuda:1', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0068, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9934, device='cuda:1', grad_fn=<MinBackward1>)
17_v proxy err 0.014012527652084827 err 3.979179859161377 tr(WHW.T) 283.9730224609375
bpp_loss 3.515083074569702
17_q proxy err 0.0008008552249521017 err 22.080732345581055 tr(WHW.T) 27571.44140625
bpp_loss 4.270614147186279
17_k proxy err 0.0003744197019841522 err 6.526065826416016 tr(WHW.T) 17429.814453125
bpp_loss 5.203762054443359
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.51it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:08,  3.15s/it]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.52it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.43it/s]
v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.54it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.10s/it]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.49it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]tensor(4.7317e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0069, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0070, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0069, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9938, device='cuda:2', grad_fn=<MinBackward1>)
18_v proxy err 0.012630324810743332 err 3.632655382156372 tr(WHW.T) 287.61376953125
bpp_loss 3.4491140842437744
18_q proxy err 0.0009845246095210314 err 22.0528564453125 tr(WHW.T) 22399.498046875
bpp_loss 4.268903732299805
18_k proxy err 0.0003792875213548541 err 6.597634792327881 tr(WHW.T) 17394.810546875
bpp_loss 5.284782409667969
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:08,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.15s/it]tensor(1.8562e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0060, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0062, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0060, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9938, device='cuda:3', grad_fn=<MinBackward1>)
19_v proxy err 0.011213500052690506 err 3.824472427368164 tr(WHW.T) 341.0596618652344
bpp_loss 3.484266757965088
19_q proxy err 0.0009143435745500028 err 21.979022979736328 tr(WHW.T) 24038.03515625
bpp_loss 4.268052577972412
19_k proxy err 0.00042292129364795983 err 6.577816486358643 tr(WHW.T) 15553.287109375
bpp_loss 5.181816101074219
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:03,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:22<04:52,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:44,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:32,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:38,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:26,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:17,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:12,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:08,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:04,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:14,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:11,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:57,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:22<03:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:57,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:49,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:41<03:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:44<03:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:32,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:15,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:17,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:04,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:14,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:19<02:57,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:22<02:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:41<02:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:44<02:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:39,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:25,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:22,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [03:00<02:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:24,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:11,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:16,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:04,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:13,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:16<02:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<02:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:19<01:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:22<01:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:58,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:01,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:55,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:51,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:38<01:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:45,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:48,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:41<01:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:45,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:35,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:31,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:32,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:28,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:57<01:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:29,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [04:00<01:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:26,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:03<01:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:13<01:04,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:16<01:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:07,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:19<00:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<01:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:35<00:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:38<00:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:41<00:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:47,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:22,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:57<00:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [05:00<00:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:13<00:03,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.12s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.16s/it]
o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.11s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.15s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:13<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
tensor(-6.9098e-07, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0137, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0119, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0125, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9863, device='cuda:0', grad_fn=<MinBackward1>)
16_o proxy err 0.01833237335085869 err 17.76569366455078 tr(WHW.T) 969.0885620117188
bpp_loss 3.4582690000534058
16_up proxy err 0.0077932048588991165 err 64.9266128540039 tr(WHW.T) 8331.1826171875
bpp_loss 3.6152916976383755
16_gate proxy err 0.0017358771292492747 err 71.47669982910156 tr(WHW.T) 41176.12890625
bpp_loss 3.931856155395508
16_down proxy err 0.010269483551383018 err 64.577392578125 tr(WHW.T) 6288.2802734375
bpp_loss 3.603182111467634
tensor(1.5948e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0128, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0139, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0139, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9882, device='cuda:1', grad_fn=<MinBackward1>)
17_o proxy err 0.016041956841945648 err 17.75362205505371 tr(WHW.T) 1106.6993408203125
bpp_loss 3.4999762773513794
17_up proxy err 0.007671342696994543 err 64.84234619140625 tr(WHW.T) 8452.5419921875
bpp_loss 3.611156633922032
17_gate proxy err 0.0017206266056746244 err 71.78034973144531 tr(WHW.T) 41717.5625
bpp_loss 3.945538418633597
17_down proxy err 0.010374649427831173 err 64.45059204101562 tr(WHW.T) 6212.31494140625
bpp_loss 3.6013313020978654
I0408 10:13:17.212759 535569 quantize_finetune_llama.py:251] computed original embedding for layer 20 in 1.1649646759033203s
I0408 10:13:21.230540 558829 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:13:21.230645 558829 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:13:21.230689 558829 utils.py:162] NumExpr defaulting to 16 threads.
I0408 10:13:21.601932 558829 config.py:54] PyTorch version 2.6.0 available.
W0408 10:13:21.813585 558829 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

tensor(5.1876e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0152, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0159, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0159, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9866, device='cuda:2', grad_fn=<MinBackward1>)
18_o proxy err 0.014701105654239655 err 17.688276290893555 tr(WHW.T) 1203.193603515625
bpp_loss 3.4678667783737183
18_up proxy err 0.008108017034828663 err 64.72535705566406 tr(WHW.T) 7982.8837890625
bpp_loss 3.60653509412493
18_gate proxy err 0.0020315165165811777 err 71.59786224365234 tr(WHW.T) 35243.5546875
bpp_loss 3.9546501636505127
18_down proxy err 0.01034843735396862 err 64.43535614013672 tr(WHW.T) 6226.57861328125
bpp_loss 3.5990693228585378
W0408 10:13:22.450730 558829 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:13:22.454925 535569 quantize_finetune_llama.py:220] layer 21 gpu 1
I0408 10:13:22.470176 558829 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:58,  1.68it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:40,  2.40it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.79it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.01it/s]I0408 10:13:24.507984 535569 quantize_finetune_llama.py:251] computed original embedding for layer 21 in 0.9596452713012695s
v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.15it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.21it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.29it/s]tensor(3.0055e-08, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0120, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0130, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0122, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9870, device='cuda:3', grad_fn=<MinBackward1>)
19_o proxy err 0.015379275195300579 err 17.976709365844727 tr(WHW.T) 1168.891845703125
bpp_loss 3.478362798690796
19_up proxy err 0.0084524592384696 err 64.65532684326172 tr(WHW.T) 7649.2919921875
bpp_loss 3.6027462823050365
19_gate proxy err 0.002186940051615238 err 71.75786590576172 tr(WHW.T) 32811.99609375
bpp_loss 3.9663046087537492
19_down proxy err 0.010413345880806446 err 64.38296508789062 tr(WHW.T) 6182.73583984375
bpp_loss 3.597132819039481
v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:27,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.45it/s]I0408 10:13:28.067871 558988 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:13:28.067965 558988 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:13:28.068001 558988 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.47it/s]I0408 10:13:28.390995 558988 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.45it/s]W0408 10:13:28.580434 558988 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.45it/s]W0408 10:13:29.130941 558988 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:13:29.134600 535569 quantize_finetune_llama.py:220] layer 22 gpu 2
I0408 10:13:29.147761 558988 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.45it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:07<00:22,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.86it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.44it/s]I0408 10:13:30.417487 535569 quantize_finetune_llama.py:251] computed original embedding for layer 22 in 0.8807759284973145s
v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.55it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:22,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.89it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.11it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:21,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:21,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:20,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:19,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.51it/s]I0408 10:13:33.969649 559131 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:13:33.969744 559131 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:13:33.969784 559131 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.52it/s]I0408 10:13:34.291005 559131 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:18,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.53it/s]W0408 10:13:34.478615 559131 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:12<00:17,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.54it/s]W0408 10:13:35.025186 559131 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:13:35.028864 535569 quantize_finetune_llama.py:220] layer 23 gpu 3
I0408 10:13:35.046953 559131 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.53it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.76it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.41it/s]I0408 10:13:36.164964 535569 quantize_finetune_llama.py:251] computed original embedding for layer 23 in 0.7060267925262451s
v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.47it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.86it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.07it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:14<00:15,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:15,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:14,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.48it/s]I0408 10:13:39.595006 559265 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:13:39.595098 559265 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:13:39.595135 559265 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.50it/s]I0408 10:13:39.920019 559265 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:17<00:12,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.50it/s]W0408 10:13:40.110593 559265 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:12,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.53it/s]W0408 10:13:40.652519 559265 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:13:40.656289 535569 quantize_finetune_llama.py:220] layer 24 gpu 0
v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.47it/s]I0408 10:13:40.669071 559265 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.47it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:50,  1.95it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.65it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:19<00:10,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.99it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.19it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:10,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:11,  2.89it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.02it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.12it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:21<00:09,  3.19it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.32it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:23<00:06,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:05,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:25<00:04,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.01it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:26<00:03,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.15it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.26it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.36it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:28<00:01,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:29<00:00,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.48it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.37it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.34it/s]
v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.94it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.06it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.25it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.30it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.39it/s]tensor(2.3705e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0062, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0060, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0062, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9942, device='cuda:0', grad_fn=<MinBackward1>)
20_v proxy err 0.012118788436055183 err 4.001528739929199 tr(WHW.T) 330.192138671875
bpp_loss 3.518655300140381
20_q proxy err 0.001048916019499302 err 21.75214958190918 tr(WHW.T) 20737.7421875
bpp_loss 4.24091362953186
20_k proxy err 0.0004233501385897398 err 6.517818450927734 tr(WHW.T) 15395.810546875
bpp_loss 5.130876541137695
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.48it/s]
v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.94it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:10,  3.14s/it]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.10it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.20it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.28it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.33it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.45it/s]tensor(1.6091e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0065, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0069, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0069, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9940, device='cuda:1', grad_fn=<MinBackward1>)
21_v proxy err 0.011323224753141403 err 4.108893871307373 tr(WHW.T) 362.87310791015625
bpp_loss 3.5395376682281494
21_q proxy err 0.0008498181705363095 err 21.95769691467285 tr(WHW.T) 25838.111328125
bpp_loss 4.236547946929932
21_k proxy err 0.0003884317120537162 err 6.520779132843018 tr(WHW.T) 16787.453125
bpp_loss 5.175832748413086
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.51it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:08,  3.15s/it]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.55it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]
v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.52it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.50it/s]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:05,  3.15s/it]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.49it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]tensor(6.1012e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0057, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0061, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0060, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9945, device='cuda:2', grad_fn=<MinBackward1>)
22_v proxy err 0.012277031317353249 err 4.248822212219238 tr(WHW.T) 346.0789489746094
bpp_loss 3.5805559158325195
22_q proxy err 0.0010644346475601196 err 21.62889289855957 tr(WHW.T) 20319.60546875
bpp_loss 4.196983098983765
22_k proxy err 0.00043987983372062445 err 6.476833820343018 tr(WHW.T) 14724.09765625
bpp_loss 5.106654644012451
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:02,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:59,  3.15s/it]tensor(9.4077e-07, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0053, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0056, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0056, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9947, device='cuda:3', grad_fn=<MinBackward1>)
23_v proxy err 0.011264855042099953 err 4.482365131378174 tr(WHW.T) 397.90704345703125
bpp_loss 3.6251273155212402
23_q proxy err 0.0009648879640735686 err 21.815086364746094 tr(WHW.T) 22608.931640625
bpp_loss 4.20421576499939
23_k proxy err 0.0004347716167103499 err 6.45960807800293 tr(WHW.T) 14857.474609375
bpp_loss 5.10703706741333
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:02,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:22<04:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:38,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:32,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:04,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:57,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:22<03:53,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:41<03:33,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:44<03:30,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:38,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:27,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:12,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:17,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:08,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:04,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:04,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:11,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:19<02:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:57,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:22<02:54,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:50,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<02:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:38<02:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:39,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:49,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:41<02:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:44<02:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:39,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:39,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:27,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [03:00<02:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:23,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:27,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:12,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:20,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:24,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:08,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:04,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:14,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:16<02:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:10,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:19<01:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:10,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:22<01:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:53,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:56,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:24<01:49,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:53,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:38<01:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:27<01:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:50,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:41<01:34,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:43,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:39,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:33,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:57<01:18,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [04:00<01:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:49<01:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:03<01:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:12,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:13<01:04,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:16<01:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:09,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<01:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:19<00:57,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:08<01:07,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:11<01:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<01:00,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:02,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:35<00:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:38<00:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:41<00:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:47,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:27,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:54<00:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:57<00:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [05:00<00:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:54<00:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:13<00:03,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.16s/it]
o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.22s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:10<00:03,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.19s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.14s/it]
o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.15s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.14s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
tensor(3.1486e-07, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0127, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0156, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0133, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9844, device='cuda:0', grad_fn=<MinBackward1>)
20_o proxy err 0.01478289719671011 err 17.815208435058594 tr(WHW.T) 1205.1229248046875
bpp_loss 3.469141125679016
20_up proxy err 0.008510074578225613 err 64.67366027832031 tr(WHW.T) 7599.658203125
bpp_loss 3.6063328811100552
20_gate proxy err 0.0023358722683042288 err 71.62956237792969 tr(WHW.T) 30665.015625
bpp_loss 3.9688989434923445
20_down proxy err 0.010229473002254963 err 64.45449829101562 tr(WHW.T) 6300.8623046875
bpp_loss 3.6012272153581892
tensor(1.5310e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0117, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0104, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0098, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9883, device='cuda:1', grad_fn=<MinBackward1>)
21_o proxy err 0.013615728355944157 err 17.246620178222656 tr(WHW.T) 1266.6689453125
bpp_loss 3.488604426383972
21_up proxy err 0.008325259201228619 err 64.70866394042969 tr(WHW.T) 7772.57080078125
bpp_loss 3.6093101501464844
21_gate proxy err 0.0022757654078304768 err 71.83768463134766 tr(WHW.T) 31566.3828125
bpp_loss 3.9811168057577953
21_down proxy err 0.010161545127630234 err 64.54069519042969 tr(WHW.T) 6351.46484375
bpp_loss 3.60399900163923
I0408 10:19:52.091609 535569 quantize_finetune_llama.py:251] computed original embedding for layer 24 in 1.0230019092559814s
I0408 10:19:56.051396 563421 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:19:56.051497 563421 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:19:56.051537 563421 utils.py:162] NumExpr defaulting to 16 threads.
I0408 10:19:56.433366 563421 config.py:54] PyTorch version 2.6.0 available.
W0408 10:19:56.645386 563421 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 10:19:57.262954 563421 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:19:57.266904 535569 quantize_finetune_llama.py:220] layer 25 gpu 1
I0408 10:19:57.280816 563421 data_utils.py:336] using 256 training seqs, 128 validation seqs
tensor(5.7956e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0136, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0156, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0156, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9866, device='cuda:2', grad_fn=<MinBackward1>)
22_o proxy err 0.015122096985578537 err 18.476646423339844 tr(WHW.T) 1221.8309326171875
bpp_loss 3.5139044523239136
22_up proxy err 0.008584150113165379 err 64.78677368164062 tr(WHW.T) 7547.25537109375
bpp_loss 3.6130397660391673
22_gate proxy err 0.0024332080502063036 err 71.86260986328125 tr(WHW.T) 29534.099609375
bpp_loss 3.9855318750653947
22_down proxy err 0.009887748397886753 err 64.56196594238281 tr(WHW.T) 6529.4912109375
bpp_loss 3.6077985763549805
v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.83it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.53it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.88it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.08it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.20it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.27it/s]I0408 10:19:59.984989 535569 quantize_finetune_llama.py:251] computed original embedding for layer 25 in 1.099804401397705s
v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.32it/s]tensor(-2.5689e-07, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0142, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0128, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0141, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9876, device='cuda:3', grad_fn=<MinBackward1>)
23_o proxy err 0.010738998651504517 err 18.733871459960938 tr(WHW.T) 1744.470947265625
bpp_loss 3.521817684173584
23_up proxy err 0.008747600950300694 err 64.9002685546875 tr(WHW.T) 7419.2080078125
bpp_loss 3.617288725716727
23_gate proxy err 0.002631426090374589 err 71.81596374511719 tr(WHW.T) 27291.65234375
bpp_loss 3.9889912605285645
23_down proxy err 0.009700164198875427 err 64.67085266113281 tr(WHW.T) 6666.9853515625
bpp_loss 3.612213815961565
v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.34it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:27,  3.35it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:24,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.46it/s]I0408 10:20:03.618853 563584 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:20:03.618941 563584 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:20:03.618982 563584 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.46it/s]I0408 10:20:03.959416 563584 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.47it/s]W0408 10:20:04.155583 563584 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.47it/s]W0408 10:20:04.712373 563584 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:20:04.716035 535569 quantize_finetune_llama.py:220] layer 26 gpu 2
I0408 10:20:04.728795 563584 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.44it/s]v
v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.75it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.51it/s]I0408 10:20:05.999266 535569 quantize_finetune_llama.py:251] computed original embedding for layer 26 in 0.8510808944702148s
v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.85it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.09it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.22it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.37it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:19,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:18,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.49it/s]I0408 10:20:09.606898 563716 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:20:09.606996 563716 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:20:09.607038 563716 utils.py:162] NumExpr defaulting to 16 threads.
v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.50it/s]I0408 10:20:09.942892 563716 config.py:54] PyTorch version 2.6.0 available.
v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.51it/s]W0408 10:20:10.135415 563716 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.50it/s]W0408 10:20:10.706137 563716 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:20:10.710085 535569 quantize_finetune_llama.py:220] layer 27 gpu 3
I0408 10:20:10.723326 563716 data_utils.py:336] using 256 training seqs, 128 validation seqs
v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.49it/s]v
26_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.40it/s]v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]26_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.89it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.40it/s]I0408 10:20:11.971863 535569 quantize_finetune_llama.py:251] computed original embedding for layer 27 in 0.8519279956817627s
26_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.61it/s]v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.38it/s]26_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.96it/s]v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:15,  3.38it/s]26_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.15it/s]v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.37it/s]26_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.29it/s]v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.39it/s]26_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.38it/s]v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:14,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.42it/s]26_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.47it/s]v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.44it/s]26_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.44it/s]I0408 10:20:15.556294 563847 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:20:15.556384 563847 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:20:15.556424 563847 utils.py:162] NumExpr defaulting to 16 threads.
26_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.44it/s]I0408 10:20:15.886343 563847 config.py:54] PyTorch version 2.6.0 available.
26_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.51it/s]W0408 10:20:16.076256 563847 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.45it/s]26_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.45it/s]26_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.44it/s]W0408 10:20:16.691690 563847 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:20:16.695536 535569 quantize_finetune_llama.py:220] layer 28 gpu 0
I0408 10:20:16.708564 563847 data_utils.py:336] using 256 training seqs, 128 validation seqs
26_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.50it/s]v
v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.50it/s]26_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.86it/s]v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:11,  2.87it/s]26_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.59it/s]v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.49it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.01it/s]26_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.96it/s]v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.13it/s]26_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.54it/s]27_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.18it/s]v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.20it/s]26_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.31it/s]v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.27it/s]26_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.32it/s]26_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.45it/s]v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.36it/s]27_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]26_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.37it/s]27_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.52it/s]26_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.38it/s]27_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.40it/s]27_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.41it/s]27_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.42it/s]27_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.43it/s]27_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.42it/s]26_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.42it/s]26_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.60it/s]26_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.43it/s]v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.59it/s]26_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.59it/s]26_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.58it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.41it/s]v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.43it/s]27_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.57it/s]v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.96it/s]26_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.41it/s]27_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.12it/s]26_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.39it/s]27_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.56it/s]v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.23it/s]26_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.40it/s]27_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.30it/s]26_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.41it/s]27_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.37it/s]26_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.42it/s]27_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.39it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.40it/s]27_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.54it/s]v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.42it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.41it/s]27_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.46it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.42it/s]27_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.48it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.42it/s]27_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.50it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.43it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.37it/s]
27_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.55it/s]v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.48it/s]27_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.51it/s]26_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.47it/s]27_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.50it/s]26_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]26_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.48it/s]27_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.48it/s]26_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.95it/s]27_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.48it/s]26_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.10it/s]27_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.46it/s]26_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.19it/s]27_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.46it/s]26_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.29it/s]27_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.47it/s]26_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.35it/s]27_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.47it/s]26_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.40it/s]27_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.50it/s]v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.45it/s]26_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.46it/s]tensor(1.2789e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0060, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0059, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0060, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9943, device='cuda:0', grad_fn=<MinBackward1>)
24_v proxy err 0.010143160820007324 err 4.739679336547852 tr(WHW.T) 467.2783508300781
bpp_loss 3.7065250873565674
24_q proxy err 0.000966545834671706 err 21.685518264770508 tr(WHW.T) 22436.099609375
bpp_loss 4.169379472732544
24_k proxy err 0.00044933019671589136 err 6.373045444488525 tr(WHW.T) 14183.4345703125
bpp_loss 4.934964179992676
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]26_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.47it/s]26_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.47it/s]27_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.49it/s]26_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.53it/s]v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.49it/s]26_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.51it/s]v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.48it/s]26_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.52it/s]v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]26_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.51it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.49it/s]v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.45it/s]
26_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.54it/s]27_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.52it/s]26_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.50it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:10,  3.14s/it]26_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.50it/s]26_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.51it/s]26_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.93it/s]26_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.09it/s]26_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.19it/s]26_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.27it/s]26_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.48it/s]27_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.33it/s]26_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.47it/s]27_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.35it/s]26_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.43it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:08,  3.15s/it]26_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.44it/s]26_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.44it/s]tensor(1.6093e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0049, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0052, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0047, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9948, device='cuda:1', grad_fn=<MinBackward1>)
25_v proxy err 0.00859437882900238 err 4.794018745422363 tr(WHW.T) 557.8086547851562
bpp_loss 3.7196462154388428
25_q proxy err 0.0008287375094369054 err 21.640018463134766 tr(WHW.T) 26112.029296875
bpp_loss 4.148374080657959
25_k proxy err 0.0004395585274323821 err 6.336948394775391 tr(WHW.T) 14416.6201171875
bpp_loss 4.92311954498291
o
o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]26_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.47it/s]26_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.47it/s]26_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]26_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
27_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.50it/s]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:05,  3.15s/it]27_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.48it/s]27_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.47it/s]o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]27_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.48it/s]27_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.46it/s]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:02,  3.15s/it]tensor(-2.8202e-08, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0050, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0052, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0049, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9948, device='cuda:2', grad_fn=<MinBackward1>)
26_v proxy err 0.011096874251961708 err 4.822100639343262 tr(WHW.T) 434.54583740234375
bpp_loss 3.777491569519043
26_q proxy err 0.0010043727234005928 err 21.496871948242188 tr(WHW.T) 21403.28125
bpp_loss 4.155888557434082
26_k proxy err 0.0004124769475311041 err 6.362698554992676 tr(WHW.T) 15425.5859375
bpp_loss 4.996563911437988
o
26_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]27_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.12s/it]27_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
26_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:59,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]tensor(6.6398e-07, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0059, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0062, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0059, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9939, device='cuda:3', grad_fn=<MinBackward1>)
27_v proxy err 0.007453228812664747 err 5.051007270812988 tr(WHW.T) 677.69384765625
bpp_loss 3.843967914581299
27_q proxy err 0.0010107361013069749 err 21.534711837768555 tr(WHW.T) 21305.96875
bpp_loss 4.126901626586914
27_k proxy err 0.00045448984019458294 err 6.368138790130615 tr(WHW.T) 14011.6201171875
bpp_loss 4.950887203216553
o
27_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]26_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:56,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.09s/it]26_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:02,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:22<04:52,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:00,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:56,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:43,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:59,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:22<04:55,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:45,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:50,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:40,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:41<04:36,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:38,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:47,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:32,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:38,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:32,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:35,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:25,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:22,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:18,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:23,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [01:00<04:15,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:22,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:17,  3.22s/it]27_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:12,  3.20s/it]27_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:23,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:08,  3.19s/it]27_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:18,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:04,  3.18s/it]27_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:16,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:16<04:00,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:19<03:57,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:22<03:54,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:02,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:47,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:38<03:37,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:41<03:34,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:49,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:42,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:35,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:44<03:31,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:32,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:28,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:31,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [02:00<03:15,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:27,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:11,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:24,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:12,  3.20s/it]27_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:21,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:16,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:09,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:08,  3.19s/it]27_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:18,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:04,  3.18s/it]27_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:14,  3.09s/it]26_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:09,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:06,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:16<03:00,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:11,  3.09s/it]26_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:03,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:19<02:56,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:08,  3.09s/it]26_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:59,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:22<02:53,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:04,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:52,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:57,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:51,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:48,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:38<02:37,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:45,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:41<02:34,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:49,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:41,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:44<02:31,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:39,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:27,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:33,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:26,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:20,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [03:00<02:15,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:30,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:23,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:18,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:12,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:20,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:15,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.22s/it]27_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:12,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.20s/it]27_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:11,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:04,  3.19s/it]27_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:11,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.20s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:16<02:00,  3.18s/it]27_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:10,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:04,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:19<01:57,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<02:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:22<01:53,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:03,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<02:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:54,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:57,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:50,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:53,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:35<01:41,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:56,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:38<01:37,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:53,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:41<01:34,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:50,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:43,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:36,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:33,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:22,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:49<01:25,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:57<01:18,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:22,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:29,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [04:00<01:15,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:26,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:03<01:12,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:20,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:17,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.22s/it]26_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:08,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:13<01:04,  3.20s/it]26_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.14s/it]o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:08<01:07,  3.20s/it]27_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:16<01:00,  3.19s/it]26_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:09,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:11<01:03,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:19<00:57,  3.18s/it]26_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:07,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<01:00,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:56,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<01:00,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:57,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:32<00:44,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:47,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:35<00:40,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:50,  3.17s/it]o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:30<00:44,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:38<00:37,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:47,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:33<00:40,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:41<00:34,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:44,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:33<00:41,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.10s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:51<00:25,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:54<00:22,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:57<00:18,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.16s/it]o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:21,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:30,  3.09s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [05:00<00:15,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:49<00:25,  3.23s/it]o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:55<00:19,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:28,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.20s/it]26_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:52<00:22,  3.21s/it]o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:25,  3.15s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.19s/it]26_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:55<00:19,  3.19s/it]o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.13s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:10<00:06,  3.18s/it]26_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.18s/it]o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:13<00:03,  3.23s/it]26_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.18s/it]27_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:08<00:06,  3.22s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.21s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.17s/it]
26_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:11<00:03,  3.20s/it]26_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.10s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.17s/it]o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.14s/it]
26_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:11<00:03,  3.20s/it]27_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.14s/it]
27_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.18s/it]27_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
tensor(-1.4592e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0104, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0101, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0092, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9896, device='cuda:0', grad_fn=<MinBackward1>)
24_o proxy err 0.01180584542453289 err 18.765296936035156 tr(WHW.T) 1589.4920654296875
bpp_loss 3.5832101106643677
24_up proxy err 0.008879412896931171 err 64.91866302490234 tr(WHW.T) 7311.1435546875
bpp_loss 3.621901750564575
24_gate proxy err 0.0027765301056206226 err 71.8489990234375 tr(WHW.T) 25877.26171875
bpp_loss 3.995889970234462
24_down proxy err 0.009619932621717453 err 64.85697937011719 tr(WHW.T) 6741.93701171875
bpp_loss 3.617424556187221
tensor(1.2177e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0133, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0123, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9996, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0123, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9867, device='cuda:1', grad_fn=<MinBackward1>)
25_o proxy err 0.009505422785878181 err 18.920366287231445 tr(WHW.T) 1990.481201171875
bpp_loss 3.588266968727112
25_up proxy err 0.0088009312748909 err 64.97015380859375 tr(WHW.T) 7382.19091796875
bpp_loss 3.6310696601867676
25_gate proxy err 0.0027371023315936327 err 72.00614166259766 tr(WHW.T) 26307.435546875
bpp_loss 4.005198376519339
25_down proxy err 0.009815041907131672 err 64.93583679199219 tr(WHW.T) 6615.951171875
bpp_loss 3.626546178545271
I0408 10:26:30.165417 535569 quantize_finetune_llama.py:251] computed original embedding for layer 28 in 0.9912793636322021s
tensor(1.5829e-06, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0116, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0118, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0109, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9882, device='cuda:2', grad_fn=<MinBackward1>)
26_o proxy err 0.007986693643033504 err 19.078006744384766 tr(WHW.T) 2388.72412109375
bpp_loss 3.5960123538970947
26_up proxy err 0.00852623675018549 err 65.18867492675781 tr(WHW.T) 7645.65625
bpp_loss 3.6397834164755687
26_gate proxy err 0.0024900499265640974 err 71.9660415649414 tr(WHW.T) 28901.4453125
bpp_loss 4.00994838987078
26_down proxy err 0.00981805007904768 err 64.98395538330078 tr(WHW.T) 6618.82470703125
bpp_loss 3.6353074482509067
I0408 10:26:34.153496 568051 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:26:34.153594 568051 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:26:34.153634 568051 utils.py:162] NumExpr defaulting to 16 threads.
I0408 10:26:34.545027 568051 config.py:54] PyTorch version 2.6.0 available.
W0408 10:26:34.757633 568051 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 10:26:35.439963 568051 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:26:35.444131 535569 quantize_finetune_llama.py:220] layer 29 gpu 1
I0408 10:26:35.460888 568051 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
28_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]tensor(-5.9069e-07, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0182, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0142, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9996, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0182, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9834, device='cuda:3', grad_fn=<MinBackward1>)
27_o proxy err 0.008989326655864716 err 19.416549682617188 tr(WHW.T) 2159.9560546875
bpp_loss 3.6355855464935303
27_up proxy err 0.007730261422693729 err 65.51856231689453 tr(WHW.T) 8475.5947265625
bpp_loss 3.653531381062099
27_gate proxy err 0.0022017736919224262 err 72.23807525634766 tr(WHW.T) 32809.0390625
bpp_loss 4.017937523978097
27_down proxy err 0.009950419887900352 err 65.10916137695312 tr(WHW.T) 6543.35791015625
bpp_loss 3.6475155694144115
28_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.78it/s]28_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.52it/s]I0408 10:26:36.956596 535569 quantize_finetune_llama.py:251] computed original embedding for layer 29 in 1.019317865371704s
28_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.86it/s]28_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.06it/s]28_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.18it/s]28_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.26it/s]28_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.31it/s]28_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.35it/s]28_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.38it/s]28_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.41it/s]28_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.40it/s]28_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.42it/s]28_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.43it/s]I0408 10:26:40.389228 568212 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:26:40.389322 568212 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:26:40.389362 568212 utils.py:162] NumExpr defaulting to 16 threads.
28_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.45it/s]I0408 10:26:40.710680 568212 config.py:54] PyTorch version 2.6.0 available.
28_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.45it/s]W0408 10:26:40.898211 568212 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

28_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.48it/s]W0408 10:26:41.440346 568212 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:26:41.444156 535569 quantize_finetune_llama.py:220] layer 30 gpu 2
I0408 10:26:41.457365 568212 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.45it/s]v
29_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.46it/s]28_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.81it/s]28_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.56it/s]I0408 10:26:42.829889 535569 quantize_finetune_llama.py:251] computed original embedding for layer 30 in 0.9727966785430908s
28_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.90it/s]29_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.13it/s]28_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.28it/s]28_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.37it/s]28_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.41it/s]28_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.42it/s]29_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.44it/s]28_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.43it/s]I0408 10:26:46.246968 568345 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:26:46.247061 568345 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:26:46.247101 568345 utils.py:162] NumExpr defaulting to 16 threads.
29_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.42it/s]I0408 10:26:46.567164 568345 config.py:54] PyTorch version 2.6.0 available.
29_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.50it/s]W0408 10:26:46.753062 568345 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

28_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.43it/s]W0408 10:26:47.292049 568345 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:26:47.295731 535569 quantize_finetune_llama.py:220] layer 31 gpu 3
29_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.50it/s]I0408 10:26:47.309330 568345 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:18,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.41it/s]v
30_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]29_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.46it/s]28_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.43it/s]30_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.43it/s]30_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.58it/s]I0408 10:26:48.706555 535569 quantize_finetune_llama.py:251] computed original embedding for layer 31 in 0.994945764541626s
29_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.42it/s]30_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.91it/s]29_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.41it/s]30_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.11it/s]29_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.25it/s]28_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.40it/s]29_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.31it/s]28_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.40it/s]29_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.36it/s]28_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.42it/s]28_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.43it/s]28_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.45it/s]28_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.42it/s]29_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.42it/s]29_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:25,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.48it/s]I0408 10:26:52.346473 568472 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:26:52.346559 568472 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:26:52.346596 568472 utils.py:162] NumExpr defaulting to 16 threads.
28_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.51it/s]I0408 10:26:52.752663 568472 config.py:54] PyTorch version 2.6.0 available.
30_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.49it/s]W0408 10:26:52.953408 568472 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

28_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]W0408 10:26:53.646339 568472 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 10:26:53.664869 568472 data_utils.py:336] using 256 training seqs, 128 validation seqs
30_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:23,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.46it/s]28_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.52it/s]v
31_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]30_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.46it/s]28_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:11,  1.38it/s]29_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.43it/s]30_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:01<00:45,  2.15it/s]29_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:36,  2.62it/s]29_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:32,  2.93it/s]29_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:09,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.11it/s]29_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.54it/s]28_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:09,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.24it/s]29_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:11,  2.81it/s]31_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.34it/s]29_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.40it/s]28_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:10,  2.97it/s]29_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.43it/s]28_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:09,  3.10it/s]29_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.45it/s]28_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.19it/s]29_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.26it/s]30_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.31it/s]30_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:24,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.34it/s]30_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.37it/s]30_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.39it/s]30_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.54it/s]28_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.41it/s]30_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.41it/s]30_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.41it/s]30_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.51it/s]29_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.42it/s]30_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.51it/s]29_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.42it/s]30_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.42it/s]29_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.41it/s]31_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.46it/s]28_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.98it/s]31_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.11it/s]31_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.21it/s]31_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.46it/s]28_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.31it/s]31_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.37it/s]31_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.42it/s]29_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.41it/s]31_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.42it/s]29_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.42it/s]29_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.41it/s]31_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]28_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]
31_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.93it/s]31_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.06it/s]31_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]31_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.25it/s]31_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.31it/s]31_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.34it/s]31_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.38it/s]31_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.39it/s]31_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]29_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.46it/s]
30_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.40it/s]31_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.47it/s]tensor(4.2188e-07, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0058, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0057, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0057, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9946, device='cuda:0', grad_fn=<MinBackward1>)
28_v proxy err 0.008687556721270084 err 5.225430011749268 tr(WHW.T) 601.4844360351562
bpp_loss 3.8883309364318848
28_q proxy err 0.0009410289349034429 err 21.797889709472656 tr(WHW.T) 23163.888671875
bpp_loss 4.133872747421265
28_k proxy err 0.00043051113607361913 err 6.455175399780273 tr(WHW.T) 14994.2119140625
bpp_loss 4.896484375
o
28_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]30_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.41it/s]31_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.43it/s]28_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:11,  3.14s/it]30_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:12,  2.71it/s]30_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:11,  2.90it/s]30_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.05it/s]30_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.16it/s]30_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.25it/s]30_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.30it/s]30_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.35it/s]tensor(8.7621e-08, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0052, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0053, device='cuda:1', grad_fn=<MinBackward1>)
tensor(1.0000, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0052, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9951, device='cuda:1', grad_fn=<MinBackward1>)
29_v proxy err 0.006437442731112242 err 5.474587917327881 tr(WHW.T) 850.4290161132812
bpp_loss 3.925696611404419
29_q proxy err 0.0010535947512835264 err 21.760129928588867 tr(WHW.T) 20653.2265625
bpp_loss 4.125101327896118
29_k proxy err 0.0003908459038939327 err 6.396504878997803 tr(WHW.T) 16365.796875
bpp_loss 5.001546382904053
o
29_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]30_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.38it/s]30_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.41it/s]30_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.42it/s]30_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]
31_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.43it/s]28_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:08,  3.15s/it]31_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.45it/s]29_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.11s/it]31_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.44it/s]28_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.14s/it]31_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.44it/s]29_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.12s/it]tensor(4.9808e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0047, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0048, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0048, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9953, device='cuda:2', grad_fn=<MinBackward1>)
30_v proxy err 0.006979930214583874 err 6.024104118347168 tr(WHW.T) 863.060791015625
bpp_loss 4.141515731811523
30_q proxy err 0.0008821420487947762 err 21.216073989868164 tr(WHW.T) 24050.6328125
bpp_loss 4.021165132522583
30_k proxy err 0.0004395358555484563 err 6.166946887969971 tr(WHW.T) 14030.5888671875
bpp_loss 4.635194301605225
o
30_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]31_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.45it/s]28_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:02,  3.15s/it]31_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.39it/s]
29_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:02,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:08,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:59,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:00,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]tensor(5.0295e-07, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0040, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0043, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9999, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0040, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9957, device='cuda:3', grad_fn=<MinBackward1>)
31_v proxy err 0.003041679272428155 err 5.50155782699585 tr(WHW.T) 1808.723876953125
bpp_loss 4.012999534606934
31_q proxy err 0.0004832299309782684 err 22.313461303710938 tr(WHW.T) 46175.66015625
bpp_loss 4.177239894866943
31_k proxy err 0.00031856304849497974 err 6.520235061645508 tr(WHW.T) 20467.64453125
bpp_loss 4.876802444458008
o
31_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:56,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:03,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:22<04:52,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:57,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:54,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:43,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:40,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:48,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:44,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:34,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:30,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:38,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:44,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:35,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:21,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:30,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:18,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:18,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:26,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:22,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.21s/it]29_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.19s/it]29_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:18,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:06,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.19s/it]28_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.18s/it]28_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.18s/it]31_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.19s/it]28_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:22<03:53,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:04,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.17s/it]28_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:57,  3.17s/it]28_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:54,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:43,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:50,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:40,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:47,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:46,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:44,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:44<03:30,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:43,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:41,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:31,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:38,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:27,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:36,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:24,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:31,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:32,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:28,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:25,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:15,  3.20s/it]29_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:26,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:22,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.19s/it]29_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:13,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:19,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:17,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:12,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:12,  3.22s/it]28_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:59,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:13,  3.18s/it]30_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:08,  3.20s/it]28_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:22<02:53,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:56,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:04,  3.19s/it]28_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:04,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:01,  3.18s/it]28_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:46,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:00,  3.12s/it]29_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:50,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:57,  3.17s/it]28_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:57,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:47,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:22<02:54,  3.17s/it]28_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:53,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:43,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:50,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:39,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:47,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:44,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:44<02:31,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:41,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:25,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:27,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:22,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:34,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:24,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:44<02:31,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:31,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:21,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:28,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:18,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:25,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:12,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:15,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:22,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.22s/it]31_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]29_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:12,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.20s/it]31_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.13s/it]29_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:11,  3.21s/it]30_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:04,  3.19s/it]31_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.13s/it]29_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.19s/it]30_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:12,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:14,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.18s/it]29_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:03,  3.18s/it]30_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.22s/it]31_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:19<01:57,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:14<01:59,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.18s/it]28_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:22<01:54,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:56,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.14s/it]28_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:57,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:27<01:46,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:22<01:53,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:41,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:43,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:46,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:41<01:34,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:36<01:37,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:43,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:39<01:34,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:31,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:46<01:28,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:49<01:25,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:21,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [04:00<01:15,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:03<01:12,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:58<01:15,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:22,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:01<01:12,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.21s/it]29_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:09,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.19s/it]29_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:08<01:07,  3.20s/it]30_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:03<01:12,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.18s/it]29_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:11<01:03,  3.17s/it]30_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:09,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:19<00:56,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:14<00:59,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.22s/it]31_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:17<00:56,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.20s/it]31_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:20<00:53,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.19s/it]31_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]28_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:23<00:49,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:19<00:57,  3.18s/it]31_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:26<00:46,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:52,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:33<00:40,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:36<00:37,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:41<00:34,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:39<00:34,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:41,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:42<00:31,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:45<00:28,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:41<00:34,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:48<00:25,  3.14s/it]28_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:51<00:22,  3.14s/it]28_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:30,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:55<00:18,  3.15s/it]28_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [05:00<00:15,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.13s/it]29_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:58<00:15,  3.15s/it]28_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:21,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]29_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:01<00:12,  3.15s/it]28_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.13s/it]29_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:04<00:09,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.13s/it]29_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:07<00:06,  3.22s/it]28_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.22s/it]30_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:11<00:03,  3.20s/it]28_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.21s/it]28_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:16<00:00,  3.16s/it]
30_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.13s/it]29_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.19s/it]29_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:14<00:00,  3.14s/it]
30_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.18s/it]31_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.18s/it]30_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
31_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
tensor(-9.6721e-07, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0143, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0130, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9997, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0131, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9857, device='cuda:0', grad_fn=<MinBackward1>)
28_o proxy err 0.0078075947239995 err 19.608348846435547 tr(WHW.T) 2511.445556640625
bpp_loss 3.6675864458084106
28_up proxy err 0.006445455830544233 err 66.04059600830078 tr(WHW.T) 10246.0703125
bpp_loss 3.6761207239968434
28_gate proxy err 0.002004590118303895 err 72.00680541992188 tr(WHW.T) 35920.9609375
bpp_loss 4.004050833838327
28_down proxy err 0.009046724066138268 err 65.22766876220703 tr(WHW.T) 7210.08740234375
bpp_loss 3.665893009730748
tensor(1.7249e-06, device='cuda:1', grad_fn=<MeanBackward0>) tensor(0.0130, device='cuda:1', grad_fn=<MaxBackward1>) tensor(-0.0115, device='cuda:1', grad_fn=<MinBackward1>)
tensor(0.9995, device='cuda:1', grad_fn=<MeanBackward0>) tensor(1.0116, device='cuda:1', grad_fn=<MaxBackward1>) tensor(0.9870, device='cuda:1', grad_fn=<MinBackward1>)
29_o proxy err 0.006255470681935549 err 19.40975570678711 tr(WHW.T) 3102.844970703125
bpp_loss 3.701545834541321
29_up proxy err 0.005179456900805235 err 66.65187072753906 tr(WHW.T) 12868.505859375
bpp_loss 3.7069879940577914
29_gate proxy err 0.0018774957861751318 err 72.02913665771484 tr(WHW.T) 38364.47265625
bpp_loss 3.9928007466452464
29_down proxy err 0.008846884593367577 err 66.09086608886719 tr(WHW.T) 7470.5244140625
bpp_loss 3.6856788907732283
tensor(-2.3901e-07, device='cuda:2', grad_fn=<MeanBackward0>) tensor(0.0109, device='cuda:2', grad_fn=<MaxBackward1>) tensor(-0.0124, device='cuda:2', grad_fn=<MinBackward1>)
tensor(0.9998, device='cuda:2', grad_fn=<MeanBackward0>) tensor(1.0124, device='cuda:2', grad_fn=<MaxBackward1>) tensor(0.9892, device='cuda:2', grad_fn=<MinBackward1>)
30_o proxy err 0.004082720726728439 err 19.879480361938477 tr(WHW.T) 4869.1748046875
bpp_loss 3.813614249229431
30_up proxy err 0.003121675457805395 err 67.77530670166016 tr(WHW.T) 21711.1953125
bpp_loss 3.73421471459525
30_gate proxy err 0.0014070224715396762 err 73.10108184814453 tr(WHW.T) 51954.453125
bpp_loss 4.03825889314924
30_down proxy err 0.007372323889285326 err 64.95149230957031 tr(WHW.T) 8810.1787109375
bpp_loss 3.6925704138619557
tensor(-1.3300e-06, device='cuda:3', grad_fn=<MeanBackward0>) tensor(0.0171, device='cuda:3', grad_fn=<MaxBackward1>) tensor(-0.0171, device='cuda:3', grad_fn=<MinBackward1>)
tensor(0.9995, device='cuda:3', grad_fn=<MeanBackward0>) tensor(1.0165, device='cuda:3', grad_fn=<MaxBackward1>) tensor(0.9832, device='cuda:3', grad_fn=<MinBackward1>)
31_o proxy err 0.007878763601183891 err 17.440284729003906 tr(WHW.T) 2213.58154296875
bpp_loss 3.7377431392669678
31_up proxy err 0.0010579921072348952 err 73.02202606201172 tr(WHW.T) 69019.4453125
bpp_loss 3.9195443221500943
31_gate proxy err 0.0005407559219747782 err 78.11357879638672 tr(WHW.T) 144452.5625
bpp_loss 4.2540420804704935
31_down proxy err 0.006597776897251606 err 65.71510314941406 tr(WHW.T) 9960.1884765625
bpp_loss 3.7242373057774136
I0408 10:33:27.556694 572807 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:33:27.556920 572807 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:33:27.556962 572807 utils.py:162] NumExpr defaulting to 16 threads.
I0408 10:33:27.871518 572807 config.py:54] PyTorch version 2.6.0 available.
W0408 10:33:28.076242 572807 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0408 10:33:28.192401 572807 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.50it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.44it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.85it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  8.99it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.10it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.09it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.34it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.03it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.79it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  9.07it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.21it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.25it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.27it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.21it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.33it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.24it/s]
I0408 10:33:30.955150 572807 hfize_llama.py:161] loaded layer 0
I0408 10:33:31.265164 572807 hfize_llama.py:161] loaded layer 1
I0408 10:33:31.523305 572807 hfize_llama.py:161] loaded layer 2
I0408 10:33:31.827717 572807 hfize_llama.py:161] loaded layer 3
I0408 10:33:32.059257 572807 hfize_llama.py:161] loaded layer 4
I0408 10:33:32.334323 572807 hfize_llama.py:161] loaded layer 5
I0408 10:33:32.588887 572807 hfize_llama.py:161] loaded layer 6
I0408 10:33:32.857940 572807 hfize_llama.py:161] loaded layer 7
I0408 10:33:33.107442 572807 hfize_llama.py:161] loaded layer 8
I0408 10:33:33.367108 572807 hfize_llama.py:161] loaded layer 9
I0408 10:33:33.618050 572807 hfize_llama.py:161] loaded layer 10
I0408 10:33:34.024758 572807 hfize_llama.py:161] loaded layer 11
I0408 10:33:34.289095 572807 hfize_llama.py:161] loaded layer 12
I0408 10:33:34.521691 572807 hfize_llama.py:161] loaded layer 13
I0408 10:33:34.780124 572807 hfize_llama.py:161] loaded layer 14
I0408 10:33:35.053479 572807 hfize_llama.py:161] loaded layer 15
I0408 10:33:35.327429 572807 hfize_llama.py:161] loaded layer 16
I0408 10:33:35.600968 572807 hfize_llama.py:161] loaded layer 17
I0408 10:33:35.876570 572807 hfize_llama.py:161] loaded layer 18
I0408 10:33:36.190304 572807 hfize_llama.py:161] loaded layer 19
I0408 10:33:36.539627 572807 hfize_llama.py:161] loaded layer 20
I0408 10:33:36.898266 572807 hfize_llama.py:161] loaded layer 21
I0408 10:33:37.146821 572807 hfize_llama.py:161] loaded layer 22
I0408 10:33:37.440928 572807 hfize_llama.py:161] loaded layer 23
I0408 10:33:37.706122 572807 hfize_llama.py:161] loaded layer 24
I0408 10:33:38.294228 572807 hfize_llama.py:161] loaded layer 25
I0408 10:33:38.584142 572807 hfize_llama.py:161] loaded layer 26
I0408 10:33:38.880706 572807 hfize_llama.py:161] loaded layer 27
I0408 10:33:39.125293 572807 hfize_llama.py:161] loaded layer 28
I0408 10:33:39.391187 572807 hfize_llama.py:161] loaded layer 29
I0408 10:33:39.668137 572807 hfize_llama.py:161] loaded layer 30
I0408 10:33:39.950338 572807 hfize_llama.py:161] loaded layer 31
I0408 10:33:39.950460 572807 hfize_llama.py:165] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:08,  1.44s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.16s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.08s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.05s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.12s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:01,  1.04s/it]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:07<00:00,  1.05s/it]
I0408 10:34:23.813171 572807 hfize_llama.py:175] successfully loaded hfized model
I0408 10:34:28.892279 573623 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 10:34:28.892463 573623 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 10:34:28.892506 573623 utils.py:162] NumExpr defaulting to 16 threads.
W0408 10:34:29.241995 573623 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0408 10:34:29.620571 573623 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:06,  1.02s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.02s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.02s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.01s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:00,  1.01it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.05it/s]
I0408 10:34:36.387701 573623 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.6922839879989624:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.6922839879989624:   1%|          | 1/141 [00:01<04:20,  1.86s/it]avg_loss = 1.9689651131629944:   1%|          | 1/141 [00:03<04:20,  1.86s/it]avg_loss = 1.9689651131629944:   1%|▏         | 2/141 [00:03<03:45,  1.62s/it]avg_loss = 2.095099091529846:   1%|▏         | 2/141 [00:04<03:45,  1.62s/it] avg_loss = 2.095099091529846:   2%|▏         | 3/141 [00:04<03:34,  1.55s/it]avg_loss = 2.0420157313346863:   2%|▏         | 3/141 [00:06<03:34,  1.55s/it]avg_loss = 2.0420157313346863:   3%|▎         | 4/141 [00:06<03:28,  1.52s/it]avg_loss = 1.9883366823196411:   3%|▎         | 4/141 [00:07<03:28,  1.52s/it]avg_loss = 1.9883366823196411:   4%|▎         | 5/141 [00:07<03:25,  1.51s/it]avg_loss = 1.8919296463330586:   4%|▎         | 5/141 [00:09<03:25,  1.51s/it]avg_loss = 1.8919296463330586:   4%|▍         | 6/141 [00:09<03:22,  1.50s/it]avg_loss = 1.8295015607561385:   4%|▍         | 6/141 [00:10<03:22,  1.50s/it]avg_loss = 1.8295015607561385:   5%|▍         | 7/141 [00:10<03:20,  1.50s/it]avg_loss = 1.8234599381685257:   5%|▍         | 7/141 [00:12<03:20,  1.50s/it]avg_loss = 1.8234599381685257:   6%|▌         | 8/141 [00:12<03:19,  1.50s/it]avg_loss = 1.8568953275680542:   6%|▌         | 8/141 [00:13<03:19,  1.50s/it]avg_loss = 1.8568953275680542:   6%|▋         | 9/141 [00:13<03:17,  1.50s/it]avg_loss = 1.858704721927643:   6%|▋         | 9/141 [00:15<03:17,  1.50s/it] avg_loss = 1.858704721927643:   7%|▋         | 10/141 [00:15<03:16,  1.50s/it]avg_loss = 1.8526506532322278:   7%|▋         | 10/141 [00:16<03:16,  1.50s/it]avg_loss = 1.8526506532322278:   8%|▊         | 11/141 [00:16<03:14,  1.50s/it]avg_loss = 1.8760904173056285:   8%|▊         | 11/141 [00:18<03:14,  1.50s/it]avg_loss = 1.8760904173056285:   9%|▊         | 12/141 [00:18<03:13,  1.50s/it]avg_loss = 1.888812386072599:   9%|▊         | 12/141 [00:19<03:13,  1.50s/it] avg_loss = 1.888812386072599:   9%|▉         | 13/141 [00:19<03:12,  1.50s/it]avg_loss = 1.9067208511488778:   9%|▉         | 13/141 [00:21<03:12,  1.50s/it]avg_loss = 1.9067208511488778:  10%|▉         | 14/141 [00:21<03:11,  1.51s/it]avg_loss = 1.9169085582097372:  10%|▉         | 14/141 [00:22<03:11,  1.51s/it]avg_loss = 1.9169085582097372:  11%|█         | 15/141 [00:22<03:10,  1.51s/it]avg_loss = 1.9411806240677834:  11%|█         | 15/141 [00:24<03:10,  1.51s/it]avg_loss = 1.9411806240677834:  11%|█▏        | 16/141 [00:24<03:08,  1.51s/it]avg_loss = 1.9436292017207426:  11%|█▏        | 16/141 [00:25<03:08,  1.51s/it]avg_loss = 1.9436292017207426:  12%|█▏        | 17/141 [00:25<03:07,  1.51s/it]avg_loss = 1.946879804134369:  12%|█▏        | 17/141 [00:27<03:07,  1.51s/it] avg_loss = 1.946879804134369:  13%|█▎        | 18/141 [00:27<03:06,  1.52s/it]avg_loss = 1.9342662409732216:  13%|█▎        | 18/141 [00:28<03:06,  1.52s/it]avg_loss = 1.9342662409732216:  13%|█▎        | 19/141 [00:28<03:05,  1.52s/it]avg_loss = 1.9332569301128388:  13%|█▎        | 19/141 [00:30<03:05,  1.52s/it]avg_loss = 1.9332569301128388:  14%|█▍        | 20/141 [00:30<03:04,  1.52s/it]avg_loss = 1.938088445436387:  14%|█▍        | 20/141 [00:31<03:04,  1.52s/it] avg_loss = 1.938088445436387:  15%|█▍        | 21/141 [00:31<03:02,  1.52s/it]avg_loss = 1.9399229179729114:  15%|█▍        | 21/141 [00:33<03:02,  1.52s/it]avg_loss = 1.9399229179729114:  16%|█▌        | 22/141 [00:33<03:01,  1.53s/it]avg_loss = 1.9413997556852258:  16%|█▌        | 22/141 [00:34<03:01,  1.53s/it]avg_loss = 1.9413997556852258:  16%|█▋        | 23/141 [00:34<03:00,  1.53s/it]avg_loss = 1.9468222906192143:  16%|█▋        | 23/141 [00:36<03:00,  1.53s/it]avg_loss = 1.9468222906192143:  17%|█▋        | 24/141 [00:36<02:59,  1.53s/it]avg_loss = 1.952642970085144:  17%|█▋        | 24/141 [00:38<02:59,  1.53s/it] avg_loss = 1.952642970085144:  18%|█▊        | 25/141 [00:38<02:57,  1.53s/it]avg_loss = 1.9642428205563471:  18%|█▊        | 25/141 [00:39<02:57,  1.53s/it]avg_loss = 1.9642428205563471:  18%|█▊        | 26/141 [00:39<02:56,  1.53s/it]avg_loss = 1.9766288465923734:  18%|█▊        | 26/141 [00:41<02:56,  1.53s/it]avg_loss = 1.9766288465923734:  19%|█▉        | 27/141 [00:41<02:54,  1.53s/it]avg_loss = 1.9828334663595473:  19%|█▉        | 27/141 [00:42<02:54,  1.53s/it]avg_loss = 1.9828334663595473:  20%|█▉        | 28/141 [00:42<02:53,  1.53s/it]avg_loss = 1.9789420654033791:  20%|█▉        | 28/141 [00:44<02:53,  1.53s/it]avg_loss = 1.9789420654033791:  21%|██        | 29/141 [00:44<02:51,  1.54s/it]avg_loss = 1.9692016561826071:  21%|██        | 29/141 [00:45<02:51,  1.54s/it]avg_loss = 1.9692016561826071:  21%|██▏       | 30/141 [00:45<02:50,  1.54s/it]avg_loss = 1.9558982733757264:  21%|██▏       | 30/141 [00:47<02:50,  1.54s/it]avg_loss = 1.9558982733757264:  22%|██▏       | 31/141 [00:47<02:49,  1.54s/it]avg_loss = 1.9445796459913254:  22%|██▏       | 31/141 [00:48<02:49,  1.54s/it]avg_loss = 1.9445796459913254:  23%|██▎       | 32/141 [00:48<02:47,  1.54s/it]avg_loss = 1.9426933129628499:  23%|██▎       | 32/141 [00:50<02:47,  1.54s/it]avg_loss = 1.9426933129628499:  23%|██▎       | 33/141 [00:50<02:46,  1.54s/it]avg_loss = 1.9408652116270626:  23%|██▎       | 33/141 [00:51<02:46,  1.54s/it]avg_loss = 1.9408652116270626:  24%|██▍       | 34/141 [00:51<02:45,  1.55s/it]avg_loss = 1.9432508162089757:  24%|██▍       | 34/141 [00:53<02:45,  1.55s/it]avg_loss = 1.9432508162089757:  25%|██▍       | 35/141 [00:53<02:44,  1.55s/it]avg_loss = 1.9265742500623066:  25%|██▍       | 35/141 [00:55<02:44,  1.55s/it]avg_loss = 1.9265742500623066:  26%|██▌       | 36/141 [00:55<02:42,  1.55s/it]avg_loss = 1.9107407267029222:  26%|██▌       | 36/141 [00:56<02:42,  1.55s/it]avg_loss = 1.9107407267029222:  26%|██▌       | 37/141 [00:56<02:40,  1.55s/it]avg_loss = 1.8955443093651219:  26%|██▌       | 37/141 [00:58<02:40,  1.55s/it]avg_loss = 1.8955443093651219:  27%|██▋       | 38/141 [00:58<02:39,  1.55s/it]avg_loss = 1.8811652171306121:  27%|██▋       | 38/141 [00:59<02:39,  1.55s/it]avg_loss = 1.8811652171306121:  28%|██▊       | 39/141 [00:59<02:38,  1.55s/it]avg_loss = 1.8723980098962785:  28%|██▊       | 39/141 [01:01<02:38,  1.55s/it]avg_loss = 1.8723980098962785:  28%|██▊       | 40/141 [01:01<02:36,  1.55s/it]avg_loss = 1.8771859116670562:  28%|██▊       | 40/141 [01:02<02:36,  1.55s/it]avg_loss = 1.8771859116670562:  29%|██▉       | 41/141 [01:02<02:35,  1.56s/it]avg_loss = 1.8936728494507926:  29%|██▉       | 41/141 [01:04<02:35,  1.56s/it]avg_loss = 1.8936728494507926:  30%|██▉       | 42/141 [01:04<02:34,  1.56s/it]avg_loss = 1.910017537516217:  30%|██▉       | 42/141 [01:05<02:34,  1.56s/it] avg_loss = 1.910017537516217:  30%|███       | 43/141 [01:05<02:32,  1.56s/it]avg_loss = 1.9142534814097665:  30%|███       | 43/141 [01:07<02:32,  1.56s/it]avg_loss = 1.9142534814097665:  31%|███       | 44/141 [01:07<02:31,  1.56s/it]avg_loss = 1.9186434613333807:  31%|███       | 44/141 [01:09<02:31,  1.56s/it]avg_loss = 1.9186434613333807:  32%|███▏      | 45/141 [01:09<02:29,  1.56s/it]avg_loss = 1.9238552762114483:  32%|███▏      | 45/141 [01:10<02:29,  1.56s/it]avg_loss = 1.9238552762114483:  33%|███▎      | 46/141 [01:10<02:28,  1.56s/it]avg_loss = 1.9300654467116012:  33%|███▎      | 46/141 [01:12<02:28,  1.56s/it]avg_loss = 1.9300654467116012:  33%|███▎      | 47/141 [01:12<02:26,  1.56s/it]avg_loss = 1.9332649285594623:  33%|███▎      | 47/141 [01:13<02:26,  1.56s/it]avg_loss = 1.9332649285594623:  34%|███▍      | 48/141 [01:13<02:25,  1.56s/it]avg_loss = 1.9323394055269203:  34%|███▍      | 48/141 [01:15<02:25,  1.56s/it]avg_loss = 1.9323394055269203:  35%|███▍      | 49/141 [01:15<02:24,  1.57s/it]avg_loss = 1.9324011301994324:  35%|███▍      | 49/141 [01:16<02:24,  1.57s/it]avg_loss = 1.9324011301994324:  35%|███▌      | 50/141 [01:16<02:22,  1.57s/it]avg_loss = 1.9261176258909936:  35%|███▌      | 50/141 [01:18<02:22,  1.57s/it]avg_loss = 1.9261176258909936:  36%|███▌      | 51/141 [01:18<02:21,  1.57s/it]avg_loss = 1.9220452973475823:  36%|███▌      | 51/141 [01:20<02:21,  1.57s/it]avg_loss = 1.9220452973475823:  37%|███▋      | 52/141 [01:20<02:19,  1.57s/it]avg_loss = 1.9152942693458412:  37%|███▋      | 52/141 [01:21<02:19,  1.57s/it]avg_loss = 1.9152942693458412:  38%|███▊      | 53/141 [01:21<02:18,  1.57s/it]avg_loss = 1.9120954429661785:  38%|███▊      | 53/141 [01:23<02:18,  1.57s/it]avg_loss = 1.9120954429661785:  38%|███▊      | 54/141 [01:23<02:16,  1.57s/it]avg_loss = 1.904432901469144:  38%|███▊      | 54/141 [01:24<02:16,  1.57s/it] avg_loss = 1.904432901469144:  39%|███▉      | 55/141 [01:24<02:15,  1.58s/it]avg_loss = 1.896738350391388:  39%|███▉      | 55/141 [01:26<02:15,  1.58s/it]avg_loss = 1.896738350391388:  40%|███▉      | 56/141 [01:26<02:14,  1.58s/it]avg_loss = 1.8922129932202791:  40%|███▉      | 56/141 [01:27<02:14,  1.58s/it]avg_loss = 1.8922129932202791:  40%|████      | 57/141 [01:27<02:12,  1.58s/it]avg_loss = 1.8891111612319946:  40%|████      | 57/141 [01:29<02:12,  1.58s/it]avg_loss = 1.8891111612319946:  41%|████      | 58/141 [01:29<02:11,  1.58s/it]avg_loss = 1.8913410962638209:  41%|████      | 58/141 [01:31<02:11,  1.58s/it]avg_loss = 1.8913410962638209:  42%|████▏     | 59/141 [01:31<02:09,  1.58s/it]avg_loss = 1.8966453830401102:  42%|████▏     | 59/141 [01:32<02:09,  1.58s/it]avg_loss = 1.8966453830401102:  43%|████▎     | 60/141 [01:32<02:07,  1.58s/it]avg_loss = 1.9022106381713366:  43%|████▎     | 60/141 [01:34<02:07,  1.58s/it]avg_loss = 1.9022106381713366:  43%|████▎     | 61/141 [01:34<02:06,  1.58s/it]avg_loss = 1.9093003349919473:  43%|████▎     | 61/141 [01:35<02:06,  1.58s/it]avg_loss = 1.9093003349919473:  44%|████▍     | 62/141 [01:35<02:04,  1.57s/it]avg_loss = 1.9003796236855643:  44%|████▍     | 62/141 [01:37<02:04,  1.57s/it]avg_loss = 1.9003796236855643:  45%|████▍     | 63/141 [01:37<02:02,  1.58s/it]avg_loss = 1.8982194792479277:  45%|████▍     | 63/141 [01:38<02:02,  1.58s/it]avg_loss = 1.8982194792479277:  45%|████▌     | 64/141 [01:38<02:01,  1.58s/it]avg_loss = 1.8957234657727755:  45%|████▌     | 64/141 [01:40<02:01,  1.58s/it]avg_loss = 1.8957234657727755:  46%|████▌     | 65/141 [01:40<02:00,  1.58s/it]avg_loss = 1.8898503310752637:  46%|████▌     | 65/141 [01:42<02:00,  1.58s/it]avg_loss = 1.8898503310752637:  47%|████▋     | 66/141 [01:42<01:58,  1.58s/it]avg_loss = 1.887286006514706:  47%|████▋     | 66/141 [01:43<01:58,  1.58s/it] avg_loss = 1.887286006514706:  48%|████▊     | 67/141 [01:43<01:57,  1.58s/it]avg_loss = 1.884051461430157:  48%|████▊     | 67/141 [01:45<01:57,  1.58s/it]avg_loss = 1.884051461430157:  48%|████▊     | 68/141 [01:45<01:55,  1.58s/it]avg_loss = 1.8812026580174763:  48%|████▊     | 68/141 [01:46<01:55,  1.58s/it]avg_loss = 1.8812026580174763:  49%|████▉     | 69/141 [01:46<01:53,  1.58s/it]avg_loss = 1.8822205526488167:  49%|████▉     | 69/141 [01:48<01:53,  1.58s/it]avg_loss = 1.8822205526488167:  50%|████▉     | 70/141 [01:48<01:52,  1.58s/it]avg_loss = 1.885903971295961:  50%|████▉     | 70/141 [01:50<01:52,  1.58s/it] avg_loss = 1.885903971295961:  50%|█████     | 71/141 [01:50<01:50,  1.58s/it]avg_loss = 1.8885819365580876:  50%|█████     | 71/141 [01:51<01:50,  1.58s/it]avg_loss = 1.8885819365580876:  51%|█████     | 72/141 [01:51<01:49,  1.58s/it]avg_loss = 1.8869895428827363:  51%|█████     | 72/141 [01:53<01:49,  1.58s/it]avg_loss = 1.8869895428827363:  52%|█████▏    | 73/141 [01:53<01:47,  1.58s/it]avg_loss = 1.88865710432465:  52%|█████▏    | 73/141 [01:54<01:47,  1.58s/it]  avg_loss = 1.88865710432465:  52%|█████▏    | 74/141 [01:54<01:45,  1.58s/it]avg_loss = 1.888816343943278:  52%|█████▏    | 74/141 [01:56<01:45,  1.58s/it]avg_loss = 1.888816343943278:  53%|█████▎    | 75/141 [01:56<01:44,  1.58s/it]avg_loss = 1.8876211219712307:  53%|█████▎    | 75/141 [01:57<01:44,  1.58s/it]avg_loss = 1.8876211219712307:  54%|█████▍    | 76/141 [01:57<01:42,  1.58s/it]avg_loss = 1.8887437024673859:  54%|█████▍    | 76/141 [01:59<01:42,  1.58s/it]avg_loss = 1.8887437024673859:  55%|█████▍    | 77/141 [01:59<01:41,  1.58s/it]avg_loss = 1.8910603202306306:  55%|█████▍    | 77/141 [02:01<01:41,  1.58s/it]avg_loss = 1.8910603202306306:  55%|█████▌    | 78/141 [02:01<01:39,  1.58s/it]avg_loss = 1.8948901167398766:  55%|█████▌    | 78/141 [02:02<01:39,  1.58s/it]avg_loss = 1.8948901167398766:  56%|█████▌    | 79/141 [02:02<01:38,  1.58s/it]avg_loss = 1.8917798325419426:  56%|█████▌    | 79/141 [02:04<01:38,  1.58s/it]avg_loss = 1.8917798325419426:  57%|█████▋    | 80/141 [02:04<01:36,  1.58s/it]avg_loss = 1.8904435163662758:  57%|█████▋    | 80/141 [02:05<01:36,  1.58s/it]avg_loss = 1.8904435163662758:  57%|█████▋    | 81/141 [02:05<01:34,  1.58s/it]avg_loss = 1.8895224914318178:  57%|█████▋    | 81/141 [02:07<01:34,  1.58s/it]avg_loss = 1.8895224914318178:  58%|█████▊    | 82/141 [02:07<01:33,  1.58s/it]avg_loss = 1.887708355145282:  58%|█████▊    | 82/141 [02:08<01:33,  1.58s/it] avg_loss = 1.887708355145282:  59%|█████▉    | 83/141 [02:09<01:31,  1.59s/it]avg_loss = 1.8853602721577598:  59%|█████▉    | 83/141 [02:10<01:31,  1.59s/it]avg_loss = 1.8853602721577598:  60%|█████▉    | 84/141 [02:10<01:30,  1.59s/it]avg_loss = 1.882938333118663:  60%|█████▉    | 84/141 [02:12<01:30,  1.59s/it] avg_loss = 1.882938333118663:  60%|██████    | 85/141 [02:12<01:28,  1.59s/it]avg_loss = 1.8844221594721773:  60%|██████    | 85/141 [02:13<01:28,  1.59s/it]avg_loss = 1.8844221594721773:  61%|██████    | 86/141 [02:13<01:27,  1.59s/it]avg_loss = 1.8861268210685116:  61%|██████    | 86/141 [02:15<01:27,  1.59s/it]avg_loss = 1.8861268210685116:  62%|██████▏   | 87/141 [02:15<01:25,  1.59s/it]avg_loss = 1.8868733129718087:  62%|██████▏   | 87/141 [02:16<01:25,  1.59s/it]avg_loss = 1.8868733129718087:  62%|██████▏   | 88/141 [02:16<01:24,  1.59s/it]avg_loss = 1.8956531594308574:  62%|██████▏   | 88/141 [02:18<01:24,  1.59s/it]avg_loss = 1.8956531594308574:  63%|██████▎   | 89/141 [02:18<01:22,  1.59s/it]avg_loss = 1.9030432568656073:  63%|██████▎   | 89/141 [02:20<01:22,  1.59s/it]avg_loss = 1.9030432568656073:  64%|██████▍   | 90/141 [02:20<01:20,  1.58s/it]avg_loss = 1.9061106797103042:  64%|██████▍   | 90/141 [02:21<01:20,  1.58s/it]avg_loss = 1.9061106797103042:  65%|██████▍   | 91/141 [02:21<01:19,  1.58s/it]avg_loss = 1.9109840574471846:  65%|██████▍   | 91/141 [02:23<01:19,  1.58s/it]avg_loss = 1.9109840574471846:  65%|██████▌   | 92/141 [02:23<01:17,  1.59s/it]avg_loss = 1.9160352112144552:  65%|██████▌   | 92/141 [02:24<01:17,  1.59s/it]avg_loss = 1.9160352112144552:  66%|██████▌   | 93/141 [02:24<01:16,  1.59s/it]avg_loss = 1.9170058813500912:  66%|██████▌   | 93/141 [02:26<01:16,  1.59s/it]avg_loss = 1.9170058813500912:  67%|██████▋   | 94/141 [02:26<01:14,  1.58s/it]avg_loss = 1.9205673945577522:  67%|██████▋   | 94/141 [02:28<01:14,  1.58s/it]avg_loss = 1.9205673945577522:  67%|██████▋   | 95/141 [02:28<01:12,  1.58s/it]avg_loss = 1.9213206047813098:  67%|██████▋   | 95/141 [02:29<01:12,  1.58s/it]avg_loss = 1.9213206047813098:  68%|██████▊   | 96/141 [02:29<01:11,  1.59s/it]avg_loss = 1.9230499906638234:  68%|██████▊   | 96/141 [02:31<01:11,  1.59s/it]avg_loss = 1.9230499906638234:  69%|██████▉   | 97/141 [02:31<01:09,  1.59s/it]avg_loss = 1.9196377579046755:  69%|██████▉   | 97/141 [02:32<01:09,  1.59s/it]avg_loss = 1.9196377579046755:  70%|██████▉   | 98/141 [02:32<01:08,  1.59s/it]avg_loss = 1.9207896247054592:  70%|██████▉   | 98/141 [02:34<01:08,  1.59s/it]avg_loss = 1.9207896247054592:  70%|███████   | 99/141 [02:34<01:06,  1.59s/it]avg_loss = 1.9229499554634095:  70%|███████   | 99/141 [02:35<01:06,  1.59s/it]avg_loss = 1.9229499554634095:  71%|███████   | 100/141 [02:35<01:05,  1.59s/it]avg_loss = 1.9219598380645904:  71%|███████   | 100/141 [02:37<01:05,  1.59s/it]avg_loss = 1.9219598380645904:  72%|███████▏  | 101/141 [02:37<01:03,  1.59s/it]avg_loss = 1.9222545226414998:  72%|███████▏  | 101/141 [02:39<01:03,  1.59s/it]avg_loss = 1.9222545226414998:  72%|███████▏  | 102/141 [02:39<01:02,  1.59s/it]avg_loss = 1.921069315336283:  72%|███████▏  | 102/141 [02:40<01:02,  1.59s/it] avg_loss = 1.921069315336283:  73%|███████▎  | 103/141 [02:40<01:00,  1.59s/it]avg_loss = 1.9239183125587611:  73%|███████▎  | 103/141 [02:42<01:00,  1.59s/it]avg_loss = 1.9239183125587611:  74%|███████▍  | 104/141 [02:42<00:58,  1.59s/it]avg_loss = 1.9228190967014858:  74%|███████▍  | 104/141 [02:43<00:58,  1.59s/it]avg_loss = 1.9228190967014858:  74%|███████▍  | 105/141 [02:43<00:57,  1.59s/it]avg_loss = 1.9219598477741457:  74%|███████▍  | 105/141 [02:45<00:57,  1.59s/it]avg_loss = 1.9219598477741457:  75%|███████▌  | 106/141 [02:45<00:55,  1.59s/it]avg_loss = 1.9196745580601915:  75%|███████▌  | 106/141 [02:47<00:55,  1.59s/it]avg_loss = 1.9196745580601915:  76%|███████▌  | 107/141 [02:47<00:54,  1.60s/it]avg_loss = 1.9174857249966375:  76%|███████▌  | 107/141 [02:48<00:54,  1.60s/it]avg_loss = 1.9174857249966375:  77%|███████▋  | 108/141 [02:48<00:52,  1.60s/it]avg_loss = 1.915172609714193:  77%|███████▋  | 108/141 [02:50<00:52,  1.60s/it] avg_loss = 1.915172609714193:  77%|███████▋  | 109/141 [02:50<00:51,  1.60s/it]avg_loss = 1.9126967126672918:  77%|███████▋  | 109/141 [02:51<00:51,  1.60s/it]avg_loss = 1.9126967126672918:  78%|███████▊  | 110/141 [02:51<00:49,  1.60s/it]avg_loss = 1.915026314623721:  78%|███████▊  | 110/141 [02:53<00:49,  1.60s/it] avg_loss = 1.915026314623721:  79%|███████▊  | 111/141 [02:53<00:47,  1.60s/it]avg_loss = 1.9147411520992006:  79%|███████▊  | 111/141 [02:55<00:47,  1.60s/it]avg_loss = 1.9147411520992006:  79%|███████▉  | 112/141 [02:55<00:46,  1.60s/it]avg_loss = 1.9158229131614213:  79%|███████▉  | 112/141 [02:56<00:46,  1.60s/it]avg_loss = 1.9158229131614213:  80%|████████  | 113/141 [02:56<00:44,  1.60s/it]avg_loss = 1.9166226010573537:  80%|████████  | 113/141 [02:58<00:44,  1.60s/it]avg_loss = 1.9166226010573537:  81%|████████  | 114/141 [02:58<00:43,  1.60s/it]avg_loss = 1.915683350355729:  81%|████████  | 114/141 [02:59<00:43,  1.60s/it] avg_loss = 1.915683350355729:  82%|████████▏ | 115/141 [02:59<00:41,  1.60s/it]avg_loss = 1.9144715194044442:  82%|████████▏ | 115/141 [03:01<00:41,  1.60s/it]avg_loss = 1.9144715194044442:  82%|████████▏ | 116/141 [03:01<00:39,  1.60s/it]avg_loss = 1.9166163746108356:  82%|████████▏ | 116/141 [03:03<00:39,  1.60s/it]avg_loss = 1.9166163746108356:  83%|████████▎ | 117/141 [03:03<00:38,  1.60s/it]avg_loss = 1.9162050394688623:  83%|████████▎ | 117/141 [03:04<00:38,  1.60s/it]avg_loss = 1.9162050394688623:  84%|████████▎ | 118/141 [03:04<00:36,  1.60s/it]avg_loss = 1.9147503355971904:  84%|████████▎ | 118/141 [03:06<00:36,  1.60s/it]avg_loss = 1.9147503355971904:  84%|████████▍ | 119/141 [03:06<00:35,  1.60s/it]avg_loss = 1.9129642883936564:  84%|████████▍ | 119/141 [03:07<00:35,  1.60s/it]avg_loss = 1.9129642883936564:  85%|████████▌ | 120/141 [03:07<00:33,  1.60s/it]avg_loss = 1.9127681058300428:  85%|████████▌ | 120/141 [03:09<00:33,  1.60s/it]avg_loss = 1.9127681058300428:  86%|████████▌ | 121/141 [03:09<00:31,  1.60s/it]avg_loss = 1.9132105405213402:  86%|████████▌ | 121/141 [03:11<00:31,  1.60s/it]avg_loss = 1.9132105405213402:  87%|████████▋ | 122/141 [03:11<00:30,  1.60s/it]avg_loss = 1.9130452881014444:  87%|████████▋ | 122/141 [03:12<00:30,  1.60s/it]avg_loss = 1.9130452881014444:  87%|████████▋ | 123/141 [03:12<00:28,  1.60s/it]avg_loss = 1.9131646829266702:  87%|████████▋ | 123/141 [03:14<00:28,  1.60s/it]avg_loss = 1.9131646829266702:  88%|████████▊ | 124/141 [03:14<00:27,  1.60s/it]avg_loss = 1.91188152885437:  88%|████████▊ | 124/141 [03:15<00:27,  1.60s/it]  avg_loss = 1.91188152885437:  89%|████████▊ | 125/141 [03:15<00:25,  1.60s/it]avg_loss = 1.9122404948113456:  89%|████████▊ | 125/141 [03:17<00:25,  1.60s/it]avg_loss = 1.9122404948113456:  89%|████████▉ | 126/141 [03:17<00:23,  1.60s/it]avg_loss = 1.9118584713597937:  89%|████████▉ | 126/141 [03:19<00:23,  1.60s/it]avg_loss = 1.9118584713597937:  90%|█████████ | 127/141 [03:19<00:22,  1.60s/it]avg_loss = 1.9105439120903611:  90%|█████████ | 127/141 [03:20<00:22,  1.60s/it]avg_loss = 1.9105439120903611:  91%|█████████ | 128/141 [03:20<00:20,  1.60s/it]avg_loss = 1.9106492783672127:  91%|█████████ | 128/141 [03:22<00:20,  1.60s/it]avg_loss = 1.9106492783672127:  91%|█████████▏| 129/141 [03:22<00:19,  1.60s/it]avg_loss = 1.9114541723177982:  91%|█████████▏| 129/141 [03:23<00:19,  1.60s/it]avg_loss = 1.9114541723177982:  92%|█████████▏| 130/141 [03:23<00:17,  1.60s/it]avg_loss = 1.9123795769596827:  92%|█████████▏| 130/141 [03:25<00:17,  1.60s/it]avg_loss = 1.9123795769596827:  93%|█████████▎| 131/141 [03:25<00:15,  1.60s/it]avg_loss = 1.9128979173573581:  93%|█████████▎| 131/141 [03:27<00:15,  1.60s/it]avg_loss = 1.9128979173573581:  94%|█████████▎| 132/141 [03:27<00:14,  1.59s/it]avg_loss = 1.9098703144188214:  94%|█████████▎| 132/141 [03:28<00:14,  1.59s/it]avg_loss = 1.9098703144188214:  94%|█████████▍| 133/141 [03:28<00:12,  1.59s/it]avg_loss = 1.9053746853301774:  94%|█████████▍| 133/141 [03:30<00:12,  1.59s/it]avg_loss = 1.9053746853301774:  95%|█████████▌| 134/141 [03:30<00:11,  1.59s/it]avg_loss = 1.9077882395850287:  95%|█████████▌| 134/141 [03:31<00:11,  1.59s/it]avg_loss = 1.9077882395850287:  96%|█████████▌| 135/141 [03:31<00:09,  1.59s/it]avg_loss = 1.9113141385947956:  96%|█████████▌| 135/141 [03:33<00:09,  1.59s/it]avg_loss = 1.9113141385947956:  96%|█████████▋| 136/141 [03:33<00:07,  1.59s/it]avg_loss = 1.9126273558957734:  96%|█████████▋| 136/141 [03:35<00:07,  1.59s/it]avg_loss = 1.9126273558957734:  97%|█████████▋| 137/141 [03:35<00:06,  1.59s/it]avg_loss = 1.91140315670898:  97%|█████████▋| 137/141 [03:36<00:06,  1.59s/it]  avg_loss = 1.91140315670898:  98%|█████████▊| 138/141 [03:36<00:04,  1.59s/it]avg_loss = 1.9116703066036855:  98%|█████████▊| 138/141 [03:38<00:04,  1.59s/it]avg_loss = 1.9116703066036855:  99%|█████████▊| 139/141 [03:38<00:03,  1.59s/it]avg_loss = 1.9123773140566689:  99%|█████████▊| 139/141 [03:39<00:03,  1.59s/it]avg_loss = 1.9123773140566689:  99%|█████████▉| 140/141 [03:39<00:01,  1.59s/it]avg_loss = 1.9135602695722107:  99%|█████████▉| 140/141 [03:41<00:01,  1.59s/it]avg_loss = 1.9135602695722107: 100%|██████████| 141/141 [03:41<00:00,  1.59s/it]avg_loss = 1.9135602695722107: 100%|██████████| 141/141 [03:41<00:00,  1.57s/it]
I0408 10:38:41.852540 573623 eval_ppl.py:107] wikitext2 perplexity: 6.777174472808838
wikitext2 perplexity: 6.777
