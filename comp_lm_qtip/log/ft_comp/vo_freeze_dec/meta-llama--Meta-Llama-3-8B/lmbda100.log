I0408 11:04:31.614643 589684 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:04:31.614745 589684 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:04:31.614784 589684 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:04:31.936553 589684 config.py:54] PyTorch version 2.6.0 available.
W0408 11:04:32.124245 589684 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 11:04:32.817179 589684 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.21it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.70it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.86it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  7.95it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  8.02it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  7.86it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.84it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.83it/s]
I0408 11:04:34.276457 589684 quantize_finetune_llama.py:158] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:00<00:00, 16720.78it/s]
I0408 11:04:38.235394 589684 quantize_finetune_llama.py:196] loaded compression model
I0408 11:04:56.171813 589684 quantize_finetune_llama.py:200] loaded dataset and devset
I0408 11:05:02.138550 589684 quantize_finetune_llama.py:220] layer 0 gpu 0
I0408 11:05:05.703786 589684 quantize_finetune_llama.py:251] computed original embedding for layer 0 in 3.4146087169647217s
tensor(-4.7143e-06) tensor(0.0125)
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0408 11:05:23.372938 590362 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:05:23.373031 590362 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:05:23.373070 590362 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:05:23.692483 590362 config.py:54] PyTorch version 2.6.0 available.
W0408 11:05:23.878049 590362 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 11:05:24.452437 590362 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:05:24.456449 589684 quantize_finetune_llama.py:220] layer 1 gpu 1
I0408 11:05:24.469357 590362 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
0_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]0_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.80it/s]0_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.65it/s]0_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.08it/s]0_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.36it/s]0_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.55it/s]0_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.67it/s]0_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.74it/s]0_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.79it/s]0_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.83it/s]I0408 11:05:27.789343 589684 quantize_finetune_llama.py:251] computed original embedding for layer 1 in 3.1621484756469727s
0_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.79it/s]0_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.80it/s]0_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.84it/s]0_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.84it/s]0_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.86it/s]0_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.86it/s]0_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.86it/s]0_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.85it/s]0_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.85it/s]0_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.85it/s]0_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.84it/s]0_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.85it/s]0_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.83it/s]0_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.86it/s]I0408 11:05:31.285725 590505 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:05:31.285820 590505 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:05:31.285861 590505 utils.py:162] NumExpr defaulting to 16 threads.
0_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.86it/s]I0408 11:05:31.609656 590505 config.py:54] PyTorch version 2.6.0 available.
0_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.88it/s]W0408 11:05:31.800368 590505 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

0_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.86it/s]0_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.88it/s]W0408 11:05:32.335274 590505 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:05:32.339050 589684 quantize_finetune_llama.py:220] layer 2 gpu 2
I0408 11:05:32.358482 590505 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.87it/s]0_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.87it/s]v
1_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]0_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.86it/s]0_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.72it/s]0_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.58it/s]0_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.07it/s]0_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.88it/s]1_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.37it/s]0_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.55it/s]0_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.69it/s]0_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.78it/s]0_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:23,  3.85it/s]0_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.89it/s]0_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.88it/s]1_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.91it/s]I0408 11:05:35.757456 589684 quantize_finetune_llama.py:251] computed original embedding for layer 2 in 3.2576370239257812s
0_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.88it/s]1_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.85it/s]0_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.82it/s]0_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.84it/s]0_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.86it/s]0_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.88it/s]0_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.82it/s]1_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.94it/s]0_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.82it/s]1_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.95it/s]0_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.93it/s]I0408 11:05:39.342201 590670 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:05:39.342303 590670 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:05:39.342341 590670 utils.py:162] NumExpr defaulting to 16 threads.
0_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.92it/s]I0408 11:05:39.682437 590670 config.py:54] PyTorch version 2.6.0 available.
0_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:18,  3.92it/s]W0408 11:05:39.873742 590670 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

0_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.90it/s]1_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.83it/s]W0408 11:05:40.451447 590670 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:05:40.455201 589684 quantize_finetune_llama.py:220] layer 3 gpu 3
I0408 11:05:40.468784 590670 data_utils.py:336] using 256 training seqs, 128 validation seqs
1_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.82it/s]1_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.90it/s]0_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.78it/s]v
2_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]1_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.81it/s]1_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.81it/s]1_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:06,  1.48it/s]0_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.83it/s]1_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:08<00:16,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.35it/s]0_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.88it/s]0_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.84it/s]2_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.23it/s]1_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.44it/s]0_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.25it/s]2_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.60it/s]1_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.89it/s]0_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.42it/s]2_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.67it/s]1_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.91it/s]I0408 11:05:43.142590 589684 quantize_finetune_llama.py:251] computed original embedding for layer 3 in 2.533557653427124s
0_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.73it/s]1_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.90it/s]0_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.60it/s]2_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.77it/s]1_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.89it/s]0_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.67it/s]1_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.89it/s]2_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.81it/s]0_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.74it/s]2_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.89it/s]0_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.79it/s]2_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.88it/s]0_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.79it/s]2_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.89it/s]0_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.84it/s]2_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.90it/s]0_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.91it/s]1_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.92it/s]1_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:20,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.90it/s]2_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.93it/s]0_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.91it/s]I0408 11:05:46.761139 590819 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:05:46.761242 590819 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:05:46.761284 590819 utils.py:162] NumExpr defaulting to 16 threads.
2_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:19,  3.92it/s]1_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.87it/s]I0408 11:05:47.091462 590819 config.py:54] PyTorch version 2.6.0 available.
2_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.93it/s]1_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.86it/s]W0408 11:05:47.284309 590819 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

2_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.93it/s]1_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.81it/s]2_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:10,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.83it/s]W0408 11:05:47.933835 590819 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:05:47.937552 589684 quantize_finetune_llama.py:220] layer 4 gpu 0
I0408 11:05:47.950834 590819 data_utils.py:336] using 256 training seqs, 128 validation seqs
2_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:18,  3.90it/s]1_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.81it/s]2_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.81it/s]v
3_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]1_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.88it/s]0_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.82it/s]2_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:09,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.84it/s]3_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.88it/s]2_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.90it/s]0_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.83it/s]3_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:35,  2.74it/s]1_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.90it/s]2_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.88it/s]0_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.82it/s]3_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:30,  3.18it/s]1_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.90it/s]0_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.79it/s]3_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:27,  3.43it/s]1_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:08,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.81it/s]3_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.61it/s]1_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:16,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.83it/s]3_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.72it/s]2_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.89it/s]0_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.82it/s]3_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.77it/s]1_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.23it/s]2_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.90it/s]0_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.81it/s]1_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.41it/s]3_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.80it/s]2_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.91it/s]0_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.80it/s]3_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.83it/s]1_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.65it/s]3_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.87it/s]2_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.92it/s]0_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.84it/s]0_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.78it/s]
1_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.72it/s]3_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.87it/s]2_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.91it/s]1_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.78it/s]3_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.89it/s]2_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.93it/s]1_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.82it/s]3_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.89it/s]2_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.90it/s]1_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.84it/s]3_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.90it/s]2_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.90it/s]3_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.91it/s]1_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.90it/s]1_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:19<00:06,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.90it/s]3_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.90it/s]1_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.91it/s]3_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.88it/s]1_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.82it/s]2_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.83it/s]2_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.90it/s]3_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:20<00:05,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.84it/s]3_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:21<00:04,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:19,  3.83it/s]1_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.84it/s]1_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.84it/s]2_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.84it/s]tensor(-6.8242e-08, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0095, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0094, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9992, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0087, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9906, device='cuda:0', grad_fn=<MinBackward1>)
0_v proxy err 0.06381132453680038 err 3.885270357131958 tr(WHW.T) 60.88684844970703
bpp_loss 3.160883903503418
0_q proxy err 0.00010959242354147136 err 31.5729923248291 tr(WHW.T) 288094.65625
bpp_loss 4.030368447303772
0_k proxy err 9.983196650864556e-05 err 10.001239776611328 tr(WHW.T) 100180.734375
bpp_loss 4.642569065093994
o
0_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]2_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.87it/s]3_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:18,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.87it/s]3_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.85it/s]1_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.87it/s]3_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.87it/s]1_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.87it/s]3_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.88it/s]1_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.86it/s]1_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.88it/s]1_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.91it/s]1_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.88it/s]2_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.92it/s]1_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.88it/s]2_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.25it/s]3_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.92it/s]1_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:25<00:00,  3.88it/s]2_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.42it/s]3_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.92it/s]1_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.89it/s]1_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]
0_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.99s/it]2_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.55it/s]3_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.64it/s]3_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.68it/s]3_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.91it/s]3_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.74it/s]3_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:13,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.79it/s]3_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.83it/s]3_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.83it/s]3_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.83it/s]3_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.87it/s]2_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.84it/s]3_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.82it/s]0_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:53,  2.99s/it]3_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.85it/s]2_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.83it/s]3_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.84it/s]3_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.87it/s]2_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.88it/s]2_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.87it/s]3_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.89it/s]2_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.86it/s]1.6922695067478344e-06 0.00841656792908907 -0.008365783840417862
0.9995758533477783 1.0084168910980225 0.9917073845863342
1_v proxy err 0.03857170417904854 err 4.207052707672119 tr(WHW.T) 109.07096099853516
bpp_loss 3.2908060550689697
1_q proxy err 0.00018466476467438042 err 26.744348526000977 tr(WHW.T) 144826.484375
bpp_loss 4.268676280975342
1_k proxy err 0.00010360204760218039 err 7.825999736785889 tr(WHW.T) 75539.046875
bpp_loss 4.983175754547119
o
1_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]3_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.86it/s]2_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.85it/s]3_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.89it/s]2_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:09,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.85it/s]3_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.90it/s]2_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.91it/s]2_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.86it/s]3_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.87it/s]0_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:50,  3.00s/it]3_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:08,  3.93it/s]2_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.87it/s]3_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.92it/s]2_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.88it/s]2_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.90it/s]3_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.24it/s]2_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.43it/s]2_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.88it/s]1_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.98s/it]3_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.63it/s]2_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.70it/s]2_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.89it/s]2_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.80it/s]
3_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.76it/s]3_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.81it/s]3_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.79it/s]3_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.85it/s]0_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:47,  3.00s/it]3_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:19<00:06,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.90it/s]3_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:20<00:05,  3.92it/s]3_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.94it/s]1_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:51,  2.97s/it]3_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.95it/s]3_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.93it/s]3_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.90it/s]3_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.87it/s]3_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.89it/s]0_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:44,  3.00s/it]3_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.90it/s]-4.490369178711262e-07 0.006451224442571402 -0.006024020723998547
0.9998473525047302 1.0064517259597778 0.9939496517181396
2_v proxy err 0.02655865252017975 err 4.142074108123779 tr(WHW.T) 155.95950317382812
bpp_loss 3.191200017929077
2_q proxy err 0.000551645818632096 err 22.879596710205078 tr(WHW.T) 41475.15625
bpp_loss 4.24832010269165
2_k proxy err 0.0002991344372276217 err 6.7647857666015625 tr(WHW.T) 22614.533203125
bpp_loss 5.134323596954346
o
2_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]3_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.91it/s]3_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.89it/s]3_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.90it/s]1_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:48,  2.98s/it]3_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.92it/s]3_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.91it/s]3_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.92it/s]3_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.93it/s]3_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.93it/s]3_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.93it/s]0_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:41,  3.00s/it]3_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:25<00:00,  3.93it/s]3_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.88it/s]3_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]
2_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:56,  3.00s/it]1_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:38,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.98s/it]6.665768523816951e-07 0.006167321931570768 -0.006803535856306553
0.9999217987060547 1.0067921876907349 0.9943757057189941
3_v proxy err 0.014727714471518993 err 4.261216163635254 tr(WHW.T) 289.3331604003906
bpp_loss 3.302434206008911
3_q proxy err 0.0004838559834752232 err 23.020381927490234 tr(WHW.T) 47576.9296875
bpp_loss 4.282341003417969
3_k proxy err 0.0002550834615249187 err 6.676685810089111 tr(WHW.T) 26174.515625
bpp_loss 5.20915412902832
o
3_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]0_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:35,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:54,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:32,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:50,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:29,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:47,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:27,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:44,  2.96s/it]0_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:24,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:41,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:21,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:38,  2.96s/it]0_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:18,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:35,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:15,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:32,  2.96s/it]0_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:12,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:29,  2.96s/it]0_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:09,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:06,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:03,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:05,  3.06s/it]2_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:00,  3.05s/it]2_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:56,  3.04s/it]2_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.04s/it]3_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:58,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:09,  3.04s/it]1_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<04:03,  3.08s/it]3_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:13,  3.02s/it]0_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:52,  3.06s/it]2_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:04,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:57,  3.05s/it]3_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:09,  3.01s/it]0_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:48,  3.05s/it]2_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:05,  3.07s/it]1_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:52,  3.02s/it]3_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:05,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:44,  3.04s/it]2_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:59,  3.04s/it]1_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:48,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:02,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:41,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:55,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  3.00s/it]3_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:03,  3.05s/it]0_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:37,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.00s/it]1_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]0_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:34,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  3.00s/it]1_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]0_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:31,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:28,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]2_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:38,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:25,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:27,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:35,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:22,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:32,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:19,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:15,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:33,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:12,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:09,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:20,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:06,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:17,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:57<03:07,  3.08s/it]1_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:14,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:00<03:03,  3.06s/it]1_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:05,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:03<02:59,  3.05s/it]1_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]3_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:06<02:56,  3.04s/it]1_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]3_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:09<02:52,  3.03s/it]1_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]0_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:12<02:49,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  3.00s/it]3_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]0_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:15<02:46,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  3.00s/it]3_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]0_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:18<02:43,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:04,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.00s/it]0_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:21<02:39,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.01s/it]2_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:24<02:36,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:46,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:28<02:33,  3.02s/it]1_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:31<02:30,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]2_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:34<02:27,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]2_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:37<02:24,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:40<02:21,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:22,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:43<02:18,  3.02s/it]3_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:46<02:15,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:49<02:12,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.98s/it]2_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:52<02:09,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.97s/it]2_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:55<02:06,  3.01s/it]2_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:05,  3.07s/it]2_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:19,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:02,  3.05s/it]2_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.04s/it]3_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:58,  3.04s/it]2_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]3_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:10,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:51,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.05s/it]1_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.00s/it]3_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:49<02:07,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:48,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.02s/it]3_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:04,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:45,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.03s/it]0_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  3.00s/it]1_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.02s/it]0_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]0_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  3.00s/it]0_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:31<01:30,  3.01s/it]2_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:34<01:27,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:44,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:37<01:24,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:41,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:40<01:21,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:38,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:43<01:18,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:35,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:46<01:15,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:32,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:49<01:12,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:29,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:52<01:09,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:26,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:55<01:06,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:23,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:58<01:04,  3.08s/it]2_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:01<01:01,  3.06s/it]2_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.03s/it]0_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:04<00:57,  3.04s/it]2_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.01s/it]3_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:14,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:07<00:54,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.00s/it]3_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:10<00:51,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.05s/it]3_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.00s/it]0_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:13<00:48,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.02s/it]3_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:16<00:45,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.00s/it]1_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:03,  3.04s/it]0_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:19<00:42,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:53,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.03s/it]0_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:23<00:39,  3.03s/it]2_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:57,  3.01s/it]0_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:26<00:36,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:54,  3.00s/it]0_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:29<00:33,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.99s/it]0_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:32<00:30,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:35<00:27,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  2.99s/it]1_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:38<00:24,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:41<00:21,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:44<00:18,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.99s/it]3_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:47<00:15,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:50<00:12,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.98s/it]0_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:53<00:09,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:56<00:06,  3.07s/it]2_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.98s/it]3_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.97s/it]0_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:59<00:03,  3.05s/it]2_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.97s/it]3_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.97s/it]1_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:06,  3.04s/it]0_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.04s/it]0_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.02s/it]
2_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.96s/it]3_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.01s/it]2_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.96s/it]3_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.98s/it]1_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.01s/it]1_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
2_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.03s/it]3_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.99s/it]2_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.02s/it]3_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  3.00s/it]2_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.02s/it]2_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
3_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.06s/it]3_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.04s/it]3_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.02s/it]3_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
tensor(8.3670e-07, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0211, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0208, device='cuda:0', grad_fn=<MinBackward1>)
tensor(0.9988, device='cuda:0', grad_fn=<MeanBackward0>) tensor(1.0134, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9789, device='cuda:0', grad_fn=<MinBackward1>)
0_o proxy err 0.00549020990729332 err 17.147119522094727 tr(WHW.T) 3123.217529296875
bpp_loss 3.152177572250366
0_up proxy err 0.007260303944349289 err 64.79422760009766 tr(WHW.T) 8924.451171875
bpp_loss 3.6066859449659074
0_gate proxy err 0.0042414856143295765 err 66.92498779296875 tr(WHW.T) 15778.666015625
bpp_loss 3.7081523963383267
0_down proxy err 0.00590786337852478 err 63.912479400634766 tr(WHW.T) 10818.205078125
bpp_loss 3.5998972484043668
-4.985485020370106e-07 0.01484617404639721 -0.01611725054681301
0.9995229244232178 1.0107938051223755 0.9837797284126282
1_o proxy err 0.00875601451843977 err 17.37046241760254 tr(WHW.T) 1983.8321533203125
bpp_loss 3.282852292060852
1_up proxy err 0.007898249663412571 err 65.00907135009766 tr(WHW.T) 8230.8203125
bpp_loss 3.6220274652753557
1_gate proxy err 0.004808362573385239 err 67.08802795410156 tr(WHW.T) 13952.365234375
bpp_loss 3.7258975165230885
1_down proxy err 0.003645973978564143 err 50.963539123535156 tr(WHW.T) 13978.03125
bpp_loss 3.617948532104492
I0408 11:11:35.590201 589684 quantize_finetune_llama.py:251] computed original embedding for layer 4 in 1.0611672401428223s
I0408 11:11:39.557425 594724 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:11:39.557536 594724 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:11:39.557577 594724 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:11:39.948938 594724 config.py:54] PyTorch version 2.6.0 available.
W0408 11:11:40.159712 594724 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 11:11:40.778163 594724 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:11:40.782842 589684 quantize_finetune_llama.py:220] layer 5 gpu 1
I0408 11:11:40.798512 594724 data_utils.py:336] using 256 training seqs, 128 validation seqs
6.417253644031007e-07 0.012569786049425602 -0.013713816180825233
0.9996570944786072 1.011357307434082 0.9863054156303406
2_o proxy err 0.008807940408587456 err 17.328060150146484 tr(WHW.T) 1967.3226318359375
bpp_loss 3.2093783617019653
2_up proxy err 0.008531047962605953 err 64.84001159667969 tr(WHW.T) 7600.474609375
bpp_loss 3.6178698199135915
2_gate proxy err 0.004477299749851227 err 67.6668472290039 tr(WHW.T) 15113.31640625
bpp_loss 3.7600429398672923
2_down proxy err 0.008391709066927433 err 64.8404312133789 tr(WHW.T) 7726.72509765625
bpp_loss 3.6206304005214145
v
4_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]4_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.73it/s]4_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.55it/s]4_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.99it/s]4_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.26it/s]4_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.43it/s]4_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.54it/s]I0408 11:11:43.458909 589684 quantize_finetune_llama.py:251] computed original embedding for layer 5 in 0.9334936141967773s
4_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.49it/s]4_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.55it/s]4_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.60it/s]4_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:24,  3.65it/s]4_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.66it/s]4_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.67it/s]4_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:23,  3.70it/s]4_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.71it/s]4_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.72it/s]4_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.72it/s]4_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.71it/s]4_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.73it/s]4_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.73it/s]4_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:21,  3.74it/s]4_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:21,  3.75it/s]I0408 11:11:47.426959 594879 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:11:47.427060 594879 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:11:47.427101 594879 utils.py:162] NumExpr defaulting to 16 threads.
4_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.76it/s]4_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.77it/s]I0408 11:11:47.778445 594879 config.py:54] PyTorch version 2.6.0 available.
W0408 11:11:47.969390 594879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

1.0346846011088928e-06 0.009944992139935493 -0.010676699690520763
0.9997494220733643 1.0106762647628784 0.9893225431442261
3_o proxy err 0.009565679356455803 err 17.76497459411621 tr(WHW.T) 1857.15771484375
bpp_loss 3.369921088218689
3_up proxy err 0.008567577227950096 err 64.56924438476562 tr(WHW.T) 7536.46484375
bpp_loss 3.598167794091361
3_gate proxy err 0.0033106436021625996 err 69.14063262939453 tr(WHW.T) 20884.34765625
bpp_loss 3.831740583692278
3_down proxy err 0.00920895766466856 err 64.44990539550781 tr(WHW.T) 6998.6103515625
bpp_loss 3.595522335597447
4_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.80it/s]4_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.80it/s]W0408 11:11:48.511235 594879 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:11:48.514817 589684 quantize_finetune_llama.py:220] layer 6 gpu 2
I0408 11:11:48.527768 594879 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.79it/s]4_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.78it/s]4_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:19,  3.77it/s]v
5_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]4_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:18,  3.78it/s]4_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.79it/s]5_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.77it/s]4_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.79it/s]5_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.61it/s]I0408 11:11:49.971682 589684 quantize_finetune_llama.py:251] computed original embedding for layer 6 in 0.8105738162994385s
4_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.78it/s]5_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.05it/s]4_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:17,  3.76it/s]5_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.33it/s]4_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.74it/s]5_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.52it/s]4_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.76it/s]5_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.64it/s]5_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.74it/s]4_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:17,  3.75it/s]5_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.81it/s]4_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.77it/s]5_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.83it/s]4_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.78it/s]5_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.86it/s]4_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.78it/s]5_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:22,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.78it/s]5_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.90it/s]4_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.79it/s]5_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.91it/s]4_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.79it/s]5_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:21,  3.92it/s]4_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:15,  3.79it/s]5_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.92it/s]4_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:14,  3.79it/s]5_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.93it/s]I0408 11:11:53.559764 595027 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:11:53.559876 595027 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:11:53.559915 595027 utils.py:162] NumExpr defaulting to 16 threads.
4_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.79it/s]5_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.90it/s]4_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.79it/s]I0408 11:11:53.883634 595027 config.py:54] PyTorch version 2.6.0 available.
5_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.93it/s]W0408 11:11:54.071629 595027 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

4_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.80it/s]5_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.91it/s]4_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:13,  3.80it/s]5_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.93it/s]4_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.80it/s]W0408 11:11:54.653512 595027 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:11:54.657250 589684 quantize_finetune_llama.py:220] layer 7 gpu 3
I0408 11:11:54.673471 595027 data_utils.py:336] using 256 training seqs, 128 validation seqs
5_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.94it/s]4_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.80it/s]5_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.91it/s]4_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:13,  3.75it/s]v
6_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]5_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.91it/s]4_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.77it/s]5_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.91it/s]4_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.79it/s]6_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:51,  1.90it/s]5_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.91it/s]I0408 11:11:55.917077 589684 quantize_finetune_llama.py:251] computed original embedding for layer 7 in 0.828620433807373s
4_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.73it/s]6_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:35,  2.72it/s]5_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:19,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:12,  3.74it/s]6_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.12it/s]5_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.87it/s]4_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.75it/s]6_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.38it/s]5_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.87it/s]4_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.57it/s]5_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.74it/s]6_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.67it/s]5_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.76it/s]4_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.73it/s]5_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.80it/s]4_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.75it/s]5_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.92it/s]6_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.82it/s]4_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.77it/s]5_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.93it/s]6_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.86it/s]5_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:08<00:16,  3.93it/s]4_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:10,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.86it/s]5_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.92it/s]4_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:09,  3.77it/s]6_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.89it/s]5_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.92it/s]4_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.78it/s]6_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.88it/s]5_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.93it/s]4_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.88it/s]5_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.90it/s]4_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:09,  3.74it/s]6_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.89it/s]5_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.90it/s]I0408 11:11:59.519987 595178 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:11:59.520088 595178 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:11:59.520127 595178 utils.py:162] NumExpr defaulting to 16 threads.
4_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.15it/s]6_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.91it/s]5_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.92it/s]I0408 11:11:59.845307 595178 config.py:54] PyTorch version 2.6.0 available.
6_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.32it/s]5_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.92it/s]W0408 11:12:00.035704 595178 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

6_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.87it/s]5_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.93it/s]4_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.44it/s]6_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.86it/s]5_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.91it/s]4_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.52it/s]W0408 11:12:00.610822 595178 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:12:00.614613 589684 quantize_finetune_llama.py:220] layer 8 gpu 0
I0408 11:12:00.627922 595178 data_utils.py:336] using 256 training seqs, 128 validation seqs
5_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.86it/s]4_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.87it/s]5_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.62it/s]v
7_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]5_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.89it/s]6_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.86it/s]4_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.66it/s]6_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.88it/s]5_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.88it/s]4_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:07,  3.66it/s]7_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.79it/s]5_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.88it/s]6_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.86it/s]4_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.70it/s]7_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.65it/s]5_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.87it/s]4_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.73it/s]7_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.12it/s]5_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:19,  3.87it/s]4_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.73it/s]7_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.42it/s]5_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.89it/s]6_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.87it/s]4_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.75it/s]7_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.61it/s]5_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.75it/s]7_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.72it/s]5_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.76it/s]7_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.81it/s]5_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.92it/s]6_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:18,  3.88it/s]4_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:22<00:05,  3.76it/s]7_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:23,  3.84it/s]5_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.84it/s]4_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.75it/s]7_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.89it/s]5_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.87it/s]4_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.77it/s]7_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:22,  3.92it/s]5_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.89it/s]4_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.76it/s]7_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:22,  3.92it/s]5_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.92it/s]6_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:16,  3.88it/s]4_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:23<00:03,  3.78it/s]7_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.94it/s]5_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.88it/s]4_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.77it/s]7_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.94it/s]5_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.89it/s]6_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.87it/s]7_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:21,  3.95it/s]4_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.77it/s]5_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:09,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.87it/s]7_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.96it/s]4_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.77it/s]5_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.94it/s]4_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.78it/s]5_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.92it/s]6_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.93it/s]4_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.76it/s]5_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.89it/s]7_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.95it/s]4_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.77it/s]5_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:08,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.93it/s]4_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.75it/s]5_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.91it/s]6_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.89it/s]7_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.95it/s]4_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.92it/s]5_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.25it/s]4_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.75it/s]6_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.86it/s]7_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.95it/s]5_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.41it/s]4_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.87it/s]7_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.95it/s]5_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.54it/s]4_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:26<00:01,  3.75it/s]6_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.85it/s]7_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.96it/s]5_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.65it/s]4_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.74it/s]6_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.87it/s]7_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:18,  3.96it/s]5_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.73it/s]4_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:18,  3.96it/s]5_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.79it/s]4_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.89it/s]7_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.97it/s]5_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.82it/s]4_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:27<00:00,  3.77it/s]6_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.90it/s]4_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:27<00:00,  3.69it/s]
7_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.94it/s]5_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:17,  3.95it/s]5_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.86it/s]7_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.96it/s]5_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:19<00:06,  3.83it/s]6_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.85it/s]7_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.94it/s]5_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.86it/s]6_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.86it/s]7_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.93it/s]5_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.87it/s]6_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.86it/s]7_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.92it/s]5_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.84it/s]6_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.84it/s]7_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:08<00:16,  3.91it/s]5_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:20<00:05,  3.87it/s]6_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.84it/s]7_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.90it/s]5_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.86it/s]6_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.82it/s]7_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.88it/s]5_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.88it/s]6_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.84it/s]7_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.91it/s]5_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.88it/s]6_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.83it/s]7_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:09<00:15,  3.88it/s]5_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:21<00:04,  3.87it/s]6_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.83it/s]7_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.87it/s]5_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.83it/s]7_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.86it/s]5_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.86it/s]5_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:10<00:15,  3.86it/s]5_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.86it/s]6_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.80it/s]7_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.87it/s]5_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.87it/s]6_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.80it/s]7_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.87it/s]5_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.86it/s]7_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.89it/s]5_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.18it/s]9.61013711275882e-07 0.006953842472285032 -0.00655346317216754
0.9999051690101624 1.0069284439086914 0.9939242005348206
4_v proxy err 0.015039452351629734 err 4.290863037109375 tr(WHW.T) 285.30712890625
bpp_loss 3.3594014644622803
4_q proxy err 0.000455692206742242 err 22.836950302124023 tr(WHW.T) 50114.859375
bpp_loss 4.246515989303589
4_k proxy err 0.00023073672491591424 err 6.761041641235352 tr(WHW.T) 29301.974609375
bpp_loss 5.1801557540893555
o
4_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]7_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.90it/s]5_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.84it/s]6_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.33it/s]7_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.87it/s]5_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.46it/s]7_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.90it/s]5_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.86it/s]6_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.91it/s]5_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.88it/s]6_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.63it/s]7_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.91it/s]5_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.68it/s]7_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.90it/s]5_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.72it/s]7_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.91it/s]5_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.87it/s]6_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.75it/s]7_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:11,  3.92it/s]5_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:25<00:00,  3.88it/s]6_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.78it/s]7_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.92it/s]5_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.89it/s]5_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]
6_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.80it/s]7_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.93it/s]6_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.80it/s]7_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.93it/s]7_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:10,  3.93it/s]6_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.80it/s]4_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:00,  3.03s/it]7_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.94it/s]6_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.79it/s]7_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.93it/s]6_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.78it/s]7_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.93it/s]6_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:09,  3.93it/s]6_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.94it/s]6_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.80it/s]7_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.93it/s]6_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.82it/s]7_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.94it/s]6_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.82it/s]7_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:08,  3.94it/s]6_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.90it/s]6_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.79it/s]6_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.78it/s]7_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.22it/s]6_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.78it/s]7_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.41it/s]6_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.78it/s]4_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:56,  3.02s/it]7_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.54it/s]6_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.77it/s]7_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.63it/s]6_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.75it/s]7_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.71it/s]6_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.76it/s]1.3685252042705542e-06 0.006666840519756079 -0.006146624218672514
0.9998995661735535 1.0066008567810059 0.9937162399291992
5_v proxy err 0.02011677622795105 err 4.200782775878906 tr(WHW.T) 208.81988525390625
bpp_loss 3.2287867069244385
5_q proxy err 0.0006219731876626611 err 22.385826110839844 tr(WHW.T) 35991.625
bpp_loss 4.229933261871338
5_k proxy err 0.00028542184736579657 err 6.564061641693115 tr(WHW.T) 22997.75390625
bpp_loss 5.1647467613220215
o
5_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]7_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.76it/s]6_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.80it/s]7_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.80it/s]6_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.82it/s]6_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.82it/s]6_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.83it/s]7_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:19<00:06,  3.85it/s]6_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.84it/s]7_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.86it/s]6_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.81it/s]7_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.86it/s]6_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]6_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.78it/s]
7_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.87it/s]7_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:20<00:05,  3.88it/s]4_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:52,  3.02s/it]7_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.87it/s]7_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.89it/s]7_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.90it/s]5_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:56,  2.99s/it]7_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:21<00:04,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.87it/s]7_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.86it/s]7_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.86it/s]7_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:22<00:03,  3.88it/s]7_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.85it/s]7_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.83it/s]7_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.82it/s]7_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.82it/s]4_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:49,  3.01s/it]7_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.83it/s]7_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.83it/s]5_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.98s/it]7_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.83it/s]7_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.81it/s]6.738315505572245e-07 0.006349319126456976 -0.006569070275872946
0.9999305009841919 1.0065146684646606 0.993858814239502
6_v proxy err 0.016990425065159798 err 4.309345722198486 tr(WHW.T) 253.63377380371094
bpp_loss 3.2841222286224365
6_q proxy err 0.0006306796567514539 err 22.477161407470703 tr(WHW.T) 35639.5859375
bpp_loss 4.279874086380005
6_k proxy err 0.0002598010760266334 err 6.797345161437988 tr(WHW.T) 26163.654296875
bpp_loss 5.227919101715088
o
6_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]7_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.78it/s]7_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.79it/s]7_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:25<00:00,  3.79it/s]7_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.82it/s]7_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]
4_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:46,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:57,  3.00s/it]4_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:43,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]5.957605253570364e-07 0.006037401966750622 -0.00646545272320509
0.99994957447052 1.0064455270767212 0.9936211705207825
7_v proxy err 0.013723250478506088 err 4.246345520019531 tr(WHW.T) 309.4270935058594
bpp_loss 3.279327392578125
7_q proxy err 0.0006259562214836478 err 21.999202728271484 tr(WHW.T) 35144.953125
bpp_loss 4.204926490783691
7_k proxy err 0.0002490907208994031 err 6.68820858001709 tr(WHW.T) 26850.4921875
bpp_loss 5.259917259216309
o
7_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]6_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:40,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:00,  3.03s/it]6_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:37,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:53,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:33,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:30,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:27,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:36<04:24,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:39<04:21,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:42<04:18,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:45<04:15,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:25,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:48<04:12,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:51<04:10,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:23,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:54<04:06,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:03,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:05,  3.07s/it]7_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:01,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:00,  3.05s/it]7_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:57,  3.04s/it]5_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:03,  3.04s/it]6_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:53,  3.03s/it]5_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]6_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:01,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:49,  3.03s/it]5_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:03,  3.04s/it]7_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:46,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  3.00s/it]6_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:59,  3.03s/it]5_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:43,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]6_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:57,  3.01s/it]4_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:39,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  3.00s/it]5_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.00s/it]4_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:36,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]5_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:33,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]5_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:30,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  2.99s/it]5_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:27,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:38,  2.99s/it]5_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:24,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:21,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:21,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:35,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:18,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:15,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:12,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:21,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:12,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:24,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:09,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:06,  3.02s/it]6_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:57<03:07,  3.08s/it]5_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:00<03:03,  3.06s/it]7_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]6_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:08,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:03<02:59,  3.04s/it]7_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]6_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:05,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:06<02:56,  3.04s/it]7_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]4_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:09<02:52,  3.03s/it]6_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]7_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  3.00s/it]4_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:12<02:49,  3.02s/it]6_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  3.00s/it]7_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:04,  3.03s/it]4_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:15<02:46,  3.02s/it]6_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.00s/it]4_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:18<02:42,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.00s/it]6_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:21<02:39,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  3.00s/it]6_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:46,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:24<02:36,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:27<02:33,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:30<02:30,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:34<02:27,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:37<02:24,  3.02s/it]5_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:40<02:21,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:43<02:18,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:46<02:15,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:49<02:12,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:52<02:09,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:22,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:55<02:06,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:19,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:06,  3.08s/it]7_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:16,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:02,  3.06s/it]7_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.04s/it]6_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:58,  3.05s/it]7_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:46<02:10,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.02s/it]6_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.04s/it]7_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:49<02:08,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.00s/it]6_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.05s/it]4_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:52,  3.03s/it]7_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:05,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  3.00s/it]6_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]4_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:48,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.03s/it]5_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  3.00s/it]6_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.02s/it]4_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:45,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.01s/it]4_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:56,  3.00s/it]5_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:51,  3.01s/it]4_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  2.99s/it]5_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:48,  3.01s/it]4_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:07<01:50,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:45,  3.01s/it]4_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:10<01:47,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:34,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:42,  3.00s/it]4_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:31<01:30,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:44,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:31,  2.96s/it]6_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  3.00s/it]4_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:34<01:27,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:41,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:28,  2.96s/it]6_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:37<01:24,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:38,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:26,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:40<01:21,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:35,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:23,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:43<01:18,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:32,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:46<01:15,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:29,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:49<01:12,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:26,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:14,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:52<01:09,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:23,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:55<01:06,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:58<01:04,  3.07s/it]7_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:01<01:01,  3.06s/it]7_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:13,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:03,  3.05s/it]6_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:04<00:57,  3.04s/it]7_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:10,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.03s/it]6_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:07<00:54,  3.04s/it]7_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:57,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.04s/it]4_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:10<00:51,  3.03s/it]7_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  3.00s/it]6_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.03s/it]4_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:13<00:48,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:03,  3.03s/it]5_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.02s/it]4_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:16<00:45,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.01s/it]4_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:19<00:42,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:56,  3.00s/it]5_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:51,  3.00s/it]4_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:22<00:39,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  2.99s/it]5_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:25<00:36,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.98s/it]5_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  2.99s/it]4_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:28<00:33,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:31<00:30,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.99s/it]6_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:34<00:27,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:37<00:24,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:41<00:21,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:44<00:18,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:26,  2.98s/it]4_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:47<00:15,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.97s/it]5_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:35<00:23,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.96s/it]4_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:50<00:12,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:38<00:20,  2.99s/it]7_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:53<00:09,  3.01s/it]5_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.98s/it]6_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:41<00:17,  2.98s/it]7_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.97s/it]4_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:56<00:06,  3.06s/it]5_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.97s/it]6_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:44<00:14,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.96s/it]4_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:59<00:03,  3.05s/it]5_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.03s/it]6_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:47<00:11,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.96s/it]4_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.04s/it]4_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.02s/it]
5_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:50<00:08,  2.97s/it]7_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.96s/it]5_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.00s/it]5_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
6_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:06,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:48<00:08,  2.96s/it]6_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.02s/it]7_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.03s/it]6_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.01s/it]6_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
7_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.01s/it]7_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.00s/it]7_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.98s/it]
1.8272635315952357e-06 0.012744167819619179 -0.011727549135684967
0.9996994733810425 1.0127557516098022 0.9880736470222473
4_o proxy err 0.013790413737297058 err 17.889589309692383 tr(WHW.T) 1297.2481689453125
bpp_loss 3.3776952028274536
4_up proxy err 0.008679541759192944 err 64.08528900146484 tr(WHW.T) 7383.48779296875
bpp_loss 3.571086508887155
4_gate proxy err 0.002426103688776493 err 70.67476654052734 tr(WHW.T) 29130.974609375
bpp_loss 3.9015627588544572
4_down proxy err 0.010018824599683285 err 64.07762145996094 tr(WHW.T) 6395.72265625
bpp_loss 3.5689394814627513
8.5196120380715e-07 0.012815555557608604 -0.013591703027486801
0.9996926188468933 1.0127933025360107 0.9863712191581726
5_o proxy err 0.01669885963201523 err 17.627092361450195 tr(WHW.T) 1055.5865478515625
bpp_loss 3.2922443151474
5_up proxy err 0.008384881541132927 err 64.19828796386719 tr(WHW.T) 7656.43310546875
bpp_loss 3.5776535783495222
5_gate proxy err 0.002333512296900153 err 70.90831756591797 tr(WHW.T) 30386.947265625
bpp_loss 3.904359442847116
5_down proxy err 0.009993154555559158 err 64.0674057006836 tr(WHW.T) 6411.12939453125
bpp_loss 3.5734197071620395
I0408 11:17:51.276947 589684 quantize_finetune_llama.py:251] computed original embedding for layer 8 in 1.190955638885498s
I0408 11:17:55.374780 599092 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:17:55.374892 599092 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:17:55.374936 599092 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:17:55.755013 599092 config.py:54] PyTorch version 2.6.0 available.
W0408 11:17:55.971044 599092 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

5.148996820025786e-07 0.01629462279379368 -0.013007585890591145
0.9997788667678833 1.01631498336792 0.9875326752662659
6_o proxy err 0.017711179330945015 err 17.873207092285156 tr(WHW.T) 1009.1483764648438
bpp_loss 3.344879984855652
6_up proxy err 0.00811244547367096 err 64.27925109863281 tr(WHW.T) 7923.53564453125
bpp_loss 3.5775199958256314
6_gate proxy err 0.00198932527564466 err 71.11518096923828 tr(WHW.T) 35748.39453125
bpp_loss 3.9081943375723704
6_down proxy err 0.009887350723147392 err 64.105224609375 tr(WHW.T) 6483.5595703125
bpp_loss 3.572333335876465
W0408 11:17:56.589390 599092 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:17:56.593548 589684 quantize_finetune_llama.py:220] layer 9 gpu 1
I0408 11:17:56.610622 599092 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
8_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]8_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.71it/s]8_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.54it/s]8_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.98it/s]I0408 11:17:58.412873 589684 quantize_finetune_llama.py:251] computed original embedding for layer 9 in 1.0159530639648438s
8_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.26it/s]8_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.43it/s]8_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.53it/s]8_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.60it/s]8_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.65it/s]8_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.70it/s]8_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:24,  3.74it/s]8.195919463105383e-07 0.011351356282830238 -0.01298434566706419
0.9997912645339966 1.0125433206558228 0.9879334568977356
7_o proxy err 0.018664516508579254 err 17.90329360961914 tr(WHW.T) 959.2155151367188
bpp_loss 3.3564958572387695
7_up proxy err 0.007480317261070013 err 64.53606414794922 tr(WHW.T) 8627.4501953125
bpp_loss 3.590876885822841
7_gate proxy err 0.0020240333396941423 err 70.64591979980469 tr(WHW.T) 34903.53515625
bpp_loss 3.8793918745858327
7_down proxy err 0.009830950759351254 err 64.24160766601562 tr(WHW.T) 6534.6279296875
bpp_loss 3.5851635251726424
8_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.76it/s]8_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.77it/s]8_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.79it/s]8_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:22,  3.82it/s]8_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.82it/s]8_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.82it/s]8_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.84it/s]I0408 11:18:02.042848 599260 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:18:02.042946 599260 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:18:02.042985 599260 utils.py:162] NumExpr defaulting to 16 threads.
8_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.84it/s]I0408 11:18:02.363860 599260 config.py:54] PyTorch version 2.6.0 available.
8_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.82it/s]W0408 11:18:02.551178 599260 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

8_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.84it/s]8_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.85it/s]W0408 11:18:03.105671 599260 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:18:03.109341 589684 quantize_finetune_llama.py:220] layer 10 gpu 2
I0408 11:18:03.122430 599260 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.85it/s]8_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.81it/s]v
9_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]8_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.82it/s]8_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.82it/s]9_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:59,  1.66it/s]8_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.83it/s]9_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.52it/s]8_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.81it/s]I0408 11:18:04.551349 589684 quantize_finetune_llama.py:251] computed original embedding for layer 10 in 0.98136305809021s
9_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.96it/s]8_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.80it/s]9_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.26it/s]8_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.80it/s]9_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.47it/s]8_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.79it/s]9_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.59it/s]8_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.80it/s]9_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.69it/s]8_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.79it/s]9_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.77it/s]8_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.80it/s]9_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.80it/s]8_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.81it/s]9_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.85it/s]8_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.82it/s]9_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.85it/s]8_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.77it/s]9_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.84it/s]8_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.78it/s]9_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.85it/s]8_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.79it/s]9_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.87it/s]8_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.77it/s]9_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.89it/s]8_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.78it/s]9_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.90it/s]I0408 11:18:08.170325 599391 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:18:08.170425 599391 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:18:08.170464 599391 utils.py:162] NumExpr defaulting to 16 threads.
8_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.78it/s]9_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.79it/s]I0408 11:18:08.495899 599391 config.py:54] PyTorch version 2.6.0 available.
9_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.94it/s]W0408 11:18:08.685927 599391 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

8_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:15,  3.79it/s]9_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.93it/s]8_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.79it/s]9_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.90it/s]W0408 11:18:09.226897 599391 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:18:09.230647 589684 quantize_finetune_llama.py:220] layer 11 gpu 3
I0408 11:18:09.244197 599391 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.78it/s]9_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.73it/s]9_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.90it/s]v
10_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]8_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:14,  3.74it/s]9_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.90it/s]9_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.76it/s]10_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:00,  1.65it/s]9_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.89it/s]8_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.78it/s]10_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.51it/s]9_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.89it/s]8_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.77it/s]I0408 11:18:10.621485 589684 quantize_finetune_llama.py:251] computed original embedding for layer 11 in 0.9279012680053711s
10_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.98it/s]9_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.86it/s]8_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:13,  3.76it/s]10_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.27it/s]9_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.85it/s]8_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.77it/s]10_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.84it/s]8_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.77it/s]10_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.60it/s]9_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.86it/s]8_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.77it/s]10_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.70it/s]9_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.84it/s]8_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:12,  3.75it/s]10_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.76it/s]9_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.86it/s]8_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.77it/s]10_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.81it/s]9_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.83it/s]8_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.73it/s]10_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.84it/s]9_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.85it/s]8_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.73it/s]10_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.85it/s]9_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.86it/s]8_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.75it/s]10_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.84it/s]8_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.76it/s]10_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.86it/s]8_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.77it/s]10_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.88it/s]9_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.81it/s]8_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:10,  3.77it/s]10_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.81it/s]8_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.77it/s]10_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.89it/s]I0408 11:18:14.199743 599525 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:18:14.199852 599525 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:18:14.199893 599525 utils.py:162] NumExpr defaulting to 16 threads.
9_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.83it/s]8_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.78it/s]10_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.89it/s]9_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.86it/s]I0408 11:18:14.525642 599525 config.py:54] PyTorch version 2.6.0 available.
8_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.78it/s]10_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.90it/s]W0408 11:18:14.715599 599525 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

9_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.88it/s]8_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.78it/s]10_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.90it/s]9_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.91it/s]9_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.90it/s]W0408 11:18:15.272102 599525 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:18:15.275929 589684 quantize_finetune_llama.py:220] layer 12 gpu 0
8_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.17it/s]I0408 11:18:15.291245 599525 data_utils.py:336] using 256 training seqs, 128 validation seqs
10_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.90it/s]9_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.90it/s]8_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.31it/s]10_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.88it/s]v
11_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]9_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.88it/s]8_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.89it/s]9_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.89it/s]8_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.53it/s]10_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.90it/s]9_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.88it/s]11_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.77it/s]8_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.60it/s]10_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.91it/s]9_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.63it/s]8_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.65it/s]10_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:18,  3.92it/s]9_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.86it/s]11_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.09it/s]8_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.68it/s]10_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.91it/s]9_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.39it/s]8_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:07,  3.71it/s]10_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.92it/s]11_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.56it/s]9_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.87it/s]8_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.70it/s]10_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.92it/s]11_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.69it/s]9_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.89it/s]8_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.73it/s]10_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:17,  3.93it/s]11_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.79it/s]9_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.90it/s]8_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.73it/s]10_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.83it/s]9_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.74it/s]10_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.88it/s]9_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.74it/s]10_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.90it/s]9_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:10,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.74it/s]10_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:16,  3.91it/s]11_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:22,  3.91it/s]9_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:05,  3.75it/s]11_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.93it/s]9_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.90it/s]8_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.75it/s]11_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.93it/s]9_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.91it/s]10_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.75it/s]11_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:21,  3.92it/s]9_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:09,  3.91it/s]10_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.75it/s]11_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.93it/s]9_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.92it/s]10_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.75it/s]11_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.95it/s]9_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.91it/s]10_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.92it/s]8_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.75it/s]11_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.94it/s]9_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.91it/s]10_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.92it/s]11_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.95it/s]8_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.72it/s]9_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:08,  3.92it/s]10_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.94it/s]8_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.74it/s]9_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.92it/s]10_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.95it/s]8_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.72it/s]9_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:09,  3.31it/s]10_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.91it/s]11_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:19,  3.95it/s]8_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.74it/s]9_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.48it/s]10_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.92it/s]11_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.96it/s]8_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.75it/s]9_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.58it/s]10_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.91it/s]11_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.95it/s]8_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.73it/s]9_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.69it/s]10_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.95it/s]8_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.75it/s]9_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.73it/s]10_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:18,  3.96it/s]8_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.72it/s]9_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.79it/s]10_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:18,  3.95it/s]8_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.73it/s]9_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.82it/s]10_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.94it/s]8_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.73it/s]9_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.95it/s]8_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.72it/s]9_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.87it/s]10_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.91it/s]11_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.94it/s]8_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.73it/s]9_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.94it/s]8_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.72it/s]9_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.94it/s]8_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.74it/s]8_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.70it/s]
9_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.90it/s]10_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.94it/s]9_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:16,  3.95it/s]9_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.88it/s]10_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:08<00:16,  3.92it/s]9_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.93it/s]10_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.84it/s]9_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.93it/s]10_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.85it/s]9_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.90it/s]10_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.85it/s]9_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:09<00:15,  3.92it/s]10_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.86it/s]11_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.92it/s]9_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.84it/s]10_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.86it/s]9_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.91it/s]10_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.86it/s]11_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:10<00:14,  3.88it/s]10_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.85it/s]9_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.83it/s]11_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.85it/s]9_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.83it/s]10_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.12it/s]11_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.85it/s]9_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.84it/s]10_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.31it/s]11_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.88it/s]9_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.86it/s]10_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.42it/s]11_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.83it/s]10_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.55it/s]11_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.89it/s]9_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.86it/s]10_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:08,  3.62it/s]11_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.68it/s]11_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.86it/s]9_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.85it/s]9.555304814057308e-07 0.006384699605405331 -0.006459552329033613
0.9999510049819946 1.0064460039138794 0.9939663410186768
8_v proxy err 0.01676420494914055 err 4.320223331451416 tr(WHW.T) 257.7052307128906
bpp_loss 3.308629035949707
8_q proxy err 0.0008174876566044986 err 21.745969772338867 tr(WHW.T) 26600.9765625
bpp_loss 4.193664312362671
8_k proxy err 0.0002874924975913018 err 6.476845741271973 tr(WHW.T) 22528.748046875
bpp_loss 5.1715288162231445
o
8_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]10_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.73it/s]11_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.77it/s]11_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.87it/s]9_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.80it/s]11_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.89it/s]9_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.83it/s]10_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.83it/s]11_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.91it/s]9_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]9_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.80it/s]
10_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.82it/s]11_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.90it/s]10_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.82it/s]11_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.88it/s]10_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.81it/s]11_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.84it/s]10_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.87it/s]10_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:10,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.84it/s]8_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:58,  3.01s/it]11_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.82it/s]11_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.88it/s]10_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.85it/s]10_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.82it/s]11_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:09,  3.84it/s]10_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.83it/s]10_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.82it/s]11_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.79it/s]10_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.80it/s]11_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.17it/s]10_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.34it/s]10_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.82it/s]11_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.49it/s]10_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.82it/s]11_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.58it/s]10_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.83it/s]11_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.64it/s]-6.558811946888454e-07 0.006692942231893539 -0.0066993348300457
0.9999567866325378 1.0066956281661987 0.9934697151184082
9_v proxy err 0.0124858058989048 err 4.387871742248535 tr(WHW.T) 351.4288024902344
bpp_loss 3.4242289066314697
9_q proxy err 0.000850945245474577 err 21.829496383666992 tr(WHW.T) 25653.232421875
bpp_loss 4.201360464096069
9_k proxy err 0.00031036132713779807 err 6.499785423278809 tr(WHW.T) 20942.638671875
bpp_loss 5.189379692077637
o
9_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]10_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.83it/s]11_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.70it/s]10_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.85it/s]8_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:54,  3.01s/it]11_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.78it/s]10_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.81it/s]10_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.86it/s]10_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:19<00:06,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.89it/s]10_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.86it/s]10_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.79it/s]
11_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.90it/s]11_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:20<00:05,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.85it/s]9_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:56,  2.99s/it]11_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.88it/s]11_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.90it/s]8_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:52,  3.01s/it]11_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.86it/s]11_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.89it/s]11_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.87it/s]11_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.84it/s]11_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.86it/s]11_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.83it/s]11_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.81it/s]9_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.98s/it]11_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.84it/s]4.681693894781347e-07 0.006761365570127964 -0.007036700379103422
0.9999480247497559 1.0070362091064453 0.9933454990386963
10_v proxy err 0.017146185040473938 err 4.318076133728027 tr(WHW.T) 251.83889770507812
bpp_loss 3.2967326641082764
10_q proxy err 0.0009356678347103298 err 21.836761474609375 tr(WHW.T) 23338.15625
bpp_loss 4.212794780731201
10_k proxy err 0.00032940658275038004 err 6.50378942489624 tr(WHW.T) 19743.95703125
bpp_loss 5.199295997619629
o
10_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]11_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.84it/s]8_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:49,  3.01s/it]11_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.86it/s]11_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.86it/s]11_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:25<00:00,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.85it/s]11_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.82it/s]
9_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:46,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]7.93654976405378e-07 0.006267154589295387 -0.006257284432649612
0.999941885471344 1.0062676668167114 0.9940070509910583
11_v proxy err 0.013501222245395184 err 4.314573764801025 tr(WHW.T) 319.5691223144531
bpp_loss 3.2977426052093506
11_q proxy err 0.0009664437966421247 err 21.446256637573242 tr(WHW.T) 22190.8984375
bpp_loss 4.146041631698608
11_k proxy err 0.00036573238321579993 err 6.593212604522705 tr(WHW.T) 18027.423828125
bpp_loss 5.195851802825928
o
11_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]10_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:43,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:00,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:40,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:53,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:37,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:34,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:31,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:28,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:34,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:36<04:25,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:25,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:39<04:22,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:42<04:19,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:25,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:45<04:16,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:23,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:48<04:13,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:51<04:10,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:54<04:07,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:04,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:06,  3.08s/it]9_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:01,  3.06s/it]11_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:57,  3.05s/it]11_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]8_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:53,  3.04s/it]11_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.04s/it]8_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:50,  3.03s/it]11_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]8_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:46,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  3.00s/it]11_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]8_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:43,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  3.00s/it]11_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:40,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:37,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:34,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:46,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:31,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:32,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:28,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:25,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:26,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:38,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:22,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:19,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:26,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:16,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:13,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:20,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:10,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:17,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:06,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:20,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:14,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:58<03:07,  3.08s/it]9_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:01<03:03,  3.06s/it]11_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:08,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:04<02:59,  3.05s/it]11_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:11,  2.99s/it]9_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:07<02:56,  3.04s/it]11_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]8_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:10<02:52,  3.03s/it]11_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]8_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:13<02:49,  3.03s/it]9_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  3.00s/it]11_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]8_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:16<02:46,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.01s/it]8_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:19<02:43,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:51,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:22<02:40,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:25<02:36,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:28<02:33,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:31<02:30,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:34<02:27,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:37<02:24,  3.02s/it]11_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:40<02:21,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:43<02:18,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:46<02:15,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:49<02:12,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:52<02:09,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:22,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:55<02:06,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:19,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:06,  3.08s/it]11_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:16,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:02,  3.06s/it]11_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:05,  3.05s/it]10_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:58,  3.04s/it]11_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.03s/it]11_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:05,  3.05s/it]8_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:51,  3.02s/it]11_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:04,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]8_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:48,  3.02s/it]11_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.03s/it]9_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:51,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]8_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:45,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  3.00s/it]9_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.99s/it]9_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:34,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:31<01:30,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:44,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:31,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:34<01:27,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:41,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.97s/it]10_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:38,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:37<01:24,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:35,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:40<01:21,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:32,  2.99s/it]8_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:43<01:18,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:29,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:46<01:15,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:26,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:49<01:12,  3.01s/it]9_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:23,  2.99s/it]9_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.97s/it]8_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:52<01:09,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.97s/it]8_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:55<01:06,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.97s/it]8_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:58<01:04,  3.07s/it]10_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:14,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.04s/it]8_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:01<01:01,  3.06s/it]10_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.03s/it]8_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:04<00:57,  3.04s/it]10_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.97s/it]11_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.02s/it]8_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:07<00:54,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.04s/it]11_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.01s/it]8_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:10<00:51,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.03s/it]11_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:03,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:51,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:14<00:48,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.02s/it]11_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.02s/it]9_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:48,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:17<00:45,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.00s/it]11_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:57,  3.00s/it]9_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:45,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:20<00:42,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  3.00s/it]9_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:42,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:23<00:39,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.99s/it]9_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:26<00:36,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.99s/it]9_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:29<00:33,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  2.98s/it]11_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:32<00:30,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:35<00:27,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:26,  3.00s/it]8_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:38<00:24,  3.02s/it]10_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  2.99s/it]11_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:35<00:23,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:41<00:21,  3.02s/it]11_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:38<00:20,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:26,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:44<00:18,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.96s/it]9_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:41<00:18,  3.00s/it]10_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:35<00:23,  2.97s/it]8_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:47<00:15,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:44<00:14,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:38<00:20,  2.97s/it]8_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:50<00:12,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:47<00:11,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:41<00:17,  2.97s/it]8_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:53<00:09,  3.01s/it]11_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:50<00:08,  2.98s/it]10_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:44<00:14,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:56<00:06,  3.06s/it]11_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:06,  3.03s/it]10_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:47<00:11,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:59<00:03,  3.05s/it]11_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.97s/it]9_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:50<00:08,  2.98s/it]8_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.03s/it]8_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.02s/it]
11_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.98s/it]9_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.00s/it]9_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
10_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:06,  3.04s/it]11_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.99s/it]10_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.02s/it]11_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.06s/it]10_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.01s/it]10_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
11_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.04s/it]11_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.03s/it]11_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
4.2714680148492334e-07 0.014356078580021858 -0.015423087403178215
0.9997929334640503 1.0154366493225098 0.9861505031585693
8_o proxy err 0.024132706224918365 err 17.993494033813477 tr(WHW.T) 745.6061401367188
bpp_loss 3.365277051925659
8_up proxy err 0.0075810132548213005 err 64.401123046875 tr(WHW.T) 8495.0546875
bpp_loss 3.586514336722238
8_gate proxy err 0.001897207461297512 err 70.64849090576172 tr(WHW.T) 37238.1484375
bpp_loss 3.8833649839673723
8_down proxy err 0.009889689274132252 err 64.1723861694336 tr(WHW.T) 6488.8173828125
bpp_loss 3.58147280556815
-2.3806842364137992e-06 0.014714927412569523 -0.01526965107768774
0.999789834022522 1.0152987241744995 0.986733615398407
9_o proxy err 0.02348414622247219 err 18.237829208374023 tr(WHW.T) 776.6017456054688
bpp_loss 3.441869854927063
9_up proxy err 0.007190039847046137 err 64.49929809570312 tr(WHW.T) 8970.6455078125
bpp_loss 3.595087630408151
9_gate proxy err 0.0018006039317697287 err 70.97209930419922 tr(WHW.T) 39415.71875
bpp_loss 3.896738052368164
9_down proxy err 0.010235566645860672 err 64.20672607421875 tr(WHW.T) 6272.90380859375
bpp_loss 3.5844293321881975
I0408 11:24:06.113068 589684 quantize_finetune_llama.py:251] computed original embedding for layer 12 in 1.0854666233062744s
-9.126624718192033e-07 0.013837634585797787 -0.014268822968006134
0.999760627746582 1.0142723321914673 0.987683892250061
10_o proxy err 0.026536336168646812 err 18.06233024597168 tr(WHW.T) 680.6640625
bpp_loss 3.352302312850952
10_up proxy err 0.007056971546262503 err 64.9181900024414 tr(WHW.T) 9199.1572265625
bpp_loss 3.6122402804238454
10_gate proxy err 0.001883380115032196 err 70.4372329711914 tr(WHW.T) 37399.37109375
bpp_loss 3.8660552161080495
10_down proxy err 0.00988424476236105 err 64.49700164794922 tr(WHW.T) 6525.2333984375
bpp_loss 3.5992355346679688
I0408 11:24:10.145711 603549 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:24:10.145823 603549 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:24:10.145871 603549 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:24:10.521700 603549 config.py:54] PyTorch version 2.6.0 available.
W0408 11:24:10.736964 603549 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 11:24:11.379069 603549 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:24:11.383132 589684 quantize_finetune_llama.py:220] layer 13 gpu 1
I0408 11:24:11.397652 603549 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
12_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]12_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.78it/s]12_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.58it/s]I0408 11:24:12.921681 589684 quantize_finetune_llama.py:251] computed original embedding for layer 13 in 1.068889856338501s
12_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.98it/s]12_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.25it/s]12_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.42it/s]12_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.59it/s]12_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.65it/s]12_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.67it/s]12_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:24,  3.70it/s]12_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.73it/s]2.001862412726041e-06 0.016474753618240356 -0.015667976811528206
0.9997648000717163 1.0164893865585327 0.9849269390106201
11_o proxy err 0.0322713740170002 err 18.2639102935791 tr(WHW.T) 565.9476928710938
bpp_loss 3.3680124282836914
11_up proxy err 0.007063227705657482 err 64.92939758300781 tr(WHW.T) 9192.595703125
bpp_loss 3.6186180795942033
11_gate proxy err 0.0019016986479982734 err 70.1424331665039 tr(WHW.T) 36884.09375
bpp_loss 3.8462506362370084
11_down proxy err 0.009721248410642147 err 64.70356750488281 tr(WHW.T) 6655.890625
bpp_loss 3.6065514428274974
12_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.76it/s]12_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:23,  3.76it/s]12_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:22,  3.78it/s]12_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.72it/s]12_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.73it/s]I0408 11:24:16.639235 603695 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:24:16.639332 603695 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:24:16.639372 603695 utils.py:162] NumExpr defaulting to 16 threads.
12_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.75it/s]I0408 11:24:16.961491 603695 config.py:54] PyTorch version 2.6.0 available.
12_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.76it/s]W0408 11:24:17.150331 603695 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

12_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.74it/s]12_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:21,  3.76it/s]W0408 11:24:17.734360 603695 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:24:17.738101 589684 quantize_finetune_llama.py:220] layer 14 gpu 2
I0408 11:24:17.758600 603695 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.76it/s]12_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.75it/s]v
13_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]12_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.78it/s]12_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:20,  3.79it/s]13_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:51,  1.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:35,  2.75it/s]12_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:30,  3.19it/s]I0408 11:24:19.333752 589684 quantize_finetune_llama.py:251] computed original embedding for layer 14 in 1.1249196529388428s
12_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.41it/s]12_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:19,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.56it/s]12_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:18,  3.74it/s]13_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.68it/s]12_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.76it/s]12_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.80it/s]12_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:18,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.82it/s]12_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:17,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.87it/s]12_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.87it/s]12_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:17,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.76it/s]13_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.87it/s]12_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:16,  3.74it/s]13_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.87it/s]I0408 11:24:22.949556 603836 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:24:22.949652 603836 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:24:22.949689 603836 utils.py:162] NumExpr defaulting to 16 threads.
13_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.76it/s]I0408 11:24:23.276540 603836 config.py:54] PyTorch version 2.6.0 available.
13_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.75it/s]W0408 11:24:23.466653 603836 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

13_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:15,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:14,  3.77it/s]W0408 11:24:24.069143 603836 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:24:24.072819 589684 quantize_finetune_llama.py:220] layer 15 gpu 3
I0408 11:24:24.085966 603836 data_utils.py:336] using 256 training seqs, 128 validation seqs
13_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.77it/s]13_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.75it/s]v
14_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]13_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:14,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:13,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.80it/s]13_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:19,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.64it/s]13_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.89it/s]I0408 11:24:25.484508 589684 quantize_finetune_llama.py:251] computed original embedding for layer 15 in 0.9613542556762695s
12_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.73it/s]14_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.05it/s]13_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.90it/s]12_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:13,  3.72it/s]14_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.32it/s]13_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.50it/s]13_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.59it/s]13_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.67it/s]13_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.86it/s]12_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:12,  3.73it/s]14_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.86it/s]12_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.87it/s]12_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.78it/s]13_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.87it/s]12_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.76it/s]14_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.80it/s]13_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.87it/s]12_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:10,  3.76it/s]14_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.76it/s]14_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.89it/s]12_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.90it/s]14_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.83it/s]12_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:10,  3.74it/s]13_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.82it/s]12_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:09,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.87it/s]14_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.84it/s]I0408 11:24:29.092821 603967 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:24:29.092920 603967 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:24:29.092957 603967 utils.py:162] NumExpr defaulting to 16 threads.
12_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.74it/s]13_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.86it/s]14_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.84it/s]I0408 11:24:29.420502 603967 config.py:54] PyTorch version 2.6.0 available.
12_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.74it/s]13_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.86it/s]14_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.83it/s]W0408 11:24:29.612223 603967 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

12_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:09,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.87it/s]14_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.85it/s]13_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.88it/s]14_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.84it/s]W0408 11:24:30.166404 603967 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:24:30.170374 589684 quantize_finetune_llama.py:220] layer 16 gpu 0
I0408 11:24:30.187136 603967 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.14it/s]13_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.29it/s]13_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.90it/s]14_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.80it/s]v
15_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]12_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.82it/s]12_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.51it/s]13_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.58it/s]13_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.66it/s]12_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.62it/s]13_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.11it/s]12_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.66it/s]13_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.90it/s]14_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.79it/s]15_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.38it/s]12_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:07,  3.69it/s]13_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.90it/s]14_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.54it/s]12_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.72it/s]13_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.91it/s]14_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.65it/s]12_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.72it/s]13_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.90it/s]14_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.70it/s]13_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.92it/s]12_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.73it/s]14_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:10,  3.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.85it/s]15_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.78it/s]13_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.92it/s]12_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.80it/s]13_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.82it/s]13_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.90it/s]12_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:22<00:05,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.80it/s]13_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:09,  3.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.85it/s]15_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.90it/s]12_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.83it/s]15_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.85it/s]13_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:23<00:04,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.85it/s]13_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:08,  3.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.75it/s]14_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.85it/s]13_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.91it/s]12_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.24it/s]15_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.82it/s]14_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.85it/s]12_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.72it/s]13_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.40it/s]15_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.83it/s]14_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.54it/s]15_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.64it/s]15_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.82it/s]14_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.82it/s]12_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:25<00:02,  3.75it/s]13_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.72it/s]15_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.79it/s]14_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.85it/s]13_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.77it/s]12_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.74it/s]15_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.82it/s]14_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.82it/s]12_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.73it/s]15_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.83it/s]14_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.83it/s]12_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.72it/s]15_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.83it/s]14_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.86it/s]12_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:26<00:01,  3.72it/s]15_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.81it/s]14_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:19<00:06,  3.88it/s]12_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.71it/s]15_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.82it/s]13_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.88it/s]14_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.83it/s]12_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.72it/s]15_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.84it/s]13_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.90it/s]14_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.73it/s]13_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.83it/s]12_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:27<00:00,  3.72it/s]12_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:27<00:00,  3.68it/s]
13_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:20<00:05,  3.89it/s]14_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.82it/s]13_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.88it/s]14_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.80it/s]15_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.83it/s]14_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.76it/s]15_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.84it/s]14_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.80it/s]15_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.86it/s]14_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.86it/s]14_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.83it/s]13_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.86it/s]14_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.83it/s]15_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.84it/s]13_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.84it/s]14_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.82it/s]14_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.78it/s]15_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.80it/s]13_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.86it/s]14_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.82it/s]13_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.84it/s]14_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.80it/s]15_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.84it/s]14_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.79it/s]15_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.81it/s]13_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.79it/s]14_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.11it/s]13_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.79it/s]15_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.78it/s]14_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.29it/s]13_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.80it/s]15_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.44it/s]13_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.79it/s]14_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.53it/s]13_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.61it/s]13_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.83it/s]1.442647771909833e-06 0.0068103414960205555 -0.006449653301388025
0.9999522566795349 1.006752610206604 0.9938077330589294
12_v proxy err 0.012235240079462528 err 4.449019432067871 tr(WHW.T) 363.6233825683594
bpp_loss 3.434685468673706
12_q proxy err 0.0006475064437836409 err 22.081668853759766 tr(WHW.T) 34102.625
bpp_loss 4.197685718536377
12_k proxy err 0.00028295646188780665 err 6.524138927459717 tr(WHW.T) 23057.041015625
bpp_loss 5.181294918060303
o
12_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]15_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.78it/s]14_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.67it/s]13_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.78it/s]14_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.67it/s]13_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:25<00:00,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:07,  3.71it/s]13_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.85it/s]13_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.82it/s]
15_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.79it/s]14_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.75it/s]15_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.82it/s]14_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.73it/s]15_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.77it/s]15_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.81it/s]14_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.79it/s]15_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.82it/s]14_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.83it/s]14_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:05,  3.80it/s]15_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.81it/s]14_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.83it/s]14_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.85it/s]12_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:02,  3.05s/it]15_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.83it/s]15_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:10,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.83it/s]15_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.78it/s]14_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.79it/s]14_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.83it/s]15_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.80it/s]14_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.78it/s]14_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.84it/s]14_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.85it/s]15_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.19it/s]14_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.86it/s]15_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.33it/s]2.9674147299374454e-06 0.0064529492519795895 -0.006529712583869696
0.999940037727356 1.0065137147903442 0.9939582347869873
13_v proxy err 0.015627987682819366 err 4.378236293792725 tr(WHW.T) 280.153564453125
bpp_loss 3.3649303913116455
13_q proxy err 0.0010272531071677804 err 21.466894149780273 tr(WHW.T) 20897.375
bpp_loss 4.180989980697632
13_k proxy err 0.00036255206214264035 err 6.453033447265625 tr(WHW.T) 17798.916015625
bpp_loss 5.20693826675415
o
13_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]14_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.46it/s]14_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.86it/s]15_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.87it/s]15_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:07,  3.64it/s]12_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:56,  3.03s/it]14_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.86it/s]15_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.67it/s]14_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.86it/s]15_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.74it/s]14_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.86it/s]15_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.77it/s]14_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.86it/s]15_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.79it/s]14_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.87it/s]15_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.81it/s]14_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.88it/s]14_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.76it/s]
15_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.84it/s]15_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.79it/s]13_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:56,  2.99s/it]15_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.83it/s]12_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:52,  3.02s/it]15_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.83it/s]15_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.81it/s]15_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.79it/s]15_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.78it/s]15_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.78it/s]15_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.76it/s]15_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.76it/s]13_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:51,  2.98s/it]15_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.76it/s]15_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.76it/s]15_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.78it/s]15_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.77it/s]6.622575483561377e-07 0.006562387570738792 -0.006454138085246086
0.9999338984489441 1.006554365158081 0.9943726658821106
14_v proxy err 0.015426745638251305 err 4.340134143829346 tr(WHW.T) 281.3382873535156
bpp_loss 3.35479474067688
14_q proxy err 0.0010343026369810104 err 21.59813690185547 tr(WHW.T) 20881.8359375
bpp_loss 4.153017520904541
14_k proxy err 0.0003490325470920652 err 6.498741149902344 tr(WHW.T) 18619.298828125
bpp_loss 5.1590681076049805
o
14_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]12_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:49,  3.02s/it]15_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.80it/s]15_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.82it/s]15_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.86it/s]15_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.87it/s]15_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.87it/s]15_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]15_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.75it/s]
13_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:57,  3.01s/it]12_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:46,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:53,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:43,  3.01s/it]1.0985977496602573e-06 0.006911813747137785 -0.006756762508302927
0.9999329447746277 1.006904125213623 0.9935057759284973
15_v proxy err 0.01546706072986126 err 4.393064975738525 tr(WHW.T) 284.0271301269531
bpp_loss 3.4203975200653076
15_q proxy err 0.0007833624258637428 err 21.996273040771484 tr(WHW.T) 28079.306640625
bpp_loss 4.286397933959961
15_k proxy err 0.0003503337502479553 err 6.611382007598877 tr(WHW.T) 18871.66796875
bpp_loss 5.18640661239624
o
15_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]13_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:40,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:37,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:51,  2.97s/it]13_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:48,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:34,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:34,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:31,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:28,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:34,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:36<04:25,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:39<04:22,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:42<04:19,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:25,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:45<04:15,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:48<04:13,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:51<04:09,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:54<04:06,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:03,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:05,  3.07s/it]13_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:01,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:00,  3.05s/it]13_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]14_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:56,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:53,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]12_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:49,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:57,  3.01s/it]12_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:46,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:48,  3.00s/it]14_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:01,  3.02s/it]12_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:43,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:57,  3.01s/it]12_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:40,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:53,  3.00s/it]14_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:48,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:37,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:38,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:34,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:35,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:31,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:27,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:24,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:21,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:35,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:19,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:20,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:32,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:15,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:17,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:29,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:12,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:14,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:09,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:11,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:06,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:08,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:57<03:07,  3.07s/it]13_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:05,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:00<03:03,  3.06s/it]13_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]14_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:03<02:59,  3.04s/it]13_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:11,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:06<02:55,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:08,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]12_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:09<02:52,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:05,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.03s/it]12_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:12<02:49,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  3.00s/it]14_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]12_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:15<02:45,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]12_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:18<02:42,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:56,  3.00s/it]14_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:21<02:39,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:24<02:36,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:27<02:33,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]14_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:42,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:31<02:30,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:34<02:27,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:37<02:24,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:40<02:21,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:43<02:18,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:46<02:15,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:49<02:12,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:52<02:09,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:22,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:55<02:06,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:19,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:05,  3.07s/it]13_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:16,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:10,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:02,  3.05s/it]13_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:05,  3.05s/it]15_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:43<02:13,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:07,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:58,  3.04s/it]13_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]15_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:46<02:10,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:49<02:07,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.04s/it]12_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:52,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:04,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.02s/it]12_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:48,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:03,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]12_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:45,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:58<01:59,  3.00s/it]14_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:01<01:56,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:04<01:53,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:48,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:07<01:50,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:45,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:10<01:47,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:31<01:30,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:31,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:44,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:34<01:27,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:41,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:37<01:24,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:38,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:40<01:21,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:34,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:43<01:18,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:31,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:46<01:15,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:28,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.97s/it]13_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:49<01:12,  3.02s/it]15_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:25,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:52<01:09,  3.02s/it]15_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:22,  2.96s/it]14_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:55<01:06,  3.01s/it]15_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.97s/it]13_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:58<01:04,  3.07s/it]14_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:14,  2.96s/it]13_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.04s/it]12_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:01<01:01,  3.05s/it]14_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.96s/it]13_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.02s/it]12_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:04<00:57,  3.04s/it]14_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.00s/it]15_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:07<00:54,  3.03s/it]14_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:53,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:10<00:51,  3.03s/it]14_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.02s/it]13_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:03,  3.04s/it]12_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:13<00:48,  3.03s/it]14_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.01s/it]13_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.02s/it]12_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:16<00:45,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:53,  2.99s/it]13_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:57,  3.01s/it]12_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:19<00:42,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  2.99s/it]13_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  2.99s/it]12_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:22<00:39,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  3.00s/it]13_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  2.96s/it]15_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:25<00:36,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  2.99s/it]13_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.96s/it]15_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:28<00:33,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:31<00:30,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  2.97s/it]13_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:34<00:27,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.97s/it]15_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.98s/it]12_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:37<00:24,  3.02s/it]14_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.98s/it]15_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:40<00:21,  3.01s/it]14_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  2.99s/it]13_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.97s/it]12_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:44<00:18,  3.01s/it]14_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:26,  2.99s/it]13_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.96s/it]12_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:47<00:15,  3.01s/it]14_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:35<00:23,  2.99s/it]13_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.96s/it]12_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:50<00:12,  3.01s/it]14_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:38<00:20,  2.99s/it]13_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.96s/it]12_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:53<00:09,  3.01s/it]14_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:41<00:17,  3.00s/it]13_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.99s/it]15_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.97s/it]14_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:44<00:14,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:56<00:06,  3.07s/it]15_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:06,  3.06s/it]14_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:47<00:11,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:59<00:03,  3.06s/it]15_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.98s/it]13_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.04s/it]14_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:50<00:08,  3.00s/it]12_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.05s/it]12_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.02s/it]
15_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.97s/it]13_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.03s/it]13_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
14_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:06,  3.06s/it]15_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.98s/it]14_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.04s/it]15_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.06s/it]14_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.04s/it]14_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
15_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.04s/it]15_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.03s/it]15_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.98s/it]
1.4280590221460443e-06 0.012447291053831577 -0.012933646328747272
0.9998035430908203 1.012933373451233 0.9886444807052612
12_o proxy err 0.023459674790501595 err 18.293180465698242 tr(WHW.T) 779.7713012695312
bpp_loss 3.4516254663467407
12_up proxy err 0.006503316108137369 err 65.20976257324219 tr(WHW.T) 10027.1552734375
bpp_loss 3.638040781021118
12_gate proxy err 0.0018707729177549481 err 69.8436279296875 tr(WHW.T) 37334.1015625
bpp_loss 3.8258458205631802
12_down proxy err 0.009490089491009712 err 64.7481460571289 tr(WHW.T) 6822.7119140625
bpp_loss 3.6227006912231445
1.312184622292989e-06 0.013802063651382923 -0.014481067657470703
0.9998131990432739 1.0144877433776855 0.9865515232086182
13_o proxy err 0.02723751589655876 err 18.39095687866211 tr(WHW.T) 675.2068481445312
bpp_loss 3.416696310043335
13_up proxy err 0.006525702774524689 err 65.32416534423828 tr(WHW.T) 10010.2880859375
bpp_loss 3.6415088857923235
13_gate proxy err 0.0018009464256465435 err 70.09510803222656 tr(WHW.T) 38921.26171875
bpp_loss 3.830236094338553
13_down proxy err 0.0099127646535635 err 65.03275299072266 tr(WHW.T) 6560.505859375
bpp_loss 3.6233628136771068
I0408 11:30:20.830186 589684 quantize_finetune_llama.py:251] computed original embedding for layer 16 in 1.1808457374572754s
I0408 11:30:24.985911 607894 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:30:24.986019 607894 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:30:24.986061 607894 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:30:25.380837 607894 config.py:54] PyTorch version 2.6.0 available.
W0408 11:30:25.598888 607894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

1.7593087875411584e-07 0.016091885045170784 -0.01698017492890358
0.9997481107711792 1.0169978141784668 0.9844109416007996
14_o proxy err 0.02652888558804989 err 18.20671272277832 tr(WHW.T) 686.2976684570312
bpp_loss 3.408401608467102
14_up proxy err 0.007114281412214041 err 65.19731903076172 tr(WHW.T) 9164.287109375
bpp_loss 3.637215648378645
14_gate proxy err 0.0016857108566910028 err 70.43881225585938 tr(WHW.T) 41785.8203125
bpp_loss 3.8602141993386403
14_down proxy err 0.010157419368624687 err 64.91521453857422 tr(WHW.T) 6390.916015625
bpp_loss 3.621612548828125
W0408 11:30:26.241235 607894 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:30:26.245312 589684 quantize_finetune_llama.py:220] layer 17 gpu 1
I0408 11:30:26.260319 607894 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
16_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]16_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.75it/s]16_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.56it/s]16_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.00it/s]I0408 11:30:28.163909 589684 quantize_finetune_llama.py:251] computed original embedding for layer 17 in 1.2260310649871826s
16_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.26it/s]16_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.43it/s]16_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.53it/s]16_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.61it/s]16_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.65it/s]16_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.66it/s]16_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:24,  3.68it/s]16_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.69it/s]16_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.68it/s]1.2881625934824115e-06 0.01630217768251896 -0.01562392245978117
0.9998250007629395 1.0163239240646362 0.9855508804321289
15_o proxy err 0.02212756685912609 err 18.320030212402344 tr(WHW.T) 827.9279174804688
bpp_loss 3.455894112586975
15_up proxy err 0.007236468140035868 err 65.08891296386719 tr(WHW.T) 8994.5693359375
bpp_loss 3.629257849284581
15_gate proxy err 0.0015446410980075598 err 71.39017486572266 tr(WHW.T) 46217.96875
bpp_loss 3.8968233040400913
15_down proxy err 0.010122193023562431 err 64.77582550048828 tr(WHW.T) 6399.38671875
bpp_loss 3.616391454424177
16_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:23,  3.71it/s]16_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.72it/s]16_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.74it/s]16_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.70it/s]16_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.71it/s]I0408 11:30:31.829996 608052 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:30:31.830088 608052 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:30:31.830126 608052 utils.py:162] NumExpr defaulting to 16 threads.
16_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.73it/s]I0408 11:30:32.153513 608052 config.py:54] PyTorch version 2.6.0 available.
16_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.74it/s]W0408 11:30:32.342945 608052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

16_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:21,  3.75it/s]16_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:21,  3.75it/s]W0408 11:30:32.903236 608052 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:30:32.906885 589684 quantize_finetune_llama.py:220] layer 18 gpu 2
I0408 11:30:32.920142 608052 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.76it/s]16_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.74it/s]v
17_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]16_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:20,  3.74it/s]16_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.75it/s]17_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.67it/s]I0408 11:30:34.292741 589684 quantize_finetune_llama.py:251] computed original embedding for layer 18 in 0.9350254535675049s
16_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.75it/s]17_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.12it/s]16_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:19,  3.75it/s]17_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.37it/s]16_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.72it/s]17_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.54it/s]16_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.75it/s]17_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.67it/s]16_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.74it/s]16_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.78it/s]17_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.77it/s]16_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:17,  3.79it/s]17_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.80it/s]16_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.83it/s]17_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.86it/s]16_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.78it/s]17_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.87it/s]16_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:17,  3.76it/s]17_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.90it/s]16_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.73it/s]17_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.90it/s]16_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.73it/s]17_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.90it/s]16_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.73it/s]17_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.92it/s]I0408 11:30:37.797591 608188 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:30:37.797685 608188 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:30:37.797721 608188 utils.py:162] NumExpr defaulting to 16 threads.
16_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:16,  3.74it/s]17_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.93it/s]16_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.76it/s]I0408 11:30:38.122332 608188 config.py:54] PyTorch version 2.6.0 available.
17_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.93it/s]W0408 11:30:38.312665 608188 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

16_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.93it/s]16_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:15,  3.79it/s]17_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.90it/s]16_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:14,  3.80it/s]W0408 11:30:38.866521 608188 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:30:38.870254 589684 quantize_finetune_llama.py:220] layer 19 gpu 3
I0408 11:30:38.883790 608188 data_utils.py:336] using 256 training seqs, 128 validation seqs
17_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.91it/s]16_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.78it/s]17_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.89it/s]16_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.79it/s]v
18_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]17_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.89it/s]16_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.88it/s]16_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:13,  3.81it/s]18_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.87it/s]16_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.81it/s]I0408 11:30:40.204445 589684 quantize_finetune_llama.py:251] computed original embedding for layer 19 in 0.8799550533294678s
18_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.65it/s]17_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:19,  3.83it/s]16_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.09it/s]17_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.82it/s]16_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.78it/s]18_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.37it/s]17_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.83it/s]16_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.81it/s]18_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.54it/s]17_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.79it/s]18_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.64it/s]17_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.85it/s]16_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.79it/s]18_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.68it/s]17_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.85it/s]18_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.74it/s]16_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.79it/s]17_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.86it/s]18_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.77it/s]16_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.79it/s]17_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.86it/s]18_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.80it/s]16_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.81it/s]17_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.85it/s]18_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.81it/s]16_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.81it/s]17_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.85it/s]16_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.83it/s]18_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.85it/s]18_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.83it/s]16_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.81it/s]17_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.86it/s]18_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.79it/s]16_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.86it/s]18_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.80it/s]16_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:10,  3.76it/s]17_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.84it/s]I0408 11:30:43.760089 608322 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:30:43.760183 608322 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:30:43.760226 608322 utils.py:162] NumExpr defaulting to 16 threads.
18_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.79it/s]16_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:09,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.84it/s]I0408 11:30:44.098706 608322 config.py:54] PyTorch version 2.6.0 available.
18_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.80it/s]16_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.82it/s]W0408 11:30:44.292261 608322 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

18_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.81it/s]16_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.84it/s]18_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.82it/s]16_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.78it/s]17_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.83it/s]W0408 11:30:44.868176 608322 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:30:44.871971 589684 quantize_finetune_llama.py:220] layer 20 gpu 0
I0408 11:30:44.888268 608322 data_utils.py:336] using 256 training seqs, 128 validation seqs
18_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.83it/s]17_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.80it/s]16_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.19it/s]18_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.83it/s]17_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.80it/s]16_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.35it/s]v
19_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]18_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.81it/s]17_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.81it/s]16_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.83it/s]17_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.81it/s]16_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.57it/s]19_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.86it/s]18_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.82it/s]17_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.82it/s]16_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:07,  3.63it/s]19_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.71it/s]18_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.82it/s]17_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.83it/s]19_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:30,  3.16it/s]16_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.68it/s]18_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.83it/s]17_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.82it/s]19_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:27,  3.44it/s]16_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.71it/s]18_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.83it/s]17_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.62it/s]16_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:06,  3.74it/s]18_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.84it/s]17_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.73it/s]16_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.76it/s]18_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.85it/s]17_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.80it/s]19_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.81it/s]16_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.76it/s]18_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.82it/s]17_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.80it/s]19_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:23,  3.86it/s]16_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.78it/s]18_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.84it/s]17_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.90it/s]16_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.85it/s]17_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.88it/s]16_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.84it/s]17_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.82it/s]19_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:22,  3.87it/s]16_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.85it/s]17_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.83it/s]19_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.89it/s]16_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:05,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.92it/s]17_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.83it/s]16_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.77it/s]18_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.86it/s]19_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:21,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.83it/s]16_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.79it/s]18_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.87it/s]19_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.88it/s]19_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.88it/s]19_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.92it/s]17_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.82it/s]16_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.86it/s]19_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.91it/s]17_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.82it/s]18_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.86it/s]16_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.82it/s]18_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.86it/s]16_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.80it/s]19_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.91it/s]18_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.14it/s]19_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.93it/s]18_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.85it/s]16_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.79it/s]17_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.31it/s]19_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.94it/s]18_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.86it/s]16_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.45it/s]18_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.53it/s]18_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.84it/s]16_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:18,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:08,  3.61it/s]18_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.83it/s]16_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.78it/s]19_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.67it/s]18_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.85it/s]16_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.78it/s]19_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.72it/s]18_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.85it/s]16_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.94it/s]17_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.75it/s]18_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.95it/s]16_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.77it/s]17_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.75it/s]18_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.95it/s]16_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.78it/s]17_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.78it/s]18_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.86it/s]19_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.93it/s]16_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.78it/s]16_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.71it/s]
17_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.91it/s]17_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.78it/s]18_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:08<00:16,  3.89it/s]17_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.76it/s]18_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.86it/s]17_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.83it/s]19_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.89it/s]17_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:05,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.89it/s]17_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.80it/s]19_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:09<00:15,  3.89it/s]18_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.90it/s]18_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.81it/s]17_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.81it/s]17_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.77it/s]19_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.89it/s]18_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.84it/s]17_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:10<00:14,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.87it/s]18_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.80it/s]17_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.80it/s]19_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.86it/s]18_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.78it/s]17_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.85it/s]17_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.10it/s]19_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.87it/s]17_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.79it/s]18_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.28it/s]19_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.86it/s]17_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.81it/s]18_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.44it/s]19_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.86it/s]17_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.82it/s]18_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.54it/s]19_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.84it/s]17_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.85it/s]18_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.62it/s]19_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.84it/s]1.1347176496201428e-06 0.006327132228761911 -0.00634927349165082
0.9998955726623535 1.0063352584838867 0.9938443303108215
16_v proxy err 0.01602156274020672 err 4.394421100616455 tr(WHW.T) 274.28167724609375
bpp_loss 3.3686351776123047
16_q proxy err 0.0008955862140282989 err 21.929901123046875 tr(WHW.T) 24486.64453125
bpp_loss 4.261316299438477
16_k proxy err 0.0003364720905665308 err 6.563344955444336 tr(WHW.T) 19506.357421875
bpp_loss 5.185060977935791
o
16_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]17_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.83it/s]18_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.68it/s]19_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.86it/s]17_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.82it/s]18_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.73it/s]19_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.86it/s]17_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.81it/s]18_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.76it/s]19_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.85it/s]17_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.83it/s]18_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.77it/s]19_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.84it/s]17_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.84it/s]18_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.80it/s]19_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.86it/s]17_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.84it/s]17_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.77it/s]
18_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.86it/s]18_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.85it/s]18_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.83it/s]19_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.87it/s]18_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.83it/s]19_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:10,  3.88it/s]16_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:58,  3.01s/it]19_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:09,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.83it/s]19_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.88it/s]18_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.78it/s]19_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.14it/s]18_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.76it/s]19_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.31it/s]18_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.76it/s]19_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.76it/s]19_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.59it/s]18_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.77it/s]19_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.65it/s]18_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.77it/s]19_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.72it/s]18_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.77it/s]16_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:55,  3.01s/it]-4.1550123341949075e-07 0.006545666605234146 -0.0065554301254451275
0.9999224543571472 1.006539225578308 0.9934746026992798
17_v proxy err 0.015616131015121937 err 4.4345598220825195 tr(WHW.T) 283.9730224609375
bpp_loss 3.455874443054199
17_q proxy err 0.0008008552249521017 err 22.080732345581055 tr(WHW.T) 27571.44140625
bpp_loss 4.270614147186279
17_k proxy err 0.0003744197019841522 err 6.526065826416016 tr(WHW.T) 17429.814453125
bpp_loss 5.203762054443359
o
17_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]19_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.76it/s]18_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.74it/s]19_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.77it/s]19_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.81it/s]18_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:19<00:06,  3.83it/s]18_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.79it/s]19_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.83it/s]18_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.80it/s]19_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.84it/s]18_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.80it/s]18_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.75it/s]
19_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.87it/s]19_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.86it/s]19_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.87it/s]19_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.89it/s]19_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.89it/s]16_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:52,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:57,  3.01s/it]19_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.89it/s]19_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.83it/s]19_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.81it/s]19_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.82it/s]19_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.84it/s]19_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.83it/s]17_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:49,  3.01s/it]19_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.85it/s]1.3808711685214803e-07 0.006023908965289593 -0.00645544845610857
0.999908447265625 1.0064547061920166 0.9943961501121521
18_v proxy err 0.015100867487490177 err 4.343217372894287 tr(WHW.T) 287.61376953125
bpp_loss 3.362734079360962
18_q proxy err 0.0009845246095210314 err 22.0528564453125 tr(WHW.T) 22399.498046875
bpp_loss 4.268903732299805
18_k proxy err 0.0003792875213548541 err 6.597634792327881 tr(WHW.T) 17394.810546875
bpp_loss 5.284782409667969
o
18_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]19_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.85it/s]19_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.87it/s]19_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:25<00:00,  3.88it/s]19_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.89it/s]19_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.82it/s]
17_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:46,  3.01s/it]18_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:00,  3.04s/it]1.7170815453937394e-06 0.005508165806531906 -0.006236649584025145
0.9998970627784729 1.0062317848205566 0.994378387928009
19_v proxy err 0.012988983653485775 err 4.430018424987793 tr(WHW.T) 341.0596618652344
bpp_loss 3.412360668182373
19_q proxy err 0.0009143435745500028 err 21.979022979736328 tr(WHW.T) 24038.03515625
bpp_loss 4.268052577972412
19_k proxy err 0.00042292129364795983 err 6.577816486358643 tr(WHW.T) 15553.287109375
bpp_loss 5.181816101074219
o
19_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]17_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:43,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:54,  3.00s/it]19_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.99s/it]17_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:40,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:50,  2.99s/it]19_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:51,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:37,  3.01s/it]18_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.99s/it]19_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:48,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:34,  3.01s/it]18_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:44,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:31,  3.01s/it]18_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:28,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:38,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:34,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:36<04:25,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:35,  2.96s/it]17_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:25,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:39<04:22,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:32,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:42<04:19,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:29,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:45<04:15,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:26,  2.96s/it]17_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:48<04:13,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:51<04:10,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:54<04:07,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:04,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:05,  3.07s/it]19_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:01,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:01,  3.05s/it]19_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:03,  3.04s/it]18_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:57,  3.04s/it]19_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:01,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:53,  3.04s/it]19_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:53,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:03,  3.05s/it]16_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:50,  3.03s/it]19_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:59,  3.03s/it]16_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:47,  3.03s/it]19_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]17_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:46,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]16_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:43,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.01s/it]16_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:40,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:53,  3.00s/it]17_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:39,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:48,  3.01s/it]16_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:37,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:49,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:34,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:46,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:31,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:42,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:28,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:39,  2.96s/it]17_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:25,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:36,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:22,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:33,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:29,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:19,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:30,  2.96s/it]17_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:26,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:16,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:27,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:23,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:13,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:20,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:10,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:07,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:58<03:07,  3.08s/it]19_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:01<03:03,  3.06s/it]19_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.04s/it]18_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:04<02:59,  3.05s/it]19_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:07<02:56,  3.04s/it]19_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:56,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:00,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:10<02:52,  3.03s/it]19_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.03s/it]16_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:13<02:49,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:04,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:58,  3.02s/it]16_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:16<02:46,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.01s/it]16_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:19<02:43,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:51,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:22<02:40,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  3.00s/it]17_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:48,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:25<02:36,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]17_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:28<02:33,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:31<02:30,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:34<02:27,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:35,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:37<02:24,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:19<02:37,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:40<02:21,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:22<02:34,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:43<02:18,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:25<02:31,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:46<02:15,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:28<02:29,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:24,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:49<02:12,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:31<02:26,  2.99s/it]17_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:52<02:09,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:34<02:23,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:55<02:06,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:37<02:19,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:06,  3.08s/it]19_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:40<02:16,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:04,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:43<02:14,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:02,  3.06s/it]17_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.99s/it]19_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:46<02:11,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:58,  3.05s/it]17_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.01s/it]18_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]19_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:49<02:08,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.04s/it]17_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:56,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:05,  3.05s/it]19_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:05,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:52,  3.03s/it]17_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.04s/it]16_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:48,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:55<02:04,  3.05s/it]17_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:58,  3.03s/it]16_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:45,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:58<02:00,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:01<01:57,  3.01s/it]16_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:51,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:04<01:54,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:48,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:07<01:50,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:45,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:10<01:47,  3.00s/it]16_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:42,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:44,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:31<01:30,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  3.00s/it]19_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:41,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:34<01:27,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.99s/it]19_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:38,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:37<01:24,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:35,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:40<01:21,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:32,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:43<01:18,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:29,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:46<01:15,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:25,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:49<01:12,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.96s/it]19_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:22,  2.96s/it]16_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:52<01:09,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.96s/it]19_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  2.96s/it]16_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:55<01:06,  3.01s/it]17_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:58<01:04,  3.07s/it]17_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.97s/it]18_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:14,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:02<01:01,  3.05s/it]17_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:05<00:57,  3.04s/it]17_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.00s/it]18_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.99s/it]16_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:08<00:54,  3.04s/it]17_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:56,  2.99s/it]18_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.04s/it]19_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.99s/it]17_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:11<00:51,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:04,  3.05s/it]17_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:14<00:48,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.03s/it]17_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:17<00:45,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:57,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:20<00:42,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:51,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:54,  3.00s/it]17_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:23<00:39,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:48,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.99s/it]17_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:26<00:36,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:45,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:29<00:33,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:42,  3.01s/it]19_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:32<00:30,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  3.00s/it]19_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:35<00:27,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  2.99s/it]19_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.96s/it]17_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.96s/it]16_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:38<00:24,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:41<00:21,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:44<00:18,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:26,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.97s/it]17_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:47<00:15,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:35<00:23,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:50<00:12,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:38<00:20,  2.96s/it]19_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:53<00:09,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:41<00:17,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.98s/it]16_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:56<00:06,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:44<00:14,  2.98s/it]19_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.04s/it]18_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:47<00:11,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:59<00:03,  3.08s/it]19_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.99s/it]17_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.03s/it]18_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:50<00:08,  2.97s/it]16_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.06s/it]16_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.03s/it]
19_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.98s/it]17_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.02s/it]17_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
18_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:05,  2.97s/it]19_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.98s/it]18_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.03s/it]19_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.04s/it]18_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.02s/it]18_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
19_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.02s/it]19_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.00s/it]19_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.98s/it]
-1.2664166888498585e-06 0.014954381622374058 -0.013144082389771938
0.9997889399528503 1.0138148069381714 0.9850289225578308
16_o proxy err 0.018820708617568016 err 18.238933563232422 tr(WHW.T) 969.0885620117188
bpp_loss 3.4387885332107544
16_up proxy err 0.0077932048588991165 err 64.9266128540039 tr(WHW.T) 8331.1826171875
bpp_loss 3.6152916976383755
16_gate proxy err 0.0017358771292492747 err 71.47669982910156 tr(WHW.T) 41176.12890625
bpp_loss 3.931856155395508
16_down proxy err 0.010269483551383018 err 64.577392578125 tr(WHW.T) 6288.2802734375
bpp_loss 3.603182111467634
7.252973546201247e-07 0.013616733253002167 -0.015288103371858597
0.999751627445221 1.015310287475586 0.9869396686553955
17_o proxy err 0.0165170356631279 err 18.27939224243164 tr(WHW.T) 1106.6993408203125
bpp_loss 3.4802900552749634
17_up proxy err 0.007671342696994543 err 64.84234619140625 tr(WHW.T) 8452.5419921875
bpp_loss 3.611156633922032
17_gate proxy err 0.0017206266056746244 err 71.78034973144531 tr(WHW.T) 41717.5625
bpp_loss 3.945538418633597
17_down proxy err 0.010374649427831173 err 64.45059204101562 tr(WHW.T) 6212.31494140625
bpp_loss 3.6013313020978654
I0408 11:36:37.834893 589684 quantize_finetune_llama.py:251] computed original embedding for layer 20 in 1.2498023509979248s
I0408 11:36:41.855776 612255 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:36:41.855902 612255 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:36:41.855947 612255 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:36:42.242691 612255 config.py:54] PyTorch version 2.6.0 available.
W0408 11:36:42.455502 612255 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

-1.2347982192295603e-08 0.013860569335520267 -0.015461640432476997
0.9997552633285522 1.015489935874939 0.9869794845581055
18_o proxy err 0.015114415436983109 err 18.18556785583496 tr(WHW.T) 1203.193603515625
bpp_loss 3.460042357444763
18_up proxy err 0.008108017034828663 err 64.72535705566406 tr(WHW.T) 7982.8837890625
bpp_loss 3.60653509412493
18_gate proxy err 0.0020315165165811777 err 71.59786224365234 tr(WHW.T) 35243.5546875
bpp_loss 3.9546501636505127
18_down proxy err 0.01034843735396862 err 64.43535614013672 tr(WHW.T) 6226.57861328125
bpp_loss 3.5990693228585378
W0408 11:36:43.092864 612255 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:36:43.097262 589684 quantize_finetune_llama.py:220] layer 21 gpu 1
I0408 11:36:43.113942 612255 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
20_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]20_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:58,  1.70it/s]20_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.53it/s]20_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.99it/s]20_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.27it/s]I0408 11:36:45.220507 589684 quantize_finetune_llama.py:251] computed original embedding for layer 21 in 1.0530285835266113s
20_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.44it/s]20_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.54it/s]20_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.60it/s]20_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.66it/s]20_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.67it/s]-1.0607197964418447e-07 0.011212923564016819 -0.012261345051229
0.9997438192367554 1.0112507343292236 0.9877107739448547
19_o proxy err 0.01555630099028349 err 18.18363380432129 tr(WHW.T) 1168.891845703125
bpp_loss 3.477681279182434
19_up proxy err 0.0084524592384696 err 64.65532684326172 tr(WHW.T) 7649.2919921875
bpp_loss 3.6027462823050365
19_gate proxy err 0.002186940051615238 err 71.75786590576172 tr(WHW.T) 32811.99609375
bpp_loss 3.9663046087537492
19_down proxy err 0.010413345880806446 err 64.38296508789062 tr(WHW.T) 6182.73583984375
bpp_loss 3.597132819039481
20_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:24,  3.71it/s]20_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.75it/s]20_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.75it/s]20_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:23,  3.77it/s]20_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:22,  3.76it/s]20_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.75it/s]20_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.77it/s]20_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.77it/s]20_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.75it/s]I0408 11:36:48.845378 612415 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:36:48.845474 612415 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:36:48.845511 612415 utils.py:162] NumExpr defaulting to 16 threads.
20_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.79it/s]I0408 11:36:49.171758 612415 config.py:54] PyTorch version 2.6.0 available.
20_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:21,  3.81it/s]W0408 11:36:49.360906 612415 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

20_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.82it/s]20_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.79it/s]W0408 11:36:49.956649 612415 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:36:49.960389 589684 quantize_finetune_llama.py:220] layer 22 gpu 2
I0408 11:36:49.974390 612415 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.81it/s]20_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:20,  3.78it/s]v
21_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]20_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.76it/s]20_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.73it/s]20_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.58it/s]I0408 11:36:51.348131 589684 quantize_finetune_llama.py:251] computed original embedding for layer 22 in 0.9350905418395996s
20_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:19,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.03it/s]20_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.65it/s]21_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.30it/s]20_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.67it/s]21_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.47it/s]20_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.71it/s]21_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.59it/s]20_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:18,  3.73it/s]21_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.67it/s]20_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:17,  3.76it/s]21_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.74it/s]20_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.79it/s]20_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.76it/s]21_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.82it/s]20_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.82it/s]20_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.81it/s]21_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.84it/s]20_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.80it/s]21_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.85it/s]20_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.86it/s]I0408 11:36:54.961359 612546 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:36:54.961451 612546 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:36:54.961488 612546 utils.py:162] NumExpr defaulting to 16 threads.
20_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.84it/s]I0408 11:36:55.288522 612546 config.py:54] PyTorch version 2.6.0 available.
20_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.81it/s]21_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.86it/s]W0408 11:36:55.476434 612546 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

20_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.81it/s]21_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.87it/s]20_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.80it/s]21_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.88it/s]W0408 11:36:56.014956 612546 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:36:56.018675 589684 quantize_finetune_llama.py:220] layer 23 gpu 3
I0408 11:36:56.037578 612546 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.80it/s]21_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.88it/s]20_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:14,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.87it/s]v
22_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]20_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:13,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.88it/s]20_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.80it/s]21_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.87it/s]22_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.83it/s]20_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.81it/s]21_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.65it/s]I0408 11:36:57.435812 589684 quantize_finetune_llama.py:251] computed original embedding for layer 23 in 0.9609806537628174s
20_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:13,  3.71it/s]21_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.00it/s]20_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.71it/s]21_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.78it/s]22_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.25it/s]20_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.74it/s]21_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.82it/s]22_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.48it/s]20_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.76it/s]21_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.80it/s]22_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.59it/s]20_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.75it/s]21_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.81it/s]22_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.69it/s]20_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.80it/s]22_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.73it/s]20_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.78it/s]21_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.78it/s]20_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.78it/s]21_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.80it/s]20_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.83it/s]20_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.84it/s]20_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.78it/s]21_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.84it/s]20_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:10,  3.78it/s]21_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.81it/s]20_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:09,  3.73it/s]21_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.85it/s]22_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.82it/s]20_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.74it/s]21_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.83it/s]I0408 11:37:00.958015 612680 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:37:00.958105 612680 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:37:00.958148 612680 utils.py:162] NumExpr defaulting to 16 threads.
22_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.84it/s]21_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.74it/s]22_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.84it/s]I0408 11:37:01.286806 612680 config.py:54] PyTorch version 2.6.0 available.
21_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.87it/s]20_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:09,  3.73it/s]W0408 11:37:01.476084 612680 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

22_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.82it/s]21_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:14,  3.88it/s]22_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.81it/s]20_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.10it/s]21_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.89it/s]W0408 11:37:02.030234 612680 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:37:02.033980 589684 quantize_finetune_llama.py:220] layer 24 gpu 0
I0408 11:37:02.047245 612680 data_utils.py:336] using 256 training seqs, 128 validation seqs
22_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.83it/s]20_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.27it/s]21_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.91it/s]22_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.83it/s]20_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.40it/s]21_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.88it/s]v
23_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]22_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.82it/s]20_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.88it/s]22_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.84it/s]20_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.56it/s]21_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.87it/s]23_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:50,  1.95it/s]22_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.83it/s]21_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.61it/s]23_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:35,  2.79it/s]22_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.82it/s]21_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.87it/s]20_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.67it/s]23_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:30,  3.23it/s]22_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.80it/s]21_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:07,  3.67it/s]23_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:27,  3.47it/s]22_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.77it/s]21_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.85it/s]20_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.70it/s]23_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.63it/s]22_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.72it/s]23_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.73it/s]22_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.81it/s]21_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.88it/s]20_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.73it/s]23_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.80it/s]22_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.82it/s]21_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.87it/s]20_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.74it/s]23_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:23,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.83it/s]21_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.87it/s]23_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.87it/s]20_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.72it/s]22_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.82it/s]21_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.86it/s]23_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.88it/s]20_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.73it/s]22_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.82it/s]21_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.85it/s]23_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:22,  3.88it/s]20_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:22<00:05,  3.73it/s]22_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.82it/s]21_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.86it/s]23_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.87it/s]20_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.73it/s]22_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.82it/s]21_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.89it/s]23_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.89it/s]20_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.72it/s]22_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.83it/s]21_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.89it/s]23_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.90it/s]20_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.71it/s]22_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.83it/s]21_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.89it/s]23_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.91it/s]20_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:23<00:04,  3.73it/s]22_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.84it/s]21_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.90it/s]23_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.92it/s]20_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.73it/s]22_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.84it/s]21_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.88it/s]23_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.92it/s]20_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.71it/s]22_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.83it/s]21_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.88it/s]23_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.91it/s]20_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.70it/s]22_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.83it/s]21_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.87it/s]23_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.88it/s]20_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.71it/s]22_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.85it/s]21_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.86it/s]23_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.90it/s]20_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.75it/s]22_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.91it/s]20_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.78it/s]22_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.85it/s]21_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.19it/s]23_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.90it/s]20_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.79it/s]21_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.38it/s]22_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.85it/s]23_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.91it/s]21_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.53it/s]20_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.80it/s]22_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.93it/s]21_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.61it/s]22_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.79it/s]23_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.93it/s]21_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.68it/s]22_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.81it/s]23_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:18,  3.94it/s]21_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.73it/s]22_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.84it/s]20_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:26<00:01,  3.80it/s]23_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.94it/s]21_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.77it/s]22_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.84it/s]20_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.78it/s]23_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.94it/s]21_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.79it/s]22_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.86it/s]20_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.79it/s]23_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.93it/s]21_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.82it/s]22_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.85it/s]20_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.79it/s]23_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.93it/s]21_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.84it/s]20_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:27<00:00,  3.79it/s]20_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:27<00:00,  3.70it/s]
23_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.92it/s]21_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.87it/s]22_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.93it/s]21_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.88it/s]21_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:08<00:16,  3.89it/s]21_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.85it/s]22_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.90it/s]21_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.91it/s]21_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.88it/s]22_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.91it/s]21_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.88it/s]22_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.86it/s]23_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:09<00:15,  3.89it/s]21_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.88it/s]22_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.88it/s]23_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.87it/s]21_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.87it/s]22_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.88it/s]23_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.87it/s]21_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.87it/s]23_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.86it/s]21_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.85it/s]23_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:10<00:15,  3.85it/s]21_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.85it/s]21_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.81it/s]22_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.81it/s]23_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.85it/s]21_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.20it/s]21_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.38it/s]21_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.85it/s]22_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.87it/s]22_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.58it/s]1.6473670712002786e-06 0.005881999619305134 -0.0055459123104810715
0.9998979568481445 1.00587797164917 0.9945989847183228
20_v proxy err 0.013540267944335938 err 4.470890045166016 tr(WHW.T) 330.192138671875
bpp_loss 3.4588146209716797
20_q proxy err 0.001048916019499302 err 21.75214958190918 tr(WHW.T) 20737.7421875
bpp_loss 4.24091362953186
20_k proxy err 0.0004233501385897398 err 6.517818450927734 tr(WHW.T) 15395.810546875
bpp_loss 5.130876541137695
o
20_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]21_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.81it/s]23_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.87it/s]22_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.67it/s]21_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.89it/s]22_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.71it/s]21_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.75it/s]21_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.87it/s]22_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.78it/s]21_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.86it/s]23_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.88it/s]22_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.81it/s]21_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.85it/s]23_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.89it/s]22_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.81it/s]21_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]21_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.78it/s]
23_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.89it/s]22_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.88it/s]22_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.85it/s]22_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.85it/s]23_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.87it/s]22_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.86it/s]20_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:57,  3.01s/it]22_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:10,  3.85it/s]22_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.85it/s]22_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.86it/s]22_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.80it/s]23_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:16<00:09,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.80it/s]23_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.77it/s]23_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.15it/s]22_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.78it/s]23_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:09,  3.34it/s]22_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.81it/s]23_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.47it/s]22_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.81it/s]23_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.56it/s]22_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.80it/s]23_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.66it/s]22_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.80it/s]20_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:55,  3.01s/it]8.400392061957973e-07 0.006319535430520773 -0.006778791546821594
0.9999022483825684 1.006784439086914 0.9939999580383301
21_v proxy err 0.01241734717041254 err 4.505921363830566 tr(WHW.T) 362.87310791015625
bpp_loss 3.4890387058258057
21_q proxy err 0.0008498181705363095 err 21.95769691467285 tr(WHW.T) 25838.111328125
bpp_loss 4.236547946929932
21_k proxy err 0.0003884317120537162 err 6.520779132843018 tr(WHW.T) 16787.453125
bpp_loss 5.175832748413086
o
21_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]23_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:18<00:07,  3.70it/s]22_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.79it/s]23_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.74it/s]22_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.79it/s]23_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.79it/s]22_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.80it/s]23_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.82it/s]22_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.81it/s]23_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]22_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.76it/s]
23_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.85it/s]20_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:52,  3.01s/it]23_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.85it/s]21_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.99s/it]23_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.80it/s]23_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.82it/s]23_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.81it/s]23_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.82it/s]20_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:49,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.98s/it]23_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.80it/s]-5.058012675362988e-09 0.005571774672716856 -0.005652326159179211
0.9999018311500549 1.005569338798523 0.9946462512016296
22_v proxy err 0.013089637272059917 err 4.53004789352417 tr(WHW.T) 346.0789489746094
bpp_loss 3.5459017753601074
22_q proxy err 0.0010644346475601196 err 21.62889289855957 tr(WHW.T) 20319.60546875
bpp_loss 4.196983098983765
22_k proxy err 0.00043987983372062445 err 6.476833820343018 tr(WHW.T) 14724.09765625
bpp_loss 5.106654644012451
o
22_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]23_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.80it/s]23_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.83it/s]23_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.84it/s]23_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.85it/s]23_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.81it/s]
20_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:45,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:56,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:42,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.99s/it]1.069745678705658e-07 0.0054234107956290245 -0.005755567457526922
0.9999188780784607 1.0057525634765625 0.994665265083313
23_v proxy err 0.01169309951364994 err 4.652766704559326 tr(WHW.T) 397.90704345703125
bpp_loss 3.607011318206787
23_q proxy err 0.0009648879640735686 err 21.815086364746094 tr(WHW.T) 22608.931640625
bpp_loss 4.20421576499939
23_k proxy err 0.0004347716167103499 err 6.45960807800293 tr(WHW.T) 14857.474609375
bpp_loss 5.10703706741333
o
23_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]20_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:39,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:54,  2.98s/it]21_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:36,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:50,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:33,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:48,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:30,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:44,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:27,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:36<04:24,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:34,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:39<04:21,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:42<04:18,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:45<04:15,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:25,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:48<04:12,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:51<04:09,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:54<04:06,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:03,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:11,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:05,  3.06s/it]21_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:00,  3.05s/it]21_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]22_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:56,  3.04s/it]21_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]22_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:02,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:53,  3.03s/it]21_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:03,  3.05s/it]20_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:49,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:59,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:46,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:46,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:55,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:43,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:57,  3.01s/it]20_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:40,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:53,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:37,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:33,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:35,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:31,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:38,  3.00s/it]20_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:28,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:35,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:25,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:22,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:18,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:15,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:12,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:18,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:26,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:09,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:11,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:15,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:23,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:06,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:08,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:20,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:57<03:07,  3.07s/it]21_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:05,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:17,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:00<03:03,  3.05s/it]21_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:05,  3.05s/it]22_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:03<02:59,  3.04s/it]21_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.03s/it]22_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:06<02:55,  3.03s/it]21_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:58,  3.02s/it]23_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:04,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:09<02:52,  3.03s/it]21_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:54,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:04,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.01s/it]20_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:12<02:49,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:51,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:56,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:04,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:15<02:46,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:48,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.01s/it]20_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:18<02:42,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:45,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]20_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:21<02:39,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:42,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:46,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  3.00s/it]20_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:24<02:36,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:39,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:27<02:33,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:36,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:46,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:30<02:30,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:32,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:33<02:27,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:36<02:24,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:39<02:21,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:22,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:29,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:42<02:18,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:19,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:45<02:15,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:48<02:12,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:26,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:52<02:09,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:16,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:55<02:06,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:07,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:06,  3.08s/it]21_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:04,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:10,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:02,  3.06s/it]21_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.03s/it]22_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:07,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:14,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:58,  3.05s/it]22_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.98s/it]21_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.03s/it]21_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]22_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:04,  3.03s/it]23_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:51,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:48,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:05,  3.05s/it]20_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:45,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:45,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.00s/it]20_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:40,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:31<01:30,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:34<01:27,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:37<01:24,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:40<01:21,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:43<01:18,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:46<01:15,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:49<01:12,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:52<01:09,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.96s/it]22_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:55<01:06,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:58<01:04,  3.07s/it]21_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:01<01:00,  3.05s/it]22_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.04s/it]23_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:04<00:57,  3.04s/it]22_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.97s/it]21_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.02s/it]23_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:07<00:54,  3.03s/it]21_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.00s/it]22_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.02s/it]23_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:10<00:51,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:53,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:13<00:48,  3.02s/it]21_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:03,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:16<00:45,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.01s/it]20_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:19<00:42,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:56,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:22<00:39,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:25<00:36,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.98s/it]22_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:28<00:33,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:31<00:30,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.96s/it]20_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:34<00:27,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.96s/it]22_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.96s/it]20_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:37<00:24,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.96s/it]23_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.96s/it]22_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  3.00s/it]20_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:40<00:21,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.96s/it]23_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.96s/it]22_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  3.00s/it]20_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:43<00:18,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.97s/it]23_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.95s/it]22_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:26,  3.00s/it]20_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:46<00:15,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.95s/it]22_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:49<00:12,  3.01s/it]21_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.98s/it]23_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.95s/it]22_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.98s/it]20_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:52<00:09,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.99s/it]23_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.95s/it]22_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.98s/it]21_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.99s/it]20_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:55<00:06,  3.06s/it]23_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.96s/it]22_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:58<00:03,  3.05s/it]21_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.04s/it]23_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.97s/it]20_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:01<00:00,  3.03s/it]20_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:01<00:00,  3.02s/it]
21_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.02s/it]23_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.96s/it]21_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.00s/it]21_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
23_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.97s/it]22_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.02s/it]23_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.96s/it]22_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:06,  3.03s/it]22_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]22_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
23_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.01s/it]23_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.00s/it]23_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.98s/it]
3.808219162237947e-07 0.011065641418099403 -0.013355089351534843
0.9997830390930176 1.0120673179626465 0.9865996837615967
20_o proxy err 0.015052632428705692 err 18.14027214050293 tr(WHW.T) 1205.1229248046875
bpp_loss 3.465932011604309
20_up proxy err 0.008510074578225613 err 64.67366027832031 tr(WHW.T) 7599.658203125
bpp_loss 3.6063328811100552
20_gate proxy err 0.0023358722683042288 err 71.62956237792969 tr(WHW.T) 30665.015625
bpp_loss 3.9688989434923445
20_down proxy err 0.010229473002254963 err 64.45449829101562 tr(WHW.T) 6300.8623046875
bpp_loss 3.6012272153581892
2.170206926166429e-06 0.012329903431236744 -0.012146802619099617
0.9996055364608765 1.0110833644866943 0.9875823259353638
21_o proxy err 0.014218480326235294 err 18.010107040405273 tr(WHW.T) 1266.6689453125
bpp_loss 3.484660029411316
21_up proxy err 0.008325259201228619 err 64.70866394042969 tr(WHW.T) 7772.57080078125
bpp_loss 3.6093101501464844
21_gate proxy err 0.0022757654078304768 err 71.83768463134766 tr(WHW.T) 31566.3828125
bpp_loss 3.9811168057577953
21_down proxy err 0.010161545127630234 err 64.54069519042969 tr(WHW.T) 6351.46484375
bpp_loss 3.60399900163923
I0408 11:42:56.861313 589684 quantize_finetune_llama.py:251] computed original embedding for layer 24 in 1.2094857692718506s
-3.2254121151709114e-07 0.01353357918560505 -0.014145110733807087
0.9997875094413757 1.0141589641571045 0.9875980019569397
22_o proxy err 0.015145878307521343 err 18.50570297241211 tr(WHW.T) 1221.8309326171875
bpp_loss 3.5208483934402466
22_up proxy err 0.008584150113165379 err 64.78677368164062 tr(WHW.T) 7547.25537109375
bpp_loss 3.6130397660391673
22_gate proxy err 0.0024332080502063036 err 71.86260986328125 tr(WHW.T) 29534.099609375
bpp_loss 3.9855318750653947
22_down proxy err 0.009887748397886753 err 64.56196594238281 tr(WHW.T) 6529.4912109375
bpp_loss 3.6077985763549805
I0408 11:43:00.721060 616624 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:43:00.721172 616624 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:43:00.721228 616624 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:43:01.088447 616624 config.py:54] PyTorch version 2.6.0 available.
W0408 11:43:01.304580 616624 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 11:43:01.970812 616624 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:43:01.975142 589684 quantize_finetune_llama.py:220] layer 25 gpu 1
I0408 11:43:01.989928 616624 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
24_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]24_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.76it/s]24_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.56it/s]24_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.00it/s]I0408 11:43:03.755236 589684 quantize_finetune_llama.py:251] computed original embedding for layer 25 in 1.2920336723327637s
24_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.24it/s]24_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.42it/s]24_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.54it/s]24_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.59it/s]24_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.64it/s]24_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.68it/s]24_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:24,  3.72it/s]5.732352406084829e-07 0.009679477661848068 -0.011037847958505154
0.9997704029083252 1.0109881162643433 0.9897904992103577
23_o proxy err 0.01057530753314495 err 18.44831657409668 tr(WHW.T) 1744.470947265625
bpp_loss 3.554722547531128
23_up proxy err 0.008747600950300694 err 64.9002685546875 tr(WHW.T) 7419.2080078125
bpp_loss 3.617288725716727
23_gate proxy err 0.002631426090374589 err 71.81596374511719 tr(WHW.T) 27291.65234375
bpp_loss 3.9889912605285645
23_down proxy err 0.009700164198875427 err 64.67085266113281 tr(WHW.T) 6666.9853515625
bpp_loss 3.612213815961565
24_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.76it/s]24_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.77it/s]24_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.80it/s]24_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:22,  3.78it/s]24_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.79it/s]24_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.79it/s]24_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.80it/s]I0408 11:43:07.391402 616777 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:43:07.391497 616777 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:43:07.391536 616777 utils.py:162] NumExpr defaulting to 16 threads.
24_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.79it/s]I0408 11:43:07.714855 616777 config.py:54] PyTorch version 2.6.0 available.
24_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.81it/s]W0408 11:43:07.902249 616777 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

24_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.83it/s]W0408 11:43:08.461165 616777 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:43:08.464919 589684 quantize_finetune_llama.py:220] layer 26 gpu 2
I0408 11:43:08.485849 616777 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.81it/s]v
25_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]24_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.82it/s]25_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.81it/s]25_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:36,  2.68it/s]I0408 11:43:09.933772 589684 quantize_finetune_llama.py:251] computed original embedding for layer 26 in 0.9989891052246094s
24_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.76it/s]25_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.09it/s]24_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:19,  3.77it/s]25_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.36it/s]24_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.78it/s]25_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.53it/s]25_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.65it/s]24_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.73it/s]24_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.80it/s]24_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.84it/s]24_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:17,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.81it/s]25_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:22,  3.90it/s]24_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.82it/s]25_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.92it/s]24_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.83it/s]25_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.92it/s]24_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.83it/s]25_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:21,  3.93it/s]24_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.81it/s]25_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.90it/s]24_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.91it/s]24_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.82it/s]I0408 11:43:13.445618 616911 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:43:13.445711 616911 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:43:13.445748 616911 utils.py:162] NumExpr defaulting to 16 threads.
25_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.91it/s]24_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.83it/s]I0408 11:43:13.765873 616911 config.py:54] PyTorch version 2.6.0 available.
25_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:20,  3.93it/s]24_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.84it/s]W0408 11:43:13.951973 616911 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

25_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.92it/s]24_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.84it/s]25_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.93it/s]24_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.80it/s]W0408 11:43:14.530176 616911 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:43:14.533988 589684 quantize_finetune_llama.py:220] layer 27 gpu 3
I0408 11:43:14.553937 616911 data_utils.py:336] using 256 training seqs, 128 validation seqs
25_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.93it/s]24_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.81it/s]25_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:19,  3.91it/s]24_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.80it/s]v
26_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]25_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.92it/s]24_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.92it/s]24_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.81it/s]26_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:51,  1.92it/s]25_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.92it/s]24_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:35,  2.74it/s]25_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:18,  3.93it/s]I0408 11:43:15.895727 589684 quantize_finetune_llama.py:251] computed original embedding for layer 27 in 0.9148705005645752s
24_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.80it/s]26_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:30,  3.15it/s]25_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.90it/s]24_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:13,  3.75it/s]26_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.38it/s]25_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.89it/s]24_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.74it/s]26_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:26,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.89it/s]24_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.76it/s]26_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:25,  3.66it/s]25_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:07<00:17,  3.91it/s]26_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:24,  3.74it/s]24_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.75it/s]25_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.91it/s]26_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.78it/s]24_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.76it/s]25_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.91it/s]26_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:23,  3.81it/s]24_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.75it/s]25_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.89it/s]26_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.84it/s]24_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.76it/s]25_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:08<00:16,  3.89it/s]26_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.86it/s]24_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.77it/s]25_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.87it/s]26_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.86it/s]26_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.86it/s]26_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.86it/s]24_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:10,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.86it/s]I0408 11:43:19.450996 617057 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:43:19.451092 617057 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:43:19.451135 617057 utils.py:162] NumExpr defaulting to 16 threads.
24_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.81it/s]25_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.85it/s]26_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.86it/s]24_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.76it/s]25_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.87it/s]I0408 11:43:19.777924 617057 config.py:54] PyTorch version 2.6.0 available.
26_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.88it/s]W0408 11:43:19.967658 617057 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

24_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.78it/s]25_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.87it/s]26_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.88it/s]24_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.87it/s]26_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.90it/s]25_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.89it/s]W0408 11:43:20.561776 617057 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:43:20.565670 589684 quantize_finetune_llama.py:220] layer 28 gpu 0
I0408 11:43:20.579092 617057 data_utils.py:336] using 256 training seqs, 128 validation seqs
26_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.06it/s]25_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.88it/s]26_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.86it/s]24_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.23it/s]25_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.86it/s]v
27_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]26_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.37it/s]25_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.86it/s]26_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.88it/s]24_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.48it/s]25_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.86it/s]26_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:19,  1.24it/s]26_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:19,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.65it/s]25_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:01<00:47,  2.04it/s]26_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.84it/s]24_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.71it/s]25_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:37,  2.61it/s]26_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.86it/s]24_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:07,  3.70it/s]25_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:32,  2.99it/s]26_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.75it/s]25_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.25it/s]26_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.74it/s]27_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:27,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.83it/s]24_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.75it/s]27_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.86it/s]25_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.75it/s]27_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.63it/s]26_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.84it/s]25_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:14<00:11,  3.86it/s]24_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.76it/s]27_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.70it/s]26_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.77it/s]27_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:24,  3.75it/s]26_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:05,  3.76it/s]27_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.77it/s]26_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.85it/s]24_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.75it/s]27_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.78it/s]26_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:15<00:10,  3.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.77it/s]27_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.80it/s]26_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.88it/s]24_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.75it/s]27_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:22,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.83it/s]25_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.88it/s]24_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.77it/s]27_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.81it/s]26_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.84it/s]25_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.88it/s]24_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.76it/s]27_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.78it/s]27_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.86it/s]25_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.88it/s]27_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.77it/s]26_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:08,  3.87it/s]27_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.81it/s]24_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.78it/s]26_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:17<00:08,  3.88it/s]27_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.81it/s]24_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.79it/s]26_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:20,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.24it/s]26_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.83it/s]24_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.40it/s]26_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.83it/s]24_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:08,  3.51it/s]26_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.82it/s]27_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.78it/s]25_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.60it/s]26_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:19,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.67it/s]26_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.73it/s]26_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.82it/s]24_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.79it/s]25_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.76it/s]26_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.87it/s]27_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.83it/s]24_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.79it/s]26_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:18,  3.83it/s]24_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.77it/s]25_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.81it/s]26_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.84it/s]24_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.77it/s]24_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.72it/s]
25_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.84it/s]25_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:18,  3.77it/s]25_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:17,  3.76it/s]25_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.78it/s]25_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.85it/s]26_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.85it/s]26_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.80it/s]25_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.84it/s]26_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.81it/s]25_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.85it/s]26_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.81it/s]25_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.85it/s]26_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.82it/s]25_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.85it/s]26_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:15,  3.82it/s]25_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.84it/s]26_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.77it/s]25_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.78it/s]25_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:15,  3.76it/s]25_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:23<00:02,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.07it/s]27_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:14,  3.75it/s]25_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.24it/s]25_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.77it/s]26_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.39it/s]25_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.77it/s]26_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.49it/s]25_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:24<00:01,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.79it/s]26_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:08,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:13,  3.78it/s]26_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.62it/s]25_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.74it/s]26_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.68it/s]6.126474545453675e-07 0.005938197020441294 -0.005939729977399111
0.9999118447303772 1.0059384107589722 0.9941813349723816
24_v proxy err 0.010187351144850254 err 4.760328769683838 tr(WHW.T) 467.2783508300781
bpp_loss 3.7102696895599365
24_q proxy err 0.000966545834671706 err 21.685518264770508 tr(WHW.T) 22436.099609375
bpp_loss 4.169379472732544
24_k proxy err 0.00044933019671589136 err 6.373045444488525 tr(WHW.T) 14183.4345703125
bpp_loss 4.934964179992676
o
24_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]25_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.76it/s]26_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:07,  3.70it/s]25_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.79it/s]26_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.74it/s]25_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.87it/s]25_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.81it/s]
27_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.80it/s]26_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.76it/s]27_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.78it/s]27_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.80it/s]26_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.77it/s]27_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.80it/s]26_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.80it/s]27_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.84it/s]26_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.82it/s]27_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:10,  3.84it/s]26_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.82it/s]27_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.82it/s]26_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.80it/s]27_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.84it/s]26_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.80it/s]24_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:57,  3.01s/it]27_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.86it/s]26_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:09,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.84it/s]26_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.84it/s]26_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.85it/s]26_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.78it/s]26_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.19it/s]26_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.77it/s]27_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.37it/s]26_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.75it/s]27_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.49it/s]26_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.76it/s]27_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.59it/s]26_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.76it/s]27_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:07,  3.65it/s]7.050963404253707e-07 0.00486617861315608 -0.005181103944778442
0.999935507774353 1.004867434501648 0.9948391914367676
25_v proxy err 0.008541306480765343 err 4.7644147872924805 tr(WHW.T) 557.8086547851562
bpp_loss 3.7242496013641357
25_q proxy err 0.0008287375094369054 err 21.640018463134766 tr(WHW.T) 26112.029296875
bpp_loss 4.148374080657959
25_k proxy err 0.0004395585274323821 err 6.336948394775391 tr(WHW.T) 14416.6201171875
bpp_loss 4.92311954498291
o
25_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]26_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.76it/s]27_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.70it/s]24_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:54,  3.01s/it]26_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.75it/s]26_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:06,  3.78it/s]26_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.81it/s]26_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.83it/s]26_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.76it/s]
27_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.84it/s]27_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.85it/s]25_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:56,  2.99s/it]27_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.82it/s]24_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:51,  3.01s/it]27_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.86it/s]27_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.82it/s]27_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.83it/s]27_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.78it/s]25_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.99s/it]27_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.80it/s]27_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.81it/s]24_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:48,  3.01s/it]-8.799922568414331e-08 0.005171237047761679 -0.005407040007412434
0.9999400973320007 1.0053998231887817 0.994910717010498
26_v proxy err 0.011093731969594955 err 4.820734977722168 tr(WHW.T) 434.54583740234375
bpp_loss 3.7847445011138916
26_q proxy err 0.0010043727234005928 err 21.496871948242188 tr(WHW.T) 21403.28125
bpp_loss 4.155888557434082
26_k proxy err 0.0004124769475311041 err 6.362698554992676 tr(WHW.T) 15425.5859375
bpp_loss 4.996563911437988
o
26_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]27_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.79it/s]27_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.81it/s]27_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.85it/s]27_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.87it/s]27_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.88it/s]27_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.72it/s]
25_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:45,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:56,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:42,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:53,  2.99s/it]3.449318342063634e-07 0.006237337365746498 -0.006033182144165039
0.9999209046363831 1.006232738494873 0.9940168261528015
27_v proxy err 0.007338454015552998 err 4.973225116729736 tr(WHW.T) 677.69384765625
bpp_loss 3.8619604110717773
27_q proxy err 0.0010107361013069749 err 21.534711837768555 tr(WHW.T) 21305.96875
bpp_loss 4.126901626586914
27_k proxy err 0.00045448984019458294 err 6.368138790130615 tr(WHW.T) 14011.6201171875
bpp_loss 4.950887203216553
o
27_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]25_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:39,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:50,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:57,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:36,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:33,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:48,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:34,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:30,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:27,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:36<04:24,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:39<04:22,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:42<04:18,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:45<04:15,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:48<04:13,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:51<04:09,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:54<04:06,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:03,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.96s/it]26_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:05,  3.07s/it]25_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.96s/it]26_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:00,  3.05s/it]25_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]26_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:56,  3.03s/it]25_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:58,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:52,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:54,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]27_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:49,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:57,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:46,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:53,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]24_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:43,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:43,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:50,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:57,  3.01s/it]24_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:39,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:47,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:53,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:36,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:36,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:44,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:49,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:33,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:33,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:40,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:45,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:30,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:30,  2.96s/it]26_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:42,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:27,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:27,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:39,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:24,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:24,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:36,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:21,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:21,  2.96s/it]26_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:27,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:33,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:18,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:24,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:30,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:15,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:16,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:21,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:27,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:12,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:18,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:24,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:09,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:11,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:15,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:06,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:08,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:12,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:19,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:57<03:03,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:05,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:09,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:17,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:00<03:04,  3.07s/it]25_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:02,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:06,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:13,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:03<02:59,  3.05s/it]25_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:02,  3.05s/it]26_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:03,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:10,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:06<02:56,  3.04s/it]25_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:59,  3.03s/it]26_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:00,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:07,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:09<02:52,  3.03s/it]25_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:55,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.03s/it]27_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:03,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:12<02:49,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:51,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:00,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:15<02:45,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:48,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:01,  3.02s/it]24_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:18<02:42,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:45,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:50,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:57,  3.00s/it]24_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:21<02:39,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:47,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:24<02:36,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:38,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:44,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:49,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:27<02:33,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:41,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:46,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:30<02:30,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:13<02:43,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:33<02:27,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:16<02:40,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:36<02:24,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:19<02:37,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:39<02:21,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:22,  2.96s/it]26_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.97s/it]27_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:22<02:34,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:42<02:18,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:19,  2.96s/it]26_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:31<02:25,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:25<02:30,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:45<02:15,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:16,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:34<02:22,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:28<02:27,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:48<02:12,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:37<02:19,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:31<02:24,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:51<02:09,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:11,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:40<02:16,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:34<02:21,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:54<02:06,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:08,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:43<02:13,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:37<02:19,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:05,  3.07s/it]25_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:05,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:46<02:10,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:40<02:16,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:02,  3.06s/it]26_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:49<02:07,  2.96s/it]25_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:05,  3.05s/it]27_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:43<02:13,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:58,  3.04s/it]26_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:04,  2.96s/it]25_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:01,  3.03s/it]27_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:46<02:11,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.04s/it]26_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:55<02:03,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:57,  3.02s/it]27_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:49<02:08,  2.98s/it]24_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:52,  3.03s/it]26_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:58<02:00,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:05,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:48,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:01<01:56,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:51,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:55<02:04,  3.05s/it]24_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:45,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:04<01:53,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:48,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:58<02:01,  3.03s/it]24_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:07<01:50,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:45,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:01<01:57,  3.02s/it]24_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:10<01:46,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:04<01:54,  3.01s/it]24_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:43,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:07<01:51,  3.01s/it]24_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:40,  2.96s/it]25_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:10<01:48,  3.00s/it]24_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:31<01:30,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:37,  2.96s/it]25_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:44,  3.00s/it]24_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:34<01:27,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:35,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:41,  3.00s/it]24_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:37<01:24,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:32,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:38,  3.00s/it]24_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:40<01:21,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:29,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:35,  3.00s/it]24_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:43<01:18,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:26,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:21,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:32,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:46<01:15,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:23,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:18,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:29,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:49<01:12,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:26,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:52<01:09,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:23,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:55<01:06,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:14,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:58<01:04,  3.07s/it]26_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  2.99s/it]24_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:01<01:00,  3.05s/it]26_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:14,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:04,  3.06s/it]24_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:04<00:57,  3.03s/it]26_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.04s/it]24_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:07<00:54,  3.03s/it]26_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:03,  3.03s/it]27_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.03s/it]24_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:10<00:51,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.02s/it]24_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:13<00:48,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:56,  3.00s/it]25_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:51,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:04,  3.05s/it]24_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:16<00:45,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  2.99s/it]25_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:48,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<01:00,  3.03s/it]24_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:19<00:42,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.98s/it]25_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:45,  3.01s/it]27_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:57,  3.02s/it]26_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:22<00:39,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:42,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:54,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:25<00:36,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:39,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:51,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.97s/it]24_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:28<00:33,  3.01s/it]25_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:36,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:48,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:31<00:30,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:33,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:45,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:34<00:27,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:30,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:37<00:24,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:27,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:40<00:21,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:35<00:23,  3.00s/it]27_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:43<00:18,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:38<00:20,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  3.00s/it]26_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:46<00:15,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:41<00:17,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:49<00:12,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:44<00:14,  2.98s/it]27_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.98s/it]26_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:39<00:17,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:52<00:09,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:47<00:11,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:42<00:14,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:55<00:06,  3.02s/it]25_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:50<00:08,  2.99s/it]27_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.97s/it]26_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:45<00:11,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:58<00:03,  3.08s/it]27_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.97s/it]25_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:05,  2.99s/it]26_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:48<00:08,  2.96s/it]24_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:01<00:00,  3.06s/it]24_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:01<00:00,  3.02s/it]
27_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.96s/it]25_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.05s/it]26_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:51<00:05,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.96s/it]25_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.03s/it]25_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
26_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:54<00:03,  3.02s/it]27_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.96s/it]26_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:57<00:00,  3.01s/it]26_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:57<00:00,  2.98s/it]
27_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:05,  2.96s/it]27_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.04s/it]27_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.02s/it]27_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
-5.583203801506897e-07 0.009973972104489803 -0.009818305261433125
0.9997363090515137 1.0093250274658203 0.9899663329124451
24_o proxy err 0.011692370288074017 err 18.584930419921875 tr(WHW.T) 1589.4920654296875
bpp_loss 3.606738805770874
24_up proxy err 0.008879412896931171 err 64.91866302490234 tr(WHW.T) 7311.1435546875
bpp_loss 3.621901750564575
24_gate proxy err 0.0027765301056206226 err 71.8489990234375 tr(WHW.T) 25877.26171875
bpp_loss 3.995889970234462
24_down proxy err 0.009619932621717453 err 64.85697937011719 tr(WHW.T) 6741.93701171875
bpp_loss 3.617424556187221
1.2652637906285236e-06 0.012857947498559952 -0.011475860141217709
0.9996433258056641 1.0104105472564697 0.9870883226394653
25_o proxy err 0.009313644841313362 err 18.53863525390625 tr(WHW.T) 1990.481201171875
bpp_loss 3.6115556955337524
25_up proxy err 0.0088009312748909 err 64.97015380859375 tr(WHW.T) 7382.19091796875
bpp_loss 3.6310696601867676
25_gate proxy err 0.0027371023315936327 err 72.00614166259766 tr(WHW.T) 26307.435546875
bpp_loss 4.005198376519339
25_down proxy err 0.009815041907131672 err 64.93583679199219 tr(WHW.T) 6615.951171875
bpp_loss 3.626546178545271
I0408 11:49:17.114243 589684 quantize_finetune_llama.py:251] computed original embedding for layer 28 in 1.118218183517456s
1.8729956536844838e-06 0.010141023434698582 -0.00938634853810072
0.9997533559799194 1.008516550064087 0.9898039102554321
26_o proxy err 0.007843360304832458 err 18.735624313354492 tr(WHW.T) 2388.72412109375
bpp_loss 3.631981372833252
26_up proxy err 0.00852623675018549 err 65.18867492675781 tr(WHW.T) 7645.65625
bpp_loss 3.6397834164755687
26_gate proxy err 0.0024900499265640974 err 71.9660415649414 tr(WHW.T) 28901.4453125
bpp_loss 4.00994838987078
26_down proxy err 0.00981805007904768 err 64.98395538330078 tr(WHW.T) 6618.82470703125
bpp_loss 3.6353074482509067
I0408 11:49:21.083234 621058 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:49:21.083334 621058 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:49:21.083380 621058 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:49:21.443300 621058 config.py:54] PyTorch version 2.6.0 available.
W0408 11:49:21.649861 621058 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 11:49:22.260497 621058 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:49:22.265120 589684 quantize_finetune_llama.py:220] layer 29 gpu 1
I0408 11:49:22.281770 621058 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
28_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.73it/s]28_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.55it/s]I0408 11:49:23.782683 589684 quantize_finetune_llama.py:251] computed original embedding for layer 29 in 1.0380823612213135s
28_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.00it/s]28_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.29it/s]28_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.43it/s]28_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.56it/s]1.4355762800732919e-08 0.01665053516626358 -0.013497330248355865
0.9996328949928284 1.0166635513305664 0.9839069843292236
27_o proxy err 0.008770369924604893 err 18.943613052368164 tr(WHW.T) 2159.9560546875
bpp_loss 3.6651183366775513
27_up proxy err 0.007730261422693729 err 65.51856231689453 tr(WHW.T) 8475.5947265625
bpp_loss 3.653531381062099
27_gate proxy err 0.0022017736919224262 err 72.23807525634766 tr(WHW.T) 32809.0390625
bpp_loss 4.017937523978097
27_down proxy err 0.009950419887900352 err 65.10916137695312 tr(WHW.T) 6543.35791015625
bpp_loss 3.6475155694144115
28_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.65it/s]28_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.70it/s]28_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.75it/s]28_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.79it/s]28_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.79it/s]28_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.78it/s]28_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.82it/s]28_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.83it/s]28_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.84it/s]I0408 11:49:27.326376 621200 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:49:27.326469 621200 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:49:27.326510 621200 utils.py:162] NumExpr defaulting to 16 threads.
28_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.85it/s]I0408 11:49:27.651043 621200 config.py:54] PyTorch version 2.6.0 available.
28_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.85it/s]W0408 11:49:27.839872 621200 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

28_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.84it/s]W0408 11:49:28.389034 621200 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:49:28.392745 589684 quantize_finetune_llama.py:220] layer 30 gpu 2
I0408 11:49:28.407960 621200 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.83it/s]28_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.82it/s]v
29_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:20,  3.83it/s]28_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.81it/s]28_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.84it/s]I0408 11:49:29.668588 589684 quantize_finetune_llama.py:251] computed original embedding for layer 30 in 0.8596658706665039s
29_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.62it/s]28_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.01it/s]28_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.79it/s]29_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.31it/s]28_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.79it/s]29_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.81it/s]29_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.59it/s]28_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.82it/s]29_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.68it/s]28_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.74it/s]28_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.77it/s]28_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.78it/s]28_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.81it/s]28_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.82it/s]29_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.83it/s]28_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.84it/s]28_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.84it/s]28_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.84it/s]I0408 11:49:33.287806 621331 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:49:33.287925 621331 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:49:33.287965 621331 utils.py:162] NumExpr defaulting to 16 threads.
29_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.84it/s]I0408 11:49:33.615160 621331 config.py:54] PyTorch version 2.6.0 available.
29_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.84it/s]W0408 11:49:33.801264 621331 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

29_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.83it/s]28_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.85it/s]W0408 11:49:34.357859 621331 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:49:34.361520 589684 quantize_finetune_llama.py:220] layer 31 gpu 3
I0408 11:49:34.374812 621331 data_utils.py:336] using 256 training seqs, 128 validation seqs
29_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.82it/s]28_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.81it/s]28_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.83it/s]v
30_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.86it/s]30_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.79it/s]28_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.62it/s]28_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.87it/s]30_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:31,  3.08it/s]28_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.84it/s]I0408 11:49:36.238548 589684 quantize_finetune_llama.py:251] computed original embedding for layer 31 in 1.4530692100524902s
29_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:19,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:28,  3.34it/s]28_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:27,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.80it/s]29_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:26,  3.60it/s]28_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.79it/s]29_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:25,  3.68it/s]28_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:12,  3.78it/s]29_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.79it/s]30_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:24,  3.73it/s]28_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.78it/s]29_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.78it/s]28_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.79it/s]29_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:02<00:23,  3.83it/s]28_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.79it/s]29_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.75it/s]29_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:22,  3.88it/s]28_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.77it/s]29_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.90it/s]28_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.78it/s]29_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:03<00:22,  3.90it/s]28_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.79it/s]29_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:21,  3.91it/s]28_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.90it/s]29_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:16,  3.78it/s]28_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.81it/s]28_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:04<00:21,  3.89it/s]I0408 11:49:39.916191 621462 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:49:39.916280 621462 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:49:39.916320 621462 utils.py:162] NumExpr defaulting to 16 threads.
29_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.84it/s]28_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:20,  3.91it/s]29_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.84it/s]I0408 11:49:40.314870 621462 config.py:54] PyTorch version 2.6.0 available.
28_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.88it/s]29_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.84it/s]W0408 11:49:40.516788 621462 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

30_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.85it/s]28_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:10,  3.18it/s]30_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:05<00:20,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.86it/s]28_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.35it/s]W0408 11:49:41.148891 621462 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 11:49:41.168447 621462 data_utils.py:336] using 256 training seqs, 128 validation seqs
30_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.88it/s]29_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:13,  3.87it/s]28_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.87it/s]28_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.57it/s]30_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:06<00:19,  3.87it/s]29_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.86it/s]v
31_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:07,  3.63it/s]30_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:06<00:19,  3.88it/s]29_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.86it/s]28_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.69it/s]30_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.88it/s]28_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.73it/s]30_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:15,  1.31it/s]28_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.75it/s]30_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:07<00:18,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:01<00:45,  2.14it/s]28_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.78it/s]30_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:17,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:36,  2.68it/s]28_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.79it/s]30_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.90it/s]29_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.06it/s]28_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.79it/s]30_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.89it/s]31_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.27it/s]28_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.78it/s]30_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:08<00:17,  3.90it/s]29_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.90it/s]31_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:27,  3.46it/s]28_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.77it/s]30_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:16,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.91it/s]31_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.79it/s]30_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.89it/s]29_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.89it/s]31_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.67it/s]28_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.88it/s]29_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:24,  3.72it/s]28_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:09<00:16,  3.88it/s]29_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:23,  3.77it/s]28_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:15,  3.90it/s]29_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.89it/s]31_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:23,  3.81it/s]28_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.87it/s]29_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.90it/s]31_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:23,  3.82it/s]28_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.88it/s]29_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:22,  3.82it/s]28_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:10<00:15,  3.86it/s]29_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:22,  3.84it/s]28_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.87it/s]29_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:22,  3.82it/s]28_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.88it/s]29_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:21,  3.84it/s]28_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:21,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.24it/s]28_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:11<00:14,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:21,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.41it/s]28_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:21,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.79it/s]30_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:20,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.63it/s]28_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:12<00:13,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:05<00:20,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:07,  3.69it/s]28_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:12<00:13,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:20,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.74it/s]28_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:12,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:19,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.77it/s]28_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:19,  3.81it/s]29_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.79it/s]28_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:13<00:12,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:19,  3.82it/s]29_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.82it/s]28_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:13<00:12,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:19,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.83it/s]28_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:18,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.82it/s]28_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.81it/s]28_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.75it/s]
30_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:18,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:14<00:11,  3.83it/s]31_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:18,  3.86it/s]29_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.82it/s]31_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:18,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:10,  3.83it/s]31_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:17,  3.85it/s]29_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:05,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:08<00:17,  3.86it/s]29_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.79it/s]30_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:15<00:10,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:17,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:17,  3.83it/s]29_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:16,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.85it/s]30_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.83it/s]31_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:09<00:16,  3.82it/s]29_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:16<00:09,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:16,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.86it/s]30_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:16,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:08,  3.84it/s]31_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:10<00:15,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.82it/s]31_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:10<00:15,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:17<00:10,  3.17it/s]29_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.81it/s]31_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:15,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:09,  3.34it/s]29_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.80it/s]31_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:15,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:08,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.80it/s]31_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:11<00:14,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:18<00:08,  3.56it/s]29_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.82it/s]31_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:11<00:14,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:18<00:08,  3.62it/s]29_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.83it/s]31_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:14,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.67it/s]29_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.82it/s]31_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:14,  3.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.73it/s]29_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.81it/s]31_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:12<00:13,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:19<00:06,  3.75it/s]29_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.79it/s]4.273423144240951e-07 0.006546795833855867 -0.005916598718613386
0.9999512434005737 1.0064566135406494 0.9941608905792236
28_v proxy err 0.008288655430078506 err 4.985496997833252 tr(WHW.T) 601.4844360351562
bpp_loss 3.9216651916503906
28_q proxy err 0.0009410289349034429 err 21.797889709472656 tr(WHW.T) 23163.888671875
bpp_loss 4.133872747421265
28_k proxy err 0.00043051113607361913 err 6.455175399780273 tr(WHW.T) 14994.2119140625
bpp_loss 4.896484375
o
28_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]31_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:13,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:19<00:06,  3.79it/s]29_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.81it/s]31_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:13,  3.83it/s]30_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.82it/s]29_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.80it/s]31_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:13<00:13,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:05,  3.84it/s]29_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.82it/s]29_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.78it/s]
31_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:13<00:12,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:20<00:05,  3.83it/s]31_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:12,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:20<00:05,  3.83it/s]31_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:12,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.84it/s]31_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:14<00:11,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:04,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:14<00:11,  3.85it/s]30_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:21<00:04,  3.87it/s]31_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:11,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:21<00:04,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:15<00:11,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.89it/s]31_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:15<00:11,  3.78it/s]30_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:22<00:03,  3.87it/s]28_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:58,  3.02s/it]31_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:15<00:10,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:22<00:03,  3.89it/s]30_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:22<00:03,  3.89it/s]31_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:10,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.88it/s]31_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:16<00:10,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:23<00:02,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:16<00:09,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:23<00:02,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:16<00:09,  3.81it/s]30_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.85it/s]31_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:17<00:09,  3.80it/s]30_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:17<00:09,  3.79it/s]30_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:24<00:01,  3.84it/s]31_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:17<00:09,  3.77it/s]30_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:24<00:01,  3.84it/s]30_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.84it/s]31_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:18<00:11,  2.87it/s]30_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:18<00:10,  3.09it/s]-3.5631373407341016e-08 0.005477994680404663 -0.005432623438537121
0.999965488910675 1.0054808855056763 0.9947108626365662
29_v proxy err 0.0059749772772192955 err 5.081294059753418 tr(WHW.T) 850.4290161132812
bpp_loss 3.9811840057373047
29_q proxy err 0.0010535947512835264 err 21.760129928588867 tr(WHW.T) 20653.2265625
bpp_loss 4.125101327896118
29_k proxy err 0.0003908459038939327 err 6.396504878997803 tr(WHW.T) 16365.796875
bpp_loss 5.001546382904053
o
29_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]30_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:25<00:00,  3.84it/s]31_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:18<00:09,  3.24it/s]28_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<04:55,  3.01s/it]30_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:25<00:00,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.39it/s]30_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.86it/s]31_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:19<00:08,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.86it/s]30_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.79it/s]
31_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:19<00:07,  3.60it/s]31_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:19<00:07,  3.67it/s]31_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:20<00:07,  3.68it/s]31_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:20<00:06,  3.70it/s]31_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:20<00:06,  3.74it/s]31_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:20<00:06,  3.76it/s]31_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:21<00:05,  3.80it/s]31_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:21<00:05,  3.80it/s]29_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.99s/it]31_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:21<00:05,  3.78it/s]28_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:52,  3.01s/it]31_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:21<00:05,  3.77it/s]31_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:22<00:04,  3.77it/s]31_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:22<00:04,  3.77it/s]31_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:22<00:04,  3.77it/s]31_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:23<00:03,  3.76it/s]31_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:23<00:03,  3.76it/s]31_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:23<00:03,  3.76it/s]31_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:23<00:03,  3.76it/s]31_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:24<00:02,  3.75it/s]31_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:24<00:02,  3.77it/s]31_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:24<00:02,  3.78it/s]2.858062941868411e-07 0.005752647761255503 -0.005278628319501877
0.9999492764472961 1.0057238340377808 0.995017409324646
30_v proxy err 0.006275819148868322 err 5.416413307189941 tr(WHW.T) 863.060791015625
bpp_loss 4.24386739730835
30_q proxy err 0.0008821420487947762 err 21.216073989868164 tr(WHW.T) 24050.6328125
bpp_loss 4.021165132522583
30_k proxy err 0.0004395358555484563 err 6.166946887969971 tr(WHW.T) 14030.5888671875
bpp_loss 4.635194301605225
o
30_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]29_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:52,  2.99s/it]31_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:24<00:02,  3.77it/s]28_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:49,  3.01s/it]31_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:25<00:01,  3.79it/s]31_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:25<00:01,  3.79it/s]31_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:25<00:01,  3.79it/s]31_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:25<00:01,  3.80it/s]31_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:26<00:00,  3.81it/s]31_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:26<00:00,  3.79it/s]31_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:26<00:00,  3.80it/s]31_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.79it/s]31_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:26<00:00,  3.70it/s]
30_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<04:58,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:49,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:46,  3.01s/it]30_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:53,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:42,  3.01s/it]-1.718446469567425e-07 0.006313585210591555 -0.005979465786367655
0.9999663829803467 1.0063128471374512 0.994744062423706
31_v proxy err 0.0029154818039387465 err 5.273301601409912 tr(WHW.T) 1808.723876953125
bpp_loss 4.058653831481934
31_q proxy err 0.0004832299309782684 err 22.313461303710938 tr(WHW.T) 46175.66015625
bpp_loss 4.177239894866943
31_k proxy err 0.00031856304849497974 err 6.520235061645508 tr(WHW.T) 20467.64453125
bpp_loss 4.876802444458008
o
31_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]29_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:43,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:50,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:39,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:02<04:55,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:46,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:36,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:05<04:51,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:36,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:44,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:33,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:08<04:48,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:33,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:40,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:30,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:11<04:45,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:37,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:27,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:14<04:42,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:34,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:36<04:24,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:17<04:39,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:24,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:31,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:39<04:21,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:20<04:35,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:21,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:28,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:42<04:18,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:23<04:32,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:18,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:26,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:45<04:15,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:26<04:30,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:48<04:12,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:29<04:27,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:51<04:09,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:32<04:25,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:11,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:15,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:54<04:06,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:35<04:22,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:12,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:57<04:03,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:38<04:19,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:09,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:04,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:00<04:05,  3.07s/it]31_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:41<04:16,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:06,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:00,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:03<04:01,  3.06s/it]31_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:44<04:13,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:03,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:02,  3.03s/it]28_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:06<03:57,  3.05s/it]31_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:47<04:10,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:01,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:57,  3.01s/it]28_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:09<03:53,  3.04s/it]31_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:50<04:07,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:53,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:03,  3.05s/it]28_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:12<03:50,  3.03s/it]31_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:53<04:05,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:49,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:59,  3.03s/it]28_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:15<03:47,  3.03s/it]31_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:56<04:02,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:46,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:55,  3.02s/it]28_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:18<03:43,  3.03s/it]31_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [00:59<04:04,  3.05s/it]29_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:42,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.01s/it]28_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:21<03:40,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:02<03:59,  3.03s/it]29_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:39,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:48,  3.01s/it]28_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:24<03:37,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:05<03:55,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:37,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:45,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:27<03:34,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:08<03:51,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:34,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:42,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:30<03:31,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:11<03:48,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:31,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:39,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:33<03:28,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:14<03:45,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:29,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:36,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:36<03:25,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:17<03:41,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:32,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:39<03:22,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:20<03:38,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:23,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:28,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:42<03:19,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:23<03:35,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:20,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:25,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:45<03:16,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:26<03:32,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:17,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:48<03:13,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:29<03:29,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:14,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:18,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:51<03:09,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:32<03:26,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:11,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:15,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:54<03:06,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:35<03:22,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:08,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:12,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:57<03:04,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:38<03:18,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:05,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:09,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:41<03:15,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:00<03:04,  3.08s/it]30_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:06,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:02,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:44<03:12,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:03<03:00,  3.06s/it]30_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:03,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:03,  3.05s/it]31_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:47<03:09,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:07<02:56,  3.05s/it]30_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:00,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:59,  3.04s/it]31_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:50<03:06,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:10<02:53,  3.04s/it]30_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:55,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:53<03:03,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:13<02:49,  3.03s/it]30_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:56,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:51,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [01:56<03:00,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:16<02:46,  3.03s/it]30_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:48,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [01:59<03:00,  3.02s/it]28_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:19<02:43,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:49,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:45,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:02<02:56,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:22<02:40,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:46,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:42,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:05<02:53,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:25<02:37,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:39,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:08<02:49,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:28<02:34,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:36,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:11<02:46,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:31<02:31,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:33,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:14<02:43,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:34<02:27,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:33,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:30,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:17<02:40,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:37<02:24,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:27,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:20<02:37,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:40<02:21,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:28,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:23,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:23<02:34,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:43<02:18,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:25,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:26<02:31,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:46<02:19,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:24,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:20,  3.06s/it]31_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:29<02:32,  3.05s/it]28_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:49<02:15,  3.08s/it]30_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]29_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:16,  3.04s/it]31_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:32<02:27,  3.02s/it]28_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:52<02:11,  3.06s/it]30_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:13,  3.03s/it]31_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:35<02:24,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:55<02:08,  3.05s/it]30_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:09,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:38<02:20,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:58<02:07,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:10,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:06,  3.01s/it]31_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:41<02:17,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:49<02:07,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:01<02:03,  3.08s/it]29_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:57<02:05,  3.07s/it]31_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:44<02:13,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:52<02:04,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:04<01:59,  3.06s/it]29_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:00<02:01,  3.05s/it]31_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:47<02:10,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:07<01:55,  3.05s/it]30_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:03,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:03<01:58,  3.03s/it]31_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:50<02:07,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<02:00,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:10<01:52,  3.04s/it]29_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:54,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [02:53<02:04,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:56,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:13<01:49,  3.03s/it]29_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:50,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [02:56<02:03,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:04<01:53,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:16<01:46,  3.03s/it]29_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:11<01:47,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [02:59<01:59,  3.00s/it]30_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:07<01:50,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:19<01:42,  3.03s/it]29_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:14<01:44,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:02<01:56,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:10<01:46,  2.97s/it]28_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:22<01:39,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:17<01:41,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:05<01:53,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:44,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:25<01:36,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:20<01:38,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:08<01:49,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:41,  2.98s/it]28_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:28<01:33,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:23<01:35,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:10<01:46,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:38,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:32<01:30,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:26<01:32,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:13<01:43,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:35,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:35<01:27,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:29<01:29,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:16<01:40,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:32,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:38<01:24,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:32<01:26,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:19<01:37,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:29,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:41<01:21,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:35<01:23,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:22<01:34,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:26,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:44<01:18,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:38<01:20,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:25<01:31,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:23,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:47<01:15,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:41<01:17,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:28<01:28,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:20,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:50<01:12,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:44<01:14,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:31<01:25,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:17,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:53<01:09,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:47<01:11,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:34<01:22,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:15,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:56<01:06,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:50<01:08,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:37<01:19,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:12,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:59<01:04,  3.07s/it]29_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:53<01:05,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:40<01:16,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:09,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:02<01:01,  3.05s/it]29_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:57<01:04,  3.05s/it]31_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:43<01:13,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:06,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:05<00:57,  3.04s/it]29_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:46<01:11,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:56<01:04,  3.06s/it]28_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:08<00:54,  3.03s/it]29_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.00s/it]31_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:49<01:08,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:59<01:00,  3.04s/it]28_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:11<00:51,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:53,  2.99s/it]31_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [03:52<01:05,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:02<00:57,  3.03s/it]28_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:14<00:48,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:50,  2.98s/it]31_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [03:55<01:03,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:05<00:54,  3.01s/it]28_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:17<00:45,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:47,  2.97s/it]31_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [03:58<00:59,  3.00s/it]30_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:08<00:51,  3.01s/it]28_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:20<00:42,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:44,  2.97s/it]31_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:01<00:56,  2.99s/it]30_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:11<00:48,  3.01s/it]28_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:23<00:39,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:04<00:53,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:14<00:45,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:26<00:36,  3.01s/it]29_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:20<00:38,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:07<00:50,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:17<00:41,  3.00s/it]28_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:29<00:33,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:23<00:35,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:10<00:47,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.99s/it]28_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:32<00:30,  3.02s/it]29_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:26<00:32,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:13<00:44,  2.97s/it]30_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.98s/it]29_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:29<00:29,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:35<00:27,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:16<00:41,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:32<00:26,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:38<00:24,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:19<00:38,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:35<00:23,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:41<00:21,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:22<00:35,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.97s/it]29_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:38<00:20,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:25<00:32,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:44<00:18,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:41<00:17,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:28<00:29,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:47<00:15,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:37<00:20,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:44<00:14,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:31<00:26,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:50<00:12,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:40<00:17,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:47<00:11,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:34<00:23,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:53<00:09,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:43<00:14,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:50<00:08,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:36<00:20,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:56<00:06,  3.02s/it]30_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:46<00:11,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:53<00:05,  2.96s/it]31_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:39<00:17,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:59<00:03,  3.08s/it]30_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:49<00:08,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:56<00:03,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:42<00:14,  2.96s/it]28_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.07s/it]28_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:02<00:00,  3.03s/it]
30_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:52<00:05,  2.96s/it]29_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  3.00s/it]29_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:59<00:00,  2.99s/it]
31_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:45<00:11,  2.96s/it]30_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.02s/it]31_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [04:48<00:08,  2.98s/it]30_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.01s/it]30_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.99s/it]
31_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [04:51<00:05,  2.98s/it]31_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [04:55<00:03,  3.06s/it]31_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  3.05s/it]31_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [04:58<00:00,  2.98s/it]
-2.1130508685018867e-06 0.013047398999333382 -0.012304514646530151
0.9997422695159912 1.0123220682144165 0.9869512319564819
28_o proxy err 0.007645216770470142 err 19.200546264648438 tr(WHW.T) 2511.445556640625
bpp_loss 3.692756772041321
28_up proxy err 0.006445455830544233 err 66.04059600830078 tr(WHW.T) 10246.0703125
bpp_loss 3.6761207239968434
28_gate proxy err 0.002004590118303895 err 72.00680541992188 tr(WHW.T) 35920.9609375
bpp_loss 4.004050833838327
28_down proxy err 0.009046724066138268 err 65.22766876220703 tr(WHW.T) 7210.08740234375
bpp_loss 3.665893009730748
1.6809967746667098e-06 0.011132624000310898 -0.009897529147565365
0.9995522499084473 1.011146903038025 0.9896562099456787
29_o proxy err 0.006184001453220844 err 19.187997817993164 tr(WHW.T) 3102.844970703125
bpp_loss 3.740586757659912
29_up proxy err 0.005179456900805235 err 66.65187072753906 tr(WHW.T) 12868.505859375
bpp_loss 3.7069879940577914
29_gate proxy err 0.0018774957861751318 err 72.02913665771484 tr(WHW.T) 38364.47265625
bpp_loss 3.9928007466452464
29_down proxy err 0.008846884593367577 err 66.09086608886719 tr(WHW.T) 7470.5244140625
bpp_loss 3.6856788907732283
-6.456215260186582e-07 0.01047951728105545 -0.011246174573898315
0.999815821647644 1.011231541633606 0.9894196391105652
30_o proxy err 0.0040464927442371845 err 19.703081130981445 tr(WHW.T) 4869.1748046875
bpp_loss 3.825392961502075
30_up proxy err 0.003121675457805395 err 67.77530670166016 tr(WHW.T) 21711.1953125
bpp_loss 3.73421471459525
30_gate proxy err 0.0014070224715396762 err 73.10108184814453 tr(WHW.T) 51954.453125
bpp_loss 4.03825889314924
30_down proxy err 0.007372323889285326 err 64.95149230957031 tr(WHW.T) 8810.1787109375
bpp_loss 3.6925704138619557
-3.217940047761658e-08 0.01647980511188507 -0.017274225130677223
0.9994728565216064 1.0163116455078125 0.9832451343536377
31_o proxy err 0.00870710052549839 err 19.273876190185547 tr(WHW.T) 2213.58154296875
bpp_loss 3.7733914852142334
31_up proxy err 0.0010579921072348952 err 73.02202606201172 tr(WHW.T) 69019.4453125
bpp_loss 3.9195443221500943
31_gate proxy err 0.0005407559219747782 err 78.11357879638672 tr(WHW.T) 144452.5625
bpp_loss 4.2540420804704935
31_down proxy err 0.006597776897251606 err 65.71510314941406 tr(WHW.T) 9960.1884765625
bpp_loss 3.7242373057774136
I0408 11:55:58.094847 625612 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:55:58.095039 625612 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:55:58.095079 625612 utils.py:162] NumExpr defaulting to 16 threads.
I0408 11:55:58.411273 625612 config.py:54] PyTorch version 2.6.0 available.
W0408 11:55:58.615489 625612 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0408 11:55:58.727421 625612 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.46it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.46it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.89it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.16it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.27it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.19it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.41it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.11it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  9.39it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  9.45it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.30it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.30it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.36it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.34it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.44it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.38it/s]
I0408 11:56:01.555912 625612 hfize_llama.py:161] loaded layer 0
I0408 11:56:01.900483 625612 hfize_llama.py:161] loaded layer 1
I0408 11:56:02.258724 625612 hfize_llama.py:161] loaded layer 2
I0408 11:56:02.587907 625612 hfize_llama.py:161] loaded layer 3
I0408 11:56:02.890767 625612 hfize_llama.py:161] loaded layer 4
I0408 11:56:03.208469 625612 hfize_llama.py:161] loaded layer 5
I0408 11:56:03.510025 625612 hfize_llama.py:161] loaded layer 6
I0408 11:56:03.838500 625612 hfize_llama.py:161] loaded layer 7
I0408 11:56:04.103729 625612 hfize_llama.py:161] loaded layer 8
I0408 11:56:04.408416 625612 hfize_llama.py:161] loaded layer 9
I0408 11:56:04.713997 625612 hfize_llama.py:161] loaded layer 10
I0408 11:56:05.122686 625612 hfize_llama.py:161] loaded layer 11
I0408 11:56:05.441713 625612 hfize_llama.py:161] loaded layer 12
I0408 11:56:05.743885 625612 hfize_llama.py:161] loaded layer 13
I0408 11:56:06.061991 625612 hfize_llama.py:161] loaded layer 14
I0408 11:56:06.388914 625612 hfize_llama.py:161] loaded layer 15
I0408 11:56:06.795927 625612 hfize_llama.py:161] loaded layer 16
I0408 11:56:07.083415 625612 hfize_llama.py:161] loaded layer 17
I0408 11:56:07.392221 625612 hfize_llama.py:161] loaded layer 18
I0408 11:56:07.775201 625612 hfize_llama.py:161] loaded layer 19
I0408 11:56:08.186164 625612 hfize_llama.py:161] loaded layer 20
I0408 11:56:08.469180 625612 hfize_llama.py:161] loaded layer 21
I0408 11:56:08.789620 625612 hfize_llama.py:161] loaded layer 22
I0408 11:56:09.091420 625612 hfize_llama.py:161] loaded layer 23
I0408 11:56:09.346225 625612 hfize_llama.py:161] loaded layer 24
I0408 11:56:09.630945 625612 hfize_llama.py:161] loaded layer 25
I0408 11:56:09.937760 625612 hfize_llama.py:161] loaded layer 26
I0408 11:56:10.239418 625612 hfize_llama.py:161] loaded layer 27
I0408 11:56:10.593745 625612 hfize_llama.py:161] loaded layer 28
I0408 11:56:10.875762 625612 hfize_llama.py:161] loaded layer 29
I0408 11:56:11.142494 625612 hfize_llama.py:161] loaded layer 30
I0408 11:56:11.450198 625612 hfize_llama.py:161] loaded layer 31
I0408 11:56:11.450308 625612 hfize_llama.py:165] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:07,  1.27s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.02s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:03,  1.02it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:03<00:02,  1.05it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:04<00:01,  1.08it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:05<00:00,  1.13it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.32it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.14it/s]
I0408 11:56:53.695026 625612 hfize_llama.py:175] successfully loaded hfized model
I0408 11:56:58.766651 626421 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 11:56:58.766883 626421 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 11:56:58.766925 626421 utils.py:162] NumExpr defaulting to 16 threads.
W0408 11:56:59.113503 626421 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0408 11:56:59.458230 626421 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:05,  1.01it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:01<00:04,  1.00it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:04,  1.02s/it]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:04<00:03,  1.02s/it]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:05<00:02,  1.01s/it]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:06<00:00,  1.00it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.16it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.06it/s]
I0408 11:57:06.171082 626421 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.7018834352493286:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.7018834352493286:   1%|          | 1/141 [00:01<04:14,  1.81s/it]avg_loss = 1.9772607684135437:   1%|          | 1/141 [00:03<04:14,  1.81s/it]avg_loss = 1.9772607684135437:   1%|▏         | 2/141 [00:03<03:43,  1.61s/it]avg_loss = 2.1063206593195596:   1%|▏         | 2/141 [00:04<03:43,  1.61s/it]avg_loss = 2.1063206593195596:   2%|▏         | 3/141 [00:04<03:32,  1.54s/it]avg_loss = 2.049855649471283:   2%|▏         | 3/141 [00:06<03:32,  1.54s/it] avg_loss = 2.049855649471283:   3%|▎         | 4/141 [00:06<03:27,  1.51s/it]avg_loss = 1.995317006111145:   3%|▎         | 4/141 [00:07<03:27,  1.51s/it]avg_loss = 1.995317006111145:   4%|▎         | 5/141 [00:07<03:24,  1.50s/it]avg_loss = 1.8972045381863911:   4%|▎         | 5/141 [00:09<03:24,  1.50s/it]avg_loss = 1.8972045381863911:   4%|▍         | 6/141 [00:09<03:21,  1.49s/it]avg_loss = 1.8341222490583147:   4%|▍         | 6/141 [00:10<03:21,  1.49s/it]avg_loss = 1.8341222490583147:   5%|▍         | 7/141 [00:10<03:19,  1.49s/it]avg_loss = 1.8266480416059494:   5%|▍         | 7/141 [00:12<03:19,  1.49s/it]avg_loss = 1.8266480416059494:   6%|▌         | 8/141 [00:12<03:18,  1.49s/it]avg_loss = 1.858077300919427:   6%|▌         | 8/141 [00:13<03:18,  1.49s/it] avg_loss = 1.858077300919427:   6%|▋         | 9/141 [00:13<03:17,  1.49s/it]avg_loss = 1.8596891283988952:   6%|▋         | 9/141 [00:15<03:17,  1.49s/it]avg_loss = 1.8596891283988952:   7%|▋         | 10/141 [00:15<03:15,  1.49s/it]avg_loss = 1.852819648655978:   7%|▋         | 10/141 [00:16<03:15,  1.49s/it] avg_loss = 1.852819648655978:   8%|▊         | 11/141 [00:16<03:14,  1.49s/it]avg_loss = 1.8757770359516144:   8%|▊         | 11/141 [00:18<03:14,  1.49s/it]avg_loss = 1.8757770359516144:   9%|▊         | 12/141 [00:18<03:12,  1.50s/it]avg_loss = 1.888565494463994:   9%|▊         | 12/141 [00:19<03:12,  1.50s/it] avg_loss = 1.888565494463994:   9%|▉         | 13/141 [00:19<03:11,  1.50s/it]avg_loss = 1.9061724032674516:   9%|▉         | 13/141 [00:21<03:11,  1.50s/it]avg_loss = 1.9061724032674516:  10%|▉         | 14/141 [00:21<03:10,  1.50s/it]avg_loss = 1.916252319018046:  10%|▉         | 14/141 [00:22<03:10,  1.50s/it] avg_loss = 1.916252319018046:  11%|█         | 15/141 [00:22<03:09,  1.50s/it]avg_loss = 1.9412590190768242:  11%|█         | 15/141 [00:24<03:09,  1.50s/it]avg_loss = 1.9412590190768242:  11%|█▏        | 16/141 [00:24<03:08,  1.51s/it]avg_loss = 1.943957854719723:  11%|█▏        | 16/141 [00:25<03:08,  1.51s/it] avg_loss = 1.943957854719723:  12%|█▏        | 17/141 [00:25<03:07,  1.51s/it]avg_loss = 1.9477353427145216:  12%|█▏        | 17/141 [00:27<03:07,  1.51s/it]avg_loss = 1.9477353427145216:  13%|█▎        | 18/141 [00:27<03:06,  1.51s/it]avg_loss = 1.934685744737324:  13%|█▎        | 18/141 [00:28<03:06,  1.51s/it] avg_loss = 1.934685744737324:  13%|█▎        | 19/141 [00:28<03:04,  1.52s/it]avg_loss = 1.9338662922382355:  13%|█▎        | 19/141 [00:30<03:04,  1.52s/it]avg_loss = 1.9338662922382355:  14%|█▍        | 20/141 [00:30<03:03,  1.52s/it]avg_loss = 1.9387379998252505:  14%|█▍        | 20/141 [00:31<03:03,  1.52s/it]avg_loss = 1.9387379998252505:  15%|█▍        | 21/141 [00:31<03:02,  1.52s/it]avg_loss = 1.94089552489194:  15%|█▍        | 21/141 [00:33<03:02,  1.52s/it]  avg_loss = 1.94089552489194:  16%|█▌        | 22/141 [00:33<03:01,  1.52s/it]avg_loss = 1.9428509007329526:  16%|█▌        | 22/141 [00:34<03:01,  1.52s/it]avg_loss = 1.9428509007329526:  16%|█▋        | 23/141 [00:34<02:59,  1.52s/it]avg_loss = 1.9482712944348652:  16%|█▋        | 23/141 [00:36<02:59,  1.52s/it]avg_loss = 1.9482712944348652:  17%|█▋        | 24/141 [00:36<02:58,  1.52s/it]avg_loss = 1.9541521739959717:  17%|█▋        | 24/141 [00:37<02:58,  1.52s/it]avg_loss = 1.9541521739959717:  18%|█▊        | 25/141 [00:37<02:56,  1.52s/it]avg_loss = 1.965149109180157:  18%|█▊        | 25/141 [00:39<02:56,  1.52s/it] avg_loss = 1.965149109180157:  18%|█▊        | 26/141 [00:39<02:55,  1.53s/it]avg_loss = 1.977610711698179:  18%|█▊        | 26/141 [00:40<02:55,  1.53s/it]avg_loss = 1.977610711698179:  19%|█▉        | 27/141 [00:40<02:54,  1.53s/it]avg_loss = 1.9835082803453719:  19%|█▉        | 27/141 [00:42<02:54,  1.53s/it]avg_loss = 1.9835082803453719:  20%|█▉        | 28/141 [00:42<02:52,  1.53s/it]avg_loss = 1.9796489477157593:  20%|█▉        | 28/141 [00:43<02:52,  1.53s/it]avg_loss = 1.9796489477157593:  21%|██        | 29/141 [00:43<02:51,  1.53s/it]avg_loss = 1.9699573397636414:  21%|██        | 29/141 [00:45<02:51,  1.53s/it]avg_loss = 1.9699573397636414:  21%|██▏       | 30/141 [00:45<02:49,  1.53s/it]avg_loss = 1.9568163733328543:  21%|██▏       | 30/141 [00:47<02:49,  1.53s/it]avg_loss = 1.9568163733328543:  22%|██▏       | 31/141 [00:47<02:48,  1.53s/it]avg_loss = 1.9453377611935139:  22%|██▏       | 31/141 [00:48<02:48,  1.53s/it]avg_loss = 1.9453377611935139:  23%|██▎       | 32/141 [00:48<02:47,  1.53s/it]avg_loss = 1.943528074206728:  23%|██▎       | 32/141 [00:50<02:47,  1.53s/it] avg_loss = 1.943528074206728:  23%|██▎       | 33/141 [00:50<02:45,  1.53s/it]avg_loss = 1.942057539434994:  23%|██▎       | 33/141 [00:51<02:45,  1.53s/it]avg_loss = 1.942057539434994:  24%|██▍       | 34/141 [00:51<02:44,  1.54s/it]avg_loss = 1.9447821140289308:  24%|██▍       | 34/141 [00:53<02:44,  1.54s/it]avg_loss = 1.9447821140289308:  25%|██▍       | 35/141 [00:53<02:43,  1.54s/it]avg_loss = 1.927901609076394:  25%|██▍       | 35/141 [00:54<02:43,  1.54s/it] avg_loss = 1.927901609076394:  26%|██▌       | 36/141 [00:54<02:41,  1.54s/it]avg_loss = 1.9118283825951654:  26%|██▌       | 36/141 [00:56<02:41,  1.54s/it]avg_loss = 1.9118283825951654:  26%|██▌       | 37/141 [00:56<02:40,  1.54s/it]avg_loss = 1.8965075517955579:  26%|██▌       | 37/141 [00:57<02:40,  1.54s/it]avg_loss = 1.8965075517955579:  27%|██▋       | 38/141 [00:57<02:38,  1.54s/it]avg_loss = 1.8820063059146588:  27%|██▋       | 38/141 [00:59<02:38,  1.54s/it]avg_loss = 1.8820063059146588:  28%|██▊       | 39/141 [00:59<02:37,  1.54s/it]avg_loss = 1.8732468247413636:  28%|██▊       | 39/141 [01:00<02:37,  1.54s/it]avg_loss = 1.8732468247413636:  28%|██▊       | 40/141 [01:00<02:36,  1.55s/it]avg_loss = 1.878070924340225:  28%|██▊       | 40/141 [01:02<02:36,  1.55s/it] avg_loss = 1.878070924340225:  29%|██▉       | 41/141 [01:02<02:34,  1.55s/it]avg_loss = 1.894394840512957:  29%|██▉       | 41/141 [01:04<02:34,  1.55s/it]avg_loss = 1.894394840512957:  30%|██▉       | 42/141 [01:04<02:33,  1.55s/it]avg_loss = 1.9108293444611306:  30%|██▉       | 42/141 [01:05<02:33,  1.55s/it]avg_loss = 1.9108293444611306:  30%|███       | 43/141 [01:05<02:31,  1.55s/it]avg_loss = 1.9150570305910977:  30%|███       | 43/141 [01:07<02:31,  1.55s/it]avg_loss = 1.9150570305910977:  31%|███       | 44/141 [01:07<02:30,  1.55s/it]avg_loss = 1.9199628988901773:  31%|███       | 44/141 [01:08<02:30,  1.55s/it]avg_loss = 1.9199628988901773:  32%|███▏      | 45/141 [01:08<02:28,  1.55s/it]avg_loss = 1.924978950749273:  32%|███▏      | 45/141 [01:10<02:28,  1.55s/it] avg_loss = 1.924978950749273:  33%|███▎      | 46/141 [01:10<02:27,  1.55s/it]avg_loss = 1.931463895960057:  33%|███▎      | 46/141 [01:11<02:27,  1.55s/it]avg_loss = 1.931463895960057:  33%|███▎      | 47/141 [01:11<02:26,  1.55s/it]avg_loss = 1.9348054726918538:  33%|███▎      | 47/141 [01:13<02:26,  1.55s/it]avg_loss = 1.9348054726918538:  34%|███▍      | 48/141 [01:13<02:24,  1.56s/it]avg_loss = 1.9338790616210626:  34%|███▍      | 48/141 [01:14<02:24,  1.56s/it]avg_loss = 1.9338790616210626:  35%|███▍      | 49/141 [01:14<02:23,  1.56s/it]avg_loss = 1.9338848662376404:  35%|███▍      | 49/141 [01:16<02:23,  1.56s/it]avg_loss = 1.9338848662376404:  35%|███▌      | 50/141 [01:16<02:21,  1.56s/it]avg_loss = 1.9274569352467854:  35%|███▌      | 50/141 [01:18<02:21,  1.56s/it]avg_loss = 1.9274569352467854:  36%|███▌      | 51/141 [01:18<02:20,  1.56s/it]avg_loss = 1.9232737146891081:  36%|███▌      | 51/141 [01:19<02:20,  1.56s/it]avg_loss = 1.9232737146891081:  37%|███▋      | 52/141 [01:19<02:18,  1.56s/it]avg_loss = 1.9166782104744102:  37%|███▋      | 52/141 [01:21<02:18,  1.56s/it]avg_loss = 1.9166782104744102:  38%|███▊      | 53/141 [01:21<02:17,  1.56s/it]avg_loss = 1.9134862665776853:  38%|███▊      | 53/141 [01:22<02:17,  1.56s/it]avg_loss = 1.9134862665776853:  38%|███▊      | 54/141 [01:22<02:15,  1.56s/it]avg_loss = 1.9058253028176046:  38%|███▊      | 54/141 [01:24<02:15,  1.56s/it]avg_loss = 1.9058253028176046:  39%|███▉      | 55/141 [01:24<02:14,  1.56s/it]avg_loss = 1.8980680469955717:  39%|███▉      | 55/141 [01:25<02:14,  1.56s/it]avg_loss = 1.8980680469955717:  40%|███▉      | 56/141 [01:25<02:12,  1.56s/it]avg_loss = 1.893286851414463:  40%|███▉      | 56/141 [01:27<02:12,  1.56s/it] avg_loss = 1.893286851414463:  40%|████      | 57/141 [01:27<02:11,  1.57s/it]avg_loss = 1.890305352622065:  40%|████      | 57/141 [01:29<02:11,  1.57s/it]avg_loss = 1.890305352622065:  41%|████      | 58/141 [01:29<02:09,  1.57s/it]avg_loss = 1.8924247188083196:  41%|████      | 58/141 [01:30<02:09,  1.57s/it]avg_loss = 1.8924247188083196:  42%|████▏     | 59/141 [01:30<02:08,  1.57s/it]avg_loss = 1.8979196091492971:  42%|████▏     | 59/141 [01:32<02:08,  1.57s/it]avg_loss = 1.8979196091492971:  43%|████▎     | 60/141 [01:32<02:06,  1.57s/it]avg_loss = 1.903405574501538:  43%|████▎     | 60/141 [01:33<02:06,  1.57s/it] avg_loss = 1.903405574501538:  43%|████▎     | 61/141 [01:33<02:05,  1.57s/it]avg_loss = 1.9106386611538548:  43%|████▎     | 61/141 [01:35<02:05,  1.57s/it]avg_loss = 1.9106386611538548:  44%|████▍     | 62/141 [01:35<02:03,  1.57s/it]avg_loss = 1.9018853089166066:  44%|████▍     | 62/141 [01:36<02:03,  1.57s/it]avg_loss = 1.9018853089166066:  45%|████▍     | 63/141 [01:36<02:02,  1.57s/it]avg_loss = 1.899808343499899:  45%|████▍     | 63/141 [01:38<02:02,  1.57s/it] avg_loss = 1.899808343499899:  45%|████▌     | 64/141 [01:38<02:00,  1.57s/it]avg_loss = 1.897452372771043:  45%|████▌     | 64/141 [01:39<02:00,  1.57s/it]avg_loss = 1.897452372771043:  46%|████▌     | 65/141 [01:39<01:59,  1.57s/it]avg_loss = 1.8916444290768017:  46%|████▌     | 65/141 [01:41<01:59,  1.57s/it]avg_loss = 1.8916444290768017:  47%|████▋     | 66/141 [01:41<01:57,  1.57s/it]avg_loss = 1.8891302026919465:  47%|████▋     | 66/141 [01:43<01:57,  1.57s/it]avg_loss = 1.8891302026919465:  48%|████▊     | 67/141 [01:43<01:56,  1.57s/it]avg_loss = 1.886263891178019:  48%|████▊     | 67/141 [01:44<01:56,  1.57s/it] avg_loss = 1.886263891178019:  48%|████▊     | 68/141 [01:44<01:54,  1.57s/it]avg_loss = 1.8833058709683625:  48%|████▊     | 68/141 [01:46<01:54,  1.57s/it]avg_loss = 1.8833058709683625:  49%|████▉     | 69/141 [01:46<01:53,  1.57s/it]avg_loss = 1.8843123980930874:  49%|████▉     | 69/141 [01:47<01:53,  1.57s/it]avg_loss = 1.8843123980930874:  50%|████▉     | 70/141 [01:47<01:51,  1.57s/it]avg_loss = 1.8879638826343375:  50%|████▉     | 70/141 [01:49<01:51,  1.57s/it]avg_loss = 1.8879638826343375:  50%|█████     | 71/141 [01:49<01:50,  1.57s/it]avg_loss = 1.8905497822496626:  50%|█████     | 71/141 [01:51<01:50,  1.57s/it]avg_loss = 1.8905497822496626:  51%|█████     | 72/141 [01:51<01:48,  1.57s/it]avg_loss = 1.8889949370736945:  51%|█████     | 72/141 [01:52<01:48,  1.57s/it]avg_loss = 1.8889949370736945:  52%|█████▏    | 73/141 [01:52<01:47,  1.58s/it]avg_loss = 1.8906555256328068:  52%|█████▏    | 73/141 [01:54<01:47,  1.58s/it]avg_loss = 1.8906555256328068:  52%|█████▏    | 74/141 [01:54<01:45,  1.58s/it]avg_loss = 1.8907476154963176:  52%|█████▏    | 74/141 [01:55<01:45,  1.58s/it]avg_loss = 1.8907476154963176:  53%|█████▎    | 75/141 [01:55<01:44,  1.58s/it]avg_loss = 1.889600738098747:  53%|█████▎    | 75/141 [01:57<01:44,  1.58s/it] avg_loss = 1.889600738098747:  54%|█████▍    | 76/141 [01:57<01:42,  1.58s/it]avg_loss = 1.89066498310535:  54%|█████▍    | 76/141 [01:58<01:42,  1.58s/it] avg_loss = 1.89066498310535:  55%|█████▍    | 77/141 [01:58<01:40,  1.58s/it]avg_loss = 1.8929806030713594:  55%|█████▍    | 77/141 [02:00<01:40,  1.58s/it]avg_loss = 1.8929806030713594:  55%|█████▌    | 78/141 [02:00<01:39,  1.58s/it]avg_loss = 1.8968206025377106:  55%|█████▌    | 78/141 [02:02<01:39,  1.58s/it]avg_loss = 1.8968206025377106:  56%|█████▌    | 79/141 [02:02<01:37,  1.58s/it]avg_loss = 1.8935484379529952:  56%|█████▌    | 79/141 [02:03<01:37,  1.58s/it]avg_loss = 1.8935484379529952:  57%|█████▋    | 80/141 [02:03<01:36,  1.58s/it]avg_loss = 1.8921253077777815:  57%|█████▋    | 80/141 [02:05<01:36,  1.58s/it]avg_loss = 1.8921253077777815:  57%|█████▋    | 81/141 [02:05<01:34,  1.58s/it]avg_loss = 1.8911964442671798:  57%|█████▋    | 81/141 [02:06<01:34,  1.58s/it]avg_loss = 1.8911964442671798:  58%|█████▊    | 82/141 [02:06<01:33,  1.58s/it]avg_loss = 1.8894026868314628:  58%|█████▊    | 82/141 [02:08<01:33,  1.58s/it]avg_loss = 1.8894026868314628:  59%|█████▉    | 83/141 [02:08<01:31,  1.58s/it]avg_loss = 1.8869993204162234:  59%|█████▉    | 83/141 [02:09<01:31,  1.58s/it]avg_loss = 1.8869993204162234:  60%|█████▉    | 84/141 [02:09<01:29,  1.58s/it]avg_loss = 1.8845143766964183:  60%|█████▉    | 84/141 [02:11<01:29,  1.58s/it]avg_loss = 1.8845143766964183:  60%|██████    | 85/141 [02:11<01:28,  1.58s/it]avg_loss = 1.8859692756519761:  60%|██████    | 85/141 [02:13<01:28,  1.58s/it]avg_loss = 1.8859692756519761:  61%|██████    | 86/141 [02:13<01:26,  1.58s/it]avg_loss = 1.8875757031057072:  61%|██████    | 86/141 [02:14<01:26,  1.58s/it]avg_loss = 1.8875757031057072:  62%|██████▏   | 87/141 [02:14<01:25,  1.58s/it]avg_loss = 1.8883955465121702:  62%|██████▏   | 87/141 [02:16<01:25,  1.58s/it]avg_loss = 1.8883955465121702:  62%|██████▏   | 88/141 [02:16<01:23,  1.58s/it]avg_loss = 1.8971403221066079:  62%|██████▏   | 88/141 [02:17<01:23,  1.58s/it]avg_loss = 1.8971403221066079:  63%|██████▎   | 89/141 [02:17<01:22,  1.58s/it]avg_loss = 1.904788315296173:  63%|██████▎   | 89/141 [02:19<01:22,  1.58s/it] avg_loss = 1.904788315296173:  64%|██████▍   | 90/141 [02:19<01:20,  1.58s/it]avg_loss = 1.907867280991523:  64%|██████▍   | 90/141 [02:21<01:20,  1.58s/it]avg_loss = 1.907867280991523:  65%|██████▍   | 91/141 [02:21<01:19,  1.58s/it]avg_loss = 1.9129390288954196:  65%|██████▍   | 91/141 [02:22<01:19,  1.58s/it]avg_loss = 1.9129390288954196:  65%|██████▌   | 92/141 [02:22<01:17,  1.58s/it]avg_loss = 1.9181290864944458:  65%|██████▌   | 92/141 [02:24<01:17,  1.58s/it]avg_loss = 1.9181290864944458:  66%|██████▌   | 93/141 [02:24<01:15,  1.58s/it]avg_loss = 1.9190601807959535:  66%|██████▌   | 93/141 [02:25<01:15,  1.58s/it]avg_loss = 1.9190601807959535:  67%|██████▋   | 94/141 [02:25<01:14,  1.58s/it]avg_loss = 1.9226772923218576:  67%|██████▋   | 94/141 [02:27<01:14,  1.58s/it]avg_loss = 1.9226772923218576:  67%|██████▋   | 95/141 [02:27<01:12,  1.58s/it]avg_loss = 1.9234071485698223:  67%|██████▋   | 95/141 [02:28<01:12,  1.58s/it]avg_loss = 1.9234071485698223:  68%|██████▊   | 96/141 [02:28<01:11,  1.58s/it]avg_loss = 1.9252208692511332:  68%|██████▊   | 96/141 [02:30<01:11,  1.58s/it]avg_loss = 1.9252208692511332:  69%|██████▉   | 97/141 [02:30<01:09,  1.58s/it]avg_loss = 1.921898024422782:  69%|██████▉   | 97/141 [02:32<01:09,  1.58s/it] avg_loss = 1.921898024422782:  70%|██████▉   | 98/141 [02:32<01:08,  1.58s/it]avg_loss = 1.9230945351147892:  70%|██████▉   | 98/141 [02:33<01:08,  1.58s/it]avg_loss = 1.9230945351147892:  70%|███████   | 99/141 [02:33<01:06,  1.58s/it]avg_loss = 1.925423228740692:  70%|███████   | 99/141 [02:35<01:06,  1.58s/it] avg_loss = 1.925423228740692:  71%|███████   | 100/141 [02:35<01:04,  1.58s/it]avg_loss = 1.9245198481153734:  71%|███████   | 100/141 [02:36<01:04,  1.58s/it]avg_loss = 1.9245198481153734:  72%|███████▏  | 101/141 [02:36<01:03,  1.58s/it]avg_loss = 1.924896429566776:  72%|███████▏  | 101/141 [02:38<01:03,  1.58s/it] avg_loss = 1.924896429566776:  72%|███████▏  | 102/141 [02:38<01:01,  1.58s/it]avg_loss = 1.9237738037572323:  72%|███████▏  | 102/141 [02:40<01:01,  1.58s/it]avg_loss = 1.9237738037572323:  73%|███████▎  | 103/141 [02:40<01:00,  1.58s/it]avg_loss = 1.9266732667501156:  73%|███████▎  | 103/141 [02:41<01:00,  1.58s/it]avg_loss = 1.9266732667501156:  74%|███████▍  | 104/141 [02:41<00:58,  1.58s/it]avg_loss = 1.925691430909293:  74%|███████▍  | 104/141 [02:43<00:58,  1.58s/it] avg_loss = 1.925691430909293:  74%|███████▍  | 105/141 [02:43<00:56,  1.58s/it]avg_loss = 1.9248547194139012:  74%|███████▍  | 105/141 [02:44<00:56,  1.58s/it]avg_loss = 1.9248547194139012:  75%|███████▌  | 106/141 [02:44<00:55,  1.58s/it]avg_loss = 1.9225922143347909:  75%|███████▌  | 106/141 [02:46<00:55,  1.58s/it]avg_loss = 1.9225922143347909:  76%|███████▌  | 107/141 [02:46<00:53,  1.58s/it]avg_loss = 1.9203802049160004:  76%|███████▌  | 107/141 [02:47<00:53,  1.58s/it]avg_loss = 1.9203802049160004:  77%|███████▋  | 108/141 [02:47<00:52,  1.58s/it]avg_loss = 1.9180669511130097:  77%|███████▋  | 108/141 [02:49<00:52,  1.58s/it]avg_loss = 1.9180669511130097:  77%|███████▋  | 109/141 [02:49<00:50,  1.58s/it]avg_loss = 1.9155574852770025:  77%|███████▋  | 109/141 [02:51<00:50,  1.58s/it]avg_loss = 1.9155574852770025:  78%|███████▊  | 110/141 [02:51<00:49,  1.58s/it]avg_loss = 1.9178585651758555:  78%|███████▊  | 110/141 [02:52<00:49,  1.58s/it]avg_loss = 1.9178585651758555:  79%|███████▊  | 111/141 [02:52<00:47,  1.59s/it]avg_loss = 1.9176530508058411:  79%|███████▊  | 111/141 [02:54<00:47,  1.59s/it]avg_loss = 1.9176530508058411:  79%|███████▉  | 112/141 [02:54<00:45,  1.59s/it]avg_loss = 1.9188169093258614:  79%|███████▉  | 112/141 [02:55<00:45,  1.59s/it]avg_loss = 1.9188169093258614:  80%|████████  | 113/141 [02:55<00:44,  1.59s/it]avg_loss = 1.9196831960427134:  80%|████████  | 113/141 [02:57<00:44,  1.59s/it]avg_loss = 1.9196831960427134:  81%|████████  | 114/141 [02:57<00:42,  1.59s/it]avg_loss = 1.9187549000201019:  81%|████████  | 114/141 [02:59<00:42,  1.59s/it]avg_loss = 1.9187549000201019:  82%|████████▏ | 115/141 [02:59<00:41,  1.59s/it]avg_loss = 1.9174581468105316:  82%|████████▏ | 115/141 [03:00<00:41,  1.59s/it]avg_loss = 1.9174581468105316:  82%|████████▏ | 116/141 [03:00<00:39,  1.58s/it]avg_loss = 1.9195641136576986:  82%|████████▏ | 116/141 [03:02<00:39,  1.58s/it]avg_loss = 1.9195641136576986:  83%|████████▎ | 117/141 [03:02<00:38,  1.59s/it]avg_loss = 1.9191062854508223:  83%|████████▎ | 117/141 [03:03<00:38,  1.59s/it]avg_loss = 1.9191062854508223:  84%|████████▎ | 118/141 [03:03<00:36,  1.59s/it]avg_loss = 1.9176642213548933:  84%|████████▎ | 118/141 [03:05<00:36,  1.59s/it]avg_loss = 1.9176642213548933:  84%|████████▍ | 119/141 [03:05<00:34,  1.59s/it]avg_loss = 1.9158492346604665:  84%|████████▍ | 119/141 [03:06<00:34,  1.59s/it]avg_loss = 1.9158492346604665:  85%|████████▌ | 120/141 [03:06<00:33,  1.59s/it]avg_loss = 1.9156135813263822:  85%|████████▌ | 120/141 [03:08<00:33,  1.59s/it]avg_loss = 1.9156135813263822:  86%|████████▌ | 121/141 [03:08<00:31,  1.59s/it]avg_loss = 1.9160175665480192:  86%|████████▌ | 121/141 [03:10<00:31,  1.59s/it]avg_loss = 1.9160175665480192:  87%|████████▋ | 122/141 [03:10<00:30,  1.59s/it]avg_loss = 1.9158039529149125:  87%|████████▋ | 122/141 [03:11<00:30,  1.59s/it]avg_loss = 1.9158039529149125:  87%|████████▋ | 123/141 [03:11<00:28,  1.59s/it]avg_loss = 1.9159500589293819:  87%|████████▋ | 123/141 [03:13<00:28,  1.59s/it]avg_loss = 1.9159500589293819:  88%|████████▊ | 124/141 [03:13<00:26,  1.59s/it]avg_loss = 1.914713846206665:  88%|████████▊ | 124/141 [03:14<00:26,  1.59s/it] avg_loss = 1.914713846206665:  89%|████████▊ | 125/141 [03:14<00:25,  1.58s/it]avg_loss = 1.9150285238311404:  89%|████████▊ | 125/141 [03:16<00:25,  1.58s/it]avg_loss = 1.9150285238311404:  89%|████████▉ | 126/141 [03:16<00:23,  1.58s/it]avg_loss = 1.9146899050614965:  89%|████████▉ | 126/141 [03:18<00:23,  1.58s/it]avg_loss = 1.9146899050614965:  90%|█████████ | 127/141 [03:18<00:22,  1.59s/it]avg_loss = 1.913419583812356:  90%|█████████ | 127/141 [03:19<00:22,  1.59s/it] avg_loss = 1.913419583812356:  91%|█████████ | 128/141 [03:19<00:20,  1.59s/it]avg_loss = 1.9134922351023949:  91%|█████████ | 128/141 [03:21<00:20,  1.59s/it]avg_loss = 1.9134922351023949:  91%|█████████▏| 129/141 [03:21<00:19,  1.59s/it]avg_loss = 1.9142326914347134:  91%|█████████▏| 129/141 [03:22<00:19,  1.59s/it]avg_loss = 1.9142326914347134:  92%|█████████▏| 130/141 [03:22<00:17,  1.59s/it]avg_loss = 1.9151633395493486:  92%|█████████▏| 130/141 [03:24<00:17,  1.59s/it]avg_loss = 1.9151633395493486:  93%|█████████▎| 131/141 [03:24<00:15,  1.59s/it]avg_loss = 1.915616051717238:  93%|█████████▎| 131/141 [03:25<00:15,  1.59s/it] avg_loss = 1.915616051717238:  94%|█████████▎| 132/141 [03:25<00:14,  1.59s/it]avg_loss = 1.9125482211435647:  94%|█████████▎| 132/141 [03:27<00:14,  1.59s/it]avg_loss = 1.9125482211435647:  94%|█████████▍| 133/141 [03:27<00:12,  1.59s/it]avg_loss = 1.9080549576389256:  94%|█████████▍| 133/141 [03:29<00:12,  1.59s/it]avg_loss = 1.9080549576389256:  95%|█████████▌| 134/141 [03:29<00:11,  1.59s/it]avg_loss = 1.9104450870443273:  95%|█████████▌| 134/141 [03:30<00:11,  1.59s/it]avg_loss = 1.9104450870443273:  96%|█████████▌| 135/141 [03:30<00:09,  1.59s/it]avg_loss = 1.9139194199267555:  96%|█████████▌| 135/141 [03:32<00:09,  1.59s/it]avg_loss = 1.9139194199267555:  96%|█████████▋| 136/141 [03:32<00:07,  1.59s/it]avg_loss = 1.9152043118094007:  96%|█████████▋| 136/141 [03:33<00:07,  1.59s/it]avg_loss = 1.9152043118094007:  97%|█████████▋| 137/141 [03:33<00:06,  1.59s/it]avg_loss = 1.9139755998832593:  97%|█████████▋| 137/141 [03:35<00:06,  1.59s/it]avg_loss = 1.9139755998832593:  98%|█████████▊| 138/141 [03:35<00:04,  1.59s/it]avg_loss = 1.914293856929532:  98%|█████████▊| 138/141 [03:37<00:04,  1.59s/it] avg_loss = 1.914293856929532:  99%|█████████▊| 139/141 [03:37<00:03,  1.59s/it]avg_loss = 1.9150352937834603:  99%|█████████▊| 139/141 [03:38<00:03,  1.59s/it]avg_loss = 1.9150352937834603:  99%|█████████▉| 140/141 [03:38<00:01,  1.59s/it]avg_loss = 1.9163023816778304:  99%|█████████▉| 140/141 [03:40<00:01,  1.59s/it]avg_loss = 1.9163023816778304: 100%|██████████| 141/141 [03:40<00:00,  1.59s/it]avg_loss = 1.9163023816778304: 100%|██████████| 141/141 [03:40<00:00,  1.56s/it]
I0408 12:01:11.623692 626421 eval_ppl.py:107] wikitext2 perplexity: 6.795783519744873
wikitext2 perplexity: 6.796
