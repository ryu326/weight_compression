I0408 12:54:41.651062 650138 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 12:54:41.651165 650138 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 12:54:41.651203 650138 utils.py:162] NumExpr defaulting to 16 threads.
I0408 12:54:41.973738 650138 config.py:54] PyTorch version 2.6.0 available.
W0408 12:54:42.162735 650138 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 12:54:42.807312 650138 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.19it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  7.62it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  7.69it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  7.40it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  7.64it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  7.76it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.95it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  7.74it/s]
I0408 12:54:44.283603 650138 quantize_finetune_llama.py:158] loaded model
calculating model weight mean & std:   0%|          | 0/32 [00:00<?, ?it/s]calculating model weight mean & std: 100%|██████████| 32/32 [00:00<00:00, 17845.73it/s]
I0408 12:54:49.903337 650138 quantize_finetune_llama.py:196] loaded compression model
I0408 12:55:07.870982 650138 quantize_finetune_llama.py:200] loaded dataset and devset
I0408 12:55:13.845633 650138 quantize_finetune_llama.py:220] layer 0 gpu 0
I0408 12:55:17.758573 650138 quantize_finetune_llama.py:251] computed original embedding for layer 0 in 3.7661385536193848s
tensor(-4.7143e-06) tensor(0.0125)
tensor(0.0125) tensor(-4.7143e-06)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
I0408 12:55:35.378697 650840 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 12:55:35.378798 650840 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 12:55:35.378837 650840 utils.py:162] NumExpr defaulting to 16 threads.
I0408 12:55:35.702321 650840 config.py:54] PyTorch version 2.6.0 available.
W0408 12:55:35.889839 650840 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 12:55:36.445502 650840 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 12:55:36.449292 650138 quantize_finetune_llama.py:220] layer 1 gpu 1
I0408 12:55:36.462703 650840 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
0_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]0_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.83it/s]0_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.59it/s]0_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.98it/s]0_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.19it/s]0_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.32it/s]0_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.40it/s]0_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.46it/s]0_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]0_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.52it/s]0_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.54it/s]0_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.55it/s]I0408 12:55:40.332986 650138 quantize_finetune_llama.py:251] computed original embedding for layer 1 in 3.7030036449432373s
0_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.53it/s]0_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.53it/s]0_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.54it/s]0_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.52it/s]0_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.52it/s]0_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.51it/s]0_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.54it/s]0_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]0_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.58it/s]0_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.59it/s]0_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.57it/s]0_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.54it/s]I0408 12:55:43.912936 650990 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 12:55:43.913037 650990 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 12:55:43.913074 650990 utils.py:162] NumExpr defaulting to 16 threads.
0_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.55it/s]I0408 12:55:44.233655 650990 config.py:54] PyTorch version 2.6.0 available.
0_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.58it/s]W0408 12:55:44.421749 650990 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

0_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.58it/s]0_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.58it/s]W0408 12:55:44.995769 650990 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 12:55:44.999753 650138 quantize_finetune_llama.py:220] layer 2 gpu 2
I0408 12:55:45.013728 650990 data_utils.py:336] using 256 training seqs, 128 validation seqs
0_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.55it/s]0_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.53it/s]v
1_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]0_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.53it/s]0_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.55it/s]1_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.74it/s]0_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.57it/s]1_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.52it/s]0_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.57it/s]1_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.94it/s]0_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.57it/s]1_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.19it/s]0_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.57it/s]1_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.33it/s]0_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.57it/s]1_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.44it/s]0_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.56it/s]1_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.52it/s]0_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.56it/s]1_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.57it/s]0_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.56it/s]1_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.60it/s]I0408 12:55:48.282321 650138 quantize_finetune_llama.py:251] computed original embedding for layer 2 in 3.127689838409424s
0_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.59it/s]0_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.59it/s]0_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.51it/s]1_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.61it/s]0_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.50it/s]1_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.62it/s]1_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.51it/s]1_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:22,  3.65it/s]0_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.53it/s]1_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.62it/s]0_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.53it/s]1_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:21,  3.65it/s]0_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:21,  3.66it/s]0_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.52it/s]I0408 12:55:51.801773 651167 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 12:55:51.801873 651167 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 12:55:51.801913 651167 utils.py:162] NumExpr defaulting to 16 threads.
1_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.65it/s]I0408 12:55:52.126531 651167 config.py:54] PyTorch version 2.6.0 available.
0_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.53it/s]W0408 12:55:52.313184 651167 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

1_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:20,  3.63it/s]0_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.65it/s]0_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.54it/s]W0408 12:55:52.854181 651167 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 12:55:52.857896 650138 quantize_finetune_llama.py:220] layer 3 gpu 3
I0408 12:55:52.875328 651167 data_utils.py:336] using 256 training seqs, 128 validation seqs
1_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.65it/s]0_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.54it/s]1_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.52it/s]v
2_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]1_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:19,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.53it/s]1_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.62it/s]0_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.81it/s]1_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.63it/s]0_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]2_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.57it/s]1_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:18,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.54it/s]2_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.98it/s]1_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.66it/s]0_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.20it/s]1_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.54it/s]2_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.36it/s]1_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.63it/s]0_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.46it/s]1_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:17,  3.64it/s]2_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.65it/s]0_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:11,  3.00it/s]I0408 12:55:55.863395 650138 quantize_finetune_llama.py:251] computed original embedding for layer 3 in 2.8421876430511475s
2_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.57it/s]1_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.62it/s]0_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:10,  3.12it/s]2_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.57it/s]1_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.59it/s]0_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.20it/s]2_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.58it/s]1_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.58it/s]0_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.28it/s]2_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.58it/s]1_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.55it/s]0_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.32it/s]2_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.58it/s]1_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.56it/s]0_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.38it/s]2_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:16,  3.56it/s]0_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.42it/s]2_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.62it/s]1_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.56it/s]0_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.45it/s]2_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.64it/s]1_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.56it/s]0_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.46it/s]2_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.64it/s]1_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.56it/s]0_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.47it/s]2_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.63it/s]1_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:15,  3.54it/s]0_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.50it/s]2_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.63it/s]1_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.54it/s]0_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.50it/s]2_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.65it/s]1_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.52it/s]2_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:21,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.49it/s]1_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.54it/s]2_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:21,  3.65it/s]0_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.49it/s]I0408 12:55:59.504546 651332 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 12:55:59.504651 651332 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 12:55:59.504692 651332 utils.py:162] NumExpr defaulting to 16 threads.
1_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.66it/s]0_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.50it/s]I0408 12:55:59.827497 651332 config.py:54] PyTorch version 2.6.0 available.
1_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.64it/s]W0408 12:56:00.019519 651332 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

0_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.50it/s]1_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.58it/s]2_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:20,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.51it/s]1_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:13,  3.56it/s]2_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.65it/s]W0408 12:56:00.589702 651332 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 12:56:00.593560 650138 quantize_finetune_llama.py:220] layer 4 gpu 0
0_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.52it/s]I0408 12:56:00.607371 651332 data_utils.py:336] using 256 training seqs, 128 validation seqs
1_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.56it/s]2_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.64it/s]0_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.49it/s]1_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.54it/s]v
3_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]2_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.63it/s]0_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.50it/s]1_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:07<00:19,  3.63it/s]0_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.49it/s]1_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]2_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.62it/s]3_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:04,  1.54it/s]0_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.48it/s]1_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.62it/s]3_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.34it/s]0_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.48it/s]1_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.52it/s]2_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.63it/s]3_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.79it/s]0_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.47it/s]1_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:11,  3.49it/s]2_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.63it/s]3_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.07it/s]0_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.47it/s]1_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.24it/s]0_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.47it/s]1_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.53it/s]2_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:27,  3.36it/s]0_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.48it/s]1_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.54it/s]2_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:18,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]0_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.49it/s]1_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.51it/s]3_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.57it/s]0_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.50it/s]3_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.54it/s]2_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:11,  2.97it/s]0_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.50it/s]3_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.56it/s]2_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:10,  3.12it/s]0_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.49it/s]3_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:16,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.23it/s]0_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.49it/s]3_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.60it/s]1_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.32it/s]0_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.50it/s]3_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.61it/s]2_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.38it/s]0_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.49it/s]3_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.62it/s]2_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:16,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.42it/s]0_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]3_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.61it/s]2_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.49it/s]0_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.49it/s]0_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
3_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.61it/s]2_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.49it/s]3_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.60it/s]2_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.61it/s]1_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.50it/s]3_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.58it/s]2_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:12<00:15,  3.58it/s]1_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.49it/s]3_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.58it/s]1_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.53it/s]3_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.60it/s]2_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.60it/s]1_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.52it/s]3_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:21,  3.62it/s]2_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:21<00:06,  3.52it/s]3_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:13,  3.58it/s]1_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.52it/s]3_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.56it/s]1_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.58it/s]2_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.52it/s]3_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:14<00:13,  3.56it/s]1_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.49it/s]3_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.58it/s]2_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.55it/s]1_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.50it/s]3_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.53it/s]1_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.47it/s]3_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.52it/s]1_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:23<00:04,  3.47it/s]3_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]1_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.49it/s]3_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.53it/s]1_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.48it/s]3_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.60it/s]1_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.48it/s]2_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:11,  3.55it/s]2.678267719602445e-06 0.004913446493446827 -0.005020405165851116
1.000253438949585 1.005010724067688 0.9954555034637451
0_v proxy err 0.04373018071055412 err 2.662592887878418 tr(WHW.T) 60.88684844970703
bpp_loss 3.3090720176696777
0_q proxy err 0.00010959242354147136 err 31.5729923248291 tr(WHW.T) 288094.65625
bpp_loss 4.030368447303772
0_k proxy err 9.983196650864556e-05 err 10.001239776611328 tr(WHW.T) 100180.734375
bpp_loss 4.642569065093994
o
0_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]3_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.48it/s]2_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.48it/s]2_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.60it/s]1_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.52it/s]2_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.63it/s]1_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:25<00:02,  3.50it/s]2_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.63it/s]1_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:11,  3.01it/s]3_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.62it/s]1_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.53it/s]2_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:10,  3.16it/s]3_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:16,  3.63it/s]1_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.27it/s]3_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.61it/s]1_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.50it/s]2_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.36it/s]3_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.61it/s]1_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.42it/s]3_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.60it/s]1_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.50it/s]2_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:08,  3.45it/s]3_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.50it/s]2_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.48it/s]3_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.60it/s]0_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.11s/it]1_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]2_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:07,  3.52it/s]3_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.59it/s]1_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]1_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]
2_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.53it/s]3_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.58it/s]2_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.53it/s]3_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.53it/s]3_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.58it/s]2_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.58it/s]2_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:21<00:06,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:13,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.59it/s]3_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.59it/s]2_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:22<00:05,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.55it/s]0_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]2_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.55it/s]3_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:23<00:04,  3.55it/s]3_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]2_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.53it/s]3_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:24<00:03,  3.51it/s]3_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.53it/s]3.759881110454444e-06 0.005047901999205351 -0.004630601964890957
1.0001540184020996 1.0050382614135742 0.9953514337539673
1_v proxy err 0.030117100104689598 err 3.2849011421203613 tr(WHW.T) 109.07096099853516
bpp_loss 3.408667802810669
1_q proxy err 0.00018466476467438042 err 26.744348526000977 tr(WHW.T) 144826.484375
bpp_loss 4.268676280975342
1_k proxy err 0.00010360204760218039 err 7.825999736785889 tr(WHW.T) 75539.046875
bpp_loss 4.983175754547119
o
1_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]2_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]3_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.53it/s]2_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:25<00:02,  3.55it/s]3_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.55it/s]2_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:11,  3.01it/s]2_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.57it/s]0_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:02,  3.11s/it]3_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:10,  3.14it/s]2_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.26it/s]2_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:26<00:01,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.37it/s]2_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.59it/s]3_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.41it/s]2_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.59it/s]3_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.45it/s]2_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.48it/s]2_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:07,  3.50it/s]1_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:03,  3.07s/it]2_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.57it/s]2_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.53it/s]
3_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.55it/s]3_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.53it/s]3_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.53it/s]3_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.58it/s]0_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:59,  3.12s/it]3_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.55it/s]1_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.08s/it]3_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:23<00:04,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.57it/s]3_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.52it/s]0_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:56,  3.12s/it]3_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.53it/s]2.9883246952522313e-06 0.005341493058949709 -0.005057597067207098
1.0002655982971191 1.0053309202194214 0.9955949783325195
2_v proxy err 0.01860792189836502 err 2.9020822048187256 tr(WHW.T) 155.95950317382812
bpp_loss 3.3183329105377197
2_q proxy err 0.000551645818632096 err 22.879596710205078 tr(WHW.T) 41475.15625
bpp_loss 4.24832010269165
2_k proxy err 0.0002991344372276217 err 6.7647857666015625 tr(WHW.T) 22614.533203125
bpp_loss 5.134323596954346
o
2_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]3_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.52it/s]3_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:25<00:02,  3.55it/s]3_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.54it/s]3_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.55it/s]3_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.57it/s]1_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:58,  3.08s/it]3_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.60it/s]3_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.59it/s]3_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.58it/s]3_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.58it/s]0_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:53,  3.12s/it]3_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.56it/s]2_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:03,  3.07s/it]3_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.56it/s]3_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]
1_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:56,  3.09s/it]0_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:50,  3.12s/it]2_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.09s/it]1_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]4.234893822285812e-06 0.004624854773283005 -0.004995432216674089
1.0001546144485474 1.0049890279769897 0.9953791499137878
3_v proxy err 0.011726262979209423 err 3.392796754837036 tr(WHW.T) 289.3331604003906
bpp_loss 3.408262014389038
3_q proxy err 0.0004838559834752232 err 23.020381927490234 tr(WHW.T) 47576.9296875
bpp_loss 4.282341003417969
3_k proxy err 0.0002550834615249187 err 6.676685810089111 tr(WHW.T) 26174.515625
bpp_loss 5.20915412902832
o
3_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]0_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:47,  3.13s/it]2_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.09s/it]1_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:50,  3.09s/it]3_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:03,  3.07s/it]2_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:56,  3.09s/it]0_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:44,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:47,  3.09s/it]3_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:01,  3.08s/it]2_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]0_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:41,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:44,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:58,  3.08s/it]2_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:50,  3.09s/it]0_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:38,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.09s/it]3_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:55,  3.08s/it]2_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:47,  3.09s/it]0_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:35,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:38,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:52,  3.08s/it]2_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:44,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:35,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:50,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.09s/it]0_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:32,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:46,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:38,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:29,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:44,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:35,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:32,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:19,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:38,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:29,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:16,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:33<04:35,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:13,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:32,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.19s/it]1_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:28,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:10,  3.17s/it]1_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.10s/it]3_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.09s/it]2_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:06,  3.16s/it]3_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:22,  3.09s/it]1_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:12,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:02,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.14s/it]2_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:59,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:16,  3.09s/it]1_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.13s/it]2_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]0_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:55,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:13,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.12s/it]2_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]0_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:10,  3.09s/it]1_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]2_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]0_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:12,  3.15s/it]1_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]0_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:46,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:07,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:42,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:03,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:46,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:39,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<03:59,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:26<03:43,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:56,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:47,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:49,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:27,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:46,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:26<03:43,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:29<03:40,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:17,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:14,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:19,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]3_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:54<03:15,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:22,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:11,  3.19s/it]3_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:27,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:19,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:07,  3.17s/it]3_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:24,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:03,  3.16s/it]3_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<02:59,  3.16s/it]3_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:18,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]2_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]0_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:54<03:15,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]2_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]0_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:57<03:12,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]2_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]0_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:50,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:12,  3.16s/it]1_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.12s/it]2_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]0_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:46,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.14s/it]1_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:19<02:51,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:58,  3.13s/it]0_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:43,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:40,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:30,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:19<02:50,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:27,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:22<02:47,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:39,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:25<02:44,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:24,  3.15s/it]1_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:52<02:21,  3.14s/it]1_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:26,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.10s/it]0_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:18,  3.14s/it]1_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:47<02:23,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.14s/it]1_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]3_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:14,  3.21s/it]2_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:10,  3.19s/it]2_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:25,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:13,  3.17s/it]0_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:08<02:07,  3.18s/it]2_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:47<02:22,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.15s/it]0_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:11<02:03,  3.17s/it]2_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:14,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:50<02:19,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.14s/it]0_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:13,  3.17s/it]3_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:53<02:16,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:02,  3.13s/it]0_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.16s/it]3_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:12,  3.17s/it]1_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:24<01:50,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:08,  3.14s/it]1_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:27<01:47,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.13s/it]3_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:30<01:43,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]3_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:01,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:33<01:40,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:12<01:58,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:15<01:55,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:46,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:18<01:51,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:46<01:28,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:40<01:30,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:49<01:24,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:52<01:21,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:55<01:18,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:24,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:40<01:30,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:05<01:10,  3.21s/it]2_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:21,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:43<01:27,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:08<01:06,  3.19s/it]2_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]3_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:46<01:23,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:09,  3.17s/it]0_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:11<01:03,  3.18s/it]2_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:49<01:20,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.15s/it]0_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.17s/it]2_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]0_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.17s/it]3_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]0_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:21<00:53,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:24<00:50,  3.16s/it]2_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:09,  3.16s/it]1_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.12s/it]0_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:27<00:47,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]3_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:05<01:06,  3.15s/it]1_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:30<00:44,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]3_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:08<01:02,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:33<00:40,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.13s/it]3_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:11<00:59,  3.13s/it]1_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]3_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.12s/it]1_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:43<00:31,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:46<00:28,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:49<00:25,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:28,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:52<00:22,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:33<00:37,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:28,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:36<00:34,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:39<00:31,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:05<00:09,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:42<00:27,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:08<00:06,  3.21s/it]2_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.10s/it]1_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]0_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:11<00:03,  3.19s/it]2_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.17s/it]0_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.18s/it]0_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.15s/it]
2_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.12s/it]3_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.11s/it]1_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.14s/it]1_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
2_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.18s/it]3_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]3_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:01<00:09,  3.11s/it]2_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]2_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
3_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:04<00:06,  3.18s/it]3_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.17s/it]3_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.15s/it]3_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
2.2815165721112862e-06 0.016402272507548332 -0.016303343698382378
1.000061273574829 1.0164108276367188 0.9836952686309814
0_o proxy err 0.004646240267902613 err 14.511219024658203 tr(WHW.T) 3123.217529296875
bpp_loss 3.2496631145477295
0_up proxy err 0.007260303944349289 err 64.79422760009766 tr(WHW.T) 8924.451171875
bpp_loss 3.6066859449659074
0_gate proxy err 0.0042414856143295765 err 66.92498779296875 tr(WHW.T) 15778.666015625
bpp_loss 3.7081523963383267
0_down proxy err 0.00590786337852478 err 63.912479400634766 tr(WHW.T) 10818.205078125
bpp_loss 3.5998972484043668
2.246397116323351e-06 0.015175792388617992 -0.0158220324665308
1.0000107288360596 1.0158429145812988 0.9855168461799622
1_o proxy err 0.008038582280278206 err 15.947198867797852 tr(WHW.T) 1983.8321533203125
bpp_loss 3.341001510620117
1_up proxy err 0.007898249663412571 err 65.00907135009766 tr(WHW.T) 8230.8203125
bpp_loss 3.6220274652753557
1_gate proxy err 0.004808362573385239 err 67.08802795410156 tr(WHW.T) 13952.365234375
bpp_loss 3.7258975165230885
1_down proxy err 0.003645973978564143 err 50.963539123535156 tr(WHW.T) 13978.03125
bpp_loss 3.617948532104492
I0408 13:02:02.865121 650138 quantize_finetune_llama.py:251] computed original embedding for layer 4 in 0.8754918575286865s
I0408 13:02:06.735546 655409 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:02:06.735650 655409 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:02:06.735690 655409 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:02:07.101287 655409 config.py:54] PyTorch version 2.6.0 available.
W0408 13:02:07.330185 655409 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 13:02:08.004049 655409 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:02:08.008090 650138 quantize_finetune_llama.py:220] layer 5 gpu 1
I0408 13:02:08.023866 655409 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
4_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]2.371637037867913e-06 0.014516419731080532 -0.01519729383289814
1.0000463724136353 1.0152170658111572 0.9861474633216858
2_o proxy err 0.007773928809911013 err 15.29382610321045 tr(WHW.T) 1967.3226318359375
bpp_loss 3.2855833768844604
2_up proxy err 0.008531047962605953 err 64.84001159667969 tr(WHW.T) 7600.474609375
bpp_loss 3.6178698199135915
2_gate proxy err 0.004477299749851227 err 67.6668472290039 tr(WHW.T) 15113.31640625
bpp_loss 3.7600429398672923
2_down proxy err 0.008391709066927433 err 64.8404312133789 tr(WHW.T) 7726.72509765625
bpp_loss 3.6206304005214145
4_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.71it/s]4_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.49it/s]4_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.85it/s]4_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.06it/s]4_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.19it/s]4_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.29it/s]I0408 13:02:10.752937 650138 quantize_finetune_llama.py:251] computed original embedding for layer 5 in 0.8396799564361572s
4_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.35it/s]4_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.39it/s]4_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.40it/s]4_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.42it/s]4_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.43it/s]4_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.44it/s]4_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.45it/s]4_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.45it/s]4_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.44it/s]4_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.45it/s]4_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:24,  3.43it/s]4_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.43it/s]4_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.45it/s]4_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.47it/s]I0408 13:02:14.639892 655557 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:02:14.640002 655557 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:02:14.640042 655557 utils.py:162] NumExpr defaulting to 16 threads.
4_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.46it/s]I0408 13:02:15.015900 655557 config.py:54] PyTorch version 2.6.0 available.
4_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.45it/s]W0408 13:02:15.237133 655557 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

4_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.43it/s]4_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.43it/s]W0408 13:02:15.840151 655557 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:02:15.844413 650138 quantize_finetune_llama.py:220] layer 6 gpu 2
I0408 13:02:15.864632 655557 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.45it/s]1.935608224812313e-06 0.014799036085605621 -0.01480260118842125
0.9999697804450989 1.014824390411377 0.9877690076828003
3_o proxy err 0.009260650724172592 err 17.198488235473633 tr(WHW.T) 1857.15771484375
bpp_loss 3.397921919822693
3_up proxy err 0.008567577227950096 err 64.56924438476562 tr(WHW.T) 7536.46484375
bpp_loss 3.598167794091361
3_gate proxy err 0.0033106436021625996 err 69.14063262939453 tr(WHW.T) 20884.34765625
bpp_loss 3.831740583692278
3_down proxy err 0.00920895766466856 err 64.44990539550781 tr(WHW.T) 6998.6103515625
bpp_loss 3.595522335597447
4_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.47it/s]v
5_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]4_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.77it/s]4_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.45it/s]5_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.54it/s]4_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.45it/s]5_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.94it/s]4_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.17it/s]4_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.46it/s]I0408 13:02:18.036077 650138 quantize_finetune_llama.py:251] computed original embedding for layer 6 in 0.7497222423553467s
5_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.32it/s]4_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.45it/s]5_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.40it/s]4_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.42it/s]5_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]4_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.43it/s]5_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.48it/s]4_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.43it/s]5_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.50it/s]4_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.53it/s]4_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.55it/s]4_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.45it/s]5_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.56it/s]4_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.44it/s]5_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.60it/s]4_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.45it/s]5_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.61it/s]4_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.43it/s]5_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.58it/s]4_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.42it/s]5_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.58it/s]I0408 13:02:21.568073 655713 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:02:21.568171 655713 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:02:21.568209 655713 utils.py:162] NumExpr defaulting to 16 threads.
4_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.43it/s]5_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.56it/s]4_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.47it/s]I0408 13:02:21.892824 655713 config.py:54] PyTorch version 2.6.0 available.
5_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.58it/s]W0408 13:02:22.084584 655713 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

4_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.44it/s]5_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.45it/s]5_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.58it/s]W0408 13:02:22.613019 655713 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:02:22.616732 650138 quantize_finetune_llama.py:220] layer 7 gpu 3
I0408 13:02:22.629971 655713 data_utils.py:336] using 256 training seqs, 128 validation seqs
4_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.43it/s]5_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.41it/s]5_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.55it/s]v
6_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]4_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.43it/s]5_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.56it/s]4_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.44it/s]5_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:00,  1.62it/s]I0408 13:02:23.775987 650138 quantize_finetune_llama.py:251] computed original embedding for layer 7 in 0.7309432029724121s
5_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.56it/s]4_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.43it/s]6_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:40,  2.40it/s]5_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.53it/s]4_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.41it/s]6_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.83it/s]5_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.53it/s]4_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.40it/s]6_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.09it/s]5_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.52it/s]4_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.40it/s]6_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.26it/s]5_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.52it/s]4_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.42it/s]6_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:27,  3.37it/s]5_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.53it/s]4_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.39it/s]6_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.42it/s]5_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.53it/s]6_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]4_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.39it/s]5_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.53it/s]6_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.52it/s]4_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:12,  3.38it/s]5_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.54it/s]6_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.56it/s]4_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.41it/s]5_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.58it/s]4_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.41it/s]5_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.58it/s]4_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.41it/s]5_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.41it/s]5_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.57it/s]I0408 13:02:27.375022 655859 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:02:27.375120 655859 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:02:27.375157 655859 utils.py:162] NumExpr defaulting to 16 threads.
4_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.42it/s]5_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.57it/s]I0408 13:02:27.701017 655859 config.py:54] PyTorch version 2.6.0 available.
4_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.57it/s]W0408 13:02:27.890130 655859 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

6_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.58it/s]4_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.47it/s]5_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.57it/s]5_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.58it/s]W0408 13:02:28.446544 655859 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:02:28.450394 650138 quantize_finetune_llama.py:220] layer 8 gpu 0
I0408 13:02:28.463672 655859 data_utils.py:336] using 256 training seqs, 128 validation seqs
6_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.90it/s]5_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.53it/s]6_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.56it/s]4_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.04it/s]v
7_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]5_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.17it/s]5_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.24it/s]7_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.85it/s]5_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.55it/s]4_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.31it/s]7_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.60it/s]5_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.55it/s]4_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.36it/s]7_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  3.00it/s]5_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.56it/s]4_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.40it/s]7_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:29,  3.21it/s]5_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.58it/s]4_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.41it/s]7_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.35it/s]5_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:13,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.58it/s]7_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.44it/s]4_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.42it/s]5_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.58it/s]7_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.51it/s]4_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.44it/s]5_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:25,  3.54it/s]4_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.44it/s]5_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.55it/s]7_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.57it/s]4_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.44it/s]5_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.60it/s]4_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.44it/s]5_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.58it/s]7_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.62it/s]4_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.59it/s]7_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.61it/s]4_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.57it/s]7_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.61it/s]4_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.47it/s]5_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.62it/s]4_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.61it/s]4_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.58it/s]7_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.62it/s]4_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.57it/s]7_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.61it/s]4_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.46it/s]5_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.54it/s]6_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.57it/s]7_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.59it/s]4_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.47it/s]5_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.60it/s]4_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.47it/s]5_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.60it/s]4_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.47it/s]6_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:21,  3.61it/s]5_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:11,  2.99it/s]4_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.48it/s]6_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.57it/s]7_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.61it/s]5_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:10,  3.14it/s]4_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.47it/s]6_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.60it/s]5_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.25it/s]4_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.46it/s]6_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.55it/s]7_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.59it/s]5_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.33it/s]4_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.48it/s]6_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.59it/s]5_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.40it/s]4_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.59it/s]6_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.53it/s]5_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.44it/s]4_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.61it/s]6_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.46it/s]4_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.48it/s]7_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.59it/s]6_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.48it/s]4_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.51it/s]4_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.49it/s]7_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.53it/s]4_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.48it/s]7_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.60it/s]6_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.55it/s]5_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.59it/s]4_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.48it/s]4_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.40it/s]
6_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.52it/s]5_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:09<00:18,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.53it/s]5_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.53it/s]7_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.56it/s]5_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]5_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.55it/s]7_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.52it/s]5_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]5_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.51it/s]5_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:16,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.50it/s]5_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.53it/s]6_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.48it/s]5_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.55it/s]7_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.51it/s]6_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.48it/s]5_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.52it/s]5_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:11,  2.96it/s]7_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.52it/s]5_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:10,  3.09it/s]7_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.50it/s]5_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.54it/s]6_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.20it/s]7_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.51it/s]4.08680261898553e-06 0.0047949994914233685 -0.004654396325349808
1.0001254081726074 1.0047833919525146 0.9954342246055603
4_v proxy err 0.012683713808655739 err 3.6187539100646973 tr(WHW.T) 285.30712890625
bpp_loss 3.4531335830688477
4_q proxy err 0.000455692206742242 err 22.836950302124023 tr(WHW.T) 50114.859375
bpp_loss 4.246515989303589
4_k proxy err 0.00023073672491591424 err 6.761041641235352 tr(WHW.T) 29301.974609375
bpp_loss 5.1801557540893555
o
4_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]5_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.27it/s]7_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.51it/s]5_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.54it/s]6_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.33it/s]7_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.51it/s]5_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.38it/s]7_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.51it/s]5_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.42it/s]7_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.53it/s]5_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.54it/s]5_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.55it/s]5_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.48it/s]7_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.55it/s]5_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.49it/s]7_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.56it/s]5_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.56it/s]5_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]
6_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.49it/s]7_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.50it/s]7_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.49it/s]7_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.55it/s]4_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:09,  3.12s/it]6_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.49it/s]7_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.54it/s]6_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.51it/s]7_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.52it/s]7_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.52it/s]7_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.52it/s]6_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.52it/s]7_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:11,  2.99it/s]6_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.52it/s]7_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:10,  3.12it/s]6_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.50it/s]7_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.23it/s]6_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.30it/s]6_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.39it/s]6_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.48it/s]7_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.44it/s]4_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:06,  3.13s/it]6_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.47it/s]7_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.46it/s]6_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.46it/s]7_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.48it/s]2.679732233445975e-06 0.005305803846567869 -0.004940955433994532
1.0002119541168213 1.0053026676177979 0.9955939650535583
5_v proxy err 0.014783872291445732 err 3.0871665477752686 tr(WHW.T) 208.81988525390625
bpp_loss 3.348564863204956
5_q proxy err 0.0006219731876626611 err 22.385826110839844 tr(WHW.T) 35991.625
bpp_loss 4.229933261871338
5_k proxy err 0.00028542184736579657 err 6.564061641693115 tr(WHW.T) 22997.75390625
bpp_loss 5.1647467613220215
o
5_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]6_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.45it/s]7_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.49it/s]6_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.50it/s]7_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.52it/s]6_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.53it/s]7_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.53it/s]7_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.55it/s]6_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.55it/s]7_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.54it/s]6_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.55it/s]7_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.56it/s]6_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.58it/s]7_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.57it/s]6_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.58it/s]6_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.48it/s]
7_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.57it/s]4_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:03,  3.12s/it]7_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.59it/s]7_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.57it/s]5_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.09s/it]7_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:23<00:04,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.58it/s]7_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.56it/s]7_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.57it/s]7_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.57it/s]7_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.57it/s]7_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:25<00:02,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.52it/s]4_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:00,  3.13s/it]7_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.51it/s]7_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.52it/s]5_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:03,  3.10s/it]7_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.52it/s]7_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.52it/s]3.3710466595948674e-06 0.004806180484592915 -0.00490499148145318
1.0001649856567383 1.0048900842666626 0.9954392313957214
6_v proxy err 0.013131393119692802 err 3.3305647373199463 tr(WHW.T) 253.63377380371094
bpp_loss 3.3939223289489746
6_q proxy err 0.0006306796567514539 err 22.477161407470703 tr(WHW.T) 35639.5859375
bpp_loss 4.279874086380005
6_k proxy err 0.0002598010760266334 err 6.797345161437988 tr(WHW.T) 26163.654296875
bpp_loss 5.227919101715088
o
6_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]7_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.49it/s]7_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.53it/s]7_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]7_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.54it/s]7_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.51it/s]
4_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:57,  3.13s/it]5_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.09s/it]6_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.09s/it]4_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:54,  3.14s/it]5_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.10s/it]3.3102362522186013e-06 0.004905614536255598 -0.00462108151987195
1.0001704692840576 1.0049076080322266 0.9956039786338806
7_v proxy err 0.010720671154558659 err 3.3172662258148193 tr(WHW.T) 309.4270935058594
bpp_loss 3.3890576362609863
7_q proxy err 0.0006259562214836478 err 21.999202728271484 tr(WHW.T) 35144.953125
bpp_loss 4.204926490783691
7_k proxy err 0.0002490907208994031 err 6.68820858001709 tr(WHW.T) 26850.4921875
bpp_loss 5.259917259216309
o
7_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]6_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:51,  3.13s/it]7_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.09s/it]5_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]6_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:48,  3.13s/it]7_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.09s/it]5_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.13s/it]7_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.09s/it]5_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]6_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:56,  3.09s/it]5_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]5_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:50,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:32,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:47,  3.09s/it]5_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:30,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:26,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:23,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:38,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:35,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:32,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.14s/it]5_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:29,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]5_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:15,  3.20s/it]6_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.18s/it]6_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]5_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]6_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]4_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]6_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]4_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:59,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]7_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:10,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:12,  3.16s/it]5_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:07,  3.14s/it]5_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:49,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.13s/it]7_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.13s/it]5_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.13s/it]7_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:42,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:56,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:46,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:26<03:43,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:27,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:32,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:17,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:27,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]6_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:24,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:11,  3.19s/it]6_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.18s/it]4_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.17s/it]6_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:18,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.16s/it]4_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]6_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:54<03:15,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.15s/it]4_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]6_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.18s/it]7_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:57<03:12,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]4_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.16s/it]6_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.16s/it]7_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:12,  3.16s/it]5_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:50,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]7_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]5_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:46,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]7_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]7_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:19<02:51,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:39,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:22<02:47,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:27,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:14,  3.21s/it]7_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:25,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:14,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:10,  3.19s/it]7_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:47<02:22,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:13,  3.18s/it]6_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.18s/it]7_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:50<02:19,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.16s/it]6_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]7_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:13,  3.18s/it]4_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]7_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.16s/it]4_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.16s/it]7_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:12,  3.16s/it]5_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.13s/it]6_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.15s/it]4_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:08,  3.14s/it]5_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]6_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]4_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:24<01:50,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.13s/it]5_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.13s/it]6_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:01,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:12<01:58,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:15<01:55,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:51,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:46<01:28,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:24,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:20,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:40<01:30,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:24,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:43<01:26,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:10,  3.21s/it]7_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:46<01:23,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.19s/it]7_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.18s/it]6_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.12s/it]4_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.18s/it]7_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.16s/it]6_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.17s/it]7_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.18s/it]4_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.16s/it]7_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.10s/it]5_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.14s/it]6_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.16s/it]4_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:21<00:53,  3.16s/it]7_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:09,  3.17s/it]5_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.13s/it]6_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]4_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:24<00:50,  3.16s/it]7_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:05<01:06,  3.14s/it]5_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]6_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.14s/it]4_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:08<01:02,  3.14s/it]5_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]6_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]4_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]5_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:43<00:31,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:46<00:28,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:33<00:37,  3.11s/it]4_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:36<00:34,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:39<00:30,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:05<00:09,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.21s/it]5_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.12s/it]6_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.19s/it]5_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.18s/it]6_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.12s/it]7_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.10s/it]4_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.18s/it]4_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.15s/it]
5_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]6_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]7_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.11s/it]5_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]5_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
6_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.18s/it]7_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:01<00:09,  3.11s/it]6_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]7_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:04<00:06,  3.18s/it]6_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]6_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
7_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.15s/it]7_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
2.0353131731098983e-06 0.014509162865579128 -0.014700260944664478
0.9999787211418152 1.0147149562835693 0.986810564994812
4_o proxy err 0.013204917311668396 err 17.130054473876953 tr(WHW.T) 1297.2481689453125
bpp_loss 3.4134029150009155
4_up proxy err 0.008679541759192944 err 64.08528900146484 tr(WHW.T) 7383.48779296875
bpp_loss 3.571086508887155
4_gate proxy err 0.002426103688776493 err 70.67476654052734 tr(WHW.T) 29130.974609375
bpp_loss 3.9015627588544572
4_down proxy err 0.010018824599683285 err 64.07762145996094 tr(WHW.T) 6395.72265625
bpp_loss 3.5689394814627513
2.19341245610849e-06 0.011610196903347969 -0.010945678688585758
1.0000051259994507 1.0116313695907593 0.9907271862030029
5_o proxy err 0.015404528006911278 err 16.260812759399414 tr(WHW.T) 1055.5865478515625
bpp_loss 3.3506795167922974
5_up proxy err 0.008384881541132927 err 64.19828796386719 tr(WHW.T) 7656.43310546875
bpp_loss 3.5776535783495222
5_gate proxy err 0.002333512296900153 err 70.90831756591797 tr(WHW.T) 30386.947265625
bpp_loss 3.904359442847116
5_down proxy err 0.009993154555559158 err 64.0674057006836 tr(WHW.T) 6411.12939453125
bpp_loss 3.5734197071620395
I0408 13:08:38.962745 650138 quantize_finetune_llama.py:251] computed original embedding for layer 8 in 1.1083455085754395s
1.8172833051721682e-06 0.013087579980492592 -0.013359347358345985
0.999982476234436 1.0133787393569946 0.9887431859970093
6_o proxy err 0.01676356978714466 err 16.916929244995117 tr(WHW.T) 1009.1483764648438
bpp_loss 3.3885446786880493
6_up proxy err 0.00811244547367096 err 64.27925109863281 tr(WHW.T) 7923.53564453125
bpp_loss 3.5775199958256314
6_gate proxy err 0.00198932527564466 err 71.11518096923828 tr(WHW.T) 35748.39453125
bpp_loss 3.9081943375723704
6_down proxy err 0.009887350723147392 err 64.105224609375 tr(WHW.T) 6483.5595703125
bpp_loss 3.572333335876465
I0408 13:08:43.349971 659977 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:08:43.350106 659977 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:08:43.350148 659977 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:08:43.762797 659977 config.py:54] PyTorch version 2.6.0 available.
W0408 13:08:43.979593 659977 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 13:08:44.640670 659977 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:08:44.644694 650138 quantize_finetune_llama.py:220] layer 9 gpu 1
I0408 13:08:44.659248 659977 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
8_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]8_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:01,  1.61it/s]I0408 13:08:46.037820 650138 quantize_finetune_llama.py:251] computed original embedding for layer 9 in 0.9241032600402832s
8_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.34it/s]2.287628831254551e-06 0.013374444097280502 -0.015507707372307777
0.9999851584434509 1.0155019760131836 0.98814857006073
7_o proxy err 0.01776808127760887 err 17.043418884277344 tr(WHW.T) 959.2155151367188
bpp_loss 3.4004546403884888
7_up proxy err 0.007480317261070013 err 64.53606414794922 tr(WHW.T) 8627.4501953125
bpp_loss 3.590876885822841
7_gate proxy err 0.0020240333396941423 err 70.64591979980469 tr(WHW.T) 34903.53515625
bpp_loss 3.8793918745858327
7_down proxy err 0.009830950759351254 err 64.24160766601562 tr(WHW.T) 6534.6279296875
bpp_loss 3.5851635251726424
8_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:35,  2.75it/s]8_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.02it/s]8_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.18it/s]8_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.29it/s]8_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.36it/s]8_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.42it/s]8_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.47it/s]8_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.50it/s]8_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.52it/s]8_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.53it/s]8_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:24,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.54it/s]I0408 13:08:49.607018 660118 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:08:49.607111 660118 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:08:49.607148 660118 utils.py:162] NumExpr defaulting to 16 threads.
8_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.52it/s]I0408 13:08:49.939330 660118 config.py:54] PyTorch version 2.6.0 available.
8_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.54it/s]W0408 13:08:50.126470 660118 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

8_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.54it/s]8_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.54it/s]W0408 13:08:50.679548 660118 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:08:50.683235 650138 quantize_finetune_llama.py:220] layer 10 gpu 2
I0408 13:08:50.696691 660118 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.55it/s]v
9_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]8_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.53it/s]8_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.52it/s]9_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.80it/s]8_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.51it/s]I0408 13:08:51.980723 650138 quantize_finetune_llama.py:251] computed original embedding for layer 10 in 0.8494348526000977s
9_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.92it/s]8_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.46it/s]9_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.15it/s]8_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.28it/s]8_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.38it/s]8_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]8_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.50it/s]8_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.53it/s]8_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.54it/s]8_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.50it/s]9_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.58it/s]I0408 13:08:55.489076 660249 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:08:55.489182 660249 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:08:55.489226 660249 utils.py:162] NumExpr defaulting to 16 threads.
8_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.50it/s]I0408 13:08:55.811069 660249 config.py:54] PyTorch version 2.6.0 available.
9_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.58it/s]W0408 13:08:56.001664 660249 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

8_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.51it/s]9_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.59it/s]8_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.50it/s]9_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.59it/s]W0408 13:08:56.590952 660249 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:08:56.594559 650138 quantize_finetune_llama.py:220] layer 11 gpu 3
I0408 13:08:56.607484 660249 data_utils.py:336] using 256 training seqs, 128 validation seqs
8_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.60it/s]8_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.58it/s]v
10_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]8_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.57it/s]8_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.56it/s]10_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.84it/s]8_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.56it/s]10_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.56it/s]I0408 13:08:57.900864 650138 quantize_finetune_llama.py:251] computed original embedding for layer 11 in 0.8616983890533447s
8_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.55it/s]10_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.91it/s]8_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.56it/s]10_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.11it/s]8_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.57it/s]10_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.24it/s]8_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.44it/s]9_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.58it/s]10_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.33it/s]9_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.57it/s]8_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.45it/s]10_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.38it/s]9_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.46it/s]10_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.42it/s]9_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.57it/s]8_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]8_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:25,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.51it/s]8_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.46it/s]I0408 13:09:01.486204 660390 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:09:01.486303 660390 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:09:01.486340 660390 utils.py:162] NumExpr defaulting to 16 threads.
9_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.52it/s]8_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.48it/s]10_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.54it/s]I0408 13:09:01.814101 660390 config.py:54] PyTorch version 2.6.0 available.
8_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.49it/s]W0408 13:09:02.009884 660390 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

9_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.53it/s]8_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.48it/s]10_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]8_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.48it/s]10_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.48it/s]W0408 13:09:02.556270 660390 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:09:02.560280 650138 quantize_finetune_llama.py:220] layer 12 gpu 0
I0408 13:09:02.575973 660390 data_utils.py:336] using 256 training seqs, 128 validation seqs
9_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.52it/s]8_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.48it/s]8_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.48it/s]v
11_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]9_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.48it/s]8_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.46it/s]10_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.46it/s]8_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.46it/s]10_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:53,  1.85it/s]9_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.47it/s]8_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.60it/s]10_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.48it/s]8_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.45it/s]11_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.98it/s]10_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.50it/s]11_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.18it/s]8_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.32it/s]10_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.49it/s]8_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.93it/s]9_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.39it/s]10_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.50it/s]8_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.07it/s]9_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.45it/s]10_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]8_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.18it/s]9_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]10_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.47it/s]8_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.25it/s]9_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.50it/s]11_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.52it/s]10_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.48it/s]8_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.30it/s]9_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.54it/s]10_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.49it/s]8_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.35it/s]9_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.54it/s]10_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.48it/s]8_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.38it/s]9_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.55it/s]10_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]8_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.41it/s]11_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.56it/s]10_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.42it/s]11_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]10_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.43it/s]11_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.57it/s]10_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.55it/s]11_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.43it/s]10_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.56it/s]11_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.45it/s]10_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.55it/s]11_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.56it/s]11_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]8_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.56it/s]11_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.54it/s]11_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.45it/s]10_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.46it/s]9_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.54it/s]11_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.57it/s]8_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.45it/s]10_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.53it/s]11_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.45it/s]10_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.54it/s]11_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.48it/s]11_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.96it/s]10_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]9_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.10it/s]10_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.46it/s]9_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.21it/s]10_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.30it/s]10_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.35it/s]10_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.57it/s]8_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.44it/s]9_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.40it/s]10_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.57it/s]8_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.44it/s]9_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.58it/s]8_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.45it/s]10_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]8_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.45it/s]11_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.50it/s]10_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.56it/s]8_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.45it/s]9_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.50it/s]10_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.55it/s]8_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.44it/s]9_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.49it/s]10_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]8_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.43it/s]8_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]
9_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.50it/s]11_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]10_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.46it/s]9_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.56it/s]10_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.55it/s]10_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.46it/s]9_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.52it/s]11_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.55it/s]10_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.47it/s]9_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.53it/s]11_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.53it/s]10_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.46it/s]9_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.54it/s]11_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.53it/s]10_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:11,  2.94it/s]9_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.54it/s]11_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.54it/s]10_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:11,  3.06it/s]9_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.52it/s]11_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.54it/s]10_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.17it/s]9_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.52it/s]11_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.54it/s]10_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:09,  3.26it/s]9_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.52it/s]11_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.55it/s]9_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.51it/s]10_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.31it/s]11_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.53it/s]9_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.50it/s]10_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.34it/s]11_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.51it/s]9_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.50it/s]10_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.39it/s]11_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.49it/s]10_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.40it/s]11_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.48it/s]9_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.52it/s]10_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.42it/s]11_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.49it/s]9_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.52it/s]10_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.41it/s]11_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]9_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.50it/s]10_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.42it/s]11_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.51it/s]9_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.53it/s]10_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.52it/s]3.3985395475610858e-06 0.004721000324934721 -0.004783228505402803
1.0001651048660278 1.0047837495803833 0.9952890276908875
8_v proxy err 0.013025185093283653 err 3.3566582202911377 tr(WHW.T) 257.7052307128906
bpp_loss 3.413923740386963
8_q proxy err 0.0008174876566044986 err 21.745969772338867 tr(WHW.T) 26600.9765625
bpp_loss 4.193664312362671
8_k proxy err 0.0002874924975913018 err 6.476845741271973 tr(WHW.T) 22528.748046875
bpp_loss 5.1715288162231445
o
8_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]9_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]10_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.43it/s]11_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.51it/s]9_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.53it/s]9_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.48it/s]
11_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.52it/s]10_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]10_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.51it/s]10_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.51it/s]10_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.51it/s]10_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.51it/s]10_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.53it/s]10_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.48it/s]11_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.53it/s]10_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.01it/s]10_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.48it/s]11_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.13it/s]8_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:13,  3.17s/it]10_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.45it/s]11_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.23it/s]10_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.43it/s]11_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.30it/s]10_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.36it/s]10_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.44it/s]11_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.42it/s]10_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.45it/s]11_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.44it/s]10_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.48it/s]10_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.48it/s]11_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.48it/s]3.4313286505494034e-06 0.004792873281985521 -0.00461336225271225
1.000105619430542 1.004626989364624 0.9953596591949463
9_v proxy err 0.010669125244021416 err 3.7494380474090576 tr(WHW.T) 351.4288024902344
bpp_loss 3.5044543743133545
9_q proxy err 0.000850945245474577 err 21.829496383666992 tr(WHW.T) 25653.232421875
bpp_loss 4.201360464096069
9_k proxy err 0.00031036132713779807 err 6.499785423278809 tr(WHW.T) 20942.638671875
bpp_loss 5.189379692077637
o
9_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]10_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.47it/s]10_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.50it/s]10_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.45it/s]11_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.50it/s]8_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:08,  3.15s/it]10_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.45it/s]11_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.52it/s]10_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]10_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]
11_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.53it/s]11_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.54it/s]11_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.50it/s]11_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.52it/s]11_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.51it/s]9_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:09,  3.13s/it]11_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.51it/s]11_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.52it/s]11_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.54it/s]8_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.14s/it]11_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.52it/s]11_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.49it/s]11_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.49it/s]11_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.47it/s]11_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.48it/s]11_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.49it/s]11_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.46it/s]11_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.49it/s]9_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]2.928009735114756e-06 0.004800981841981411 -0.005059971008449793
1.0001773834228516 1.005049228668213 0.9954466223716736
10_v proxy err 0.01328150276094675 err 3.344799041748047 tr(WHW.T) 251.83889770507812
bpp_loss 3.405784845352173
10_q proxy err 0.0009356678347103298 err 21.836761474609375 tr(WHW.T) 23338.15625
bpp_loss 4.212794780731201
10_k proxy err 0.00032940658275038004 err 6.50378942489624 tr(WHW.T) 19743.95703125
bpp_loss 5.199295997619629
o
10_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]11_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.48it/s]11_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]11_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.48it/s]
8_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]9_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]3.740178726729937e-06 0.004538961686193943 -0.004955783952027559
1.0001507997512817 1.0049262046813965 0.9957400560379028
11_v proxy err 0.01072352472692728 err 3.4269073009490967 tr(WHW.T) 319.5691223144531
bpp_loss 3.4033491611480713
11_q proxy err 0.0009664437966421247 err 21.446256637573242 tr(WHW.T) 22190.8984375
bpp_loss 4.146041631698608
11_k proxy err 0.00036573238321579993 err 6.593212604522705 tr(WHW.T) 18027.423828125
bpp_loss 5.195851802825928
o
11_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]9_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.08s/it]9_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:52,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.09s/it]9_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.09s/it]9_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:56,  3.09s/it]9_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]9_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:50,  3.09s/it]9_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:47,  3.09s/it]9_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:43,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:44,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:30,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:38,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:35,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:31,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:32,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:29,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:25,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:22,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.20s/it]11_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.19s/it]11_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]10_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]11_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]11_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]10_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]8_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]11_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]10_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]8_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.16s/it]9_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]10_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]8_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.14s/it]9_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.12s/it]10_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]8_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:49,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.13s/it]9_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]10_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:58,  3.14s/it]8_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.12s/it]9_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:56,  3.12s/it]9_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:45,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:46,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:26<03:43,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:24,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:32,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:18,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:27,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:24,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:15,  3.21s/it]9_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.19s/it]9_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]10_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:18,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.18s/it]9_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:54<03:15,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]9_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]10_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:13,  3.18s/it]11_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]9_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]10_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.16s/it]11_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:12,  3.16s/it]8_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.16s/it]9_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:57,  3.12s/it]10_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]8_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.16s/it]9_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]10_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:19<02:51,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:47,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:39,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:27,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:25,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]9_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:25,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:14,  3.21s/it]10_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:47<02:22,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:10,  3.19s/it]10_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:55<02:17,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:50<02:19,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.18s/it]9_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:10,  3.17s/it]10_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:14,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]9_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:13,  3.18s/it]11_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]8_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.16s/it]11_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:12,  3.16s/it]9_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:08,  3.14s/it]9_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.13s/it]9_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:01,  3.12s/it]9_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:17<01:55,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:12<01:58,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:43,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:15<01:55,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:51,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:42<01:30,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:45<01:27,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:40<01:29,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:43<01:26,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.10s/it]8_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:10,  3.21s/it]10_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:18,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.16s/it]8_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.19s/it]10_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.15s/it]8_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.18s/it]10_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]8_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.17s/it]10_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:04<01:09,  3.18s/it]11_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]8_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:07<01:06,  3.16s/it]11_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:09,  3.17s/it]9_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:21<00:53,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:02,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:05<01:06,  3.14s/it]9_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:08<01:02,  3.13s/it]9_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.12s/it]9_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]9_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]11_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.12s/it]9_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:29<00:43,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:32<00:40,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.11s/it]8_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.12s/it]11_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:33<00:37,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:36<00:34,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:39<00:31,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]9_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.10s/it]10_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:57<00:15,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.21s/it]11_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.19s/it]11_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.12s/it]8_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.17s/it]8_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
11_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.10s/it]9_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.13s/it]9_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
10_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.19s/it]11_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:01<00:09,  3.11s/it]10_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.17s/it]11_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:04<00:06,  3.16s/it]10_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]10_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
11_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]11_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.14s/it]11_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
2.0290408428991213e-06 0.015555967576801777 -0.015913167968392372
0.999994695186615 1.0159252882003784 0.9865688681602478
8_o proxy err 0.022907255217432976 err 17.079790115356445 tr(WHW.T) 745.6061401367188
bpp_loss 3.4139602184295654
8_up proxy err 0.0075810132548213005 err 64.401123046875 tr(WHW.T) 8495.0546875
bpp_loss 3.586514336722238
8_gate proxy err 0.001897207461297512 err 70.64849090576172 tr(WHW.T) 37238.1484375
bpp_loss 3.8833649839673723
8_down proxy err 0.009889689274132252 err 64.1723861694336 tr(WHW.T) 6488.8173828125
bpp_loss 3.58147280556815
1.3152312021702528e-06 0.01320018619298935 -0.01462480053305626
0.999993085861206 1.0146437883377075 0.9861857891082764
9_o proxy err 0.022795675322413445 err 17.703161239624023 tr(WHW.T) 776.6017456054688
bpp_loss 3.4746198654174805
9_up proxy err 0.007190039847046137 err 64.49929809570312 tr(WHW.T) 8970.6455078125
bpp_loss 3.595087630408151
9_gate proxy err 0.0018006039317697287 err 70.97209930419922 tr(WHW.T) 39415.71875
bpp_loss 3.896738052368164
9_down proxy err 0.010235566645860672 err 64.20672607421875 tr(WHW.T) 6272.90380859375
bpp_loss 3.5844293321881975
I0408 13:15:14.354319 650138 quantize_finetune_llama.py:251] computed original embedding for layer 12 in 0.9801440238952637s
I0408 13:15:18.336937 664551 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:15:18.337047 664551 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:15:18.337088 664551 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:15:18.751295 664551 config.py:54] PyTorch version 2.6.0 available.
W0408 13:15:18.969122 664551 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 13:15:19.611996 664551 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:15:19.616130 650138 quantize_finetune_llama.py:220] layer 13 gpu 1
I0408 13:15:19.632698 664551 data_utils.py:336] using 256 training seqs, 128 validation seqs
1.7779872223400162e-06 0.014939902350306511 -0.015465933829545975
0.9999973177909851 1.0154865980148315 0.9866656064987183
10_o proxy err 0.025001155212521553 err 17.01738739013672 tr(WHW.T) 680.6640625
bpp_loss 3.4046871662139893
10_up proxy err 0.007056971546262503 err 64.9181900024414 tr(WHW.T) 9199.1572265625
bpp_loss 3.6122402804238454
10_gate proxy err 0.001883380115032196 err 70.4372329711914 tr(WHW.T) 37399.37109375
bpp_loss 3.8660552161080495
10_down proxy err 0.00988424476236105 err 64.49700164794922 tr(WHW.T) 6525.2333984375
bpp_loss 3.5992355346679688
v
12_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]12_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.78it/s]12_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.48it/s]12_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.85it/s]12_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.05it/s]12_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.17it/s]12_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.28it/s]I0408 13:15:22.183005 650138 quantize_finetune_llama.py:251] computed original embedding for layer 13 in 0.9533452987670898s
1.54202780322521e-06 0.011498681269586086 -0.013635377399623394
0.9999895095825195 1.0136361122131348 0.9899986386299133
11_o proxy err 0.03035419061779976 err 17.178884506225586 tr(WHW.T) 565.9476928710938
bpp_loss 3.4242072105407715
11_up proxy err 0.007063227705657482 err 64.92939758300781 tr(WHW.T) 9192.595703125
bpp_loss 3.6186180795942033
11_gate proxy err 0.0019016986479982734 err 70.1424331665039 tr(WHW.T) 36884.09375
bpp_loss 3.8462506362370084
11_down proxy err 0.009721248410642147 err 64.70356750488281 tr(WHW.T) 6655.890625
bpp_loss 3.6065514428274974
12_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.33it/s]12_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.36it/s]12_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.39it/s]12_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.41it/s]12_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.42it/s]12_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.43it/s]12_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.44it/s]12_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.46it/s]12_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.47it/s]12_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.47it/s]12_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.46it/s]12_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.48it/s]I0408 13:15:25.730351 664709 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:15:25.730446 664709 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:15:25.730485 664709 utils.py:162] NumExpr defaulting to 16 threads.
12_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.48it/s]I0408 13:15:26.049036 664709 config.py:54] PyTorch version 2.6.0 available.
12_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.47it/s]W0408 13:15:26.235454 664709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

12_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.49it/s]12_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.46it/s]W0408 13:15:26.802835 664709 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:15:26.807025 650138 quantize_finetune_llama.py:220] layer 14 gpu 2
I0408 13:15:26.820596 664709 data_utils.py:336] using 256 training seqs, 128 validation seqs
12_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.45it/s]v
13_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]12_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.46it/s]12_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]13_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.72it/s]12_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.48it/s]13_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.48it/s]12_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.50it/s]I0408 13:15:28.333896 650138 quantize_finetune_llama.py:251] computed original embedding for layer 14 in 1.0915577411651611s
13_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.87it/s]12_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]13_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.09it/s]12_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.45it/s]13_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.27it/s]12_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.47it/s]13_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.38it/s]12_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.46it/s]13_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]12_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.47it/s]13_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.50it/s]12_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.46it/s]13_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.55it/s]12_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.44it/s]13_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.58it/s]12_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.44it/s]13_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.59it/s]12_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.45it/s]13_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.62it/s]12_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.46it/s]13_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:23,  3.63it/s]12_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:18,  3.40it/s]13_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.62it/s]12_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:18,  3.36it/s]13_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.61it/s]I0408 13:15:31.887775 664845 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:15:31.887886 664845 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:15:31.887925 664845 utils.py:162] NumExpr defaulting to 16 threads.
12_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.38it/s]13_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.62it/s]I0408 13:15:32.207986 664845 config.py:54] PyTorch version 2.6.0 available.
13_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:22,  3.61it/s]12_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.39it/s]W0408 13:15:32.397308 664845 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

13_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.61it/s]12_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:17,  3.39it/s]13_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.63it/s]12_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.40it/s]W0408 13:15:32.973014 664845 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:15:32.976672 650138 quantize_finetune_llama.py:220] layer 15 gpu 3
I0408 13:15:32.999087 664845 data_utils.py:336] using 256 training seqs, 128 validation seqs
13_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.60it/s]12_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.41it/s]13_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.58it/s]v
14_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]12_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.41it/s]13_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.58it/s]12_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.41it/s]13_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.58it/s]14_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.74it/s]12_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.42it/s]I0408 13:15:34.207360 650138 quantize_finetune_llama.py:251] computed original embedding for layer 15 in 0.7894580364227295s
13_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.59it/s]14_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.48it/s]12_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.41it/s]13_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.57it/s]14_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.84it/s]12_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:15,  3.38it/s]13_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.59it/s]14_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.09it/s]12_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.39it/s]13_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.58it/s]14_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.25it/s]12_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.39it/s]13_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.57it/s]14_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.35it/s]12_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:14,  3.40it/s]13_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.58it/s]14_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.42it/s]12_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.58it/s]14_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.47it/s]12_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.59it/s]14_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]12_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.59it/s]14_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.54it/s]12_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.60it/s]14_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.56it/s]12_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.59it/s]14_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.56it/s]12_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.58it/s]14_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:12,  3.41it/s]13_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.58it/s]14_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.55it/s]I0408 13:15:37.817142 664991 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:15:37.817237 664991 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:15:37.817273 664991 utils.py:162] NumExpr defaulting to 16 threads.
13_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.58it/s]12_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.41it/s]14_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.55it/s]13_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.58it/s]I0408 13:15:38.143047 664991 config.py:54] PyTorch version 2.6.0 available.
12_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.43it/s]14_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.55it/s]W0408 13:15:38.334484 664991 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

13_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.57it/s]12_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.42it/s]14_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.56it/s]13_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.58it/s]12_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.44it/s]14_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.58it/s]W0408 13:15:38.891520 664991 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:15:38.895376 650138 quantize_finetune_llama.py:220] layer 16 gpu 0
I0408 13:15:38.912699 664991 data_utils.py:336] using 256 training seqs, 128 validation seqs
13_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.58it/s]12_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.41it/s]14_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.59it/s]13_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:16,  3.56it/s]12_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.40it/s]14_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.58it/s]v
15_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]13_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.56it/s]14_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:21,  3.60it/s]12_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:10,  3.36it/s]13_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.56it/s]14_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.58it/s]13_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.57it/s]12_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:12,  2.72it/s]15_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:09,  1.43it/s]14_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.54it/s]13_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.56it/s]12_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:11,  2.89it/s]15_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:44,  2.21it/s]14_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.55it/s]13_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:36,  2.65it/s]12_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.02it/s]13_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]15_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:32,  2.93it/s]12_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.14it/s]13_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.12it/s]14_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:09,  3.21it/s]13_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.27it/s]14_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.52it/s]12_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.26it/s]13_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.37it/s]14_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.51it/s]12_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.31it/s]13_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.43it/s]14_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.52it/s]12_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.32it/s]13_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.47it/s]14_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.51it/s]12_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.35it/s]13_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.50it/s]14_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.37it/s]13_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.52it/s]14_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.36it/s]13_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.56it/s]15_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.37it/s]13_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.57it/s]15_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:24,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.39it/s]13_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.57it/s]15_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]14_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.55it/s]12_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.56it/s]15_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.56it/s]14_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.56it/s]12_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.56it/s]14_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.55it/s]12_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.43it/s]13_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.54it/s]15_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.57it/s]14_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]12_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.57it/s]14_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:25<00:04,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]14_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.54it/s]12_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.42it/s]13_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.56it/s]15_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.57it/s]14_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.55it/s]12_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.43it/s]13_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.56it/s]15_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.51it/s]13_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.56it/s]12_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.44it/s]15_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]12_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.43it/s]15_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.52it/s]14_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.51it/s]13_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.02it/s]12_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.44it/s]15_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.54it/s]13_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.16it/s]12_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.42it/s]15_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.55it/s]13_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.26it/s]12_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.41it/s]15_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.55it/s]13_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:08,  3.34it/s]12_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.43it/s]15_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.54it/s]13_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.42it/s]12_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.44it/s]15_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.55it/s]13_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.46it/s]12_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.45it/s]15_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.55it/s]13_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.57it/s]12_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.44it/s]14_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.54it/s]13_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.58it/s]12_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.44it/s]14_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.52it/s]13_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.58it/s]12_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.44it/s]14_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.53it/s]13_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.53it/s]15_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.53it/s]12_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.45it/s]14_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.53it/s]13_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.53it/s]15_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.54it/s]12_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.45it/s]14_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.55it/s]13_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.54it/s]12_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.42it/s]12_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.37it/s]
13_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.54it/s]13_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.55it/s]15_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.57it/s]14_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.53it/s]13_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.52it/s]15_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.49it/s]13_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.52it/s]15_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.53it/s]14_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.51it/s]13_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.51it/s]13_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:23<00:04,  3.52it/s]15_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.48it/s]13_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.55it/s]14_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.48it/s]13_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.53it/s]15_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.53it/s]14_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.46it/s]13_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.49it/s]13_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.53it/s]15_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.54it/s]13_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.52it/s]15_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]14_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.91it/s]13_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.49it/s]14_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.04it/s]13_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:25<00:02,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:15,  3.44it/s]14_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.15it/s]13_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.45it/s]14_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.22it/s]13_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.48it/s]14_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.28it/s]13_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.47it/s]14_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.30it/s]13_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.46it/s]14_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.32it/s]13_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.48it/s]14_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.35it/s]13_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.49it/s]4.198896931484342e-06 0.00471969461068511 -0.005136416293680668
1.0000691413879395 1.0045888423919678 0.994877815246582
12_v proxy err 0.010732664726674557 err 3.9026477336883545 tr(WHW.T) 363.6233825683594
bpp_loss 3.5074262619018555
12_q proxy err 0.0006475064437836409 err 22.081668853759766 tr(WHW.T) 34102.625
bpp_loss 4.197685718536377
12_k proxy err 0.00028295646188780665 err 6.524138927459717 tr(WHW.T) 23057.041015625
bpp_loss 5.181294918060303
o
12_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]14_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.37it/s]13_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.47it/s]14_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.38it/s]13_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.50it/s]14_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.41it/s]13_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]13_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]
15_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.51it/s]14_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.44it/s]15_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.51it/s]14_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.46it/s]15_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.50it/s]14_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.45it/s]15_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.49it/s]14_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.53it/s]14_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.48it/s]15_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.54it/s]14_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.53it/s]14_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.54it/s]12_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:09,  3.12s/it]14_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.53it/s]14_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.49it/s]14_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.91it/s]14_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.06it/s]14_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.45it/s]15_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.16it/s]14_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.24it/s]14_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.31it/s]14_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.48it/s]15_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.35it/s]14_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.39it/s]3.3784353945520706e-06 0.004582712892442942 -0.004692636895924807
1.000107765197754 1.0046690702438354 0.9954277276992798
13_v proxy err 0.013021479360759258 err 3.6480138301849365 tr(WHW.T) 280.153564453125
bpp_loss 3.4558210372924805
13_q proxy err 0.0010272531071677804 err 21.466894149780273 tr(WHW.T) 20897.375
bpp_loss 4.180989980697632
13_k proxy err 0.00036255206214264035 err 6.453033447265625 tr(WHW.T) 17798.916015625
bpp_loss 5.20693826675415
o
13_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]14_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.48it/s]15_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.42it/s]14_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.45it/s]12_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]14_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.45it/s]14_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.48it/s]14_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.49it/s]14_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]14_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.45it/s]
15_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.50it/s]13_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.08s/it]15_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.47it/s]12_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:03,  3.13s/it]15_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.51it/s]15_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.48it/s]15_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.47it/s]15_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.46it/s]13_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:03,  3.10s/it]15_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.47it/s]3.866971383104101e-06 0.004816562402993441 -0.005021774675697088
1.0001227855682373 1.0049182176589966 0.995303750038147
14_v proxy err 0.012821943499147892 err 3.6073036193847656 tr(WHW.T) 281.3382873535156
bpp_loss 3.447849988937378
14_q proxy err 0.0010343026369810104 err 21.59813690185547 tr(WHW.T) 20881.8359375
bpp_loss 4.153017520904541
14_k proxy err 0.0003490325470920652 err 6.498741149902344 tr(WHW.T) 18619.298828125
bpp_loss 5.1590681076049805
o
14_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]15_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.46it/s]12_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]15_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.49it/s]15_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.50it/s]15_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.44it/s]
13_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.09s/it]14_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.10s/it]12_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.10s/it]3.8411021705542225e-06 0.005251214373856783 -0.004994585644453764
1.0000898838043213 1.005253553390503 0.9950516223907471
15_v proxy err 0.013387194834649563 err 3.8023264408111572 tr(WHW.T) 284.0271301269531
bpp_loss 3.501938819885254
15_q proxy err 0.0007833624258637428 err 21.996273040771484 tr(WHW.T) 28079.306640625
bpp_loss 4.286397933959961
15_k proxy err 0.0003503337502479553 err 6.611382007598877 tr(WHW.T) 18871.66796875
bpp_loss 5.18640661239624
o
15_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]14_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:04,  3.08s/it]14_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]12_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:51,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.09s/it]14_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.09s/it]14_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:56,  3.09s/it]14_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]14_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:47,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:43,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:30,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:37,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:26,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:39,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:35,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:28,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:29,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.21s/it]13_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:12,  3.19s/it]13_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]15_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.18s/it]13_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]15_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.17s/it]13_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]15_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]12_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]13_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]15_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]12_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.16s/it]13_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]12_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.16s/it]13_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]12_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:58,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:47,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]14_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:54,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]14_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.12s/it]14_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:47,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:31,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:43,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:32,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:22,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:29,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:25,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:16,  3.21s/it]13_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.20s/it]15_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.18s/it]15_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:19,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]15_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.18s/it]12_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]15_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.16s/it]12_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.16s/it]13_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]15_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]12_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]12_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:46,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]14_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]14_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.12s/it]14_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:30<02:42,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:44<02:31,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:39,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:27,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:36,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:22,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:14,  3.21s/it]13_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:26,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:10,  3.19s/it]15_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:22,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:12,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:06,  3.17s/it]15_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:58<02:13,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]15_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]15_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.13s/it]14_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]12_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:12,  3.16s/it]14_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]12_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]12_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it]12_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:01,  3.13s/it]14_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:43,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.12s/it]14_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:20<01:52,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]14_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]15_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]15_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.15s/it]15_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:24,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:26,  3.10s/it]12_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.10s/it]12_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:10,  3.21s/it]14_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.17s/it]12_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:06,  3.19s/it]14_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.15s/it]12_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]12_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.16s/it]14_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]13_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:09,  3.16s/it]12_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:21<00:53,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.15s/it]13_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.12s/it]15_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.14s/it]12_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.13s/it]13_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]12_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]13_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:43<00:31,  3.14s/it]14_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.12s/it]13_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:33<00:37,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.10s/it]12_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.10s/it]12_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.10s/it]15_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.11s/it]13_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:05<00:09,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.11s/it]15_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]14_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.21s/it]15_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]12_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.19s/it]15_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.12s/it]12_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.18s/it]12_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
15_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.10s/it]13_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.14s/it]13_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
14_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.17s/it]15_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:01<00:09,  3.10s/it]14_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.15s/it]15_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.17s/it]14_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]14_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
15_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.16s/it]15_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.14s/it]15_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
1.6639726254652487e-06 0.015249714255332947 -0.01612509787082672
0.9999712109565735 1.0160958766937256 0.9849212169647217
12_o proxy err 0.02304713800549507 err 17.97149658203125 tr(WHW.T) 779.7713012695312
bpp_loss 3.4778714179992676
12_up proxy err 0.006503316108137369 err 65.20976257324219 tr(WHW.T) 10027.1552734375
bpp_loss 3.638040781021118
12_gate proxy err 0.0018707729177549481 err 69.8436279296875 tr(WHW.T) 37334.1015625
bpp_loss 3.8258458205631802
12_down proxy err 0.009490089491009712 err 64.7481460571289 tr(WHW.T) 6822.7119140625
bpp_loss 3.6227006912231445
2.125205810443731e-06 0.013488845899701118 -0.013631065376102924
0.9999814629554749 1.0136511325836182 0.9865728616714478
13_o proxy err 0.02628576010465622 err 17.74832534790039 tr(WHW.T) 675.2068481445312
bpp_loss 3.454083800315857
13_up proxy err 0.006525702774524689 err 65.32416534423828 tr(WHW.T) 10010.2880859375
bpp_loss 3.6415088857923235
13_gate proxy err 0.0018009464256465435 err 70.09510803222656 tr(WHW.T) 38921.26171875
bpp_loss 3.830236094338553
13_down proxy err 0.0099127646535635 err 65.03275299072266 tr(WHW.T) 6560.505859375
bpp_loss 3.6233628136771068
I0408 13:21:50.728882 650138 quantize_finetune_llama.py:251] computed original embedding for layer 16 in 1.1315300464630127s
I0408 13:21:54.781026 669074 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:21:54.781125 669074 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:21:54.781165 669074 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:21:55.205702 669074 config.py:54] PyTorch version 2.6.0 available.
1.998502284550341e-06 0.01124699879437685 -0.011958619579672813
0.9999803304672241 1.0119400024414062 0.9889902472496033
14_o proxy err 0.02564973756670952 err 17.603355407714844 tr(WHW.T) 686.2976684570312
bpp_loss 3.4486422538757324
14_up proxy err 0.007114281412214041 err 65.19731903076172 tr(WHW.T) 9164.287109375
bpp_loss 3.637215648378645
14_gate proxy err 0.0016857108566910028 err 70.43881225585938 tr(WHW.T) 41785.8203125
bpp_loss 3.8602141993386403
14_down proxy err 0.010157419368624687 err 64.91521453857422 tr(WHW.T) 6390.916015625
bpp_loss 3.621612548828125
W0408 13:21:55.420863 669074 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 13:21:56.075671 669074 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:21:56.079992 650138 quantize_finetune_llama.py:220] layer 17 gpu 1
I0408 13:21:56.096455 669074 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
16_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]16_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:01,  1.61it/s]16_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.37it/s]I0408 13:21:57.726662 650138 quantize_finetune_llama.py:251] computed original embedding for layer 17 in 1.0666468143463135s
16_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:35,  2.76it/s]16_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.00it/s]16_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.15it/s]16_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.25it/s]1.6491181895617046e-06 0.015560057945549488 -0.016095735132694244
0.999973714351654 1.0161049365997314 0.9844245910644531
15_o proxy err 0.021670974791049957 err 17.942005157470703 tr(WHW.T) 827.9279174804688
bpp_loss 3.4808285236358643
15_up proxy err 0.007236468140035868 err 65.08891296386719 tr(WHW.T) 8994.5693359375
bpp_loss 3.629257849284581
15_gate proxy err 0.0015446410980075598 err 71.39017486572266 tr(WHW.T) 46217.96875
bpp_loss 3.8968233040400913
15_down proxy err 0.010122193023562431 err 64.77582550048828 tr(WHW.T) 6399.38671875
bpp_loss 3.616391454424177
16_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.33it/s]16_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.40it/s]16_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.42it/s]16_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.46it/s]16_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.47it/s]16_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.49it/s]16_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:24,  3.50it/s]16_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.49it/s]16_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.51it/s]I0408 13:22:01.360046 669222 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:22:01.360137 669222 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:22:01.360176 669222 utils.py:162] NumExpr defaulting to 16 threads.
16_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.52it/s]I0408 13:22:01.683256 669222 config.py:54] PyTorch version 2.6.0 available.
16_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.50it/s]W0408 13:22:01.871412 669222 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

16_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.49it/s]16_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.50it/s]W0408 13:22:02.413951 669222 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:22:02.417642 650138 quantize_finetune_llama.py:220] layer 18 gpu 2
I0408 13:22:02.430863 669222 data_utils.py:336] using 256 training seqs, 128 validation seqs
16_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.49it/s]v
17_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]16_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.50it/s]16_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:55,  1.78it/s]16_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.55it/s]I0408 13:22:03.824991 650138 quantize_finetune_llama.py:251] computed original embedding for layer 18 in 0.9968841075897217s
16_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.92it/s]16_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.11it/s]16_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.46it/s]17_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.26it/s]16_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.46it/s]17_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.39it/s]16_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.44it/s]17_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.46it/s]16_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.44it/s]17_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.46it/s]17_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.55it/s]16_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.58it/s]16_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.50it/s]17_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.59it/s]16_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.60it/s]16_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.61it/s]16_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.46it/s]17_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.60it/s]16_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.60it/s]I0408 13:22:07.393055 669361 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:22:07.393152 669361 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:22:07.393193 669361 utils.py:162] NumExpr defaulting to 16 threads.
16_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:18,  3.45it/s]17_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.60it/s]I0408 13:22:07.721543 669361 config.py:54] PyTorch version 2.6.0 available.
16_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.46it/s]17_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:22,  3.61it/s]W0408 13:22:07.909034 669361 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

17_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.62it/s]16_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.45it/s]17_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.61it/s]W0408 13:22:08.465943 669361 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

16_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.43it/s]I0408 13:22:08.469776 650138 quantize_finetune_llama.py:220] layer 19 gpu 3
I0408 13:22:08.483927 669361 data_utils.py:336] using 256 training seqs, 128 validation seqs
17_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.59it/s]16_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.41it/s]v
18_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]17_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:21,  3.59it/s]16_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.43it/s]17_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.58it/s]16_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.43it/s]18_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.83it/s]17_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.57it/s]16_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.43it/s]18_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.57it/s]17_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.59it/s]16_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.43it/s]I0408 13:22:09.965392 650138 quantize_finetune_llama.py:251] computed original embedding for layer 19 in 1.0913307666778564s
18_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.93it/s]17_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.57it/s]16_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.42it/s]18_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.14it/s]17_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.56it/s]16_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.27it/s]17_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.55it/s]16_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.37it/s]17_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.54it/s]16_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]17_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.55it/s]16_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.56it/s]16_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]17_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.58it/s]16_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:14,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.52it/s]17_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.58it/s]16_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.54it/s]17_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.57it/s]16_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.55it/s]17_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.57it/s]18_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.56it/s]16_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.40it/s]17_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.57it/s]18_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]16_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.39it/s]17_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.57it/s]18_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.55it/s]16_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.35it/s]17_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.55it/s]I0408 13:22:13.711119 669492 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:22:13.711204 669492 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:22:13.711242 669492 utils.py:162] NumExpr defaulting to 16 threads.
18_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.54it/s]16_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.37it/s]17_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.54it/s]18_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.53it/s]16_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:12,  3.42it/s]17_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]I0408 13:22:14.111964 669492 config.py:54] PyTorch version 2.6.0 available.
18_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.55it/s]W0408 13:22:14.312888 669492 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

17_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.54it/s]16_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]17_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.54it/s]16_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.56it/s]17_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.53it/s]16_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.41it/s]W0408 13:22:14.968408 669492 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:22:14.972552 650138 quantize_finetune_llama.py:220] layer 20 gpu 0
I0408 13:22:14.992727 669492 data_utils.py:336] using 256 training seqs, 128 validation seqs
18_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.57it/s]17_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.54it/s]17_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.50it/s]16_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.42it/s]v
19_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]18_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.54it/s]17_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.50it/s]18_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.56it/s]16_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:12,  2.86it/s]17_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]18_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.58it/s]16_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:11,  2.99it/s]17_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.50it/s]19_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:18,  1.26it/s]18_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.59it/s]16_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:10,  3.11it/s]17_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.51it/s]19_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:01<00:48,  2.03it/s]18_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.58it/s]16_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  3.19it/s]17_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.50it/s]19_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:38,  2.52it/s]18_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.54it/s]16_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.25it/s]17_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.50it/s]19_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:33,  2.84it/s]18_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.54it/s]16_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.29it/s]17_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.52it/s]19_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:31,  3.04it/s]18_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.55it/s]16_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.35it/s]17_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.52it/s]19_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.19it/s]18_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.55it/s]17_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.36it/s]19_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.28it/s]18_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.56it/s]17_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.37it/s]19_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.35it/s]18_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.55it/s]17_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.39it/s]19_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:03<00:26,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.54it/s]17_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.39it/s]19_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.42it/s]18_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.54it/s]17_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.40it/s]19_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.45it/s]18_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.56it/s]17_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.39it/s]19_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.46it/s]18_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.56it/s]17_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.40it/s]19_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.57it/s]17_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.40it/s]19_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.57it/s]17_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.49it/s]18_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.58it/s]17_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.53it/s]16_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:05<00:24,  3.49it/s]18_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.54it/s]17_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.53it/s]16_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.49it/s]18_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.53it/s]17_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.40it/s]19_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.50it/s]18_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]17_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.52it/s]16_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.42it/s]19_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.50it/s]18_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.53it/s]17_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.53it/s]16_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.50it/s]18_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.55it/s]18_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.55it/s]16_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.40it/s]19_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.44it/s]17_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.94it/s]18_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.55it/s]16_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.44it/s]17_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.09it/s]18_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.55it/s]19_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:07<00:22,  3.44it/s]16_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.39it/s]17_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.19it/s]18_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.57it/s]19_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.46it/s]16_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.37it/s]17_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.29it/s]18_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.56it/s]19_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.47it/s]16_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.38it/s]17_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.34it/s]18_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.56it/s]19_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.40it/s]16_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.54it/s]19_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.44it/s]16_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.54it/s]19_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.47it/s]16_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.52it/s]19_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.48it/s]16_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.54it/s]19_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:20,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.48it/s]16_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.38it/s]18_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.50it/s]19_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.48it/s]16_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.40it/s]18_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.50it/s]17_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.48it/s]16_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.39it/s]18_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.49it/s]16_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.41it/s]18_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.52it/s]19_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.48it/s]16_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.42it/s]18_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.52it/s]19_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.48it/s]16_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.41it/s]16_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.37it/s]
18_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.52it/s]19_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.52it/s]19_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.45it/s]18_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.44it/s]18_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.51it/s]19_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.53it/s]19_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.51it/s]19_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.95it/s]19_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.09it/s]19_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.21it/s]19_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.49it/s]18_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.27it/s]19_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.33it/s]19_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.46it/s]17_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.36it/s]19_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.47it/s]17_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.46it/s]18_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.46it/s]18_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.44it/s]19_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.49it/s]17_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.45it/s]19_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.50it/s]17_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.47it/s]19_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.46it/s]17_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.46it/s]18_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.47it/s]4.1414809857087675e-06 0.00486714718863368 -0.0049032834358513355
1.0001118183135986 1.004883885383606 0.9954776763916016
16_v proxy err 0.013315550051629543 err 3.6522114276885986 tr(WHW.T) 274.28167724609375
bpp_loss 3.460322141647339
16_q proxy err 0.0008955862140282989 err 21.929901123046875 tr(WHW.T) 24486.64453125
bpp_loss 4.261316299438477
16_k proxy err 0.0003364720905665308 err 6.563344955444336 tr(WHW.T) 19506.357421875
bpp_loss 5.185060977935791
o
16_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]19_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.48it/s]17_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.45it/s]17_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
18_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:06,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.48it/s]19_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]18_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.48it/s]18_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.48it/s]19_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.46it/s]18_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.48it/s]19_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.46it/s]18_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.50it/s]19_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.46it/s]18_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:04,  3.48it/s]19_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.45it/s]18_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.49it/s]19_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.48it/s]16_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:09,  3.13s/it]19_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.47it/s]19_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.47it/s]18_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.45it/s]18_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.45it/s]19_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:12,  2.70it/s]18_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:02,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:11,  2.89it/s]18_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.04it/s]18_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.44it/s]19_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.14it/s]18_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.45it/s]19_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.23it/s]18_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.44it/s]2.2655108296021353e-06 0.004926128312945366 -0.004891271237283945
1.000061273574829 1.0049136877059937 0.9951381683349609
17_v proxy err 0.01392501499503851 err 3.9543285369873047 tr(WHW.T) 283.9730224609375
bpp_loss 3.525369167327881
17_q proxy err 0.0008008552249521017 err 22.080732345581055 tr(WHW.T) 27571.44140625
bpp_loss 4.270614147186279
17_k proxy err 0.0003744197019841522 err 6.526065826416016 tr(WHW.T) 17429.814453125
bpp_loss 5.203762054443359
o
17_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]19_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.29it/s]18_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.45it/s]19_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.32it/s]18_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.38it/s]18_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]18_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.47it/s]
16_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]19_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.36it/s]19_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.38it/s]19_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.39it/s]19_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.38it/s]19_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.43it/s]19_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.44it/s]17_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]19_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.42it/s]19_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.44it/s]19_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.44it/s]19_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.45it/s]16_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.14s/it]19_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.43it/s]19_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.45it/s]19_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.42it/s]3.665945996544906e-06 0.005107476841658354 -0.004646994639188051
1.0001126527786255 1.0049822330474854 0.9954609870910645
18_v proxy err 0.012547757476568222 err 3.608907699584961 tr(WHW.T) 287.61376953125
bpp_loss 3.45471453666687
18_q proxy err 0.0009845246095210314 err 22.0528564453125 tr(WHW.T) 22399.498046875
bpp_loss 4.268903732299805
18_k proxy err 0.0003792875213548541 err 6.597634792327881 tr(WHW.T) 17394.810546875
bpp_loss 5.284782409667969
o
18_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]17_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]19_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.42it/s]19_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.41it/s]19_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.43it/s]19_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.44it/s]16_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]19_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.43it/s]19_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.43it/s]19_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.46it/s]19_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.47it/s]19_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.37it/s]
18_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]18_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:56,  3.15s/it]2.98893451144977e-06 0.004795711487531662 -0.004980423022061586
1.0000907182693481 1.004940152168274 0.9950945973396301
19_v proxy err 0.011156599968671799 err 3.8050663471221924 tr(WHW.T) 341.0596618652344
bpp_loss 3.492506742477417
19_q proxy err 0.0009143435745500028 err 21.979022979736328 tr(WHW.T) 24038.03515625
bpp_loss 4.268052577972412
19_k proxy err 0.00042292129364795983 err 6.577816486358643 tr(WHW.T) 15553.287109375
bpp_loss 5.181816101074219
o
19_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]18_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:22<04:52,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.10s/it]18_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:03,  3.10s/it]18_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.09s/it]18_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.10s/it]18_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.09s/it]18_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]18_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]18_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:30,  3.14s/it]18_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:34,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]18_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.21s/it]17_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.19s/it]18_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]19_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.18s/it]18_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]17_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]18_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]19_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]17_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]18_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.10s/it]16_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]16_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.13s/it]19_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]16_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:49,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.13s/it]19_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]16_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:37,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:49,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:34,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:46,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:38,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:43,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:35,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:42,  3.17s/it]16_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:25,  3.21s/it]17_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:26,  3.17s/it]18_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:31,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:37,  3.16s/it]16_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:21,  3.19s/it]17_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:21,  3.15s/it]18_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:27,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:33,  3.14s/it]16_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:16,  3.18s/it]17_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:17,  3.14s/it]18_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:23,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:29,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:16,  3.23s/it]17_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:14,  3.13s/it]18_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:20,  3.13s/it]19_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:26,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:12,  3.20s/it]18_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.13s/it]17_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:14,  3.18s/it]19_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.19s/it]18_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]17_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]17_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.15s/it]18_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.18s/it]19_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.17s/it]17_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.13s/it]18_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:09,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.16s/it]17_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]18_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:08<03:05,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]16_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:22<02:53,  3.16s/it]17_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]16_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]19_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]16_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:41<02:34,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:44<02:31,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:33<02:38,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:36<02:35,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:14,  3.21s/it]18_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:10,  3.19s/it]19_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:22,  3.10s/it]18_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.12s/it]17_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]16_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.18s/it]19_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.10s/it]18_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:10,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.15s/it]16_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]19_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]16_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]18_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]19_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.16s/it]18_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:22<01:53,  3.16s/it]18_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]17_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]17_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:43,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]17_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:23<01:49,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]17_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]17_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:41<01:34,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.12s/it]17_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:44<01:31,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:26,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:48<01:24,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:51<01:21,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:03<01:12,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:10,  3.21s/it]19_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:06,  3.19s/it]19_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]18_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.18s/it]19_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.15s/it]18_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.17s/it]19_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]18_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]16_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]18_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:10<01:03,  3.16s/it]16_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:22<00:53,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:13<00:59,  3.15s/it]16_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]17_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.14s/it]16_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]17_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.12s/it]17_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:41<00:34,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]17_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.14s/it]19_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:35<00:37,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.11s/it]17_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.17s/it]18_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:38<00:34,  3.17s/it]16_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.19s/it]19_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:41,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:25,  3.15s/it]18_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:41<00:31,  3.16s/it]16_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.18s/it]19_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.13s/it]18_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.14s/it]16_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:19,  3.17s/it]19_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:25,  3.13s/it]19_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.13s/it]16_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [05:00<00:15,  3.16s/it]17_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.13s/it]19_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:28,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:03<00:12,  3.16s/it]17_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.15s/it]17_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]16_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.21s/it]17_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.17s/it]18_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:00<00:12,  3.12s/it]19_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.19s/it]17_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.15s/it]18_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:03<00:09,  3.11s/it]19_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.11s/it]16_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.18s/it]16_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
17_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.14s/it]17_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
18_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.18s/it]19_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]18_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.12s/it]18_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]18_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.13s/it]
19_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.18s/it]19_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]19_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]19_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
1.442064217371808e-06 0.016071897000074387 -0.016128497198224068
0.9999667406082153 1.0161418914794922 0.9839052557945251
16_o proxy err 0.018384607508778572 err 17.816312789916992 tr(WHW.T) 969.0885620117188
bpp_loss 3.4610064029693604
16_up proxy err 0.0077932048588991165 err 64.9266128540039 tr(WHW.T) 8331.1826171875
bpp_loss 3.6152916976383755
16_gate proxy err 0.0017358771292492747 err 71.47669982910156 tr(WHW.T) 41176.12890625
bpp_loss 3.931856155395508
16_down proxy err 0.010269483551383018 err 64.577392578125 tr(WHW.T) 6288.2802734375
bpp_loss 3.603182111467634
1.4316719898488373e-06 0.0163566954433918 -0.015338344499468803
0.9999695420265198 1.0163841247558594 0.9849783182144165
17_o proxy err 0.01635158807039261 err 18.09629249572754 tr(WHW.T) 1106.6993408203125
bpp_loss 3.49489688873291
17_up proxy err 0.007671342696994543 err 64.84234619140625 tr(WHW.T) 8452.5419921875
bpp_loss 3.611156633922032
17_gate proxy err 0.0017206266056746244 err 71.78034973144531 tr(WHW.T) 41717.5625
bpp_loss 3.945538418633597
17_down proxy err 0.010374649427831173 err 64.45059204101562 tr(WHW.T) 6212.31494140625
bpp_loss 3.6013313020978654
I0408 13:28:26.535735 650138 quantize_finetune_llama.py:251] computed original embedding for layer 20 in 1.2930185794830322s
1.5851758234930458e-06 0.01347469910979271 -0.01304551586508751
0.9999608397483826 1.013481616973877 0.9885044693946838
18_o proxy err 0.014959567226469517 err 17.999256134033203 tr(WHW.T) 1203.193603515625
bpp_loss 3.4702937602996826
18_up proxy err 0.008108017034828663 err 64.72535705566406 tr(WHW.T) 7982.8837890625
bpp_loss 3.60653509412493
18_gate proxy err 0.0020315165165811777 err 71.59786224365234 tr(WHW.T) 35243.5546875
bpp_loss 3.9546501636505127
18_down proxy err 0.01034843735396862 err 64.43535614013672 tr(WHW.T) 6226.57861328125
bpp_loss 3.5990693228585378
I0408 13:28:30.639877 673587 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:28:30.639977 673587 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:28:30.640020 673587 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:28:31.033375 673587 config.py:54] PyTorch version 2.6.0 available.
W0408 13:28:31.246449 673587 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

W0408 13:28:31.887331 673587 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:28:31.891358 650138 quantize_finetune_llama.py:220] layer 21 gpu 1
I0408 13:28:31.905546 673587 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
20_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]20_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.71it/s]20_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:40,  2.42it/s]I0408 13:28:33.426655 650138 quantize_finetune_llama.py:251] computed original embedding for layer 21 in 1.055983304977417s
20_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.78it/s]20_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:32,  2.95it/s]20_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.10it/s]20_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.21it/s]20_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.26it/s]20_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.31it/s]20_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:27,  3.34it/s]20_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.36it/s]20_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.38it/s]20_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.39it/s]20_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.40it/s]20_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:25,  3.39it/s]1.966839590750169e-06 0.014239740557968616 -0.013528814539313316
0.9999558925628662 1.0142571926116943 0.988937258720398
19_o proxy err 0.01549664605408907 err 18.113903045654297 tr(WHW.T) 1168.891845703125
bpp_loss 3.484166383743286
19_up proxy err 0.0084524592384696 err 64.65532684326172 tr(WHW.T) 7649.2919921875
bpp_loss 3.6027462823050365
19_gate proxy err 0.002186940051615238 err 71.75786590576172 tr(WHW.T) 32811.99609375
bpp_loss 3.9663046087537492
19_down proxy err 0.010413345880806446 err 64.38296508789062 tr(WHW.T) 6182.73583984375
bpp_loss 3.597132819039481
20_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.42it/s]I0408 13:28:37.275733 673729 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:28:37.275843 673729 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:28:37.275887 673729 utils.py:162] NumExpr defaulting to 16 threads.
20_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.42it/s]I0408 13:28:37.629632 673729 config.py:54] PyTorch version 2.6.0 available.
20_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:24,  3.44it/s]W0408 13:28:37.816416 673729 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

20_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.45it/s]20_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.45it/s]W0408 13:28:38.406846 673729 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:28:38.410529 650138 quantize_finetune_llama.py:220] layer 22 gpu 2
I0408 13:28:38.431294 673729 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.44it/s]20_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:23,  3.43it/s]v
21_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]20_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.43it/s]20_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:07<00:22,  3.42it/s]21_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:54,  1.83it/s]20_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.43it/s]I0408 13:28:39.744731 650138 quantize_finetune_llama.py:251] computed original embedding for layer 22 in 0.9112186431884766s
21_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:38,  2.55it/s]20_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.42it/s]21_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.92it/s]20_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.44it/s]21_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.15it/s]20_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.44it/s]21_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.30it/s]20_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:21,  3.42it/s]21_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.39it/s]20_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.42it/s]21_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.45it/s]21_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.48it/s]20_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:20,  3.42it/s]21_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]20_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.43it/s]21_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.53it/s]20_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.45it/s]21_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.55it/s]20_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.45it/s]21_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.56it/s]20_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.45it/s]21_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.56it/s]20_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.43it/s]21_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]20_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.45it/s]I0408 13:28:43.363608 673886 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:28:43.363694 673886 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:28:43.363733 673886 utils.py:162] NumExpr defaulting to 16 threads.
21_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.57it/s]20_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.46it/s]21_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.57it/s]I0408 13:28:43.749695 673886 config.py:54] PyTorch version 2.6.0 available.
20_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.47it/s]W0408 13:28:43.950002 673886 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

21_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.58it/s]20_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.46it/s]21_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.59it/s]20_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.46it/s]21_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.60it/s]W0408 13:28:44.609616 673886 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:28:44.613707 650138 quantize_finetune_llama.py:220] layer 23 gpu 3
I0408 13:28:44.628664 673886 data_utils.py:336] using 256 training seqs, 128 validation seqs
20_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.45it/s]21_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.60it/s]20_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:17,  3.40it/s]21_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.59it/s]v
22_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]20_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.41it/s]21_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.58it/s]20_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.42it/s]21_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.57it/s]22_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:58,  1.70it/s]20_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.42it/s]21_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.59it/s]22_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.45it/s]20_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.42it/s]I0408 13:28:46.146780 650138 quantize_finetune_llama.py:251] computed original embedding for layer 23 in 1.0805037021636963s
21_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.59it/s]22_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.82it/s]20_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:14<00:15,  3.40it/s]21_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.58it/s]22_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.05it/s]20_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.37it/s]21_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.59it/s]22_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.20it/s]20_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:15,  3.36it/s]21_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.57it/s]22_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.29it/s]20_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.38it/s]21_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.58it/s]22_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.36it/s]21_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.59it/s]20_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.38it/s]22_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.40it/s]21_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.60it/s]20_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:14,  3.41it/s]22_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.44it/s]21_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:18,  3.59it/s]20_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.41it/s]22_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.47it/s]21_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.58it/s]20_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.42it/s]22_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.47it/s]21_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.56it/s]20_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.42it/s]22_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.56it/s]20_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.43it/s]22_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:24,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.58it/s]20_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.42it/s]22_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.52it/s]21_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.58it/s]20_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.53it/s]21_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.57it/s]20_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:12,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.54it/s]21_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.56it/s]I0408 13:28:50.140917 674024 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:28:50.141010 674024 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:28:50.141050 674024 utils.py:162] NumExpr defaulting to 16 threads.
20_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.42it/s]22_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.55it/s]21_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.56it/s]20_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.42it/s]I0408 13:28:50.547053 674024 config.py:54] PyTorch version 2.6.0 available.
22_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.55it/s]21_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.57it/s]W0408 13:28:50.750966 674024 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

20_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.43it/s]22_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.54it/s]21_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.57it/s]20_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.43it/s]22_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.54it/s]21_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.59it/s]20_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:19<00:10,  3.44it/s]W0408 13:28:51.422322 674024 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:28:51.426378 650138 quantize_finetune_llama.py:220] layer 24 gpu 0
22_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.54it/s]I0408 13:28:51.442052 674024 data_utils.py:336] using 256 training seqs, 128 validation seqs
21_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.58it/s]20_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.41it/s]22_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.52it/s]21_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.55it/s]20_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.53it/s]v
23_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]21_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.54it/s]22_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.54it/s]21_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.55it/s]20_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:11,  2.77it/s]22_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.54it/s]21_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.55it/s]20_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  2.92it/s]22_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.54it/s]23_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:19,  1.24it/s]21_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.55it/s]20_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.06it/s]22_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:01<00:49,  1.99it/s]21_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.54it/s]20_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.15it/s]22_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:39,  2.46it/s]21_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.54it/s]20_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.24it/s]22_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:34,  2.75it/s]21_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.53it/s]20_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.29it/s]22_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:31,  2.97it/s]21_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.54it/s]22_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.52it/s]20_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.32it/s]23_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:30,  3.13it/s]21_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.53it/s]22_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.53it/s]20_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.35it/s]23_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.24it/s]21_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.55it/s]22_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.53it/s]20_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.37it/s]23_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.31it/s]21_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.57it/s]22_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.52it/s]20_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.35it/s]23_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:03<00:27,  3.37it/s]21_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.57it/s]22_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.52it/s]20_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:23<00:06,  3.36it/s]23_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.41it/s]21_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.56it/s]22_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.53it/s]21_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.58it/s]20_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.35it/s]23_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.42it/s]22_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.52it/s]21_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.56it/s]23_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.44it/s]20_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.37it/s]22_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.53it/s]21_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.58it/s]23_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.46it/s]20_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.38it/s]22_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.54it/s]21_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.59it/s]23_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.47it/s]20_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.38it/s]22_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.53it/s]21_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.58it/s]23_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.47it/s]20_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.38it/s]22_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.52it/s]21_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.56it/s]23_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:05<00:24,  3.46it/s]20_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:05,  3.38it/s]22_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.51it/s]21_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.56it/s]23_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.47it/s]20_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:25<00:04,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.52it/s]21_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.56it/s]23_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.46it/s]20_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.53it/s]23_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:06<00:23,  3.45it/s]20_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.40it/s]21_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.89it/s]22_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.52it/s]23_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.45it/s]20_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:26<00:03,  3.39it/s]21_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.07it/s]22_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:23,  3.43it/s]20_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.41it/s]21_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.20it/s]22_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.45it/s]20_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.37it/s]21_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.30it/s]22_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.49it/s]23_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:07<00:22,  3.47it/s]20_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.38it/s]21_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.38it/s]22_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.48it/s]20_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.40it/s]21_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.42it/s]22_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]20_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.41it/s]21_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.47it/s]22_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:08<00:21,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.50it/s]20_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.51it/s]20_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:28<00:01,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.49it/s]23_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.52it/s]20_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.39it/s]22_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.53it/s]20_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:19,  3.51it/s]21_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.53it/s]20_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.41it/s]22_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.52it/s]21_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.55it/s]20_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.49it/s]23_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.51it/s]21_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.56it/s]20_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.39it/s]22_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.47it/s]23_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:10<00:19,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.55it/s]20_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.39it/s]20_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.35it/s]
22_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.47it/s]23_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.48it/s]21_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.55it/s]22_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.47it/s]23_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.57it/s]22_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.48it/s]21_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.57it/s]22_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.56it/s]22_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.49it/s]23_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.56it/s]22_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.48it/s]21_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.55it/s]22_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.53it/s]23_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:12<00:17,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.54it/s]22_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.54it/s]23_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.47it/s]21_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.53it/s]22_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.78it/s]23_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.53it/s]22_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  2.98it/s]23_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:15,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.53it/s]22_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:09,  3.12it/s]23_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.51it/s]22_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.22it/s]23_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.48it/s]21_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.51it/s]22_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.30it/s]23_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:14<00:15,  3.47it/s]21_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.50it/s]22_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.37it/s]23_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.47it/s]21_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.50it/s]22_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.42it/s]23_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.48it/s]21_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.46it/s]22_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.44it/s]23_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.48it/s]21_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.49it/s]22_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.45it/s]23_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.48it/s]21_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.47it/s]22_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.50it/s]21_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.49it/s]21_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.50it/s]
22_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.50it/s]4.100193109479733e-06 0.00461878627538681 -0.004673246759921312
1.000062346458435 1.004654884338379 0.9954054355621338
20_v proxy err 0.012071516364812851 err 3.985919952392578 tr(WHW.T) 330.192138671875
bpp_loss 3.5260562896728516
20_q proxy err 0.001048916019499302 err 21.75214958190918 tr(WHW.T) 20737.7421875
bpp_loss 4.24091362953186
20_k proxy err 0.0004233501385897398 err 6.517818450927734 tr(WHW.T) 15395.810546875
bpp_loss 5.130876541137695
o
20_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]23_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.46it/s]22_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.52it/s]23_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.45it/s]22_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:05,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.46it/s]22_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.52it/s]23_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.49it/s]22_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.50it/s]22_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.52it/s]23_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.48it/s]22_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.53it/s]23_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.49it/s]22_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.53it/s]23_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.49it/s]22_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.53it/s]23_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.49it/s]22_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:03,  3.54it/s]23_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.50it/s]22_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.53it/s]23_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.50it/s]22_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.53it/s]20_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:10,  3.14s/it]23_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.49it/s]22_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.46it/s]22_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.46it/s]22_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.51it/s]22_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:12,  2.65it/s]22_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:11,  2.84it/s]22_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.49it/s]23_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.00it/s]22_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.51it/s]3.900193405570462e-06 0.004682443104684353 -0.004892607219517231
1.0000455379486084 1.0048871040344238 0.995395302772522
21_v proxy err 0.011241600848734379 err 4.079274654388428 tr(WHW.T) 362.87310791015625
bpp_loss 3.5488121509552
21_q proxy err 0.0008498181705363095 err 21.95769691467285 tr(WHW.T) 25838.111328125
bpp_loss 4.236547946929932
21_k proxy err 0.0003884317120537162 err 6.520779132843018 tr(WHW.T) 16787.453125
bpp_loss 5.175832748413086
o
21_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]23_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.14it/s]22_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.50it/s]23_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.23it/s]22_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.29it/s]22_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.36it/s]22_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.51it/s]20_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]23_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.40it/s]22_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.51it/s]22_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.45it/s]
23_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.43it/s]23_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.45it/s]23_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.44it/s]23_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.45it/s]23_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.46it/s]23_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.48it/s]21_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.09s/it]23_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.48it/s]23_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.46it/s]23_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.47it/s]23_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.44it/s]20_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.14s/it]23_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.43it/s]23_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.45it/s]23_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]23_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.47it/s]23_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.47it/s]23_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.46it/s]21_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]23_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.46it/s]23_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.47it/s]3.88960415875772e-06 0.004730053246021271 -0.004434346687048674
1.0000180006027222 1.004731297492981 0.9954075217247009
22_v proxy err 0.012282007373869419 err 4.25054407119751 tr(WHW.T) 346.0789489746094
bpp_loss 3.5875799655914307
22_q proxy err 0.0010644346475601196 err 21.62889289855957 tr(WHW.T) 20319.60546875
bpp_loss 4.196983098983765
22_k proxy err 0.00043987983372062445 err 6.476833820343018 tr(WHW.T) 14724.09765625
bpp_loss 5.106654644012451
o
22_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]23_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.47it/s]23_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.49it/s]23_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.51it/s]20_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]23_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.53it/s]23_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.52it/s]23_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.51it/s]23_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.52it/s]23_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.52it/s]23_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]
21_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]22_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.15s/it]4.666207132686395e-06 0.004832460079342127 -0.004617908038198948
0.9999964237213135 1.0045814514160156 0.9953646659851074
23_v proxy err 0.011266876943409443 err 4.4831695556640625 tr(WHW.T) 397.90704345703125
bpp_loss 3.628558397293091
23_q proxy err 0.0009648879640735686 err 21.815086364746094 tr(WHW.T) 22608.931640625
bpp_loss 4.20421576499939
23_k proxy err 0.0004347716167103499 err 6.45960807800293 tr(WHW.T) 14857.474609375
bpp_loss 5.10703706741333
o
23_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]21_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:52,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:05,  3.08s/it]21_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.09s/it]21_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.09s/it]21_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:43,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.09s/it]21_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]21_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:40,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:46,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:30,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:39,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:21,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:18,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.21s/it]21_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.19s/it]21_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]22_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]21_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]22_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]23_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.13s/it]22_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.13s/it]22_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]20_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.13s/it]23_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]20_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:49,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.13s/it]23_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]20_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:49,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:47,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:43,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:18,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:18,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:15,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:27,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:15,  3.20s/it]21_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:24,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:11,  3.18s/it]21_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]22_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.17s/it]21_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:13,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:18,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]22_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]23_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.13s/it]22_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:12,  3.16s/it]20_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.13s/it]23_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.15s/it]20_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]23_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]20_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:47,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]20_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:50,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:47,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:31,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:28,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:34,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:28,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:03<02:14,  3.21s/it]22_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:25,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:10,  3.19s/it]22_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:47<02:22,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]20_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:06,  3.17s/it]22_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]20_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]22_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:01<02:13,  3.17s/it]23_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]20_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]22_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.16s/it]23_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]20_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.16s/it]22_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.13s/it]23_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:25<01:50,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]23_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:46,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:01,  3.13s/it]21_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:43,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:12<01:58,  3.12s/it]21_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:46,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:47<01:28,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:25,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:24,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:24,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:40<01:29,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:21,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:43<01:26,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:06<01:10,  3.21s/it]23_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]21_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:06,  3.19s/it]23_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.16s/it]22_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.18s/it]23_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]22_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:09,  3.18s/it]20_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.17s/it]23_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.10s/it]21_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]22_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.16s/it]23_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.17s/it]21_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]22_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:08,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:21<00:53,  3.16s/it]21_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]20_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:25<00:50,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:05<01:06,  3.17s/it]21_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.13s/it]20_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]20_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]20_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.13s/it]20_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.12s/it]22_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.12s/it]20_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:44<00:31,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:47<00:28,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:28,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:33<00:37,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:36<00:34,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:06<00:09,  3.15s/it]21_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]22_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.11s/it]20_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.21s/it]21_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.17s/it]22_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.12s/it]23_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.19s/it]21_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]23_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.10s/it]20_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.18s/it]20_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.16s/it]
21_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.14s/it]21_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
22_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.17s/it]23_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.10s/it]22_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]23_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:01<00:09,  3.10s/it]22_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]22_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
23_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.17s/it]23_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]23_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.14s/it]23_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
1.3694312883671955e-06 0.015980849042534828 -0.015428123995661736
0.9999570250511169 1.0159965753555298 0.9859259724617004
20_o proxy err 0.01498753298074007 err 18.061819076538086 tr(WHW.T) 1205.1229248046875
bpp_loss 3.471767544746399
20_up proxy err 0.008510074578225613 err 64.67366027832031 tr(WHW.T) 7599.658203125
bpp_loss 3.6063328811100552
20_gate proxy err 0.0023358722683042288 err 71.62956237792969 tr(WHW.T) 30665.015625
bpp_loss 3.9688989434923445
20_down proxy err 0.010229473002254963 err 64.45449829101562 tr(WHW.T) 6300.8623046875
bpp_loss 3.6012272153581892
1.9382725895411568e-06 0.013653980568051338 -0.014358886517584324
0.9999644756317139 1.0143725872039795 0.9890099167823792
21_o proxy err 0.014140678569674492 err 17.911558151245117 tr(WHW.T) 1266.6689453125
bpp_loss 3.496433734893799
21_up proxy err 0.008325259201228619 err 64.70866394042969 tr(WHW.T) 7772.57080078125
bpp_loss 3.6093101501464844
21_gate proxy err 0.0022757654078304768 err 71.83768463134766 tr(WHW.T) 31566.3828125
bpp_loss 3.9811168057577953
21_down proxy err 0.010161545127630234 err 64.54069519042969 tr(WHW.T) 6351.46484375
bpp_loss 3.60399900163923
I0408 13:35:01.957736 650138 quantize_finetune_llama.py:251] computed original embedding for layer 24 in 1.0775866508483887s
I0408 13:35:06.081146 678106 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:35:06.081251 678106 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:35:06.081295 678106 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:35:06.468701 678106 config.py:54] PyTorch version 2.6.0 available.
W0408 13:35:06.679185 678106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

1.567004801472649e-06 0.015099669806659222 -0.014325611293315887
0.9999500513076782 1.01511812210083 0.9856778979301453
22_o proxy err 0.015214214101433754 err 18.589197158813477 tr(WHW.T) 1221.8309326171875
bpp_loss 3.5182477235794067
22_up proxy err 0.008584150113165379 err 64.78677368164062 tr(WHW.T) 7547.25537109375
bpp_loss 3.6130397660391673
22_gate proxy err 0.0024332080502063036 err 71.86260986328125 tr(WHW.T) 29534.099609375
bpp_loss 3.9855318750653947
22_down proxy err 0.009887748397886753 err 64.56196594238281 tr(WHW.T) 6529.4912109375
bpp_loss 3.6077985763549805
W0408 13:35:07.314132 678106 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:35:07.318212 650138 quantize_finetune_llama.py:220] layer 25 gpu 1
I0408 13:35:07.333198 678106 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
24_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]24_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:01,  1.61it/s]24_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:41,  2.37it/s]24_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:35,  2.75it/s]24_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.01it/s]I0408 13:35:09.362915 650138 quantize_finetune_llama.py:251] computed original embedding for layer 25 in 1.2199242115020752s
24_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:30,  3.13it/s]24_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.22it/s]24_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.29it/s]24_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.34it/s]24_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.37it/s]24_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.39it/s]24_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.41it/s]24_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.43it/s]24_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.44it/s]24_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.45it/s]24_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.47it/s]1.3783944723400054e-06 0.01506622601300478 -0.013754468411207199
0.9999474287033081 1.0150928497314453 0.988591730594635
23_o proxy err 0.010773889720439911 err 18.794736862182617 tr(WHW.T) 1744.470947265625
bpp_loss 3.541361093521118
23_up proxy err 0.008747600950300694 err 64.9002685546875 tr(WHW.T) 7419.2080078125
bpp_loss 3.617288725716727
23_gate proxy err 0.002631426090374589 err 71.81596374511719 tr(WHW.T) 27291.65234375
bpp_loss 3.9889912605285645
23_down proxy err 0.009700164198875427 err 64.67085266113281 tr(WHW.T) 6666.9853515625
bpp_loss 3.612213815961565
24_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.46it/s]24_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.48it/s]I0408 13:35:13.206712 678261 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:35:13.206799 678261 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:35:13.206835 678261 utils.py:162] NumExpr defaulting to 16 threads.
24_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.47it/s]I0408 13:35:13.547993 678261 config.py:54] PyTorch version 2.6.0 available.
24_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.47it/s]W0408 13:35:13.737573 678261 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

24_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.47it/s]24_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.49it/s]W0408 13:35:14.303056 678261 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:35:14.306702 650138 quantize_finetune_llama.py:220] layer 26 gpu 2
I0408 13:35:14.324323 678261 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.46it/s]24_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:22,  3.45it/s]v
25_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]24_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:22,  3.45it/s]25_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:52,  1.87it/s]24_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.45it/s]25_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.62it/s]24_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.45it/s]I0408 13:35:15.851180 650138 quantize_finetune_llama.py:251] computed original embedding for layer 26 in 1.0781869888305664s
25_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.94it/s]24_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.16it/s]24_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.45it/s]25_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.30it/s]24_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.46it/s]25_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.38it/s]24_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:20,  3.47it/s]25_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.44it/s]24_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.48it/s]25_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]24_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.48it/s]25_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.52it/s]24_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.47it/s]25_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.54it/s]24_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.58it/s]24_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.47it/s]25_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.58it/s]24_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.46it/s]25_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.60it/s]24_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.46it/s]25_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:23,  3.58it/s]24_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.45it/s]25_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.60it/s]I0408 13:35:19.418364 678400 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:35:19.418451 678400 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:35:19.418488 678400 utils.py:162] NumExpr defaulting to 16 threads.
24_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.45it/s]25_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.60it/s]24_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.46it/s]25_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:23,  3.60it/s]I0408 13:35:19.801316 678400 config.py:54] PyTorch version 2.6.0 available.
W0408 13:35:19.996879 678400 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

24_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.62it/s]24_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.45it/s]25_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.62it/s]24_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.45it/s]25_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.62it/s]W0408 13:35:20.697877 678400 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:35:20.701871 650138 quantize_finetune_llama.py:220] layer 27 gpu 3
I0408 13:35:20.716872 678400 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.46it/s]25_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:21,  3.61it/s]24_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:16,  3.43it/s]25_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.60it/s]v
26_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]25_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.60it/s]24_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.43it/s]25_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.60it/s]24_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.46it/s]26_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:57,  1.72it/s]25_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.61it/s]24_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:15,  3.46it/s]26_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.50it/s]25_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.62it/s]24_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.46it/s]I0408 13:35:22.368363 650138 quantize_finetune_llama.py:251] computed original embedding for layer 27 in 1.1912062168121338s
26_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.88it/s]25_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.55it/s]24_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.09it/s]25_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.55it/s]24_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:14,  3.42it/s]26_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.22it/s]25_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.56it/s]24_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:14,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.35it/s]25_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.42it/s]25_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.44it/s]26_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.49it/s]25_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.58it/s]24_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.44it/s]26_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.51it/s]25_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.59it/s]24_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.45it/s]26_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.53it/s]25_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.59it/s]26_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.54it/s]24_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.60it/s]26_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.53it/s]24_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.61it/s]26_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.56it/s]24_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.62it/s]26_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.61it/s]26_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.56it/s]24_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.42it/s]25_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:16,  3.60it/s]26_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.42it/s]25_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.59it/s]26_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.41it/s]I0408 13:35:26.450145 678538 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:35:26.450299 678538 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:35:26.450356 678538 utils.py:162] NumExpr defaulting to 16 threads.
25_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.41it/s]25_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:11<00:16,  3.58it/s]I0408 13:35:26.857008 678538 config.py:54] PyTorch version 2.6.0 available.
26_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.43it/s]25_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.58it/s]W0408 13:35:27.063688 678538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

26_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.44it/s]25_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.59it/s]26_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.60it/s]26_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.58it/s]W0408 13:35:27.736652 678538 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:35:27.741047 650138 quantize_finetune_llama.py:220] layer 28 gpu 0
I0408 13:35:27.761925 678538 data_utils.py:336] using 256 training seqs, 128 validation seqs
24_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.81it/s]25_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.58it/s]24_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:10,  2.96it/s]25_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.59it/s]26_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.56it/s]24_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.07it/s]25_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.59it/s]v
27_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]26_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:20,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.16it/s]25_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:13<00:14,  3.60it/s]26_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.24it/s]25_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:13,  3.60it/s]26_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.55it/s]27_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:14,  1.33it/s]25_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.60it/s]24_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.30it/s]26_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:01<00:46,  2.09it/s]25_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.58it/s]24_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.34it/s]26_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:37,  2.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.60it/s]24_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.34it/s]26_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:33,  2.85it/s]25_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.59it/s]24_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.39it/s]26_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:31,  3.06it/s]25_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.39it/s]26_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.20it/s]25_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.56it/s]24_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.29it/s]25_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.59it/s]27_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.35it/s]24_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.42it/s]26_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:03<00:26,  3.40it/s]24_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:16<00:11,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.43it/s]24_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.42it/s]24_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.43it/s]26_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.45it/s]24_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.42it/s]26_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.47it/s]24_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.39it/s]26_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.49it/s]24_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.41it/s]26_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.52it/s]26_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.42it/s]25_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:05<00:23,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:15,  3.58it/s]24_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.42it/s]27_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.97it/s]24_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.43it/s]27_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  3.13it/s]24_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.24it/s]24_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:19<00:09,  3.33it/s]24_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.43it/s]27_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.40it/s]24_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.40it/s]27_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.46it/s]24_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.43it/s]27_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:20<00:07,  3.49it/s]24_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.51it/s]24_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.53it/s]24_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.55it/s]24_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.45it/s]27_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:20,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:21<00:06,  3.56it/s]24_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.57it/s]24_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.43it/s]27_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:19,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.56it/s]24_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.44it/s]24_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]
26_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.59it/s]27_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.59it/s]27_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:23<00:04,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:24<00:03,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.57it/s]25_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:16,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:25<00:02,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:12,  2.70it/s]27_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.56it/s]25_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:11,  2.89it/s]27_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.55it/s]25_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:10,  3.05it/s]27_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.54it/s]25_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.21it/s]27_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.52it/s]25_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:26<00:01,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.30it/s]27_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.53it/s]25_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.36it/s]27_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.52it/s]25_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.57it/s]26_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.40it/s]27_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.54it/s]25_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:27<00:00,  3.58it/s]26_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.45it/s]3.392152848391561e-06 0.004906106274574995 -0.004770379513502121
0.9999769330024719 1.0045157670974731 0.9950966835021973
24_v proxy err 0.010194787755608559 err 4.763803482055664 tr(WHW.T) 467.2783508300781
bpp_loss 3.7087900638580322
24_q proxy err 0.000966545834671706 err 21.685518264770508 tr(WHW.T) 22436.099609375
bpp_loss 4.169379472732544
24_k proxy err 0.00044933019671589136 err 6.373045444488525 tr(WHW.T) 14183.4345703125
bpp_loss 4.934964179992676
o
24_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]27_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.54it/s]25_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.54it/s]25_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.58it/s]25_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.53it/s]
26_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.48it/s]27_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.55it/s]27_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.54it/s]27_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.56it/s]27_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]26_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.55it/s]27_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.52it/s]26_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.55it/s]27_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.54it/s]26_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.54it/s]24_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:09,  3.13s/it]27_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.56it/s]27_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.51it/s]26_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.56it/s]27_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.51it/s]26_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.56it/s]27_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.51it/s]26_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.52it/s]26_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.53it/s]26_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:12,  2.73it/s]26_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.57it/s]3.5786783882940654e-06 0.004679871257394552 -0.004757692571729422
0.999972939491272 1.004759430885315 0.9953219294548035
25_v proxy err 0.008634109981358051 err 4.816181182861328 tr(WHW.T) 557.8086547851562
bpp_loss 3.717824935913086
25_q proxy err 0.0008287375094369054 err 21.640018463134766 tr(WHW.T) 26112.029296875
bpp_loss 4.148374080657959
25_k proxy err 0.0004395585274323821 err 6.336948394775391 tr(WHW.T) 14416.6201171875
bpp_loss 4.92311954498291
o
25_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]27_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  2.93it/s]26_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.58it/s]27_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.08it/s]26_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.57it/s]24_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:07,  3.14s/it]27_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.20it/s]26_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.55it/s]27_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.29it/s]26_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.57it/s]27_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.34it/s]26_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.56it/s]27_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.37it/s]26_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.56it/s]26_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.49it/s]
27_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.41it/s]27_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.43it/s]27_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.44it/s]27_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.46it/s]27_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.46it/s]25_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.09s/it]27_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.51it/s]24_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:03,  3.13s/it]27_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.47it/s]27_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.51it/s]27_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.50it/s]25_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.11s/it]27_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.46it/s]4.1957209759857506e-06 0.004633193835616112 -0.004658002872020006
0.999973714351654 1.0045753717422485 0.9954102635383606
26_v proxy err 0.01116855163127184 err 4.85324764251709 tr(WHW.T) 434.54583740234375
bpp_loss 3.7817161083221436
26_q proxy err 0.0010043727234005928 err 21.496871948242188 tr(WHW.T) 21403.28125
bpp_loss 4.155888557434082
26_k proxy err 0.0004124769475311041 err 6.362698554992676 tr(WHW.T) 15425.5859375
bpp_loss 4.996563911437988
o
26_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]24_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]27_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.48it/s]27_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.49it/s]27_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.50it/s]27_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.52it/s]27_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.53it/s]27_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.54it/s]27_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.56it/s]27_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.44it/s]
25_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:57,  3.13s/it]25_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.14s/it]3.8087760003691074e-06 0.004454519599676132 -0.004578552208840847
0.9999668598175049 1.0045124292373657 0.9955839514732361
27_v proxy err 0.0074621387757360935 err 5.0570454597473145 tr(WHW.T) 677.69384765625
bpp_loss 3.8454525470733643
27_q proxy err 0.0010107361013069749 err 21.534711837768555 tr(WHW.T) 21305.96875
bpp_loss 4.126901626586914
27_k proxy err 0.00045448984019458294 err 6.368138790130615 tr(WHW.T) 14011.6201171875
bpp_loss 4.950887203216553
o
27_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]25_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:51,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:04,  3.07s/it]25_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:48,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.09s/it]25_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:55,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:45,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.09s/it]25_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:52,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:42,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:56,  3.09s/it]25_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]25_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:50,  3.09s/it]25_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:43,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:47,  3.09s/it]25_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:29,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:44,  3.09s/it]25_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:26,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:23,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:38,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:20,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:35,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:17,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:32,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:29,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:16,  3.20s/it]27_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:11,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:11,  3.18s/it]27_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:15,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]24_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<03:59,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.15s/it]24_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.14s/it]24_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:52,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.17s/it]25_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]24_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:49,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:04,  3.13s/it]25_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:00,  3.13s/it]25_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:56,  3.12s/it]25_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:53,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:50,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:47,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:46<03:27,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:26<03:43,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:21,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:17,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:14,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:02<03:15,  3.20s/it]25_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:05<03:10,  3.18s/it]25_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:16,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:06,  3.17s/it]25_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:18,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.16s/it]25_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:54<03:15,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<02:59,  3.16s/it]25_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]24_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:08,  3.14s/it]24_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:24<02:49,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:04,  3.13s/it]24_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:27<02:46,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:01,  3.13s/it]24_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:57,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:34,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:30,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:46<02:27,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:42,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:49<02:24,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:12,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:26,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:05<02:11,  3.21s/it]25_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:22,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.19s/it]25_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:19,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]25_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]25_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:09,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.16s/it]25_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]26_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:05,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.16s/it]25_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]26_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.16s/it]24_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:24<01:50,  3.16s/it]25_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:05,  3.15s/it]24_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:27<01:47,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:02,  3.14s/it]24_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:44,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]24_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:41,  3.16s/it]25_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:46,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:42,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:46<01:28,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:49<01:25,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:26,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:40<01:30,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:05<01:09,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.20s/it]26_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]24_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.19s/it]26_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.16s/it]24_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.18s/it]26_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]24_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:57,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.14s/it]24_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:21<00:53,  3.17s/it]26_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:08,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:24<00:50,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]27_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:05<01:06,  3.15s/it]25_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:27<00:47,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]25_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]27_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]25_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:40,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.13s/it]25_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:53,  3.12s/it]25_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:43<00:31,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:46<00:28,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:49<00:25,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.11s/it]27_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.10s/it]25_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:21,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:33<00:37,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:28,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.11s/it]24_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:28,  3.12s/it]25_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.10s/it]24_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:05<00:09,  3.14s/it]26_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.12s/it]27_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.12s/it]25_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.10s/it]26_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:08<00:06,  3.21s/it]27_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.16s/it]26_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.19s/it]27_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.12s/it]24_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.18s/it]24_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.15s/it]
27_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.11s/it]25_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.13s/it]25_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
26_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.17s/it]27_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:01<00:09,  3.11s/it]26_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]26_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
27_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.18s/it]27_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.16s/it]27_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.15s/it]27_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
1.5450470982614206e-06 0.011118398979306221 -0.009272408671677113
0.9999524354934692 1.0111398696899414 0.9911551475524902
24_o proxy err 0.011917580850422382 err 18.942899703979492 tr(WHW.T) 1589.4920654296875
bpp_loss 3.5949443578720093
24_up proxy err 0.008879412896931171 err 64.91866302490234 tr(WHW.T) 7311.1435546875
bpp_loss 3.621901750564575
24_gate proxy err 0.0027765301056206226 err 71.8489990234375 tr(WHW.T) 25877.26171875
bpp_loss 3.995889970234462
24_down proxy err 0.009619932621717453 err 64.85697937011719 tr(WHW.T) 6741.93701171875
bpp_loss 3.617424556187221
1.0509324965823907e-06 0.014205713756382465 -0.013838962651789188
0.9999529123306274 1.014225959777832 0.9891458749771118
25_o proxy err 0.009519211016595364 err 18.947811126708984 tr(WHW.T) 1990.481201171875
bpp_loss 3.5982935428619385
25_up proxy err 0.0088009312748909 err 64.97015380859375 tr(WHW.T) 7382.19091796875
bpp_loss 3.6310696601867676
25_gate proxy err 0.0027371023315936327 err 72.00614166259766 tr(WHW.T) 26307.435546875
bpp_loss 4.005198376519339
25_down proxy err 0.009815041907131672 err 64.93583679199219 tr(WHW.T) 6615.951171875
bpp_loss 3.626546178545271
I0408 13:41:36.735133 650138 quantize_finetune_llama.py:251] computed original embedding for layer 28 in 1.0850536823272705s
I0408 13:41:40.982200 682613 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:41:40.982308 682613 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:41:40.982354 682613 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:41:41.407572 682613 config.py:54] PyTorch version 2.6.0 available.
W0408 13:41:41.627073 682613 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

1.4158210888126632e-06 0.012639367952942848 -0.01354999840259552
0.9999605417251587 1.0135713815689087 0.987333357334137
26_o proxy err 0.007937867194414139 err 18.961374282836914 tr(WHW.T) 2388.72412109375
bpp_loss 3.6251672506332397
26_up proxy err 0.00852623675018549 err 65.18867492675781 tr(WHW.T) 7645.65625
bpp_loss 3.6397834164755687
26_gate proxy err 0.0024900499265640974 err 71.9660415649414 tr(WHW.T) 28901.4453125
bpp_loss 4.00994838987078
26_down proxy err 0.00981805007904768 err 64.98395538330078 tr(WHW.T) 6618.82470703125
bpp_loss 3.6353074482509067
W0408 13:41:42.290158 682613 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:41:42.294292 650138 quantize_finetune_llama.py:220] layer 29 gpu 1
I0408 13:41:42.309470 682613 data_utils.py:336] using 256 training seqs, 128 validation seqs
v
28_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.76it/s]28_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.49it/s]I0408 13:41:43.907829 650138 quantize_finetune_llama.py:251] computed original embedding for layer 29 in 0.9494838714599609s
28_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:34,  2.81it/s]28_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.03it/s]28_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.17it/s]28_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:28,  3.25it/s]28_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.30it/s]28_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.35it/s]28_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.38it/s]28_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.40it/s]28_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:26,  3.42it/s]28_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.43it/s]28_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.44it/s]28_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:25,  3.42it/s]28_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.42it/s]I0408 13:41:47.742662 682784 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:41:47.742749 682784 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:41:47.742786 682784 utils.py:162] NumExpr defaulting to 16 threads.
28_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:24,  3.45it/s]1.3319215668161632e-06 0.01624486967921257 -0.017032494768500328
0.9999591708183289 1.0170564651489258 0.9841537475585938
27_o proxy err 0.008883768692612648 err 19.188549041748047 tr(WHW.T) 2159.9560546875
bpp_loss 3.65808641910553
27_up proxy err 0.007730261422693729 err 65.51856231689453 tr(WHW.T) 8475.5947265625
bpp_loss 3.653531381062099
27_gate proxy err 0.0022017736919224262 err 72.23807525634766 tr(WHW.T) 32809.0390625
bpp_loss 4.017937523978097
27_down proxy err 0.009950419887900352 err 65.10916137695312 tr(WHW.T) 6543.35791015625
bpp_loss 3.6475155694144115
28_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.47it/s]I0408 13:41:48.113266 682784 config.py:54] PyTorch version 2.6.0 available.
W0408 13:41:48.311060 682784 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

28_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:22,  3.49it/s]W0408 13:41:48.917253 682784 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:41:48.920906 650138 quantize_finetune_llama.py:220] layer 30 gpu 2
I0408 13:41:48.936610 682784 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.48it/s]v
29_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:51,  1.92it/s]28_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.51it/s]I0408 13:41:50.152148 650138 quantize_finetune_llama.py:251] computed original embedding for layer 30 in 0.7648777961730957s
29_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:37,  2.62it/s]28_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:32,  2.96it/s]28_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:30,  3.17it/s]28_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:28,  3.31it/s]28_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:27,  3.40it/s]28_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:26,  3.47it/s]28_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:20,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:25,  3.54it/s]28_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:24,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:18,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.55it/s]I0408 13:41:53.767697 682915 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:41:53.767788 682915 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:41:53.767845 682915 utils.py:162] NumExpr defaulting to 16 threads.
28_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.50it/s]I0408 13:41:54.157986 682915 config.py:54] PyTorch version 2.6.0 available.
29_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.50it/s]W0408 13:41:54.356143 682915 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

29_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:04<00:23,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.55it/s]28_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:16,  3.51it/s]W0408 13:41:55.011504 682915 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:41:55.015423 650138 quantize_finetune_llama.py:220] layer 31 gpu 3
29_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.55it/s]I0408 13:41:55.030323 682915 data_utils.py:336] using 256 training seqs, 128 validation seqs
28_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.52it/s]29_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.51it/s]v
30_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:16,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<00:56,  1.75it/s]28_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:06<00:21,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:00<00:39,  2.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.52it/s]I0408 13:41:56.795994 650138 quantize_finetune_llama.py:251] computed original embedding for layer 31 in 1.2994210720062256s
30_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:33,  2.87it/s]28_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:31,  3.08it/s]28_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:29,  3.23it/s]28_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:01<00:28,  3.33it/s]28_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:27,  3.40it/s]28_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:26,  3.45it/s]28_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:08<00:19,  3.55it/s]30_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:02<00:26,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:25,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:13,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:18,  3.55it/s]30_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.56it/s]30_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:24,  3.54it/s]28_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.57it/s]30_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:03<00:24,  3.54it/s]28_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:17,  3.59it/s]30_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.56it/s]30_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:23,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:10<00:17,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:04<00:23,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:23,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:10,  3.47it/s]I0408 13:42:00.973740 683053 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:42:00.973894 683053 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:42:00.973939 683053 utils.py:162] NumExpr defaulting to 16 threads.
29_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:22,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:22,  3.57it/s]I0408 13:42:01.396911 683053 config.py:54] PyTorch version 2.6.0 available.
29_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.48it/s]W0408 13:42:01.600674 683053 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

30_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:05<00:22,  3.58it/s]29_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.58it/s]29_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:21,  3.58it/s]W0408 13:42:02.280750 683053 warnings.py:109] /opt/conda/lib/python3.10/site-packages/compressai/models/video/google.py:353: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @amp.autocast(enabled=False)

I0408 13:42:02.301120 683053 data_utils.py:336] using 256 training seqs, 128 validation seqs
29_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.57it/s]30_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:06<00:21,  3.58it/s]29_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:12,  2.72it/s]30_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.56it/s]29_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:14,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:11,  2.89it/s]v
31_v_torch.Size([1024, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]30_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.56it/s]29_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.04it/s]30_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:20,  3.57it/s]29_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.15it/s]30_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:07<00:20,  3.56it/s]31_v_torch.Size([1024, 4096])_bs1024:   1%|          | 1/100 [00:00<01:13,  1.35it/s]29_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:13,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:08,  3.23it/s]30_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.55it/s]31_v_torch.Size([1024, 4096])_bs1024:   2%|▏         | 2/100 [00:01<00:46,  2.11it/s]29_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:13,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.30it/s]30_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.55it/s]31_v_torch.Size([1024, 4096])_bs1024:   3%|▎         | 3/100 [00:01<00:37,  2.57it/s]29_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:14<00:13,  3.58it/s]28_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:08,  3.34it/s]30_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:08<00:19,  3.53it/s]31_v_torch.Size([1024, 4096])_bs1024:   4%|▍         | 4/100 [00:01<00:33,  2.87it/s]29_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.36it/s]30_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:19,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:   5%|▌         | 5/100 [00:01<00:31,  3.06it/s]29_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:12,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.40it/s]30_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:   6%|▌         | 6/100 [00:02<00:29,  3.19it/s]29_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.56it/s]28_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:07,  3.41it/s]30_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:   7%|▋         | 7/100 [00:02<00:28,  3.28it/s]29_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:15<00:12,  3.57it/s]28_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.43it/s]30_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:09<00:18,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:   8%|▊         | 8/100 [00:02<00:27,  3.33it/s]29_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.55it/s]28_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.43it/s]30_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:   9%|▉         | 9/100 [00:03<00:26,  3.38it/s]29_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:11,  3.55it/s]28_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:  10%|█         | 10/100 [00:03<00:26,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:16<00:11,  3.55it/s]28_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:10<00:17,  3.52it/s]29_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.57it/s]31_v_torch.Size([1024, 4096])_bs1024:  11%|█         | 11/100 [00:03<00:25,  3.43it/s]28_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:17,  3.52it/s]29_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:10,  3.58it/s]31_v_torch.Size([1024, 4096])_bs1024:  12%|█▏        | 12/100 [00:03<00:25,  3.44it/s]28_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.51it/s]29_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.59it/s]31_v_torch.Size([1024, 4096])_bs1024:  13%|█▎        | 13/100 [00:04<00:25,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:11<00:17,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:17<00:10,  3.59it/s]31_v_torch.Size([1024, 4096])_bs1024:  14%|█▍        | 14/100 [00:04<00:24,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:11<00:16,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.58it/s]31_v_torch.Size([1024, 4096])_bs1024:  15%|█▌        | 15/100 [00:04<00:24,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:16,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:09,  3.57it/s]31_v_torch.Size([1024, 4096])_bs1024:  16%|█▌        | 16/100 [00:05<00:24,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.50it/s]28_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:18<00:09,  3.58it/s]31_v_torch.Size([1024, 4096])_bs1024:  17%|█▋        | 17/100 [00:05<00:24,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:12<00:15,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  18%|█▊        | 18/100 [00:05<00:23,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:12<00:15,  3.52it/s]28_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:11,  2.80it/s]31_v_torch.Size([1024, 4096])_bs1024:  19%|█▉        | 19/100 [00:05<00:23,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  2.99it/s]31_v_torch.Size([1024, 4096])_bs1024:  20%|██        | 20/100 [00:06<00:23,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:13<00:15,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:19<00:09,  3.14it/s]31_v_torch.Size([1024, 4096])_bs1024:  21%|██        | 21/100 [00:06<00:22,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:13<00:14,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.25it/s]28_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  22%|██▏       | 22/100 [00:06<00:22,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.51it/s]29_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.35it/s]28_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  23%|██▎       | 23/100 [00:07<00:22,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.52it/s]29_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:20<00:08,  3.40it/s]28_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.45it/s]31_v_torch.Size([1024, 4096])_bs1024:  24%|██▍       | 24/100 [00:07<00:21,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:14<00:14,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.45it/s]28_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  25%|██▌       | 25/100 [00:07<00:21,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.49it/s]28_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  26%|██▌       | 26/100 [00:07<00:21,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.48it/s]29_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  27%|██▋       | 27/100 [00:08<00:21,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:15<00:13,  3.50it/s]29_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:21<00:06,  3.51it/s]28_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  28%|██▊       | 28/100 [00:08<00:20,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:15<00:12,  3.49it/s]29_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.53it/s]28_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  29%|██▉       | 29/100 [00:08<00:20,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  30%|███       | 30/100 [00:09<00:20,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:22<00:05,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.48it/s]28_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.44it/s]28_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.40it/s]
31_v_torch.Size([1024, 4096])_bs1024:  31%|███       | 31/100 [00:09<00:20,  3.39it/s]29_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:22<00:05,  3.55it/s]30_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:16<00:12,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  32%|███▏      | 32/100 [00:09<00:19,  3.41it/s]29_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  33%|███▎      | 33/100 [00:09<00:19,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  34%|███▍      | 34/100 [00:10<00:19,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:23<00:04,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:17<00:11,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  35%|███▌      | 35/100 [00:10<00:18,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:17<00:10,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  36%|███▌      | 36/100 [00:10<00:18,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  37%|███▋      | 37/100 [00:11<00:18,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:24<00:03,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  38%|███▊      | 38/100 [00:11<00:18,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:24<00:03,  3.54it/s]30_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:18<00:10,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  39%|███▉      | 39/100 [00:11<00:17,  3.44it/s]29_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.55it/s]30_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.47it/s]29_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.57it/s]31_v_torch.Size([1024, 4096])_bs1024:  40%|████      | 40/100 [00:12<00:17,  3.45it/s]29_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:25<00:02,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  41%|████      | 41/100 [00:12<00:17,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:19<00:12,  2.73it/s]29_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  42%|████▏     | 42/100 [00:12<00:17,  3.40it/s]30_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:19<00:10,  2.92it/s]29_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  43%|████▎     | 43/100 [00:12<00:16,  3.42it/s]30_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  3.06it/s]29_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:26<00:01,  3.53it/s]31_v_torch.Size([1024, 4096])_bs1024:  44%|████▍     | 44/100 [00:13<00:16,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:20<00:09,  3.16it/s]29_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:26<00:01,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  45%|████▌     | 45/100 [00:13<00:15,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:20<00:08,  3.26it/s]29_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.53it/s]31_v_torch.Size([1024, 4096])_bs1024:  46%|████▌     | 46/100 [00:13<00:15,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.31it/s]29_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:  47%|████▋     | 47/100 [00:14<00:15,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.38it/s]29_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:27<00:00,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  48%|████▊     | 48/100 [00:14<00:14,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:21<00:07,  3.40it/s]29_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.52it/s]3.020354142790893e-06 0.005168597213923931 -0.004729835782200098
0.9999491572380066 1.0051720142364502 0.9952594041824341
28_v proxy err 0.008764048106968403 err 5.2714385986328125 tr(WHW.T) 601.4844360351562
bpp_loss 3.884458541870117
28_q proxy err 0.0009410289349034429 err 21.797889709472656 tr(WHW.T) 23163.888671875
bpp_loss 4.133872747421265
28_k proxy err 0.00043051113607361913 err 6.455175399780273 tr(WHW.T) 14994.2119140625
bpp_loss 4.896484375
o
28_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]31_v_torch.Size([1024, 4096])_bs1024:  49%|████▉     | 49/100 [00:14<00:14,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:21<00:07,  3.43it/s]29_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:  50%|█████     | 50/100 [00:14<00:14,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.46it/s]29_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.54it/s]29_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.49it/s]
31_v_torch.Size([1024, 4096])_bs1024:  51%|█████     | 51/100 [00:15<00:13,  3.50it/s]30_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:22<00:06,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  52%|█████▏    | 52/100 [00:15<00:13,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:22<00:06,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  53%|█████▎    | 53/100 [00:15<00:13,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  54%|█████▍    | 54/100 [00:16<00:13,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  55%|█████▌    | 55/100 [00:16<00:12,  3.47it/s]30_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:23<00:05,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  56%|█████▌    | 56/100 [00:16<00:12,  3.48it/s]30_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:23<00:05,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  57%|█████▋    | 57/100 [00:16<00:12,  3.49it/s]30_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.51it/s]30_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:24<00:04,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:  58%|█████▊    | 58/100 [00:17<00:12,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:24<00:04,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:  59%|█████▉    | 59/100 [00:17<00:11,  3.45it/s]28_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:10,  3.13s/it]30_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:03,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:  60%|██████    | 60/100 [00:17<00:11,  3.45it/s]30_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.51it/s]31_v_torch.Size([1024, 4096])_bs1024:  61%|██████    | 61/100 [00:18<00:11,  3.46it/s]30_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:25<00:03,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  62%|██████▏   | 62/100 [00:18<00:11,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:25<00:03,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:  63%|██████▎   | 63/100 [00:18<00:10,  3.44it/s]30_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  64%|██████▍   | 64/100 [00:18<00:10,  3.39it/s]30_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:26<00:02,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  65%|██████▌   | 65/100 [00:19<00:10,  3.42it/s]30_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:26<00:02,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:  66%|██████▌   | 66/100 [00:19<00:09,  3.41it/s]30_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:01,  3.52it/s]30_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.52it/s]31_v_torch.Size([1024, 4096])_bs1024:  67%|██████▋   | 67/100 [00:20<00:12,  2.63it/s]3.1570123155688634e-06 0.004883771296590567 -0.004660117905586958
0.9999386668205261 1.0045924186706543 0.9951115846633911
29_v proxy err 0.006398561876267195 err 5.441522598266602 tr(WHW.T) 850.4290161132812
bpp_loss 3.92203950881958
29_q proxy err 0.0010535947512835264 err 21.760129928588867 tr(WHW.T) 20653.2265625
bpp_loss 4.125101327896118
29_k proxy err 0.0003908459038939327 err 6.396504878997803 tr(WHW.T) 16365.796875
bpp_loss 5.001546382904053
o
29_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]30_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:27<00:01,  3.53it/s]31_v_torch.Size([1024, 4096])_bs1024:  68%|██████▊   | 68/100 [00:20<00:11,  2.82it/s]30_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:27<00:01,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  69%|██████▉   | 69/100 [00:20<00:10,  2.99it/s]28_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:08,  3.14s/it]30_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.53it/s]31_v_torch.Size([1024, 4096])_bs1024:  70%|███████   | 70/100 [00:21<00:09,  3.12it/s]30_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:28<00:00,  3.53it/s]31_v_torch.Size([1024, 4096])_bs1024:  71%|███████   | 71/100 [00:21<00:09,  3.22it/s]30_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:28<00:00,  3.54it/s]31_v_torch.Size([1024, 4096])_bs1024:  72%|███████▏  | 72/100 [00:21<00:08,  3.30it/s]30_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.53it/s]30_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:28<00:00,  3.45it/s]
31_v_torch.Size([1024, 4096])_bs1024:  73%|███████▎  | 73/100 [00:21<00:07,  3.38it/s]31_v_torch.Size([1024, 4096])_bs1024:  74%|███████▍  | 74/100 [00:22<00:07,  3.43it/s]31_v_torch.Size([1024, 4096])_bs1024:  75%|███████▌  | 75/100 [00:22<00:07,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  76%|███████▌  | 76/100 [00:22<00:06,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  77%|███████▋  | 77/100 [00:23<00:06,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  78%|███████▊  | 78/100 [00:23<00:06,  3.47it/s]29_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:06,  3.09s/it]31_v_torch.Size([1024, 4096])_bs1024:  79%|███████▉  | 79/100 [00:23<00:06,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  80%|████████  | 80/100 [00:23<00:05,  3.48it/s]28_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:04,  3.13s/it]31_v_torch.Size([1024, 4096])_bs1024:  81%|████████  | 81/100 [00:24<00:05,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  82%|████████▏ | 82/100 [00:24<00:05,  3.50it/s]31_v_torch.Size([1024, 4096])_bs1024:  83%|████████▎ | 83/100 [00:24<00:04,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  84%|████████▍ | 84/100 [00:25<00:04,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  85%|████████▌ | 85/100 [00:25<00:04,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  86%|████████▌ | 86/100 [00:25<00:04,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  87%|████████▋ | 87/100 [00:25<00:03,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  88%|████████▊ | 88/100 [00:26<00:03,  3.42it/s]31_v_torch.Size([1024, 4096])_bs1024:  89%|████████▉ | 89/100 [00:26<00:03,  3.42it/s]29_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:04,  3.10s/it]31_v_torch.Size([1024, 4096])_bs1024:  90%|█████████ | 90/100 [00:26<00:02,  3.44it/s]31_v_torch.Size([1024, 4096])_bs1024:  91%|█████████ | 91/100 [00:27<00:02,  3.46it/s]3.1904207844490884e-06 0.004880276508629322 -0.005374472588300705
0.9999016523361206 1.0049141645431519 0.9946625232696533
30_v proxy err 0.007255314849317074 err 6.261777877807617 tr(WHW.T) 863.060791015625
bpp_loss 4.110262870788574
30_q proxy err 0.0008821420487947762 err 21.216073989868164 tr(WHW.T) 24050.6328125
bpp_loss 4.021165132522583
30_k proxy err 0.0004395358555484563 err 6.166946887969971 tr(WHW.T) 14030.5888671875
bpp_loss 4.635194301605225
o
30_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]28_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<05:01,  3.14s/it]31_v_torch.Size([1024, 4096])_bs1024:  92%|█████████▏| 92/100 [00:27<00:02,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  93%|█████████▎| 93/100 [00:27<00:02,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  94%|█████████▍| 94/100 [00:27<00:01,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024:  95%|█████████▌| 95/100 [00:28<00:01,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  96%|█████████▌| 96/100 [00:28<00:01,  3.46it/s]31_v_torch.Size([1024, 4096])_bs1024:  97%|█████████▋| 97/100 [00:28<00:00,  3.47it/s]31_v_torch.Size([1024, 4096])_bs1024:  98%|█████████▊| 98/100 [00:29<00:00,  3.48it/s]31_v_torch.Size([1024, 4096])_bs1024:  99%|█████████▉| 99/100 [00:29<00:00,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.49it/s]31_v_torch.Size([1024, 4096])_bs1024: 100%|██████████| 100/100 [00:29<00:00,  3.38it/s]
29_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:00,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:07,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:58,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:57,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:05,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:55,  3.14s/it]3.1314762054535095e-06 0.0053858403116464615 -0.004614284727722406
0.9999319314956665 1.0045300722122192 0.9946279525756836
31_v proxy err 0.0031423282343894243 err 5.6836042404174805 tr(WHW.T) 1808.723876953125
bpp_loss 3.984410047531128
31_q proxy err 0.0004832299309782684 err 22.313461303710938 tr(WHW.T) 46175.66015625
bpp_loss 4.177239894866943
31_k proxy err 0.00031856304849497974 err 6.520235061645508 tr(WHW.T) 20467.64453125
bpp_loss 4.876802444458008
o
31_o_torch.Size([4096, 4096])_bs1024:   0%|          | 0/100 [00:00<?, ?it/s]29_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<05:01,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:52,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:   1%|          | 1/100 [00:03<05:04,  3.08s/it]29_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:58,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:25<04:49,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:   2%|▏         | 2/100 [00:06<05:02,  3.09s/it]29_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:49,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:54,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:28<04:46,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:   3%|▎         | 3/100 [00:09<04:59,  3.08s/it]29_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:51,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:43,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:   4%|▍         | 4/100 [00:12<04:56,  3.09s/it]29_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:48,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:39,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:   5%|▌         | 5/100 [00:15<04:53,  3.09s/it]29_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:45,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:36,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:   6%|▌         | 6/100 [00:18<04:50,  3.09s/it]29_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:42,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:33,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:   7%|▋         | 7/100 [00:21<04:47,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:31<04:39,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:44<04:30,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:   8%|▊         | 8/100 [00:24<04:44,  3.09s/it]29_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:36,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:47<04:27,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:   9%|▉         | 9/100 [00:27<04:41,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:33,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:50<04:24,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  10%|█         | 10/100 [00:30<04:38,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:30,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:53<04:21,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  11%|█         | 11/100 [00:34<04:35,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:27,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:56<04:18,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  12%|█▏        | 12/100 [00:37<04:32,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:24,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:14,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  13%|█▎        | 13/100 [00:40<04:29,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:21,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:03<04:16,  3.21s/it]31_o_torch.Size([4096, 4096])_bs1024:  14%|█▍        | 14/100 [00:43<04:26,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:18,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:06<04:12,  3.19s/it]31_o_torch.Size([4096, 4096])_bs1024:  15%|█▌        | 15/100 [00:46<04:23,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]30_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:15,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:09<04:07,  3.18s/it]31_o_torch.Size([4096, 4096])_bs1024:  16%|█▌        | 16/100 [00:49<04:20,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:59<04:12,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:12<04:03,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  17%|█▋        | 17/100 [00:52<04:17,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:14,  3.18s/it]28_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:15<04:00,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  18%|█▊        | 18/100 [00:55<04:14,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:09,  3.16s/it]28_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:18<03:56,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  19%|█▉        | 19/100 [00:58<04:11,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:58,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:05,  3.15s/it]28_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:53,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  20%|██        | 20/100 [01:02<04:13,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<04:01,  3.14s/it]28_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:25<03:50,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  21%|██        | 21/100 [01:05<04:08,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:51,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:57,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:28<03:46,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  22%|██▏       | 22/100 [01:08<04:03,  3.13s/it]29_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:48,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:54,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:31<03:43,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  23%|██▎       | 23/100 [01:11<03:59,  3.12s/it]29_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:21<03:50,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:34<03:40,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  24%|██▍       | 24/100 [01:14<03:56,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:24<03:47,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:37<03:36,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  25%|██▌       | 25/100 [01:17<03:52,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:27<03:44,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:40<03:33,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  26%|██▌       | 26/100 [01:20<03:49,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:41,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:43<03:30,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  27%|██▋       | 27/100 [01:23<03:46,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:37,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:47<03:27,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  28%|██▊       | 28/100 [01:26<03:43,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:34,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:50<03:24,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  29%|██▉       | 29/100 [01:30<03:40,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:31,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:53<03:20,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  30%|███       | 30/100 [01:33<03:36,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:21,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:28,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:56<03:17,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  31%|███       | 31/100 [01:36<03:33,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:18,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:25,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:59<03:14,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  32%|███▏      | 32/100 [01:39<03:30,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:49<03:22,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  33%|███▎      | 33/100 [01:42<03:27,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:03<03:15,  3.20s/it]29_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:52<03:19,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  34%|███▍      | 34/100 [01:45<03:24,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:06<03:10,  3.18s/it]29_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:09,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:55<03:15,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  35%|███▌      | 35/100 [01:48<03:21,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:09<03:07,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.17s/it]30_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:58<03:12,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  36%|███▌      | 36/100 [01:51<03:18,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:12<03:03,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:13,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  37%|███▋      | 37/100 [01:54<03:15,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:15<03:00,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:02,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:09,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  38%|███▊      | 38/100 [01:57<03:12,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:18<02:56,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  39%|███▉      | 39/100 [02:01<03:09,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:21<02:53,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:55,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:11<03:01,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  40%|████      | 40/100 [02:04<03:10,  3.17s/it]28_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:25<02:50,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:14<02:58,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  41%|████      | 41/100 [02:07<03:05,  3.15s/it]28_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:28<02:46,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:17<02:54,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  42%|████▏     | 42/100 [02:10<03:02,  3.14s/it]28_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:31<02:43,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:20<02:51,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  43%|████▎     | 43/100 [02:13<02:58,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:34<02:40,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  44%|████▍     | 44/100 [02:16<02:54,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:37<02:37,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:44,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  45%|████▌     | 45/100 [02:19<02:51,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:40<02:33,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  46%|████▌     | 46/100 [02:23<02:48,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:43<02:30,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  47%|████▋     | 47/100 [02:26<02:45,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:47<02:27,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  48%|████▊     | 48/100 [02:29<02:41,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:50<02:24,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:39<02:32,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  49%|████▉     | 49/100 [02:32<02:38,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:53<02:21,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:42<02:29,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  50%|█████     | 50/100 [02:35<02:35,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:56<02:18,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:45<02:26,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  51%|█████     | 51/100 [02:38<02:32,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:59<02:15,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:48<02:23,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  52%|█████▏    | 52/100 [02:41<02:29,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:02<02:12,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  53%|█████▎    | 53/100 [02:44<02:26,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:06<02:11,  3.20s/it]29_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:17,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  54%|█████▍    | 54/100 [02:47<02:23,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:09<02:07,  3.18s/it]29_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:10,  3.18s/it]30_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  55%|█████▌    | 55/100 [02:51<02:20,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:12<02:03,  3.17s/it]29_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  56%|█████▌    | 56/100 [02:54<02:16,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:15<02:00,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]30_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:04<02:10,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  57%|█████▋    | 57/100 [02:57<02:13,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:18<01:56,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]30_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:07<02:06,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024:  58%|█████▊    | 58/100 [03:00<02:10,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:21<01:53,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:10<02:02,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  59%|█████▉    | 59/100 [03:03<02:09,  3.17s/it]28_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:24<01:50,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  60%|██████    | 60/100 [03:06<02:06,  3.15s/it]28_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:28<01:47,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:48,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  61%|██████    | 61/100 [03:09<02:02,  3.14s/it]28_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:31<01:43,  3.15s/it]29_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  62%|██████▏   | 62/100 [03:13<01:58,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:34<01:40,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  63%|██████▎   | 63/100 [03:16<01:55,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:37<01:37,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:26<01:46,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  64%|██████▍   | 64/100 [03:19<01:52,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:40<01:34,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:29<01:43,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  65%|██████▌   | 65/100 [03:22<01:49,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:43<01:31,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:32<01:39,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  66%|██████▌   | 66/100 [03:25<01:45,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:46<01:27,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:35<01:36,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  67%|██████▋   | 67/100 [03:28<01:42,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:50<01:24,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:38<01:33,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  68%|██████▊   | 68/100 [03:31<01:39,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:53<01:21,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:24,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:41<01:30,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  69%|██████▉   | 69/100 [03:34<01:36,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:56<01:18,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  70%|███████   | 70/100 [03:37<01:33,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:59<01:15,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  71%|███████   | 71/100 [03:40<01:30,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:02<01:12,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.12s/it]30_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  72%|███████▏  | 72/100 [03:44<01:27,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:05<01:09,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]30_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:54<01:17,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  73%|███████▎  | 73/100 [03:47<01:23,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:09<01:07,  3.20s/it]30_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:57<01:14,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  74%|███████▍  | 74/100 [03:50<01:20,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:12<01:03,  3.18s/it]29_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]30_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [04:00<01:11,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  75%|███████▌  | 75/100 [03:53<01:17,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.15s/it]28_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:15<01:00,  3.17s/it]30_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:03<01:08,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  76%|███████▌  | 76/100 [03:56<01:14,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.13s/it]28_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:18<00:56,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:06<01:06,  3.17s/it]31_o_torch.Size([4096, 4096])_bs1024:  77%|███████▋  | 77/100 [03:59<01:11,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:21<00:53,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:03,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  78%|███████▊  | 78/100 [04:02<01:08,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.12s/it]28_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:24<00:50,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  79%|███████▉  | 79/100 [04:05<01:06,  3.16s/it]29_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:49,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:28<00:47,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:16<00:56,  3.14s/it]31_o_torch.Size([4096, 4096])_bs1024:  80%|████████  | 80/100 [04:09<01:02,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:31<00:44,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:19<00:53,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  81%|████████  | 81/100 [04:12<00:59,  3.12s/it]29_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:34<00:41,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:22<00:50,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  82%|████████▏ | 82/100 [04:15<00:56,  3.12s/it]29_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:37<00:37,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:25<00:46,  3.13s/it]31_o_torch.Size([4096, 4096])_bs1024:  83%|████████▎ | 83/100 [04:18<00:52,  3.11s/it]29_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:40<00:34,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:28<00:43,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  84%|████████▍ | 84/100 [04:21<00:49,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:43<00:31,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:31<00:40,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  85%|████████▌ | 85/100 [04:24<00:46,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:46<00:28,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:34<00:37,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  86%|████████▌ | 86/100 [04:27<00:43,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:50<00:25,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:37<00:34,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  87%|████████▋ | 87/100 [04:30<00:40,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:53<00:22,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:31,  3.12s/it]31_o_torch.Size([4096, 4096])_bs1024:  88%|████████▊ | 88/100 [04:33<00:37,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:56<00:18,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:44<00:28,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  89%|████████▉ | 89/100 [04:36<00:34,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:59<00:15,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:47<00:24,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  90%|█████████ | 90/100 [04:40<00:30,  3.09s/it]29_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [05:02<00:12,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:50<00:21,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  91%|█████████ | 91/100 [04:43<00:27,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.10s/it]28_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:05<00:09,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:53<00:18,  3.11s/it]31_o_torch.Size([4096, 4096])_bs1024:  92%|█████████▏| 92/100 [04:46<00:24,  3.09s/it]29_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:56<00:15,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:09<00:06,  3.21s/it]31_o_torch.Size([4096, 4096])_bs1024:  93%|█████████▎| 93/100 [04:49<00:21,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:05<00:06,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:59<00:12,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:12<00:03,  3.19s/it]31_o_torch.Size([4096, 4096])_bs1024:  94%|█████████▍| 94/100 [04:52<00:18,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.16s/it]30_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:02<00:09,  3.11s/it]28_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.17s/it]28_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:15<00:00,  3.15s/it]
31_o_torch.Size([4096, 4096])_bs1024:  95%|█████████▌| 95/100 [04:55<00:15,  3.10s/it]29_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.14s/it]29_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.12s/it]
30_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:06<00:06,  3.18s/it]31_o_torch.Size([4096, 4096])_bs1024:  96%|█████████▌| 96/100 [04:58<00:12,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:09<00:03,  3.16s/it]31_o_torch.Size([4096, 4096])_bs1024:  97%|█████████▋| 97/100 [05:01<00:09,  3.10s/it]30_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.15s/it]30_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:12<00:00,  3.12s/it]
31_o_torch.Size([4096, 4096])_bs1024:  98%|█████████▊| 98/100 [05:04<00:06,  3.10s/it]31_o_torch.Size([4096, 4096])_bs1024:  99%|█████████▉| 99/100 [05:08<00:03,  3.18s/it]31_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.15s/it]31_o_torch.Size([4096, 4096])_bs1024: 100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
9.247693242286914e-07 0.0161582063883543 -0.017198676243424416
0.9999693632125854 1.0172210931777954 0.9829726219177246
28_o proxy err 0.007656551897525787 err 19.229013442993164 tr(WHW.T) 2511.445556640625
bpp_loss 3.6914453506469727
28_up proxy err 0.006445455830544233 err 66.04059600830078 tr(WHW.T) 10246.0703125
bpp_loss 3.6761207239968434
28_gate proxy err 0.002004590118303895 err 72.00680541992188 tr(WHW.T) 35920.9609375
bpp_loss 4.004050833838327
28_down proxy err 0.009046724066138268 err 65.22766876220703 tr(WHW.T) 7210.08740234375
bpp_loss 3.665893009730748
1.0420596936455695e-06 0.013655224815011024 -0.013658092357218266
0.9999785423278809 1.0136756896972656 0.9898092746734619
29_o proxy err 0.006197798997163773 err 19.230810165405273 tr(WHW.T) 3102.844970703125
bpp_loss 3.7399332523345947
29_up proxy err 0.005179456900805235 err 66.65187072753906 tr(WHW.T) 12868.505859375
bpp_loss 3.7069879940577914
29_gate proxy err 0.0018774957861751318 err 72.02913665771484 tr(WHW.T) 38364.47265625
bpp_loss 3.9928007466452464
29_down proxy err 0.008846884593367577 err 66.09086608886719 tr(WHW.T) 7470.5244140625
bpp_loss 3.6856788907732283
8.798999147074937e-07 0.01666884683072567 -0.016836293041706085
0.9999790191650391 1.0168474912643433 0.9865249395370483
30_o proxy err 0.004005210939794779 err 19.502073287963867 tr(WHW.T) 4869.1748046875
bpp_loss 3.834492802619934
30_up proxy err 0.003121675457805395 err 67.77530670166016 tr(WHW.T) 21711.1953125
bpp_loss 3.73421471459525
30_gate proxy err 0.0014070224715396762 err 73.10108184814453 tr(WHW.T) 51954.453125
bpp_loss 4.03825889314924
30_down proxy err 0.007372323889285326 err 64.95149230957031 tr(WHW.T) 8810.1787109375
bpp_loss 3.6925704138619557
1.0835221928573446e-06 0.012404374778270721 -0.012513171881437302
0.99998539686203 1.0125336647033691 0.9878784418106079
31_o proxy err 0.0084680812433362 err 18.744789123535156 tr(WHW.T) 2213.58154296875
bpp_loss 3.802953600883484
31_up proxy err 0.0010579921072348952 err 73.02202606201172 tr(WHW.T) 69019.4453125
bpp_loss 3.9195443221500943
31_gate proxy err 0.0005407559219747782 err 78.11357879638672 tr(WHW.T) 144452.5625
bpp_loss 4.2540420804704935
31_down proxy err 0.006597776897251606 err 65.71510314941406 tr(WHW.T) 9960.1884765625
bpp_loss 3.7242373057774136
I0408 13:48:35.344355 687359 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:48:35.344552 687359 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:48:35.344592 687359 utils.py:162] NumExpr defaulting to 16 threads.
I0408 13:48:35.660274 687359 config.py:54] PyTorch version 2.6.0 available.
W0408 13:48:35.861268 687359 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0408 13:48:35.974626 687359 hfize_llama.py:27] LlamaConfig {
  "_attn_implementation_autoset": true,
  "_name_or_path": "../Wparam_dataset/hf_model/meta-llama--Meta-Llama-3-8B",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": 128001,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 8192,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "quip_params": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "transformers_version": "4.47.1",
  "use_cache": true,
  "vocab_size": 128256
}

Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  7.54it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  8.54it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  8.90it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.13it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.18it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.12it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.29it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.05it/s]
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:00<00:00,  8.94it/s]Loading checkpoint shards:  29%|██▊       | 2/7 [00:00<00:00,  9.15it/s]Loading checkpoint shards:  43%|████▎     | 3/7 [00:00<00:00,  9.18it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:00<00:00,  9.27it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:00<00:00,  9.31it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:00<00:00,  9.31it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.39it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:00<00:00,  9.29it/s]
I0408 13:48:38.638134 687359 hfize_llama.py:161] loaded layer 0
I0408 13:48:38.903366 687359 hfize_llama.py:161] loaded layer 1
I0408 13:48:39.191959 687359 hfize_llama.py:161] loaded layer 2
I0408 13:48:39.487557 687359 hfize_llama.py:161] loaded layer 3
I0408 13:48:39.741287 687359 hfize_llama.py:161] loaded layer 4
I0408 13:48:40.256849 687359 hfize_llama.py:161] loaded layer 5
I0408 13:48:40.521719 687359 hfize_llama.py:161] loaded layer 6
I0408 13:48:40.820606 687359 hfize_llama.py:161] loaded layer 7
I0408 13:48:41.084622 687359 hfize_llama.py:161] loaded layer 8
I0408 13:48:41.379056 687359 hfize_llama.py:161] loaded layer 9
I0408 13:48:41.836320 687359 hfize_llama.py:161] loaded layer 10
I0408 13:48:42.098490 687359 hfize_llama.py:161] loaded layer 11
I0408 13:48:42.358798 687359 hfize_llama.py:161] loaded layer 12
I0408 13:48:42.660273 687359 hfize_llama.py:161] loaded layer 13
I0408 13:48:42.983947 687359 hfize_llama.py:161] loaded layer 14
I0408 13:48:43.284494 687359 hfize_llama.py:161] loaded layer 15
I0408 13:48:43.556562 687359 hfize_llama.py:161] loaded layer 16
I0408 13:48:43.826430 687359 hfize_llama.py:161] loaded layer 17
I0408 13:48:44.106686 687359 hfize_llama.py:161] loaded layer 18
I0408 13:48:44.385133 687359 hfize_llama.py:161] loaded layer 19
I0408 13:48:44.668117 687359 hfize_llama.py:161] loaded layer 20
I0408 13:48:44.995100 687359 hfize_llama.py:161] loaded layer 21
I0408 13:48:45.355028 687359 hfize_llama.py:161] loaded layer 22
I0408 13:48:45.636896 687359 hfize_llama.py:161] loaded layer 23
I0408 13:48:46.014800 687359 hfize_llama.py:161] loaded layer 24
I0408 13:48:46.304383 687359 hfize_llama.py:161] loaded layer 25
I0408 13:48:46.567294 687359 hfize_llama.py:161] loaded layer 26
I0408 13:48:46.813605 687359 hfize_llama.py:161] loaded layer 27
I0408 13:48:47.048835 687359 hfize_llama.py:161] loaded layer 28
I0408 13:48:47.296729 687359 hfize_llama.py:161] loaded layer 29
I0408 13:48:47.562413 687359 hfize_llama.py:161] loaded layer 30
I0408 13:48:47.920386 687359 hfize_llama.py:161] loaded layer 31
I0408 13:48:47.920513 687359 hfize_llama.py:165] saving model...
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:07,  1.32s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.06s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:03<00:03,  1.05it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:03<00:02,  1.12it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:05<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.34it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.15it/s]
I0408 13:49:25.308051 687359 hfize_llama.py:175] successfully loaded hfized model
I0408 13:49:30.134747 688129 utils.py:146] Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
I0408 13:49:30.134934 688129 utils.py:149] Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
I0408 13:49:30.134975 688129 utils.py:162] NumExpr defaulting to 16 threads.
W0408 13:49:30.482950 688129 warnings.py:109] /opt/conda/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/opt/conda/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(

I0408 13:49:30.834058 688129 modeling.py:990] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/7 [00:00<?, ?it/s]Loading checkpoint shards:  14%|█▍        | 1/7 [00:01<00:06,  1.01s/it]Loading checkpoint shards:  29%|██▊       | 2/7 [00:02<00:05,  1.02s/it]Loading checkpoint shards:  43%|████▎     | 3/7 [00:02<00:03,  1.02it/s]Loading checkpoint shards:  57%|█████▋    | 4/7 [00:03<00:02,  1.04it/s]Loading checkpoint shards:  71%|███████▏  | 5/7 [00:04<00:01,  1.06it/s]Loading checkpoint shards:  86%|████████▌ | 6/7 [00:05<00:00,  1.09it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.25it/s]Loading checkpoint shards: 100%|██████████| 7/7 [00:06<00:00,  1.12it/s]
I0408 13:49:37.175953 688129 config.py:54] PyTorch version 2.6.0 available.
  0%|          | 0/141 [00:00<?, ?it/s]avg_loss = 1.6841634511947632:   0%|          | 0/141 [00:01<?, ?it/s]avg_loss = 1.6841634511947632:   1%|          | 1/141 [00:01<04:13,  1.81s/it]avg_loss = 1.96784907579422:   1%|          | 1/141 [00:03<04:13,  1.81s/it]  avg_loss = 1.96784907579422:   1%|▏         | 2/141 [00:03<03:43,  1.60s/it]avg_loss = 2.094195564587911:   1%|▏         | 2/141 [00:04<03:43,  1.60s/it]avg_loss = 2.094195564587911:   2%|▏         | 3/141 [00:04<03:32,  1.54s/it]avg_loss = 2.0418969690799713:   2%|▏         | 3/141 [00:06<03:32,  1.54s/it]avg_loss = 2.0418969690799713:   3%|▎         | 4/141 [00:06<03:27,  1.52s/it]avg_loss = 1.988643503189087:   3%|▎         | 4/141 [00:07<03:27,  1.52s/it] avg_loss = 1.988643503189087:   4%|▎         | 5/141 [00:07<03:24,  1.50s/it]avg_loss = 1.8923617998758953:   4%|▎         | 5/141 [00:09<03:24,  1.50s/it]avg_loss = 1.8923617998758953:   4%|▍         | 6/141 [00:09<03:22,  1.50s/it]avg_loss = 1.8287349769047327:   4%|▍         | 6/141 [00:10<03:22,  1.50s/it]avg_loss = 1.8287349769047327:   5%|▍         | 7/141 [00:10<03:20,  1.49s/it]avg_loss = 1.8219360411167145:   5%|▍         | 7/141 [00:12<03:20,  1.49s/it]avg_loss = 1.8219360411167145:   6%|▌         | 8/141 [00:12<03:18,  1.49s/it]avg_loss = 1.854465299182468:   6%|▌         | 8/141 [00:13<03:18,  1.49s/it] avg_loss = 1.854465299182468:   6%|▋         | 9/141 [00:13<03:17,  1.50s/it]avg_loss = 1.856281316280365:   6%|▋         | 9/141 [00:15<03:17,  1.50s/it]avg_loss = 1.856281316280365:   7%|▋         | 10/141 [00:15<03:15,  1.50s/it]avg_loss = 1.8499005924571643:   7%|▋         | 10/141 [00:16<03:15,  1.50s/it]avg_loss = 1.8499005924571643:   8%|▊         | 11/141 [00:16<03:14,  1.50s/it]avg_loss = 1.872847040494283:   8%|▊         | 11/141 [00:18<03:14,  1.50s/it] avg_loss = 1.872847040494283:   9%|▊         | 12/141 [00:18<03:13,  1.50s/it]avg_loss = 1.885569609128512:   9%|▊         | 12/141 [00:19<03:13,  1.50s/it]avg_loss = 1.885569609128512:   9%|▉         | 13/141 [00:19<03:12,  1.50s/it]avg_loss = 1.9036779233387537:   9%|▉         | 13/141 [00:21<03:12,  1.50s/it]avg_loss = 1.9036779233387537:  10%|▉         | 14/141 [00:21<03:11,  1.50s/it]avg_loss = 1.9140652497609456:  10%|▉         | 14/141 [00:22<03:11,  1.50s/it]avg_loss = 1.9140652497609456:  11%|█         | 15/141 [00:22<03:09,  1.51s/it]avg_loss = 1.9383183121681213:  11%|█         | 15/141 [00:24<03:09,  1.51s/it]avg_loss = 1.9383183121681213:  11%|█▏        | 16/141 [00:24<03:08,  1.51s/it]avg_loss = 1.9409172885558184:  11%|█▏        | 16/141 [00:25<03:08,  1.51s/it]avg_loss = 1.9409172885558184:  12%|█▏        | 17/141 [00:25<03:07,  1.51s/it]avg_loss = 1.9447690579626296:  12%|█▏        | 17/141 [00:27<03:07,  1.51s/it]avg_loss = 1.9447690579626296:  13%|█▎        | 18/141 [00:27<03:06,  1.51s/it]avg_loss = 1.9324151779475964:  13%|█▎        | 18/141 [00:28<03:06,  1.51s/it]avg_loss = 1.9324151779475964:  13%|█▎        | 19/141 [00:28<03:05,  1.52s/it]avg_loss = 1.9313672602176666:  13%|█▎        | 19/141 [00:30<03:05,  1.52s/it]avg_loss = 1.9313672602176666:  14%|█▍        | 20/141 [00:30<03:03,  1.52s/it]avg_loss = 1.9359555414744787:  14%|█▍        | 20/141 [00:31<03:03,  1.52s/it]avg_loss = 1.9359555414744787:  15%|█▍        | 21/141 [00:31<03:02,  1.52s/it]avg_loss = 1.937823550267653:  15%|█▍        | 21/141 [00:33<03:02,  1.52s/it] avg_loss = 1.937823550267653:  16%|█▌        | 22/141 [00:33<03:01,  1.52s/it]avg_loss = 1.939746125884678:  16%|█▌        | 22/141 [00:34<03:01,  1.52s/it]avg_loss = 1.939746125884678:  16%|█▋        | 23/141 [00:34<03:00,  1.53s/it]avg_loss = 1.9449738909800847:  16%|█▋        | 23/141 [00:36<03:00,  1.53s/it]avg_loss = 1.9449738909800847:  17%|█▋        | 24/141 [00:36<02:58,  1.53s/it]avg_loss = 1.9508097887039184:  17%|█▋        | 24/141 [00:37<02:58,  1.53s/it]avg_loss = 1.9508097887039184:  18%|█▊        | 25/141 [00:37<02:57,  1.53s/it]avg_loss = 1.9622947848760164:  18%|█▊        | 25/141 [00:39<02:57,  1.53s/it]avg_loss = 1.9622947848760164:  18%|█▊        | 26/141 [00:39<02:56,  1.53s/it]avg_loss = 1.9745973613527086:  18%|█▊        | 26/141 [00:41<02:56,  1.53s/it]avg_loss = 1.9745973613527086:  19%|█▉        | 27/141 [00:41<02:54,  1.53s/it]avg_loss = 1.9806216146264757:  19%|█▉        | 27/141 [00:42<02:54,  1.53s/it]avg_loss = 1.9806216146264757:  20%|█▉        | 28/141 [00:42<02:53,  1.53s/it]avg_loss = 1.9770013669441486:  20%|█▉        | 28/141 [00:44<02:53,  1.53s/it]avg_loss = 1.9770013669441486:  21%|██        | 29/141 [00:44<02:51,  1.53s/it]avg_loss = 1.9674147486686706:  21%|██        | 29/141 [00:45<02:51,  1.53s/it]avg_loss = 1.9674147486686706:  21%|██▏       | 30/141 [00:45<02:50,  1.54s/it]avg_loss = 1.953968636451229:  21%|██▏       | 30/141 [00:47<02:50,  1.54s/it] avg_loss = 1.953968636451229:  22%|██▏       | 31/141 [00:47<02:49,  1.54s/it]avg_loss = 1.942689660936594:  22%|██▏       | 31/141 [00:48<02:49,  1.54s/it]avg_loss = 1.942689660936594:  23%|██▎       | 32/141 [00:48<02:47,  1.54s/it]avg_loss = 1.9408631830504446:  23%|██▎       | 32/141 [00:50<02:47,  1.54s/it]avg_loss = 1.9408631830504446:  23%|██▎       | 33/141 [00:50<02:46,  1.54s/it]avg_loss = 1.9390079273897058:  23%|██▎       | 33/141 [00:51<02:46,  1.54s/it]avg_loss = 1.9390079273897058:  24%|██▍       | 34/141 [00:51<02:44,  1.54s/it]avg_loss = 1.9414667538234165:  24%|██▍       | 34/141 [00:53<02:44,  1.54s/it]avg_loss = 1.9414667538234165:  25%|██▍       | 35/141 [00:53<02:43,  1.54s/it]avg_loss = 1.9243775871064928:  25%|██▍       | 35/141 [00:54<02:43,  1.54s/it]avg_loss = 1.9243775871064928:  26%|██▌       | 36/141 [00:54<02:41,  1.54s/it]avg_loss = 1.9085748807804004:  26%|██▌       | 36/141 [00:56<02:41,  1.54s/it]avg_loss = 1.9085748807804004:  26%|██▌       | 37/141 [00:56<02:40,  1.54s/it]avg_loss = 1.8932199917341535:  26%|██▌       | 37/141 [00:57<02:40,  1.54s/it]avg_loss = 1.8932199917341535:  27%|██▋       | 38/141 [00:57<02:39,  1.55s/it]avg_loss = 1.878800752835396:  27%|██▋       | 38/141 [00:59<02:39,  1.55s/it] avg_loss = 1.878800752835396:  28%|██▊       | 39/141 [00:59<02:37,  1.55s/it]avg_loss = 1.869660210609436:  28%|██▊       | 39/141 [01:01<02:37,  1.55s/it]avg_loss = 1.869660210609436:  28%|██▊       | 40/141 [01:01<02:36,  1.55s/it]avg_loss = 1.8747000403520537:  28%|██▊       | 40/141 [01:02<02:36,  1.55s/it]avg_loss = 1.8747000403520537:  29%|██▉       | 41/141 [01:02<02:34,  1.55s/it]avg_loss = 1.8911644163585843:  29%|██▉       | 41/141 [01:04<02:34,  1.55s/it]avg_loss = 1.8911644163585843:  30%|██▉       | 42/141 [01:04<02:33,  1.55s/it]avg_loss = 1.9075762615647427:  30%|██▉       | 42/141 [01:05<02:33,  1.55s/it]avg_loss = 1.9075762615647427:  30%|███       | 43/141 [01:05<02:31,  1.55s/it]avg_loss = 1.9116881002079358:  30%|███       | 43/141 [01:07<02:31,  1.55s/it]avg_loss = 1.9116881002079358:  31%|███       | 44/141 [01:07<02:30,  1.55s/it]avg_loss = 1.9162786059909396:  31%|███       | 44/141 [01:08<02:30,  1.55s/it]avg_loss = 1.9162786059909396:  32%|███▏      | 45/141 [01:08<02:29,  1.55s/it]avg_loss = 1.9212973584299502:  32%|███▏      | 45/141 [01:10<02:29,  1.55s/it]avg_loss = 1.9212973584299502:  33%|███▎      | 46/141 [01:10<02:27,  1.56s/it]avg_loss = 1.9276495436404615:  33%|███▎      | 46/141 [01:11<02:27,  1.56s/it]avg_loss = 1.9276495436404615:  33%|███▎      | 47/141 [01:11<02:26,  1.56s/it]avg_loss = 1.9307872653007507:  33%|███▎      | 47/141 [01:13<02:26,  1.56s/it]avg_loss = 1.9307872653007507:  34%|███▍      | 48/141 [01:13<02:24,  1.56s/it]avg_loss = 1.929824941012324:  34%|███▍      | 48/141 [01:15<02:24,  1.56s/it] avg_loss = 1.929824941012324:  35%|███▍      | 49/141 [01:15<02:23,  1.56s/it]avg_loss = 1.9299272036552428:  35%|███▍      | 49/141 [01:16<02:23,  1.56s/it]avg_loss = 1.9299272036552428:  35%|███▌      | 50/141 [01:16<02:21,  1.56s/it]avg_loss = 1.9236652196622361:  35%|███▌      | 50/141 [01:18<02:21,  1.56s/it]avg_loss = 1.9236652196622361:  36%|███▌      | 51/141 [01:18<02:20,  1.56s/it]avg_loss = 1.9195480713477502:  36%|███▌      | 51/141 [01:19<02:20,  1.56s/it]avg_loss = 1.9195480713477502:  37%|███▋      | 52/141 [01:19<02:19,  1.56s/it]avg_loss = 1.9128896110462692:  37%|███▋      | 52/141 [01:21<02:19,  1.56s/it]avg_loss = 1.9128896110462692:  38%|███▊      | 53/141 [01:21<02:17,  1.56s/it]avg_loss = 1.9097447086263586:  38%|███▊      | 53/141 [01:22<02:17,  1.56s/it]avg_loss = 1.9097447086263586:  38%|███▊      | 54/141 [01:22<02:16,  1.57s/it]avg_loss = 1.9020964969288219:  38%|███▊      | 54/141 [01:24<02:16,  1.57s/it]avg_loss = 1.9020964969288219:  39%|███▉      | 55/141 [01:24<02:14,  1.57s/it]avg_loss = 1.8942314663103648:  39%|███▉      | 55/141 [01:26<02:14,  1.57s/it]avg_loss = 1.8942314663103648:  40%|███▉      | 56/141 [01:26<02:13,  1.57s/it]avg_loss = 1.889086361516986:  40%|███▉      | 56/141 [01:27<02:13,  1.57s/it] avg_loss = 1.889086361516986:  40%|████      | 57/141 [01:27<02:11,  1.56s/it]avg_loss = 1.8860310213319187:  40%|████      | 57/141 [01:29<02:11,  1.56s/it]avg_loss = 1.8860310213319187:  41%|████      | 58/141 [01:29<02:09,  1.56s/it]avg_loss = 1.8881984949111938:  41%|████      | 58/141 [01:30<02:09,  1.56s/it]avg_loss = 1.8881984949111938:  42%|████▏     | 59/141 [01:30<02:08,  1.56s/it]avg_loss = 1.89357390999794:  42%|████▏     | 59/141 [01:32<02:08,  1.56s/it]  avg_loss = 1.89357390999794:  43%|████▎     | 60/141 [01:32<02:06,  1.56s/it]avg_loss = 1.8991558923095953:  43%|████▎     | 60/141 [01:33<02:06,  1.56s/it]avg_loss = 1.8991558923095953:  43%|████▎     | 61/141 [01:33<02:05,  1.57s/it]avg_loss = 1.9061142379237759:  43%|████▎     | 61/141 [01:35<02:05,  1.57s/it]avg_loss = 1.9061142379237759:  44%|████▍     | 62/141 [01:35<02:03,  1.57s/it]avg_loss = 1.8974129131862096:  44%|████▍     | 62/141 [01:37<02:03,  1.57s/it]avg_loss = 1.8974129131862096:  45%|████▍     | 63/141 [01:37<02:02,  1.57s/it]avg_loss = 1.8952996116131544:  45%|████▍     | 63/141 [01:38<02:02,  1.57s/it]avg_loss = 1.8952996116131544:  45%|████▌     | 64/141 [01:38<02:00,  1.57s/it]avg_loss = 1.8927119163366464:  45%|████▌     | 64/141 [01:40<02:00,  1.57s/it]avg_loss = 1.8927119163366464:  46%|████▌     | 65/141 [01:40<01:59,  1.57s/it]avg_loss = 1.8866879073056309:  46%|████▌     | 65/141 [01:41<01:59,  1.57s/it]avg_loss = 1.8866879073056309:  47%|████▋     | 66/141 [01:41<01:57,  1.57s/it]avg_loss = 1.8841160411265359:  47%|████▋     | 66/141 [01:43<01:57,  1.57s/it]avg_loss = 1.8841160411265359:  48%|████▊     | 67/141 [01:43<01:56,  1.57s/it]avg_loss = 1.8807965832598068:  48%|████▊     | 67/141 [01:44<01:56,  1.57s/it]avg_loss = 1.8807965832598068:  48%|████▊     | 68/141 [01:44<01:54,  1.57s/it]avg_loss = 1.8778483366620713:  48%|████▊     | 68/141 [01:46<01:54,  1.57s/it]avg_loss = 1.8778483366620713:  49%|████▉     | 69/141 [01:46<01:53,  1.57s/it]avg_loss = 1.8788207377706254:  49%|████▉     | 69/141 [01:47<01:53,  1.57s/it]avg_loss = 1.8788207377706254:  50%|████▉     | 70/141 [01:47<01:51,  1.57s/it]avg_loss = 1.8825240454203647:  50%|████▉     | 70/141 [01:49<01:51,  1.57s/it]avg_loss = 1.8825240454203647:  50%|█████     | 71/141 [01:49<01:49,  1.57s/it]avg_loss = 1.8851093533966277:  50%|█████     | 71/141 [01:51<01:49,  1.57s/it]avg_loss = 1.8851093533966277:  51%|█████     | 72/141 [01:51<01:48,  1.57s/it]avg_loss = 1.8835437804052275:  51%|█████     | 72/141 [01:52<01:48,  1.57s/it]avg_loss = 1.8835437804052275:  52%|█████▏    | 73/141 [01:52<01:46,  1.57s/it]avg_loss = 1.8852018681732383:  52%|█████▏    | 73/141 [01:54<01:46,  1.57s/it]avg_loss = 1.8852018681732383:  52%|█████▏    | 74/141 [01:54<01:45,  1.57s/it]avg_loss = 1.8853484789530437:  52%|█████▏    | 74/141 [01:55<01:45,  1.57s/it]avg_loss = 1.8853484789530437:  53%|█████▎    | 75/141 [01:55<01:43,  1.57s/it]avg_loss = 1.8841100837055005:  53%|█████▎    | 75/141 [01:57<01:43,  1.57s/it]avg_loss = 1.8841100837055005:  54%|█████▍    | 76/141 [01:57<01:42,  1.57s/it]avg_loss = 1.885124251439974:  54%|█████▍    | 76/141 [01:58<01:42,  1.57s/it] avg_loss = 1.885124251439974:  55%|█████▍    | 77/141 [01:58<01:40,  1.57s/it]avg_loss = 1.887440331471272:  55%|█████▍    | 77/141 [02:00<01:40,  1.57s/it]avg_loss = 1.887440331471272:  55%|█████▌    | 78/141 [02:00<01:39,  1.57s/it]avg_loss = 1.8912791375872455:  55%|█████▌    | 78/141 [02:02<01:39,  1.57s/it]avg_loss = 1.8912791375872455:  56%|█████▌    | 79/141 [02:02<01:37,  1.57s/it]avg_loss = 1.8881229877471923:  56%|█████▌    | 79/141 [02:03<01:37,  1.57s/it]avg_loss = 1.8881229877471923:  57%|█████▋    | 80/141 [02:03<01:35,  1.57s/it]avg_loss = 1.8867757040777324:  57%|█████▋    | 80/141 [02:05<01:35,  1.57s/it]avg_loss = 1.8867757040777324:  57%|█████▋    | 81/141 [02:05<01:34,  1.57s/it]avg_loss = 1.8858771338695433:  57%|█████▋    | 81/141 [02:06<01:34,  1.57s/it]avg_loss = 1.8858771338695433:  58%|█████▊    | 82/141 [02:06<01:32,  1.57s/it]avg_loss = 1.8840034553803593:  58%|█████▊    | 82/141 [02:08<01:32,  1.57s/it]avg_loss = 1.8840034553803593:  59%|█████▉    | 83/141 [02:08<01:31,  1.57s/it]avg_loss = 1.8815925064541044:  59%|█████▉    | 83/141 [02:10<01:31,  1.57s/it]avg_loss = 1.8815925064541044:  60%|█████▉    | 84/141 [02:10<01:29,  1.57s/it]avg_loss = 1.8791394345900592:  60%|█████▉    | 84/141 [02:11<01:29,  1.57s/it]avg_loss = 1.8791394345900592:  60%|██████    | 85/141 [02:11<01:28,  1.57s/it]avg_loss = 1.8807050738223763:  60%|██████    | 85/141 [02:13<01:28,  1.57s/it]avg_loss = 1.8807050738223763:  61%|██████    | 86/141 [02:13<01:26,  1.57s/it]avg_loss = 1.882474891070662:  61%|██████    | 86/141 [02:14<01:26,  1.57s/it] avg_loss = 1.882474891070662:  62%|██████▏   | 87/141 [02:14<01:25,  1.58s/it]avg_loss = 1.8832834335890682:  62%|██████▏   | 87/141 [02:16<01:25,  1.58s/it]avg_loss = 1.8832834335890682:  62%|██████▏   | 88/141 [02:16<01:23,  1.58s/it]avg_loss = 1.8920399178279919:  62%|██████▏   | 88/141 [02:17<01:23,  1.58s/it]avg_loss = 1.8920399178279919:  63%|██████▎   | 89/141 [02:17<01:22,  1.58s/it]avg_loss = 1.8995441198349:  63%|██████▎   | 89/141 [02:19<01:22,  1.58s/it]   avg_loss = 1.8995441198349:  64%|██████▍   | 90/141 [02:19<01:20,  1.58s/it]avg_loss = 1.9025597624726347:  64%|██████▍   | 90/141 [02:21<01:20,  1.58s/it]avg_loss = 1.9025597624726347:  65%|██████▍   | 91/141 [02:21<01:18,  1.58s/it]avg_loss = 1.9076073791669763:  65%|██████▍   | 91/141 [02:22<01:18,  1.58s/it]avg_loss = 1.9076073791669763:  65%|██████▌   | 92/141 [02:22<01:17,  1.58s/it]avg_loss = 1.9127531179817774:  65%|██████▌   | 92/141 [02:24<01:17,  1.58s/it]avg_loss = 1.9127531179817774:  66%|██████▌   | 93/141 [02:24<01:15,  1.58s/it]avg_loss = 1.9137055062233133:  66%|██████▌   | 93/141 [02:25<01:15,  1.58s/it]avg_loss = 1.9137055062233133:  67%|██████▋   | 94/141 [02:25<01:14,  1.58s/it]avg_loss = 1.9173116357702957:  67%|██████▋   | 94/141 [02:27<01:14,  1.58s/it]avg_loss = 1.9173116357702957:  67%|██████▋   | 95/141 [02:27<01:12,  1.58s/it]avg_loss = 1.918045025318861:  67%|██████▋   | 95/141 [02:28<01:12,  1.58s/it] avg_loss = 1.918045025318861:  68%|██████▊   | 96/141 [02:28<01:11,  1.58s/it]avg_loss = 1.9197534445634823:  68%|██████▊   | 96/141 [02:30<01:11,  1.58s/it]avg_loss = 1.9197534445634823:  69%|██████▉   | 97/141 [02:30<01:09,  1.58s/it]avg_loss = 1.9164192044005102:  69%|██████▉   | 97/141 [02:32<01:09,  1.58s/it]avg_loss = 1.9164192044005102:  70%|██████▉   | 98/141 [02:32<01:07,  1.58s/it]avg_loss = 1.917679695167927:  70%|██████▉   | 98/141 [02:33<01:07,  1.58s/it] avg_loss = 1.917679695167927:  70%|███████   | 99/141 [02:33<01:06,  1.58s/it]avg_loss = 1.9198366451263427:  70%|███████   | 99/141 [02:35<01:06,  1.58s/it]avg_loss = 1.9198366451263427:  71%|███████   | 100/141 [02:35<01:04,  1.58s/it]avg_loss = 1.91892405783776:  71%|███████   | 100/141 [02:36<01:04,  1.58s/it]  avg_loss = 1.91892405783776:  72%|███████▏  | 101/141 [02:36<01:03,  1.58s/it]avg_loss = 1.9191690683364868:  72%|███████▏  | 101/141 [02:38<01:03,  1.58s/it]avg_loss = 1.9191690683364868:  72%|███████▏  | 102/141 [02:38<01:01,  1.58s/it]avg_loss = 1.9179389499923558:  72%|███████▏  | 102/141 [02:39<01:01,  1.58s/it]avg_loss = 1.9179389499923558:  73%|███████▎  | 103/141 [02:39<01:00,  1.58s/it]avg_loss = 1.9207747395222003:  73%|███████▎  | 103/141 [02:41<01:00,  1.58s/it]avg_loss = 1.9207747395222003:  74%|███████▍  | 104/141 [02:41<00:58,  1.58s/it]avg_loss = 1.9197941212427048:  74%|███████▍  | 104/141 [02:43<00:58,  1.58s/it]avg_loss = 1.9197941212427048:  74%|███████▍  | 105/141 [02:43<00:56,  1.58s/it]avg_loss = 1.9188861700723756:  74%|███████▍  | 105/141 [02:44<00:56,  1.58s/it]avg_loss = 1.9188861700723756:  75%|███████▌  | 106/141 [02:44<00:55,  1.58s/it]avg_loss = 1.9166413991250724:  75%|███████▌  | 106/141 [02:46<00:55,  1.58s/it]avg_loss = 1.9166413991250724:  76%|███████▌  | 107/141 [02:46<00:53,  1.58s/it]avg_loss = 1.9143541974050027:  76%|███████▌  | 107/141 [02:47<00:53,  1.58s/it]avg_loss = 1.9143541974050027:  77%|███████▋  | 108/141 [02:47<00:52,  1.58s/it]avg_loss = 1.9120575878598274:  77%|███████▋  | 108/141 [02:49<00:52,  1.58s/it]avg_loss = 1.9120575878598274:  77%|███████▋  | 109/141 [02:49<00:50,  1.58s/it]avg_loss = 1.9095999533479864:  77%|███████▋  | 109/141 [02:51<00:50,  1.58s/it]avg_loss = 1.9095999533479864:  78%|███████▊  | 110/141 [02:51<00:48,  1.58s/it]avg_loss = 1.911942944870339:  78%|███████▊  | 110/141 [02:52<00:48,  1.58s/it] avg_loss = 1.911942944870339:  79%|███████▊  | 111/141 [02:52<00:47,  1.58s/it]avg_loss = 1.911743886768818:  79%|███████▊  | 111/141 [02:54<00:47,  1.58s/it]avg_loss = 1.911743886768818:  79%|███████▉  | 112/141 [02:54<00:45,  1.58s/it]avg_loss = 1.9128141540341672:  79%|███████▉  | 112/141 [02:55<00:45,  1.58s/it]avg_loss = 1.9128141540341672:  80%|████████  | 113/141 [02:55<00:44,  1.58s/it]avg_loss = 1.9135972250971878:  80%|████████  | 113/141 [02:57<00:44,  1.58s/it]avg_loss = 1.9135972250971878:  81%|████████  | 114/141 [02:57<00:42,  1.58s/it]avg_loss = 1.9126776176950206:  81%|████████  | 114/141 [02:58<00:42,  1.58s/it]avg_loss = 1.9126776176950206:  82%|████████▏ | 115/141 [02:58<00:41,  1.58s/it]avg_loss = 1.9113392028315315:  82%|████████▏ | 115/141 [03:00<00:41,  1.58s/it]avg_loss = 1.9113392028315315:  82%|████████▏ | 116/141 [03:00<00:39,  1.58s/it]avg_loss = 1.9135533683320396:  82%|████████▏ | 116/141 [03:02<00:39,  1.58s/it]avg_loss = 1.9135533683320396:  83%|████████▎ | 117/141 [03:02<00:37,  1.58s/it]avg_loss = 1.9131712883205738:  83%|████████▎ | 117/141 [03:03<00:37,  1.58s/it]avg_loss = 1.9131712883205738:  84%|████████▎ | 118/141 [03:03<00:36,  1.58s/it]avg_loss = 1.9117488099747346:  84%|████████▎ | 118/141 [03:05<00:36,  1.58s/it]avg_loss = 1.9117488099747346:  84%|████████▍ | 119/141 [03:05<00:34,  1.58s/it]avg_loss = 1.9099091678857802:  84%|████████▍ | 119/141 [03:06<00:34,  1.58s/it]avg_loss = 1.9099091678857802:  85%|████████▌ | 120/141 [03:06<00:33,  1.58s/it]avg_loss = 1.9096865141687314:  85%|████████▌ | 120/141 [03:08<00:33,  1.58s/it]avg_loss = 1.9096865141687314:  86%|████████▌ | 121/141 [03:08<00:31,  1.58s/it]avg_loss = 1.9100502895527198:  86%|████████▌ | 121/141 [03:10<00:31,  1.58s/it]avg_loss = 1.9100502895527198:  87%|████████▋ | 122/141 [03:10<00:30,  1.58s/it]avg_loss = 1.909811510303156:  87%|████████▋ | 122/141 [03:11<00:30,  1.58s/it] avg_loss = 1.909811510303156:  87%|████████▋ | 123/141 [03:11<00:28,  1.58s/it]avg_loss = 1.909943401813507:  87%|████████▋ | 123/141 [03:13<00:28,  1.58s/it]avg_loss = 1.909943401813507:  88%|████████▊ | 124/141 [03:13<00:26,  1.58s/it]avg_loss = 1.9087342891693115:  88%|████████▊ | 124/141 [03:14<00:26,  1.58s/it]avg_loss = 1.9087342891693115:  89%|████████▊ | 125/141 [03:14<00:25,  1.58s/it]avg_loss = 1.909070300677466:  89%|████████▊ | 125/141 [03:16<00:25,  1.58s/it] avg_loss = 1.909070300677466:  89%|████████▉ | 126/141 [03:16<00:23,  1.58s/it]avg_loss = 1.9086829226786697:  89%|████████▉ | 126/141 [03:17<00:23,  1.58s/it]avg_loss = 1.9086829226786697:  90%|█████████ | 127/141 [03:17<00:22,  1.58s/it]avg_loss = 1.9074046975001693:  90%|█████████ | 127/141 [03:19<00:22,  1.58s/it]avg_loss = 1.9074046975001693:  91%|█████████ | 128/141 [03:19<00:20,  1.58s/it]avg_loss = 1.907498453938684:  91%|█████████ | 128/141 [03:21<00:20,  1.58s/it] avg_loss = 1.907498453938684:  91%|█████████▏| 129/141 [03:21<00:18,  1.58s/it]avg_loss = 1.9081697363119858:  91%|█████████▏| 129/141 [03:22<00:18,  1.58s/it]avg_loss = 1.9081697363119858:  92%|█████████▏| 130/141 [03:22<00:17,  1.58s/it]avg_loss = 1.909097923577287:  92%|█████████▏| 130/141 [03:24<00:17,  1.58s/it] avg_loss = 1.909097923577287:  93%|█████████▎| 131/141 [03:24<00:15,  1.58s/it]avg_loss = 1.9095755914847057:  93%|█████████▎| 131/141 [03:25<00:15,  1.58s/it]avg_loss = 1.9095755914847057:  94%|█████████▎| 132/141 [03:25<00:14,  1.58s/it]avg_loss = 1.9065123823352326:  94%|█████████▎| 132/141 [03:27<00:14,  1.58s/it]avg_loss = 1.9065123823352326:  94%|█████████▍| 133/141 [03:27<00:12,  1.58s/it]avg_loss = 1.9019850190006085:  94%|█████████▍| 133/141 [03:29<00:12,  1.58s/it]avg_loss = 1.9019850190006085:  95%|█████████▌| 134/141 [03:29<00:11,  1.58s/it]avg_loss = 1.9044218752119275:  95%|█████████▌| 134/141 [03:30<00:11,  1.58s/it]avg_loss = 1.9044218752119275:  96%|█████████▌| 135/141 [03:30<00:09,  1.58s/it]avg_loss = 1.9079758437240826:  96%|█████████▌| 135/141 [03:32<00:09,  1.58s/it]avg_loss = 1.9079758437240826:  96%|█████████▋| 136/141 [03:32<00:07,  1.58s/it]avg_loss = 1.9093272163920159:  96%|█████████▋| 136/141 [03:33<00:07,  1.58s/it]avg_loss = 1.9093272163920159:  97%|█████████▋| 137/141 [03:33<00:06,  1.58s/it]avg_loss = 1.9081266608791074:  97%|█████████▋| 137/141 [03:35<00:06,  1.58s/it]avg_loss = 1.9081266608791074:  98%|█████████▊| 138/141 [03:35<00:04,  1.58s/it]avg_loss = 1.9082921083024937:  98%|█████████▊| 138/141 [03:36<00:04,  1.58s/it]avg_loss = 1.9082921083024937:  99%|█████████▊| 139/141 [03:36<00:03,  1.58s/it]avg_loss = 1.9089364060333798:  99%|█████████▊| 139/141 [03:38<00:03,  1.58s/it]avg_loss = 1.9089364060333798:  99%|█████████▉| 140/141 [03:38<00:01,  1.58s/it]avg_loss = 1.910134771191482:  99%|█████████▉| 140/141 [03:40<00:01,  1.58s/it] avg_loss = 1.910134771191482: 100%|██████████| 141/141 [03:40<00:00,  1.58s/it]avg_loss = 1.910134771191482: 100%|██████████| 141/141 [03:40<00:00,  1.56s/it]
I0408 13:53:41.884652 688129 eval_ppl.py:107] wikitext2 perplexity: 6.75399923324585
wikitext2 perplexity: 6.754
